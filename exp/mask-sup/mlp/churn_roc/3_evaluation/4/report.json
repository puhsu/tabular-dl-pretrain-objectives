{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised___b1a17643407b49ccab1db9676d5c9dd1.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 4,
        "data": {
            "path": "data/churn_roc",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512,
                    512
                ],
                "dropout": 0.0
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [],
            "d_num_embedding": null,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.0005651719782097044,
            "weight_decay": 5.5350583325020384e-05,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.582137452174284,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.0005651719782097044,
            "weight_decay": 5.5350583325020384e-05,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "epoch_size": 50,
    "n_parameters": 538636,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": 0.8900903270699502,
                    "pretrain_loss": 1.0879859328269958,
                    "pretrain_component": 0.6156789660453796,
                    "supervised_component": 0.4723069667816162,
                    "features_accuracy": [
                        0.5795312523841858,
                        0.6932812333106995,
                        0.5645312666893005,
                        0.5299999713897705,
                        0.6076562404632568,
                        0.7035937309265137,
                        0.7526562213897705,
                        0.7564062476158142,
                        0.7128124833106995,
                        0.7457812428474426,
                        0.6545312404632568
                    ]
                },
                "val": {
                    "score": 0.8670483766890427,
                    "pretrain_loss": 1.0737575590610504,
                    "pretrain_component": 0.61179119348526,
                    "supervised_component": 0.4619663655757904,
                    "features_accuracy": [
                        0.6056249737739563,
                        0.7199999690055847,
                        0.5799999833106995,
                        0.5106250047683716,
                        0.621874988079071,
                        0.7087500095367432,
                        0.7425000071525574,
                        0.7762500047683716,
                        0.7049999833106995,
                        0.7462499737739563,
                        0.653124988079071
                    ]
                },
                "test": {
                    "score": 0.8542533288295999,
                    "pretrain_loss": 1.0893921852111816,
                    "pretrain_component": 0.6104967594146729,
                    "supervised_component": 0.4788954257965088,
                    "features_accuracy": [
                        0.5955000519752502,
                        0.7190000414848328,
                        0.5820000171661377,
                        0.5160000324249268,
                        0.6185000538825989,
                        0.6790000200271606,
                        0.7595000267028809,
                        0.7605000138282776,
                        0.7300000190734863,
                        0.7490000128746033,
                        0.6460000276565552
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": 0.9054909540503319,
                    "pretrain_loss": 1.0866182744503021,
                    "pretrain_component": 0.6121997237205505,
                    "supervised_component": 0.4744185507297516,
                    "features_accuracy": [
                        0.5765624642372131,
                        0.71484375,
                        0.5573437213897705,
                        0.5134375095367432,
                        0.6034374833106995,
                        0.6971874833106995,
                        0.7543749809265137,
                        0.7565624713897705,
                        0.7065624594688416,
                        0.7465624809265137,
                        0.6646875143051147
                    ]
                },
                "val": {
                    "score": 0.8696848725332511,
                    "pretrain_loss": 1.076129823923111,
                    "pretrain_component": 0.6112148761749268,
                    "supervised_component": 0.4649149477481842,
                    "features_accuracy": [
                        0.6056249737739563,
                        0.7199999690055847,
                        0.5793749690055847,
                        0.5074999928474426,
                        0.6200000047683716,
                        0.7093749642372131,
                        0.7437499761581421,
                        0.7762500047683716,
                        0.7068749666213989,
                        0.7462499737739563,
                        0.6556249856948853
                    ]
                },
                "test": {
                    "score": 0.8522019708460384,
                    "pretrain_loss": 1.0869586169719696,
                    "pretrain_component": 0.6087719798088074,
                    "supervised_component": 0.47818663716316223,
                    "features_accuracy": [
                        0.5955000519752502,
                        0.7190000414848328,
                        0.5840000510215759,
                        0.5164999961853027,
                        0.6195000410079956,
                        0.6795000433921814,
                        0.7635000348091125,
                        0.7605000138282776,
                        0.7310000061988831,
                        0.7520000338554382,
                        0.6460000276565552
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": 0.8931904669607343,
                    "pretrain_loss": 1.0853612422943115,
                    "pretrain_component": 0.6136390566825867,
                    "supervised_component": 0.47172218561172485,
                    "features_accuracy": [
                        0.5804687142372131,
                        0.7203124761581421,
                        0.5623437166213989,
                        0.5184375047683716,
                        0.6051562428474426,
                        0.6909374594688416,
                        0.7465624809265137,
                        0.7554687261581421,
                        0.7009375095367432,
                        0.73890620470047,
                        0.6524999737739563
                    ]
                },
                "val": {
                    "score": 0.8688036328264198,
                    "pretrain_loss": 1.0715017318725586,
                    "pretrain_component": 0.6087781190872192,
                    "supervised_component": 0.46272361278533936,
                    "features_accuracy": [
                        0.6056249737739563,
                        0.7199999690055847,
                        0.581250011920929,
                        0.5131250023841858,
                        0.6287499666213989,
                        0.7099999785423279,
                        0.7431249618530273,
                        0.7762500047683716,
                        0.706250011920929,
                        0.75,
                        0.6537500023841858
                    ]
                },
                "test": {
                    "score": 0.8585966552068247,
                    "pretrain_loss": 1.0854936838150024,
                    "pretrain_component": 0.6077626347541809,
                    "supervised_component": 0.47773104906082153,
                    "features_accuracy": [
                        0.5955000519752502,
                        0.7190000414848328,
                        0.581000030040741,
                        0.5125000476837158,
                        0.6150000095367432,
                        0.6780000329017639,
                        0.7660000324249268,
                        0.7605000138282776,
                        0.7290000319480896,
                        0.7540000081062317,
                        0.6460000276565552
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": 0.894799752723175,
                    "pretrain_loss": 1.0827564299106598,
                    "pretrain_component": 0.6110475063323975,
                    "supervised_component": 0.47170892357826233,
                    "features_accuracy": [
                        0.5839062333106995,
                        0.7124999761581421,
                        0.559374988079071,
                        0.5260937213897705,
                        0.6015625,
                        0.703906238079071,
                        0.7501562237739563,
                        0.7542187571525574,
                        0.7028124928474426,
                        0.75390625,
                        0.6506249904632568
                    ]
                },
                "val": {
                    "score": 0.8706431605204612,
                    "pretrain_loss": 1.0724213123321533,
                    "pretrain_component": 0.6077181696891785,
                    "supervised_component": 0.46470314264297485,
                    "features_accuracy": [
                        0.6056249737739563,
                        0.7199999690055847,
                        0.5818749666213989,
                        0.5093749761581421,
                        0.6193749904632568,
                        0.7099999785423279,
                        0.7462499737739563,
                        0.7762500047683716,
                        0.7049999833106995,
                        0.7537499666213989,
                        0.6524999737739563
                    ]
                },
                "test": {
                    "score": 0.8601914703609619,
                    "pretrain_loss": 1.084814578294754,
                    "pretrain_component": 0.6072603464126587,
                    "supervised_component": 0.47755423188209534,
                    "features_accuracy": [
                        0.5955000519752502,
                        0.7190000414848328,
                        0.5795000195503235,
                        0.5160000324249268,
                        0.6185000538825989,
                        0.6795000433921814,
                        0.7645000219345093,
                        0.7605000138282776,
                        0.7300000190734863,
                        0.7535000443458557,
                        0.6445000171661377
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": 0.8962326701563116,
                    "pretrain_loss": 1.0857186615467072,
                    "pretrain_component": 0.6133221983909607,
                    "supervised_component": 0.47239646315574646,
                    "features_accuracy": [
                        0.5707812309265137,
                        0.707812488079071,
                        0.5634374618530273,
                        0.52734375,
                        0.6071875095367432,
                        0.6948437094688416,
                        0.7479687333106995,
                        0.7560937404632568,
                        0.7010937333106995,
                        0.7482812404632568,
                        0.663281261920929
                    ]
                },
                "val": {
                    "score": 0.8708598588090264,
                    "pretrain_loss": 1.075980931520462,
                    "pretrain_component": 0.6106334924697876,
                    "supervised_component": 0.46534743905067444,
                    "features_accuracy": [
                        0.6056249737739563,
                        0.7199999690055847,
                        0.5743749737739563,
                        0.5093749761581421,
                        0.6262499690055847,
                        0.7099999785423279,
                        0.7362499833106995,
                        0.7762500047683716,
                        0.7049999833106995,
                        0.7450000047683716,
                        0.6556249856948853
                    ]
                },
                "test": {
                    "score": 0.8601914703609619,
                    "pretrain_loss": 1.0860613286495209,
                    "pretrain_component": 0.6088022589683533,
                    "supervised_component": 0.4772590696811676,
                    "features_accuracy": [
                        0.5955000519752502,
                        0.7190000414848328,
                        0.5800000429153442,
                        0.5160000324249268,
                        0.6165000200271606,
                        0.6795000433921814,
                        0.7635000348091125,
                        0.7605000138282776,
                        0.7290000319480896,
                        0.752500057220459,
                        0.643500030040741
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": 0.9092210238271807,
                    "pretrain_loss": 1.08830526471138,
                    "pretrain_component": 0.6104208827018738,
                    "supervised_component": 0.4778843820095062,
                    "features_accuracy": [
                        0.5746874809265137,
                        0.7151562571525574,
                        0.5628125071525574,
                        0.5114062428474426,
                        0.606249988079071,
                        0.7001562118530273,
                        0.7607812285423279,
                        0.7610937356948853,
                        0.7043749690055847,
                        0.7482812404632568,
                        0.6484375
                    ]
                },
                "val": {
                    "score": 0.8686591673007098,
                    "pretrain_loss": 1.0740934014320374,
                    "pretrain_component": 0.608167290687561,
                    "supervised_component": 0.4659261107444763,
                    "features_accuracy": [
                        0.6056249737739563,
                        0.7199999690055847,
                        0.5806249976158142,
                        0.5093749761581421,
                        0.6237499713897705,
                        0.7099999785423279,
                        0.7456249594688416,
                        0.7762500047683716,
                        0.7049999833106995,
                        0.753125011920929,
                        0.6512500047683716
                    ]
                },
                "test": {
                    "score": 0.85544404188472,
                    "pretrain_loss": 1.0848847925662994,
                    "pretrain_component": 0.6065641045570374,
                    "supervised_component": 0.4783206880092621,
                    "features_accuracy": [
                        0.5955000519752502,
                        0.7190000414848328,
                        0.5825000405311584,
                        0.515500009059906,
                        0.6195000410079956,
                        0.6790000200271606,
                        0.76500004529953,
                        0.7605000138282776,
                        0.7300000190734863,
                        0.7565000653266907,
                        0.6455000042915344
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": 0.9090761068467028,
                    "pretrain_loss": 1.085948795080185,
                    "pretrain_component": 0.6095287203788757,
                    "supervised_component": 0.4764200747013092,
                    "features_accuracy": [
                        0.582812488079071,
                        0.7099999785423279,
                        0.5571874976158142,
                        0.5259374976158142,
                        0.6115624904632568,
                        0.7021874785423279,
                        0.7529687285423279,
                        0.7643749713897705,
                        0.7124999761581421,
                        0.7482812404632568,
                        0.657031238079071
                    ]
                },
                "val": {
                    "score": 0.8713895657366297,
                    "pretrain_loss": 1.0714643597602844,
                    "pretrain_component": 0.6089566349983215,
                    "supervised_component": 0.4625077247619629,
                    "features_accuracy": [
                        0.6056249737739563,
                        0.7199999690055847,
                        0.5762500166893005,
                        0.5093749761581421,
                        0.6256250143051147,
                        0.7087500095367432,
                        0.7487499713897705,
                        0.7762500047683716,
                        0.7049999833106995,
                        0.7524999976158142,
                        0.65625
                    ]
                },
                "test": {
                    "score": 0.8551186008813126,
                    "pretrain_loss": 1.0866885483264923,
                    "pretrain_component": 0.6089072823524475,
                    "supervised_component": 0.4777812659740448,
                    "features_accuracy": [
                        0.5955000519752502,
                        0.7190000414848328,
                        0.5815000534057617,
                        0.5164999961853027,
                        0.612500011920929,
                        0.6790000200271606,
                        0.7635000348091125,
                        0.7605000138282776,
                        0.7295000553131104,
                        0.752500057220459,
                        0.6440000534057617
                    ]
                }
            },
            "80000": {
                "train": {
                    "score": 0.8987979866321234,
                    "pretrain_loss": 1.0873804986476898,
                    "pretrain_component": 0.6108524203300476,
                    "supervised_component": 0.4765280783176422,
                    "features_accuracy": [
                        0.5787500143051147,
                        0.7114062309265137,
                        0.5692187547683716,
                        0.5299999713897705,
                        0.6045312285423279,
                        0.6853125095367432,
                        0.7434374690055847,
                        0.7589062452316284,
                        0.7099999785423279,
                        0.76624995470047,
                        0.6454687118530273
                    ]
                },
                "val": {
                    "score": 0.8716592347179553,
                    "pretrain_loss": 1.0699476897716522,
                    "pretrain_component": 0.607438862323761,
                    "supervised_component": 0.46250882744789124,
                    "features_accuracy": [
                        0.6056249737739563,
                        0.7199999690055847,
                        0.5837500095367432,
                        0.5087499618530273,
                        0.6225000023841858,
                        0.7099999785423279,
                        0.7475000023841858,
                        0.7762500047683716,
                        0.7049999833106995,
                        0.7537499666213989,
                        0.6524999737739563
                    ]
                },
                "test": {
                    "score": 0.8602068941051992,
                    "pretrain_loss": 1.0863319635391235,
                    "pretrain_component": 0.606579065322876,
                    "supervised_component": 0.47975289821624756,
                    "features_accuracy": [
                        0.5955000519752502,
                        0.7190000414848328,
                        0.581000030040741,
                        0.515500009059906,
                        0.6195000410079956,
                        0.6795000433921814,
                        0.7670000195503235,
                        0.7605000138282776,
                        0.7295000553131104,
                        0.7555000185966492,
                        0.6460000276565552
                    ]
                }
            },
            "90000": {
                "train": {
                    "score": 0.8994625280503896,
                    "pretrain_loss": 1.0878840386867523,
                    "pretrain_component": 0.6108205914497375,
                    "supervised_component": 0.47706344723701477,
                    "features_accuracy": [
                        0.5840625166893005,
                        0.7121874690055847,
                        0.5732812285423279,
                        0.5290625095367432,
                        0.6078124642372131,
                        0.6814062595367432,
                        0.7556250095367432,
                        0.7634375095367432,
                        0.7017187476158142,
                        0.7479687333106995,
                        0.65234375
                    ]
                },
                "val": {
                    "score": 0.8682763336575782,
                    "pretrain_loss": 1.0691920220851898,
                    "pretrain_component": 0.6066450476646423,
                    "supervised_component": 0.4625469744205475,
                    "features_accuracy": [
                        0.6056249737739563,
                        0.7199999690055847,
                        0.5799999833106995,
                        0.5099999904632568,
                        0.628125011920929,
                        0.7087500095367432,
                        0.7493749856948853,
                        0.7762500047683716,
                        0.706250011920929,
                        0.7556250095367432,
                        0.6537500023841858
                    ]
                },
                "test": {
                    "score": 0.8587292994072655,
                    "pretrain_loss": 1.0853131115436554,
                    "pretrain_component": 0.6065517067909241,
                    "supervised_component": 0.4787614047527313,
                    "features_accuracy": [
                        0.5955000519752502,
                        0.7190000414848328,
                        0.5790000557899475,
                        0.515500009059906,
                        0.612500011920929,
                        0.6785000562667847,
                        0.7670000195503235,
                        0.7610000371932983,
                        0.7300000190734863,
                        0.7560000419616699,
                        0.643500030040741
                    ]
                }
            },
            "100000": {
                "train": {
                    "score": 0.8997073670194835,
                    "pretrain_loss": 1.0824809968471527,
                    "pretrain_component": 0.6103474497795105,
                    "supervised_component": 0.4721335470676422,
                    "features_accuracy": [
                        0.5895312428474426,
                        0.7168749570846558,
                        0.5651562213897705,
                        0.5237500071525574,
                        0.6031249761581421,
                        0.6859374642372131,
                        0.7495312094688416,
                        0.75062495470047,
                        0.7212499976158142,
                        0.7489062547683716,
                        0.6448437571525574
                    ]
                },
                "val": {
                    "score": 0.8696391251167762,
                    "pretrain_loss": 1.0685712397098541,
                    "pretrain_component": 0.6059874296188354,
                    "supervised_component": 0.4625838100910187,
                    "features_accuracy": [
                        0.6049999594688416,
                        0.7199999690055847,
                        0.5793749690055847,
                        0.5106250047683716,
                        0.6262499690055847,
                        0.7081249952316284,
                        0.7487499713897705,
                        0.7762500047683716,
                        0.706250011920929,
                        0.7562499642372131,
                        0.6518749594688416
                    ]
                },
                "test": {
                    "score": 0.8587478079003503,
                    "pretrain_loss": 1.0837964117527008,
                    "pretrain_component": 0.6061984896659851,
                    "supervised_component": 0.4775979220867157,
                    "features_accuracy": [
                        0.5960000157356262,
                        0.7190000414848328,
                        0.5820000171661377,
                        0.5160000324249268,
                        0.6175000071525574,
                        0.6795000433921814,
                        0.7665000557899475,
                        0.7605000138282776,
                        0.7285000085830688,
                        0.7545000314712524,
                        0.6475000381469727
                    ]
                }
            }
        },
        "train": {
            "score": 0.8987979866321234
        },
        "val": {
            "score": 0.8716592347179553
        },
        "test": {
            "score": 0.8602068941051992
        }
    },
    "best_iteration": 80000,
    "time": "0:07:26"
}
