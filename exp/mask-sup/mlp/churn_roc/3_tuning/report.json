{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/tune.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 0,
        "program": "bin/pretrain_mask_supervised.py",
        "base_config": {
            "seed": 0,
            "data": {
                "T_cache": true,
                "path": "data/churn_roc",
                "T": {
                    "normalization": "quantile"
                }
            },
            "model": {
                "kind": "mlp"
            },
            "training": {
                "batch_size": 128,
                "patience": 16
            },
            "pretrain": {
                "corrupt_strategy": "resample",
                "patience": 2,
                "d_hidden_head": 512
            }
        },
        "space": {
            "model": {
                "config": {
                    "d_layers": [
                        "$fixed_mlp_d_layers",
                        1,
                        8,
                        512
                    ],
                    "dropout": [
                        "?uniform",
                        0.0,
                        0.0,
                        0.5
                    ]
                }
            },
            "pretrain": {
                "corrupt_probability": [
                    "uniform",
                    0.2,
                    0.8
                ]
            },
            "training": {
                "lr": [
                    "loguniform",
                    5e-05,
                    0.005
                ],
                "weight_decay": [
                    "?loguniform",
                    0.0,
                    1e-06,
                    0.001
                ]
            }
        },
        "n_trials": 100,
        "timeout": null,
        "sampler": {
            "seed": 0
        }
    },
    "best": {
        "program": "bin/pretrain_mask_supervised.py",
        "environment": {
            "CUDA_VISIBLE_DEVICES": "0",
            "gpus": {
                "driver": "450.119.04",
                "devices": [
                    {
                        "name": "A100-SXM-80GB",
                        "memory_total": 85199093760,
                        "memory_free": 85195948032,
                        "memory_used": 3145728,
                        "utilization": 0
                    }
                ]
            },
            "torch.version.cuda": "11.1",
            "torch.backends.cudnn.version()": 8005,
            "torch.cuda.nccl.version()": [
                2,
                10,
                3
            ]
        },
        "config": {
            "seed": 0,
            "data": {
                "path": "data/churn_roc",
                "T": {
                    "seed": 0,
                    "normalization": "quantile",
                    "num_nan_policy": null,
                    "cat_nan_policy": null,
                    "cat_min_frequency": null,
                    "cat_encoding": null,
                    "y_policy": "default"
                },
                "T_cache": true
            },
            "model": {
                "kind": "mlp",
                "config": {
                    "d_layers": [
                        512,
                        512
                    ],
                    "dropout": 0.0
                },
                "default": true,
                "checkpoint": null,
                "num_embedding_arch": [],
                "d_num_embedding": null,
                "positional_encoding": null,
                "d_cat_embedding": null
            },
            "training": {
                "batch_size": 128,
                "lr": 0.0005651719782097044,
                "weight_decay": 5.5350583325020384e-05,
                "optimizer": "AdamW",
                "patience": 16,
                "n_epochs": Infinity,
                "eval_batch_size": 8192
            },
            "pretrain": {
                "corrupt_probability": 0.582137452174284,
                "corrupt_strategy": "resample",
                "d_hidden_head": 512,
                "lr": 0.0005651719782097044,
                "weight_decay": 5.5350583325020384e-05,
                "patience": 2,
                "n_iterations": 100000,
                "validate_every": 10000,
                "replace_strategy": "shuffle",
                "n_neighbors": 20,
                "use_target": false,
                "early_stop_type": "finetune",
                "target_injection_type": "post"
            },
            "bins": null
        },
        "epoch_size": 50,
        "n_parameters": 538636,
        "metrics": {
            "iteration_scores": {
                "10000": {
                    "train": {
                        "score": 0.899216033747147,
                        "pretrain_loss": 1.0922503173351288,
                        "pretrain_component": 0.6141518354415894,
                        "supervised_component": 0.47809848189353943,
                        "features_accuracy": [
                            0.5912500023841858,
                            0.7098437547683716,
                            0.5770312547683716,
                            0.5207812190055847,
                            0.6153124570846558,
                            0.6912499666213989,
                            0.7443749904632568,
                            0.7557812333106995,
                            0.7118749618530273,
                            0.7521874904632568,
                            0.6399999856948853
                        ]
                    },
                    "val": {
                        "score": 0.8677610732825456,
                        "pretrain_loss": 1.0909354090690613,
                        "pretrain_component": 0.6125237941741943,
                        "supervised_component": 0.47841161489486694,
                        "features_accuracy": [
                            0.5831249952316284,
                            0.7118749618530273,
                            0.5862500071525574,
                            0.518750011920929,
                            0.5974999666213989,
                            0.7112500071525574,
                            0.7418749928474426,
                            0.7562499642372131,
                            0.7131249904632568,
                            0.7437499761581421,
                            0.6631249785423279
                        ]
                    },
                    "test": {
                        "score": 0.8535222433527517,
                        "pretrain_loss": 1.0937432646751404,
                        "pretrain_component": 0.6096266508102417,
                        "supervised_component": 0.4841166138648987,
                        "features_accuracy": [
                            0.5625,
                            0.7255000472068787,
                            0.5830000042915344,
                            0.5375000238418579,
                            0.6145000457763672,
                            0.6995000243186951,
                            0.7480000257492065,
                            0.7545000314712524,
                            0.718000054359436,
                            0.7600000500679016,
                            0.6640000343322754
                        ]
                    }
                },
                "20000": {
                    "train": {
                        "score": 0.8911348429178185,
                        "pretrain_loss": 1.0910448729991913,
                        "pretrain_component": 0.613451361656189,
                        "supervised_component": 0.4775935113430023,
                        "features_accuracy": [
                            0.5759375095367432,
                            0.7212499976158142,
                            0.5731250047683716,
                            0.534375011920929,
                            0.6006249785423279,
                            0.6964062452316284,
                            0.7489062547683716,
                            0.7528125047683716,
                            0.7120312452316284,
                            0.7425000071525574,
                            0.6553124785423279
                        ]
                    },
                    "val": {
                        "score": 0.8702892199824714,
                        "pretrain_loss": 1.092180460691452,
                        "pretrain_component": 0.6125762462615967,
                        "supervised_component": 0.47960421442985535,
                        "features_accuracy": [
                            0.5831249952316284,
                            0.7118749618530273,
                            0.5862500071525574,
                            0.5237500071525574,
                            0.5849999785423279,
                            0.7106249928474426,
                            0.7400000095367432,
                            0.7556250095367432,
                            0.7131249904632568,
                            0.7412499785423279,
                            0.6612499952316284
                        ]
                    },
                    "test": {
                        "score": 0.8585997399556721,
                        "pretrain_loss": 1.091572344303131,
                        "pretrain_component": 0.6099672317504883,
                        "supervised_component": 0.4816051125526428,
                        "features_accuracy": [
                            0.5625,
                            0.7255000472068787,
                            0.5835000276565552,
                            0.5425000190734863,
                            0.6130000352859497,
                            0.6995000243186951,
                            0.749500036239624,
                            0.7550000548362732,
                            0.718000054359436,
                            0.7605000138282776,
                            0.6655000448226929
                        ]
                    }
                },
                "30000": {
                    "train": {
                        "score": 0.8929516473885448,
                        "pretrain_loss": 1.0805322229862213,
                        "pretrain_component": 0.611320436000824,
                        "supervised_component": 0.46921178698539734,
                        "features_accuracy": [
                            0.5731250047683716,
                            0.71546870470047,
                            0.5701562166213989,
                            0.5276562571525574,
                            0.6034374833106995,
                            0.6990624666213989,
                            0.7521874904632568,
                            0.7384374737739563,
                            0.7134374976158142,
                            0.7542187571525574,
                            0.6559374928474426
                        ]
                    },
                    "val": {
                        "score": 0.8707804027698858,
                        "pretrain_loss": 1.0872609317302704,
                        "pretrain_component": 0.610813558101654,
                        "supervised_component": 0.47644737362861633,
                        "features_accuracy": [
                            0.5831249952316284,
                            0.7118749618530273,
                            0.5824999809265137,
                            0.5218749642372131,
                            0.5949999690055847,
                            0.7112500071525574,
                            0.7443749904632568,
                            0.7556250095367432,
                            0.7124999761581421,
                            0.7425000071525574,
                            0.6606249809265137
                        ]
                    },
                    "test": {
                        "score": 0.8578038747530273,
                        "pretrain_loss": 1.0898394286632538,
                        "pretrain_component": 0.607341468334198,
                        "supervised_component": 0.4824979603290558,
                        "features_accuracy": [
                            0.5625,
                            0.7255000472068787,
                            0.5840000510215759,
                            0.5420000553131104,
                            0.6105000376701355,
                            0.6980000138282776,
                            0.7515000104904175,
                            0.7550000548362732,
                            0.718000054359436,
                            0.7620000243186951,
                            0.6685000061988831
                        ]
                    }
                },
                "40000": {
                    "train": {
                        "score": 0.89282704587262,
                        "pretrain_loss": 1.084902286529541,
                        "pretrain_component": 0.6121556758880615,
                        "supervised_component": 0.4727466106414795,
                        "features_accuracy": [
                            0.5709375143051147,
                            0.7157812118530273,
                            0.5596874952316284,
                            0.5249999761581421,
                            0.6078124642372131,
                            0.6993749737739563,
                            0.754687488079071,
                            0.7556250095367432,
                            0.7043749690055847,
                            0.7426562309265137,
                            0.6501562595367432
                        ]
                    },
                    "val": {
                        "score": 0.8706696458668413,
                        "pretrain_loss": 1.0846246480941772,
                        "pretrain_component": 0.6101904511451721,
                        "supervised_component": 0.4744341969490051,
                        "features_accuracy": [
                            0.5837500095367432,
                            0.7118749618530273,
                            0.5862500071525574,
                            0.5231249928474426,
                            0.5981249809265137,
                            0.7124999761581421,
                            0.7418749928474426,
                            0.7556250095367432,
                            0.7124999761581421,
                            0.7443749904632568,
                            0.6624999642372131
                        ]
                    },
                    "test": {
                        "score": 0.8587524350236213,
                        "pretrain_loss": 1.0897725224494934,
                        "pretrain_component": 0.607498824596405,
                        "supervised_component": 0.4822736978530884,
                        "features_accuracy": [
                            0.5615000128746033,
                            0.7255000472068787,
                            0.5805000066757202,
                            0.5425000190734863,
                            0.6165000200271606,
                            0.7010000348091125,
                            0.7480000257492065,
                            0.7550000548362732,
                            0.7175000309944153,
                            0.7645000219345093,
                            0.6670000553131104
                        ]
                    }
                },
                "50000": {
                    "train": {
                        "score": 0.8934446359950304,
                        "pretrain_loss": 1.0847234725952148,
                        "pretrain_component": 0.613167405128479,
                        "supervised_component": 0.47155606746673584,
                        "features_accuracy": [
                            0.5717187523841858,
                            0.7003124952316284,
                            0.5776562094688416,
                            0.5199999809265137,
                            0.6037499904632568,
                            0.6876562237739563,
                            0.7485937476158142,
                            0.750781238079071,
                            0.707812488079071,
                            0.754687488079071,
                            0.6565625071525574
                        ]
                    },
                    "val": {
                        "score": 0.870368676021612,
                        "pretrain_loss": 1.08660888671875,
                        "pretrain_component": 0.6104174852371216,
                        "supervised_component": 0.4761914014816284,
                        "features_accuracy": [
                            0.5831249952316284,
                            0.7118749618530273,
                            0.5856249928474426,
                            0.5274999737739563,
                            0.59375,
                            0.7068749666213989,
                            0.7437499761581421,
                            0.7562499642372131,
                            0.7124999761581421,
                            0.7443749904632568,
                            0.6643750071525574
                        ]
                    },
                    "test": {
                        "score": 0.8589190114613844,
                        "pretrain_loss": 1.0887859165668488,
                        "pretrain_component": 0.6068772077560425,
                        "supervised_component": 0.4819087088108063,
                        "features_accuracy": [
                            0.562000036239624,
                            0.7255000472068787,
                            0.5825000405311584,
                            0.5405000448226929,
                            0.6140000224113464,
                            0.6975000500679016,
                            0.7510000467300415,
                            0.7550000548362732,
                            0.7160000205039978,
                            0.7635000348091125,
                            0.6670000553131104
                        ]
                    }
                },
                "60000": {
                    "train": {
                        "score": 0.8946899739721278,
                        "pretrain_loss": 1.0834782421588898,
                        "pretrain_component": 0.6126267313957214,
                        "supervised_component": 0.47085151076316833,
                        "features_accuracy": [
                            0.5743749737739563,
                            0.703906238079071,
                            0.5618749856948853,
                            0.5282812118530273,
                            0.6107812523841858,
                            0.6949999928474426,
                            0.7517187595367432,
                            0.760937511920929,
                            0.710156261920929,
                            0.7503125071525574,
                            0.6479687094688416
                        ]
                    },
                    "val": {
                        "score": 0.8714425364293902,
                        "pretrain_loss": 1.0864167511463165,
                        "pretrain_component": 0.60996413230896,
                        "supervised_component": 0.47645261883735657,
                        "features_accuracy": [
                            0.5831249952316284,
                            0.7118749618530273,
                            0.5868749618530273,
                            0.5243749618530273,
                            0.5949999690055847,
                            0.7124999761581421,
                            0.7437499761581421,
                            0.7556250095367432,
                            0.7131249904632568,
                            0.746874988079071,
                            0.6637499928474426
                        ]
                    },
                    "test": {
                        "score": 0.8598428937411987,
                        "pretrain_loss": 1.0875594317913055,
                        "pretrain_component": 0.6065359115600586,
                        "supervised_component": 0.48102352023124695,
                        "features_accuracy": [
                            0.5625,
                            0.7255000472068787,
                            0.5840000510215759,
                            0.5410000085830688,
                            0.6135000586509705,
                            0.7000000476837158,
                            0.7515000104904175,
                            0.7550000548362732,
                            0.7160000205039978,
                            0.76500004529953,
                            0.6670000553131104
                        ]
                    }
                },
                "70000": {
                    "train": {
                        "score": 0.8959131906656009,
                        "pretrain_loss": 1.0840502977371216,
                        "pretrain_component": 0.6091622710227966,
                        "supervised_component": 0.47488802671432495,
                        "features_accuracy": [
                            0.5771874785423279,
                            0.7189062237739563,
                            0.5645312666893005,
                            0.5348437428474426,
                            0.5985937118530273,
                            0.6942187547683716,
                            0.7426562309265137,
                            0.76171875,
                            0.7160937190055847,
                            0.7576562166213989,
                            0.6317187547683716
                        ]
                    },
                    "val": {
                        "score": 0.8711006346852095,
                        "pretrain_loss": 1.0855113565921783,
                        "pretrain_component": 0.6093389987945557,
                        "supervised_component": 0.4761723577976227,
                        "features_accuracy": [
                            0.5831249952316284,
                            0.7118749618530273,
                            0.581250011920929,
                            0.5237500071525574,
                            0.5974999666213989,
                            0.7124999761581421,
                            0.7437499761581421,
                            0.7556250095367432,
                            0.7131249904632568,
                            0.7462499737739563,
                            0.6612499952316284
                        ]
                    },
                    "test": {
                        "score": 0.8606834878021319,
                        "pretrain_loss": 1.0900686383247375,
                        "pretrain_component": 0.6061721444129944,
                        "supervised_component": 0.48389649391174316,
                        "features_accuracy": [
                            0.5625,
                            0.7255000472068787,
                            0.5845000147819519,
                            0.5425000190734863,
                            0.6165000200271606,
                            0.7000000476837158,
                            0.753000020980835,
                            0.7550000548362732,
                            0.718000054359436,
                            0.765500009059906,
                            0.6630000472068787
                        ]
                    }
                },
                "80000": {
                    "train": {
                        "score": 0.8961660053355935,
                        "pretrain_loss": 1.0828819274902344,
                        "pretrain_component": 0.6106828451156616,
                        "supervised_component": 0.47219908237457275,
                        "features_accuracy": [
                            0.5751562118530273,
                            0.7178124785423279,
                            0.5690624713897705,
                            0.5178124904632568,
                            0.606249988079071,
                            0.699999988079071,
                            0.737500011920929,
                            0.7562499642372131,
                            0.7107812166213989,
                            0.7599999904632568,
                            0.6571874618530273
                        ]
                    },
                    "val": {
                        "score": 0.872037252843563,
                        "pretrain_loss": 1.087901383638382,
                        "pretrain_component": 0.6103200316429138,
                        "supervised_component": 0.47758135199546814,
                        "features_accuracy": [
                            0.5831249952316284,
                            0.7118749618530273,
                            0.5856249928474426,
                            0.5237500071525574,
                            0.5974999666213989,
                            0.7112500071525574,
                            0.7431249618530273,
                            0.7556250095367432,
                            0.7131249904632568,
                            0.7475000023841858,
                            0.6624999642372131
                        ]
                    },
                    "test": {
                        "score": 0.8597148766640291,
                        "pretrain_loss": 1.0910534262657166,
                        "pretrain_component": 0.6069208979606628,
                        "supervised_component": 0.4841325283050537,
                        "features_accuracy": [
                            0.5625,
                            0.7255000472068787,
                            0.5845000147819519,
                            0.5425000190734863,
                            0.6155000329017639,
                            0.6990000605583191,
                            0.7515000104904175,
                            0.7550000548362732,
                            0.7155000567436218,
                            0.76500004529953,
                            0.6630000472068787
                        ]
                    }
                },
                "90000": {
                    "train": {
                        "score": 0.9080442317323342,
                        "pretrain_loss": 1.083076387643814,
                        "pretrain_component": 0.6100292801856995,
                        "supervised_component": 0.4730471074581146,
                        "features_accuracy": [
                            0.5787500143051147,
                            0.7048437595367432,
                            0.561718761920929,
                            0.5271874666213989,
                            0.6082812547683716,
                            0.6967187523841858,
                            0.7668749690055847,
                            0.7587499618530273,
                            0.7043749690055847,
                            0.7481249570846558,
                            0.6410937309265137
                        ]
                    },
                    "val": {
                        "score": 0.8727234640906858,
                        "pretrain_loss": 1.0876681208610535,
                        "pretrain_component": 0.6098426580429077,
                        "supervised_component": 0.47782546281814575,
                        "features_accuracy": [
                            0.5837500095367432,
                            0.7118749618530273,
                            0.5868749618530273,
                            0.5231249928474426,
                            0.5893749594688416,
                            0.7106249928474426,
                            0.7425000071525574,
                            0.7556250095367432,
                            0.7131249904632568,
                            0.7456249594688416,
                            0.6606249809265137
                        ]
                    },
                    "test": {
                        "score": 0.8537952436257522,
                        "pretrain_loss": 1.0871630311012268,
                        "pretrain_component": 0.606217086315155,
                        "supervised_component": 0.4809459447860718,
                        "features_accuracy": [
                            0.5625,
                            0.7255000472068787,
                            0.5825000405311584,
                            0.5410000085830688,
                            0.6140000224113464,
                            0.7005000114440918,
                            0.7520000338554382,
                            0.7550000548362732,
                            0.7165000438690186,
                            0.765500009059906,
                            0.6695000529289246
                        ]
                    }
                },
                "100000": {
                    "train": {
                        "score": 0.8975987722838072,
                        "pretrain_loss": 1.0823367536067963,
                        "pretrain_component": 0.6107847094535828,
                        "supervised_component": 0.4715520441532135,
                        "features_accuracy": [
                            0.5785937309265137,
                            0.715624988079071,
                            0.5692187547683716,
                            0.5245312452316284,
                            0.6092187166213989,
                            0.6989062428474426,
                            0.7476562261581421,
                            0.7571874856948853,
                            0.7060937285423279,
                            0.7421875,
                            0.6521874666213989
                        ]
                    },
                    "val": {
                        "score": 0.873546917587233,
                        "pretrain_loss": 1.0854471325874329,
                        "pretrain_component": 0.6088942885398865,
                        "supervised_component": 0.4765528440475464,
                        "features_accuracy": [
                            0.5831249952316284,
                            0.7118749618530273,
                            0.5831249952316284,
                            0.5218749642372131,
                            0.5893749594688416,
                            0.7081249952316284,
                            0.7456249594688416,
                            0.7556250095367432,
                            0.7131249904632568,
                            0.7475000023841858,
                            0.6618750095367432
                        ]
                    },
                    "test": {
                        "score": 0.8610875899011492,
                        "pretrain_loss": 1.0883905589580536,
                        "pretrain_component": 0.6060876250267029,
                        "supervised_component": 0.4823029339313507,
                        "features_accuracy": [
                            0.5625,
                            0.7255000472068787,
                            0.5835000276565552,
                            0.5425000190734863,
                            0.6150000095367432,
                            0.7000000476837158,
                            0.752500057220459,
                            0.7550000548362732,
                            0.7170000076293945,
                            0.76500004529953,
                            0.6650000214576721
                        ]
                    }
                }
            },
            "train": {
                "score": 0.8975987722838072
            },
            "val": {
                "score": 0.873546917587233
            },
            "test": {
                "score": 0.8610875899011492
            }
        },
        "best_iteration": 100000,
        "time": "0:06:55",
        "trial_id": 94,
        "tuning_time": "9:08:42"
    },
    "time": "9:33:27",
    "continuations": [
        35
    ]
}
