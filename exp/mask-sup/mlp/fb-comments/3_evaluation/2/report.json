{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised___44f60819937d45f1bc3d10c1c30fbdae.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 2,
        "data": {
            "path": "data/fb-comments",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512,
                    512
                ],
                "dropout": 0.17268933438574993
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [],
            "d_num_embedding": null,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 512,
            "lr": 9.340061002994785e-05,
            "weight_decay": 0.0,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.30212150355754686,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 9.340061002994785e-05,
            "weight_decay": 0.0,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "epoch_size": 308,
    "n_parameters": 619572,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -4.355268732403213,
                    "pretrain_loss": 0.7745447754859924,
                    "pretrain_component": 0.32368186116218567,
                    "supervised_component": 0.45086291432380676,
                    "features_accuracy": [
                        0.7570446133613586,
                        0.81550133228302,
                        0.8696444034576416,
                        0.8711414933204651,
                        0.8885992169380188,
                        0.8786460161209106,
                        0.8668468594551086,
                        0.8804857134819031,
                        0.8728860020637512,
                        0.8804476261138916,
                        0.995806872844696,
                        0.786022424697876,
                        0.8588792085647583,
                        0.8785254955291748,
                        0.868464469909668,
                        0.8747700452804565,
                        0.8623745441436768,
                        0.8636115789413452,
                        0.6988924145698547,
                        0.8861949443817139,
                        0.887279748916626,
                        0.8214009404182434,
                        0.8140740394592285,
                        0.8313731551170349,
                        0.8262602090835571,
                        0.7318920493125916,
                        0.7168195843696594,
                        0.7020134925842285,
                        0.7481445074081421,
                        0.9889874458312988,
                        0.9346668124198914,
                        0.9954579472541809,
                        0.9262551069259644,
                        0.9233433604240417,
                        0.9200827479362488,
                        0.9245232939720154,
                        0.9236859083175659,
                        0.9290082454681396,
                        0.9260584712028503,
                        0.92889404296875,
                        0.9291414618492126,
                        0.926102876663208,
                        0.862006664276123,
                        0.9208122491836548,
                        0.9248848557472229,
                        0.9265849590301514,
                        0.8843172788619995,
                        0.8670181035995483,
                        0.8734695911407471,
                        0.9977607131004333,
                        0.7196298241615295
                    ]
                },
                "val": {
                    "score": -5.46376347248351,
                    "pretrain_loss": 0.7681045234203339,
                    "pretrain_component": 0.3246499001979828,
                    "supervised_component": 0.4434546232223511,
                    "features_accuracy": [
                        0.7565155625343323,
                        0.8143697381019592,
                        0.8693844079971313,
                        0.8693337440490723,
                        0.8882465958595276,
                        0.8789169192314148,
                        0.8685224652290344,
                        0.8780549168586731,
                        0.8742013573646545,
                        0.884494423866272,
                        0.9953351020812988,
                        0.7825270891189575,
                        0.8654801249504089,
                        0.881553590297699,
                        0.8687252402305603,
                        0.8733394145965576,
                        0.8598012328147888,
                        0.8701449632644653,
                        0.69749516248703,
                        0.8828212022781372,
                        0.885153591632843,
                        0.8241557478904724,
                        0.8094513416290283,
                        0.8294797539710999,
                        0.828769862651825,
                        0.7321265339851379,
                        0.7129094004631042,
                        0.699675440788269,
                        0.750380277633667,
                        0.987374484539032,
                        0.9350471496582031,
                        0.9947266578674316,
                        0.928759753704071,
                        0.9222187995910645,
                        0.9180610179901123,
                        0.9235878586769104,
                        0.9263259172439575,
                        0.9289625287055969,
                        0.9243484139442444,
                        0.9287090301513672,
                        0.9239428043365479,
                        0.9206976890563965,
                        0.8635026812553406,
                        0.9208498001098633,
                        0.9248554706573486,
                        0.9253625273704529,
                        0.8857113718986511,
                        0.8640604019165039,
                        0.8744041919708252,
                        0.9971604943275452,
                        0.7195517420768738
                    ]
                },
                "test": {
                    "score": -5.757346019264971,
                    "pretrain_loss": 0.7743297219276428,
                    "pretrain_component": 0.3229818046092987,
                    "supervised_component": 0.4513479173183441,
                    "features_accuracy": [
                        0.7577078938484192,
                        0.8125253319740295,
                        0.8698275685310364,
                        0.8733265995979309,
                        0.8870689868927002,
                        0.8773326873779297,
                        0.8693711757659912,
                        0.8819980025291443,
                        0.8721602559089661,
                        0.8852941393852234,
                        0.9962981939315796,
                        0.7872717976570129,
                        0.8548681735992432,
                        0.879462480545044,
                        0.8669878244400024,
                        0.8757606744766235,
                        0.8652637004852295,
                        0.8604969382286072,
                        0.7002535462379456,
                        0.888843834400177,
                        0.8858011960983276,
                        0.8252028226852417,
                        0.8096348643302917,
                        0.8295639157295227,
                        0.8290060758590698,
                        0.7354462742805481,
                        0.7210446000099182,
                        0.7018762826919556,
                        0.750608503818512,
                        0.988286018371582,
                        0.9368661046028137,
                        0.9958418011665344,
                        0.9248479008674622,
                        0.9239351153373718,
                        0.9204868078231812,
                        0.9249492883682251,
                        0.9241379499435425,
                        0.9316937327384949,
                        0.9300709962844849,
                        0.9295132160186768,
                        0.9301217198371887,
                        0.9259635210037231,
                        0.8662272095680237,
                        0.9196754693984985,
                        0.9250507354736328,
                        0.9252028465270996,
                        0.8846349120140076,
                        0.8689655065536499,
                        0.8735800981521606,
                        0.9981237649917603,
                        0.7183570265769958
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -4.261131258364291,
                    "pretrain_loss": 0.7320882976055145,
                    "pretrain_component": 0.2988113760948181,
                    "supervised_component": 0.4332769215106964,
                    "features_accuracy": [
                        0.7770271301269531,
                        0.8154696226119995,
                        0.8810058832168579,
                        0.8869372010231018,
                        0.8969982266426086,
                        0.8874192833900452,
                        0.8735013604164124,
                        0.8886499404907227,
                        0.8948603868484497,
                        0.8951839208602905,
                        0.9953057169914246,
                        0.801703929901123,
                        0.8737170100212097,
                        0.8896395564079285,
                        0.8830548524856567,
                        0.8867532014846802,
                        0.8805681467056274,
                        0.8789695501327515,
                        0.6986132860183716,
                        0.9049912095069885,
                        0.894619345664978,
                        0.8372854590415955,
                        0.8227965235710144,
                        0.8445552587509155,
                        0.8366256952285767,
                        0.7874687910079956,
                        0.7302617430686951,
                        0.7028000950813293,
                        0.7582689523696899,
                        0.9888161420822144,
                        0.9396021366119385,
                        0.9950900077819824,
                        0.9310826063156128,
                        0.9282914400100708,
                        0.9243900775909424,
                        0.9309747815132141,
                        0.9301183819770813,
                        0.9329159259796143,
                        0.9306005239486694,
                        0.9318692684173584,
                        0.9301120638847351,
                        0.9258681535720825,
                        0.8712366223335266,
                        0.9223411083221436,
                        0.9274921417236328,
                        0.9268133640289307,
                        0.8921833634376526,
                        0.887146532535553,
                        0.8840254545211792,
                        0.9977670311927795,
                        0.7195663452148438
                    ]
                },
                "val": {
                    "score": -5.492769140215893,
                    "pretrain_loss": 0.7250636518001556,
                    "pretrain_component": 0.2998560070991516,
                    "supervised_component": 0.42520764470100403,
                    "features_accuracy": [
                        0.7749720811843872,
                        0.8144204020500183,
                        0.8799816966056824,
                        0.887283205986023,
                        0.895700216293335,
                        0.8877902626991272,
                        0.8729337453842163,
                        0.8849508166313171,
                        0.8945847153663635,
                        0.8978298306465149,
                        0.9948787689208984,
                        0.7970793843269348,
                        0.8800831437110901,
                        0.8918973207473755,
                        0.8818578124046326,
                        0.8844437599182129,
                        0.8798803091049194,
                        0.8827197551727295,
                        0.69749516248703,
                        0.9025453329086304,
                        0.8923029899597168,
                        0.8388094305992126,
                        0.8178683519363403,
                        0.8452996611595154,
                        0.840026319026947,
                        0.7881046533584595,
                        0.7217827439308167,
                        0.699675440788269,
                        0.760217010974884,
                        0.9874758720397949,
                        0.9398133754730225,
                        0.9943210482597351,
                        0.9335259795188904,
                        0.9273906946182251,
                        0.9218131899833679,
                        0.9294189214706421,
                        0.9311935901641846,
                        0.932410478591919,
                        0.9277456402778625,
                        0.9310414791107178,
                        0.9265287518501282,
                        0.9226751327514648,
                        0.8713619112968445,
                        0.9232836365699768,
                        0.927441418170929,
                        0.9263765811920166,
                        0.89215087890625,
                        0.8854578137397766,
                        0.8843423128128052,
                        0.997211217880249,
                        0.7195010185241699
                    ]
                },
                "test": {
                    "score": -5.724716547801326,
                    "pretrain_loss": 0.7357271611690521,
                    "pretrain_component": 0.29823464155197144,
                    "supervised_component": 0.4374925196170807,
                    "features_accuracy": [
                        0.7784482836723328,
                        0.8124239444732666,
                        0.8816937208175659,
                        0.8890973925590515,
                        0.8951825499534607,
                        0.8872718214988708,
                        0.8747464418411255,
                        0.8913792967796326,
                        0.8927991986274719,
                        0.8970081210136414,
                        0.9953854084014893,
                        0.7994421720504761,
                        0.8696247339248657,
                        0.8908215165138245,
                        0.8801724314689636,
                        0.8871703743934631,
                        0.8825050592422485,
                        0.8760648965835571,
                        0.7002535462379456,
                        0.9070993661880493,
                        0.8926470875740051,
                        0.839959442615509,
                        0.8191683888435364,
                        0.8463488817214966,
                        0.8409736156463623,
                        0.7898580431938171,
                        0.7325050830841064,
                        0.7018762826919556,
                        0.763336718082428,
                        0.9886409640312195,
                        0.9415821433067322,
                        0.9949290156364441,
                        0.9316937327384949,
                        0.9283468723297119,
                        0.9245943427085876,
                        0.9301217198371887,
                        0.9298174381256104,
                        0.9367647171020508,
                        0.9335193037986755,
                        0.932251513004303,
                        0.93215012550354,
                        0.9270791411399841,
                        0.8737829923629761,
                        0.9229716062545776,
                        0.926673412322998,
                        0.9261663556098938,
                        0.8926470875740051,
                        0.8865618705749512,
                        0.8849391341209412,
                        0.9981237649917603,
                        0.7183570265769958
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -4.663788301294986,
                    "pretrain_loss": 0.7077493071556091,
                    "pretrain_component": 0.28313344717025757,
                    "supervised_component": 0.42461585998535156,
                    "features_accuracy": [
                        0.7845887541770935,
                        0.8154252171516418,
                        0.8876667022705078,
                        0.8946066498756409,
                        0.8995610475540161,
                        0.8916631937026978,
                        0.8797498345375061,
                        0.8938136696815491,
                        0.9014070630073547,
                        0.9076048135757446,
                        0.9952803254127502,
                        0.8026174306869507,
                        0.8791281580924988,
                        0.8953171372413635,
                        0.8876159191131592,
                        0.8910478353500366,
                        0.886074423789978,
                        0.8819003105163574,
                        0.7012332081794739,
                        0.9149063229560852,
                        0.8987300395965576,
                        0.8463378548622131,
                        0.8328005075454712,
                        0.8651911616325378,
                        0.8454497456550598,
                        0.8183369636535645,
                        0.7332876920700073,
                        0.7015250325202942,
                        0.7615105509757996,
                        0.989596426486969,
                        0.9421967267990112,
                        0.9949377775192261,
                        0.9340831637382507,
                        0.9326367974281311,
                        0.9283167719841003,
                        0.9350029826164246,
                        0.9339436292648315,
                        0.9391580820083618,
                        0.9364112615585327,
                        0.9376736879348755,
                        0.9369568228721619,
                        0.9316345453262329,
                        0.876406729221344,
                        0.9275301694869995,
                        0.9337913393974304,
                        0.9349268674850464,
                        0.8938707709312439,
                        0.8959578275680542,
                        0.8908956050872803,
                        0.997874915599823,
                        0.7383626103401184
                    ]
                },
                "val": {
                    "score": -5.523611754397228,
                    "pretrain_loss": 0.6979793906211853,
                    "pretrain_component": 0.28421711921691895,
                    "supervised_component": 0.41376227140426636,
                    "features_accuracy": [
                        0.7812594771385193,
                        0.8144204020500183,
                        0.8881958723068237,
                        0.8950917720794678,
                        0.8993509411811829,
                        0.8930635452270508,
                        0.8816042542457581,
                        0.890781819820404,
                        0.9014298319816589,
                        0.909745454788208,
                        0.9949802160263062,
                        0.8002737760543823,
                        0.883733868598938,
                        0.8989453315734863,
                        0.8882973194122314,
                        0.8896663188934326,
                        0.8844437599182129,
                        0.8850522041320801,
                        0.69749516248703,
                        0.9132440686225891,
                        0.8975256085395813,
                        0.8463137149810791,
                        0.825879693031311,
                        0.8609167337417603,
                        0.8462123274803162,
                        0.8185782432556152,
                        0.7259912490844727,
                        0.699675440788269,
                        0.7635127902030945,
                        0.988033652305603,
                        0.9424500465393066,
                        0.9948281049728394,
                        0.937278151512146,
                        0.9311935901641846,
                        0.9262751936912537,
                        0.9324612021446228,
                        0.9349964261054993,
                        0.9379879832267761,
                        0.9353513717651367,
                        0.9360105395317078,
                        0.9326639771461487,
                        0.9284555315971375,
                        0.8759253621101379,
                        0.9281005859375,
                        0.9350471496582031,
                        0.9335259795188904,
                        0.8952438831329346,
                        0.8936213254928589,
                        0.8916945457458496,
                        0.9972619414329529,
                        0.7392759323120117
                    ]
                },
                "test": {
                    "score": -5.774461050555665,
                    "pretrain_loss": 0.7103744447231293,
                    "pretrain_component": 0.2826896905899048,
                    "supervised_component": 0.4276847541332245,
                    "features_accuracy": [
                        0.7851927280426025,
                        0.8124239444732666,
                        0.886713981628418,
                        0.8968560099601746,
                        0.8984280228614807,
                        0.8914300203323364,
                        0.8823529481887817,
                        0.8967545628547668,
                        0.8985294103622437,
                        0.9098377227783203,
                        0.9958925247192383,
                        0.8024848103523254,
                        0.8744422197341919,
                        0.8952332735061646,
                        0.885598361492157,
                        0.8918864130973816,
                        0.8889959454536438,
                        0.8805781006813049,
                        0.7002535462379456,
                        0.9170385599136353,
                        0.8962981700897217,
                        0.8458924889564514,
                        0.8268255591392517,
                        0.8652129769325256,
                        0.8465009927749634,
                        0.8210446238517761,
                        0.7357504963874817,
                        0.7018762826919556,
                        0.7647566199302673,
                        0.9890466332435608,
                        0.9439148306846619,
                        0.9953854084014893,
                        0.9347870349884033,
                        0.9325050711631775,
                        0.929411768913269,
                        0.933874249458313,
                        0.933874249458313,
                        0.9402636885643005,
                        0.9396044611930847,
                        0.9364097118377686,
                        0.937778890132904,
                        0.9317951202392578,
                        0.8771805167198181,
                        0.9284989833831787,
                        0.9331642985343933,
                        0.9336206912994385,
                        0.8948783278465271,
                        0.895588219165802,
                        0.8906693458557129,
                        0.9981237649917603,
                        0.7403650879859924
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -4.682241330333445,
                    "pretrain_loss": 0.6748906373977661,
                    "pretrain_component": 0.27160802483558655,
                    "supervised_component": 0.40328261256217957,
                    "features_accuracy": [
                        0.7886106371879578,
                        0.8150319457054138,
                        0.893553614616394,
                        0.8982732892036438,
                        0.9045978784561157,
                        0.8962369561195374,
                        0.8899694681167603,
                        0.9000558257102966,
                        0.9100915193557739,
                        0.9151093363761902,
                        0.9954389333724976,
                        0.806569516658783,
                        0.8893033862113953,
                        0.8996625542640686,
                        0.895018994808197,
                        0.8953044414520264,
                        0.8965858817100525,
                        0.8893858194351196,
                        0.6988797187805176,
                        0.9208756685256958,
                        0.906152069568634,
                        0.8569570779800415,
                        0.8384082913398743,
                        0.8776881098747253,
                        0.8540517091751099,
                        0.8373234868049622,
                        0.7370177507400513,
                        0.7039610147476196,
                        0.7645047903060913,
                        0.9895583987236023,
                        0.9444867372512817,
                        0.9957117438316345,
                        0.9370329976081848,
                        0.9323767423629761,
                        0.9300739765167236,
                        0.9360750913619995,
                        0.935776948928833,
                        0.9391200542449951,
                        0.9377180933952332,
                        0.9390565752983093,
                        0.9383207559585571,
                        0.9344066977500916,
                        0.8816972970962524,
                        0.9299471378326416,
                        0.9360116124153137,
                        0.9370456337928772,
                        0.8973153829574585,
                        0.8998718857765198,
                        0.8976516127586365,
                        0.9979446530342102,
                        0.7655007243156433
                    ]
                },
                "val": {
                    "score": -5.535695278567249,
                    "pretrain_loss": 0.6777770519256592,
                    "pretrain_component": 0.2726004421710968,
                    "supervised_component": 0.4051766097545624,
                    "features_accuracy": [
                        0.7841496467590332,
                        0.8144204020500183,
                        0.8942804932594299,
                        0.8976777195930481,
                        0.9028496146202087,
                        0.8976777195930481,
                        0.8922522664070129,
                        0.8984382748603821,
                        0.9094918966293335,
                        0.9180102944374084,
                        0.995182991027832,
                        0.8029611110687256,
                        0.8925058245658875,
                        0.9038130044937134,
                        0.893570601940155,
                        0.8933171033859253,
                        0.8924043774604797,
                        0.8941283822059631,
                        0.69749516248703,
                        0.9187709093093872,
                        0.9026467800140381,
                        0.8571645617485046,
                        0.8318121433258057,
                        0.8735421895980835,
                        0.8541222810745239,
                        0.837085485458374,
                        0.732025146484375,
                        0.699675440788269,
                        0.7662001848220825,
                        0.9885407090187073,
                        0.9447317719459534,
                        0.9950816035270691,
                        0.9390020966529846,
                        0.9328668117523193,
                        0.9279991388320923,
                        0.9351485371589661,
                        0.9372274279594421,
                        0.9396612644195557,
                        0.936517596244812,
                        0.9370753169059753,
                        0.9353513717651367,
                        0.9315484762191772,
                        0.8812493681907654,
                        0.9298245310783386,
                        0.9359598159790039,
                        0.9350978136062622,
                        0.8969678282737732,
                        0.8972720503807068,
                        0.8972213268280029,
                        0.997211217880249,
                        0.7634621262550354
                    ]
                },
                "test": {
                    "score": -5.764529110783725,
                    "pretrain_loss": 0.6908292770385742,
                    "pretrain_component": 0.2710738480091095,
                    "supervised_component": 0.4197554290294647,
                    "features_accuracy": [
                        0.7883874177932739,
                        0.8124239444732666,
                        0.8935091495513916,
                        0.9009634852409363,
                        0.9034990072250366,
                        0.8963488936424255,
                        0.8914300203323364,
                        0.9043610692024231,
                        0.9087221026420593,
                        0.9192190766334534,
                        0.9963995814323425,
                        0.8048174381256104,
                        0.8839249610900879,
                        0.9004563689231873,
                        0.8918356895446777,
                        0.896095335483551,
                        0.8956389427185059,
                        0.8887423872947693,
                        0.7002535462379456,
                        0.9247464537620544,
                        0.9029411673545837,
                        0.8584685921669006,
                        0.8357505202293396,
                        0.8774340748786926,
                        0.8553245663642883,
                        0.8403651118278503,
                        0.7405679821968079,
                        0.7018762826919556,
                        0.7666328549385071,
                        0.9893001914024353,
                        0.9472616910934448,
                        0.9960446357727051,
                        0.9381338953971863,
                        0.9335193037986755,
                        0.9309330582618713,
                        0.9355983734130859,
                        0.9355476498603821,
                        0.9412271976470947,
                        0.9407708048820496,
                        0.9390973448753357,
                        0.9406186938285828,
                        0.9349391460418701,
                        0.8815416097640991,
                        0.92890465259552,
                        0.9369675517082214,
                        0.9356998205184937,
                        0.8981237411499023,
                        0.9002535343170166,
                        0.8956896662712097,
                        0.9981744289398193,
                        0.7657707929611206
                    ]
                }
            }
        },
        "train": {
            "score": -4.355268732403213
        },
        "val": {
            "score": -5.46376347248351
        },
        "test": {
            "score": -5.757346019264971
        }
    },
    "best_iteration": 10000,
    "time": "0:07:59"
}
