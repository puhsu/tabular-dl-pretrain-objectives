{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised___44f60819937d45f1bc3d10c1c30fbdae.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 11,
        "data": {
            "path": "data/fb-comments",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512,
                    512
                ],
                "dropout": 0.17268933438574993
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [],
            "d_num_embedding": null,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 512,
            "lr": 9.340061002994785e-05,
            "weight_decay": 0.0,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.30212150355754686,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 9.340061002994785e-05,
            "weight_decay": 0.0,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "epoch_size": 308,
    "n_parameters": 619572,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -4.232969739547646,
                    "pretrain_loss": 0.7690010070800781,
                    "pretrain_component": 0.3226358890533447,
                    "supervised_component": 0.4463651180267334,
                    "features_accuracy": [
                        0.7628554105758667,
                        0.815704345703125,
                        0.8665613532066345,
                        0.8762481212615967,
                        0.8925639986991882,
                        0.8833212852478027,
                        0.8685659766197205,
                        0.884145975112915,
                        0.8788553476333618,
                        0.8827821016311646,
                        0.9951788187026978,
                        0.7877288460731506,
                        0.8655654191970825,
                        0.8846027255058289,
                        0.8700250387191772,
                        0.8794453144073486,
                        0.8643220663070679,
                        0.8686738014221191,
                        0.700046956539154,
                        0.8804730176925659,
                        0.88660728931427,
                        0.8121836185455322,
                        0.8129829168319702,
                        0.8233547806739807,
                        0.8184764981269836,
                        0.7382737994194031,
                        0.714447021484375,
                        0.7024575471878052,
                        0.7475228309631348,
                        0.9881881475448608,
                        0.9348190426826477,
                        0.9955848455429077,
                        0.9262107014656067,
                        0.9222015142440796,
                        0.921820878982544,
                        0.9256841540336609,
                        0.9236288666725159,
                        0.9283104538917542,
                        0.9279361963272095,
                        0.9303086996078491,
                        0.930162787437439,
                        0.9246945977210999,
                        0.8613024950027466,
                        0.9211040735244751,
                        0.925969660282135,
                        0.9253796935081482,
                        0.8840381503105164,
                        0.8679760098457336,
                        0.8769268989562988,
                        0.9978812336921692,
                        0.7196742296218872
                    ]
                },
                "val": {
                    "score": -5.420279525782899,
                    "pretrain_loss": 0.7538646161556244,
                    "pretrain_component": 0.323263943195343,
                    "supervised_component": 0.43060067296028137,
                    "features_accuracy": [
                        0.7638677358627319,
                        0.8182739615440369,
                        0.8634012341499329,
                        0.8780549168586731,
                        0.8953959941864014,
                        0.882973313331604,
                        0.8673562407493591,
                        0.8800324201583862,
                        0.8796268105506897,
                        0.8874860405921936,
                        0.995182991027832,
                        0.7896257638931274,
                        0.8691309094429016,
                        0.8828718662261963,
                        0.872376024723053,
                        0.8802352547645569,
                        0.8666463494300842,
                        0.8640097379684448,
                        0.6963289380073547,
                        0.8783084750175476,
                        0.8854071497917175,
                        0.8140655159950256,
                        0.8114288449287415,
                        0.8229387998580933,
                        0.821671187877655,
                        0.7350674271583557,
                        0.7146840691566467,
                        0.7073826193809509,
                        0.7460196614265442,
                        0.9883378744125366,
                        0.9368724822998047,
                        0.9947773814201355,
                        0.9235371351242065,
                        0.9220666885375977,
                        0.9235371351242065,
                        0.9252104163169861,
                        0.925413191318512,
                        0.923232913017273,
                        0.9292668104171753,
                        0.9262751936912537,
                        0.9251089692115784,
                        0.9277963638305664,
                        0.8593448996543884,
                        0.9241963028907776,
                        0.9262244701385498,
                        0.9261738061904907,
                        0.8796268105506897,
                        0.8687759637832642,
                        0.8786126971244812,
                        0.997312605381012,
                        0.7174221277236938
                    ]
                },
                "test": {
                    "score": -5.684433166075837,
                    "pretrain_loss": 0.7577877938747406,
                    "pretrain_component": 0.32358938455581665,
                    "supervised_component": 0.43419840931892395,
                    "features_accuracy": [
                        0.7580628991127014,
                        0.8146551847457886,
                        0.866125762462616,
                        0.8786511421203613,
                        0.8936105370521545,
                        0.8843306303024292,
                        0.8624746203422546,
                        0.8808823823928833,
                        0.8794117569923401,
                        0.883367121219635,
                        0.9956389665603638,
                        0.7856997847557068,
                        0.8660750389099121,
                        0.8846855759620667,
                        0.8712981939315796,
                        0.875,
                        0.8641480803489685,
                        0.8670892715454102,
                        0.6964502930641174,
                        0.8805781006813049,
                        0.8838235139846802,
                        0.8133367300033569,
                        0.8169878125190735,
                        0.8275355100631714,
                        0.8196247220039368,
                        0.7391988039016724,
                        0.7109026312828064,
                        0.7037018537521362,
                        0.7448782920837402,
                        0.9889452457427979,
                        0.9341278076171875,
                        0.994979739189148,
                        0.9254056811332703,
                        0.9274340867996216,
                        0.9153650999069214,
                        0.9265720248222351,
                        0.923275887966156,
                        0.9282961487770081,
                        0.9296146035194397,
                        0.9277383685112,
                        0.9309330582618713,
                        0.9236308336257935,
                        0.8606997728347778,
                        0.9204868078231812,
                        0.9228701591491699,
                        0.9261663556098938,
                        0.8820993900299072,
                        0.8669878244400024,
                        0.8771805167198181,
                        0.998275876045227,
                        0.7188640832901001
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -4.131927462392408,
                    "pretrain_loss": 0.7194291651248932,
                    "pretrain_component": 0.2986011207103729,
                    "supervised_component": 0.42082804441452026,
                    "features_accuracy": [
                        0.7806683778762817,
                        0.8166558742523193,
                        0.875537633895874,
                        0.8935916423797607,
                        0.8986221551895142,
                        0.8880282640457153,
                        0.877738893032074,
                        0.8958626985549927,
                        0.8937248587608337,
                        0.8895507454872131,
                        0.9947728514671326,
                        0.8015580177307129,
                        0.8727210760116577,
                        0.8921389579772949,
                        0.8774343729019165,
                        0.8876857161521912,
                        0.8720930218696594,
                        0.8735013604164124,
                        0.6992857456207275,
                        0.9067357182502747,
                        0.8973280787467957,
                        0.8365305662155151,
                        0.8235514163970947,
                        0.8504548668861389,
                        0.8349636793136597,
                        0.7844999432563782,
                        0.7256118655204773,
                        0.7047666311264038,
                        0.7607873678207397,
                        0.9888986349105835,
                        0.9391897916793823,
                        0.9951471090316772,
                        0.9278410077095032,
                        0.9244598746299744,
                        0.9229310154914856,
                        0.928494393825531,
                        0.928760826587677,
                        0.9314125180244446,
                        0.9321737289428711,
                        0.9341339468955994,
                        0.9336898922920227,
                        0.929236650466919,
                        0.8777769207954407,
                        0.9240982532501221,
                        0.9269148707389832,
                        0.9304355978965759,
                        0.8936741352081299,
                        0.8796166181564331,
                        0.8865184783935547,
                        0.9977480173110962,
                        0.7184244990348816
                    ]
                },
                "val": {
                    "score": -5.469422844743709,
                    "pretrain_loss": 0.7094821035861969,
                    "pretrain_component": 0.29925650358200073,
                    "supervised_component": 0.41022560000419617,
                    "features_accuracy": [
                        0.7803974747657776,
                        0.8178683519363403,
                        0.872376024723053,
                        0.8984889984130859,
                        0.8978298306465149,
                        0.8888043761253357,
                        0.8758746385574341,
                        0.8927085995674133,
                        0.8950917720794678,
                        0.8939255475997925,
                        0.994422435760498,
                        0.8038738369941711,
                        0.8755704164505005,
                        0.8903762102127075,
                        0.8776493072509766,
                        0.8874353170394897,
                        0.8740999698638916,
                        0.8711590766906738,
                        0.6963289380073547,
                        0.9081228971481323,
                        0.8983875513076782,
                        0.8360206484794617,
                        0.8225839138031006,
                        0.8519419431686401,
                        0.8351587057113647,
                        0.7833383679389954,
                        0.7274616956710815,
                        0.7073826193809509,
                        0.7577831745147705,
                        0.9885913729667664,
                        0.9405739307403564,
                        0.994422435760498,
                        0.9257681369781494,
                        0.9242976903915405,
                        0.9270357489585876,
                        0.9290639758110046,
                        0.9297231435775757,
                        0.9266301393508911,
                        0.9336273670196533,
                        0.9321569800376892,
                        0.9299259185791016,
                        0.932309091091156,
                        0.8727816343307495,
                        0.9268329739570618,
                        0.9285061955451965,
                        0.9304836988449097,
                        0.8876381516456604,
                        0.8782577514648438,
                        0.8892099857330322,
                        0.9972619414329529,
                        0.7176249623298645
                    ]
                },
                "test": {
                    "score": -5.682599592361025,
                    "pretrain_loss": 0.7174077928066254,
                    "pretrain_component": 0.299751877784729,
                    "supervised_component": 0.41765591502189636,
                    "features_accuracy": [
                        0.7768762707710266,
                        0.8140973448753357,
                        0.8768255710601807,
                        0.895588219165802,
                        0.8968560099601746,
                        0.8887423872947693,
                        0.8720588088035583,
                        0.8931541442871094,
                        0.8932555913925171,
                        0.8906186819076538,
                        0.9951318502426147,
                        0.8005577921867371,
                        0.8723123669624329,
                        0.8920892477035522,
                        0.8766734600067139,
                        0.8838235139846802,
                        0.8710446357727051,
                        0.8754056692123413,
                        0.6964502930641174,
                        0.9054766893386841,
                        0.8963488936424255,
                        0.8347362875938416,
                        0.8271805047988892,
                        0.850557804107666,
                        0.8324036598205566,
                        0.7839756608009338,
                        0.7203347086906433,
                        0.7037018537521362,
                        0.7582150101661682,
                        0.9889959692955017,
                        0.937728226184845,
                        0.9943711757659912,
                        0.9270284175872803,
                        0.9303752779960632,
                        0.9184077382087708,
                        0.9303752779960632,
                        0.9280425906181335,
                        0.931643009185791,
                        0.9347870349884033,
                        0.9322007894515991,
                        0.9350405931472778,
                        0.9290568232536316,
                        0.8743407726287842,
                        0.9242900609970093,
                        0.9260649085044861,
                        0.9288032650947571,
                        0.8905172348022461,
                        0.8775355219841003,
                        0.8876774907112122,
                        0.998275876045227,
                        0.718813419342041
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -4.003238291388558,
                    "pretrain_loss": 0.7036741673946381,
                    "pretrain_component": 0.28490403294563293,
                    "supervised_component": 0.4187701344490051,
                    "features_accuracy": [
                        0.7830091714859009,
                        0.815311074256897,
                        0.877402663230896,
                        0.9021999835968018,
                        0.8991042971611023,
                        0.8913079500198364,
                        0.8820399045944214,
                        0.9064121842384338,
                        0.8979687690734863,
                        0.8935155272483826,
                        0.9954262375831604,
                        0.8025476336479187,
                        0.8771172165870667,
                        0.8966556191444397,
                        0.8798322677612305,
                        0.8918725252151489,
                        0.8740468621253967,
                        0.8781068325042725,
                        0.6994950771331787,
                        0.9165493249893188,
                        0.9021301865577698,
                        0.8412946462631226,
                        0.8284360766410828,
                        0.8645123839378357,
                        0.8422968983650208,
                        0.817639172077179,
                        0.7328753471374512,
                        0.7022862434387207,
                        0.763413667678833,
                        0.9896852374076843,
                        0.9415813684463501,
                        0.9951027035713196,
                        0.9325289726257324,
                        0.9319390058517456,
                        0.9296045303344727,
                        0.9345653057098389,
                        0.9357642531394958,
                        0.9381113648414612,
                        0.9352186918258667,
                        0.938168466091156,
                        0.9369568228721619,
                        0.9328081011772156,
                        0.8814055323600769,
                        0.9282850623130798,
                        0.9315710663795471,
                        0.9329476356506348,
                        0.8978102207183838,
                        0.8824077844619751,
                        0.8889227509498596,
                        0.9976592063903809,
                        0.742130696773529
                    ]
                },
                "val": {
                    "score": -5.466323732953206,
                    "pretrain_loss": 0.692537784576416,
                    "pretrain_component": 0.28549692034721375,
                    "supervised_component": 0.40704086422920227,
                    "features_accuracy": [
                        0.7837440371513367,
                        0.8178683519363403,
                        0.8766351938247681,
                        0.9051312804222107,
                        0.9013791680335999,
                        0.8915424346923828,
                        0.8811479210853577,
                        0.9043200016021729,
                        0.898539662361145,
                        0.895598828792572,
                        0.9948787689208984,
                        0.8026062250137329,
                        0.879423975944519,
                        0.8963086605072021,
                        0.8813000321388245,
                        0.8903762102127075,
                        0.8764830827713013,
                        0.8743028044700623,
                        0.6963289380073547,
                        0.915373682975769,
                        0.9031538367271423,
                        0.8432714343070984,
                        0.8257275819778442,
                        0.864719569683075,
                        0.8439306020736694,
                        0.8166514039039612,
                        0.7344589829444885,
                        0.7073826193809509,
                        0.7591521739959717,
                        0.9887434840202332,
                        0.9435148239135742,
                        0.9940168261528015,
                        0.9315991997718811,
                        0.928861141204834,
                        0.932410478591919,
                        0.933728814125061,
                        0.9350471496582031,
                        0.9326639771461487,
                        0.937278151512146,
                        0.9354020357131958,
                        0.9339823126792908,
                        0.9356048703193665,
                        0.8775479197502136,
                        0.9309907555580139,
                        0.932410478591919,
                        0.932968258857727,
                        0.8945339918136597,
                        0.8828212022781372,
                        0.8925058245658875,
                        0.9973633289337158,
                        0.7398843765258789
                    ]
                },
                "test": {
                    "score": -5.73756262117413,
                    "pretrain_loss": 0.6975116431713104,
                    "pretrain_component": 0.2859712541103363,
                    "supervised_component": 0.4115403890609741,
                    "features_accuracy": [
                        0.7797160148620605,
                        0.8140973448753357,
                        0.8792089223861694,
                        0.9037018418312073,
                        0.8985294103622437,
                        0.8924442529678345,
                        0.8758113384246826,
                        0.9056288003921509,
                        0.8975152373313904,
                        0.8920385241508484,
                        0.9953854084014893,
                        0.7988336682319641,
                        0.8770284056663513,
                        0.8969066739082336,
                        0.8798681497573853,
                        0.8892495036125183,
                        0.8738336563110352,
                        0.8789046406745911,
                        0.6964502930641174,
                        0.9162778854370117,
                        0.9029918909072876,
                        0.841582179069519,
                        0.8326064944267273,
                        0.8660243153572083,
                        0.8395537734031677,
                        0.8176977634429932,
                        0.7322008013725281,
                        0.7037018537521362,
                        0.7600913047790527,
                        0.9896044731140137,
                        0.9395030736923218,
                        0.9943711757659912,
                        0.9303245544433594,
                        0.9350405931472778,
                        0.9259635210037231,
                        0.9365618824958801,
                        0.9339249730110168,
                        0.9382352828979492,
                        0.9372718334197998,
                        0.9344320297241211,
                        0.9379817247390747,
                        0.9331642985343933,
                        0.8806794881820679,
                        0.9288539886474609,
                        0.9287018179893494,
                        0.9326065182685852,
                        0.8970081210136414,
                        0.8820486664772034,
                        0.8885395526885986,
                        0.998275876045227,
                        0.7426470518112183
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -4.1777389788183115,
                    "pretrain_loss": 0.6827694773674011,
                    "pretrain_component": 0.2730501890182495,
                    "supervised_component": 0.4097192883491516,
                    "features_accuracy": [
                        0.7874941229820251,
                        0.815108060836792,
                        0.8856367468833923,
                        0.9091399312019348,
                        0.9017559289932251,
                        0.8989583849906921,
                        0.8912889361381531,
                        0.9148555994033813,
                        0.9007599949836731,
                        0.8992565274238586,
                        0.9957307577133179,
                        0.8042730689048767,
                        0.8841840624809265,
                        0.9018764495849609,
                        0.887945830821991,
                        0.9004808664321899,
                        0.881951093673706,
                        0.8802509903907776,
                        0.6988416910171509,
                        0.9226265549659729,
                        0.9110684394836426,
                        0.8569570779800415,
                        0.8342912197113037,
                        0.8766287565231323,
                        0.8560689687728882,
                        0.835921585559845,
                        0.7389144897460938,
                        0.6998122334480286,
                        0.7619609832763672,
                        0.9894759058952332,
                        0.945381224155426,
                        0.9954579472541809,
                        0.9359228014945984,
                        0.9339943528175354,
                        0.9317930936813354,
                        0.9350156784057617,
                        0.9358847737312317,
                        0.9392849802970886,
                        0.9388980269432068,
                        0.9398495554924011,
                        0.9395197033882141,
                        0.9348697662353516,
                        0.8844695091247559,
                        0.9309937953948975,
                        0.9350346922874451,
                        0.937172532081604,
                        0.8997196555137634,
                        0.8866643905639648,
                        0.896287739276886,
                        0.9978305101394653,
                        0.7677463889122009
                    ]
                },
                "val": {
                    "score": -5.48353415007656,
                    "pretrain_loss": 0.6719595789909363,
                    "pretrain_component": 0.27394819259643555,
                    "supervised_component": 0.39801138639450073,
                    "features_accuracy": [
                        0.7892201542854309,
                        0.8178683519363403,
                        0.8832775354385376,
                        0.9116722345352173,
                        0.9026467800140381,
                        0.8972720503807068,
                        0.8881958723068237,
                        0.9135482907295227,
                        0.9004157781600952,
                        0.9025960564613342,
                        0.995132327079773,
                        0.806104838848114,
                        0.8868268728256226,
                        0.9004157781600952,
                        0.8879930973052979,
                        0.8983875513076782,
                        0.8834296464920044,
                        0.8776493072509766,
                        0.6962782740592957,
                        0.9202920198440552,
                        0.9118750095367432,
                        0.8549842834472656,
                        0.8326741456985474,
                        0.878764808177948,
                        0.8580772280693054,
                        0.8358178734779358,
                        0.7411012649536133,
                        0.7073826193809509,
                        0.7605212330818176,
                        0.9890477657318115,
                        0.9463542699813843,
                        0.9946252703666687,
                        0.9353513717651367,
                        0.9326133131980896,
                        0.9338809251785278,
                        0.9357569813728333,
                        0.9357569813728333,
                        0.933728814125061,
                        0.9397626519203186,
                        0.9391034841537476,
                        0.936517596244812,
                        0.9377344846725464,
                        0.8798295855522156,
                        0.9327147006988525,
                        0.936618983745575,
                        0.9371260404586792,
                        0.8965622186660767,
                        0.8856099247932434,
                        0.8995030522346497,
                        0.997312605381012,
                        0.767315685749054
                    ]
                },
                "test": {
                    "score": -5.718010755536006,
                    "pretrain_loss": 0.675939679145813,
                    "pretrain_component": 0.2742697596549988,
                    "supervised_component": 0.4016699194908142,
                    "features_accuracy": [
                        0.7865111827850342,
                        0.8140973448753357,
                        0.8884381651878357,
                        0.9108012318611145,
                        0.9008620977401733,
                        0.8997464776039124,
                        0.8847362995147705,
                        0.9142494797706604,
                        0.8991379141807556,
                        0.898833692073822,
                        0.9957403540611267,
                        0.8000507354736328,
                        0.8847870230674744,
                        0.900557816028595,
                        0.8868154287338257,
                        0.897819459438324,
                        0.8815922737121582,
                        0.8814908862113953,
                        0.6964502930641174,
                        0.9213995933532715,
                        0.9111054539680481,
                        0.8546146154403687,
                        0.8372718095779419,
                        0.8802231550216675,
                        0.8529918789863586,
                        0.836105465888977,
                        0.7367647290229797,
                        0.7037018537521362,
                        0.7585192918777466,
                        0.9898073077201843,
                        0.9434584379196167,
                        0.9949290156364441,
                        0.9327079057693481,
                        0.9384381175041199,
                        0.9267241358757019,
                        0.9372718334197998,
                        0.9346855878829956,
                        0.9404665231704712,
                        0.9396551847457886,
                        0.937728226184845,
                        0.9407200813293457,
                        0.9349391460418701,
                        0.8829107284545898,
                        0.931643009185791,
                        0.9335193037986755,
                        0.9356998205184937,
                        0.8996957540512085,
                        0.8864604234695435,
                        0.8961460590362549,
                        0.998275876045227,
                        0.7671399712562561
                    ]
                }
            }
        },
        "train": {
            "score": -4.232969739547646
        },
        "val": {
            "score": -5.420279525782899
        },
        "test": {
            "score": -5.684433166075837
        }
    },
    "best_iteration": 10000,
    "time": "0:09:20"
}
