{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised___44f60819937d45f1bc3d10c1c30fbdae.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 14,
        "data": {
            "path": "data/fb-comments",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512,
                    512
                ],
                "dropout": 0.17268933438574993
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [],
            "d_num_embedding": null,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 512,
            "lr": 9.340061002994785e-05,
            "weight_decay": 0.0,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.30212150355754686,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 9.340061002994785e-05,
            "weight_decay": 0.0,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "epoch_size": 308,
    "n_parameters": 619572,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -4.385721355734469,
                    "pretrain_loss": 0.7671623826026917,
                    "pretrain_component": 0.32266637682914734,
                    "supervised_component": 0.4444960057735443,
                    "features_accuracy": [
                        0.7512909770011902,
                        0.8157170414924622,
                        0.8627741932868958,
                        0.8826932907104492,
                        0.8901343941688538,
                        0.8773519396781921,
                        0.8673226237297058,
                        0.8836575150489807,
                        0.8803144097328186,
                        0.883682906627655,
                        0.9957751631736755,
                        0.786618709564209,
                        0.8656542301177979,
                        0.8842982053756714,
                        0.8706340193748474,
                        0.8805237412452698,
                        0.8618480563163757,
                        0.8672401309013367,
                        0.6980233192443848,
                        0.877802312374115,
                        0.8857064843177795,
                        0.8219401836395264,
                        0.8111940026283264,
                        0.8321724534034729,
                        0.8202146887779236,
                        0.7375696301460266,
                        0.7199659943580627,
                        0.703707218170166,
                        0.744198739528656,
                        0.9890064597129822,
                        0.9349839687347412,
                        0.9954706430435181,
                        0.9260647892951965,
                        0.9230325222015381,
                        0.9198861122131348,
                        0.9247834086418152,
                        0.9238255023956299,
                        0.9285070896148682,
                        0.9265976548194885,
                        0.9308352470397949,
                        0.928304135799408,
                        0.924770712852478,
                        0.8641634583473206,
                        0.9204570055007935,
                        0.9253987073898315,
                        0.9274540543556213,
                        0.877872109413147,
                        0.866199791431427,
                        0.8778150081634521,
                        0.9976655840873718,
                        0.7203212380409241
                    ]
                },
                "val": {
                    "score": -5.428623851009113,
                    "pretrain_loss": 0.7624015212059021,
                    "pretrain_component": 0.3224737346172333,
                    "supervised_component": 0.4399277865886688,
                    "features_accuracy": [
                        0.7494675517082214,
                        0.8173612952232361,
                        0.8650745153427124,
                        0.8839367032051086,
                        0.8873339295387268,
                        0.8793225884437561,
                        0.8716661334037781,
                        0.8842916488647461,
                        0.8771929740905762,
                        0.8812493681907654,
                        0.9955886602401733,
                        0.7914511561393738,
                        0.8670012950897217,
                        0.8863705396652222,
                        0.8725787997245789,
                        0.879525363445282,
                        0.858381450176239,
                        0.8712605237960815,
                        0.6922218799591064,
                        0.8771929740905762,
                        0.8864212036132812,
                        0.8192880749702454,
                        0.8085386753082275,
                        0.8306459784507751,
                        0.8200486302375793,
                        0.7382618188858032,
                        0.7154953479766846,
                        0.7058614492416382,
                        0.74338299036026,
                        0.9889463186264038,
                        0.9367710947990417,
                        0.9947266578674316,
                        0.9279484748840332,
                        0.926731526851654,
                        0.9221681356430054,
                        0.9227258563041687,
                        0.928861141204834,
                        0.9276949167251587,
                        0.9270357489585876,
                        0.927340030670166,
                        0.9297231435775757,
                        0.9257174730300903,
                        0.861829400062561,
                        0.9194807410240173,
                        0.9257681369781494,
                        0.9239934682846069,
                        0.8780549168586731,
                        0.8659365177154541,
                        0.879423975944519,
                        0.9975154399871826,
                        0.7216813564300537
                    ]
                },
                "test": {
                    "score": -5.690652709508123,
                    "pretrain_loss": 0.7741067111492157,
                    "pretrain_component": 0.32240965962409973,
                    "supervised_component": 0.45169705152511597,
                    "features_accuracy": [
                        0.7491886615753174,
                        0.8156693577766418,
                        0.8634381294250488,
                        0.8841785192489624,
                        0.8885902762413025,
                        0.8767748475074768,
                        0.867241382598877,
                        0.8818458318710327,
                        0.8787018060684204,
                        0.8856490850448608,
                        0.9960446357727051,
                        0.786156177520752,
                        0.8656693696975708,
                        0.8884381651878357,
                        0.8720081448554993,
                        0.8777890801429749,
                        0.8587220907211304,
                        0.8683062791824341,
                        0.6939148306846619,
                        0.8796145915985107,
                        0.8843306303024292,
                        0.8235294222831726,
                        0.807758629322052,
                        0.8365618586540222,
                        0.8199290037155151,
                        0.7402637004852295,
                        0.7158722281455994,
                        0.7100405693054199,
                        0.7442190647125244,
                        0.9895537495613098,
                        0.9351927042007446,
                        0.9965010285377502,
                        0.9280933141708374,
                        0.920537531375885,
                        0.918914794921875,
                        0.9245943427085876,
                        0.9243407845497131,
                        0.9281440377235413,
                        0.9265213012695312,
                        0.9283975958824158,
                        0.9299695491790771,
                        0.9228701591491699,
                        0.8650608658790588,
                        0.9199796915054321,
                        0.9230730533599854,
                        0.9243407845497131,
                        0.8846349120140076,
                        0.8684077262878418,
                        0.8803752660751343,
                        0.9983265995979309,
                        0.7193711996078491
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -4.5271045475624065,
                    "pretrain_loss": 0.7273877561092377,
                    "pretrain_component": 0.2994844913482666,
                    "supervised_component": 0.42790326476097107,
                    "features_accuracy": [
                        0.7780294418334961,
                        0.8172141313552856,
                        0.872277021408081,
                        0.8886436223983765,
                        0.8963003754615784,
                        0.8880029320716858,
                        0.874275267124176,
                        0.8899567723274231,
                        0.8924307823181152,
                        0.8883898854255676,
                        0.9952359199523926,
                        0.7983862161636353,
                        0.8798386454582214,
                        0.8906291723251343,
                        0.8813103437423706,
                        0.8832895755767822,
                        0.876939594745636,
                        0.8739517331123352,
                        0.7025907635688782,
                        0.8932490944862366,
                        0.8940356969833374,
                        0.8344308137893677,
                        0.8256385326385498,
                        0.8575470447540283,
                        0.8321914672851562,
                        0.8086882829666138,
                        0.7316510081291199,
                        0.7024131417274475,
                        0.7563976049423218,
                        0.9891143441200256,
                        0.9412705302238464,
                        0.9952867031097412,
                        0.9292873740196228,
                        0.9270544052124023,
                        0.9253987073898315,
                        0.929832935333252,
                        0.9299851655960083,
                        0.9345589280128479,
                        0.9303531050682068,
                        0.9325416684150696,
                        0.9328398108482361,
                        0.9297187328338623,
                        0.8730890154838562,
                        0.9261409044265747,
                        0.9275174736976624,
                        0.9299407601356506,
                        0.8918598294258118,
                        0.8776437044143677,
                        0.8844504952430725,
                        0.9977543950080872,
                        0.7195346355438232
                    ]
                },
                "val": {
                    "score": -5.487142124614705,
                    "pretrain_loss": 0.7257184684276581,
                    "pretrain_component": 0.29945582151412964,
                    "supervised_component": 0.42626264691352844,
                    "features_accuracy": [
                        0.7773551940917969,
                        0.8171077966690063,
                        0.8754689693450928,
                        0.890122652053833,
                        0.8939762711524963,
                        0.8910353779792786,
                        0.8786634206771851,
                        0.8936213254928589,
                        0.8908325433731079,
                        0.8883480429649353,
                        0.995132327079773,
                        0.803265392780304,
                        0.8806915879249573,
                        0.8925564885139465,
                        0.8811986446380615,
                        0.8817563652992249,
                        0.8715647459030151,
                        0.8766351938247681,
                        0.6922218799591064,
                        0.8905283212661743,
                        0.8962579369544983,
                        0.8333333134651184,
                        0.8222289681434631,
                        0.8582293391227722,
                        0.8323699235916138,
                        0.8033667802810669,
                        0.7275630831718445,
                        0.7058614492416382,
                        0.7575803399085999,
                        0.9890477657318115,
                        0.9440726041793823,
                        0.9943717122077942,
                        0.9310921430587769,
                        0.9310921430587769,
                        0.9270864725112915,
                        0.9272385835647583,
                        0.933830201625824,
                        0.9335767030715942,
                        0.9301287531852722,
                        0.9299766421318054,
                        0.9332217574119568,
                        0.9313963651657104,
                        0.8700435757637024,
                        0.9227765798568726,
                        0.9285569190979004,
                        0.9286076426506042,
                        0.8903254866600037,
                        0.8778014183044434,
                        0.884393036365509,
                        0.9974647164344788,
                        0.7216813564300537
                    ]
                },
                "test": {
                    "score": -5.7839505204580455,
                    "pretrain_loss": 0.7362770736217499,
                    "pretrain_component": 0.29986703395843506,
                    "supervised_component": 0.4364100396633148,
                    "features_accuracy": [
                        0.7790060639381409,
                        0.8152129650115967,
                        0.87662273645401,
                        0.8898072838783264,
                        0.89219069480896,
                        0.8846349120140076,
                        0.8733265995979309,
                        0.8918864130973816,
                        0.8942697644233704,
                        0.8927991986274719,
                        0.9956896305084229,
                        0.7984787225723267,
                        0.8785496950149536,
                        0.8939655423164368,
                        0.8798681497573853,
                        0.8831642866134644,
                        0.8709431886672974,
                        0.8748986124992371,
                        0.6939148306846619,
                        0.8946247696876526,
                        0.8937119841575623,
                        0.838843822479248,
                        0.8222616910934448,
                        0.8629310131072998,
                        0.8331642746925354,
                        0.8095842003822327,
                        0.7279411554336548,
                        0.7100405693054199,
                        0.7588235139846802,
                        0.9897058606147766,
                        0.9419878125190735,
                        0.9962981939315796,
                        0.931744396686554,
                        0.9245943427085876,
                        0.923275887966156,
                        0.9280933141708374,
                        0.9285497069358826,
                        0.9340263605117798,
                        0.92890465259552,
                        0.9312880635261536,
                        0.933874249458313,
                        0.9296146035194397,
                        0.8731744289398193,
                        0.9248985648155212,
                        0.9261156320571899,
                        0.9280425906181335,
                        0.8979209065437317,
                        0.8795132040977478,
                        0.8868154287338257,
                        0.99837726354599,
                        0.7193711996078491
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -4.571326489643551,
                    "pretrain_loss": 0.7100710272789001,
                    "pretrain_component": 0.285207062959671,
                    "supervised_component": 0.4248639643192291,
                    "features_accuracy": [
                        0.7859970331192017,
                        0.8145307898521423,
                        0.8759182691574097,
                        0.8917964100837708,
                        0.8991360068321228,
                        0.8926210999488831,
                        0.8792994022369385,
                        0.8936487436294556,
                        0.8942260146141052,
                        0.8916885852813721,
                        0.9950709939002991,
                        0.8003844618797302,
                        0.8895761370658875,
                        0.894555926322937,
                        0.8847739696502686,
                        0.8879014253616333,
                        0.8864994645118713,
                        0.8790329694747925,
                        0.6996029019355774,
                        0.9031895995140076,
                        0.8988378643989563,
                        0.8419607281684875,
                        0.8298316597938538,
                        0.8715030550956726,
                        0.837177574634552,
                        0.836188018321991,
                        0.7372841835021973,
                        0.7015313506126404,
                        0.7596392035484314,
                        0.9896345138549805,
                        0.9454763531684875,
                        0.9953818321228027,
                        0.9352250099182129,
                        0.9303911924362183,
                        0.9313681125640869,
                        0.9353836178779602,
                        0.9351361989974976,
                        0.9389931559562683,
                        0.9369441866874695,
                        0.9368553757667542,
                        0.9370012283325195,
                        0.9336581230163574,
                        0.8799084424972534,
                        0.9309366941452026,
                        0.9329984188079834,
                        0.933842122554779,
                        0.8962686657905579,
                        0.8800542950630188,
                        0.8898996710777283,
                        0.9976401925086975,
                        0.7296464443206787
                    ]
                },
                "val": {
                    "score": -5.505473380304723,
                    "pretrain_loss": 0.702211320400238,
                    "pretrain_component": 0.2848730683326721,
                    "supervised_component": 0.4173382520675659,
                    "features_accuracy": [
                        0.7853158712387085,
                        0.8171077966690063,
                        0.8784605860710144,
                        0.8928607106208801,
                        0.8976269960403442,
                        0.8949903249740601,
                        0.8823648691177368,
                        0.8951424360275269,
                        0.8926072120666504,
                        0.8915930986404419,
                        0.9945238828659058,
                        0.8069161176681519,
                        0.8895649313926697,
                        0.896460771560669,
                        0.8842409253120422,
                        0.8877902626991272,
                        0.8819084763526917,
                        0.8824155330657959,
                        0.6922218799591064,
                        0.9034073352813721,
                        0.9016326665878296,
                        0.8380488753318787,
                        0.8276543617248535,
                        0.8719196319580078,
                        0.8385559320449829,
                        0.8329276442527771,
                        0.7324814796447754,
                        0.7058614492416382,
                        0.7593550086021423,
                        0.9898589849472046,
                        0.9468106627464294,
                        0.9946252703666687,
                        0.9366697072982788,
                        0.9335259795188904,
                        0.9314470887184143,
                        0.9355542063713074,
                        0.9387485980987549,
                        0.9388499855995178,
                        0.9366697072982788,
                        0.9360105395317078,
                        0.93803870677948,
                        0.9344386458396912,
                        0.8779028058052063,
                        0.929520308971405,
                        0.9334752559661865,
                        0.9326639771461487,
                        0.8947875499725342,
                        0.8811986446380615,
                        0.8911367654800415,
                        0.9975154399871826,
                        0.7317209243774414
                    ]
                },
                "test": {
                    "score": -5.754963745351455,
                    "pretrain_loss": 0.7138226926326752,
                    "pretrain_component": 0.28511473536491394,
                    "supervised_component": 0.42870795726776123,
                    "features_accuracy": [
                        0.7837221026420593,
                        0.8152636885643005,
                        0.8780933022499084,
                        0.8927484750747681,
                        0.8974645137786865,
                        0.8890973925590515,
                        0.8786511421203613,
                        0.8935598134994507,
                        0.8971095085144043,
                        0.8977687954902649,
                        0.9954867959022522,
                        0.801673412322998,
                        0.8876774907112122,
                        0.8968560099601746,
                        0.8849391341209412,
                        0.8868661522865295,
                        0.8832150101661682,
                        0.8793103694915771,
                        0.6939148306846619,
                        0.9049695730209351,
                        0.8999999761581421,
                        0.8436105251312256,
                        0.8284482955932617,
                        0.8754563927650452,
                        0.8396044373512268,
                        0.8391481041908264,
                        0.7313894629478455,
                        0.7100405693054199,
                        0.7617647051811218,
                        0.9902637004852295,
                        0.9452332854270935,
                        0.9966024160385132,
                        0.9382352828979492,
                        0.9282454252243042,
                        0.9289553761482239,
                        0.934989869594574,
                        0.9334685802459717,
                        0.9391480684280396,
                        0.9353448152542114,
                        0.9370182752609253,
                        0.9382860064506531,
                        0.9329107403755188,
                        0.879969596862793,
                        0.9307302236557007,
                        0.9313387274742126,
                        0.9316937327384949,
                        0.9034482836723328,
                        0.8844320774078369,
                        0.8919371366500854,
                        0.99837726354599,
                        0.7302231192588806
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -4.3151497921486115,
                    "pretrain_loss": 0.6790288984775543,
                    "pretrain_component": 0.27551034092903137,
                    "supervised_component": 0.40351855754852295,
                    "features_accuracy": [
                        0.7842969298362732,
                        0.8149304389953613,
                        0.8801240921020508,
                        0.8957675099372864,
                        0.9003983736038208,
                        0.8935472369194031,
                        0.8847232460975647,
                        0.8947398662567139,
                        0.8997830748558044,
                        0.8963321447372437,
                        0.9950646758079529,
                        0.8042730689048767,
                        0.9010581374168396,
                        0.898679256439209,
                        0.8890305757522583,
                        0.8957040905952454,
                        0.8948286771774292,
                        0.8838732242584229,
                        0.6996980309486389,
                        0.9106560945510864,
                        0.9070592522621155,
                        0.8478856682777405,
                        0.8342975974082947,
                        0.8775295615196228,
                        0.8438637852668762,
                        0.8509369492530823,
                        0.741001546382904,
                        0.7043859958648682,
                        0.7629061937332153,
                        0.9904211163520813,
                        0.9450957179069519,
                        0.9954643249511719,
                        0.937172532081604,
                        0.933778703212738,
                        0.9326685667037964,
                        0.936709463596344,
                        0.9362717270851135,
                        0.9401096105575562,
                        0.9380479454994202,
                        0.9388916492462158,
                        0.9394435286521912,
                        0.9350537657737732,
                        0.8879965543746948,
                        0.9321420192718506,
                        0.9353646039962769,
                        0.9365381598472595,
                        0.9015465974807739,
                        0.8840317726135254,
                        0.893889844417572,
                        0.9975767731666565,
                        0.7703599333763123
                    ]
                },
                "val": {
                    "score": -5.437929492715253,
                    "pretrain_loss": 0.6854731440544128,
                    "pretrain_component": 0.2752406597137451,
                    "supervised_component": 0.4102324843406677,
                    "features_accuracy": [
                        0.784960925579071,
                        0.8170063495635986,
                        0.8826690912246704,
                        0.8968157172203064,
                        0.897880494594574,
                        0.897779107093811,
                        0.887942373752594,
                        0.8969171047210693,
                        0.8983875513076782,
                        0.8960551619529724,
                        0.9942196011543274,
                        0.8092485070228577,
                        0.9024439454078674,
                        0.8998072743415833,
                        0.8903254866600037,
                        0.8938241600990295,
                        0.8908325433731079,
                        0.8868268728256226,
                        0.6922218799591064,
                        0.9087313413619995,
                        0.9077679514884949,
                        0.845603883266449,
                        0.8317614793777466,
                        0.877395749092102,
                        0.8439813256263733,
                        0.8447418808937073,
                        0.737754762172699,
                        0.7058614492416382,
                        0.7621944546699524,
                        0.9912787675857544,
                        0.94797682762146,
                        0.9947266578674316,
                        0.93803870677948,
                        0.936618983745575,
                        0.9325118660926819,
                        0.9369232058525085,
                        0.9402190446853638,
                        0.9392049312591553,
                        0.9375316500663757,
                        0.9381400942802429,
                        0.9399654865264893,
                        0.9362640380859375,
                        0.8862690925598145,
                        0.9311428666114807,
                        0.9366697072982788,
                        0.9355542063713074,
                        0.9003143310546875,
                        0.8836831450462341,
                        0.8950410485267639,
                        0.9975154399871826,
                        0.7692931294441223
                    ]
                },
                "test": {
                    "score": -5.746738540025234,
                    "pretrain_loss": 0.6946099698543549,
                    "pretrain_component": 0.27543389797210693,
                    "supervised_component": 0.4191760718822479,
                    "features_accuracy": [
                        0.7826572060585022,
                        0.8152636885643005,
                        0.8830628991127014,
                        0.8961460590362549,
                        0.8963996171951294,
                        0.8917343020439148,
                        0.884989857673645,
                        0.8941683769226074,
                        0.9038539528846741,
                        0.9015719890594482,
                        0.9953854084014893,
                        0.8045638799667358,
                        0.899442195892334,
                        0.900557816028595,
                        0.8896551728248596,
                        0.8931034803390503,
                        0.89219069480896,
                        0.8856998085975647,
                        0.693864107131958,
                        0.9106997847557068,
                        0.9059330821037292,
                        0.851064920425415,
                        0.8317951560020447,
                        0.8809837698936462,
                        0.844929039478302,
                        0.851673424243927,
                        0.735547661781311,
                        0.7100405693054199,
                        0.7655172348022461,
                        0.9915821552276611,
                        0.9466531276702881,
                        0.9966024160385132,
                        0.9390973448753357,
                        0.93052738904953,
                        0.93052738904953,
                        0.9372718334197998,
                        0.9341785311698914,
                        0.9394016265869141,
                        0.9359026551246643,
                        0.9392495155334473,
                        0.9409229159355164,
                        0.9336714148521423,
                        0.8865111470222473,
                        0.931135892868042,
                        0.9340770840644836,
                        0.9348884224891663,
                        0.9079107642173767,
                        0.8867647051811218,
                        0.8956896662712097,
                        0.9984787106513977,
                        0.7691683769226074
                    ]
                }
            }
        },
        "train": {
            "score": -4.385721355734469
        },
        "val": {
            "score": -5.428623851009113
        },
        "test": {
            "score": -5.690652709508123
        }
    },
    "best_iteration": 10000,
    "time": "0:07:42"
}
