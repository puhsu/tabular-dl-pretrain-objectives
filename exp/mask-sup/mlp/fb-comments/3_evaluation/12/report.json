{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised___44f60819937d45f1bc3d10c1c30fbdae.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 12,
        "data": {
            "path": "data/fb-comments",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512,
                    512
                ],
                "dropout": 0.17268933438574993
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [],
            "d_num_embedding": null,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 512,
            "lr": 9.340061002994785e-05,
            "weight_decay": 0.0,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.30212150355754686,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 9.340061002994785e-05,
            "weight_decay": 0.0,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "epoch_size": 308,
    "n_parameters": 619572,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -4.058136297571114,
                    "pretrain_loss": 0.7760918736457825,
                    "pretrain_component": 0.32431745529174805,
                    "supervised_component": 0.4517744183540344,
                    "features_accuracy": [
                        0.7555094957351685,
                        0.8161991834640503,
                        0.8635608553886414,
                        0.8716489672660828,
                        0.8894556164741516,
                        0.8802382946014404,
                        0.8625458478927612,
                        0.8822555541992188,
                        0.8775104880332947,
                        0.8723658323287964,
                        0.9957180619239807,
                        0.7915794849395752,
                        0.8617021441459656,
                        0.8780814409255981,
                        0.8708179593086243,
                        0.8780370354652405,
                        0.859589695930481,
                        0.8634403347969055,
                        0.6989685297012329,
                        0.8800162672996521,
                        0.8823063373565674,
                        0.8183559775352478,
                        0.8122597336769104,
                        0.8310115933418274,
                        0.8232596516609192,
                        0.7337888479232788,
                        0.7167561054229736,
                        0.702844500541687,
                        0.7479478716850281,
                        0.9891523718833923,
                        0.9341973662376404,
                        0.9955341219902039,
                        0.9247390031814575,
                        0.9214973449707031,
                        0.9196006059646606,
                        0.9245803952217102,
                        0.9247263073921204,
                        0.9277839064598083,
                        0.9268513917922974,
                        0.9289765357971191,
                        0.928304135799408,
                        0.9249546527862549,
                        0.8631294369697571,
                        0.9206727147102356,
                        0.9253162741661072,
                        0.9263058304786682,
                        0.8822936415672302,
                        0.8690798282623291,
                        0.8781829476356506,
                        0.9977163076400757,
                        0.7207399606704712
                    ]
                },
                "val": {
                    "score": -5.451087007221193,
                    "pretrain_loss": 0.7441787719726562,
                    "pretrain_component": 0.32370248436927795,
                    "supervised_component": 0.4204762876033783,
                    "features_accuracy": [
                        0.7561606168746948,
                        0.8200486302375793,
                        0.8645674586296082,
                        0.8705506324768066,
                        0.888601541519165,
                        0.8780549168586731,
                        0.8637561798095703,
                        0.8826183676719666,
                        0.8727816343307495,
                        0.8721731901168823,
                        0.9958421587944031,
                        0.7938342690467834,
                        0.8631477355957031,
                        0.8775479197502136,
                        0.8694351315498352,
                        0.8807423114776611,
                        0.8568096160888672,
                        0.8668999075889587,
                        0.6985092759132385,
                        0.8789169192314148,
                        0.8884494304656982,
                        0.8191359639167786,
                        0.8081837296485901,
                        0.8352600932121277,
                        0.826640248298645,
                        0.7379068732261658,
                        0.7176756858825684,
                        0.7040867805480957,
                        0.7505323886871338,
                        0.9888955950737,
                        0.933830201625824,
                        0.9953858256340027,
                        0.9243484139442444,
                        0.9257174730300903,
                        0.921103298664093,
                        0.9255146384239197,
                        0.9228779673576355,
                        0.9279991388320923,
                        0.9303315877914429,
                        0.928759753704071,
                        0.9291146397590637,
                        0.9228273034095764,
                        0.8656829595565796,
                        0.9183145761489868,
                        0.9254639148712158,
                        0.9253625273704529,
                        0.8828718662261963,
                        0.8700942993164062,
                        0.8817057013511658,
                        0.9977689385414124,
                        0.7171686291694641
                    ]
                },
                "test": {
                    "score": -5.66441799528578,
                    "pretrain_loss": 0.7827841639518738,
                    "pretrain_component": 0.3236904442310333,
                    "supervised_component": 0.45909371972084045,
                    "features_accuracy": [
                        0.756085216999054,
                        0.8136916756629944,
                        0.8673428297042847,
                        0.8710953593254089,
                        0.8909229040145874,
                        0.8813894391059875,
                        0.8624239563941956,
                        0.8789553642272949,
                        0.8752535581588745,
                        0.8723630905151367,
                        0.9961967468261719,
                        0.792190670967102,
                        0.863286018371582,
                        0.8806794881820679,
                        0.8747971653938293,
                        0.8824036717414856,
                        0.8574036359786987,
                        0.8601419925689697,
                        0.6920385360717773,
                        0.8767748475074768,
                        0.8837221264839172,
                        0.81947261095047,
                        0.813894510269165,
                        0.832200825214386,
                        0.8232251405715942,
                        0.7347363233566284,
                        0.7188640832901001,
                        0.7041075229644775,
                        0.7545132040977478,
                        0.9888437986373901,
                        0.936105489730835,
                        0.9953854084014893,
                        0.930020272731781,
                        0.9222109317779541,
                        0.9192190766334534,
                        0.9236815571784973,
                        0.9256592392921448,
                        0.9268762469291687,
                        0.9281440377235413,
                        0.9314401745796204,
                        0.9281947016716003,
                        0.9241379499435425,
                        0.8638437986373901,
                        0.9206896424293518,
                        0.9263691902160645,
                        0.923275887966156,
                        0.8791075348854065,
                        0.8720081448554993,
                        0.8789046406745911,
                        0.9974644780158997,
                        0.7241379618644714
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -4.541639298929673,
                    "pretrain_loss": 0.7311401963233948,
                    "pretrain_component": 0.2981317341327667,
                    "supervised_component": 0.43300846219062805,
                    "features_accuracy": [
                        0.7781943678855896,
                        0.8171570301055908,
                        0.8797244429588318,
                        0.8853005170822144,
                        0.8959071040153503,
                        0.8951902389526367,
                        0.8767111897468567,
                        0.8911557197570801,
                        0.8924688100814819,
                        0.8880029320716858,
                        0.9950329661369324,
                        0.7977454662322998,
                        0.8817797899246216,
                        0.8905974626541138,
                        0.8787031173706055,
                        0.8896966576576233,
                        0.86946040391922,
                        0.8730319142341614,
                        0.6993745565414429,
                        0.9081820845603943,
                        0.8921072483062744,
                        0.8314175605773926,
                        0.8248265385627747,
                        0.8550413250923157,
                        0.8327624201774597,
                        0.7946116924285889,
                        0.7279970645904541,
                        0.7017850875854492,
                        0.7579391002655029,
                        0.9889620542526245,
                        0.9365444779396057,
                        0.995210587978363,
                        0.9306576251983643,
                        0.92796790599823,
                        0.9232862591743469,
                        0.9273779392242432,
                        0.9263502359390259,
                        0.9311904907226562,
                        0.930365800857544,
                        0.9336264133453369,
                        0.9318311810493469,
                        0.9268006682395935,
                        0.8689719438552856,
                        0.9237493872642517,
                        0.928037703037262,
                        0.9301437735557556,
                        0.8941943049430847,
                        0.8801050782203674,
                        0.8962496519088745,
                        0.9978558421134949,
                        0.7182658910751343
                    ]
                },
                "val": {
                    "score": -5.5290349465698725,
                    "pretrain_loss": 0.7040461003780365,
                    "pretrain_component": 0.29816192388534546,
                    "supervised_component": 0.40588417649269104,
                    "features_accuracy": [
                        0.7780650854110718,
                        0.8197444081306458,
                        0.8816549777984619,
                        0.8857113718986511,
                        0.8961058259010315,
                        0.8952945470809937,
                        0.8777000308036804,
                        0.8911874890327454,
                        0.8895142078399658,
                        0.8857113718986511,
                        0.9950816035270691,
                        0.8013892769813538,
                        0.8833282589912415,
                        0.8892099857330322,
                        0.8785619735717773,
                        0.8905790448188782,
                        0.8686745762825012,
                        0.875976026058197,
                        0.6985092759132385,
                        0.9075144529342651,
                        0.8973734378814697,
                        0.8312544226646423,
                        0.821012020111084,
                        0.8614744544029236,
                        0.8355135917663574,
                        0.794899046421051,
                        0.7277151942253113,
                        0.7040867805480957,
                        0.7599634528160095,
                        0.9888449311256409,
                        0.9343879818916321,
                        0.9947773814201355,
                        0.9278470277786255,
                        0.9293681979179382,
                        0.9254639148712158,
                        0.9263259172439575,
                        0.9234357476234436,
                        0.9302302002906799,
                        0.9326639771461487,
                        0.9333738684654236,
                        0.9314978122711182,
                        0.9248554706573486,
                        0.8711084127426147,
                        0.9209004640579224,
                        0.9280498623847961,
                        0.9282526969909668,
                        0.8933677673339844,
                        0.8808944225311279,
                        0.8998579978942871,
                        0.9977182745933533,
                        0.7173207402229309
                    ]
                },
                "test": {
                    "score": -5.721469703001103,
                    "pretrain_loss": 0.7442686855792999,
                    "pretrain_component": 0.29827195405960083,
                    "supervised_component": 0.4459967315196991,
                    "features_accuracy": [
                        0.7804259657859802,
                        0.8134381175041199,
                        0.8820993900299072,
                        0.8865111470222473,
                        0.897210955619812,
                        0.8956896662712097,
                        0.8759635090827942,
                        0.8865618705749512,
                        0.8891480565071106,
                        0.8873732089996338,
                        0.9956896305084229,
                        0.7998479008674622,
                        0.8828093409538269,
                        0.8914807438850403,
                        0.8821501135826111,
                        0.8913792967796326,
                        0.8674949407577515,
                        0.8702839612960815,
                        0.6920385360717773,
                        0.9058823585510254,
                        0.8919371366500854,
                        0.8318965435028076,
                        0.8270791172981262,
                        0.8572008013725281,
                        0.8329614400863647,
                        0.792799174785614,
                        0.7284989953041077,
                        0.7041075229644775,
                        0.7625253796577454,
                        0.9893001914024353,
                        0.9368154406547546,
                        0.994979739189148,
                        0.9332150220870972,
                        0.926622748374939,
                        0.9238336682319641,
                        0.925507128238678,
                        0.9262170195579529,
                        0.92890465259552,
                        0.9296653270721436,
                        0.9360040426254272,
                        0.93052738904953,
                        0.926673412322998,
                        0.8708925247192383,
                        0.9231744408607483,
                        0.9293610453605652,
                        0.9272312521934509,
                        0.8904158473014832,
                        0.8797667622566223,
                        0.8976166248321533,
                        0.9975152015686035,
                        0.7241886258125305
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -4.508330631109086,
                    "pretrain_loss": 0.7029108107089996,
                    "pretrain_component": 0.28303131461143494,
                    "supervised_component": 0.4198794960975647,
                    "features_accuracy": [
                        0.7837069630622864,
                        0.8177787065505981,
                        0.8873558640480042,
                        0.8935092091560364,
                        0.9029485583305359,
                        0.906818151473999,
                        0.8806759715080261,
                        0.8946573734283447,
                        0.8986539244651794,
                        0.8955898880958557,
                        0.9953247308731079,
                        0.8020274639129639,
                        0.8913460373878479,
                        0.8997259736061096,
                        0.8834925889968872,
                        0.8960593342781067,
                        0.8750491738319397,
                        0.876133918762207,
                        0.7013601064682007,
                        0.917963981628418,
                        0.8958500027656555,
                        0.8386683464050293,
                        0.8295145034790039,
                        0.8701645731925964,
                        0.8336695432662964,
                        0.8179944157600403,
                        0.7379438877105713,
                        0.7027302980422974,
                        0.7624240517616272,
                        0.9896408319473267,
                        0.940832793712616,
                        0.9948806762695312,
                        0.9331189393997192,
                        0.9323767423629761,
                        0.928697407245636,
                        0.93431156873703,
                        0.9324211478233337,
                        0.9351933002471924,
                        0.9357198476791382,
                        0.9379591345787048,
                        0.937375545501709,
                        0.9336645007133484,
                        0.8701645731925964,
                        0.9303721189498901,
                        0.9326748847961426,
                        0.9354661107063293,
                        0.9026250243186951,
                        0.8853576183319092,
                        0.9041792154312134,
                        0.9977163076400757,
                        0.7429680824279785
                    ]
                },
                "val": {
                    "score": -5.541730294030125,
                    "pretrain_loss": 0.6817823946475983,
                    "pretrain_component": 0.28243425488471985,
                    "supervised_component": 0.3993481397628784,
                    "features_accuracy": [
                        0.7827299237251282,
                        0.8196937441825867,
                        0.8885001540184021,
                        0.8946353793144226,
                        0.9024439454078674,
                        0.9080721735954285,
                        0.8830747008323669,
                        0.8945847153663635,
                        0.8975762724876404,
                        0.893570601940155,
                        0.9954365491867065,
                        0.8072710633277893,
                        0.8906297087669373,
                        0.8977283835411072,
                        0.8841395378112793,
                        0.897018551826477,
                        0.8748605251312256,
                        0.878105640411377,
                        0.6985092759132385,
                        0.9146637916564941,
                        0.89995938539505,
                        0.8376432061195374,
                        0.825119137763977,
                        0.8728323578834534,
                        0.8355643153190613,
                        0.8166007399559021,
                        0.73557448387146,
                        0.7040867805480957,
                        0.7627015113830566,
                        0.9893519878387451,
                        0.9406246542930603,
                        0.9948281049728394,
                        0.9322076439857483,
                        0.9349964261054993,
                        0.9305344223976135,
                        0.9338809251785278,
                        0.9320555329322815,
                        0.9362640380859375,
                        0.9376837611198425,
                        0.9383936524391174,
                        0.937278151512146,
                        0.9323597550392151,
                        0.8724774122238159,
                        0.9289625287055969,
                        0.9340837597846985,
                        0.9346414804458618,
                        0.9037622809410095,
                        0.8870297074317932,
                        0.906297504901886,
                        0.9976675510406494,
                        0.7406956553459167
                    ]
                },
                "test": {
                    "score": -5.7307317648058325,
                    "pretrain_loss": 0.7176943719387054,
                    "pretrain_component": 0.2824914753437042,
                    "supervised_component": 0.4352028965950012,
                    "features_accuracy": [
                        0.7836207151412964,
                        0.8135395646095276,
                        0.8904158473014832,
                        0.8966024518013,
                        0.9040060639381409,
                        0.9067444205284119,
                        0.8807809352874756,
                        0.8906186819076538,
                        0.8990872502326965,
                        0.8957403898239136,
                        0.9957403540611267,
                        0.8046146035194397,
                        0.8917849659919739,
                        0.8990872502326965,
                        0.8880831599235535,
                        0.8998985886573792,
                        0.8759635090827942,
                        0.8731744289398193,
                        0.6920385360717773,
                        0.9151115417480469,
                        0.8958417773246765,
                        0.838843822479248,
                        0.8318458199501038,
                        0.8712474703788757,
                        0.8339756727218628,
                        0.8176470398902893,
                        0.7370689511299133,
                        0.7041075229644775,
                        0.7659229040145874,
                        0.9898580312728882,
                        0.9415821433067322,
                        0.9950811266899109,
                        0.9375760555267334,
                        0.93215012550354,
                        0.9284989833831787,
                        0.9320994019508362,
                        0.9340263605117798,
                        0.9343306422233582,
                        0.936105489730835,
                        0.9406693577766418,
                        0.9346348643302917,
                        0.9314401745796204,
                        0.8730730414390564,
                        0.9301217198371887,
                        0.9345842003822327,
                        0.9324036836624146,
                        0.899442195892334,
                        0.8863083124160767,
                        0.9043610692024231,
                        0.9974644780158997,
                        0.7481237649917603
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -4.829498545102893,
                    "pretrain_loss": 0.6800657510757446,
                    "pretrain_component": 0.2714994549751282,
                    "supervised_component": 0.40856629610061646,
                    "features_accuracy": [
                        0.7884266376495361,
                        0.8173600435256958,
                        0.8990281820297241,
                        0.899548351764679,
                        0.9084104299545288,
                        0.9124577045440674,
                        0.8868166208267212,
                        0.8998908996582031,
                        0.9028914570808411,
                        0.9010327458381653,
                        0.9955150485038757,
                        0.804298460483551,
                        0.8976770043373108,
                        0.9096283912658691,
                        0.8939151763916016,
                        0.9064375758171082,
                        0.8818051815032959,
                        0.8839746713638306,
                        0.6982707381248474,
                        0.9206473231315613,
                        0.9019716382026672,
                        0.8415356874465942,
                        0.8344181180000305,
                        0.8776437044143677,
                        0.8408632874488831,
                        0.8379515409469604,
                        0.7424415349960327,
                        0.7027937769889832,
                        0.7626714706420898,
                        0.9896725416183472,
                        0.9433639049530029,
                        0.9955721497535706,
                        0.9370710253715515,
                        0.9346224069595337,
                        0.9305307269096375,
                        0.9361512064933777,
                        0.934508204460144,
                        0.9405219554901123,
                        0.9383397698402405,
                        0.9400144815444946,
                        0.9390438795089722,
                        0.9360306859016418,
                        0.8765018582344055,
                        0.9313300251960754,
                        0.9349332451820374,
                        0.9367411732673645,
                        0.9106687903404236,
                        0.888408899307251,
                        0.9095142483711243,
                        0.9974815845489502,
                        0.7697509527206421
                    ]
                },
                "val": {
                    "score": -5.570444382560023,
                    "pretrain_loss": 0.661723792552948,
                    "pretrain_component": 0.2718045115470886,
                    "supervised_component": 0.3899192810058594,
                    "features_accuracy": [
                        0.7856200933456421,
                        0.8196937441825867,
                        0.8993002772331238,
                        0.8991481065750122,
                        0.9085792303085327,
                        0.9121792912483215,
                        0.889362096786499,
                        0.9013791680335999,
                        0.9006185531616211,
                        0.9000101089477539,
                        0.995791494846344,
                        0.8063583374023438,
                        0.8969171047210693,
                        0.9073622822761536,
                        0.8909846544265747,
                        0.9047256708145142,
                        0.8805394768714905,
                        0.8861169815063477,
                        0.6985599398612976,
                        0.9187709093093872,
                        0.9068045616149902,
                        0.84129399061203,
                        0.8296318650245667,
                        0.8814014792442322,
                        0.8426122665405273,
                        0.8331812024116516,
                        0.7402393221855164,
                        0.7040867805480957,
                        0.7634114027023315,
                        0.9899097084999084,
                        0.9438190460205078,
                        0.9953351020812988,
                        0.9349457025527954,
                        0.9369739294052124,
                        0.9319034218788147,
                        0.9365682601928711,
                        0.9340330362319946,
                        0.9390528202056885,
                        0.9388499855995178,
                        0.9404725432395935,
                        0.9395091533660889,
                        0.9351485371589661,
                        0.8775985836982727,
                        0.929621696472168,
                        0.9358077049255371,
                        0.9347429275512695,
                        0.9099482297897339,
                        0.889362096786499,
                        0.9144609570503235,
                        0.9977182745933533,
                        0.7676199078559875
                    ]
                },
                "test": {
                    "score": -5.769095828169928,
                    "pretrain_loss": 0.6979861259460449,
                    "pretrain_component": 0.27181485295295715,
                    "supervised_component": 0.42617127299308777,
                    "features_accuracy": [
                        0.7853448390960693,
                        0.8134888410568237,
                        0.9003549814224243,
                        0.9013184905052185,
                        0.90892493724823,
                        0.9108519554138184,
                        0.8856998085975647,
                        0.8978701829910278,
                        0.9016227126121521,
                        0.8998478651046753,
                        0.9958925247192383,
                        0.8041582107543945,
                        0.8990365266799927,
                        0.9083671569824219,
                        0.8959939479827881,
                        0.908823549747467,
                        0.8796145915985107,
                        0.8818965554237366,
                        0.6920892596244812,
                        0.9197261929512024,
                        0.9029918909072876,
                        0.8411257863044739,
                        0.8385902643203735,
                        0.8787018060684204,
                        0.8404665589332581,
                        0.8369675278663635,
                        0.7408722043037415,
                        0.7041075229644775,
                        0.7669878602027893,
                        0.9902129769325256,
                        0.9446754455566406,
                        0.9953346848487854,
                        0.9398580193519592,
                        0.9334178566932678,
                        0.9297160506248474,
                        0.9341278076171875,
                        0.9362068772315979,
                        0.937221109867096,
                        0.9378296136856079,
                        0.9422920942306519,
                        0.937221109867096,
                        0.9330629110336304,
                        0.8790060877799988,
                        0.931135892868042,
                        0.9363590478897095,
                        0.9325557947158813,
                        0.9065415859222412,
                        0.8913792967796326,
                        0.9117646813392639,
                        0.9974644780158997,
                        0.773326575756073
                    ]
                }
            }
        },
        "train": {
            "score": -4.058136297571114
        },
        "val": {
            "score": -5.451087007221193
        },
        "test": {
            "score": -5.66441799528578
        }
    },
    "best_iteration": 10000,
    "time": "0:07:31"
}
