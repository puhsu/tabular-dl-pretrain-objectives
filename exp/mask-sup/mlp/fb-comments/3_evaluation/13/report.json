{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised___44f60819937d45f1bc3d10c1c30fbdae.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 13,
        "data": {
            "path": "data/fb-comments",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512,
                    512
                ],
                "dropout": 0.17268933438574993
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [],
            "d_num_embedding": null,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 512,
            "lr": 9.340061002994785e-05,
            "weight_decay": 0.0,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.30212150355754686,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 9.340061002994785e-05,
            "weight_decay": 0.0,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "epoch_size": 308,
    "n_parameters": 619572,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -4.2743657270115785,
                    "pretrain_loss": 0.7723218202590942,
                    "pretrain_component": 0.32301637530326843,
                    "supervised_component": 0.4493054449558258,
                    "features_accuracy": [
                        0.7489818334579468,
                        0.8174234628677368,
                        0.8702089786529541,
                        0.8791598677635193,
                        0.887939453125,
                        0.8803207278251648,
                        0.8669800758361816,
                        0.8814689517021179,
                        0.8808345794677734,
                        0.876800000667572,
                        0.9954833388328552,
                        0.7809538245201111,
                        0.8680267333984375,
                        0.8837082386016846,
                        0.8633261322975159,
                        0.8812025189399719,
                        0.8616133332252502,
                        0.8629328012466431,
                        0.699317455291748,
                        0.8804603219032288,
                        0.8855288624763489,
                        0.8216229677200317,
                        0.8142896890640259,
                        0.8252134919166565,
                        0.8244839906692505,
                        0.7342773079872131,
                        0.7182849645614624,
                        0.7017216682434082,
                        0.7431457042694092,
                        0.9889811277389526,
                        0.9353011250495911,
                        0.99554044008255,
                        0.9253796935081482,
                        0.9244154691696167,
                        0.9196196794509888,
                        0.9247960448265076,
                        0.9238952994346619,
                        0.9279996156692505,
                        0.9274730682373047,
                        0.9294840097427368,
                        0.9286212921142578,
                        0.9251068830490112,
                        0.8627868890762329,
                        0.9197655320167542,
                        0.9245613813400269,
                        0.9264200329780579,
                        0.8831309676170349,
                        0.8699996471405029,
                        0.8791281580924988,
                        0.9976465106010437,
                        0.7183293700218201
                    ]
                },
                "val": {
                    "score": -5.4500689102415185,
                    "pretrain_loss": 0.7437951266765594,
                    "pretrain_component": 0.32289600372314453,
                    "supervised_component": 0.4208991229534149,
                    "features_accuracy": [
                        0.7474901080131531,
                        0.8163471817970276,
                        0.8673562407493591,
                        0.8803873658180237,
                        0.8890071511268616,
                        0.8832268118858337,
                        0.873136579990387,
                        0.8772943615913391,
                        0.8786634206771851,
                        0.873035192489624,
                        0.995182991027832,
                        0.7817158102989197,
                        0.8675590753555298,
                        0.8861169815063477,
                        0.8638069033622742,
                        0.884494423866272,
                        0.8642632365226746,
                        0.8609167337417603,
                        0.6983571648597717,
                        0.8777506947517395,
                        0.883632481098175,
                        0.830848753452301,
                        0.8075752854347229,
                        0.8219247460365295,
                        0.8209613561630249,
                        0.7310110330581665,
                        0.7169657945632935,
                        0.7039853930473328,
                        0.7407463788986206,
                        0.9882871508598328,
                        0.9350471496582031,
                        0.9947266578674316,
                        0.9249061942100525,
                        0.9225737452507019,
                        0.9223709106445312,
                        0.924652636051178,
                        0.9241455793380737,
                        0.9248047471046448,
                        0.9299766421318054,
                        0.9310414791107178,
                        0.9292668104171753,
                        0.9248554706573486,
                        0.863857626914978,
                        0.9216103553771973,
                        0.9263765811920166,
                        0.9282019734382629,
                        0.8856606483459473,
                        0.8685731291770935,
                        0.8792211413383484,
                        0.9975154399871826,
                        0.7220869660377502
                    ]
                },
                "test": {
                    "score": -5.678719190298293,
                    "pretrain_loss": 0.7465187907218933,
                    "pretrain_component": 0.3227863907814026,
                    "supervised_component": 0.4237323999404907,
                    "features_accuracy": [
                        0.7460953593254089,
                        0.8105983734130859,
                        0.8667342662811279,
                        0.8799188733100891,
                        0.8911764621734619,
                        0.8791581988334656,
                        0.8617647290229797,
                        0.8820993900299072,
                        0.8792089223861694,
                        0.8777890801429749,
                        0.9950811266899109,
                        0.7834178805351257,
                        0.8670892715454102,
                        0.8852434158325195,
                        0.8611055016517639,
                        0.8809837698936462,
                        0.8635902404785156,
                        0.8601419925689697,
                        0.7063894271850586,
                        0.8841785192489624,
                        0.887221097946167,
                        0.8237322568893433,
                        0.8129817247390747,
                        0.830070972442627,
                        0.8205375075340271,
                        0.7349898815155029,
                        0.7130831480026245,
                        0.7018255591392517,
                        0.7415314316749573,
                        0.9893001914024353,
                        0.9360547661781311,
                        0.9959431886672974,
                        0.9256085157394409,
                        0.9239857792854309,
                        0.9198275804519653,
                        0.9247464537620544,
                        0.9249492883682251,
                        0.93215012550354,
                        0.9278904795646667,
                        0.9295132160186768,
                        0.9277383685112,
                        0.9230730533599854,
                        0.8596348762512207,
                        0.9217545390129089,
                        0.9303245544433594,
                        0.9239351153373718,
                        0.8795132040977478,
                        0.8687119483947754,
                        0.8826572299003601,
                        0.9981237649917603,
                        0.7231744527816772
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -4.750585390300889,
                    "pretrain_loss": 0.7223596274852753,
                    "pretrain_component": 0.2994600236415863,
                    "supervised_component": 0.42289960384368896,
                    "features_accuracy": [
                        0.773684024810791,
                        0.8162879943847656,
                        0.8731524348258972,
                        0.8896268606185913,
                        0.895285427570343,
                        0.8884342908859253,
                        0.8731017112731934,
                        0.8914348483085632,
                        0.8922087550163269,
                        0.8872289657592773,
                        0.9952993988990784,
                        0.8000736236572266,
                        0.8762608170509338,
                        0.8909209966659546,
                        0.8809424042701721,
                        0.8973280787467957,
                        0.8694794774055481,
                        0.8749159574508667,
                        0.6988543272018433,
                        0.889277994632721,
                        0.8907116651535034,
                        0.8320900201797485,
                        0.823380172252655,
                        0.8580355048179626,
                        0.8339486718177795,
                        0.7864537835121155,
                        0.7275403141975403,
                        0.7032061219215393,
                        0.7594742774963379,
                        0.9888859391212463,
                        0.9396211504936218,
                        0.9950138926506042,
                        0.927898108959198,
                        0.9302008748054504,
                        0.9250054359436035,
                        0.9292429685592651,
                        0.927904486656189,
                        0.9334678649902344,
                        0.9311016798019409,
                        0.935110867023468,
                        0.9315076470375061,
                        0.9284690618515015,
                        0.8684327602386475,
                        0.9234575629234314,
                        0.929693341255188,
                        0.9285578727722168,
                        0.8927162289619446,
                        0.8785127997398376,
                        0.8852307200431824,
                        0.9977290034294128,
                        0.7197693586349487
                    ]
                },
                "val": {
                    "score": -5.550660770341789,
                    "pretrain_loss": 0.7037556767463684,
                    "pretrain_component": 0.299423485994339,
                    "supervised_component": 0.4043321907520294,
                    "features_accuracy": [
                        0.7779636979103088,
                        0.8162965178489685,
                        0.8734408020973206,
                        0.8909339308738708,
                        0.8940269351005554,
                        0.8892607092857361,
                        0.8793225884437561,
                        0.8855592608451843,
                        0.8903762102127075,
                        0.8816042542457581,
                        0.9948281049728394,
                        0.7998681664466858,
                        0.8730858564376831,
                        0.8922522664070129,
                        0.881553590297699,
                        0.9030523896217346,
                        0.8720718026161194,
                        0.8723253011703491,
                        0.6983571648597717,
                        0.8861677050590515,
                        0.8895142078399658,
                        0.8391136527061462,
                        0.8200486302375793,
                        0.8535138368606567,
                        0.8290234208106995,
                        0.7830848693847656,
                        0.7233039140701294,
                        0.7039853930473328,
                        0.7603691220283508,
                        0.9885407090187073,
                        0.9391034841537476,
                        0.9944731593132019,
                        0.9271878600120544,
                        0.9281512498855591,
                        0.9263259172439575,
                        0.9285569190979004,
                        0.9268329739570618,
                        0.9310414791107178,
                        0.9339316487312317,
                        0.9371767044067383,
                        0.9319034218788147,
                        0.9293681979179382,
                        0.8696886301040649,
                        0.9246019124984741,
                        0.9302302002906799,
                        0.9317513108253479,
                        0.896359384059906,
                        0.8763816952705383,
                        0.8866747617721558,
                        0.9976168274879456,
                        0.7221376895904541
                    ]
                },
                "test": {
                    "score": -5.777755340782621,
                    "pretrain_loss": 0.7058144807815552,
                    "pretrain_component": 0.29915180802345276,
                    "supervised_component": 0.4066626727581024,
                    "features_accuracy": [
                        0.7755070924758911,
                        0.810496985912323,
                        0.871653139591217,
                        0.8886409997940063,
                        0.8968052864074707,
                        0.8880831599235535,
                        0.8696754574775696,
                        0.8926470875740051,
                        0.8920385241508484,
                        0.8848377466201782,
                        0.9948275685310364,
                        0.8013691902160645,
                        0.8746450543403625,
                        0.893306314945221,
                        0.8792596459388733,
                        0.8990872502326965,
                        0.8702839612960815,
                        0.8721095323562622,
                        0.7063894271850586,
                        0.8908215165138245,
                        0.8919878602027893,
                        0.8326572179794312,
                        0.8227687478065491,
                        0.8623732328414917,
                        0.8271298408508301,
                        0.7907707691192627,
                        0.7220588326454163,
                        0.7018255591392517,
                        0.7612069249153137,
                        0.9890973567962646,
                        0.9407708048820496,
                        0.9957403540611267,
                        0.9281947016716003,
                        0.9298681616783142,
                        0.9243407845497131,
                        0.9276876449584961,
                        0.9281440377235413,
                        0.9363590478897095,
                        0.9314908981323242,
                        0.9351419806480408,
                        0.9307809472084045,
                        0.9275861978530884,
                        0.8663285970687866,
                        0.9253042936325073,
                        0.9352434277534485,
                        0.9275354743003845,
                        0.8896044492721558,
                        0.8779411911964417,
                        0.8901622891426086,
                        0.9981744289398193,
                        0.7231744527816772
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -4.15785214734431,
                    "pretrain_loss": 0.7131814062595367,
                    "pretrain_component": 0.28453177213668823,
                    "supervised_component": 0.4286496341228485,
                    "features_accuracy": [
                        0.7809094190597534,
                        0.8150002360343933,
                        0.8804032206535339,
                        0.8945812582969666,
                        0.8999289870262146,
                        0.8930334448814392,
                        0.8769903182983398,
                        0.8975437879562378,
                        0.8931349515914917,
                        0.8914411664009094,
                        0.9951217770576477,
                        0.8031185269355774,
                        0.8823570609092712,
                        0.8938517570495605,
                        0.8908638954162598,
                        0.9081439971923828,
                        0.8736028075218201,
                        0.8841015696525574,
                        0.7002562880516052,
                        0.8967888355255127,
                        0.896414577960968,
                        0.8415610790252686,
                        0.8302820324897766,
                        0.8696317076683044,
                        0.8392900228500366,
                        0.8334982991218567,
                        0.7336492538452148,
                        0.7022165060043335,
                        0.762151300907135,
                        0.9895012974739075,
                        0.9431418776512146,
                        0.9955023527145386,
                        0.9346668124198914,
                        0.9320849180221558,
                        0.931494951248169,
                        0.9338738322257996,
                        0.9343051910400391,
                        0.9375594854354858,
                        0.9352948069572449,
                        0.9386506080627441,
                        0.936373233795166,
                        0.9338231086730957,
                        0.8746432065963745,
                        0.930492639541626,
                        0.9332775473594666,
                        0.9345209002494812,
                        0.9017686247825623,
                        0.8826298117637634,
                        0.8893541097640991,
                        0.9977734088897705,
                        0.7363833785057068
                    ]
                },
                "val": {
                    "score": -5.504314387929081,
                    "pretrain_loss": 0.6828456819057465,
                    "pretrain_component": 0.28453588485717773,
                    "supervised_component": 0.3983097970485687,
                    "features_accuracy": [
                        0.7840482592582703,
                        0.8162965178489685,
                        0.8792718648910522,
                        0.8972720503807068,
                        0.8995537757873535,
                        0.8931649923324585,
                        0.8826690912246704,
                        0.8938748240470886,
                        0.8903762102127075,
                        0.8874353170394897,
                        0.9947773814201355,
                        0.8035188913345337,
                        0.8806408643722534,
                        0.8960551619529724,
                        0.8910353779792786,
                        0.9124835133552551,
                        0.8749112486839294,
                        0.8830747008323669,
                        0.6983571648597717,
                        0.894331157207489,
                        0.8953959941864014,
                        0.8467193841934204,
                        0.8265388607978821,
                        0.8677111864089966,
                        0.8377446532249451,
                        0.8281614184379578,
                        0.7333434820175171,
                        0.7039853930473328,
                        0.7628029584884644,
                        0.9887434840202332,
                        0.9423485994338989,
                        0.9945238828659058,
                        0.9342358708381653,
                        0.9306358098983765,
                        0.932410478591919,
                        0.935249924659729,
                        0.9347935914993286,
                        0.9333738684654236,
                        0.9382415413856506,
                        0.9402190446853638,
                        0.9360612034797668,
                        0.9335767030715942,
                        0.8769394159317017,
                        0.9308386445045471,
                        0.9324612021446228,
                        0.9375316500663757,
                        0.9044721126556396,
                        0.8804380893707275,
                        0.8896663188934326,
                        0.9976675510406494,
                        0.7374505400657654
                    ]
                },
                "test": {
                    "score": -5.708855586221777,
                    "pretrain_loss": 0.6891695261001587,
                    "pretrain_component": 0.28408560156822205,
                    "supervised_component": 0.40508392453193665,
                    "features_accuracy": [
                        0.7825557589530945,
                        0.810496985912323,
                        0.8782454133033752,
                        0.8949289917945862,
                        0.9004057049751282,
                        0.8920385241508484,
                        0.8738336563110352,
                        0.8993407487869263,
                        0.8923935294151306,
                        0.8906693458557129,
                        0.9948782920837402,
                        0.8033468723297119,
                        0.8804766535758972,
                        0.8980222940444946,
                        0.8887931108474731,
                        0.9108012318611145,
                        0.8742393255233765,
                        0.8812880516052246,
                        0.7063894271850586,
                        0.9003042578697205,
                        0.8969066739082336,
                        0.8407200574874878,
                        0.827839732170105,
                        0.8724138140678406,
                        0.8336713910102844,
                        0.8360547423362732,
                        0.7308316230773926,
                        0.7018255591392517,
                        0.7639959454536438,
                        0.9892494678497314,
                        0.9463995695114136,
                        0.9956896305084229,
                        0.9366632699966431,
                        0.9320994019508362,
                        0.9309330582618713,
                        0.932758629322052,
                        0.9348884224891663,
                        0.9390973448753357,
                        0.9351927042007446,
                        0.9383367300033569,
                        0.9358012080192566,
                        0.9329107403755188,
                        0.8733265995979309,
                        0.9311866164207458,
                        0.9376267790794373,
                        0.933874249458313,
                        0.8991886377334595,
                        0.8805273771286011,
                        0.8936105370521545,
                        0.9981744289398193,
                        0.7374746203422546
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -3.886392518160868,
                    "pretrain_loss": 0.6871268451213837,
                    "pretrain_component": 0.2741149067878723,
                    "supervised_component": 0.41301193833351135,
                    "features_accuracy": [
                        0.7828315496444702,
                        0.8183432817459106,
                        0.8832324743270874,
                        0.8974359035491943,
                        0.9040586948394775,
                        0.8976389169692993,
                        0.882617175579071,
                        0.903627336025238,
                        0.8974485993385315,
                        0.8988505601882935,
                        0.9956038594245911,
                        0.8040828108787537,
                        0.8908004760742188,
                        0.9008995294570923,
                        0.8941054940223694,
                        0.9144051671028137,
                        0.876876175403595,
                        0.8926782011985779,
                        0.6984102725982666,
                        0.9018384218215942,
                        0.9017305374145508,
                        0.8483551144599915,
                        0.8358137011528015,
                        0.8808409571647644,
                        0.84605872631073,
                        0.8491798043251038,
                        0.7428221702575684,
                        0.7010555863380432,
                        0.7626016736030579,
                        0.989393413066864,
                        0.9448229670524597,
                        0.995610237121582,
                        0.9366015791893005,
                        0.9349966645240784,
                        0.9328778982162476,
                        0.9359925985336304,
                        0.9363859295845032,
                        0.9383524656295776,
                        0.9384729862213135,
                        0.9407122731208801,
                        0.9386442303657532,
                        0.9356817603111267,
                        0.8772567510604858,
                        0.9320532083511353,
                        0.9355993270874023,
                        0.9364747405052185,
                        0.9109352231025696,
                        0.8875334858894348,
                        0.900144636631012,
                        0.9975513815879822,
                        0.7634580731391907
                    ]
                },
                "val": {
                    "score": -5.482328852446431,
                    "pretrain_loss": 0.6652838587760925,
                    "pretrain_component": 0.2745695114135742,
                    "supervised_component": 0.3907143473625183,
                    "features_accuracy": [
                        0.7858229279518127,
                        0.8162965178489685,
                        0.882973313331604,
                        0.9007200002670288,
                        0.9024439454078674,
                        0.8974748849868774,
                        0.8875367641448975,
                        0.9006185531616211,
                        0.8949903249740601,
                        0.8929621577262878,
                        0.9950816035270691,
                        0.8033667802810669,
                        0.8894128203392029,
                        0.9023425579071045,
                        0.8952945470809937,
                        0.9166412949562073,
                        0.8766859173774719,
                        0.8903254866600037,
                        0.6983571648597717,
                        0.8974748849868774,
                        0.9001622200012207,
                        0.8543251156806946,
                        0.832116425037384,
                        0.8797789216041565,
                        0.8452489376068115,
                        0.8432207703590393,
                        0.73557448387146,
                        0.7039853930473328,
                        0.7632592916488647,
                        0.9890984296798706,
                        0.9440218806266785,
                        0.9948281049728394,
                        0.9351485371589661,
                        0.9333231449127197,
                        0.9321062564849854,
                        0.935858428478241,
                        0.9357569813728333,
                        0.9354020357131958,
                        0.940827488899231,
                        0.9418415427207947,
                        0.9378865957260132,
                        0.9358077049255371,
                        0.8805394768714905,
                        0.9322583675384521,
                        0.9362640380859375,
                        0.9382922649383545,
                        0.9130919575691223,
                        0.8847479820251465,
                        0.8981847167015076,
                        0.9975154399871826,
                        0.7661494612693787
                    ]
                },
                "test": {
                    "score": -5.745623100144411,
                    "pretrain_loss": 0.6735175251960754,
                    "pretrain_component": 0.27420637011528015,
                    "supervised_component": 0.3993111550807953,
                    "features_accuracy": [
                        0.7843813300132751,
                        0.810496985912323,
                        0.8817444443702698,
                        0.8986308574676514,
                        0.9040567874908447,
                        0.8982251286506653,
                        0.8787018060684204,
                        0.9063387513160706,
                        0.8975152373313904,
                        0.8958417773246765,
                        0.9951825737953186,
                        0.8050709962844849,
                        0.887829601764679,
                        0.9036511182785034,
                        0.8929513096809387,
                        0.9151622653007507,
                        0.8780933022499084,
                        0.8893002271652222,
                        0.7063387632369995,
                        0.9055274128913879,
                        0.9019269943237305,
                        0.8515213131904602,
                        0.8332149982452393,
                        0.8817444443702698,
                        0.8419878482818604,
                        0.849442183971405,
                        0.7370182871818542,
                        0.7018255591392517,
                        0.766075074672699,
                        0.9896044731140137,
                        0.9467545747756958,
                        0.9956389665603638,
                        0.9376775026321411,
                        0.9339756369590759,
                        0.9315922856330872,
                        0.9334685802459717,
                        0.9373732209205627,
                        0.9405679702758789,
                        0.9382860064506531,
                        0.9393509030342102,
                        0.9380324482917786,
                        0.934989869594574,
                        0.8765720129013062,
                        0.9329107403755188,
                        0.9398072957992554,
                        0.9345842003822327,
                        0.9071500897407532,
                        0.8869675397872925,
                        0.9017748236656189,
                        0.9980730414390564,
                        0.7673428058624268
                    ]
                }
            }
        },
        "train": {
            "score": -4.2743657270115785
        },
        "val": {
            "score": -5.4500689102415185
        },
        "test": {
            "score": -5.678719190298293
        }
    },
    "best_iteration": 10000,
    "time": "0:08:37"
}
