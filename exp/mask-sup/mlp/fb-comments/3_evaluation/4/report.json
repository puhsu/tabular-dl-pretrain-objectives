{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised___44f60819937d45f1bc3d10c1c30fbdae.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 4,
        "data": {
            "path": "data/fb-comments",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512,
                    512
                ],
                "dropout": 0.17268933438574993
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [],
            "d_num_embedding": null,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 512,
            "lr": 9.340061002994785e-05,
            "weight_decay": 0.0,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.30212150355754686,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 9.340061002994785e-05,
            "weight_decay": 0.0,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "epoch_size": 308,
    "n_parameters": 619572,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -4.514409376900834,
                    "pretrain_loss": 0.777379035949707,
                    "pretrain_component": 0.3259383738040924,
                    "supervised_component": 0.4514406621456146,
                    "features_accuracy": [
                        0.7378994822502136,
                        0.8155331015586853,
                        0.8663457036018372,
                        0.8799781799316406,
                        0.8901534080505371,
                        0.8736535906791687,
                        0.8658318519592285,
                        0.8732412457466125,
                        0.8777452111244202,
                        0.8783478736877441,
                        0.9953882098197937,
                        0.7785623073577881,
                        0.868001401424408,
                        0.8814499378204346,
                        0.8643728494644165,
                        0.8803588151931763,
                        0.8632563352584839,
                        0.8659904599189758,
                        0.6994886994361877,
                        0.8683693408966064,
                        0.8820906281471252,
                        0.8182100653648376,
                        0.8112066984176636,
                        0.8329527378082275,
                        0.8211598992347717,
                        0.7386924624443054,
                        0.7155888676643372,
                        0.7017343640327454,
                        0.7480049133300781,
                        0.9887146949768066,
                        0.9354153275489807,
                        0.9955721497535706,
                        0.9254748225212097,
                        0.9234004616737366,
                        0.919429361820221,
                        0.9256905317306519,
                        0.9240094423294067,
                        0.9290209412574768,
                        0.9280440211296082,
                        0.9291985630989075,
                        0.9283421635627747,
                        0.9240982532501221,
                        0.8629835844039917,
                        0.9202539920806885,
                        0.9249610304832458,
                        0.9256080389022827,
                        0.8705769181251526,
                        0.866529643535614,
                        0.8746876120567322,
                        0.9978432059288025,
                        0.7182976603507996
                    ]
                },
                "val": {
                    "score": -5.483361667691837,
                    "pretrain_loss": 0.7528899610042572,
                    "pretrain_component": 0.32584694027900696,
                    "supervised_component": 0.42704302072525024,
                    "features_accuracy": [
                        0.7367406487464905,
                        0.8171584606170654,
                        0.8678632974624634,
                        0.8817057013511658,
                        0.888702929019928,
                        0.8739478588104248,
                        0.8676097393035889,
                        0.8750126361846924,
                        0.8783591389656067,
                        0.879423975944519,
                        0.9948787689208984,
                        0.7792313098907471,
                        0.8674069046974182,
                        0.8792211413383484,
                        0.8647702932357788,
                        0.884393036365509,
                        0.8589392304420471,
                        0.8610181212425232,
                        0.7009937763214111,
                        0.8715647459030151,
                        0.8835817575454712,
                        0.8156880140304565,
                        0.8066625595092773,
                        0.8366798162460327,
                        0.8176148533821106,
                        0.7371463179588318,
                        0.7138727903366089,
                        0.7085487842559814,
                        0.7459689378738403,
                        0.9882364869117737,
                        0.9350471496582031,
                        0.9947773814201355,
                        0.9258695840835571,
                        0.9264273047447205,
                        0.9201399087905884,
                        0.9270357489585876,
                        0.9249061942100525,
                        0.9293681979179382,
                        0.9256667494773865,
                        0.9287090301513672,
                        0.9255146384239197,
                        0.9248554706573486,
                        0.8621843457221985,
                        0.9179596304893494,
                        0.9263765811920166,
                        0.9277963638305664,
                        0.8712605237960815,
                        0.8669505715370178,
                        0.876584529876709,
                        0.9972619414329529,
                        0.7144812941551208
                    ]
                },
                "test": {
                    "score": -5.691683162849213,
                    "pretrain_loss": 0.7815627157688141,
                    "pretrain_component": 0.3259645104408264,
                    "supervised_component": 0.45559820532798767,
                    "features_accuracy": [
                        0.7348377108573914,
                        0.8161764740943909,
                        0.8630831837654114,
                        0.8788032531738281,
                        0.8927484750747681,
                        0.8725152015686035,
                        0.8656693696975708,
                        0.8737322688102722,
                        0.8778397440910339,
                        0.8772819638252258,
                        0.9954361319541931,
                        0.7832657098770142,
                        0.8683062791824341,
                        0.879969596862793,
                        0.8636916875839233,
                        0.8803245425224304,
                        0.8625253438949585,
                        0.8690669536590576,
                        0.6958925127983093,
                        0.8680527210235596,
                        0.8843306303024292,
                        0.8208417892456055,
                        0.8092799186706543,
                        0.8284482955932617,
                        0.8200811147689819,
                        0.7367140054702759,
                        0.7164300084114075,
                        0.7033975720405579,
                        0.7451318502426147,
                        0.9880831837654114,
                        0.9314908981323242,
                        0.9962981939315796,
                        0.9278397560119629,
                        0.9204868078231812,
                        0.9190669655799866,
                        0.9279918670654297,
                        0.9245943427085876,
                        0.9282961487770081,
                        0.9265213012695312,
                        0.9279412031173706,
                        0.9291582107543945,
                        0.925507128238678,
                        0.8628296256065369,
                        0.9207910895347595,
                        0.9256085157394409,
                        0.9219574332237244,
                        0.8726166486740112,
                        0.8673934936523438,
                        0.878346860408783,
                        0.998275876045227,
                        0.7148073315620422
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -4.563659282530127,
                    "pretrain_loss": 0.7262512743473053,
                    "pretrain_component": 0.30029651522636414,
                    "supervised_component": 0.42595475912094116,
                    "features_accuracy": [
                        0.7731194496154785,
                        0.8146767020225525,
                        0.8729938268661499,
                        0.8892145752906799,
                        0.8972011804580688,
                        0.8892208933830261,
                        0.8770411014556885,
                        0.8907433748245239,
                        0.8918091058731079,
                        0.8904832601547241,
                        0.9952296018600464,
                        0.7948591113090515,
                        0.8743957877159119,
                        0.8921199440956116,
                        0.8771743178367615,
                        0.8891257643699646,
                        0.8713127970695496,
                        0.8695428967475891,
                        0.6992413401603699,
                        0.8980385661125183,
                        0.8959007263183594,
                        0.8335427045822144,
                        0.821781575679779,
                        0.857521653175354,
                        0.834316611289978,
                        0.791966438293457,
                        0.7272548675537109,
                        0.7007447481155396,
                        0.7591887712478638,
                        0.9888923168182373,
                        0.9391834735870361,
                        0.9956926703453064,
                        0.9304546117782593,
                        0.926768958568573,
                        0.9228168725967407,
                        0.926971971988678,
                        0.9264517426490784,
                        0.9319390058517456,
                        0.9333853721618652,
                        0.9331887364387512,
                        0.9330618381500244,
                        0.926965594291687,
                        0.8715348243713379,
                        0.9247072339057922,
                        0.9281518459320068,
                        0.9307083487510681,
                        0.8895761370658875,
                        0.8803461194038391,
                        0.8930017352104187,
                        0.9978495240211487,
                        0.7199215888977051
                    ]
                },
                "val": {
                    "score": -5.487183268384344,
                    "pretrain_loss": 0.7077136337757111,
                    "pretrain_component": 0.3003147542476654,
                    "supervised_component": 0.40739887952804565,
                    "features_accuracy": [
                        0.7759861946105957,
                        0.8166007399559021,
                        0.8763309717178345,
                        0.8894635438919067,
                        0.895598828792572,
                        0.8902748227119446,
                        0.878105640411377,
                        0.8910861015319824,
                        0.8940269351005554,
                        0.8903762102127075,
                        0.9943717122077942,
                        0.7994624972343445,
                        0.8748098611831665,
                        0.8904775977134705,
                        0.8796268105506897,
                        0.8919480443000793,
                        0.8683702945709229,
                        0.8657336831092834,
                        0.7009937763214111,
                        0.9001622200012207,
                        0.8958523273468018,
                        0.829429030418396,
                        0.8175134062767029,
                        0.8588885068893433,
                        0.8315586447715759,
                        0.7926680445671082,
                        0.7262448072433472,
                        0.7085487842559814,
                        0.7622451782226562,
                        0.9883885979652405,
                        0.9377344846725464,
                        0.9948281049728394,
                        0.929621696472168,
                        0.9299259185791016,
                        0.9229794144630432,
                        0.929520308971405,
                        0.9273906946182251,
                        0.9312949776649475,
                        0.9301287531852722,
                        0.9318526983261108,
                        0.9299259185791016,
                        0.9269850850105286,
                        0.8721224665641785,
                        0.9225737452507019,
                        0.9281512498855591,
                        0.9323597550392151,
                        0.8918973207473755,
                        0.880184531211853,
                        0.8937734365463257,
                        0.9972619414329529,
                        0.7145319581031799
                    ]
                },
                "test": {
                    "score": -5.75928708143672,
                    "pretrain_loss": 0.7359814643859863,
                    "pretrain_component": 0.30061909556388855,
                    "supervised_component": 0.4353623688220978,
                    "features_accuracy": [
                        0.7718560099601746,
                        0.8159229159355164,
                        0.870030403137207,
                        0.8891480565071106,
                        0.8992900848388672,
                        0.8883874416351318,
                        0.8776876330375671,
                        0.8901622891426086,
                        0.8930527567863464,
                        0.8880324363708496,
                        0.9949290156364441,
                        0.8013691902160645,
                        0.8758620619773865,
                        0.8926470875740051,
                        0.8786511421203613,
                        0.8892495036125183,
                        0.8721095323562622,
                        0.872768759727478,
                        0.6958925127983093,
                        0.8973630666732788,
                        0.8970588445663452,
                        0.8331642746925354,
                        0.8180020451545715,
                        0.8552738428115845,
                        0.8320993781089783,
                        0.7919878363609314,
                        0.7293103337287903,
                        0.7033975720405579,
                        0.7571501135826111,
                        0.9880324602127075,
                        0.934989869594574,
                        0.9961967468261719,
                        0.9326065182685852,
                        0.925000011920929,
                        0.9209939241409302,
                        0.9308823347091675,
                        0.9258113503456116,
                        0.9311866164207458,
                        0.9318458437919617,
                        0.93215012550354,
                        0.9330121874809265,
                        0.9280933141708374,
                        0.8697261810302734,
                        0.9246957302093506,
                        0.9284482598304749,
                        0.9263691902160645,
                        0.8921399712562561,
                        0.8804766535758972,
                        0.8941176533699036,
                        0.9983265995979309,
                        0.7148073315620422
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -4.479495397248107,
                    "pretrain_loss": 0.7037968039512634,
                    "pretrain_component": 0.28637850284576416,
                    "supervised_component": 0.41741830110549927,
                    "features_accuracy": [
                        0.7829330563545227,
                        0.8153871893882751,
                        0.8768951892852783,
                        0.895222008228302,
                        0.9005252718925476,
                        0.8939278721809387,
                        0.8790393471717834,
                        0.8962242603302002,
                        0.8972265720367432,
                        0.895945131778717,
                        0.9949631690979004,
                        0.8015326261520386,
                        0.87846839427948,
                        0.8943973183631897,
                        0.8802192807197571,
                        0.8920628428459167,
                        0.8785699009895325,
                        0.8702026605606079,
                        0.7002943754196167,
                        0.9109796285629272,
                        0.9043822288513184,
                        0.8390235900878906,
                        0.8267613053321838,
                        0.8687245845794678,
                        0.8416435122489929,
                        0.8124881386756897,
                        0.733395516872406,
                        0.7014933228492737,
                        0.7638577222824097,
                        0.9890762567520142,
                        0.9418604969978333,
                        0.9952422976493835,
                        0.9340070486068726,
                        0.9318819046020508,
                        0.9275872707366943,
                        0.9327827095985413,
                        0.9340831637382507,
                        0.9372613430023193,
                        0.9374770522117615,
                        0.9368109703063965,
                        0.9348507523536682,
                        0.9320532083511353,
                        0.8709701895713806,
                        0.9289258122444153,
                        0.9319834113121033,
                        0.9348000288009644,
                        0.8958753943443298,
                        0.8880853652954102,
                        0.9007663130760193,
                        0.9976274967193604,
                        0.7387495636940002
                    ]
                },
                "val": {
                    "score": -5.500715491168538,
                    "pretrain_loss": 0.6809324026107788,
                    "pretrain_component": 0.2859337329864502,
                    "supervised_component": 0.3949986696243286,
                    "features_accuracy": [
                        0.7825270891189575,
                        0.8166007399559021,
                        0.8784098625183105,
                        0.8961565494537354,
                        0.897779107093811,
                        0.8961058259010315,
                        0.8816549777984619,
                        0.8963086605072021,
                        0.8987932205200195,
                        0.8945339918136597,
                        0.9943210482597351,
                        0.8060541152954102,
                        0.8796268105506897,
                        0.8931142687797546,
                        0.8828212022781372,
                        0.8937734365463257,
                        0.8764830827713013,
                        0.8693844079971313,
                        0.7009937763214111,
                        0.9114186763763428,
                        0.9050806164741516,
                        0.8367305397987366,
                        0.8238515257835388,
                        0.8715647459030151,
                        0.8410911560058594,
                        0.8106175661087036,
                        0.7316194772720337,
                        0.7085487842559814,
                        0.7625494003295898,
                        0.9886928200721741,
                        0.9424500465393066,
                        0.9944731593132019,
                        0.9336780905723572,
                        0.9356048703193665,
                        0.9288104176521301,
                        0.9348950386047363,
                        0.9341344237327576,
                        0.9371767044067383,
                        0.9356555938720703,
                        0.9354020357131958,
                        0.9326639771461487,
                        0.932309091091156,
                        0.8715140223503113,
                        0.9267822504043579,
                        0.9333231449127197,
                        0.9376330971717834,
                        0.8995537757873535,
                        0.8864212036132812,
                        0.9001622200012207,
                        0.9972619414329529,
                        0.7351688146591187
                    ]
                },
                "test": {
                    "score": -5.75238053865993,
                    "pretrain_loss": 0.7117123603820801,
                    "pretrain_component": 0.28631559014320374,
                    "supervised_component": 0.42539677023887634,
                    "features_accuracy": [
                        0.7830628752708435,
                        0.8159229159355164,
                        0.8731237649917603,
                        0.896095335483551,
                        0.9045131802558899,
                        0.89497971534729,
                        0.8803245425224304,
                        0.8966024518013,
                        0.8968052864074707,
                        0.8926977515220642,
                        0.9951318502426147,
                        0.8080121874809265,
                        0.8798174262046814,
                        0.8947261571884155,
                        0.8825557827949524,
                        0.8906186819076538,
                        0.8803245425224304,
                        0.8762170672416687,
                        0.6959432363510132,
                        0.9098377227783203,
                        0.9053752422332764,
                        0.8406693935394287,
                        0.823833703994751,
                        0.8667342662811279,
                        0.8408722281455994,
                        0.8130831718444824,
                        0.7366125583648682,
                        0.7033975720405579,
                        0.7571501135826111,
                        0.9881339073181152,
                        0.9387423992156982,
                        0.9956896305084229,
                        0.9371703863143921,
                        0.931744396686554,
                        0.9252535700798035,
                        0.9369168281555176,
                        0.9336206912994385,
                        0.9369675517082214,
                        0.9365618824958801,
                        0.9345334768295288,
                        0.9358012080192566,
                        0.9319472908973694,
                        0.8697769045829773,
                        0.9282454252243042,
                        0.9322007894515991,
                        0.9296653270721436,
                        0.9003042578697205,
                        0.886713981628418,
                        0.9014706015586853,
                        0.9983265995979309,
                        0.736663281917572
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -4.456150028279591,
                    "pretrain_loss": 0.6843468248844147,
                    "pretrain_component": 0.2755061984062195,
                    "supervised_component": 0.4088406264781952,
                    "features_accuracy": [
                        0.7831360697746277,
                        0.81544429063797,
                        0.8825854063034058,
                        0.8973217010498047,
                        0.9053971767425537,
                        0.8976389169692993,
                        0.8918662071228027,
                        0.9018701314926147,
                        0.9028026461601257,
                        0.8982225060462952,
                        0.9954453110694885,
                        0.8031566143035889,
                        0.8827313184738159,
                        0.8985143303871155,
                        0.8856684565544128,
                        0.8979624509811401,
                        0.8850721716880798,
                        0.8771489262580872,
                        0.6996726989746094,
                        0.9175770282745361,
                        0.9100027084350586,
                        0.8505690693855286,
                        0.8340755701065063,
                        0.8772948384284973,
                        0.8492051362991333,
                        0.8289815783500671,
                        0.7412425875663757,
                        0.7006686329841614,
                        0.761618435382843,
                        0.989469587802887,
                        0.9449498653411865,
                        0.9957180619239807,
                        0.9350220561027527,
                        0.9329159259796143,
                        0.9307971596717834,
                        0.9340260624885559,
                        0.9356627464294434,
                        0.9383968710899353,
                        0.9375531673431396,
                        0.9390629529953003,
                        0.9389360547065735,
                        0.9353138208389282,
                        0.8821033239364624,
                        0.9313173294067383,
                        0.9339816570281982,
                        0.9350283741950989,
                        0.9002207517623901,
                        0.8947842717170715,
                        0.906887948513031,
                        0.9979193210601807,
                        0.7690404653549194
                    ]
                },
                "val": {
                    "score": -5.500191386340859,
                    "pretrain_loss": 0.6616095900535583,
                    "pretrain_component": 0.27546072006225586,
                    "supervised_component": 0.3861488699913025,
                    "features_accuracy": [
                        0.7836933135986328,
                        0.8166007399559021,
                        0.8830747008323669,
                        0.8985903859138489,
                        0.9026974439620972,
                        0.9003143310546875,
                        0.8908832669258118,
                        0.9023425579071045,
                        0.9030017256736755,
                        0.8986411094665527,
                        0.9946759939193726,
                        0.8072203397750854,
                        0.884494423866272,
                        0.8979819416999817,
                        0.8873339295387268,
                        0.9014805555343628,
                        0.8813507556915283,
                        0.8736943006515503,
                        0.701703667640686,
                        0.9181117415428162,
                        0.9084778428077698,
                        0.8449954390525818,
                        0.830088198184967,
                        0.8777506947517395,
                        0.8464658260345459,
                        0.8291248083114624,
                        0.7386167645454407,
                        0.7085487842559814,
                        0.7617888450622559,
                        0.9885407090187073,
                        0.9439711570739746,
                        0.9947266578674316,
                        0.9344386458396912,
                        0.9367710947990417,
                        0.9331203699111938,
                        0.9359090924263,
                        0.9372274279594421,
                        0.9376837611198425,
                        0.9369232058525085,
                        0.9372274279594421,
                        0.9362133145332336,
                        0.9353513717651367,
                        0.8840380907058716,
                        0.930280864238739,
                        0.9343879818916321,
                        0.9396612644195557,
                        0.9029510021209717,
                        0.8937734365463257,
                        0.909846842288971,
                        0.997211217880249,
                        0.7639691233634949
                    ]
                },
                "test": {
                    "score": -5.733307250439498,
                    "pretrain_loss": 0.6925670206546783,
                    "pretrain_component": 0.27583909034729004,
                    "supervised_component": 0.4167279303073883,
                    "features_accuracy": [
                        0.7841784954071045,
                        0.8159229159355164,
                        0.8786511421203613,
                        0.900050699710846,
                        0.9071500897407532,
                        0.8979209065437317,
                        0.8906693458557129,
                        0.9021298289299011,
                        0.9007606506347656,
                        0.8958417773246765,
                        0.9954867959022522,
                        0.8098377585411072,
                        0.8830628991127014,
                        0.8987829685211182,
                        0.8865618705749512,
                        0.8970081210136414,
                        0.8843306303024292,
                        0.8803752660751343,
                        0.6969066858291626,
                        0.9176977872848511,
                        0.909939169883728,
                        0.8484280109405518,
                        0.8291075229644775,
                        0.8735800981521606,
                        0.8469573855400085,
                        0.828955352306366,
                        0.7449290156364441,
                        0.7033975720405579,
                        0.7584178447723389,
                        0.988286018371582,
                        0.9421399831771851,
                        0.996146023273468,
                        0.9379817247390747,
                        0.9319979548454285,
                        0.9288032650947571,
                        0.9376775026321411,
                        0.9361562132835388,
                        0.9381338953971863,
                        0.9373732209205627,
                        0.9364097118377686,
                        0.9387423992156982,
                        0.9340770840644836,
                        0.8795639276504517,
                        0.9311866164207458,
                        0.9340770840644836,
                        0.9323022365570068,
                        0.9024341106414795,
                        0.8943712115287781,
                        0.9102433919906616,
                        0.9983265995979309,
                        0.7651622891426086
                    ]
                }
            }
        },
        "train": {
            "score": -4.514409376900834
        },
        "val": {
            "score": -5.483361667691837
        },
        "test": {
            "score": -5.691683162849213
        }
    },
    "best_iteration": 10000,
    "time": "0:07:57"
}
