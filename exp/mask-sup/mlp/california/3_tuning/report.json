{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/tune.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 0,
        "program": "bin/pretrain_mask_supervised.py",
        "base_config": {
            "seed": 0,
            "data": {
                "T_cache": true,
                "path": "data/california",
                "T": {
                    "normalization": "quantile"
                }
            },
            "model": {
                "kind": "mlp"
            },
            "training": {
                "batch_size": 128,
                "patience": 16
            },
            "pretrain": {
                "corrupt_strategy": "resample",
                "patience": 2,
                "d_hidden_head": 512
            }
        },
        "space": {
            "model": {
                "config": {
                    "d_layers": [
                        "$fixed_mlp_d_layers",
                        1,
                        8,
                        512
                    ],
                    "dropout": [
                        "?uniform",
                        0.0,
                        0.0,
                        0.5
                    ]
                }
            },
            "pretrain": {
                "corrupt_probability": [
                    "uniform",
                    0.2,
                    0.8
                ]
            },
            "training": {
                "lr": [
                    "loguniform",
                    5e-05,
                    0.005
                ],
                "weight_decay": [
                    "?loguniform",
                    0.0,
                    1e-06,
                    0.001
                ]
            }
        },
        "n_trials": 100,
        "timeout": null,
        "sampler": {
            "seed": 0
        }
    },
    "best": {
        "program": "bin/pretrain_mask_supervised.py",
        "environment": {
            "CUDA_VISIBLE_DEVICES": "0",
            "gpus": {
                "driver": "450.119.04",
                "devices": [
                    {
                        "name": "A100-SXM-80GB",
                        "memory_total": 85199093760,
                        "memory_free": 85195948032,
                        "memory_used": 3145728,
                        "utilization": 0
                    }
                ]
            },
            "torch.version.cuda": "11.1",
            "torch.backends.cudnn.version()": 8005,
            "torch.cuda.nccl.version()": [
                2,
                10,
                3
            ]
        },
        "config": {
            "seed": 0,
            "data": {
                "path": "data/california",
                "T": {
                    "seed": 0,
                    "normalization": "quantile",
                    "num_nan_policy": null,
                    "cat_nan_policy": null,
                    "cat_min_frequency": null,
                    "cat_encoding": null,
                    "y_policy": "default"
                },
                "T_cache": true
            },
            "model": {
                "kind": "mlp",
                "config": {
                    "d_layers": [
                        512,
                        512,
                        512,
                        512,
                        512
                    ],
                    "dropout": 0.0
                },
                "default": true,
                "checkpoint": null,
                "num_embedding_arch": [],
                "d_num_embedding": null,
                "positional_encoding": null,
                "d_cat_embedding": null
            },
            "training": {
                "batch_size": 128,
                "lr": 0.0002753685470498323,
                "weight_decay": 0.0,
                "optimizer": "AdamW",
                "patience": 16,
                "n_epochs": Infinity,
                "eval_batch_size": 8192
            },
            "pretrain": {
                "corrupt_probability": 0.5015773029492148,
                "corrupt_strategy": "resample",
                "d_hidden_head": 512,
                "lr": 0.0002753685470498323,
                "weight_decay": 0.0,
                "patience": 2,
                "n_iterations": 100000,
                "validate_every": 10000,
                "replace_strategy": "shuffle",
                "n_neighbors": 20,
                "use_target": false,
                "early_stop_type": "finetune",
                "target_injection_type": "post"
            },
            "bins": null
        },
        "epoch_size": 104,
        "n_parameters": 1322505,
        "metrics": {
            "iteration_scores": {
                "10000": {
                    "train": {
                        "score": -0.33124308724895635,
                        "pretrain_loss": 1.381633996963501,
                        "pretrain_component": 0.6664842367172241,
                        "supervised_component": 0.7151497602462769,
                        "features_accuracy": [
                            0.5965629816055298,
                            0.5151790380477905,
                            0.593837559223175,
                            0.5232039093971252,
                            0.4933757483959198,
                            0.5366795659065247,
                            0.6609130501747131,
                            0.6613672971725464
                        ]
                    },
                    "val": {
                        "score": -0.46781418614730386,
                        "pretrain_loss": 1.3985956311225891,
                        "pretrain_component": 0.6679444909095764,
                        "supervised_component": 0.7306511402130127,
                        "features_accuracy": [
                            0.5882530808448792,
                            0.4992431104183197,
                            0.5846200585365295,
                            0.5068119764328003,
                            0.5028761625289917,
                            0.5401150584220886,
                            0.6430517435073853,
                            0.6603087782859802
                        ]
                    },
                    "test": {
                        "score": -0.4708142435445661,
                        "pretrain_loss": 1.3690597414970398,
                        "pretrain_component": 0.66560959815979,
                        "supervised_component": 0.7034501433372498,
                        "features_accuracy": [
                            0.5961724519729614,
                            0.5186530947685242,
                            0.5995639562606812,
                            0.5133236646652222,
                            0.4990310072898865,
                            0.5307654738426208,
                            0.6572189927101135,
                            0.6686046719551086
                        ]
                    }
                },
                "20000": {
                    "train": {
                        "score": -0.36041452765008186,
                        "pretrain_loss": 1.3478368520736694,
                        "pretrain_component": 0.6589869856834412,
                        "supervised_component": 0.6888498663902283,
                        "features_accuracy": [
                            0.6001968383789062,
                            0.5461428165435791,
                            0.6036036014556885,
                            0.5170717239379883,
                            0.5064728856086731,
                            0.5568930506706238,
                            0.6721932291984558,
                            0.6775683760643005
                        ]
                    },
                    "val": {
                        "score": -0.4556186158446239,
                        "pretrain_loss": 1.383315920829773,
                        "pretrain_component": 0.6625248193740845,
                        "supervised_component": 0.7207911014556885,
                        "features_accuracy": [
                            0.5906751155853271,
                            0.5516197085380554,
                            0.6009688377380371,
                            0.5049954652786255,
                            0.5122615694999695,
                            0.5488949418067932,
                            0.652739942073822,
                            0.6754465699195862
                        ]
                    },
                    "test": {
                        "score": -0.4594222968819628,
                        "pretrain_loss": 1.3481904864311218,
                        "pretrain_component": 0.6600566506385803,
                        "supervised_component": 0.6881338357925415,
                        "features_accuracy": [
                            0.59375,
                            0.5356104373931885,
                            0.604651153087616,
                            0.5159883499145508,
                            0.5060561895370483,
                            0.5406976938247681,
                            0.6727228760719299,
                            0.6792635917663574
                        ]
                    }
                },
                "30000": {
                    "train": {
                        "score": -0.3223905784843565,
                        "pretrain_loss": 1.3334357738494873,
                        "pretrain_component": 0.6547548770904541,
                        "supervised_component": 0.6786808967590332,
                        "features_accuracy": [
                            0.6040578484535217,
                            0.565372109413147,
                            0.6023166179656982,
                            0.5241880416870117,
                            0.5054129958152771,
                            0.562192440032959,
                            0.6757513880729675,
                            0.6852903366088867
                        ]
                    },
                    "val": {
                        "score": -0.4489298564355731,
                        "pretrain_loss": 1.3643240928649902,
                        "pretrain_component": 0.6592909097671509,
                        "supervised_component": 0.7050331830978394,
                        "features_accuracy": [
                            0.6009688377380371,
                            0.5516197085380554,
                            0.5985468029975891,
                            0.5219497680664062,
                            0.5183166861534119,
                            0.5622161626815796,
                            0.6587950587272644,
                            0.6875567436218262
                        ]
                    },
                    "test": {
                        "score": -0.45282536877018204,
                        "pretrain_loss": 1.3331550359725952,
                        "pretrain_component": 0.6554028391838074,
                        "supervised_component": 0.6777521967887878,
                        "features_accuracy": [
                            0.6034399271011353,
                            0.5663759708404541,
                            0.6044089198112488,
                            0.5155038833618164,
                            0.5106589198112488,
                            0.5704941749572754,
                            0.6751453280448914,
                            0.6899224519729614
                        ]
                    }
                },
                "40000": {
                    "train": {
                        "score": -0.342574443398464,
                        "pretrain_loss": 1.3145405650138855,
                        "pretrain_component": 0.6515568494796753,
                        "supervised_component": 0.6629837155342102,
                        "features_accuracy": [
                            0.6145809888839722,
                            0.5805132985115051,
                            0.6044363975524902,
                            0.523809552192688,
                            0.5138920545578003,
                            0.5729427337646484,
                            0.6743887066841125,
                            0.6852903366088867
                        ]
                    },
                    "val": {
                        "score": -0.44634896075386654,
                        "pretrain_loss": 1.363610565662384,
                        "pretrain_component": 0.6580363512039185,
                        "supervised_component": 0.7055742144584656,
                        "features_accuracy": [
                            0.6027853488922119,
                            0.5549500584602356,
                            0.6006660461425781,
                            0.5122615694999695,
                            0.5192249417304993,
                            0.5725098252296448,
                            0.6669694185256958,
                            0.6830154657363892
                        ]
                    },
                    "test": {
                        "score": -0.44315510447230055,
                        "pretrain_loss": 1.326847493648529,
                        "pretrain_component": 0.6541673541069031,
                        "supervised_component": 0.672680139541626,
                        "features_accuracy": [
                            0.6022287011146545,
                            0.5738856792449951,
                            0.6160368323326111,
                            0.5152616500854492,
                            0.5152616500854492,
                            0.5632267594337463,
                            0.6770833134651184,
                            0.6962209343910217
                        ]
                    }
                },
                "50000": {
                    "train": {
                        "score": -0.30035726195707046,
                        "pretrain_loss": 1.3074952960014343,
                        "pretrain_component": 0.6501185297966003,
                        "supervised_component": 0.657376766204834,
                        "features_accuracy": [
                            0.6067832708358765,
                            0.5835415720939636,
                            0.6110228300094604,
                            0.5290332436561584,
                            0.5400863289833069,
                            0.5712014436721802,
                            0.6792338490486145,
                            0.6891513466835022
                        ]
                    },
                    "val": {
                        "score": -0.4440791411619013,
                        "pretrain_loss": 1.3516141772270203,
                        "pretrain_component": 0.6562755107879639,
                        "supervised_component": 0.6953386664390564,
                        "features_accuracy": [
                            0.5952164530754089,
                            0.5616106390953064,
                            0.6064184308052063,
                            0.5110505819320679,
                            0.531335175037384,
                            0.5722070932388306,
                            0.6681804656982422,
                            0.6851347088813782
                        ]
                    },
                    "test": {
                        "score": -0.4459589628901554,
                        "pretrain_loss": 1.3220773935317993,
                        "pretrain_component": 0.652208685874939,
                        "supervised_component": 0.6698687076568604,
                        "features_accuracy": [
                            0.5978682041168213,
                            0.5709787011146545,
                            0.6082848906517029,
                            0.5176841020584106,
                            0.5261628031730652,
                            0.564437985420227,
                            0.6887112259864807,
                            0.6921027302742004
                        ]
                    }
                },
                "60000": {
                    "train": {
                        "score": -0.24790087226436947,
                        "pretrain_loss": 1.3024480938911438,
                        "pretrain_component": 0.6474501490592957,
                        "supervised_component": 0.6549979448318481,
                        "features_accuracy": [
                            0.6132940053939819,
                            0.5866454839706421,
                            0.6140510439872742,
                            0.5444772839546204,
                            0.5381179451942444,
                            0.5724884867668152,
                            0.6772655248641968,
                            0.6880157589912415
                        ]
                    },
                    "val": {
                        "score": -0.43759369134533727,
                        "pretrain_loss": 1.3531357049942017,
                        "pretrain_component": 0.6552387475967407,
                        "supervised_component": 0.6978969573974609,
                        "features_accuracy": [
                            0.5967302322387695,
                            0.5743263959884644,
                            0.6049046516418457,
                            0.5128670930862427,
                            0.5216469764709473,
                            0.580381453037262,
                            0.667574942111969,
                            0.6899787783622742
                        ]
                    },
                    "test": {
                        "score": -0.4453529777814566,
                        "pretrain_loss": 1.3278098106384277,
                        "pretrain_component": 0.6513386368751526,
                        "supervised_component": 0.6764711737632751,
                        "features_accuracy": [
                            0.5985949635505676,
                            0.5811530947685242,
                            0.6111918687820435,
                            0.5254360437393188,
                            0.5297964811325073,
                            0.5649224519729614,
                            0.6853197813034058,
                            0.6940407156944275
                        ]
                    }
                },
                "70000": {
                    "train": {
                        "score": -0.31235097475650075,
                        "pretrain_loss": 1.3326730728149414,
                        "pretrain_component": 0.6518747210502625,
                        "supervised_component": 0.680798351764679,
                        "features_accuracy": [
                            0.599969744682312,
                            0.5875539779663086,
                            0.6113256216049194,
                            0.521689772605896,
                            0.5247937440872192,
                            0.5720342397689819,
                            0.6814293265342712,
                            0.6788553595542908
                        ]
                    },
                    "val": {
                        "score": -0.44215953070860664,
                        "pretrain_loss": 1.3559685349464417,
                        "pretrain_component": 0.653808057308197,
                        "supervised_component": 0.7021604776382446,
                        "features_accuracy": [
                            0.6000605225563049,
                            0.5758401155471802,
                            0.6049046516418457,
                            0.5201331973075867,
                            0.5322434306144714,
                            0.5764456391334534,
                            0.6678776741027832,
                            0.6902815699577332
                        ]
                    },
                    "test": {
                        "score": -0.4302044903271313,
                        "pretrain_loss": 1.3208125233650208,
                        "pretrain_component": 0.6495069265365601,
                        "supervised_component": 0.6713055968284607,
                        "features_accuracy": [
                            0.6090116500854492,
                            0.5767926573753357,
                            0.6189438104629517,
                            0.5327034592628479,
                            0.5297964811325073,
                            0.5666182041168213,
                            0.6848352551460266,
                            0.6967054009437561
                        ]
                    }
                },
                "80000": {
                    "train": {
                        "score": -0.32216506314608767,
                        "pretrain_loss": 1.2999667525291443,
                        "pretrain_component": 0.6487910747528076,
                        "supervised_component": 0.6511756777763367,
                        "features_accuracy": [
                            0.603679358959198,
                            0.5771065354347229,
                            0.6118555665016174,
                            0.5421304106712341,
                            0.5402377247810364,
                            0.5802862048149109,
                            0.6810508370399475,
                            0.6893027424812317
                        ]
                    },
                    "val": {
                        "score": -0.4375761236650808,
                        "pretrain_loss": 1.348748505115509,
                        "pretrain_component": 0.6537189483642578,
                        "supervised_component": 0.6950295567512512,
                        "features_accuracy": [
                            0.5943081974983215,
                            0.5719043016433716,
                            0.5994550585746765,
                            0.5228580236434937,
                            0.5319406390190125,
                            0.577959418296814,
                            0.6687859296798706,
                            0.6890705227851868
                        ]
                    },
                    "test": {
                        "score": -0.43285014459807747,
                        "pretrain_loss": 1.3180545568466187,
                        "pretrain_component": 0.6490780115127563,
                        "supervised_component": 0.6689765453338623,
                        "features_accuracy": [
                            0.6063469052314758,
                            0.5760658979415894,
                            0.6116763353347778,
                            0.536579430103302,
                            0.5339147448539734,
                            0.5796996355056763,
                            0.679990291595459,
                            0.6899224519729614
                        ]
                    }
                },
                "90000": {
                    "train": {
                        "score": -0.31571145203806883,
                        "pretrain_loss": 1.3207641243934631,
                        "pretrain_component": 0.6484438180923462,
                        "supervised_component": 0.6723203063011169,
                        "features_accuracy": [
                            0.599742591381073,
                            0.5827087759971619,
                            0.6151866316795349,
                            0.5337270498275757,
                            0.5461428165435791,
                            0.5760466456413269,
                            0.68309485912323,
                            0.686274528503418
                        ]
                    },
                    "val": {
                        "score": -0.4349248365100062,
                        "pretrain_loss": 1.350420594215393,
                        "pretrain_component": 0.6534345746040344,
                        "supervised_component": 0.6969860196113586,
                        "features_accuracy": [
                            0.6115652322769165,
                            0.558280348777771,
                            0.5979412794113159,
                            0.5228580236434937,
                            0.5464729070663452,
                            0.5797759890556335,
                            0.6684831976890564,
                            0.687254011631012
                        ]
                    },
                    "test": {
                        "score": -0.4286723473965569,
                        "pretrain_loss": 1.3211463689804077,
                        "pretrain_component": 0.6488029956817627,
                        "supervised_component": 0.672343373298645,
                        "features_accuracy": [
                            0.5942344665527344,
                            0.5835756063461304,
                            0.6102228760719299,
                            0.5215600728988647,
                            0.5402131676673889,
                            0.5799418687820435,
                            0.6833817958831787,
                            0.6906492114067078
                        ]
                    }
                },
                "100000": {
                    "train": {
                        "score": -0.3081360838947051,
                        "pretrain_loss": 1.3025127053260803,
                        "pretrain_component": 0.6453492641448975,
                        "supervised_component": 0.6571634411811829,
                        "features_accuracy": [
                            0.6096600890159607,
                            0.5801347494125366,
                            0.6142781376838684,
                            0.5353168249130249,
                            0.5550761222839355,
                            0.5749110579490662,
                            0.6829434633255005,
                            0.6887728571891785
                        ]
                    },
                    "val": {
                        "score": -0.43364443554665894,
                        "pretrain_loss": 1.3361774682998657,
                        "pretrain_component": 0.6507829427719116,
                        "supervised_component": 0.6853945255279541,
                        "features_accuracy": [
                            0.6009688377380371,
                            0.5855283141136169,
                            0.6064184308052063,
                            0.5352709889411926,
                            0.5392068028450012,
                            0.580684244632721,
                            0.6687859296798706,
                            0.696942150592804
                        ]
                    },
                    "test": {
                        "score": -0.42700017622889797,
                        "pretrain_loss": 1.3142911195755005,
                        "pretrain_component": 0.6483439207077026,
                        "supervised_component": 0.6659471988677979,
                        "features_accuracy": [
                            0.6068313717842102,
                            0.5770348906517029,
                            0.6179748177528381,
                            0.5285852551460266,
                            0.5343992114067078,
                            0.5731589198112488,
                            0.6884689927101135,
                            0.6959787011146545
                        ]
                    }
                }
            },
            "train": {
                "score": -0.3081360838947051
            },
            "val": {
                "score": -0.43364443554665894
            },
            "test": {
                "score": -0.42700017622889797
            }
        },
        "best_iteration": 100000,
        "time": "0:09:10",
        "trial_id": 71,
        "tuning_time": "11:50:43"
    },
    "time": "16:02:05",
    "continuations": [
        21
    ]
}
