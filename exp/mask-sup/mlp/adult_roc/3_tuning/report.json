{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/tune.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 0,
        "program": "bin/pretrain_mask_supervised.py",
        "base_config": {
            "seed": 0,
            "data": {
                "T_cache": true,
                "path": "data/adult_roc",
                "T": {
                    "normalization": "quantile"
                }
            },
            "model": {
                "kind": "mlp"
            },
            "training": {
                "batch_size": 256,
                "patience": 16
            },
            "pretrain": {
                "corrupt_strategy": "resample",
                "patience": 2,
                "d_hidden_head": 512
            }
        },
        "space": {
            "model": {
                "config": {
                    "d_layers": [
                        "$fixed_mlp_d_layers",
                        1,
                        8,
                        512
                    ],
                    "dropout": [
                        "?uniform",
                        0.0,
                        0.0,
                        0.5
                    ]
                }
            },
            "pretrain": {
                "corrupt_probability": [
                    "uniform",
                    0.2,
                    0.8
                ]
            },
            "training": {
                "lr": [
                    "loguniform",
                    5e-05,
                    0.005
                ],
                "weight_decay": [
                    "?loguniform",
                    0.0,
                    1e-06,
                    0.001
                ]
            }
        },
        "n_trials": 100,
        "timeout": null,
        "sampler": {
            "seed": 0
        }
    },
    "best": {
        "program": "bin/pretrain_mask_supervised.py",
        "environment": {
            "CUDA_VISIBLE_DEVICES": "0",
            "gpus": {
                "driver": "450.119.04",
                "devices": [
                    {
                        "name": "A100-SXM-80GB",
                        "memory_total": 85199093760,
                        "memory_free": 85195948032,
                        "memory_used": 3145728,
                        "utilization": 0
                    }
                ]
            },
            "torch.version.cuda": "11.1",
            "torch.backends.cudnn.version()": 8005,
            "torch.cuda.nccl.version()": [
                2,
                10,
                3
            ]
        },
        "config": {
            "seed": 0,
            "data": {
                "path": "data/adult_roc",
                "T": {
                    "seed": 0,
                    "normalization": "quantile",
                    "num_nan_policy": null,
                    "cat_nan_policy": null,
                    "cat_min_frequency": null,
                    "cat_encoding": null,
                    "y_policy": "default"
                },
                "T_cache": true
            },
            "model": {
                "kind": "mlp",
                "config": {
                    "d_layers": [
                        512,
                        512,
                        512,
                        512,
                        512,
                        512
                    ],
                    "dropout": 0.0
                },
                "default": true,
                "checkpoint": null,
                "num_embedding_arch": [],
                "d_num_embedding": null,
                "positional_encoding": null,
                "d_cat_embedding": null
            },
            "training": {
                "batch_size": 256,
                "lr": 0.0001580917198214629,
                "weight_decay": 0.0,
                "optimizer": "AdamW",
                "patience": 16,
                "n_epochs": Infinity,
                "eval_batch_size": 8192
            },
            "pretrain": {
                "corrupt_probability": 0.7048930111502134,
                "corrupt_strategy": "resample",
                "d_hidden_head": 512,
                "lr": 0.0001580917198214629,
                "weight_decay": 0.0,
                "patience": 2,
                "n_iterations": 100000,
                "validate_every": 10000,
                "replace_strategy": "shuffle",
                "n_neighbors": 20,
                "use_target": false,
                "early_stop_type": "finetune",
                "target_injection_type": "post"
            },
            "bins": null
        },
        "epoch_size": 102,
        "n_parameters": 1639439,
        "metrics": {
            "iteration_scores": {
                "10000": {
                    "train": {
                        "score": 0.931404117298405,
                        "pretrain_loss": 1.0214418172836304,
                        "pretrain_component": 0.5163821578025818,
                        "supervised_component": 0.5050596594810486,
                        "features_accuracy": [
                            0.6913390755653381,
                            0.7089219689369202,
                            0.6734489798545837,
                            0.920953631401062,
                            0.9548909664154053,
                            0.6289542317390442,
                            0.7512285113334656,
                            0.6693795919418335,
                            0.6511056423187256,
                            0.6415847539901733,
                            0.6390509605407715,
                            0.8614481091499329,
                            0.721053421497345,
                            0.9043688178062439
                        ]
                    },
                    "val": {
                        "score": 0.9159369131879243,
                        "pretrain_loss": 1.0231799483299255,
                        "pretrain_component": 0.5174387693405151,
                        "supervised_component": 0.5057411789894104,
                        "features_accuracy": [
                            0.6853984594345093,
                            0.7104253172874451,
                            0.6740365624427795,
                            0.9246123433113098,
                            0.9510210156440735,
                            0.6313526630401611,
                            0.7508060932159424,
                            0.6751112937927246,
                            0.6499308943748474,
                            0.6373407244682312,
                            0.6330416202545166,
                            0.8656533360481262,
                            0.7193305492401123,
                            0.8968217372894287
                        ]
                    },
                    "test": {
                        "score": 0.9107749689963474,
                        "pretrain_loss": 1.0170524716377258,
                        "pretrain_component": 0.5167813301086426,
                        "supervised_component": 0.5002711415290833,
                        "features_accuracy": [
                            0.6955960988998413,
                            0.7011240124702454,
                            0.6740372776985168,
                            0.9229777455329895,
                            0.9541183114051819,
                            0.6289540529251099,
                            0.7443646192550659,
                            0.6773539781570435,
                            0.6444936394691467,
                            0.6366931200027466,
                            0.6355875134468079,
                            0.86407470703125,
                            0.7137768268585205,
                            0.9073153138160706
                        ]
                    }
                },
                "20000": {
                    "train": {
                        "score": 0.9323192184996886,
                        "pretrain_loss": 1.0154846906661987,
                        "pretrain_component": 0.5114504098892212,
                        "supervised_component": 0.5040342807769775,
                        "features_accuracy": [
                            0.6957539916038513,
                            0.7028178572654724,
                            0.6788620948791504,
                            0.9206464886665344,
                            0.9550445079803467,
                            0.6508368849754333,
                            0.7538390755653381,
                            0.6888436675071716,
                            0.6554821729660034,
                            0.6443872451782227,
                            0.6407017707824707,
                            0.8596436977386475,
                            0.7219364047050476,
                            0.9040617346763611
                        ]
                    },
                    "val": {
                        "score": 0.9173508078661191,
                        "pretrain_loss": 1.0138503313064575,
                        "pretrain_component": 0.5110931396484375,
                        "supervised_component": 0.50275719165802,
                        "features_accuracy": [
                            0.6869338154792786,
                            0.7104253172874451,
                            0.6869338154792786,
                            0.9249194264411926,
                            0.9514816403388977,
                            0.6510056853294373,
                            0.7580224275588989,
                            0.6881621479988098,
                            0.6519269347190857,
                            0.6453247666358948,
                            0.6425610184669495,
                            0.8648856282234192,
                            0.7205588817596436,
                            0.8985106945037842
                        ]
                    },
                    "test": {
                        "score": 0.9117473786205169,
                        "pretrain_loss": 1.0108310878276825,
                        "pretrain_component": 0.5110369920730591,
                        "supervised_component": 0.4997940957546234,
                        "features_accuracy": [
                            0.6952276229858398,
                            0.7011240124702454,
                            0.6851544976234436,
                            0.9229777455329895,
                            0.9540569186210632,
                            0.6526626348495483,
                            0.7526565194129944,
                            0.6881641745567322,
                            0.6555494666099548,
                            0.6459677219390869,
                            0.6384128928184509,
                            0.8640133142471313,
                            0.7149438261985779,
                            0.908052384853363
                        ]
                    }
                },
                "30000": {
                    "train": {
                        "score": 0.9285410977111184,
                        "pretrain_loss": 1.0123266577720642,
                        "pretrain_component": 0.5074722766876221,
                        "supervised_component": 0.5048543810844421,
                        "features_accuracy": [
                            0.6997849941253662,
                            0.7053516507148743,
                            0.689457893371582,
                            0.9216446280479431,
                            0.955428421497345,
                            0.6487253904342651,
                            0.7571022510528564,
                            0.6899954080581665,
                            0.6495316028594971,
                            0.6493780612945557,
                            0.6453854441642761,
                            0.8629453182220459,
                            0.7223203182220459,
                            0.9074016809463501
                        ]
                    },
                    "val": {
                        "score": 0.9175720553641071,
                        "pretrain_loss": 1.0116446018218994,
                        "pretrain_component": 0.5085057020187378,
                        "supervised_component": 0.5031388998031616,
                        "features_accuracy": [
                            0.6881621479988098,
                            0.7104253172874451,
                            0.691540002822876,
                            0.9241517186164856,
                            0.9514816403388977,
                            0.650545060634613,
                            0.7581759691238403,
                            0.6947643160820007,
                            0.6467065811157227,
                            0.6525411009788513,
                            0.6483955383300781,
                            0.8671886920928955,
                            0.7216336727142334,
                            0.9003531336784363
                        ]
                    },
                    "test": {
                        "score": 0.9129046496801569,
                        "pretrain_loss": 1.0081943571567535,
                        "pretrain_component": 0.5085177421569824,
                        "supervised_component": 0.4996766149997711,
                        "features_accuracy": [
                            0.6963946223258972,
                            0.7011240124702454,
                            0.6902524828910828,
                            0.9235305190086365,
                            0.9543026089668274,
                            0.6535225510597229,
                            0.7536392211914062,
                            0.6938149333000183,
                            0.6554880142211914,
                            0.6462134122848511,
                            0.6376144289970398,
                            0.8650574684143066,
                            0.7159879803657532,
                            0.9076838493347168
                        ]
                    }
                },
                "40000": {
                    "train": {
                        "score": 0.9298634426070593,
                        "pretrain_loss": 1.0062791109085083,
                        "pretrain_component": 0.5059825778007507,
                        "supervised_component": 0.5002965331077576,
                        "features_accuracy": [
                            0.6949477791786194,
                            0.7083461284637451,
                            0.6926827430725098,
                            0.9208384156227112,
                            0.9557739496231079,
                            0.6555973291397095,
                            0.7553362846374512,
                            0.6911087036132812,
                            0.6566722989082336,
                            0.6514895558357239,
                            0.6426981091499329,
                            0.8627533912658691,
                            0.7225122451782227,
                            0.9069793820381165
                        ]
                    },
                    "val": {
                        "score": 0.9183501939704092,
                        "pretrain_loss": 1.01116144657135,
                        "pretrain_component": 0.5073369145393372,
                        "supervised_component": 0.5038245320320129,
                        "features_accuracy": [
                            0.6877015233039856,
                            0.7104253172874451,
                            0.6916935443878174,
                            0.9236910939216614,
                            0.9510210156440735,
                            0.6530016660690308,
                            0.7594043016433716,
                            0.6938430666923523,
                            0.6548441648483276,
                            0.6525411009788513,
                            0.6490097045898438,
                            0.8654997944831848,
                            0.721480131149292,
                            0.9006602168083191
                        ]
                    },
                    "test": {
                        "score": 0.9135493960168539,
                        "pretrain_loss": 1.006426364183426,
                        "pretrain_component": 0.5073807239532471,
                        "supervised_component": 0.49904564023017883,
                        "features_accuracy": [
                            0.6962717771530151,
                            0.7011240124702454,
                            0.6904981732368469,
                            0.9236533641815186,
                            0.954241156578064,
                            0.6530311703681946,
                            0.7523493766784668,
                            0.6939377784729004,
                            0.6541367769241333,
                            0.6488544940948486,
                            0.6398255825042725,
                            0.8653645515441895,
                            0.7181377410888672,
                            0.9088508486747742
                        ]
                    }
                },
                "50000": {
                    "train": {
                        "score": 0.9308581819662178,
                        "pretrain_loss": 1.0105984210968018,
                        "pretrain_component": 0.506672739982605,
                        "supervised_component": 0.5039256811141968,
                        "features_accuracy": [
                            0.6969056725502014,
                            0.7048141956329346,
                            0.6889204382896423,
                            0.9212607145309448,
                            0.9556203484535217,
                            0.6532939076423645,
                            0.7551827430725098,
                            0.689803421497345,
                            0.6549063324928284,
                            0.6570945978164673,
                            0.6478424072265625,
                            0.8630988597869873,
                            0.7195562124252319,
                            0.9054821729660034
                        ]
                    },
                    "val": {
                        "score": 0.9182091011328696,
                        "pretrain_loss": 1.0092425346374512,
                        "pretrain_component": 0.5065775513648987,
                        "supervised_component": 0.5026649832725525,
                        "features_accuracy": [
                            0.6889298558235168,
                            0.7104253172874451,
                            0.6936895251274109,
                            0.9246123433113098,
                            0.9511745572090149,
                            0.6543835401535034,
                            0.7572547197341919,
                            0.6964532732963562,
                            0.6560724973678589,
                            0.6503915190696716,
                            0.6439428925514221,
                            0.8682634830474854,
                            0.7219407558441162,
                            0.9015814661979675
                        ]
                    },
                    "test": {
                        "score": 0.9144469075908193,
                        "pretrain_loss": 1.0058752298355103,
                        "pretrain_component": 0.5065338611602783,
                        "supervised_component": 0.49934136867523193,
                        "features_accuracy": [
                            0.6973773241043091,
                            0.7011240124702454,
                            0.6908667087554932,
                            0.9230391383171082,
                            0.954241156578064,
                            0.6522327065467834,
                            0.7519808411598206,
                            0.6968245506286621,
                            0.6560407876968384,
                            0.6500829458236694,
                            0.6408697366714478,
                            0.8651188611984253,
                            0.7175849676132202,
                            0.9094650745391846
                        ]
                    }
                },
                "60000": {
                    "train": {
                        "score": 0.9314986729996697,
                        "pretrain_loss": 1.010102927684784,
                        "pretrain_component": 0.5062882900238037,
                        "supervised_component": 0.5038146376609802,
                        "features_accuracy": [
                            0.6894962787628174,
                            0.706464946269989,
                            0.6892275810241699,
                            0.9205313324928284,
                            0.9555051922798157,
                            0.6559812426567078,
                            0.7522650361061096,
                            0.6931818127632141,
                            0.6556357145309448,
                            0.6592828631401062,
                            0.6467674970626831,
                            0.863521158695221,
                            0.7220131754875183,
                            0.9057509303092957
                        ]
                    },
                    "val": {
                        "score": 0.9185721508016755,
                        "pretrain_loss": 1.0097172260284424,
                        "pretrain_component": 0.506328821182251,
                        "supervised_component": 0.5033884048461914,
                        "features_accuracy": [
                            0.6881621479988098,
                            0.7104253172874451,
                            0.6941501498222351,
                            0.9249194264411926,
                            0.9511745572090149,
                            0.6493167281150818,
                            0.7589436769485474,
                            0.6956855654716492,
                            0.6573007702827454,
                            0.6523875594139099,
                            0.6414862871170044,
                            0.8654997944831848,
                            0.7217872142791748,
                            0.9001995921134949
                        ]
                    },
                    "test": {
                        "score": 0.9142374565107252,
                        "pretrain_loss": 1.0065360069274902,
                        "pretrain_component": 0.5068681240081787,
                        "supervised_component": 0.4996678829193115,
                        "features_accuracy": [
                            0.6974387764930725,
                            0.7011240124702454,
                            0.6917880177497864,
                            0.9235919713973999,
                            0.9544254541397095,
                            0.6520484089851379,
                            0.7519808411598206,
                            0.697254478931427,
                            0.6516798734664917,
                            0.6522327065467834,
                            0.6382900476455688,
                            0.8649960160255432,
                            0.7164179682731628,
                            0.9090965390205383
                        ]
                    }
                },
                "70000": {
                    "train": {
                        "score": 0.9320571114984595,
                        "pretrain_loss": 1.007382094860077,
                        "pretrain_component": 0.5052074790000916,
                        "supervised_component": 0.5021746158599854,
                        "features_accuracy": [
                            0.6977118849754333,
                            0.7084996700286865,
                            0.6892275810241699,
                            0.9210304021835327,
                            0.9555819630622864,
                            0.6585918068885803,
                            0.7546068429946899,
                            0.6924523711204529,
                            0.6581311225891113,
                            0.6495316028594971,
                            0.6481495499610901,
                            0.8628685474395752,
                            0.7194409966468811,
                            0.9072097539901733
                        ]
                    },
                    "val": {
                        "score": 0.9207830781453128,
                        "pretrain_loss": 1.0084972381591797,
                        "pretrain_component": 0.5062510371208191,
                        "supervised_component": 0.5022462010383606,
                        "features_accuracy": [
                            0.6903116703033447,
                            0.7104253172874451,
                            0.6941501498222351,
                            0.9246123433113098,
                            0.9513280987739563,
                            0.6536158323287964,
                            0.7618609070777893,
                            0.6950713992118835,
                            0.6540764570236206,
                            0.6546906232833862,
                            0.6448641419410706,
                            0.8664209842681885,
                            0.7216336727142334,
                            0.9017350077629089
                        ]
                    },
                    "test": {
                        "score": 0.9150636769338889,
                        "pretrain_loss": 1.0054352581501007,
                        "pretrain_component": 0.5065901875495911,
                        "supervised_component": 0.49884507060050964,
                        "features_accuracy": [
                            0.6970702409744263,
                            0.7011240124702454,
                            0.6912966370582581,
                            0.9235919713973999,
                            0.954241156578064,
                            0.6532768607139587,
                            0.7538849115371704,
                            0.6960874795913696,
                            0.6552423238754272,
                            0.6505743265151978,
                            0.6414839625358582,
                            0.8659173846244812,
                            0.7154965996742249,
                            0.9088508486747742
                        ]
                    }
                },
                "80000": {
                    "train": {
                        "score": 0.9329956672214896,
                        "pretrain_loss": 1.0075432062149048,
                        "pretrain_component": 0.5056326985359192,
                        "supervised_component": 0.5019105076789856,
                        "features_accuracy": [
                            0.6955236196517944,
                            0.7039695978164673,
                            0.6934505105018616,
                            0.9219517707824707,
                            0.9558123350143433,
                            0.6495699882507324,
                            0.7538390755653381,
                            0.6931434273719788,
                            0.6572097539901733,
                            0.6499155163764954,
                            0.6436578631401062,
                            0.8640202283859253,
                            0.7246237397193909,
                            0.9068642258644104
                        ]
                    },
                    "val": {
                        "score": 0.920841243474134,
                        "pretrain_loss": 1.0099868178367615,
                        "pretrain_component": 0.5062594413757324,
                        "supervised_component": 0.503727376461029,
                        "features_accuracy": [
                            0.6892369389533997,
                            0.7104253172874451,
                            0.6950713992118835,
                            0.9239981770515442,
                            0.9507139325141907,
                            0.6523875594139099,
                            0.7594043016433716,
                            0.6969138979911804,
                            0.6543835401535034,
                            0.6522340178489685,
                            0.6448641419410706,
                            0.8662674427032471,
                            0.7233225703239441,
                            0.9014279246330261
                        ]
                    },
                    "test": {
                        "score": 0.915345966472354,
                        "pretrain_loss": 1.0046862959861755,
                        "pretrain_component": 0.5061584115028381,
                        "supervised_component": 0.4985278844833374,
                        "features_accuracy": [
                            0.6961489319801331,
                            0.7011240124702454,
                            0.6915423274040222,
                            0.9233462810516357,
                            0.9540569186210632,
                            0.6547509431838989,
                            0.7537006735801697,
                            0.6963331699371338,
                            0.6534610986709595,
                            0.6522327065467834,
                            0.63908851146698,
                            0.8656102418899536,
                            0.7146981358528137,
                            0.9093422293663025
                        ]
                    }
                },
                "90000": {
                    "train": {
                        "score": 0.9302549182850346,
                        "pretrain_loss": 1.0057286024093628,
                        "pretrain_component": 0.5044800639152527,
                        "supervised_component": 0.5012485384941101,
                        "features_accuracy": [
                            0.6934505105018616,
                            0.7079622149467468,
                            0.6900337934494019,
                            0.9212990999221802,
                            0.9561194777488708,
                            0.6563267707824707,
                            0.7533783912658691,
                            0.6915693879127502,
                            0.6575936675071716,
                            0.6593212485313416,
                            0.6449631452560425,
                            0.8637131452560425,
                            0.7230113744735718,
                            0.9074016809463501
                        ]
                    },
                    "val": {
                        "score": 0.9203507717546068,
                        "pretrain_loss": 1.008974850177765,
                        "pretrain_component": 0.5055501461029053,
                        "supervised_component": 0.5034247040748596,
                        "features_accuracy": [
                            0.6906187534332275,
                            0.7104253172874451,
                            0.6946107745170593,
                            0.9236910939216614,
                            0.9500998258590698,
                            0.6493167281150818,
                            0.758790135383606,
                            0.699677586555481,
                            0.6528481245040894,
                            0.653462290763855,
                            0.646092414855957,
                            0.8674957752227783,
                            0.7216336727142334,
                            0.9020420908927917
                        ]
                    },
                    "test": {
                        "score": 0.9158881200443032,
                        "pretrain_loss": 1.005356252193451,
                        "pretrain_component": 0.5059217810630798,
                        "supervised_component": 0.4994344711303711,
                        "features_accuracy": [
                            0.69670170545578,
                            0.7011240124702454,
                            0.6919108629226685,
                            0.9235919713973999,
                            0.954364001750946,
                            0.6527240872383118,
                            0.7537620663642883,
                            0.6977458596229553,
                            0.6539524793624878,
                            0.6524783968925476,
                            0.640685498714447,
                            0.8668386936187744,
                            0.7180762887001038,
                            0.9092193841934204
                        ]
                    }
                },
                "100000": {
                    "train": {
                        "score": 0.9339101073913988,
                        "pretrain_loss": 1.0096116065979004,
                        "pretrain_component": 0.505813717842102,
                        "supervised_component": 0.5037978887557983,
                        "features_accuracy": [
                            0.6946406364440918,
                            0.7023955583572388,
                            0.6924523711204529,
                            0.9216446280479431,
                            0.9555819630622864,
                            0.6545608043670654,
                            0.7569103240966797,
                            0.6949861645698547,
                            0.6499922871589661,
                            0.6536778211593628,
                            0.6460380554199219,
                            0.8640970587730408,
                            0.718289315700531,
                            0.906710684299469
                        ]
                    },
                    "val": {
                        "score": 0.9203213666659787,
                        "pretrain_loss": 1.0079646706581116,
                        "pretrain_component": 0.505898654460907,
                        "supervised_component": 0.5020660161972046,
                        "features_accuracy": [
                            0.6875479817390442,
                            0.7104253172874451,
                            0.6932289600372314,
                            0.9247658848762512,
                            0.9507139325141907,
                            0.653462290763855,
                            0.7590972185134888,
                            0.6993705034255981,
                            0.6551512479782104,
                            0.6522340178489685,
                            0.6422539353370667,
                            0.8673422336578369,
                            0.7267004251480103,
                            0.9023491740226746
                        ]
                    },
                    "test": {
                        "score": 0.9157622653921036,
                        "pretrain_loss": 1.0035534799098969,
                        "pretrain_component": 0.5057342648506165,
                        "supervised_component": 0.4978192150592804,
                        "features_accuracy": [
                            0.6966403126716614,
                            0.7011240124702454,
                            0.6931392550468445,
                            0.9239605069160461,
                            0.9539955258369446,
                            0.6566550135612488,
                            0.7530250549316406,
                            0.6968859434127808,
                            0.6545667052268982,
                            0.6522327065467834,
                            0.6401327252388,
                            0.8662859201431274,
                            0.7153737545013428,
                            0.9096493124961853
                        ]
                    }
                }
            },
            "train": {
                "score": 0.9329956672214896
            },
            "val": {
                "score": 0.920841243474134
            },
            "test": {
                "score": 0.915345966472354
            }
        },
        "best_iteration": 80000,
        "time": "0:10:58",
        "trial_id": 51,
        "tuning_time": "8:12:33"
    },
    "time": "16:38:18",
    "continuations": [
        25
    ]
}
