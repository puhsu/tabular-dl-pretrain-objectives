{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised___d09c8b4c545b417d8c7cfdb56cf8edf1.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 4,
        "data": {
            "path": "data/adult_roc",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512,
                    512,
                    512,
                    512
                ],
                "dropout": 0.1419652932520368
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "positional",
                "linear",
                "relu"
            ],
            "d_num_embedding": 71,
            "positional_encoding": {
                "n": 125,
                "sigma": 1.1248226197810498,
                "trainable": true,
                "initialization": "normal"
            },
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 256,
            "lr": 0.0002546574634275081,
            "weight_decay": 0.0,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.6617170596711349,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.0002546574634275081,
            "weight_decay": 0.0,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "epoch_size": 102,
    "n_parameters": 1436843,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": 0.9381981574556579,
                    "pretrain_loss": 0.9986306428909302,
                    "pretrain_component": 0.5088292360305786,
                    "supervised_component": 0.48980140686035156,
                    "features_accuracy": [
                        0.6559044718742371,
                        0.6654637455940247,
                        0.6918381452560425,
                        0.9221820831298828,
                        0.9549293518066406,
                        0.6381679773330688,
                        0.7537622451782227,
                        0.6949477791786194,
                        0.6728347539901733,
                        0.6122158765792847,
                        0.6542920470237732,
                        0.8606035113334656,
                        0.7427825331687927,
                        0.9052518010139465
                    ]
                },
                "val": {
                    "score": 0.9253413182765522,
                    "pretrain_loss": 0.9995131492614746,
                    "pretrain_component": 0.5100870132446289,
                    "supervised_component": 0.4894261360168457,
                    "features_accuracy": [
                        0.6487026214599609,
                        0.6589897274971008,
                        0.695224940776825,
                        0.9252264499664307,
                        0.9513280987739563,
                        0.6428681015968323,
                        0.7614002823829651,
                        0.697067379951477,
                        0.6714263558387756,
                        0.6109319925308228,
                        0.6494702696800232,
                        0.8630431294441223,
                        0.7328420281410217,
                        0.89805006980896
                    ]
                },
                "test": {
                    "score": 0.9213125412833159,
                    "pretrain_loss": 0.997215747833252,
                    "pretrain_component": 0.5086930394172668,
                    "supervised_component": 0.4885227084159851,
                    "features_accuracy": [
                        0.6554266214370728,
                        0.6668509840965271,
                        0.6998956203460693,
                        0.9232848286628723,
                        0.9545482993125916,
                        0.6449235677719116,
                        0.7495239973068237,
                        0.6914194822311401,
                        0.6683250665664673,
                        0.6153184771537781,
                        0.6529697775840759,
                        0.8626006245613098,
                        0.7399423122406006,
                        0.9074995517730713
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": 0.9408814087545947,
                    "pretrain_loss": 0.996601939201355,
                    "pretrain_component": 0.5049959421157837,
                    "supervised_component": 0.4916059970855713,
                    "features_accuracy": [
                        0.6544456481933594,
                        0.6600122451782227,
                        0.6913006901741028,
                        0.9216830134391785,
                        0.9561194777488708,
                        0.6442720890045166,
                        0.7584843039512634,
                        0.6982493996620178,
                        0.6697251200675964,
                        0.6221590638160706,
                        0.6562116146087646,
                        0.8619471788406372,
                        0.7379837036132812,
                        0.908668577671051
                    ]
                },
                "val": {
                    "score": 0.927932641711892,
                    "pretrain_loss": 0.9927077293395996,
                    "pretrain_component": 0.5052347183227539,
                    "supervised_component": 0.4874730110168457,
                    "features_accuracy": [
                        0.653462290763855,
                        0.6589897274971008,
                        0.6964532732963562,
                        0.9258406162261963,
                        0.9517887234687805,
                        0.6476278305053711,
                        0.7637033462524414,
                        0.6950713992118835,
                        0.6714263558387756,
                        0.6244434118270874,
                        0.6600645184516907,
                        0.8665745258331299,
                        0.7323814034461975,
                        0.8998925089836121
                    ]
                },
                "test": {
                    "score": 0.9226521646310163,
                    "pretrain_loss": 0.9914224445819855,
                    "pretrain_component": 0.5041338801383972,
                    "supervised_component": 0.48728856444358826,
                    "features_accuracy": [
                        0.6594803929328918,
                        0.6668509840965271,
                        0.7003255486488342,
                        0.9232848286628723,
                        0.9546711444854736,
                        0.6497144103050232,
                        0.7506296038627625,
                        0.6946747899055481,
                        0.667956531047821,
                        0.626128613948822,
                        0.6631656885147095,
                        0.865671694278717,
                        0.7427062392234802,
                        0.9082366228103638
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": 0.9424818221410443,
                    "pretrain_loss": 0.9919981062412262,
                    "pretrain_component": 0.5041615962982178,
                    "supervised_component": 0.4878365099430084,
                    "features_accuracy": [
                        0.6560196280479431,
                        0.6562883853912354,
                        0.6974048018455505,
                        0.9218366146087646,
                        0.9561962485313416,
                        0.6448479890823364,
                        0.7567567229270935,
                        0.694448709487915,
                        0.6743319630622864,
                        0.6291845440864563,
                        0.6574401259422302,
                        0.8642122149467468,
                        0.7373694777488708,
                        0.9073249101638794
                    ]
                },
                "val": {
                    "score": 0.9292928850003096,
                    "pretrain_loss": 0.9889214634895325,
                    "pretrain_component": 0.503240704536438,
                    "supervised_component": 0.4856807589530945,
                    "features_accuracy": [
                        0.6539229154586792,
                        0.6589897274971008,
                        0.6989098787307739,
                        0.9258406162261963,
                        0.9516351819038391,
                        0.645017683506012,
                        0.7621679902076721,
                        0.6987563371658325,
                        0.6721940636634827,
                        0.6307384967803955,
                        0.6606786251068115,
                        0.8684170246124268,
                        0.7365269660949707,
                        0.9014279246330261
                    ]
                },
                "test": {
                    "score": 0.9238879406402634,
                    "pretrain_loss": 0.989564836025238,
                    "pretrain_component": 0.5027564764022827,
                    "supervised_component": 0.4868083596229553,
                    "features_accuracy": [
                        0.660278856754303,
                        0.6668509840965271,
                        0.699957013130188,
                        0.9235305190086365,
                        0.9553467631340027,
                        0.6497144103050232,
                        0.7533321380615234,
                        0.6947362422943115,
                        0.6709662079811096,
                        0.6312880516052246,
                        0.6616301536560059,
                        0.8668386936187744,
                        0.7436890006065369,
                        0.9084209203720093
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": 0.9434241465490434,
                    "pretrain_loss": 0.9860540628433228,
                    "pretrain_component": 0.50242680311203,
                    "supervised_component": 0.4836272597312927,
                    "features_accuracy": [
                        0.6554437875747681,
                        0.663083553314209,
                        0.695715606212616,
                        0.9216830134391785,
                        0.9566953182220459,
                        0.6478424072265625,
                        0.7564112544059753,
                        0.6997082233428955,
                        0.6782094240188599,
                        0.632409393787384,
                        0.6603577733039856,
                        0.8626765608787537,
                        0.7377917766571045,
                        0.9088989496231079
                    ]
                },
                "val": {
                    "score": 0.9303471477064031,
                    "pretrain_loss": 0.9913953840732574,
                    "pretrain_component": 0.5035176277160645,
                    "supervised_component": 0.487877756357193,
                    "features_accuracy": [
                        0.6530016660690308,
                        0.6589897274971008,
                        0.6969138979911804,
                        0.9246123433113098,
                        0.9511745572090149,
                        0.6508521437644958,
                        0.7609396576881409,
                        0.7001382112503052,
                        0.6720405220985413,
                        0.6253646612167358,
                        0.6614463329315186,
                        0.868109941482544,
                        0.7356057167053223,
                        0.9005066752433777
                    ]
                },
                "test": {
                    "score": 0.9250478358499037,
                    "pretrain_loss": 0.9905673265457153,
                    "pretrain_component": 0.503048837184906,
                    "supervised_component": 0.4875184893608093,
                    "features_accuracy": [
                        0.6576991677284241,
                        0.6668509840965271,
                        0.6993428468704224,
                        0.923714816570282,
                        0.9554082155227661,
                        0.6510657072067261,
                        0.7506296038627625,
                        0.6960874795913696,
                        0.6730545163154602,
                        0.6293839812278748,
                        0.6614459156990051,
                        0.8665315508842468,
                        0.7437503933906555,
                        0.9090350866317749
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": 0.9444352706187878,
                    "pretrain_loss": 0.9880618155002594,
                    "pretrain_component": 0.50077223777771,
                    "supervised_component": 0.48728957772254944,
                    "features_accuracy": [
                        0.6639665365219116,
                        0.6646191477775574,
                        0.6949477791786194,
                        0.9201090335845947,
                        0.9557739496231079,
                        0.6466907262802124,
                        0.7596360445022583,
                        0.694909393787384,
                        0.6765586733818054,
                        0.631833553314209,
                        0.6648879051208496,
                        0.8640586733818054,
                        0.7449707984924316,
                        0.9083998799324036
                    ]
                },
                "val": {
                    "score": 0.9294628670477292,
                    "pretrain_loss": 0.9889834225177765,
                    "pretrain_component": 0.5025132298469543,
                    "supervised_component": 0.48647019267082214,
                    "features_accuracy": [
                        0.6523875594139099,
                        0.6589897274971008,
                        0.6969138979911804,
                        0.9250729084014893,
                        0.9516351819038391,
                        0.654229998588562,
                        0.7627821564674377,
                        0.6999846696853638,
                        0.6738830208778381,
                        0.6310455799102783,
                        0.6635959148406982,
                        0.868109941482544,
                        0.7305389046669006,
                        0.9017350077629089
                    ]
                },
                "test": {
                    "score": 0.9256089857587064,
                    "pretrain_loss": 0.9892183542251587,
                    "pretrain_component": 0.5023259520530701,
                    "supervised_component": 0.4868924021720886,
                    "features_accuracy": [
                        0.6600946187973022,
                        0.6668509840965271,
                        0.6997727751731873,
                        0.9231619834899902,
                        0.9549782276153564,
                        0.650942862033844,
                        0.7522265315055847,
                        0.6948590874671936,
                        0.6717032194137573,
                        0.6290154457092285,
                        0.6626129150390625,
                        0.8666543960571289,
                        0.7436275482177734,
                        0.90860515832901
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": 0.9450404609645859,
                    "pretrain_loss": 0.9837058186531067,
                    "pretrain_component": 0.5000413656234741,
                    "supervised_component": 0.48366445302963257,
                    "features_accuracy": [
                        0.6565955281257629,
                        0.6600506901741028,
                        0.7015509605407715,
                        0.921875,
                        0.9568488597869873,
                        0.6454622149467468,
                        0.7584075331687927,
                        0.702203631401062,
                        0.6769425272941589,
                        0.6309505701065063,
                        0.6645423769950867,
                        0.8637131452560425,
                        0.7444333434104919,
                        0.9080159664154053
                    ]
                },
                "val": {
                    "score": 0.930168266750583,
                    "pretrain_loss": 0.9908963143825531,
                    "pretrain_component": 0.5028836131095886,
                    "supervised_component": 0.4880127012729645,
                    "features_accuracy": [
                        0.6536158323287964,
                        0.6589897274971008,
                        0.6966068148612976,
                        0.9255335330963135,
                        0.9510210156440735,
                        0.6493167281150818,
                        0.7647781372070312,
                        0.6975280046463013,
                        0.6712728142738342,
                        0.633962869644165,
                        0.6689697504043579,
                        0.8694918155670166,
                        0.733302652835846,
                        0.9021956324577332
                    ]
                },
                "test": {
                    "score": 0.9253729063517184,
                    "pretrain_loss": 0.9882213771343231,
                    "pretrain_component": 0.5023636221885681,
                    "supervised_component": 0.485857754945755,
                    "features_accuracy": [
                        0.6601560115814209,
                        0.6668509840965271,
                        0.7000798583030701,
                        0.9236533641815186,
                        0.9552239179611206,
                        0.6506357192993164,
                        0.7530864477157593,
                        0.6951047778129578,
                        0.6713347434997559,
                        0.6303667426109314,
                        0.6606473922729492,
                        0.8663473129272461,
                        0.7444260716438293,
                        0.9089122414588928
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": 0.9450810700566289,
                    "pretrain_loss": 0.9843154847621918,
                    "pretrain_component": 0.5021939277648926,
                    "supervised_component": 0.4821215569972992,
                    "features_accuracy": [
                        0.6501075029373169,
                        0.6607800722122192,
                        0.6985564827919006,
                        0.9208384156227112,
                        0.9547373652458191,
                        0.6499539017677307,
                        0.7590985894203186,
                        0.6978271007537842,
                        0.6785165667533875,
                        0.6314112544059753,
                        0.663083553314209,
                        0.8645577430725098,
                        0.7362561225891113,
                        0.9080543518066406
                    ]
                },
                "val": {
                    "score": 0.9305204184808402,
                    "pretrain_loss": 0.987836092710495,
                    "pretrain_component": 0.5025268197059631,
                    "supervised_component": 0.48530927300453186,
                    "features_accuracy": [
                        0.6540764570236206,
                        0.6589897274971008,
                        0.6993705034255981,
                        0.9255335330963135,
                        0.9513280987739563,
                        0.6499308943748474,
                        0.7633962631225586,
                        0.6999846696853638,
                        0.6743436455726624,
                        0.6313526630401611,
                        0.666820228099823,
                        0.8679563999176025,
                        0.7337632179260254,
                        0.9008137583732605
                    ]
                },
                "test": {
                    "score": 0.9257367850001494,
                    "pretrain_loss": 0.9882784187793732,
                    "pretrain_component": 0.502160370349884,
                    "supervised_component": 0.48611804842948914,
                    "features_accuracy": [
                        0.6600946187973022,
                        0.6668509840965271,
                        0.7009397745132446,
                        0.924390435218811,
                        0.9551010727882385,
                        0.6510042548179626,
                        0.7532707452774048,
                        0.6950433254241943,
                        0.673361599445343,
                        0.6284626722335815,
                        0.6647012233734131,
                        0.8677600026130676,
                        0.7431362271308899,
                        0.9090965390205383
                    ]
                }
            },
            "80000": {
                "train": {
                    "score": 0.9456349901641353,
                    "pretrain_loss": 0.9873082935810089,
                    "pretrain_component": 0.501270592212677,
                    "supervised_component": 0.4860377013683319,
                    "features_accuracy": [
                        0.650798499584198,
                        0.6584766507148743,
                        0.6985564827919006,
                        0.9217597842216492,
                        0.956349790096283,
                        0.6472281813621521,
                        0.7589833736419678,
                        0.7008215188980103,
                        0.6801289916038513,
                        0.6344441175460815,
                        0.6632754802703857,
                        0.8653255105018616,
                        0.7395961284637451,
                        0.9078239798545837
                    ]
                },
                "val": {
                    "score": 0.930642294835022,
                    "pretrain_loss": 0.9896507561206818,
                    "pretrain_component": 0.5028665065765381,
                    "supervised_component": 0.4867842495441437,
                    "features_accuracy": [
                        0.6536158323287964,
                        0.6589897274971008,
                        0.6946107745170593,
                        0.9259941577911377,
                        0.9520958065986633,
                        0.6499308943748474,
                        0.7647781372070312,
                        0.700445294380188,
                        0.6714263558387756,
                        0.6267465353012085,
                        0.6645171046257019,
                        0.8690311908721924,
                        0.7313066124916077,
                        0.9018885493278503
                    ]
                },
                "test": {
                    "score": 0.9253897908228351,
                    "pretrain_loss": 0.9893292784690857,
                    "pretrain_component": 0.5021047592163086,
                    "supervised_component": 0.4872245192527771,
                    "features_accuracy": [
                        0.6603403091430664,
                        0.6668509840965271,
                        0.6982372403144836,
                        0.9233462810516357,
                        0.9548553824424744,
                        0.6524169445037842,
                        0.752595067024231,
                        0.6954118609428406,
                        0.6734230518341064,
                        0.629752516746521,
                        0.6634727716445923,
                        0.8675757646560669,
                        0.7415392398834229,
                        0.9092807769775391
                    ]
                }
            },
            "90000": {
                "train": {
                    "score": 0.9452742605064186,
                    "pretrain_loss": 0.9868423640727997,
                    "pretrain_component": 0.5023152828216553,
                    "supervised_component": 0.4845270812511444,
                    "features_accuracy": [
                        0.6516814827919006,
                        0.6642352342605591,
                        0.6984029412269592,
                        0.9215678572654724,
                        0.9567720890045166,
                        0.6446943879127502,
                        0.7616707682609558,
                        0.7003224492073059,
                        0.6758292317390442,
                        0.6270346641540527,
                        0.6535626649856567,
                        0.8638666868209839,
                        0.7401335835456848,
                        0.9065186977386475
                    ]
                },
                "val": {
                    "score": 0.9307399248880543,
                    "pretrain_loss": 0.989963173866272,
                    "pretrain_component": 0.5026003122329712,
                    "supervised_component": 0.4873628616333008,
                    "features_accuracy": [
                        0.6523875594139099,
                        0.6589897274971008,
                        0.6955320239067078,
                        0.9266083240509033,
                        0.9502533674240112,
                        0.6483955383300781,
                        0.7633962631225586,
                        0.6987563371658325,
                        0.679717481136322,
                        0.6256717443466187,
                        0.666820228099823,
                        0.8701059222221375,
                        0.7309995293617249,
                        0.9008137583732605
                    ]
                },
                "test": {
                    "score": 0.9259514425611203,
                    "pretrain_loss": 0.9883487224578857,
                    "pretrain_component": 0.5019902586936951,
                    "supervised_component": 0.4863584637641907,
                    "features_accuracy": [
                        0.659726083278656,
                        0.6668509840965271,
                        0.6982986330986023,
                        0.924390435218811,
                        0.9547325372695923,
                        0.651495635509491,
                        0.7529636025428772,
                        0.6958417892456055,
                        0.6738529801368713,
                        0.63042813539505,
                        0.664578378200531,
                        0.867698609828949,
                        0.7431976199150085,
                        0.9088508486747742
                    ]
                }
            },
            "100000": {
                "train": {
                    "score": 0.9429436251081481,
                    "pretrain_loss": 0.9853612780570984,
                    "pretrain_component": 0.5005508661270142,
                    "supervised_component": 0.48481041193008423,
                    "features_accuracy": [
                        0.6562883853912354,
                        0.6645423769950867,
                        0.7010902762413025,
                        0.9212990999221802,
                        0.9559658765792847,
                        0.6461148262023926,
                        0.7608645558357239,
                        0.7005912065505981,
                        0.6777103543281555,
                        0.6313344240188599,
                        0.6642736196517944,
                        0.8649800419807434,
                        0.7409397959709167,
                        0.907747209072113
                    ]
                },
                "val": {
                    "score": 0.9298848558634779,
                    "pretrain_loss": 0.987879604101181,
                    "pretrain_component": 0.5028313994407654,
                    "supervised_component": 0.48504820466041565,
                    "features_accuracy": [
                        0.6551512479782104,
                        0.6589897274971008,
                        0.6979886293411255,
                        0.9261476993560791,
                        0.952709972858429,
                        0.6508521437644958,
                        0.7637033462524414,
                        0.699677586555481,
                        0.6784892082214355,
                        0.6273606419563293,
                        0.6585291028022766,
                        0.8697988390922546,
                        0.7331491112709045,
                        0.9014279246330261
                    ]
                },
                "test": {
                    "score": 0.9260406113872219,
                    "pretrain_loss": 0.9873861074447632,
                    "pretrain_component": 0.501688539981842,
                    "supervised_component": 0.48569756746292114,
                    "features_accuracy": [
                        0.6606473922729492,
                        0.6668509840965271,
                        0.7007555365562439,
                        0.9240218997001648,
                        0.9551010727882385,
                        0.6506971716880798,
                        0.7516737580299377,
                        0.6949819326400757,
                        0.6747128963470459,
                        0.63042813539505,
                        0.6647626161575317,
                        0.8667158484458923,
                        0.7427062392234802,
                        0.9078680872917175
                    ]
                }
            }
        },
        "train": {
            "score": 0.9452742605064186
        },
        "val": {
            "score": 0.9307399248880543
        },
        "test": {
            "score": 0.9259514425611203
        }
    },
    "best_iteration": 90000,
    "time": "0:12:33"
}
