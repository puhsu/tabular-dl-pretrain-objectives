{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised___d09c8b4c545b417d8c7cfdb56cf8edf1.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 13,
        "data": {
            "path": "data/adult_roc",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512,
                    512,
                    512,
                    512
                ],
                "dropout": 0.1419652932520368
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "positional",
                "linear",
                "relu"
            ],
            "d_num_embedding": 71,
            "positional_encoding": {
                "n": 125,
                "sigma": 1.1248226197810498,
                "trainable": true,
                "initialization": "normal"
            },
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 256,
            "lr": 0.0002546574634275081,
            "weight_decay": 0.0,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.6617170596711349,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.0002546574634275081,
            "weight_decay": 0.0,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "epoch_size": 102,
    "n_parameters": 1436843,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": 0.9418341040999463,
                    "pretrain_loss": 0.9962362051010132,
                    "pretrain_component": 0.509380578994751,
                    "supervised_component": 0.4868556261062622,
                    "features_accuracy": [
                        0.6518350839614868,
                        0.6607800722122192,
                        0.6923372149467468,
                        0.9200706481933594,
                        0.9558507204055786,
                        0.6419302821159363,
                        0.7566031813621521,
                        0.6962146759033203,
                        0.6726428270339966,
                        0.616208553314209,
                        0.6516814827919006,
                        0.8611793518066406,
                        0.7369855642318726,
                        0.9074016809463501
                    ]
                },
                "val": {
                    "score": 0.9247499922618189,
                    "pretrain_loss": 1.0107503533363342,
                    "pretrain_component": 0.5104799270629883,
                    "supervised_component": 0.500270426273346,
                    "features_accuracy": [
                        0.6516198515892029,
                        0.6560724973678589,
                        0.7059726715087891,
                        0.9238446354866028,
                        0.9513280987739563,
                        0.6494702696800232,
                        0.7574082612991333,
                        0.6900045871734619,
                        0.6669737696647644,
                        0.6143098473548889,
                        0.6485490798950195,
                        0.8650391697883606,
                        0.7311530709266663,
                        0.9003531336784363
                    ]
                },
                "test": {
                    "score": 0.9210348100293131,
                    "pretrain_loss": 0.9959613084793091,
                    "pretrain_component": 0.5096940398216248,
                    "supervised_component": 0.4862672686576843,
                    "features_accuracy": [
                        0.6379215121269226,
                        0.6621829271316528,
                        0.6940605640411377,
                        0.9233462810516357,
                        0.9544868469238281,
                        0.6454149484634399,
                        0.7475585341453552,
                        0.6951047778129578,
                        0.6664824485778809,
                        0.6138443946838379,
                        0.6513113975524902,
                        0.8660402297973633,
                        0.7344757914543152,
                        0.9092807769775391
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": 0.9397575264367205,
                    "pretrain_loss": 0.9910076558589935,
                    "pretrain_component": 0.5038962364196777,
                    "supervised_component": 0.4871114194393158,
                    "features_accuracy": [
                        0.6596283912658691,
                        0.6624692678451538,
                        0.697212815284729,
                        0.9221053123474121,
                        0.9561962485313416,
                        0.6455773711204529,
                        0.759597659111023,
                        0.6944870948791504,
                        0.6747158765792847,
                        0.6278408765792847,
                        0.6624692678451538,
                        0.860872209072113,
                        0.7400951981544495,
                        0.9070945978164673
                    ]
                },
                "val": {
                    "score": 0.9271103309878046,
                    "pretrain_loss": 1.0045499503612518,
                    "pretrain_component": 0.5057156085968018,
                    "supervised_component": 0.4988343417644501,
                    "features_accuracy": [
                        0.6536158323287964,
                        0.6560724973678589,
                        0.7079686522483826,
                        0.9252264499664307,
                        0.9516351819038391,
                        0.6493167281150818,
                        0.7577153444290161,
                        0.6926147937774658,
                        0.6689697504043579,
                        0.6335022449493408,
                        0.6539229154586792,
                        0.8668816089630127,
                        0.7339167594909668,
                        0.9028097987174988
                    ]
                },
                "test": {
                    "score": 0.923290219907952,
                    "pretrain_loss": 0.9904077649116516,
                    "pretrain_component": 0.5052573084831238,
                    "supervised_component": 0.48515045642852783,
                    "features_accuracy": [
                        0.6416682600975037,
                        0.6621829271316528,
                        0.6962717771530151,
                        0.9228549003601074,
                        0.954241156578064,
                        0.6476261019706726,
                        0.7522265315055847,
                        0.6944290995597839,
                        0.667956531047821,
                        0.6215834617614746,
                        0.6562250852584839,
                        0.8669000864028931,
                        0.7379767894744873,
                        0.9105092287063599
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": 0.9421127086707768,
                    "pretrain_loss": 0.9913135766983032,
                    "pretrain_component": 0.5038530826568604,
                    "supervised_component": 0.48746049404144287,
                    "features_accuracy": [
                        0.6510672569274902,
                        0.6592828631401062,
                        0.6972895860671997,
                        0.9212607145309448,
                        0.9565801620483398,
                        0.6434274911880493,
                        0.7585226893424988,
                        0.6987868547439575,
                        0.6681510806083679,
                        0.6256909966468811,
                        0.6564803123474121,
                        0.8640586733818054,
                        0.736793577671051,
                        0.9080159664154053
                    ]
                },
                "val": {
                    "score": 0.9287643027382845,
                    "pretrain_loss": 1.0025637745857239,
                    "pretrain_component": 0.5042014122009277,
                    "supervised_component": 0.49836236238479614,
                    "features_accuracy": [
                        0.6546906232833862,
                        0.6560724973678589,
                        0.7090434432029724,
                        0.9255335330963135,
                        0.9517887234687805,
                        0.6473207473754883,
                        0.7589436769485474,
                        0.6944572329521179,
                        0.6669737696647644,
                        0.6385689973831177,
                        0.657147228717804,
                        0.8685705661773682,
                        0.7359127998352051,
                        0.9044986963272095
                    ]
                },
                "test": {
                    "score": 0.9244209462789448,
                    "pretrain_loss": 0.9892162382602692,
                    "pretrain_component": 0.5042805671691895,
                    "supervised_component": 0.4849356710910797,
                    "features_accuracy": [
                        0.641791045665741,
                        0.6621829271316528,
                        0.6969473958015442,
                        0.9229163527488708,
                        0.9546096920967102,
                        0.6497144103050232,
                        0.7511823773384094,
                        0.6971316337585449,
                        0.6700448393821716,
                        0.6250844597816467,
                        0.6589890122413635,
                        0.8674529194831848,
                        0.7366255521774292,
                        0.9111848473548889
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": 0.9433100299620532,
                    "pretrain_loss": 0.9870199859142303,
                    "pretrain_component": 0.5014894008636475,
                    "supervised_component": 0.4855305850505829,
                    "features_accuracy": [
                        0.6557509303092957,
                        0.663083553314209,
                        0.7023955583572388,
                        0.9215294718742371,
                        0.9557355642318726,
                        0.649761974811554,
                        0.7564496397972107,
                        0.7007063627243042,
                        0.6780558824539185,
                        0.6313728094100952,
                        0.6569793820381165,
                        0.8642506003379822,
                        0.7417076230049133,
                        0.9077855944633484
                    ]
                },
                "val": {
                    "score": 0.9294649305627205,
                    "pretrain_loss": 1.0017652213573456,
                    "pretrain_component": 0.5038155317306519,
                    "supervised_component": 0.4979496896266937,
                    "features_accuracy": [
                        0.6569936871528625,
                        0.6560724973678589,
                        0.7101182341575623,
                        0.9252264499664307,
                        0.9520958065986633,
                        0.6493167281150818,
                        0.7592507600784302,
                        0.696760356426239,
                        0.6677414178848267,
                        0.6387225389480591,
                        0.6543835401535034,
                        0.8679563999176025,
                        0.7334561944007874,
                        0.9028097987174988
                    ]
                },
                "test": {
                    "score": 0.9257007055513424,
                    "pretrain_loss": 0.9889081418514252,
                    "pretrain_component": 0.503420889377594,
                    "supervised_component": 0.4854872524738312,
                    "features_accuracy": [
                        0.6436337232589722,
                        0.6621829271316528,
                        0.6974387764930725,
                        0.9238376617431641,
                        0.9549168348312378,
                        0.6481174826622009,
                        0.7525336742401123,
                        0.6976844668388367,
                        0.6681408286094666,
                        0.6245931386947632,
                        0.6580677032470703,
                        0.8678213953971863,
                        0.7392052412033081,
                        0.9108163118362427
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": 0.9436895828912182,
                    "pretrain_loss": 0.9863011837005615,
                    "pretrain_component": 0.5015147924423218,
                    "supervised_component": 0.48478639125823975,
                    "features_accuracy": [
                        0.6556740999221802,
                        0.6673064827919006,
                        0.6998617649078369,
                        0.9221436977386475,
                        0.9556587934494019,
                        0.651259183883667,
                        0.7577165365219116,
                        0.7011670470237732,
                        0.6683430671691895,
                        0.6284167766571045,
                        0.659589946269989,
                        0.8645577430725098,
                        0.7387515306472778,
                        0.9070562124252319
                    ]
                },
                "val": {
                    "score": 0.9300249814283651,
                    "pretrain_loss": 1.0016016066074371,
                    "pretrain_component": 0.5035315752029419,
                    "supervised_component": 0.49807003140449524,
                    "features_accuracy": [
                        0.6556118726730347,
                        0.6560724973678589,
                        0.7085828185081482,
                        0.9247658848762512,
                        0.9517887234687805,
                        0.6473207473754883,
                        0.7574082612991333,
                        0.6939966082572937,
                        0.670505166053772,
                        0.6421003937721252,
                        0.6582220196723938,
                        0.8664209842681885,
                        0.7369875907897949,
                        0.9031168222427368
                    ]
                },
                "test": {
                    "score": 0.9262596076822568,
                    "pretrain_loss": 0.9875341355800629,
                    "pretrain_component": 0.5035758018493652,
                    "supervised_component": 0.48395833373069763,
                    "features_accuracy": [
                        0.6428966522216797,
                        0.6621829271316528,
                        0.6967631578445435,
                        0.923714816570282,
                        0.9549168348312378,
                        0.6486088633537292,
                        0.7533935308456421,
                        0.6976230144500732,
                        0.667833685874939,
                        0.6247159242630005,
                        0.6584362387657166,
                        0.8671457767486572,
                        0.7374854683876038,
                        0.910202145576477
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": 0.9442021885378369,
                    "pretrain_loss": 0.9896763265132904,
                    "pretrain_component": 0.5023249983787537,
                    "supervised_component": 0.48735132813453674,
                    "features_accuracy": [
                        0.6597819328308105,
                        0.6620853543281555,
                        0.696291446685791,
                        0.9213374853134155,
                        0.9558123350143433,
                        0.6457693576812744,
                        0.759597659111023,
                        0.6979422569274902,
                        0.6738712787628174,
                        0.6287622451782227,
                        0.6612407565116882,
                        0.8648264408111572,
                        0.7423218488693237,
                        0.9077088236808777
                    ]
                },
                "val": {
                    "score": 0.9303926740059018,
                    "pretrain_loss": 1.003649353981018,
                    "pretrain_component": 0.5037441849708557,
                    "supervised_component": 0.49990516901016235,
                    "features_accuracy": [
                        0.6563795804977417,
                        0.6560724973678589,
                        0.7085828185081482,
                        0.9246123433113098,
                        0.950560450553894,
                        0.6485490798950195,
                        0.7580224275588989,
                        0.6961461901664734,
                        0.6688162088394165,
                        0.6359588503837585,
                        0.6553047895431519,
                        0.8687241077423096,
                        0.7362198829650879,
                        0.9034239053726196
                    ]
                },
                "test": {
                    "score": 0.9258880761342234,
                    "pretrain_loss": 0.9875177443027496,
                    "pretrain_component": 0.5032761096954346,
                    "supervised_component": 0.48424163460731506,
                    "features_accuracy": [
                        0.6435108780860901,
                        0.6621829271316528,
                        0.6971316337585449,
                        0.9231619834899902,
                        0.954364001750946,
                        0.6502057909965515,
                        0.7528407573699951,
                        0.6992813944816589,
                        0.6694920659065247,
                        0.6231804490089417,
                        0.6578834652900696,
                        0.8675757646560669,
                        0.7373626232147217,
                        0.9108777642250061
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": 0.9441350293624896,
                    "pretrain_loss": 0.985944390296936,
                    "pretrain_component": 0.5014756321907043,
                    "supervised_component": 0.4844687581062317,
                    "features_accuracy": [
                        0.6567874550819397,
                        0.6612023711204529,
                        0.7010135054588318,
                        0.9215294718742371,
                        0.9558507204055786,
                        0.6499539017677307,
                        0.7574861645698547,
                        0.7007447481155396,
                        0.6793611645698547,
                        0.6321022510528564,
                        0.6583231091499329,
                        0.8642506003379822,
                        0.740402340888977,
                        0.9070177674293518
                    ]
                },
                "val": {
                    "score": 0.9303499205546728,
                    "pretrain_loss": 1.0010922849178314,
                    "pretrain_component": 0.5030953884124756,
                    "supervised_component": 0.49799689650535583,
                    "features_accuracy": [
                        0.6557654142379761,
                        0.6560724973678589,
                        0.7105788588523865,
                        0.9244588017463684,
                        0.9517887234687805,
                        0.6474742889404297,
                        0.7592507600784302,
                        0.6966068148612976,
                        0.6674343943595886,
                        0.6384154558181763,
                        0.6565330624580383,
                        0.8691847324371338,
                        0.734377384185791,
                        0.9046522378921509
                    ]
                },
                "test": {
                    "score": 0.9260125821196901,
                    "pretrain_loss": 0.9873462915420532,
                    "pretrain_component": 0.5030322074890137,
                    "supervised_component": 0.48431408405303955,
                    "features_accuracy": [
                        0.6446778774261475,
                        0.6621829271316528,
                        0.6977458596229553,
                        0.9235919713973999,
                        0.9548553824424744,
                        0.6492230296134949,
                        0.7545605897903442,
                        0.6975616216659546,
                        0.669983446598053,
                        0.6264971494674683,
                        0.6580063104629517,
                        0.8687427639961243,
                        0.7381610870361328,
                        0.911307692527771
                    ]
                }
            },
            "80000": {
                "train": {
                    "score": 0.9441063309272194,
                    "pretrain_loss": 0.9891459941864014,
                    "pretrain_component": 0.5012059807777405,
                    "supervised_component": 0.4879400134086609,
                    "features_accuracy": [
                        0.6554437875747681,
                        0.6607033014297485,
                        0.6956388354301453,
                        0.9219133853912354,
                        0.9567337036132812,
                        0.6516814827919006,
                        0.7581003904342651,
                        0.6983645558357239,
                        0.676021158695221,
                        0.6308353543281555,
                        0.6613943576812744,
                        0.8639050722122192,
                        0.7426673769950867,
                        0.9072481393814087
                    ]
                },
                "val": {
                    "score": 0.9299452781618209,
                    "pretrain_loss": 1.0011581480503082,
                    "pretrain_component": 0.5034483671188354,
                    "supervised_component": 0.4977097809314728,
                    "features_accuracy": [
                        0.6543835401535034,
                        0.6560724973678589,
                        0.7124212980270386,
                        0.9250729084014893,
                        0.9513280987739563,
                        0.6491631865501404,
                        0.7600184082984924,
                        0.6969138979911804,
                        0.6675878763198853,
                        0.6425610184669495,
                        0.6599109768867493,
                        0.8694918155670166,
                        0.735145092010498,
                        0.9040380716323853
                    ]
                },
                "test": {
                    "score": 0.9259047933288461,
                    "pretrain_loss": 0.9870544970035553,
                    "pretrain_component": 0.5029507875442505,
                    "supervised_component": 0.4841037094593048,
                    "features_accuracy": [
                        0.6434494256973267,
                        0.6621829271316528,
                        0.6948590874671936,
                        0.9232234358787537,
                        0.9547939896583557,
                        0.6470733284950256,
                        0.7540692090988159,
                        0.6964560151100159,
                        0.6721946001052856,
                        0.6245316863059998,
                        0.6599717736244202,
                        0.8686813116073608,
                        0.7392666339874268,
                        0.9110006093978882
                    ]
                }
            },
            "90000": {
                "train": {
                    "score": 0.9449422978055169,
                    "pretrain_loss": 0.9812672436237335,
                    "pretrain_component": 0.5008988976478577,
                    "supervised_component": 0.48036834597587585,
                    "features_accuracy": [
                        0.6553670167922974,
                        0.6615478992462158,
                        0.7056204080581665,
                        0.922450840473175,
                        0.9562730193138123,
                        0.6454238295555115,
                        0.7596744298934937,
                        0.7018197178840637,
                        0.6775184273719788,
                        0.6337530612945557,
                        0.6578624248504639,
                        0.8630988597869873,
                        0.7387899160385132,
                        0.9070945978164673
                    ]
                },
                "val": {
                    "score": 0.930094754029013,
                    "pretrain_loss": 1.0020247399806976,
                    "pretrain_component": 0.503325879573822,
                    "supervised_component": 0.4986988604068756,
                    "features_accuracy": [
                        0.6551512479782104,
                        0.6560724973678589,
                        0.7085828185081482,
                        0.9238446354866028,
                        0.9520958065986633,
                        0.6491631865501404,
                        0.7597113251686096,
                        0.6956855654716492,
                        0.6663596034049988,
                        0.6373407244682312,
                        0.6556118726730347,
                        0.8693382740020752,
                        0.7366805076599121,
                        0.9034239053726196
                    ]
                },
                "test": {
                    "score": 0.9258495189023485,
                    "pretrain_loss": 0.9866729378700256,
                    "pretrain_component": 0.5027949810028076,
                    "supervised_component": 0.483877956867218,
                    "features_accuracy": [
                        0.6444936394691467,
                        0.6621829271316528,
                        0.6970702409744263,
                        0.9240218997001648,
                        0.9545482993125916,
                        0.6490387916564941,
                        0.7532707452774048,
                        0.6976230144500732,
                        0.6691849827766418,
                        0.6264357566833496,
                        0.6573920845985413,
                        0.8688656091690063,
                        0.7406793236732483,
                        0.9110006093978882
                    ]
                }
            }
        },
        "train": {
            "score": 0.9442021885378369
        },
        "val": {
            "score": 0.9303926740059018
        },
        "test": {
            "score": 0.9258880761342234
        }
    },
    "best_iteration": 60000,
    "time": "0:11:17"
}
