{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised___26794a389b7d462b82307876cd14ffed.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 5,
        "data": {
            "path": "data/california",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512,
                    512
                ],
                "dropout": 0.09554470492566089
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "positional",
                "linear",
                "relu"
            ],
            "d_num_embedding": 113,
            "positional_encoding": {
                "n": 74,
                "sigma": 0.03659148914705552,
                "trainable": true,
                "initialization": "normal"
            },
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.000638613328704204,
            "weight_decay": 0.0,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.5594919888081074,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.000638613328704204,
            "weight_decay": 0.0,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "epoch_size": 104,
    "n_parameters": 1128577,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -0.28859322290162226,
                    "pretrain_loss": 1.4232386946678162,
                    "pretrain_component": 0.6625800728797913,
                    "supervised_component": 0.7606586217880249,
                    "features_accuracy": [
                        0.5856612920761108,
                        0.559467077255249,
                        0.594367504119873,
                        0.55923992395401,
                        0.5601484179496765,
                        0.5676432847976685,
                        0.6589446663856506,
                        0.6611401438713074
                    ]
                },
                "val": {
                    "score": -0.4645971590039397,
                    "pretrain_loss": 1.3974348902702332,
                    "pretrain_component": 0.6651663184165955,
                    "supervised_component": 0.7322685718536377,
                    "features_accuracy": [
                        0.5818952322006226,
                        0.5522252321243286,
                        0.583106279373169,
                        0.5619134306907654,
                        0.5573720932006836,
                        0.568271279335022,
                        0.6542537212371826,
                        0.6518316864967346
                    ]
                },
                "test": {
                    "score": -0.46527831862316904,
                    "pretrain_loss": 1.4037994742393494,
                    "pretrain_component": 0.6627777814865112,
                    "supervised_component": 0.7410216927528381,
                    "features_accuracy": [
                        0.5796996355056763,
                        0.5625,
                        0.5915697813034058,
                        0.5772771239280701,
                        0.5651647448539734,
                        0.5683139562606812,
                        0.661821722984314,
                        0.6564922332763672
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -0.3243098074179313,
                    "pretrain_loss": 1.399331271648407,
                    "pretrain_component": 0.6600400805473328,
                    "supervised_component": 0.7392911911010742,
                    "features_accuracy": [
                        0.5921720266342163,
                        0.5598455667495728,
                        0.594670295715332,
                        0.5744568109512329,
                        0.5602241158485413,
                        0.5747596621513367,
                        0.6559164524078369,
                        0.6639412641525269
                    ]
                },
                "val": {
                    "score": -0.45433057670368543,
                    "pretrain_loss": 1.377706527709961,
                    "pretrain_component": 0.6614826321601868,
                    "supervised_component": 0.7162238955497742,
                    "features_accuracy": [
                        0.5912806391716003,
                        0.563427209854126,
                        0.5815925002098083,
                        0.5643354654312134,
                        0.5543445348739624,
                        0.5667575001716614,
                        0.6584922671318054,
                        0.6660611629486084
                    ]
                },
                "test": {
                    "score": -0.45762386172174857,
                    "pretrain_loss": 1.402606725692749,
                    "pretrain_component": 0.6609797477722168,
                    "supervised_component": 0.7416269779205322,
                    "features_accuracy": [
                        0.5879360437393188,
                        0.567829430103302,
                        0.5978682041168213,
                        0.575339138507843,
                        0.5675871968269348,
                        0.5576550364494324,
                        0.6695736646652222,
                        0.661579430103302
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -0.32711691713162966,
                    "pretrain_loss": 1.3965267539024353,
                    "pretrain_component": 0.6584590077400208,
                    "supervised_component": 0.7380677461624146,
                    "features_accuracy": [
                        0.5884624123573303,
                        0.5740025639533997,
                        0.601862370967865,
                        0.5611326098442078,
                        0.5708986520767212,
                        0.5725641846656799,
                        0.6537209749221802,
                        0.6609887480735779
                    ]
                },
                "val": {
                    "score": -0.45403243202719284,
                    "pretrain_loss": 1.3814453482627869,
                    "pretrain_component": 0.6607274413108826,
                    "supervised_component": 0.7207179069519043,
                    "features_accuracy": [
                        0.583106279373169,
                        0.5600968599319458,
                        0.5840145349502563,
                        0.5652437210083008,
                        0.5543445348739624,
                        0.5613079071044922,
                        0.6569784879684448,
                        0.662428081035614
                    ]
                },
                "test": {
                    "score": -0.4445618176836696,
                    "pretrain_loss": 1.3993566036224365,
                    "pretrain_component": 0.6600329279899597,
                    "supervised_component": 0.7393236756324768,
                    "features_accuracy": [
                        0.5806686282157898,
                        0.5620154738426208,
                        0.5896317958831787,
                        0.5731589198112488,
                        0.5687984228134155,
                        0.5675871968269348,
                        0.6661821603775024,
                        0.659641444683075
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -0.3134883635952524,
                    "pretrain_loss": 1.39161616563797,
                    "pretrain_component": 0.6551710367202759,
                    "supervised_component": 0.7364451289176941,
                    "features_accuracy": [
                        0.6060262322425842,
                        0.5691574215888977,
                        0.6075403094291687,
                        0.5662806034088135,
                        0.555757462978363,
                        0.5769551396369934,
                        0.6693164110183716,
                        0.6787039637565613
                    ]
                },
                "val": {
                    "score": -0.44313705521263624,
                    "pretrain_loss": 1.368301272392273,
                    "pretrain_component": 0.6595509052276611,
                    "supervised_component": 0.7087503671646118,
                    "features_accuracy": [
                        0.5876476168632507,
                        0.565546452999115,
                        0.5940054655075073,
                        0.5652437210083008,
                        0.5570693016052246,
                        0.5764456391334534,
                        0.6603087782859802,
                        0.6666666865348816
                    ]
                },
                "test": {
                    "score": -0.44950291195019554,
                    "pretrain_loss": 1.3936073184013367,
                    "pretrain_component": 0.6587701439857483,
                    "supervised_component": 0.7348371744155884,
                    "features_accuracy": [
                        0.5903584957122803,
                        0.5673449635505676,
                        0.5920542478561401,
                        0.5746123790740967,
                        0.5656492114067078,
                        0.5729166865348816,
                        0.6659399271011353,
                        0.6736918687820435
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": -0.31075054831014937,
                    "pretrain_loss": 1.3791142702102661,
                    "pretrain_component": 0.6535130739212036,
                    "supervised_component": 0.7256011962890625,
                    "features_accuracy": [
                        0.6103414297103882,
                        0.5736997723579407,
                        0.6025437116622925,
                        0.5649178624153137,
                        0.5580286383628845,
                        0.5831630229949951,
                        0.6683322191238403,
                        0.6727231740951538
                    ]
                },
                "val": {
                    "score": -0.4451499878244849,
                    "pretrain_loss": 1.378118634223938,
                    "pretrain_component": 0.6584897637367249,
                    "supervised_component": 0.7196288704872131,
                    "features_accuracy": [
                        0.5958219766616821,
                        0.5664547085762024,
                        0.5888586044311523,
                        0.5694822669029236,
                        0.5513169765472412,
                        0.563124418258667,
                        0.660006046295166,
                        0.6733272671699524
                    ]
                },
                "test": {
                    "score": -0.4462882723290135,
                    "pretrain_loss": 1.3913229703903198,
                    "pretrain_component": 0.6581922173500061,
                    "supervised_component": 0.7331307530403137,
                    "features_accuracy": [
                        0.5906007885932922,
                        0.5632267594337463,
                        0.59375,
                        0.5738856792449951,
                        0.5690407156944275,
                        0.5714631676673889,
                        0.6669089198112488,
                        0.6719961166381836
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": -0.32476005139497327,
                    "pretrain_loss": 1.3772181868553162,
                    "pretrain_component": 0.6523474454879761,
                    "supervised_component": 0.7248707413673401,
                    "features_accuracy": [
                        0.606404721736908,
                        0.5732455253601074,
                        0.6000454425811768,
                        0.5763494968414307,
                        0.5617382526397705,
                        0.5810432434082031,
                        0.6681051254272461,
                        0.681202232837677
                    ]
                },
                "val": {
                    "score": -0.4487865173566707,
                    "pretrain_loss": 1.3767439723014832,
                    "pretrain_component": 0.656709611415863,
                    "supervised_component": 0.7200343608856201,
                    "features_accuracy": [
                        0.6012715697288513,
                        0.5719043016433716,
                        0.5855283141136169,
                        0.5649409890174866,
                        0.5540418028831482,
                        0.5667575001716614,
                        0.6639418601989746,
                        0.6721162796020508
                    ]
                },
                "test": {
                    "score": -0.4379706302633612,
                    "pretrain_loss": 1.3919050693511963,
                    "pretrain_component": 0.6572990417480469,
                    "supervised_component": 0.7346060276031494,
                    "features_accuracy": [
                        0.59375,
                        0.5627422332763672,
                        0.5932654738426208,
                        0.5738856792449951,
                        0.5709787011146545,
                        0.5709787011146545,
                        0.6681201457977295,
                        0.6734496355056763
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": -0.2648552036064798,
                    "pretrain_loss": 1.392758309841156,
                    "pretrain_component": 0.6550411581993103,
                    "supervised_component": 0.7377171516418457,
                    "features_accuracy": [
                        0.6001211404800415,
                        0.5725641846656799,
                        0.5982285141944885,
                        0.570141613483429,
                        0.5743811130523682,
                        0.5781664252281189,
                        0.6687864661216736,
                        0.6753728985786438
                    ]
                },
                "val": {
                    "score": -0.44649879142441773,
                    "pretrain_loss": 1.3703551888465881,
                    "pretrain_component": 0.6574029326438904,
                    "supervised_component": 0.7129522562026978,
                    "features_accuracy": [
                        0.5879503488540649,
                        0.5673630237579346,
                        0.5900696516036987,
                        0.5619134306907654,
                        0.5600968599319458,
                        0.5664547085762024,
                        0.6660611629486084,
                        0.677263081073761
                    ]
                },
                "test": {
                    "score": -0.43707390804781765,
                    "pretrain_loss": 1.3903107047080994,
                    "pretrain_component": 0.6571030616760254,
                    "supervised_component": 0.733207643032074,
                    "features_accuracy": [
                        0.5915697813034058,
                        0.5668604373931885,
                        0.5915697813034058,
                        0.5721899271011353,
                        0.5692829489707947,
                        0.567829430103302,
                        0.6693313717842102,
                        0.6739341020584106
                    ]
                }
            }
        },
        "train": {
            "score": -0.3134883635952524
        },
        "val": {
            "score": -0.44313705521263624
        },
        "test": {
            "score": -0.44950291195019554
        }
    },
    "best_iteration": 40000,
    "time": "0:07:02"
}
