{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised_fast___329adb4a24fc4b4bba57f690128d8eb2.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0,1",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                },
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 7,
        "data": {
            "path": "data/fb-comments",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512
                ],
                "dropout": 0.37494127660231846
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "positional",
                "linear",
                "relu"
            ],
            "d_num_embedding": 20,
            "positional_encoding": {
                "n": 61,
                "sigma": 0.42695197074977964,
                "trainable": true,
                "initialization": "normal"
            },
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 512,
            "lr": 7.209469427576103e-05,
            "weight_decay": 0.0,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 1024
        },
        "pretrain": {
            "corrupt_probability": 0.4527672028457442,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 7.209469427576103e-05,
            "weight_decay": 0.0,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "n_parameters": 969366,
    "epoch_size": 308,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -3.2076645524028815,
                    "pretrain_loss": 0.9348267316818237,
                    "pretrain_component": 0.4144267439842224,
                    "supervised_component": 0.5203999876976013,
                    "features_accuracy": [
                        0.557771623134613,
                        0.7224336862564087,
                        0.775288999080658,
                        0.8114858269691467,
                        0.8400766253471375,
                        0.7881157994270325,
                        0.7557886242866516,
                        0.8172839283943176,
                        0.8500425219535828,
                        0.7941042184829712,
                        0.9924764633178711,
                        0.6846826672554016,
                        0.7683426737785339,
                        0.8184194564819336,
                        0.7943452596664429,
                        0.7833961248397827,
                        0.7469518780708313,
                        0.7598231434822083,
                        0.6404547095298767,
                        0.8558406233787537,
                        0.8107816576957703,
                        0.7375125288963318,
                        0.7181517481803894,
                        0.7594107985496521,
                        0.7447696924209595,
                        0.7227382063865662,
                        0.5807546377182007,
                        0.5546505451202393,
                        0.6506616473197937,
                        0.9834303855895996,
                        0.905225932598114,
                        0.9924130439758301,
                        0.8894366025924683,
                        0.8877555131912231,
                        0.8833783864974976,
                        0.8906101584434509,
                        0.8894683122634888,
                        0.8972519636154175,
                        0.8910351991653442,
                        0.8949745893478394,
                        0.8968523144721985,
                        0.890540361404419,
                        0.7682221531867981,
                        0.8866453766822815,
                        0.8910669088363647,
                        0.8916568756103516,
                        0.8029218912124634,
                        0.798957109451294,
                        0.7860351204872131,
                        0.9966251850128174,
                        0.5799490213394165
                    ]
                },
                "val": {
                    "score": -5.208015069532063,
                    "pretrain_loss": 0.9230276942253113,
                    "pretrain_component": 0.41414690017700195,
                    "supervised_component": 0.5088807940483093,
                    "features_accuracy": [
                        0.5592231750488281,
                        0.7269039154052734,
                        0.7760369181632996,
                        0.8108204007148743,
                        0.8407869338989258,
                        0.7857722043991089,
                        0.7567183375358582,
                        0.8158401846885681,
                        0.8519419431686401,
                        0.7958117723464966,
                        0.9925970435142517,
                        0.6773146390914917,
                        0.7677720189094543,
                        0.8192373514175415,
                        0.7959638833999634,
                        0.7801439762115479,
                        0.7449041604995728,
                        0.7614338994026184,
                        0.6417198777198792,
                        0.8557448387145996,
                        0.8127978444099426,
                        0.7362843155860901,
                        0.7171686291694641,
                        0.7612817883491516,
                        0.7474393844604492,
                        0.7191461324691772,
                        0.5790994763374329,
                        0.5569921731948853,
                        0.6497819423675537,
                        0.9825068116188049,
                        0.9025960564613342,
                        0.9918872117996216,
                        0.8911874890327454,
                        0.889362096786499,
                        0.8843423128128052,
                        0.8935198783874512,
                        0.8901733756065369,
                        0.8962579369544983,
                        0.892810046672821,
                        0.8942804932594299,
                        0.8954466581344604,
                        0.893570601940155,
                        0.7693438529968262,
                        0.8900212645530701,
                        0.8909846544265747,
                        0.8905283212661743,
                        0.8028090000152588,
                        0.8002737760543823,
                        0.7882567644119263,
                        0.9961971044540405,
                        0.5772233605384827
                    ]
                },
                "test": {
                    "score": -5.432003931257197,
                    "pretrain_loss": 0.9052397906780243,
                    "pretrain_component": 0.4141254127025604,
                    "supervised_component": 0.49111437797546387,
                    "features_accuracy": [
                        0.5586206912994385,
                        0.7230223417282104,
                        0.779411792755127,
                        0.8130324482917786,
                        0.8384381532669067,
                        0.7874239683151245,
                        0.7556794881820679,
                        0.8212981820106506,
                        0.8498478531837463,
                        0.7949796915054321,
                        0.993864119052887,
                        0.6878803372383118,
                        0.7734786868095398,
                        0.8147059082984924,
                        0.791632890701294,
                        0.7749999761581421,
                        0.7435598373413086,
                        0.760496973991394,
                        0.635598361492157,
                        0.8559837937355042,
                        0.8063387274742126,
                        0.7393509149551392,
                        0.7154665589332581,
                        0.767241358757019,
                        0.7471095323562622,
                        0.7255070805549622,
                        0.5758620500564575,
                        0.5519776940345764,
                        0.6502535343170166,
                        0.9834685921669006,
                        0.9070487022399902,
                        0.9927992224693298,
                        0.8914300203323364,
                        0.889452338218689,
                        0.8840263485908508,
                        0.8870689868927002,
                        0.8926977515220642,
                        0.8924442529678345,
                        0.8937119841575623,
                        0.9008620977401733,
                        0.8947768807411194,
                        0.8918356895446777,
                        0.76835697889328,
                        0.8841785192489624,
                        0.8929513096809387,
                        0.8864604234695435,
                        0.8025861978530884,
                        0.8003042340278625,
                        0.7837221026420593,
                        0.9972109794616699,
                        0.5776368975639343
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -3.798597466164344,
                    "pretrain_loss": 0.8454653024673462,
                    "pretrain_component": 0.3589874804019928,
                    "supervised_component": 0.4864778220653534,
                    "features_accuracy": [
                        0.6449523568153381,
                        0.7232646942138672,
                        0.8235006928443909,
                        0.8605539202690125,
                        0.8778150081634521,
                        0.8548763990402222,
                        0.8219591975212097,
                        0.875670850276947,
                        0.8806379437446594,
                        0.8615182042121887,
                        0.9932630658149719,
                        0.7326152324676514,
                        0.8248011469841003,
                        0.8781131505966187,
                        0.8555043935775757,
                        0.841929018497467,
                        0.8395881652832031,
                        0.8345703482627869,
                        0.6978774070739746,
                        0.8827694058418274,
                        0.8780560493469238,
                        0.7669026851654053,
                        0.7525850534439087,
                        0.7930130958557129,
                        0.7718570828437805,
                        0.75340336561203,
                        0.6070871353149414,
                        0.5552278161048889,
                        0.6633045673370361,
                        0.9833542704582214,
                        0.9086514711380005,
                        0.9930283427238464,
                        0.8956279754638672,
                        0.895215630531311,
                        0.8870386481285095,
                        0.8973026871681213,
                        0.8959769010543823,
                        0.9006648063659668,
                        0.8982225060462952,
                        0.9034116268157959,
                        0.9029104709625244,
                        0.8978926539421082,
                        0.8366003036499023,
                        0.8934394121170044,
                        0.897087037563324,
                        0.8986665606498718,
                        0.8662822842597961,
                        0.8552506566047668,
                        0.8607442378997803,
                        0.9967647790908813,
                        0.5785280466079712
                    ]
                },
                "val": {
                    "score": -5.227714460405392,
                    "pretrain_loss": 0.8486093878746033,
                    "pretrain_component": 0.3591274917125702,
                    "supervised_component": 0.4894818961620331,
                    "features_accuracy": [
                        0.6452692151069641,
                        0.7266504168510437,
                        0.8226853013038635,
                        0.8620322346687317,
                        0.8781563639640808,
                        0.8521447777748108,
                        0.8240036368370056,
                        0.8727816343307495,
                        0.8858634829521179,
                        0.8636040687561035,
                        0.9926984906196594,
                        0.7265490293502808,
                        0.8233444690704346,
                        0.8805902004241943,
                        0.8542743921279907,
                        0.8390122652053833,
                        0.8384037613868713,
                        0.8339924812316895,
                        0.6992191076278687,
                        0.8827704787254333,
                        0.8809958100318909,
                        0.7649325132369995,
                        0.7488084435462952,
                        0.7950004935264587,
                        0.7748199701309204,
                        0.7507352232933044,
                        0.6047053933143616,
                        0.5569921731948853,
                        0.6607341766357422,
                        0.983165979385376,
                        0.9068045616149902,
                        0.992343544960022,
                        0.8962072730064392,
                        0.896460771560669,
                        0.8898691534996033,
                        0.9004157781600952,
                        0.8946353793144226,
                        0.8996551632881165,
                        0.8980833292007446,
                        0.9037115573883057,
                        0.9022411108016968,
                        0.9025453329086304,
                        0.8345502018928528,
                        0.8959030508995056,
                        0.89711993932724,
                        0.897018551826477,
                        0.8656829595565796,
                        0.8511306643486023,
                        0.8626914024353027,
                        0.9961971044540405,
                        0.5776797533035278
                    ]
                },
                "test": {
                    "score": -5.499404649621688,
                    "pretrain_loss": 0.8355081975460052,
                    "pretrain_component": 0.35924142599105835,
                    "supervised_component": 0.4762667715549469,
                    "features_accuracy": [
                        0.6435598134994507,
                        0.7212981581687927,
                        0.8247464299201965,
                        0.8658722043037415,
                        0.8742393255233765,
                        0.8521298170089722,
                        0.8217545747756958,
                        0.875608503818512,
                        0.8799188733100891,
                        0.8627281785011292,
                        0.9943205118179321,
                        0.7333671450614929,
                        0.8276368975639343,
                        0.8763691782951355,
                        0.8556795120239258,
                        0.8339756727218628,
                        0.8403143882751465,
                        0.8326064944267273,
                        0.6950811147689819,
                        0.8832150101661682,
                        0.877738356590271,
                        0.7651115655899048,
                        0.7496450543403625,
                        0.799391508102417,
                        0.7725659012794495,
                        0.7532454133033752,
                        0.6072515249252319,
                        0.5509635210037231,
                        0.6633366942405701,
                        0.9836714267730713,
                        0.91217041015625,
                        0.9933570027351379,
                        0.8956389427185059,
                        0.8966024518013,
                        0.8891987800598145,
                        0.8943712115287781,
                        0.8962981700897217,
                        0.8979716300964355,
                        0.8999999761581421,
                        0.9077586531639099,
                        0.9013691544532776,
                        0.9004563689231873,
                        0.8367140293121338,
                        0.8902636766433716,
                        0.8978701829910278,
                        0.8931541442871094,
                        0.8664807081222534,
                        0.8545131683349609,
                        0.8622211217880249,
                        0.997261643409729,
                        0.5775862336158752
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -3.420067395576414,
                    "pretrain_loss": 0.8273720145225525,
                    "pretrain_component": 0.3377741575241089,
                    "supervised_component": 0.4895978569984436,
                    "features_accuracy": [
                        0.7097971439361572,
                        0.7258973121643066,
                        0.8560372591018677,
                        0.8889354467391968,
                        0.893883466720581,
                        0.8875334858894348,
                        0.8450691103935242,
                        0.8860554099082947,
                        0.8926845192909241,
                        0.8800860643386841,
                        0.9929649233818054,
                        0.7519570589065552,
                        0.8697205185890198,
                        0.8874319791793823,
                        0.8723531365394592,
                        0.8811390995979309,
                        0.8534363508224487,
                        0.8568175435066223,
                        0.7236960530281067,
                        0.8981971740722656,
                        0.8929763436317444,
                        0.7758725881576538,
                        0.7590492367744446,
                        0.8050026297569275,
                        0.7831994891166687,
                        0.7679747343063354,
                        0.6190448999404907,
                        0.5558050870895386,
                        0.6747294664382935,
                        0.9838110208511353,
                        0.9121341705322266,
                        0.9929966330528259,
                        0.8976325988769531,
                        0.8941752910614014,
                        0.8912952542304993,
                        0.8990598917007446,
                        0.8979370594024658,
                        0.9021175503730774,
                        0.9012547731399536,
                        0.9044646620750427,
                        0.9049658179283142,
                        0.8959895372390747,
                        0.8539565801620483,
                        0.8950634002685547,
                        0.8984763026237488,
                        0.9003666639328003,
                        0.886746883392334,
                        0.8699171543121338,
                        0.8805808424949646,
                        0.9963270425796509,
                        0.5879483222961426
                    ]
                },
                "val": {
                    "score": -5.245702176327071,
                    "pretrain_loss": 0.8228403329849243,
                    "pretrain_component": 0.3375926613807678,
                    "supervised_component": 0.4852476716041565,
                    "features_accuracy": [
                        0.7110333442687988,
                        0.727157473564148,
                        0.8547307252883911,
                        0.8888550400733948,
                        0.8940269351005554,
                        0.8831254243850708,
                        0.8466179370880127,
                        0.8832775354385376,
                        0.8958523273468018,
                        0.8814521431922913,
                        0.9932055473327637,
                        0.7464759945869446,
                        0.8685224652290344,
                        0.890122652053833,
                        0.8694351315498352,
                        0.8800831437110901,
                        0.852651834487915,
                        0.8578744530677795,
                        0.7209714651107788,
                        0.8986411094665527,
                        0.8942804932594299,
                        0.7742115259170532,
                        0.7556028366088867,
                        0.8048372268676758,
                        0.7889159321784973,
                        0.7641212940216064,
                        0.6245309710502625,
                        0.557245671749115,
                        0.6713821887969971,
                        0.9834194779396057,
                        0.9113680124282837,
                        0.9926477670669556,
                        0.8983368873596191,
                        0.896359384059906,
                        0.892911434173584,
                        0.9021904468536377,
                        0.8986917734146118,
                        0.901328444480896,
                        0.9024439454078674,
                        0.9040157794952393,
                        0.9052327275276184,
                        0.8997566103935242,
                        0.851333498954773,
                        0.8983875513076782,
                        0.8983368873596191,
                        0.9002129435539246,
                        0.8881958723068237,
                        0.8665449619293213,
                        0.8821620345115662,
                        0.9960449934005737,
                        0.5853868722915649
                    ]
                },
                "test": {
                    "score": -5.5267988720739085,
                    "pretrain_loss": 0.8130837976932526,
                    "pretrain_component": 0.337653249502182,
                    "supervised_component": 0.47543054819107056,
                    "features_accuracy": [
                        0.7017748355865479,
                        0.7239857912063599,
                        0.8570486903190613,
                        0.8932048678398132,
                        0.8911257386207581,
                        0.8860547542572021,
                        0.8440162539482117,
                        0.8872718214988708,
                        0.8918356895446777,
                        0.8808823823928833,
                        0.9949290156364441,
                        0.7529919147491455,
                        0.87337726354599,
                        0.8861562013626099,
                        0.8701825737953186,
                        0.8771805167198181,
                        0.8537525534629822,
                        0.8561866283416748,
                        0.7195740342140198,
                        0.8982251286506653,
                        0.8923935294151306,
                        0.7789553999900818,
                        0.7544117569923401,
                        0.8113590478897095,
                        0.7851420044898987,
                        0.7686105370521545,
                        0.6161764860153198,
                        0.5518255829811096,
                        0.6750507354736328,
                        0.9836714267730713,
                        0.9156693816184998,
                        0.9935598373413086,
                        0.8987829685211182,
                        0.8964502811431885,
                        0.8916835784912109,
                        0.8968560099601746,
                        0.8985801339149475,
                        0.8992393612861633,
                        0.9038032293319702,
                        0.9076572060585022,
                        0.9038032293319702,
                        0.8985801339149475,
                        0.8528904914855957,
                        0.8925456404685974,
                        0.900050699710846,
                        0.8962981700897217,
                        0.8875760436058044,
                        0.868864119052887,
                        0.8825557827949524,
                        0.9971602559089661,
                        0.5856997966766357
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -4.13300069586447,
                    "pretrain_loss": 0.8090702593326569,
                    "pretrain_component": 0.3279896378517151,
                    "supervised_component": 0.4810806214809418,
                    "features_accuracy": [
                        0.7194331288337708,
                        0.7335350513458252,
                        0.8712493181228638,
                        0.8991360068321228,
                        0.9019779562950134,
                        0.8934013843536377,
                        0.8582956194877625,
                        0.8902232050895691,
                        0.8961671590805054,
                        0.8925957083702087,
                        0.9936119914054871,
                        0.7567908763885498,
                        0.8787983059883118,
                        0.8931919932365417,
                        0.8810122013092041,
                        0.8920438289642334,
                        0.860388994216919,
                        0.8686484694480896,
                        0.7294434309005737,
                        0.9050166010856628,
                        0.9008805155754089,
                        0.782095730304718,
                        0.7637689113616943,
                        0.8108387589454651,
                        0.7934698462486267,
                        0.7753587365150452,
                        0.6235425472259521,
                        0.5532866716384888,
                        0.6801976561546326,
                        0.9841852784156799,
                        0.914360761642456,
                        0.9934343695640564,
                        0.8991804122924805,
                        0.8950760960578918,
                        0.8927479386329651,
                        0.8978292346000671,
                        0.8988378643989563,
                        0.9025108218193054,
                        0.9044456481933594,
                        0.9075984358787537,
                        0.9051688313484192,
                        0.896814227104187,
                        0.8626980781555176,
                        0.8945305347442627,
                        0.9002905488014221,
                        0.8992184996604919,
                        0.8985841274261475,
                        0.8741356730461121,
                        0.8868610262870789,
                        0.9964983463287354,
                        0.5926806926727295
                    ]
                },
                "val": {
                    "score": -5.3156745888872585,
                    "pretrain_loss": 0.807919442653656,
                    "pretrain_component": 0.3279966711997986,
                    "supervised_component": 0.4799227714538574,
                    "features_accuracy": [
                        0.7216813564300537,
                        0.7337490916252136,
                        0.8728323578834534,
                        0.8970692157745361,
                        0.9026974439620972,
                        0.8903254866600037,
                        0.8591927289962769,
                        0.8885001540184021,
                        0.9008721113204956,
                        0.8941283822059631,
                        0.9934590458869934,
                        0.7544873356819153,
                        0.8790183067321777,
                        0.8930635452270508,
                        0.8786126971244812,
                        0.890731155872345,
                        0.8581279516220093,
                        0.8699928522109985,
                        0.7270053625106812,
                        0.9056383371353149,
                        0.9022918343544006,
                        0.7798904776573181,
                        0.7638677358627319,
                        0.8122908473014832,
                        0.7950512170791626,
                        0.7701044082641602,
                        0.629043698310852,
                        0.557245671749115,
                        0.6731061339378357,
                        0.9834194779396057,
                        0.9123314023017883,
                        0.9923942685127258,
                        0.8983368873596191,
                        0.8965622186660767,
                        0.8939255475997925,
                        0.901987612247467,
                        0.8988946080207825,
                        0.9022411108016968,
                        0.9053341150283813,
                        0.907717227935791,
                        0.9056383371353149,
                        0.9017847776412964,
                        0.8599026203155518,
                        0.8980833292007446,
                        0.8988946080207825,
                        0.9009734988212585,
                        0.8979819416999817,
                        0.8733394145965576,
                        0.8866240382194519,
                        0.996552050113678,
                        0.5888347625732422
                    ]
                },
                "test": {
                    "score": -5.521598004726526,
                    "pretrain_loss": 0.7984223067760468,
                    "pretrain_component": 0.3280521035194397,
                    "supervised_component": 0.47037020325660706,
                    "features_accuracy": [
                        0.7121703624725342,
                        0.7314401865005493,
                        0.8724644780158997,
                        0.8997971415519714,
                        0.8990872502326965,
                        0.8930020332336426,
                        0.8557302355766296,
                        0.8912271857261658,
                        0.8960446119308472,
                        0.8914807438850403,
                        0.9952839612960815,
                        0.7581642866134644,
                        0.8829107284545898,
                        0.89056795835495,
                        0.8778904676437378,
                        0.8879817724227905,
                        0.8592799305915833,
                        0.868864119052887,
                        0.7281947135925293,
                        0.9047667384147644,
                        0.8990872502326965,
                        0.7822515368461609,
                        0.762829601764679,
                        0.8212981820106506,
                        0.7938640713691711,
                        0.7754563689231873,
                        0.6239858269691467,
                        0.5519269704818726,
                        0.6779918670654297,
                        0.9840770959854126,
                        0.9180527329444885,
                        0.9941176772117615,
                        0.8995943069458008,
                        0.8962981700897217,
                        0.894472599029541,
                        0.8965010046958923,
                        0.8985801339149475,
                        0.8999999761581421,
                        0.9069979786872864,
                        0.9096348881721497,
                        0.9034990072250366,
                        0.9017241597175598,
                        0.8623225092887878,
                        0.8923428058624268,
                        0.901673436164856,
                        0.8959939479827881,
                        0.8973630666732788,
                        0.8757606744766235,
                        0.8880831599235535,
                        0.9974138140678406,
                        0.5898579955101013
                    ]
                }
            }
        },
        "train": {
            "score": -3.2076645524028815
        },
        "val": {
            "score": -5.208015069532063
        },
        "test": {
            "score": -5.432003931257197
        }
    },
    "best_iteration": 10000,
    "time": "0:33:00"
}
