{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised_fast___4581a19c4f3e4f15835011244ff80526.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0,1",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                },
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 14,
        "data": {
            "path": "data/fb-comments",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512
                ],
                "dropout": 0.37494127660231846
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "positional",
                "linear",
                "relu"
            ],
            "d_num_embedding": 20,
            "positional_encoding": {
                "n": 61,
                "sigma": 0.42695197074977964,
                "trainable": true,
                "initialization": "normal"
            },
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 512,
            "lr": 7.209469427576103e-05,
            "weight_decay": 0.0,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 1024
        },
        "pretrain": {
            "corrupt_probability": 0.4527672028457442,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 7.209469427576103e-05,
            "weight_decay": 0.0,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "n_parameters": 969366,
    "epoch_size": 308,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -3.1358029070347437,
                    "pretrain_loss": 0.9280000030994415,
                    "pretrain_component": 0.4146457612514496,
                    "supervised_component": 0.5133542418479919,
                    "features_accuracy": [
                        0.5856139063835144,
                        0.7254278659820557,
                        0.7650249600410461,
                        0.8054085969924927,
                        0.8609916567802429,
                        0.7904375791549683,
                        0.7643651962280273,
                        0.8114604353904724,
                        0.867868185043335,
                        0.7919981479644775,
                        0.992793619632721,
                        0.7041893601417542,
                        0.7620751261711121,
                        0.782095730304718,
                        0.7799959778785706,
                        0.7990649342536926,
                        0.7526992559432983,
                        0.7747307419776917,
                        0.6431254148483276,
                        0.8665043115615845,
                        0.8038100004196167,
                        0.7381024956703186,
                        0.7208477854728699,
                        0.7714447379112244,
                        0.7537015080451965,
                        0.7198518514633179,
                        0.5679341554641724,
                        0.5554054379463196,
                        0.6443814635276794,
                        0.9831322431564331,
                        0.9026694297790527,
                        0.9934343695640564,
                        0.8896649479866028,
                        0.8857255578041077,
                        0.8841903805732727,
                        0.8886309266090393,
                        0.888148844242096,
                        0.8933442831039429,
                        0.8919169306755066,
                        0.894016683101654,
                        0.8940039873123169,
                        0.888472318649292,
                        0.7775853872299194,
                        0.8829724192619324,
                        0.8875271081924438,
                        0.89060378074646,
                        0.7830345630645752,
                        0.7763293385505676,
                        0.8299394845962524,
                        0.9965680837631226,
                        0.5776652693748474
                    ]
                },
                "val": {
                    "score": -5.192008005338724,
                    "pretrain_loss": 0.9088272750377655,
                    "pretrain_component": 0.41499000787734985,
                    "supervised_component": 0.49383726716041565,
                    "features_accuracy": [
                        0.5929926037788391,
                        0.7251293063163757,
                        0.7645776271820068,
                        0.8100091218948364,
                        0.8575195074081421,
                        0.792718768119812,
                        0.7665550708770752,
                        0.81031334400177,
                        0.8652773499488831,
                        0.7889665961265564,
                        0.9919379353523254,
                        0.706013560295105,
                        0.7598113417625427,
                        0.7846567034721375,
                        0.7826792001724243,
                        0.7949497699737549,
                        0.750380277633667,
                        0.7780650854110718,
                        0.6348240375518799,
                        0.8652266263961792,
                        0.8023020029067993,
                        0.738515317440033,
                        0.7162052392959595,
                        0.7699016332626343,
                        0.7533211708068848,
                        0.7177770733833313,
                        0.569972574710846,
                        0.5593246221542358,
                        0.6438494920730591,
                        0.9836223125457764,
                        0.906297504901886,
                        0.992343544960022,
                        0.8909339308738708,
                        0.8887536525726318,
                        0.8850014805793762,
                        0.8844437599182129,
                        0.8912382125854492,
                        0.8933677673339844,
                        0.8898184299468994,
                        0.8918973207473755,
                        0.8939762711524963,
                        0.8896156549453735,
                        0.7726903557777405,
                        0.8816042542457581,
                        0.8909339308738708,
                        0.8898184299468994,
                        0.7818172574043274,
                        0.7782171964645386,
                        0.8337389230728149,
                        0.9965013265609741,
                        0.5802149772644043
                    ]
                },
                "test": {
                    "score": -5.498789804177529,
                    "pretrain_loss": 0.9308883845806122,
                    "pretrain_component": 0.4149492084980011,
                    "supervised_component": 0.5159391760826111,
                    "features_accuracy": [
                        0.5867646932601929,
                        0.7222616672515869,
                        0.7642495036125183,
                        0.8005577921867371,
                        0.8592292070388794,
                        0.7929513454437256,
                        0.7651115655899048,
                        0.8135395646095276,
                        0.8685598373413086,
                        0.7922921180725098,
                        0.9931034445762634,
                        0.7021805047988892,
                        0.7619675397872925,
                        0.7888438105583191,
                        0.779462456703186,
                        0.7969067096710205,
                        0.7520791292190552,
                        0.7732758522033691,
                        0.6360040307044983,
                        0.8674949407577515,
                        0.7994421720504761,
                        0.7389959692955017,
                        0.7177484631538391,
                        0.7745943069458008,
                        0.7581136226654053,
                        0.7232251763343811,
                        0.5712981820106506,
                        0.5568965673446655,
                        0.6485294103622437,
                        0.983924925327301,
                        0.9014706015586853,
                        0.993864119052887,
                        0.8913792967796326,
                        0.8818965554237366,
                        0.8816937208175659,
                        0.8853955268859863,
                        0.8873732089996338,
                        0.8957403898239136,
                        0.8917343020439148,
                        0.8929005861282349,
                        0.8948783278465271,
                        0.8896551728248596,
                        0.7762170433998108,
                        0.8806288242340088,
                        0.8870689868927002,
                        0.8865111470222473,
                        0.7804766893386841,
                        0.7811866402626038,
                        0.8343306183815002,
                        0.997261643409729,
                        0.5761663317680359
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -3.7586679823718043,
                    "pretrain_loss": 0.8556343019008636,
                    "pretrain_component": 0.3603302836418152,
                    "supervised_component": 0.49530401825904846,
                    "features_accuracy": [
                        0.6578997373580933,
                        0.7240830659866333,
                        0.8441429138183594,
                        0.8698283433914185,
                        0.8847930431365967,
                        0.8750301599502563,
                        0.8291909694671631,
                        0.8607633113861084,
                        0.8790203332901001,
                        0.8707989454269409,
                        0.9926857948303223,
                        0.7391301989555359,
                        0.8195042014122009,
                        0.8701645731925964,
                        0.8484122157096863,
                        0.8612263798713684,
                        0.818235456943512,
                        0.817233145236969,
                        0.7008525729179382,
                        0.8893477916717529,
                        0.8640873432159424,
                        0.7695606350898743,
                        0.7464063167572021,
                        0.7959121465682983,
                        0.7808904051780701,
                        0.7591443657875061,
                        0.583247721195221,
                        0.5530646443367004,
                        0.6647635698318481,
                        0.9834240674972534,
                        0.908949613571167,
                        0.9925335645675659,
                        0.8947905898094177,
                        0.8896586298942566,
                        0.8881614804267883,
                        0.8971314430236816,
                        0.896554172039032,
                        0.8990471959114075,
                        0.8973217010498047,
                        0.8986031413078308,
                        0.898749053478241,
                        0.894156277179718,
                        0.8194534778594971,
                        0.8912445306777954,
                        0.8963067531585693,
                        0.8995927572250366,
                        0.8737043142318726,
                        0.8502011299133301,
                        0.8765462636947632,
                        0.9967837929725647,
                        0.5809639692306519
                    ]
                },
                "val": {
                    "score": -5.275124628198391,
                    "pretrain_loss": 0.8422602117061615,
                    "pretrain_component": 0.3605821430683136,
                    "supervised_component": 0.4816780686378479,
                    "features_accuracy": [
                        0.6654497385025024,
                        0.7247743606567383,
                        0.8482404947280884,
                        0.8720718026161194,
                        0.8850014805793762,
                        0.8781563639640808,
                        0.8312544226646423,
                        0.8621843457221985,
                        0.8762295842170715,
                        0.8676097393035889,
                        0.992343544960022,
                        0.74054354429245,
                        0.8175134062767029,
                        0.868928074836731,
                        0.8468207716941833,
                        0.859649121761322,
                        0.8119865655899048,
                        0.8199472427368164,
                        0.6966331601142883,
                        0.8883987069129944,
                        0.8661900162696838,
                        0.7689889073371887,
                        0.7415069341659546,
                        0.7935300469398499,
                        0.7795862555503845,
                        0.7573775053024292,
                        0.5803670883178711,
                        0.559273898601532,
                        0.662914514541626,
                        0.9840786457061768,
                        0.9092383980751038,
                        0.9914308786392212,
                        0.8956494927406311,
                        0.8920494914054871,
                        0.8909339308738708,
                        0.8935198783874512,
                        0.8991481065750122,
                        0.8994523882865906,
                        0.8959537148475647,
                        0.8967143297195435,
                        0.9002129435539246,
                        0.8943818807601929,
                        0.8167528510093689,
                        0.8898691534996033,
                        0.9002636671066284,
                        0.9001622200012207,
                        0.8728323578834534,
                        0.8496095538139343,
                        0.878004252910614,
                        0.9967548847198486,
                        0.5813812017440796
                    ]
                },
                "test": {
                    "score": -5.48187292894832,
                    "pretrain_loss": 0.8648138344287872,
                    "pretrain_component": 0.36078277230262756,
                    "supervised_component": 0.5040310621261597,
                    "features_accuracy": [
                        0.658316433429718,
                        0.7218052744865417,
                        0.8439655303955078,
                        0.8700811266899109,
                        0.8831642866134644,
                        0.875507116317749,
                        0.8281440138816833,
                        0.8594827651977539,
                        0.8784989714622498,
                        0.8750507235527039,
                        0.9931034445762634,
                        0.7341278195381165,
                        0.818965494632721,
                        0.8698275685310364,
                        0.8475659489631653,
                        0.8591784834861755,
                        0.8192697763442993,
                        0.8159229159355164,
                        0.6957403421401978,
                        0.8929005861282349,
                        0.8625760674476624,
                        0.7695740461349487,
                        0.7457910776138306,
                        0.8017241358757019,
                        0.782809317111969,
                        0.7594320774078369,
                        0.5812880396842957,
                        0.5568458437919617,
                        0.6692190766334534,
                        0.9843306541442871,
                        0.9053752422332764,
                        0.9933570027351379,
                        0.8961967825889587,
                        0.8856998085975647,
                        0.8865618705749512,
                        0.8929005861282349,
                        0.8952332735061646,
                        0.9020791053771973,
                        0.8968560099601746,
                        0.8967545628547668,
                        0.8998985886573792,
                        0.8948276042938232,
                        0.8168357014656067,
                        0.8886409997940063,
                        0.8946754336357117,
                        0.8944219350814819,
                        0.8761663436889648,
                        0.8529411554336548,
                        0.878346860408783,
                        0.9973630905151367,
                        0.5766734480857849
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -3.506117813258504,
                    "pretrain_loss": 0.8341507911682129,
                    "pretrain_component": 0.33961722254753113,
                    "supervised_component": 0.49453356862068176,
                    "features_accuracy": [
                        0.6912863850593567,
                        0.720460832118988,
                        0.8637511730194092,
                        0.8832261562347412,
                        0.8910161256790161,
                        0.889671266078949,
                        0.8568936586380005,
                        0.8806062340736389,
                        0.8865945935249329,
                        0.8832959532737732,
                        0.9936690330505371,
                        0.7478463649749756,
                        0.8464964032173157,
                        0.8821096420288086,
                        0.8714142441749573,
                        0.8939976692199707,
                        0.8452467322349548,
                        0.8498839139938354,
                        0.7179741263389587,
                        0.8993580341339111,
                        0.8896332383155823,
                        0.7760692238807678,
                        0.756606936454773,
                        0.8062840104103088,
                        0.7895685434341431,
                        0.7709054946899414,
                        0.6026402115821838,
                        0.552963137626648,
                        0.6700859069824219,
                        0.9840964674949646,
                        0.9130983948707581,
                        0.9928888082504272,
                        0.896547794342041,
                        0.8926401138305664,
                        0.8896142244338989,
                        0.8949111700057983,
                        0.8953108191490173,
                        0.9024727940559387,
                        0.9007536172866821,
                        0.9039444923400879,
                        0.9042173027992249,
                        0.8998084664344788,
                        0.8534110188484192,
                        0.8911493420600891,
                        0.898349404335022,
                        0.8993834257125854,
                        0.8880663514137268,
                        0.8680965304374695,
                        0.8907623887062073,
                        0.9964539408683777,
                        0.5861530900001526
                    ]
                },
                "val": {
                    "score": -5.253891776956468,
                    "pretrain_loss": 0.8167465031147003,
                    "pretrain_component": 0.33945319056510925,
                    "supervised_component": 0.47729331254959106,
                    "features_accuracy": [
                        0.6929824352264404,
                        0.7249264717102051,
                        0.8679646849632263,
                        0.884393036365509,
                        0.889362096786499,
                        0.8876888751983643,
                        0.8588885068893433,
                        0.8808436989784241,
                        0.8839874267578125,
                        0.8826183676719666,
                        0.9925463795661926,
                        0.751800000667572,
                        0.8463137149810791,
                        0.88221275806427,
                        0.8713111877441406,
                        0.8952438831329346,
                        0.8424601554870605,
                        0.852651834487915,
                        0.7176756858825684,
                        0.8972720503807068,
                        0.8939255475997925,
                        0.7753270268440247,
                        0.7529155015945435,
                        0.8039245009422302,
                        0.7880032062530518,
                        0.7704086303710938,
                        0.6019166111946106,
                        0.5590710639953613,
                        0.6672751307487488,
                        0.9840786457061768,
                        0.9149173498153687,
                        0.9919379353523254,
                        0.8982354402542114,
                        0.8956494927406311,
                        0.8920494914054871,
                        0.8939762711524963,
                        0.899908721446991,
                        0.9031538367271423,
                        0.89995938539505,
                        0.9004157781600952,
                        0.9050806164741516,
                        0.897880494594574,
                        0.8531588912010193,
                        0.8923537135124207,
                        0.8994016647338867,
                        0.8991481065750122,
                        0.8866240382194519,
                        0.871006965637207,
                        0.8927085995674133,
                        0.996552050113678,
                        0.5854882597923279
                    ]
                },
                "test": {
                    "score": -5.454634890573375,
                    "pretrain_loss": 0.8378088176250458,
                    "pretrain_component": 0.3398098647594452,
                    "supervised_component": 0.4979989528656006,
                    "features_accuracy": [
                        0.6904157996177673,
                        0.7213488817214966,
                        0.8644523620605469,
                        0.8822008371353149,
                        0.8878803253173828,
                        0.8898580074310303,
                        0.8590263724327087,
                        0.8772819638252258,
                        0.8847362995147705,
                        0.888336718082428,
                        0.9938133955001831,
                        0.7459431886672974,
                        0.8489857912063599,
                        0.8829107284545898,
                        0.8695740699768066,
                        0.8915314674377441,
                        0.8469573855400085,
                        0.8526369333267212,
                        0.7113590240478516,
                        0.9011663198471069,
                        0.8919878602027893,
                        0.7768255472183228,
                        0.7565416097640991,
                        0.8121196627616882,
                        0.7911764979362488,
                        0.7734786868095398,
                        0.6006592512130737,
                        0.5570994019508362,
                        0.6725659370422363,
                        0.9847870469093323,
                        0.9092799425125122,
                        0.9934077262878418,
                        0.8986815214157104,
                        0.8877789378166199,
                        0.8873732089996338,
                        0.8942697644233704,
                        0.8950304388999939,
                        0.9065923094749451,
                        0.8996957540512085,
                        0.9028397798538208,
                        0.9041582345962524,
                        0.8985294103622437,
                        0.853803277015686,
                        0.8909229040145874,
                        0.8956389427185059,
                        0.893306314945221,
                        0.8903144001960754,
                        0.8698782920837402,
                        0.8891480565071106,
                        0.9973123669624329,
                        0.5811359286308289
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -3.3685678908094183,
                    "pretrain_loss": 0.8083110451698303,
                    "pretrain_component": 0.32863107323646545,
                    "supervised_component": 0.47967997193336487,
                    "features_accuracy": [
                        0.7129689455032349,
                        0.7254152297973633,
                        0.8684073686599731,
                        0.8914411664009094,
                        0.8953805565834045,
                        0.8941308856010437,
                        0.8667833805084229,
                        0.8905974626541138,
                        0.894023060798645,
                        0.8887895345687866,
                        0.9934406876564026,
                        0.7585797905921936,
                        0.874408483505249,
                        0.8921009302139282,
                        0.8778403997421265,
                        0.9003539681434631,
                        0.8579339981079102,
                        0.8633515238761902,
                        0.732399582862854,
                        0.9040713906288147,
                        0.9029041528701782,
                        0.7913954854011536,
                        0.763210654258728,
                        0.8121201992034912,
                        0.7916556000709534,
                        0.7815501689910889,
                        0.6243038177490234,
                        0.5533120036125183,
                        0.6709359288215637,
                        0.9841028451919556,
                        0.9134472608566284,
                        0.9931742548942566,
                        0.8978736400604248,
                        0.8955835700035095,
                        0.8923229575157166,
                        0.8993644118309021,
                        0.8981781005859375,
                        0.9032974243164062,
                        0.9014894962310791,
                        0.9037414789199829,
                        0.9037478566169739,
                        0.8992882370948792,
                        0.8655844330787659,
                        0.8924117684364319,
                        0.8982669115066528,
                        0.9008170962333679,
                        0.8996181488037109,
                        0.8773011565208435,
                        0.8935155272483826,
                        0.9967710971832275,
                        0.599328875541687
                    ]
                },
                "val": {
                    "score": -5.239964593459414,
                    "pretrain_loss": 0.8039949834346771,
                    "pretrain_component": 0.32920587062835693,
                    "supervised_component": 0.4747891128063202,
                    "features_accuracy": [
                        0.7162559628486633,
                        0.7256363034248352,
                        0.8706013560295105,
                        0.8918973207473755,
                        0.8936213254928589,
                        0.8946861028671265,
                        0.8658857941627502,
                        0.8889057636260986,
                        0.8931142687797546,
                        0.8849508166313171,
                        0.9925463795661926,
                        0.7574282288551331,
                        0.8746070265769958,
                        0.8925058245658875,
                        0.8782577514648438,
                        0.9000608325004578,
                        0.8529560565948486,
                        0.8649224042892456,
                        0.7295913100242615,
                        0.9021904468536377,
                        0.9051820039749146,
                        0.7898285984992981,
                        0.7626001238822937,
                        0.8111246228218079,
                        0.797028660774231,
                        0.780701756477356,
                        0.6220971345901489,
                        0.5593246221542358,
                        0.6701145768165588,
                        0.9844843149185181,
                        0.9143595695495605,
                        0.9921407103538513,
                        0.9000101089477539,
                        0.8993002772331238,
                        0.8937227129936218,
                        0.8968157172203064,
                        0.9004664421081543,
                        0.9034073352813721,
                        0.9018355011940002,
                        0.9012270569801331,
                        0.9049285054206848,
                        0.8989959955215454,
                        0.8652773499488831,
                        0.8930128812789917,
                        0.9014298319816589,
                        0.9012777209281921,
                        0.8972213268280029,
                        0.8796774744987488,
                        0.8945847153663635,
                        0.9967548847198486,
                        0.6007503867149353
                    ]
                },
                "test": {
                    "score": -5.491399964314891,
                    "pretrain_loss": 0.82294100522995,
                    "pretrain_component": 0.3292883634567261,
                    "supervised_component": 0.4936526417732239,
                    "features_accuracy": [
                        0.709432065486908,
                        0.7224137783050537,
                        0.868864119052887,
                        0.8917343020439148,
                        0.8926470875740051,
                        0.8945740461349487,
                        0.8675963282585144,
                        0.8864097595214844,
                        0.8912779092788696,
                        0.8920385241508484,
                        0.9940162301063538,
                        0.7537525296211243,
                        0.8768762946128845,
                        0.89219069480896,
                        0.8759635090827942,
                        0.897718071937561,
                        0.8617140054702759,
                        0.8636409640312195,
                        0.7266227006912231,
                        0.9059330821037292,
                        0.9037018418312073,
                        0.7912778854370117,
                        0.7632859945297241,
                        0.8176977634429932,
                        0.7948275804519653,
                        0.7835192680358887,
                        0.6229208707809448,
                        0.5568965673446655,
                        0.6758113503456116,
                        0.9856491088867188,
                        0.9111054539680481,
                        0.9936612844467163,
                        0.8998985886573792,
                        0.8915821313858032,
                        0.8907707929611206,
                        0.8969066739082336,
                        0.8964502811431885,
                        0.9065923094749451,
                        0.9014706015586853,
                        0.9023833870887756,
                        0.9043610692024231,
                        0.8987322449684143,
                        0.8659229278564453,
                        0.8916835784912109,
                        0.8969066739082336,
                        0.8952839970588684,
                        0.9027890563011169,
                        0.8771805167198181,
                        0.8937119841575623,
                        0.9975659251213074,
                        0.5959939360618591
                    ]
                }
            }
        },
        "train": {
            "score": -3.1358029070347437
        },
        "val": {
            "score": -5.192008005338724
        },
        "test": {
            "score": -5.498789804177529
        }
    },
    "best_iteration": 10000,
    "time": "0:34:15"
}
