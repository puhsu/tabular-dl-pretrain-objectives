{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised___a8e00fb0e44b4b37a1a0be0093971958.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 7,
        "data": {
            "path": "data/churn_roc",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512,
                    512,
                    512,
                    512,
                    512,
                    512,
                    512,
                    512
                ],
                "dropout": 0.3668922166341568
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear",
                "relu"
            ],
            "d_num_embedding": 6,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.002771371852630896,
            "weight_decay": 2.893355916008854e-05,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.39242912213579284,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.002771371852630896,
            "weight_decay": 2.893355916008854e-05,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post",
            "supervised_weight": 0.5
        },
        "bins": {
            "count": 225,
            "value": "ratio",
            "tree": {
                "min_samples_leaf": 73,
                "min_impurity_decrease": 0.00022407828442769852
            },
            "subsample": null
        }
    },
    "epoch_size": 50,
    "n_parameters": 2140772,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": 0.8741265102666833,
                    "pretrain_loss": 1.0473862290382385,
                    "pretrain_component": 0.5871344208717346,
                    "supervised_component": 0.4602518081665039,
                    "features_accuracy": [
                        0.602343738079071,
                        0.8101562261581421,
                        0.6235937476158142,
                        0.6399999856948853,
                        0.6618750095367432,
                        0.7973437309265137,
                        0.5956249833106995,
                        0.8401562571525574,
                        0.7999999523162842,
                        0.6009374856948853,
                        0.7524999976158142
                    ]
                },
                "val": {
                    "score": 0.8665162620026774,
                    "pretrain_loss": 1.0444166958332062,
                    "pretrain_component": 0.5860275626182556,
                    "supervised_component": 0.45838913321495056,
                    "features_accuracy": [
                        0.6068750023841858,
                        0.8199999928474426,
                        0.6293749809265137,
                        0.6499999761581421,
                        0.6399999856948853,
                        0.7899999618530273,
                        0.6006249785423279,
                        0.8474999666213989,
                        0.7993749976158142,
                        0.5987499952316284,
                        0.7512499690055847
                    ]
                },
                "test": {
                    "score": 0.8591858422366897,
                    "pretrain_loss": 1.039331167936325,
                    "pretrain_component": 0.5863825082778931,
                    "supervised_component": 0.452948659658432,
                    "features_accuracy": [
                        0.5950000286102295,
                        0.8075000643730164,
                        0.5950000286102295,
                        0.6325000524520874,
                        0.6695000529289246,
                        0.7920000553131104,
                        0.6135000586509705,
                        0.8480000495910645,
                        0.8030000329017639,
                        0.6145000457763672,
                        0.7575000524520874
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": 0.878985216963142,
                    "pretrain_loss": 1.037595808506012,
                    "pretrain_component": 0.589813768863678,
                    "supervised_component": 0.447782039642334,
                    "features_accuracy": [
                        0.6081249713897705,
                        0.8056249618530273,
                        0.6103124618530273,
                        0.6417187452316284,
                        0.6653124690055847,
                        0.789843738079071,
                        0.6107812523841858,
                        0.8231250047683716,
                        0.8039062023162842,
                        0.6107812523841858,
                        0.7498437166213989
                    ]
                },
                "val": {
                    "score": 0.8743643516868758,
                    "pretrain_loss": 1.0347912013530731,
                    "pretrain_component": 0.5859057903289795,
                    "supervised_component": 0.44888541102409363,
                    "features_accuracy": [
                        0.6068750023841858,
                        0.8199999928474426,
                        0.6293749809265137,
                        0.6499999761581421,
                        0.6399999856948853,
                        0.7899999618530273,
                        0.6006249785423279,
                        0.8474999666213989,
                        0.7993749976158142,
                        0.5987499952316284,
                        0.7512499690055847
                    ]
                },
                "test": {
                    "score": 0.8647923732669496,
                    "pretrain_loss": 1.0274721086025238,
                    "pretrain_component": 0.586017906665802,
                    "supervised_component": 0.4414542019367218,
                    "features_accuracy": [
                        0.5950000286102295,
                        0.8075000643730164,
                        0.5950000286102295,
                        0.6325000524520874,
                        0.6695000529289246,
                        0.7920000553131104,
                        0.6135000586509705,
                        0.8480000495910645,
                        0.8030000329017639,
                        0.6145000457763672,
                        0.7575000524520874
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": 0.8729874898874131,
                    "pretrain_loss": 1.036356121301651,
                    "pretrain_component": 0.5867776274681091,
                    "supervised_component": 0.44957849383354187,
                    "features_accuracy": [
                        0.6209374666213989,
                        0.8079687356948853,
                        0.617968738079071,
                        0.6457812190055847,
                        0.6543749570846558,
                        0.7871874570846558,
                        0.6104687452316284,
                        0.8432812094688416,
                        0.8009374737739563,
                        0.60546875,
                        0.749218761920929
                    ]
                },
                "val": {
                    "score": 0.8699738035846711,
                    "pretrain_loss": 1.0321069359779358,
                    "pretrain_component": 0.5855397582054138,
                    "supervised_component": 0.446567177772522,
                    "features_accuracy": [
                        0.6068750023841858,
                        0.8199999928474426,
                        0.6293749809265137,
                        0.6499999761581421,
                        0.6399999856948853,
                        0.7899999618530273,
                        0.6006249785423279,
                        0.8474999666213989,
                        0.7993749976158142,
                        0.5987499952316284,
                        0.7512499690055847
                    ]
                },
                "test": {
                    "score": 0.8598128174399361,
                    "pretrain_loss": 1.028791457414627,
                    "pretrain_component": 0.5855511426925659,
                    "supervised_component": 0.44324031472206116,
                    "features_accuracy": [
                        0.5950000286102295,
                        0.8075000643730164,
                        0.5950000286102295,
                        0.6325000524520874,
                        0.6695000529289246,
                        0.7920000553131104,
                        0.6135000586509705,
                        0.8480000495910645,
                        0.8030000329017639,
                        0.6145000457763672,
                        0.7575000524520874
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": 0.8692422211333801,
                    "pretrain_loss": 1.0423459708690643,
                    "pretrain_component": 0.5856384038925171,
                    "supervised_component": 0.45670756697654724,
                    "features_accuracy": [
                        0.6154687404632568,
                        0.8032812476158142,
                        0.6182812452316284,
                        0.6490625143051147,
                        0.6589062213897705,
                        0.7959374785423279,
                        0.6057812571525574,
                        0.8385937213897705,
                        0.80140620470047,
                        0.6115624904632568,
                        0.7523437142372131
                    ]
                },
                "val": {
                    "score": 0.8736492473346111,
                    "pretrain_loss": 1.036824345588684,
                    "pretrain_component": 0.5847973823547363,
                    "supervised_component": 0.45202696323394775,
                    "features_accuracy": [
                        0.6068750023841858,
                        0.8199999928474426,
                        0.6293749809265137,
                        0.6499999761581421,
                        0.6399999856948853,
                        0.7899999618530273,
                        0.6006249785423279,
                        0.8474999666213989,
                        0.7993749976158142,
                        0.5987499952316284,
                        0.7512499690055847
                    ]
                },
                "test": {
                    "score": 0.8536093875076927,
                    "pretrain_loss": 1.0270877480506897,
                    "pretrain_component": 0.5847465395927429,
                    "supervised_component": 0.4423412084579468,
                    "features_accuracy": [
                        0.5950000286102295,
                        0.8075000643730164,
                        0.5950000286102295,
                        0.6325000524520874,
                        0.6695000529289246,
                        0.7920000553131104,
                        0.6135000586509705,
                        0.8480000495910645,
                        0.8030000329017639,
                        0.6145000457763672,
                        0.7575000524520874
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": 0.8697329524660264,
                    "pretrain_loss": 1.0386487543582916,
                    "pretrain_component": 0.5866227746009827,
                    "supervised_component": 0.45202597975730896,
                    "features_accuracy": [
                        0.6134374737739563,
                        0.8076562285423279,
                        0.6267187595367432,
                        0.640625,
                        0.6610937118530273,
                        0.7932812571525574,
                        0.6079687476158142,
                        0.8403124809265137,
                        0.8034374713897705,
                        0.6217187643051147,
                        0.7412499785423279
                    ]
                },
                "val": {
                    "score": 0.8633500592308655,
                    "pretrain_loss": 1.0336776077747345,
                    "pretrain_component": 0.5859327912330627,
                    "supervised_component": 0.44774481654167175,
                    "features_accuracy": [
                        0.6068750023841858,
                        0.8199999928474426,
                        0.6293749809265137,
                        0.6499999761581421,
                        0.6399999856948853,
                        0.7899999618530273,
                        0.6006249785423279,
                        0.8474999666213989,
                        0.7993749976158142,
                        0.5987499952316284,
                        0.7512499690055847
                    ]
                },
                "test": {
                    "score": 0.8524942507993355,
                    "pretrain_loss": 1.0313506126403809,
                    "pretrain_component": 0.5860009789466858,
                    "supervised_component": 0.44534963369369507,
                    "features_accuracy": [
                        0.5950000286102295,
                        0.8075000643730164,
                        0.5950000286102295,
                        0.6325000524520874,
                        0.6695000529289246,
                        0.7920000553131104,
                        0.6135000586509705,
                        0.8480000495910645,
                        0.8030000329017639,
                        0.6145000457763672,
                        0.7575000524520874
                    ]
                }
            }
        },
        "train": {
            "score": 0.878985216963142
        },
        "val": {
            "score": 0.8743643516868758
        },
        "test": {
            "score": 0.8647923732669496
        }
    },
    "best_iteration": 20000,
    "time": "0:07:40"
}
