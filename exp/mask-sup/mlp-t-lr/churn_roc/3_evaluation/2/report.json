{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised___a8e00fb0e44b4b37a1a0be0093971958.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 2,
        "data": {
            "path": "data/churn_roc",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512,
                    512,
                    512,
                    512,
                    512,
                    512,
                    512,
                    512
                ],
                "dropout": 0.3668922166341568
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear",
                "relu"
            ],
            "d_num_embedding": 6,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.002771371852630896,
            "weight_decay": 2.893355916008854e-05,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.39242912213579284,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.002771371852630896,
            "weight_decay": 2.893355916008854e-05,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post",
            "supervised_weight": 0.5
        },
        "bins": {
            "count": 225,
            "value": "ratio",
            "tree": {
                "min_samples_leaf": 73,
                "min_impurity_decrease": 0.00022407828442769852
            },
            "subsample": null
        }
    },
    "epoch_size": 50,
    "n_parameters": 2140772,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": 0.8734323985611233,
                    "pretrain_loss": 1.0414776504039764,
                    "pretrain_component": 0.5883775949478149,
                    "supervised_component": 0.4531000554561615,
                    "features_accuracy": [
                        0.6196874976158142,
                        0.7985937595367432,
                        0.6273437142372131,
                        0.6467187404632568,
                        0.6628124713897705,
                        0.7892187237739563,
                        0.6042187213897705,
                        0.8323437571525574,
                        0.8056249618530273,
                        0.6092187166213989,
                        0.7526562213897705
                    ]
                },
                "val": {
                    "score": 0.8656843813504638,
                    "pretrain_loss": 1.0247405767440796,
                    "pretrain_component": 0.5808688998222351,
                    "supervised_component": 0.4438716769218445,
                    "features_accuracy": [
                        0.6131249666213989,
                        0.7949999570846558,
                        0.6412500143051147,
                        0.6543749570846558,
                        0.6731249690055847,
                        0.8112499713897705,
                        0.6262499690055847,
                        0.8381249904632568,
                        0.8137499690055847,
                        0.6274999976158142,
                        0.7574999928474426
                    ]
                },
                "test": {
                    "score": 0.8580444851631293,
                    "pretrain_loss": 1.0478720664978027,
                    "pretrain_component": 0.5879345536231995,
                    "supervised_component": 0.45993751287460327,
                    "features_accuracy": [
                        0.6140000224113464,
                        0.8060000538825989,
                        0.6150000095367432,
                        0.6465000510215759,
                        0.6585000157356262,
                        0.8010000586509705,
                        0.6055000424385071,
                        0.8200000524520874,
                        0.8005000352859497,
                        0.6230000257492065,
                        0.7605000138282776
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": 0.8699099979774826,
                    "pretrain_loss": 1.0440991520881653,
                    "pretrain_component": 0.5862703323364258,
                    "supervised_component": 0.4578288197517395,
                    "features_accuracy": [
                        0.6171875,
                        0.8065624833106995,
                        0.6098437309265137,
                        0.6482812166213989,
                        0.6549999713897705,
                        0.7987499833106995,
                        0.6078124642372131,
                        0.8374999761581421,
                        0.8067187070846558,
                        0.5992187261581421,
                        0.7526562213897705
                    ]
                },
                "val": {
                    "score": 0.8680572276102513,
                    "pretrain_loss": 1.0313639044761658,
                    "pretrain_component": 0.5803002715110779,
                    "supervised_component": 0.4510636329650879,
                    "features_accuracy": [
                        0.6131249666213989,
                        0.7949999570846558,
                        0.6412500143051147,
                        0.6543749570846558,
                        0.6731249690055847,
                        0.8112499713897705,
                        0.6262499690055847,
                        0.8381249904632568,
                        0.8137499690055847,
                        0.6274999976158142,
                        0.7574999928474426
                    ]
                },
                "test": {
                    "score": 0.8571352554403402,
                    "pretrain_loss": 1.0546620786190033,
                    "pretrain_component": 0.5874525904655457,
                    "supervised_component": 0.46720948815345764,
                    "features_accuracy": [
                        0.6140000224113464,
                        0.8060000538825989,
                        0.6150000095367432,
                        0.6465000510215759,
                        0.6585000157356262,
                        0.8010000586509705,
                        0.6055000424385071,
                        0.8200000524520874,
                        0.8005000352859497,
                        0.6230000257492065,
                        0.7605000138282776
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": 0.8706649808342404,
                    "pretrain_loss": 1.0449691116809845,
                    "pretrain_component": 0.5900642275810242,
                    "supervised_component": 0.4549048840999603,
                    "features_accuracy": [
                        0.6120312213897705,
                        0.8032812476158142,
                        0.6167187094688416,
                        0.6448437571525574,
                        0.6503124833106995,
                        0.7907812595367432,
                        0.6059374809265137,
                        0.8392187356948853,
                        0.7940624952316284,
                        0.6129687428474426,
                        0.7431249618530273
                    ]
                },
                "val": {
                    "score": 0.8578916701177876,
                    "pretrain_loss": 1.0303997099399567,
                    "pretrain_component": 0.5803772807121277,
                    "supervised_component": 0.450022429227829,
                    "features_accuracy": [
                        0.6131249666213989,
                        0.7949999570846558,
                        0.6412500143051147,
                        0.6543749570846558,
                        0.6731249690055847,
                        0.8112499713897705,
                        0.6262499690055847,
                        0.8381249904632568,
                        0.8137499690055847,
                        0.6274999976158142,
                        0.7574999928474426
                    ]
                },
                "test": {
                    "score": 0.8575023405531881,
                    "pretrain_loss": 1.0517933368682861,
                    "pretrain_component": 0.5876588821411133,
                    "supervised_component": 0.46413445472717285,
                    "features_accuracy": [
                        0.6140000224113464,
                        0.8060000538825989,
                        0.6150000095367432,
                        0.6465000510215759,
                        0.6585000157356262,
                        0.8010000586509705,
                        0.6055000424385071,
                        0.8200000524520874,
                        0.8005000352859497,
                        0.6230000257492065,
                        0.7605000138282776
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": 0.8648283478681704,
                    "pretrain_loss": 1.0442754328250885,
                    "pretrain_component": 0.5856516361236572,
                    "supervised_component": 0.4586237967014313,
                    "features_accuracy": [
                        0.6114062070846558,
                        0.8070312142372131,
                        0.6137499809265137,
                        0.6535937190055847,
                        0.6567187309265137,
                        0.7939062118530273,
                        0.6010937094688416,
                        0.8312499523162842,
                        0.8182812333106995,
                        0.6014062166213989,
                        0.7479687333106995
                    ]
                },
                "val": {
                    "score": 0.8614659879997303,
                    "pretrain_loss": 1.0328823924064636,
                    "pretrain_component": 0.5787648558616638,
                    "supervised_component": 0.4541175365447998,
                    "features_accuracy": [
                        0.6131249666213989,
                        0.7949999570846558,
                        0.6412500143051147,
                        0.6543749570846558,
                        0.6731249690055847,
                        0.8112499713897705,
                        0.6262499690055847,
                        0.8381249904632568,
                        0.8137499690055847,
                        0.6274999976158142,
                        0.7574999928474426
                    ]
                },
                "test": {
                    "score": 0.8544507527558375,
                    "pretrain_loss": 1.0538086891174316,
                    "pretrain_component": 0.5863360166549683,
                    "supervised_component": 0.4674726724624634,
                    "features_accuracy": [
                        0.6140000224113464,
                        0.8060000538825989,
                        0.6150000095367432,
                        0.6465000510215759,
                        0.6585000157356262,
                        0.8010000586509705,
                        0.6055000424385071,
                        0.8200000524520874,
                        0.8005000352859497,
                        0.6230000257492065,
                        0.7605000138282776
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": 0.8530737448353575,
                    "pretrain_loss": 1.0454511940479279,
                    "pretrain_component": 0.5863274335861206,
                    "supervised_component": 0.45912376046180725,
                    "features_accuracy": [
                        0.6156249642372131,
                        0.8139062523841858,
                        0.6264062523841858,
                        0.649218738079071,
                        0.6501562595367432,
                        0.7917187213897705,
                        0.6082812547683716,
                        0.8353124856948853,
                        0.7964062094688416,
                        0.6071875095367432,
                        0.7654687166213989
                    ]
                },
                "val": {
                    "score": 0.8473805992430006,
                    "pretrain_loss": 1.036663144826889,
                    "pretrain_component": 0.5811102390289307,
                    "supervised_component": 0.4555529057979584,
                    "features_accuracy": [
                        0.6131249666213989,
                        0.7949999570846558,
                        0.6412500143051147,
                        0.6543749570846558,
                        0.6731249690055847,
                        0.8112499713897705,
                        0.6262499690055847,
                        0.8381249904632568,
                        0.8137499690055847,
                        0.6274999976158142,
                        0.7574999928474426
                    ]
                },
                "test": {
                    "score": 0.837487718843651,
                    "pretrain_loss": 1.0547396838665009,
                    "pretrain_component": 0.5881889462471008,
                    "supervised_component": 0.4665507376194,
                    "features_accuracy": [
                        0.6140000224113464,
                        0.8060000538825989,
                        0.6150000095367432,
                        0.6465000510215759,
                        0.6585000157356262,
                        0.8010000586509705,
                        0.6055000424385071,
                        0.8200000524520874,
                        0.8005000352859497,
                        0.6230000257492065,
                        0.7605000138282776
                    ]
                }
            }
        },
        "train": {
            "score": 0.8699099979774826
        },
        "val": {
            "score": 0.8680572276102513
        },
        "test": {
            "score": 0.8571352554403402
        }
    },
    "best_iteration": 20000,
    "time": "0:07:54"
}
