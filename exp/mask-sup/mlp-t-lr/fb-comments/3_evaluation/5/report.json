{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised_fast___51a733cbc92d473280573f78151386ab.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0,1",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                },
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 5,
        "data": {
            "path": "data/fb-comments",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512
                ],
                "dropout": 0.2888693523114936
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear",
                "relu"
            ],
            "d_num_embedding": 119,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 512,
            "lr": 6.783213831164318e-05,
            "weight_decay": 8.11888266863989e-06,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 1024
        },
        "pretrain": {
            "corrupt_probability": 0.6419817966690281,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 6.783213831164318e-05,
            "weight_decay": 8.11888266863989e-06,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post"
        },
        "bins": {
            "count": 230,
            "value": "ratio",
            "tree": {
                "min_samples_leaf": 117,
                "min_impurity_decrease": 1.2301905954129383e-05
            },
            "subsample": null
        }
    },
    "n_parameters": 4680766,
    "epoch_size": 308,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -3.5183792490465122,
                    "pretrain_loss": 1.1611095368862152,
                    "pretrain_component": 0.46922042965888977,
                    "supervised_component": 0.6918891072273254,
                    "features_accuracy": [
                        0.6379489898681641,
                        0.7163691520690918,
                        0.6647128462791443,
                        0.6881335973739624,
                        0.7240639925003052,
                        0.6797155737876892,
                        0.6512706279754639,
                        0.6799122095108032,
                        0.7482206225395203,
                        0.6893071532249451,
                        0.9904084205627441,
                        0.6467602849006653,
                        0.6661592125892639,
                        0.6983976364135742,
                        0.6892183423042297,
                        0.6798107028007507,
                        0.6640530824661255,
                        0.6630571484565735,
                        0.6433918476104736,
                        0.7684695720672607,
                        0.6842005252838135,
                        0.6693056225776672,
                        0.6695530414581299,
                        0.6787766814231873,
                        0.6626321077346802,
                        0.6436645984649658,
                        0.6329501867294312,
                        0.6318463683128357,
                        0.6367563605308533,
                        0.9767188429832458,
                        0.8672972321510315,
                        0.9904465079307556,
                        0.8434134125709534,
                        0.8401845097541809,
                        0.8347479701042175,
                        0.8416371941566467,
                        0.8448153734207153,
                        0.8512477874755859,
                        0.8551808595657349,
                        0.8610297441482544,
                        0.8606047034263611,
                        0.8463568687438965,
                        0.6595554351806641,
                        0.8404826521873474,
                        0.8443713188171387,
                        0.851799726486206,
                        0.6876641511917114,
                        0.683762788772583,
                        0.6767848134040833,
                        0.995274007320404,
                        0.59992516040802
                    ]
                },
                "val": {
                    "score": -5.23297331684193,
                    "pretrain_loss": 1.1272332072257996,
                    "pretrain_component": 0.4690450429916382,
                    "supervised_component": 0.6581881642341614,
                    "features_accuracy": [
                        0.6358888149261475,
                        0.718639075756073,
                        0.6734104156494141,
                        0.6888246536254883,
                        0.7213771343231201,
                        0.6779738068580627,
                        0.646739661693573,
                        0.674170970916748,
                        0.7520534992218018,
                        0.6896359324455261,
                        0.9899097084999084,
                        0.6443565487861633,
                        0.6677314639091492,
                        0.6928810477256775,
                        0.6934387683868408,
                        0.6817259788513184,
                        0.6645370721817017,
                        0.6653483510017395,
                        0.6408579349517822,
                        0.7657945156097412,
                        0.6869992613792419,
                        0.6702159643173218,
                        0.6718892455101013,
                        0.6793935298919678,
                        0.660784900188446,
                        0.6439002156257629,
                        0.6360409259796143,
                        0.6303620338439941,
                        0.6350268721580505,
                        0.9758644700050354,
                        0.8675590753555298,
                        0.9890984296798706,
                        0.8483926057815552,
                        0.8437784910202026,
                        0.8375925421714783,
                        0.8415982127189636,
                        0.8455024361610413,
                        0.8506743311882019,
                        0.8587363958358765,
                        0.8578744530677795,
                        0.8579758405685425,
                        0.844843327999115,
                        0.6589595079421997,
                        0.8416488766670227,
                        0.8493053317070007,
                        0.8528546690940857,
                        0.6898387670516968,
                        0.6808133125305176,
                        0.6794949769973755,
                        0.9946252703666687,
                        0.5973024964332581
                    ]
                },
                "test": {
                    "score": -5.498837177171654,
                    "pretrain_loss": 1.1495217382907867,
                    "pretrain_component": 0.46882328391075134,
                    "supervised_component": 0.6806984543800354,
                    "features_accuracy": [
                        0.6414807438850403,
                        0.7163792848587036,
                        0.6594827771186829,
                        0.6873224973678589,
                        0.7214503288269043,
                        0.6793610453605652,
                        0.643306314945221,
                        0.6820994019508362,
                        0.7434584498405457,
                        0.6896551847457886,
                        0.9914807081222534,
                        0.6454361081123352,
                        0.657200813293457,
                        0.6992393732070923,
                        0.6856490969657898,
                        0.6774848103523254,
                        0.6680020093917847,
                        0.6581643223762512,
                        0.6416328549385071,
                        0.7691176533699036,
                        0.6864604353904724,
                        0.6681034564971924,
                        0.6634888648986816,
                        0.6860040426254272,
                        0.657200813293457,
                        0.6421399712562561,
                        0.6365618705749512,
                        0.6327078938484192,
                        0.6346855759620667,
                        0.9778397679328918,
                        0.8672921061515808,
                        0.9899594187736511,
                        0.8454868197441101,
                        0.8392494916915894,
                        0.8354969620704651,
                        0.8433570265769958,
                        0.8495942950248718,
                        0.8529411554336548,
                        0.8597363233566284,
                        0.862778902053833,
                        0.8628296256065369,
                        0.8453347086906433,
                        0.6596856117248535,
                        0.8379817605018616,
                        0.8454868197441101,
                        0.8459939360618591,
                        0.6879310607910156,
                        0.6797160506248474,
                        0.6807302236557007,
                        0.9955882430076599,
                        0.602281928062439
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -3.50684166142698,
                    "pretrain_loss": 1.0963448286056519,
                    "pretrain_component": 0.4300330877304077,
                    "supervised_component": 0.6663117408752441,
                    "features_accuracy": [
                        0.6413745284080505,
                        0.7339854836463928,
                        0.7058640718460083,
                        0.7647648453712463,
                        0.7952841520309448,
                        0.7691736817359924,
                        0.7335477471351624,
                        0.7479161024093628,
                        0.8064553141593933,
                        0.7769066095352173,
                        0.9910364747047424,
                        0.6734163165092468,
                        0.7224336862564087,
                        0.7557505369186401,
                        0.7539997100830078,
                        0.7433233261108398,
                        0.6929420828819275,
                        0.7160392999649048,
                        0.6616171598434448,
                        0.8108260631561279,
                        0.7642573714256287,
                        0.6812951564788818,
                        0.680571973323822,
                        0.6980170011520386,
                        0.6822783946990967,
                        0.6802484393119812,
                        0.6329057812690735,
                        0.632601261138916,
                        0.6437978148460388,
                        0.9790659546852112,
                        0.8777769207954407,
                        0.9913409352302551,
                        0.8627424836158752,
                        0.858390748500824,
                        0.8489387035369873,
                        0.8601986765861511,
                        0.8563544750213623,
                        0.8674114346504211,
                        0.8655717968940735,
                        0.8705134987831116,
                        0.8702660799026489,
                        0.8614040017127991,
                        0.7232393622398376,
                        0.8518694639205933,
                        0.8604587912559509,
                        0.8642078638076782,
                        0.7479224801063538,
                        0.7396693825721741,
                        0.7737284302711487,
                        0.9953691363334656,
                        0.6000773906707764
                    ]
                },
                "val": {
                    "score": -5.25540264793509,
                    "pretrain_loss": 1.0773696601390839,
                    "pretrain_component": 0.43061932921409607,
                    "supervised_component": 0.6467503309249878,
                    "features_accuracy": [
                        0.6394381523132324,
                        0.7333434820175171,
                        0.7096136212348938,
                        0.763157844543457,
                        0.7934286594390869,
                        0.7733495235443115,
                        0.7291856408119202,
                        0.745411217212677,
                        0.805445671081543,
                        0.7811580896377563,
                        0.9903153777122498,
                        0.6684412956237793,
                        0.7218334674835205,
                        0.7494168877601624,
                        0.7588986754417419,
                        0.7423689365386963,
                        0.6895344853401184,
                        0.714430570602417,
                        0.657336950302124,
                        0.8081330060958862,
                        0.762346625328064,
                        0.6794442534446716,
                        0.6786836981773376,
                        0.6983571648597717,
                        0.679900586605072,
                        0.6809654235839844,
                        0.636142373085022,
                        0.6303620338439941,
                        0.6422776579856873,
                        0.9796673655509949,
                        0.8772436380386353,
                        0.9902646541595459,
                        0.8661900162696838,
                        0.8616772890090942,
                        0.8496602773666382,
                        0.8637561798095703,
                        0.8563532829284668,
                        0.8656322360038757,
                        0.8703985214233398,
                        0.8684210181236267,
                        0.8687252402305603,
                        0.8572152853012085,
                        0.7214785218238831,
                        0.8532096147537231,
                        0.8625392913818359,
                        0.863959014415741,
                        0.750380277633667,
                        0.7417604327201843,
                        0.7674170732498169,
                        0.9943717122077942,
                        0.5990771651268005
                    ]
                },
                "test": {
                    "score": -5.493394143475016,
                    "pretrain_loss": 1.1022760570049286,
                    "pretrain_component": 0.430513471364975,
                    "supervised_component": 0.6717625856399536,
                    "features_accuracy": [
                        0.6454868316650391,
                        0.7296146154403687,
                        0.7005071043968201,
                        0.7601419687271118,
                        0.790517270565033,
                        0.7674949169158936,
                        0.7235801219940186,
                        0.7485294342041016,
                        0.8059837818145752,
                        0.7840771079063416,
                        0.9927992224693298,
                        0.6735293865203857,
                        0.7152130007743835,
                        0.7552231550216675,
                        0.7524847984313965,
                        0.7391988039016724,
                        0.6929513216018677,
                        0.7115618586540222,
                        0.6588742136955261,
                        0.8129817247390747,
                        0.7602434158325195,
                        0.6803245544433594,
                        0.6717545390129089,
                        0.7001014351844788,
                        0.6808316707611084,
                        0.6757606267929077,
                        0.6366633176803589,
                        0.6327078938484192,
                        0.642241358757019,
                        0.9807302355766296,
                        0.8789046406745911,
                        0.9903650879859924,
                        0.8636916875839233,
                        0.8604462742805481,
                        0.8501014113426208,
                        0.8590263724327087,
                        0.8614097237586975,
                        0.8678498864173889,
                        0.8691176772117615,
                        0.8717038631439209,
                        0.8704361319541931,
                        0.8614604473114014,
                        0.7219573855400085,
                        0.8513692021369934,
                        0.8610040545463562,
                        0.8602434396743774,
                        0.7474138140678406,
                        0.7323022484779358,
                        0.772210955619812,
                        0.995537519454956,
                        0.6042596101760864
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -3.6109049649518807,
                    "pretrain_loss": 1.0763794779777527,
                    "pretrain_component": 0.4124886393547058,
                    "supervised_component": 0.6638908386230469,
                    "features_accuracy": [
                        0.6566436886787415,
                        0.7523503303527832,
                        0.7550527453422546,
                        0.7931082844734192,
                        0.8211662173271179,
                        0.7913700938224792,
                        0.7699856758117676,
                        0.781493067741394,
                        0.8269643187522888,
                        0.7977327704429626,
                        0.9920260310173035,
                        0.6743805408477783,
                        0.7695797085762024,
                        0.7904502749443054,
                        0.76461261510849,
                        0.7899237871170044,
                        0.7267917990684509,
                        0.7613202333450317,
                        0.6641926765441895,
                        0.8306499719619751,
                        0.7970540523529053,
                        0.6873787045478821,
                        0.6787893772125244,
                        0.7070884108543396,
                        0.6970400810241699,
                        0.6839404106140137,
                        0.6347517967224121,
                        0.632810652256012,
                        0.6478514075279236,
                        0.9804108142852783,
                        0.8832071423530579,
                        0.9919245839118958,
                        0.8671132922172546,
                        0.8600908517837524,
                        0.8543498516082764,
                        0.8635037541389465,
                        0.8621271848678589,
                        0.8689656257629395,
                        0.8669165968894958,
                        0.8729748129844666,
                        0.8724482655525208,
                        0.8625014424324036,
                        0.7630394101142883,
                        0.8513175845146179,
                        0.8604397773742676,
                        0.865197479724884,
                        0.7718443870544434,
                        0.7736967206001282,
                        0.8039115071296692,
                        0.9952549934387207,
                        0.6142871975898743
                    ]
                },
                "val": {
                    "score": -5.295725496682564,
                    "pretrain_loss": 1.0465421974658966,
                    "pretrain_component": 0.4126124680042267,
                    "supervised_component": 0.6339297294616699,
                    "features_accuracy": [
                        0.6529256701469421,
                        0.7512422204017639,
                        0.7587465643882751,
                        0.792820155620575,
                        0.8215190768241882,
                        0.7933779358863831,
                        0.7658452391624451,
                        0.7770509719848633,
                        0.8255754709243774,
                        0.8021498322486877,
                        0.9914308786392212,
                        0.6707737445831299,
                        0.7659973502159119,
                        0.7831862568855286,
                        0.7711692452430725,
                        0.7867355942726135,
                        0.7220869660377502,
                        0.762346625328064,
                        0.6614947319030762,
                        0.8285670876502991,
                        0.7971301078796387,
                        0.6849203705787659,
                        0.6771118640899658,
                        0.708802342414856,
                        0.6963289380073547,
                        0.6861879825592041,
                        0.6376128196716309,
                        0.6303620338439941,
                        0.6521650552749634,
                        0.9810870885848999,
                        0.8819084763526917,
                        0.9912280440330505,
                        0.8688773512840271,
                        0.8636547923088074,
                        0.8552377820014954,
                        0.8670012950897217,
                        0.8634519577026367,
                        0.8706520199775696,
                        0.8708041310310364,
                        0.8694351315498352,
                        0.8698914647102356,
                        0.8596997857093811,
                        0.758797287940979,
                        0.8549842834472656,
                        0.8636040687561035,
                        0.8670012950897217,
                        0.773704469203949,
                        0.7759354710578918,
                        0.7992596626281738,
                        0.9947773814201355,
                        0.6114998459815979
                    ]
                },
                "test": {
                    "score": -5.477870335037988,
                    "pretrain_loss": 1.0762969553470612,
                    "pretrain_component": 0.4123733341693878,
                    "supervised_component": 0.6639236211776733,
                    "features_accuracy": [
                        0.6586207151412964,
                        0.7509127855300903,
                        0.7556794881820679,
                        0.7887424230575562,
                        0.81784987449646,
                        0.788286030292511,
                        0.7656693458557129,
                        0.7800710201263428,
                        0.8253042697906494,
                        0.8007606267929077,
                        0.9930020570755005,
                        0.6723631024360657,
                        0.7618154287338257,
                        0.7902637124061584,
                        0.7641987800598145,
                        0.7906186580657959,
                        0.7254056930541992,
                        0.7610547542572021,
                        0.6643002033233643,
                        0.8337221145629883,
                        0.7937626838684082,
                        0.6876775026321411,
                        0.6754056811332703,
                        0.7089756727218628,
                        0.6971602439880371,
                        0.6800709962844849,
                        0.6369168162345886,
                        0.6327078938484192,
                        0.6457403898239136,
                        0.9819472432136536,
                        0.8818965554237366,
                        0.9919878244400024,
                        0.8684584498405457,
                        0.8623732328414917,
                        0.8564908504486084,
                        0.866125762462616,
                        0.8676470518112183,
                        0.8717545866966248,
                        0.8709431886672974,
                        0.8735800981521606,
                        0.871653139591217,
                        0.8624239563941956,
                        0.7618154287338257,
                        0.8525862097740173,
                        0.860040545463562,
                        0.8628803491592407,
                        0.7703853845596313,
                        0.7707403898239136,
                        0.8031440377235413,
                        0.996146023273468,
                        0.6182048916816711
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -3.4807120885270866,
                    "pretrain_loss": 1.0578011870384216,
                    "pretrain_component": 0.4011486768722534,
                    "supervised_component": 0.6566525101661682,
                    "features_accuracy": [
                        0.6632664799690247,
                        0.7605844140052795,
                        0.7792410850524902,
                        0.8061190843582153,
                        0.8377739191055298,
                        0.8021352887153625,
                        0.7845189571380615,
                        0.807432234287262,
                        0.8397594690322876,
                        0.8104962110519409,
                        0.9927682876586914,
                        0.6820944547653198,
                        0.7931146025657654,
                        0.8085169792175293,
                        0.7743247151374817,
                        0.8159644603729248,
                        0.7611172795295715,
                        0.773684024810791,
                        0.6697243452072144,
                        0.8470927476882935,
                        0.8210266828536987,
                        0.6938999891281128,
                        0.6798043847084045,
                        0.7082683444023132,
                        0.7046905159950256,
                        0.694305956363678,
                        0.6355066895484924,
                        0.6324363350868225,
                        0.6499701738357544,
                        0.9805377125740051,
                        0.8840952515602112,
                        0.9929395318031311,
                        0.8669419884681702,
                        0.8607696294784546,
                        0.8534554243087769,
                        0.8626409769058228,
                        0.8615245223045349,
                        0.8720042109489441,
                        0.8687816858291626,
                        0.8716426491737366,
                        0.8723594546318054,
                        0.8642903566360474,
                        0.7843286395072937,
                        0.8532333970069885,
                        0.8635164499282837,
                        0.8652482628822327,
                        0.7977771759033203,
                        0.7868598103523254,
                        0.8204050064086914,
                        0.9961938261985779,
                        0.6208148002624512
                    ]
                },
                "val": {
                    "score": -5.288475013529908,
                    "pretrain_loss": 1.029485285282135,
                    "pretrain_component": 0.40189623832702637,
                    "supervised_component": 0.6275890469551086,
                    "features_accuracy": [
                        0.6620017886161804,
                        0.759557843208313,
                        0.7770509719848633,
                        0.8050400614738464,
                        0.8383530974388123,
                        0.8058006167411804,
                        0.7851637601852417,
                        0.8053949475288391,
                        0.8379981517791748,
                        0.8139133453369141,
                        0.9921914339065552,
                        0.6805597543716431,
                        0.7911469340324402,
                        0.8032146692276001,
                        0.7756819725036621,
                        0.811834454536438,
                        0.7550451159477234,
                        0.7728931903839111,
                        0.667123019695282,
                        0.8416488766670227,
                        0.8206571340560913,
                        0.6934894919395447,
                        0.6814724206924438,
                        0.7131122350692749,
                        0.7041375041007996,
                        0.6941486597061157,
                        0.6373592615127563,
                        0.6303620338439941,
                        0.6488692760467529,
                        0.9813913106918335,
                        0.8817057013511658,
                        0.992343544960022,
                        0.8684210181236267,
                        0.8635026812553406,
                        0.8541222810745239,
                        0.8656322360038757,
                        0.8602068424224854,
                        0.8717168569564819,
                        0.8715647459030151,
                        0.8673562407493591,
                        0.8699928522109985,
                        0.8607646226882935,
                        0.7784200310707092,
                        0.8561504483222961,
                        0.86613929271698,
                        0.8664942383766174,
                        0.8034175038337708,
                        0.7911469340324402,
                        0.8159922957420349,
                        0.9955886602401733,
                        0.6169252395629883
                    ]
                },
                "test": {
                    "score": -5.508415872393182,
                    "pretrain_loss": 1.0591003894805908,
                    "pretrain_component": 0.4014062285423279,
                    "supervised_component": 0.6576941609382629,
                    "features_accuracy": [
                        0.6625253558158875,
                        0.7589249610900879,
                        0.7736815214157104,
                        0.8023833632469177,
                        0.8366125822067261,
                        0.7991379499435425,
                        0.7830121517181396,
                        0.8073022365570068,
                        0.836105465888977,
                        0.8137423992156982,
                        0.9940669536590576,
                        0.6812373399734497,
                        0.7914299964904785,
                        0.8033468723297119,
                        0.7687119841575623,
                        0.8135395646095276,
                        0.7619675397872925,
                        0.774949312210083,
                        0.6673935055732727,
                        0.8487322330474854,
                        0.818965494632721,
                        0.6908721923828125,
                        0.6784989833831787,
                        0.7140973806381226,
                        0.7042596340179443,
                        0.6885395646095276,
                        0.6370689868927002,
                        0.6327078938484192,
                        0.6470081210136414,
                        0.9822008013725281,
                        0.8831136226654053,
                        0.9928498864173889,
                        0.8665314316749573,
                        0.8629310131072998,
                        0.85502028465271,
                        0.863387405872345,
                        0.866125762462616,
                        0.87337726354599,
                        0.8723630905151367,
                        0.8724138140678406,
                        0.8730223178863525,
                        0.8628296256065369,
                        0.7823529243469238,
                        0.8531947135925293,
                        0.8615111708641052,
                        0.8610547780990601,
                        0.8009127974510193,
                        0.7898580431938171,
                        0.8193204998970032,
                        0.9965010285377502,
                        0.6236308217048645
                    ]
                }
            }
        },
        "train": {
            "score": -3.5183792490465122
        },
        "val": {
            "score": -5.23297331684193
        },
        "test": {
            "score": -5.498837177171654
        }
    },
    "best_iteration": 10000,
    "time": "1:12:13"
}
