{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised_fast___51a733cbc92d473280573f78151386ab.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0,1",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                },
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 10,
        "data": {
            "path": "data/fb-comments",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512
                ],
                "dropout": 0.2888693523114936
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear",
                "relu"
            ],
            "d_num_embedding": 119,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 512,
            "lr": 6.783213831164318e-05,
            "weight_decay": 8.11888266863989e-06,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 1024
        },
        "pretrain": {
            "corrupt_probability": 0.6419817966690281,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 6.783213831164318e-05,
            "weight_decay": 8.11888266863989e-06,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post"
        },
        "bins": {
            "count": 230,
            "value": "ratio",
            "tree": {
                "min_samples_leaf": 117,
                "min_impurity_decrease": 1.2301905954129383e-05
            },
            "subsample": null
        }
    },
    "n_parameters": 4680766,
    "epoch_size": 308,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -3.5077137000266894,
                    "pretrain_loss": 1.153097242116928,
                    "pretrain_component": 0.4694182574748993,
                    "supervised_component": 0.6836789846420288,
                    "features_accuracy": [
                        0.6396554112434387,
                        0.7067014575004578,
                        0.66069096326828,
                        0.6766008138656616,
                        0.7245144248008728,
                        0.6835471391677856,
                        0.6616044640541077,
                        0.6901572346687317,
                        0.7555602192878723,
                        0.6844669580459595,
                        0.9903767108917236,
                        0.650883674621582,
                        0.6643005013465881,
                        0.6945977807044983,
                        0.6821324825286865,
                        0.6797409653663635,
                        0.6624417901039124,
                        0.6628605127334595,
                        0.6418947577476501,
                        0.7704741358757019,
                        0.6862431764602661,
                        0.6605704426765442,
                        0.6699907779693604,
                        0.669432520866394,
                        0.663222074508667,
                        0.6463162302970886,
                        0.63274085521698,
                        0.6326139569282532,
                        0.6364011168479919,
                        0.9761351943016052,
                        0.8692510724067688,
                        0.990402102470398,
                        0.8507276177406311,
                        0.8460650444030762,
                        0.8403748273849487,
                        0.849915623664856,
                        0.8496555685997009,
                        0.8575787544250488,
                        0.8524911403656006,
                        0.8624316453933716,
                        0.862406313419342,
                        0.8523833155632019,
                        0.660487949848175,
                        0.842125654220581,
                        0.8421636819839478,
                        0.846858024597168,
                        0.6910009384155273,
                        0.6966023445129395,
                        0.673162579536438,
                        0.9950329661369324,
                        0.5972418189048767
                    ]
                },
                "val": {
                    "score": -5.246933060758998,
                    "pretrain_loss": 1.1476539075374603,
                    "pretrain_component": 0.4696359932422638,
                    "supervised_component": 0.6780179142951965,
                    "features_accuracy": [
                        0.6450663805007935,
                        0.7092079520225525,
                        0.6550552248954773,
                        0.6809147000312805,
                        0.7210729122161865,
                        0.6785822510719299,
                        0.6577932834625244,
                        0.6892809867858887,
                        0.7556535601615906,
                        0.687658429145813,
                        0.9890477657318115,
                        0.6507453322410583,
                        0.6673765182495117,
                        0.6951627731323242,
                        0.679140031337738,
                        0.6803569197654724,
                        0.6622553467750549,
                        0.6634722352027893,
                        0.6400466561317444,
                        0.7677720189094543,
                        0.6877598166465759,
                        0.6648919582366943,
                        0.6731568574905396,
                        0.6676300168037415,
                        0.660784900188446,
                        0.6476016640663147,
                        0.6316296458244324,
                        0.6265084743499756,
                        0.6351282596588135,
                        0.9773349165916443,
                        0.8720210790634155,
                        0.9896562099456787,
                        0.8493053317070007,
                        0.8464151620864868,
                        0.8427643775939941,
                        0.8491532206535339,
                        0.8478856086730957,
                        0.8529560565948486,
                        0.8503701090812683,
                        0.8603589534759521,
                        0.8596997857093811,
                        0.8513842225074768,
                        0.6593144536018372,
                        0.8439813256263733,
                        0.8467193841934204,
                        0.8487475514411926,
                        0.6899908781051636,
                        0.6933373808860779,
                        0.6740695238113403,
                        0.9941689372062683,
                        0.5921306014060974
                    ]
                },
                "test": {
                    "score": -5.4408800324181765,
                    "pretrain_loss": 1.1477375030517578,
                    "pretrain_component": 0.4696991443634033,
                    "supervised_component": 0.6780383586883545,
                    "features_accuracy": [
                        0.6422920823097229,
                        0.7083671689033508,
                        0.6579614877700806,
                        0.6805781126022339,
                        0.7232251763343811,
                        0.6835699677467346,
                        0.6633874177932739,
                        0.6914300322532654,
                        0.754462480545044,
                        0.6870182752609253,
                        0.991024374961853,
                        0.6530426144599915,
                        0.6593813300132751,
                        0.6876775026321411,
                        0.6792596578598022,
                        0.6741886734962463,
                        0.6617646813392639,
                        0.66217041015625,
                        0.6466024518013,
                        0.7704868316650391,
                        0.6834685802459717,
                        0.6596348881721497,
                        0.6717038750648499,
                        0.6674442291259766,
                        0.6592292189598083,
                        0.6391480565071106,
                        0.6273833513259888,
                        0.631135880947113,
                        0.6377788782119751,
                        0.977687656879425,
                        0.8676470518112183,
                        0.9914807081222534,
                        0.851166307926178,
                        0.8444726467132568,
                        0.840060830116272,
                        0.8480730056762695,
                        0.8495436310768127,
                        0.8584178686141968,
                        0.8531440496444702,
                        0.8617647290229797,
                        0.8617647290229797,
                        0.8527383208274841,
                        0.6528904438018799,
                        0.8429006338119507,
                        0.8442190885543823,
                        0.84269779920578,
                        0.6840770840644836,
                        0.6923935413360596,
                        0.6718052625656128,
                        0.995537519454956,
                        0.5890973806381226
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -3.9360363883771545,
                    "pretrain_loss": 1.092590868473053,
                    "pretrain_component": 0.42943811416625977,
                    "supervised_component": 0.6631527543067932,
                    "features_accuracy": [
                        0.6427130699157715,
                        0.720327615737915,
                        0.7218374013900757,
                        0.7543993592262268,
                        0.7918903231620789,
                        0.7494068741798401,
                        0.7109516859054565,
                        0.7558583617210388,
                        0.7938123941421509,
                        0.7736586332321167,
                        0.9909539818763733,
                        0.6687093377113342,
                        0.7399739027023315,
                        0.7696938514709473,
                        0.7561438679695129,
                        0.743139386177063,
                        0.7299001812934875,
                        0.7355840802192688,
                        0.6573668718338013,
                        0.81637042760849,
                        0.7498636245727539,
                        0.6806100010871887,
                        0.6776729226112366,
                        0.6930943131446838,
                        0.6835915446281433,
                        0.6771590709686279,
                        0.629277229309082,
                        0.6314594149589539,
                        0.6435948610305786,
                        0.9790977239608765,
                        0.8809614777565002,
                        0.9907382726669312,
                        0.8616196513175964,
                        0.8595516681671143,
                        0.8526434302330017,
                        0.8593993782997131,
                        0.8623682260513306,
                        0.8678554892539978,
                        0.8642522692680359,
                        0.8706911206245422,
                        0.8707101345062256,
                        0.8619622588157654,
                        0.7126073837280273,
                        0.8535886406898499,
                        0.8596150875091553,
                        0.86546391248703,
                        0.7584529519081116,
                        0.7621005177497864,
                        0.757533073425293,
                        0.995274007320404,
                        0.5982313752174377
                    ]
                },
                "val": {
                    "score": -5.311022595895586,
                    "pretrain_loss": 1.0894754528999329,
                    "pretrain_component": 0.4298190474510193,
                    "supervised_component": 0.6596564054489136,
                    "features_accuracy": [
                        0.6470946073532104,
                        0.7223405241966248,
                        0.717878520488739,
                        0.7574789524078369,
                        0.7843524813652039,
                        0.7499746084213257,
                        0.7098164558410645,
                        0.7555014491081238,
                        0.7938849925994873,
                        0.77436363697052,
                        0.9891998767852783,
                        0.6710272431373596,
                        0.7371463179588318,
                        0.7676705718040466,
                        0.7524084448814392,
                        0.7371970415115356,
                        0.7255349159240723,
                        0.7294391989707947,
                        0.6590102314949036,
                        0.8169556856155396,
                        0.7453604936599731,
                        0.6859344840049744,
                        0.6828414797782898,
                        0.6935908794403076,
                        0.6782273650169373,
                        0.6810668110847473,
                        0.6317817568778992,
                        0.6265084743499756,
                        0.6408072113990784,
                        0.9799208641052246,
                        0.8805902004241943,
                        0.9899097084999084,
                        0.8611195087432861,
                        0.8633505702018738,
                        0.8547307252883911,
                        0.8616265654563904,
                        0.8623871803283691,
                        0.8652773499488831,
                        0.8637561798095703,
                        0.8700942993164062,
                        0.8691309094429016,
                        0.8609167337417603,
                        0.7094107866287231,
                        0.8555927276611328,
                        0.8624885678291321,
                        0.8645167350769043,
                        0.7583408951759338,
                        0.7573775053024292,
                        0.760977566242218,
                        0.9942196011543274,
                        0.5942602157592773
                    ]
                },
                "test": {
                    "score": -5.541310356748398,
                    "pretrain_loss": 1.0907418131828308,
                    "pretrain_component": 0.42988377809524536,
                    "supervised_component": 0.6608580350875854,
                    "features_accuracy": [
                        0.6438133716583252,
                        0.721653163433075,
                        0.7180527448654175,
                        0.7492393255233765,
                        0.7914807200431824,
                        0.748275876045227,
                        0.7145030498504639,
                        0.7562373280525208,
                        0.7979716062545776,
                        0.7729209065437317,
                        0.9915314316749573,
                        0.6726673245429993,
                        0.7355983853340149,
                        0.7637423872947693,
                        0.7519776821136475,
                        0.7392494678497314,
                        0.7311866283416748,
                        0.7334178686141968,
                        0.6627281904220581,
                        0.8141480684280396,
                        0.7423428297042847,
                        0.68215012550354,
                        0.6822007894515991,
                        0.6882860064506531,
                        0.6798681616783142,
                        0.675507128238678,
                        0.6276876330375671,
                        0.631135880947113,
                        0.6418356895446777,
                        0.979411780834198,
                        0.8803752660751343,
                        0.9914300441741943,
                        0.8634381294250488,
                        0.8590770959854126,
                        0.8529411554336548,
                        0.8584685921669006,
                        0.8618661165237427,
                        0.8701318502426147,
                        0.8634888529777527,
                        0.8704361319541931,
                        0.870537519454956,
                        0.8616125583648682,
                        0.7108012437820435,
                        0.8536511063575745,
                        0.8591278195381165,
                        0.8628296256065369,
                        0.7557809352874756,
                        0.75162273645401,
                        0.7630324363708496,
                        0.995537519454956,
                        0.5924949049949646
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -3.488766070692853,
                    "pretrain_loss": 1.072833001613617,
                    "pretrain_component": 0.4112534523010254,
                    "supervised_component": 0.6615795493125916,
                    "features_accuracy": [
                        0.655413031578064,
                        0.7424288988113403,
                        0.7556109428405762,
                        0.7941803336143494,
                        0.8158565759658813,
                        0.7961405515670776,
                        0.7679747343063354,
                        0.7787082195281982,
                        0.8234689831733704,
                        0.7962864637374878,
                        0.9920704364776611,
                        0.6779456734657288,
                        0.7752763032913208,
                        0.7992933392524719,
                        0.7712354063987732,
                        0.7753270268440247,
                        0.7619926929473877,
                        0.7707151770591736,
                        0.6622578501701355,
                        0.8365051746368408,
                        0.8023256063461304,
                        0.6967989802360535,
                        0.6832553148269653,
                        0.7032061219215393,
                        0.6974904537200928,
                        0.6904236674308777,
                        0.632201611995697,
                        0.6336987614631653,
                        0.6472805142402649,
                        0.9801760911941528,
                        0.8825790882110596,
                        0.9914234280586243,
                        0.8645187020301819,
                        0.8612263798713684,
                        0.8543371558189392,
                        0.8608711361885071,
                        0.8620446920394897,
                        0.87079256772995,
                        0.868331253528595,
                        0.8718773722648621,
                        0.8696063160896301,
                        0.8623492121696472,
                        0.7613012194633484,
                        0.855593204498291,
                        0.8631802201271057,
                        0.8653497695922852,
                        0.786085844039917,
                        0.7796470522880554,
                        0.7851724028587341,
                        0.9950582981109619,
                        0.604854166507721
                    ]
                },
                "val": {
                    "score": -5.2622239969354085,
                    "pretrain_loss": 1.0634150207042694,
                    "pretrain_component": 0.41162827610969543,
                    "supervised_component": 0.651786744594574,
                    "features_accuracy": [
                        0.6570327281951904,
                        0.7465267181396484,
                        0.7528647780418396,
                        0.7941892147064209,
                        0.808285117149353,
                        0.7957610487937927,
                        0.7644761800765991,
                        0.7791805863380432,
                        0.8246628046035767,
                        0.8012878894805908,
                        0.9909238219261169,
                        0.6767061948776245,
                        0.7761890292167664,
                        0.7986005544662476,
                        0.7668086290359497,
                        0.7789270877838135,
                        0.7568705081939697,
                        0.7649832367897034,
                        0.6649426817893982,
                        0.8355135917663574,
                        0.7985498309135437,
                        0.6999797224998474,
                        0.6865429282188416,
                        0.6995233297348022,
                        0.6933881044387817,
                        0.6917148232460022,
                        0.6328972578048706,
                        0.6265084743499756,
                        0.6445086598396301,
                        0.9812899231910706,
                        0.8807929754257202,
                        0.9910252094268799,
                        0.8650237917900085,
                        0.8648210167884827,
                        0.8544772267341614,
                        0.8645167350769043,
                        0.8622857332229614,
                        0.8676097393035889,
                        0.8702971339225769,
                        0.8713619112968445,
                        0.8690294623374939,
                        0.8626914024353027,
                        0.7601155638694763,
                        0.8544265031814575,
                        0.869587242603302,
                        0.8652773499488831,
                        0.7855187058448792,
                        0.775783360004425,
                        0.7844032049179077,
                        0.9940168261528015,
                        0.5988743305206299
                    ]
                },
                "test": {
                    "score": -5.47550114018631,
                    "pretrain_loss": 1.06625235080719,
                    "pretrain_component": 0.4114997982978821,
                    "supervised_component": 0.6547525525093079,
                    "features_accuracy": [
                        0.6576572060585022,
                        0.7447261810302734,
                        0.7534989714622498,
                        0.790567934513092,
                        0.8175963759422302,
                        0.7958418130874634,
                        0.7648580074310303,
                        0.7764198780059814,
                        0.826724112033844,
                        0.8022819757461548,
                        0.9923428297042847,
                        0.6798681616783142,
                        0.7743407487869263,
                        0.7970588207244873,
                        0.7662271857261658,
                        0.7741886377334595,
                        0.7623225450515747,
                        0.7698276042938232,
                        0.6685091257095337,
                        0.8346349000930786,
                        0.7989857792854309,
                        0.6979715824127197,
                        0.687221109867096,
                        0.6959939002990723,
                        0.6987829804420471,
                        0.6864604353904724,
                        0.6286511421203613,
                        0.631135880947113,
                        0.6477687954902649,
                        0.9803752303123474,
                        0.8815922737121582,
                        0.9923428297042847,
                        0.8675456643104553,
                        0.8617647290229797,
                        0.8531440496444702,
                        0.8611055016517639,
                        0.8629817366600037,
                        0.8735294342041016,
                        0.8681034445762634,
                        0.872261643409729,
                        0.8712474703788757,
                        0.8628296256065369,
                        0.7624746561050415,
                        0.85664302110672,
                        0.8639452457427979,
                        0.8635902404785156,
                        0.782200813293457,
                        0.7707910537719727,
                        0.786663293838501,
                        0.9951318502426147,
                        0.5958417654037476
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -3.3725520550691352,
                    "pretrain_loss": 1.0485793948173523,
                    "pretrain_component": 0.4002854824066162,
                    "supervised_component": 0.6482939124107361,
                    "features_accuracy": [
                        0.6629937291145325,
                        0.7540504336357117,
                        0.7805034518241882,
                        0.8087263107299805,
                        0.8325086832046509,
                        0.8088786005973816,
                        0.7863142490386963,
                        0.7944848537445068,
                        0.837716817855835,
                        0.8123739361763,
                        0.9924066662788391,
                        0.680901825428009,
                        0.785559356212616,
                        0.816040575504303,
                        0.7977010607719421,
                        0.7913447618484497,
                        0.7873482704162598,
                        0.7869612574577332,
                        0.672166645526886,
                        0.846458375453949,
                        0.8229424357414246,
                        0.7093784809112549,
                        0.6853169798851013,
                        0.7120301127433777,
                        0.7056484222412109,
                        0.7009604573249817,
                        0.6344853639602661,
                        0.6317956447601318,
                        0.6498116254806519,
                        0.9804171919822693,
                        0.8851799964904785,
                        0.9922988414764404,
                        0.8651213645935059,
                        0.8618163466453552,
                        0.855523407459259,
                        0.8652735948562622,
                        0.8637955784797668,
                        0.8716680407524109,
                        0.8682488203048706,
                        0.8686928749084473,
                        0.8713064193725586,
                        0.8638209104537964,
                        0.7787018418312073,
                        0.8558025360107422,
                        0.8627678751945496,
                        0.866003155708313,
                        0.8127481937408447,
                        0.7823874950408936,
                        0.8064109086990356,
                        0.9952549934387207,
                        0.6265113949775696
                    ]
                },
                "val": {
                    "score": -5.286346170545761,
                    "pretrain_loss": 1.0459421277046204,
                    "pretrain_component": 0.40063685178756714,
                    "supervised_component": 0.6453052759170532,
                    "features_accuracy": [
                        0.66651451587677,
                        0.7565662264823914,
                        0.7740594148635864,
                        0.8086907863616943,
                        0.8263360261917114,
                        0.810414731502533,
                        0.7815130352973938,
                        0.7959638833999634,
                        0.8365784287452698,
                        0.8136598467826843,
                        0.9917351007461548,
                        0.6775681972503662,
                        0.7841496467590332,
                        0.8150795698165894,
                        0.7950512170791626,
                        0.7947469353675842,
                        0.782780647277832,
                        0.7821721434593201,
                        0.672852635383606,
                        0.846364438533783,
                        0.821671187877655,
                        0.7140249013900757,
                        0.6905485987663269,
                        0.7100699543952942,
                        0.7031233906745911,
                        0.703833281993866,
                        0.6334549784660339,
                        0.6265084743499756,
                        0.6483622193336487,
                        0.9812899231910706,
                        0.8817057013511658,
                        0.9918364882469177,
                        0.8658350706100464,
                        0.8645674586296082,
                        0.8563532829284668,
                        0.8675590753555298,
                        0.8631477355957031,
                        0.8700942993164062,
                        0.8701449632644653,
                        0.8697393536567688,
                        0.8718182444572449,
                        0.8629449009895325,
                        0.773704469203949,
                        0.8577223420143127,
                        0.8674069046974182,
                        0.8651252388954163,
                        0.816042959690094,
                        0.7789270877838135,
                        0.8042287826538086,
                        0.9949802160263062,
                        0.622654914855957
                    ]
                },
                "test": {
                    "score": -5.500525575725972,
                    "pretrain_loss": 1.0494924485683441,
                    "pretrain_component": 0.4005567729473114,
                    "supervised_component": 0.6489356756210327,
                    "features_accuracy": [
                        0.6662778854370117,
                        0.754462480545044,
                        0.7769269943237305,
                        0.805020272731781,
                        0.8353448510169983,
                        0.8114604353904724,
                        0.7858012318611145,
                        0.7898580431938171,
                        0.838843822479248,
                        0.8118154406547546,
                        0.9928498864173889,
                        0.6852940917015076,
                        0.7819472551345825,
                        0.8134381175041199,
                        0.7948783040046692,
                        0.7886916995048523,
                        0.7870689630508423,
                        0.786663293838501,
                        0.6775861978530884,
                        0.8473631143569946,
                        0.8227687478065491,
                        0.7090263962745667,
                        0.6893001794815063,
                        0.705476701259613,
                        0.7031947374343872,
                        0.6987829804420471,
                        0.6306794881820679,
                        0.631135880947113,
                        0.6493914723396301,
                        0.9807302355766296,
                        0.8849391341209412,
                        0.9925963282585144,
                        0.8681541681289673,
                        0.8610040545463562,
                        0.8551723957061768,
                        0.8644523620605469,
                        0.8649594187736511,
                        0.8739351034164429,
                        0.8680527210235596,
                        0.8706896305084229,
                        0.8712474703788757,
                        0.863793134689331,
                        0.7795131802558899,
                        0.8586207032203674,
                        0.8626775145530701,
                        0.8639959692955017,
                        0.8092799186706543,
                        0.7770283818244934,
                        0.8043103218078613,
                        0.9958418011665344,
                        0.617748498916626
                    ]
                }
            }
        },
        "train": {
            "score": -3.5077137000266894
        },
        "val": {
            "score": -5.246933060758998
        },
        "test": {
            "score": -5.4408800324181765
        }
    },
    "best_iteration": 10000,
    "time": "1:19:12"
}
