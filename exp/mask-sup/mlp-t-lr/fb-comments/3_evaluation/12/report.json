{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised_fast___51a733cbc92d473280573f78151386ab.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0,1",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                },
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 12,
        "data": {
            "path": "data/fb-comments",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512
                ],
                "dropout": 0.2888693523114936
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear",
                "relu"
            ],
            "d_num_embedding": 119,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 512,
            "lr": 6.783213831164318e-05,
            "weight_decay": 8.11888266863989e-06,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 1024
        },
        "pretrain": {
            "corrupt_probability": 0.6419817966690281,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 6.783213831164318e-05,
            "weight_decay": 8.11888266863989e-06,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post"
        },
        "bins": {
            "count": 230,
            "value": "ratio",
            "tree": {
                "min_samples_leaf": 117,
                "min_impurity_decrease": 1.2301905954129383e-05
            },
            "subsample": null
        }
    },
    "n_parameters": 4680766,
    "epoch_size": 308,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -3.5055502498769116,
                    "pretrain_loss": 1.148705244064331,
                    "pretrain_component": 0.46650415658950806,
                    "supervised_component": 0.682201087474823,
                    "features_accuracy": [
                        0.639611005783081,
                        0.7186402082443237,
                        0.6689757704734802,
                        0.6975856423377991,
                        0.724317729473114,
                        0.6863319873809814,
                        0.6612301468849182,
                        0.6800327301025391,
                        0.734531044960022,
                        0.6827858686447144,
                        0.9901102781295776,
                        0.6478767991065979,
                        0.6774191856384277,
                        0.6797980070114136,
                        0.685894250869751,
                        0.6814664006233215,
                        0.6717352271080017,
                        0.6658673882484436,
                        0.6405625939369202,
                        0.7700363993644714,
                        0.6891929507255554,
                        0.6643385887145996,
                        0.6664129495620728,
                        0.6754843592643738,
                        0.6677197217941284,
                        0.6495261192321777,
                        0.6323792338371277,
                        0.6276913285255432,
                        0.6313071846961975,
                        0.9756784439086914,
                        0.8683502674102783,
                        0.9907382726669312,
                        0.8492369055747986,
                        0.8396389484405518,
                        0.8321153521537781,
                        0.8476256132125854,
                        0.8478793501853943,
                        0.8536266684532166,
                        0.858460545539856,
                        0.8584859371185303,
                        0.859126627445221,
                        0.847257673740387,
                        0.671291172504425,
                        0.8404889702796936,
                        0.8464075922966003,
                        0.8549398183822632,
                        0.6962534785270691,
                        0.6808447241783142,
                        0.6837754845619202,
                        0.9955341219902039,
                        0.5958905816078186
                    ]
                },
                "val": {
                    "score": -5.247543048713006,
                    "pretrain_loss": 1.1018154323101044,
                    "pretrain_component": 0.4663289487361908,
                    "supervised_component": 0.6354864835739136,
                    "features_accuracy": [
                        0.6384240984916687,
                        0.7213771343231201,
                        0.6706216335296631,
                        0.6965824961662292,
                        0.7314673662185669,
                        0.6816245913505554,
                        0.6604299545288086,
                        0.6801541447639465,
                        0.7334955930709839,
                        0.6829935908317566,
                        0.9899097084999084,
                        0.6497312188148499,
                        0.676300585269928,
                        0.6795963644981384,
                        0.6866443157196045,
                        0.6797484755516052,
                        0.6717371344566345,
                        0.6723963022232056,
                        0.6377142071723938,
                        0.7732988595962524,
                        0.6898894309997559,
                        0.6652469038963318,
                        0.669303297996521,
                        0.6737653017044067,
                        0.6651961803436279,
                        0.647500216960907,
                        0.6374607086181641,
                        0.6307676434516907,
                        0.6308690905570984,
                        0.9762701392173767,
                        0.8650237917900085,
                        0.9889463186264038,
                        0.849203884601593,
                        0.8397728204727173,
                        0.8361727595329285,
                        0.8472771048545837,
                        0.8472771048545837,
                        0.8520941138267517,
                        0.8629956245422363,
                        0.8571645617485046,
                        0.856860339641571,
                        0.8441334366798401,
                        0.6764526963233948,
                        0.8415474891662598,
                        0.8478348851203918,
                        0.8549842834472656,
                        0.6953655481338501,
                        0.6729540228843689,
                        0.6836527585983276,
                        0.9946759939193726,
                        0.5997869968414307
                    ]
                },
                "test": {
                    "score": -5.543053780220738,
                    "pretrain_loss": 1.1368610560894012,
                    "pretrain_component": 0.4664745628833771,
                    "supervised_component": 0.6703864932060242,
                    "features_accuracy": [
                        0.6362575888633728,
                        0.7180527448654175,
                        0.6665821671485901,
                        0.6921906471252441,
                        0.7238336801528931,
                        0.6870689392089844,
                        0.6538032293319702,
                        0.6749492883682251,
                        0.7340263724327087,
                        0.6775861978530884,
                        0.9907200932502747,
                        0.6495436429977417,
                        0.6722109317779541,
                        0.6792089343070984,
                        0.6921399831771851,
                        0.6783468723297119,
                        0.6728701591491699,
                        0.6663793325424194,
                        0.6411764621734619,
                        0.7731237411499023,
                        0.6899594068527222,
                        0.6710953116416931,
                        0.6633874177932739,
                        0.6743407845497131,
                        0.6672921180725098,
                        0.6531947255134583,
                        0.6315922737121582,
                        0.6339756846427917,
                        0.6298681497573853,
                        0.9751521348953247,
                        0.8686612844467163,
                        0.9908722043037415,
                        0.8507099151611328,
                        0.8387423753738403,
                        0.8316429853439331,
                        0.8483772873878479,
                        0.8466024398803711,
                        0.854918897151947,
                        0.8606997728347778,
                        0.8610040545463562,
                        0.8606997728347778,
                        0.8511156439781189,
                        0.6680527329444885,
                        0.8430527448654175,
                        0.8463996052742004,
                        0.8501521348953247,
                        0.6956389546394348,
                        0.6764198541641235,
                        0.6791582107543945,
                        0.9956389665603638,
                        0.5971602201461792
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -3.3767317034243938,
                    "pretrain_loss": 1.1013815999031067,
                    "pretrain_component": 0.43075984716415405,
                    "supervised_component": 0.6706217527389526,
                    "features_accuracy": [
                        0.6472805142402649,
                        0.7327738404273987,
                        0.7399421334266663,
                        0.7367132306098938,
                        0.7985194325447083,
                        0.7403735518455505,
                        0.7010238766670227,
                        0.7702965140342712,
                        0.786225438117981,
                        0.7616881728172302,
                        0.9904465079307556,
                        0.6680749654769897,
                        0.7526675462722778,
                        0.7597851157188416,
                        0.7288153767585754,
                        0.7662302255630493,
                        0.7029206156730652,
                        0.7073231339454651,
                        0.655083179473877,
                        0.8078508973121643,
                        0.7744896411895752,
                        0.680971622467041,
                        0.6729976534843445,
                        0.6972684264183044,
                        0.6862114667892456,
                        0.6795379519462585,
                        0.6321508884429932,
                        0.6297085881233215,
                        0.6423134207725525,
                        0.9787551164627075,
                        0.8830295205116272,
                        0.9910554885864258,
                        0.8635100722312927,
                        0.8482155203819275,
                        0.8519012331962585,
                        0.8634973764419556,
                        0.863738477230072,
                        0.8681155443191528,
                        0.8657494187355042,
                        0.8699615597724915,
                        0.8705642223358154,
                        0.8607189059257507,
                        0.7217612862586975,
                        0.8515713214874268,
                        0.8653433918952942,
                        0.8646265864372253,
                        0.7565498352050781,
                        0.7434438467025757,
                        0.7548878192901611,
                        0.9950075745582581,
                        0.6009972095489502
                    ]
                },
                "val": {
                    "score": -5.2504906640371685,
                    "pretrain_loss": 1.0602949261665344,
                    "pretrain_component": 0.4313218593597412,
                    "supervised_component": 0.6289730668067932,
                    "features_accuracy": [
                        0.6442551016807556,
                        0.7370955944061279,
                        0.7395294308662415,
                        0.737653374671936,
                        0.7998174428939819,
                        0.739833652973175,
                        0.6957204937934875,
                        0.7691917419433594,
                        0.7827299237251282,
                        0.7582902312278748,
                        0.989554762840271,
                        0.6702159643173218,
                        0.7506337761878967,
                        0.7577831745147705,
                        0.7314673662185669,
                        0.7630057334899902,
                        0.7025149464607239,
                        0.7075347304344177,
                        0.6467903852462769,
                        0.8085893988609314,
                        0.770155131816864,
                        0.6769596934318542,
                        0.6731568574905396,
                        0.6987627744674683,
                        0.6818780899047852,
                        0.6755399703979492,
                        0.6379170417785645,
                        0.6307676434516907,
                        0.6454213261604309,
                        0.9783490300178528,
                        0.8804887533187866,
                        0.9896562099456787,
                        0.8626406788825989,
                        0.8499644994735718,
                        0.8557448387145996,
                        0.8609673976898193,
                        0.8635533452033997,
                        0.8648210167884827,
                        0.8663928508758545,
                        0.8679139614105225,
                        0.8704999089241028,
                        0.8586350083351135,
                        0.722188413143158,
                        0.8519419431686401,
                        0.8709055781364441,
                        0.8650237917900085,
                        0.7549436688423157,
                        0.7419125437736511,
                        0.7618395686149597,
                        0.9949802160263062,
                        0.6015110015869141
                    ]
                },
                "test": {
                    "score": -5.472529477501122,
                    "pretrain_loss": 1.0969026386737823,
                    "pretrain_component": 0.4312685430049896,
                    "supervised_component": 0.6656340956687927,
                    "features_accuracy": [
                        0.6439655423164368,
                        0.7338742613792419,
                        0.738894522190094,
                        0.7330628633499146,
                        0.7957910895347595,
                        0.7442697882652283,
                        0.6996957659721375,
                        0.7664300203323364,
                        0.7857505083084106,
                        0.7573022246360779,
                        0.991125762462616,
                        0.6728194952011108,
                        0.7512170672416687,
                        0.754462480545044,
                        0.7347870469093323,
                        0.7614097595214844,
                        0.7012677788734436,
                        0.7062373161315918,
                        0.6501521468162537,
                        0.8088235259056091,
                        0.7742393612861633,
                        0.6818965673446655,
                        0.673884391784668,
                        0.6952332854270935,
                        0.6834178566932678,
                        0.6833164095878601,
                        0.6336206793785095,
                        0.6339756846427917,
                        0.647819459438324,
                        0.9781947135925293,
                        0.880020260810852,
                        0.9912272095680237,
                        0.8667342662811279,
                        0.8486308455467224,
                        0.8507606387138367,
                        0.8622211217880249,
                        0.8627281785011292,
                        0.8675456643104553,
                        0.8660750389099121,
                        0.8719066977500916,
                        0.8725659251213074,
                        0.8594827651977539,
                        0.7207403779029846,
                        0.8529411554336548,
                        0.8671906590461731,
                        0.863387405872345,
                        0.7498986124992371,
                        0.7394523620605469,
                        0.7510648965835571,
                        0.9956389665603638,
                        0.5996957421302795
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -3.3484844069271276,
                    "pretrain_loss": 1.075675755739212,
                    "pretrain_component": 0.41113749146461487,
                    "supervised_component": 0.6645382642745972,
                    "features_accuracy": [
                        0.6625813841819763,
                        0.7476116418838501,
                        0.7791395783424377,
                        0.7716350555419922,
                        0.8271419405937195,
                        0.7687740325927734,
                        0.7502442598342896,
                        0.8007650375366211,
                        0.8178104162216187,
                        0.7919791340827942,
                        0.9911569952964783,
                        0.6865032911300659,
                        0.7673467397689819,
                        0.8018181324005127,
                        0.7737347483634949,
                        0.8029916882514954,
                        0.7501998543739319,
                        0.7560423612594604,
                        0.6575762033462524,
                        0.8337456583976746,
                        0.8080602288246155,
                        0.6932783126831055,
                        0.679836094379425,
                        0.7064857482910156,
                        0.6928342580795288,
                        0.6917875409126282,
                        0.6365978121757507,
                        0.6328550577163696,
                        0.6494119763374329,
                        0.9796432256698608,
                        0.8841776847839355,
                        0.9915439486503601,
                        0.866003155708313,
                        0.8568746447563171,
                        0.8512604832649231,
                        0.864398181438446,
                        0.8661046624183655,
                        0.8710716962814331,
                        0.8678808808326721,
                        0.8727020025253296,
                        0.8675573468208313,
                        0.8602684736251831,
                        0.7510181665420532,
                        0.855396568775177,
                        0.8647407293319702,
                        0.8609155416488647,
                        0.792626142501831,
                        0.7719839215278625,
                        0.7961151599884033,
                        0.9955277442932129,
                        0.6075184941291809
                    ]
                },
                "val": {
                    "score": -5.2622653761057405,
                    "pretrain_loss": 1.0270632803440094,
                    "pretrain_component": 0.4113008677959442,
                    "supervised_component": 0.6157624125480652,
                    "features_accuracy": [
                        0.6591116189956665,
                        0.7526620030403137,
                        0.7798397541046143,
                        0.7728931903839111,
                        0.8274008631706238,
                        0.7701044082641602,
                        0.7481999397277832,
                        0.7968258857727051,
                        0.8164486289024353,
                        0.7951526045799255,
                        0.9905688762664795,
                        0.6848189830780029,
                        0.7684818506240845,
                        0.8001216650009155,
                        0.7766960263252258,
                        0.7983977198600769,
                        0.7506337761878967,
                        0.7584930062294006,
                        0.6529763340950012,
                        0.8332825899124146,
                        0.8044822812080383,
                        0.6905993223190308,
                        0.6798499226570129,
                        0.7071797847747803,
                        0.688317596912384,
                        0.6931345462799072,
                        0.6396917104721069,
                        0.6307676434516907,
                        0.6507453322410583,
                        0.9795659184455872,
                        0.8830747008323669,
                        0.9906702637672424,
                        0.8661900162696838,
                        0.8595983982086182,
                        0.855542004108429,
                        0.8629956245422363,
                        0.8643139600753784,
                        0.8671534061431885,
                        0.8683196306228638,
                        0.8713111877441406,
                        0.8691309094429016,
                        0.8617280125617981,
                        0.7515465021133423,
                        0.8550856709480286,
                        0.8697900772094727,
                        0.8626406788825989,
                        0.7933272123336792,
                        0.7741101384162903,
                        0.8025047779083252,
                        0.9950816035270691,
                        0.6083561182022095
                    ]
                },
                "test": {
                    "score": -5.527947833872965,
                    "pretrain_loss": 1.0635968148708344,
                    "pretrain_component": 0.4114321172237396,
                    "supervised_component": 0.6521646976470947,
                    "features_accuracy": [
                        0.6633874177932739,
                        0.7478194832801819,
                        0.7779411673545837,
                        0.7681034803390503,
                        0.8263691663742065,
                        0.7640973925590515,
                        0.7499492764472961,
                        0.7975152134895325,
                        0.8190669417381287,
                        0.795537531375885,
                        0.991632878780365,
                        0.6870689392089844,
                        0.7661764621734619,
                        0.8015213012695312,
                        0.7774340510368347,
                        0.8017748594284058,
                        0.7479208707809448,
                        0.7518762946128845,
                        0.6535496711730957,
                        0.8348377346992493,
                        0.8053245544433594,
                        0.6978194713592529,
                        0.6769776940345764,
                        0.7053752541542053,
                        0.6929005980491638,
                        0.6947261691093445,
                        0.6354462504386902,
                        0.6339756846427917,
                        0.6499999761581421,
                        0.9796146154403687,
                        0.8829107284545898,
                        0.9918357133865356,
                        0.8681034445762634,
                        0.8564908504486084,
                        0.8491379618644714,
                        0.8636916875839233,
                        0.8652637004852295,
                        0.8701825737953186,
                        0.8684077262878418,
                        0.8753042817115784,
                        0.8716024160385132,
                        0.8614604473114014,
                        0.747768759727478,
                        0.8573022484779358,
                        0.8655679821968079,
                        0.8574543595314026,
                        0.7857505083084106,
                        0.7728701829910278,
                        0.7908722162246704,
                        0.9958418011665344,
                        0.6058823466300964
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -3.3318597424457193,
                    "pretrain_loss": 1.0487977266311646,
                    "pretrain_component": 0.3997035026550293,
                    "supervised_component": 0.6490942239761353,
                    "features_accuracy": [
                        0.6648396849632263,
                        0.757469654083252,
                        0.792759358882904,
                        0.7927466630935669,
                        0.8412248492240906,
                        0.798024594783783,
                        0.7879825830459595,
                        0.8145942091941833,
                        0.8331810832023621,
                        0.8042794466018677,
                        0.9922163486480713,
                        0.6943884491920471,
                        0.7866504192352295,
                        0.815241277217865,
                        0.7999721169471741,
                        0.8178231120109558,
                        0.7718760967254639,
                        0.7865235805511475,
                        0.671430766582489,
                        0.8505119681358337,
                        0.8200877904891968,
                        0.6998122334480286,
                        0.682640016078949,
                        0.7077925801277161,
                        0.6931133270263672,
                        0.6959362626075745,
                        0.6347835063934326,
                        0.6312881708145142,
                        0.652152419090271,
                        0.97972571849823,
                        0.8822872638702393,
                        0.9925144910812378,
                        0.8654893040657043,
                        0.8602240681648254,
                        0.8559484481811523,
                        0.8653560876846313,
                        0.8624126315116882,
                        0.8725053668022156,
                        0.86899733543396,
                        0.8721628189086914,
                        0.8697015047073364,
                        0.8613786101341248,
                        0.7788287401199341,
                        0.856798529624939,
                        0.8648549318313599,
                        0.863865315914154,
                        0.8111051917076111,
                        0.7881792783737183,
                        0.812843382358551,
                        0.9957687854766846,
                        0.6178586483001709
                    ]
                },
                "val": {
                    "score": -5.283180375950916,
                    "pretrain_loss": 1.0134567618370056,
                    "pretrain_component": 0.400631844997406,
                    "supervised_component": 0.6128249168395996,
                    "features_accuracy": [
                        0.6611905097961426,
                        0.7602676749229431,
                        0.7944427132606506,
                        0.792718768119812,
                        0.8410911560058594,
                        0.7978906631469727,
                        0.7828313112258911,
                        0.8127471804618835,
                        0.8300374746322632,
                        0.8055470585823059,
                        0.9914815425872803,
                        0.6928810477256775,
                        0.7882567644119263,
                        0.8112260103225708,
                        0.8043808937072754,
                        0.8113781213760376,
                        0.7668086290359497,
                        0.7888144850730896,
                        0.6672751307487488,
                        0.8489503860473633,
                        0.8206571340560913,
                        0.7001318335533142,
                        0.6823851466178894,
                        0.7068248391151428,
                        0.6864415407180786,
                        0.6989656090736389,
                        0.6401987671852112,
                        0.6307676434516907,
                        0.6516580581665039,
                        0.9794645309448242,
                        0.8817057013511658,
                        0.9916843771934509,
                        0.8653280138969421,
                        0.8630970120429993,
                        0.8598518967628479,
                        0.866037905216217,
                        0.8612209558486938,
                        0.8685731291770935,
                        0.8683196306228638,
                        0.8709055781364441,
                        0.872376024723053,
                        0.8599533438682556,
                        0.7806510329246521,
                        0.856860339641571,
                        0.869587242603302,
                        0.8638069033622742,
                        0.8130006790161133,
                        0.7900314331054688,
                        0.817462682723999,
                        0.9958421587944031,
                        0.6205253005027771
                    ]
                },
                "test": {
                    "score": -5.47675257743439,
                    "pretrain_loss": 1.0496758818626404,
                    "pretrain_component": 0.4001917243003845,
                    "supervised_component": 0.6494841575622559,
                    "features_accuracy": [
                        0.6641480922698975,
                        0.7586714029312134,
                        0.7895537614822388,
                        0.7888438105583191,
                        0.8365111351013184,
                        0.7920385599136353,
                        0.7863083481788635,
                        0.8067951202392578,
                        0.8344827890396118,
                        0.8040568232536316,
                        0.9925456643104553,
                        0.693864107131958,
                        0.7829107642173767,
                        0.8136916756629944,
                        0.8047160506248474,
                        0.8151623010635376,
                        0.76835697889328,
                        0.7807809114456177,
                        0.6698275804519653,
                        0.8490872383117676,
                        0.8187626600265503,
                        0.7081136107444763,
                        0.6819979548454285,
                        0.7057809233665466,
                        0.6919371485710144,
                        0.6995435953140259,
                        0.6353448033332825,
                        0.6339756846427917,
                        0.6530426144599915,
                        0.9799695611000061,
                        0.8813387751579285,
                        0.9925456643104553,
                        0.8693711757659912,
                        0.8608519434928894,
                        0.8537018299102783,
                        0.8652129769325256,
                        0.8640973567962646,
                        0.8718052506446838,
                        0.8692697882652283,
                        0.8735800981521606,
                        0.8726673722267151,
                        0.8598884344100952,
                        0.7732758522033691,
                        0.856135904788971,
                        0.8646044731140137,
                        0.8613083362579346,
                        0.8042089343070984,
                        0.7889959216117859,
                        0.8096855878829956,
                        0.9962474703788757,
                        0.6175456643104553
                    ]
                }
            }
        },
        "train": {
            "score": -3.5055502498769116
        },
        "val": {
            "score": -5.247543048713006
        },
        "test": {
            "score": -5.543053780220738
        }
    },
    "best_iteration": 10000,
    "time": "1:29:38"
}
