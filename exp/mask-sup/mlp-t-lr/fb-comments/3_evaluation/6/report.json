{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised_fast___51a733cbc92d473280573f78151386ab.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0,1",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                },
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 6,
        "data": {
            "path": "data/fb-comments",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512
                ],
                "dropout": 0.2888693523114936
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear",
                "relu"
            ],
            "d_num_embedding": 119,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 512,
            "lr": 6.783213831164318e-05,
            "weight_decay": 8.11888266863989e-06,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 1024
        },
        "pretrain": {
            "corrupt_probability": 0.6419817966690281,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 6.783213831164318e-05,
            "weight_decay": 8.11888266863989e-06,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post"
        },
        "bins": {
            "count": 230,
            "value": "ratio",
            "tree": {
                "min_samples_leaf": 117,
                "min_impurity_decrease": 1.2301905954129383e-05
            },
            "subsample": null
        }
    },
    "n_parameters": 4680766,
    "epoch_size": 308,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -3.21277308654377,
                    "pretrain_loss": 1.156714528799057,
                    "pretrain_component": 0.46819743514060974,
                    "supervised_component": 0.6885170936584473,
                    "features_accuracy": [
                        0.6392874717712402,
                        0.721856415271759,
                        0.6652774214744568,
                        0.6835915446281433,
                        0.7445476651191711,
                        0.6887933015823364,
                        0.6563138365745544,
                        0.6847333908081055,
                        0.7424479126930237,
                        0.6922696232795715,
                        0.9908144474029541,
                        0.6463416218757629,
                        0.6640403866767883,
                        0.6818216443061829,
                        0.6921364068984985,
                        0.673092782497406,
                        0.6716654896736145,
                        0.6660006046295166,
                        0.6434869766235352,
                        0.776817798614502,
                        0.6870551705360413,
                        0.6686776280403137,
                        0.6693754196166992,
                        0.6786434650421143,
                        0.6621436476707458,
                        0.63007652759552,
                        0.632671058177948,
                        0.6325695514678955,
                        0.6242150068283081,
                        0.9766554236412048,
                        0.866865873336792,
                        0.9903767108917236,
                        0.8463631868362427,
                        0.8443142175674438,
                        0.8396389484405518,
                        0.8449612855911255,
                        0.8470419645309448,
                        0.8563163876533508,
                        0.8565194010734558,
                        0.8587586879730225,
                        0.8594881892204285,
                        0.8473972082138062,
                        0.6646557450294495,
                        0.8380593657493591,
                        0.8490338921546936,
                        0.854793906211853,
                        0.6786688566207886,
                        0.6876070499420166,
                        0.679106593132019,
                        0.9949694871902466,
                        0.5993478894233704
                    ]
                },
                "val": {
                    "score": -5.242436921825066,
                    "pretrain_loss": 1.1125045120716095,
                    "pretrain_component": 0.46858641505241394,
                    "supervised_component": 0.6439180970191956,
                    "features_accuracy": [
                        0.6388804316520691,
                        0.7215799689292908,
                        0.6639792919158936,
                        0.6772639751434326,
                        0.7410506010055542,
                        0.6857823729515076,
                        0.6527228355407715,
                        0.6830949783325195,
                        0.7429773807525635,
                        0.6872020959854126,
                        0.9900111556053162,
                        0.6486157178878784,
                        0.6642835140228271,
                        0.6878612637519836,
                        0.696075439453125,
                        0.6743230819702148,
                        0.6731568574905396,
                        0.6606834530830383,
                        0.6490721106529236,
                        0.777912974357605,
                        0.6857823729515076,
                        0.6700131893157959,
                        0.6669201850891113,
                        0.6787850856781006,
                        0.6690497994422913,
                        0.6268633604049683,
                        0.6351282596588135,
                        0.6326944231987,
                        0.6194604635238647,
                        0.9761180281639099,
                        0.8631477355957031,
                        0.9894533753395081,
                        0.8436771035194397,
                        0.8461109399795532,
                        0.8396714329719543,
                        0.8486461639404297,
                        0.8483926057815552,
                        0.8518405556678772,
                        0.8565053939819336,
                        0.8586350083351135,
                        0.8574180603027344,
                        0.8457559943199158,
                        0.66651451587677,
                        0.8381502628326416,
                        0.8526011109352112,
                        0.8547307252883911,
                        0.6711793541908264,
                        0.6813710331916809,
                        0.6855288147926331,
                        0.9940674901008606,
                        0.6023222804069519
                    ]
                },
                "test": {
                    "score": -5.464509137086488,
                    "pretrain_loss": 1.1296285092830658,
                    "pretrain_component": 0.467692106962204,
                    "supervised_component": 0.6619364023208618,
                    "features_accuracy": [
                        0.6427484750747681,
                        0.7216024398803711,
                        0.6717545390129089,
                        0.6799695491790771,
                        0.7411764860153198,
                        0.6835192441940308,
                        0.6570993661880493,
                        0.6851419806480408,
                        0.7440162301063538,
                        0.6886916756629944,
                        0.9916836023330688,
                        0.6434584259986877,
                        0.6622210741043091,
                        0.6806288361549377,
                        0.6907200813293457,
                        0.6722109317779541,
                        0.670537531375885,
                        0.6634381413459778,
                        0.6435598134994507,
                        0.7803245186805725,
                        0.6923428177833557,
                        0.6735801100730896,
                        0.6672921180725098,
                        0.6781440377235413,
                        0.6597363352775574,
                        0.6245436072349548,
                        0.6367647051811218,
                        0.6315922737121582,
                        0.6185598373413086,
                        0.9774847626686096,
                        0.8656693696975708,
                        0.9904665350914001,
                        0.8467038869857788,
                        0.8436612486839294,
                        0.8380324840545654,
                        0.8475659489631653,
                        0.847819447517395,
                        0.8569979667663574,
                        0.8579614758491516,
                        0.8617140054702759,
                        0.861663281917572,
                        0.8483772873878479,
                        0.6696754693984985,
                        0.8363083004951477,
                        0.8490872383117676,
                        0.8541582226753235,
                        0.683874249458313,
                        0.6875760555267334,
                        0.6771298050880432,
                        0.9951825737953186,
                        0.5984280109405518
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -3.209024223672219,
                    "pretrain_loss": 1.1056835055351257,
                    "pretrain_component": 0.43289732933044434,
                    "supervised_component": 0.6727861762046814,
                    "features_accuracy": [
                        0.6407782435417175,
                        0.7401768565177917,
                        0.739872395992279,
                        0.7500031590461731,
                        0.7958614230155945,
                        0.7702457904815674,
                        0.715848982334137,
                        0.7523820400238037,
                        0.7882617115974426,
                        0.7745721340179443,
                        0.9904147386550903,
                        0.6681510806083679,
                        0.7141425609588623,
                        0.7388446927070618,
                        0.7445095777511597,
                        0.7324185967445374,
                        0.6999391317367554,
                        0.7008208632469177,
                        0.6586483120918274,
                        0.81416916847229,
                        0.7800593972206116,
                        0.6825892329216003,
                        0.6789669990539551,
                        0.6958791613578796,
                        0.6853233575820923,
                        0.6720080375671387,
                        0.6321825981140137,
                        0.63407301902771,
                        0.6442609429359436,
                        0.978996217250824,
                        0.8752331733703613,
                        0.9908714890480042,
                        0.8560372591018677,
                        0.852998673915863,
                        0.8486786484718323,
                        0.856728732585907,
                        0.8627678751945496,
                        0.8653116822242737,
                        0.8625141382217407,
                        0.8688831329345703,
                        0.8655654191970825,
                        0.8589553236961365,
                        0.7080907225608826,
                        0.8495794534683228,
                        0.8607886433601379,
                        0.8645567893981934,
                        0.7532638311386108,
                        0.7272231578826904,
                        0.7406145930290222,
                        0.9951153993606567,
                        0.5995128154754639
                    ]
                },
                "val": {
                    "score": -5.2474190710932715,
                    "pretrain_loss": 1.0706659257411957,
                    "pretrain_component": 0.43363526463508606,
                    "supervised_component": 0.6370306611061096,
                    "features_accuracy": [
                        0.6400973200798035,
                        0.7405942678451538,
                        0.732785701751709,
                        0.7456647157669067,
                        0.7955582141876221,
                        0.7684818506240845,
                        0.7129094004631042,
                        0.7494168877601624,
                        0.789879322052002,
                        0.7724875807762146,
                        0.9903660416603088,
                        0.6617990136146545,
                        0.7138727903366089,
                        0.7393265962600708,
                        0.7472365498542786,
                        0.7281208634376526,
                        0.6993712186813354,
                        0.6989148855209351,
                        0.66367506980896,
                        0.8144711256027222,
                        0.7758340835571289,
                        0.6827400922775269,
                        0.6765540838241577,
                        0.6962782740592957,
                        0.6921204328536987,
                        0.6718892455101013,
                        0.635381817817688,
                        0.6326944231987,
                        0.6428353786468506,
                        0.9785518646240234,
                        0.8724266886711121,
                        0.9896562099456787,
                        0.85123211145401,
                        0.8555927276611328,
                        0.8515870571136475,
                        0.8591420650482178,
                        0.861829400062561,
                        0.8623364567756653,
                        0.8616265654563904,
                        0.8674576282501221,
                        0.8652773499488831,
                        0.856201171875,
                        0.7117938995361328,
                        0.8511306643486023,
                        0.8654801249504089,
                        0.8641618490219116,
                        0.7490619421005249,
                        0.7213771343231201,
                        0.7431294918060303,
                        0.9947266578674316,
                        0.6060743927955627
                    ]
                },
                "test": {
                    "score": -5.479905760610138,
                    "pretrain_loss": 1.0861260890960693,
                    "pretrain_component": 0.4325324296951294,
                    "supervised_component": 0.6535936594009399,
                    "features_accuracy": [
                        0.6435598134994507,
                        0.7424949407577515,
                        0.7390973567962646,
                        0.7503042817115784,
                        0.7947261929512024,
                        0.7662779092788696,
                        0.7148579955101013,
                        0.7479208707809448,
                        0.7880831956863403,
                        0.7778904438018799,
                        0.9918864369392395,
                        0.6654158234596252,
                        0.7130831480026245,
                        0.7350912690162659,
                        0.7514199018478394,
                        0.7283468842506409,
                        0.6981744170188904,
                        0.7015720009803772,
                        0.6590771079063416,
                        0.8140973448753357,
                        0.7793610692024231,
                        0.6859533786773682,
                        0.6746450066566467,
                        0.6954361200332642,
                        0.6797160506248474,
                        0.6708924770355225,
                        0.6368661522865295,
                        0.6315922737121582,
                        0.6425456404685974,
                        0.979411780834198,
                        0.8740872144699097,
                        0.9906693696975708,
                        0.8573022484779358,
                        0.8533975481987,
                        0.847819447517395,
                        0.8574036359786987,
                        0.8608519434928894,
                        0.8676977753639221,
                        0.8617647290229797,
                        0.8693205118179321,
                        0.8702839612960815,
                        0.8582656979560852,
                        0.7090770602226257,
                        0.8508113622665405,
                        0.8595334887504578,
                        0.8610547780990601,
                        0.7531440258026123,
                        0.724442183971405,
                        0.7353448271751404,
                        0.9956389665603638,
                        0.600557804107666
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -3.9276666505293862,
                    "pretrain_loss": 1.070899873971939,
                    "pretrain_component": 0.4129815995693207,
                    "supervised_component": 0.6579182744026184,
                    "features_accuracy": [
                        0.6511881947517395,
                        0.7541329264640808,
                        0.7609713673591614,
                        0.7911861538887024,
                        0.815704345703125,
                        0.8000989556312561,
                        0.7562960982322693,
                        0.7845950722694397,
                        0.8206080198287964,
                        0.8026300668716431,
                        0.9918864965438843,
                        0.6776285171508789,
                        0.7548116445541382,
                        0.7914018630981445,
                        0.7828125357627869,
                        0.7924739122390747,
                        0.7491721510887146,
                        0.7243685126304626,
                        0.6656897664070129,
                        0.8328829407691956,
                        0.8051358461380005,
                        0.6925234198570251,
                        0.6842893362045288,
                        0.7007447481155396,
                        0.6969195604324341,
                        0.6906901001930237,
                        0.6332420110702515,
                        0.6368959546089172,
                        0.6472614407539368,
                        0.9801824688911438,
                        0.8803842067718506,
                        0.9920387268066406,
                        0.8594247698783875,
                        0.859056830406189,
                        0.8534744381904602,
                        0.8619304895401001,
                        0.8622350096702576,
                        0.86679607629776,
                        0.8651530742645264,
                        0.8712239861488342,
                        0.8700059652328491,
                        0.8615055084228516,
                        0.7450805306434631,
                        0.854590892791748,
                        0.8634910583496094,
                        0.8669165968894958,
                        0.7885789275169373,
                        0.7690024375915527,
                        0.7907420992851257,
                        0.9951725006103516,
                        0.6098529696464539
                    ]
                },
                "val": {
                    "score": -5.301413314538915,
                    "pretrain_loss": 1.032328188419342,
                    "pretrain_component": 0.41338467597961426,
                    "supervised_component": 0.6189435124397278,
                    "features_accuracy": [
                        0.6492748856544495,
                        0.7540817260742188,
                        0.7527633905410767,
                        0.786329984664917,
                        0.813862681388855,
                        0.8002230525016785,
                        0.7526620030403137,
                        0.7842510938644409,
                        0.8192880749702454,
                        0.8024033904075623,
                        0.9917858242988586,
                        0.6705709099769592,
                        0.7508873343467712,
                        0.7881553173065186,
                        0.7866342067718506,
                        0.794138491153717,
                        0.746830940246582,
                        0.7250785827636719,
                        0.6720413565635681,
                        0.8317107558250427,
                        0.804685115814209,
                        0.694047212600708,
                        0.6805090308189392,
                        0.7025149464607239,
                        0.7034276127815247,
                        0.6879626512527466,
                        0.6356860399246216,
                        0.6326944231987,
                        0.6493763327598572,
                        0.9794138073921204,
                        0.8788155317306519,
                        0.9912280440330505,
                        0.8589392304420471,
                        0.8603589534759521,
                        0.8537673354148865,
                        0.8620322346687317,
                        0.8644153475761414,
                        0.8626914024353027,
                        0.8615251779556274,
                        0.8692322969436646,
                        0.8707027435302734,
                        0.8610181212425232,
                        0.7505831122398376,
                        0.8579758405685425,
                        0.868826687335968,
                        0.866798460483551,
                        0.7934286594390869,
                        0.76939457654953,
                        0.7944427132606506,
                        0.9944731593132019,
                        0.6126660704612732
                    ]
                },
                "test": {
                    "score": -5.562561379296191,
                    "pretrain_loss": 1.0538046061992645,
                    "pretrain_component": 0.4127996861934662,
                    "supervised_component": 0.6410049200057983,
                    "features_accuracy": [
                        0.6536511182785034,
                        0.7551217079162598,
                        0.7613590359687805,
                        0.7891480922698975,
                        0.8153144121170044,
                        0.7963995933532715,
                        0.7546145915985107,
                        0.7806288003921509,
                        0.820588231086731,
                        0.8039553761482239,
                        0.9921399354934692,
                        0.6768762469291687,
                        0.7528904676437378,
                        0.7911764979362488,
                        0.787778913974762,
                        0.789401650428772,
                        0.7451825737953186,
                        0.7223631143569946,
                        0.6637930870056152,
                        0.8312373161315918,
                        0.8053752779960632,
                        0.6984279751777649,
                        0.6776876449584961,
                        0.7018762826919556,
                        0.691734254360199,
                        0.6859026551246643,
                        0.6379817724227905,
                        0.6315922737121582,
                        0.6473124027252197,
                        0.981135904788971,
                        0.8795639276504517,
                        0.9914807081222534,
                        0.8615618944168091,
                        0.8603955507278442,
                        0.8517241477966309,
                        0.861156165599823,
                        0.864503026008606,
                        0.8686612844467163,
                        0.8624239563941956,
                        0.8726673722267151,
                        0.8745943307876587,
                        0.8636916875839233,
                        0.7459939122200012,
                        0.8573022484779358,
                        0.862170398235321,
                        0.864503026008606,
                        0.7915314435958862,
                        0.7689655423164368,
                        0.7863590121269226,
                        0.995537519454956,
                        0.6062373518943787
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -3.3389523251614652,
                    "pretrain_loss": 1.0542907416820526,
                    "pretrain_component": 0.40033790469169617,
                    "supervised_component": 0.6539528369903564,
                    "features_accuracy": [
                        0.6648143529891968,
                        0.7608761787414551,
                        0.7734429836273193,
                        0.8128497004508972,
                        0.8272561430931091,
                        0.8096715211868286,
                        0.7767924070358276,
                        0.8079079985618591,
                        0.8362387418746948,
                        0.8164782524108887,
                        0.9921466112136841,
                        0.6910770535469055,
                        0.7924929261207581,
                        0.8127037882804871,
                        0.8051485419273376,
                        0.8134142756462097,
                        0.7780421376228333,
                        0.7649932503700256,
                        0.6713990569114685,
                        0.8425887227058411,
                        0.816973090171814,
                        0.7081858515739441,
                        0.6864461898803711,
                        0.708725094795227,
                        0.7064921259880066,
                        0.6961963772773743,
                        0.6329120993614197,
                        0.6307299137115479,
                        0.6513023376464844,
                        0.9803600907325745,
                        0.8834862112998962,
                        0.9922163486480713,
                        0.8619812726974487,
                        0.8606300950050354,
                        0.8545211553573608,
                        0.8618163466453552,
                        0.8644235730171204,
                        0.8723721504211426,
                        0.8678554892539978,
                        0.8723911643028259,
                        0.8723848462104797,
                        0.8626283407211304,
                        0.7589540481567383,
                        0.856132447719574,
                        0.865134060382843,
                        0.8636559844017029,
                        0.8122280240058899,
                        0.7936855554580688,
                        0.8154188990592957,
                        0.9959020018577576,
                        0.6217917203903198
                    ]
                },
                "val": {
                    "score": -5.247069015801324,
                    "pretrain_loss": 1.0163633227348328,
                    "pretrain_component": 0.4008947014808655,
                    "supervised_component": 0.6154686212539673,
                    "features_accuracy": [
                        0.6632187366485596,
                        0.7619916796684265,
                        0.7658959031105042,
                        0.8073217272758484,
                        0.822279691696167,
                        0.8092485070228577,
                        0.7748706936836243,
                        0.8101105093955994,
                        0.834398090839386,
                        0.8135077357292175,
                        0.9916336536407471,
                        0.6829428672790527,
                        0.7908933758735657,
                        0.8113274574279785,
                        0.8064597845077515,
                        0.8183754086494446,
                        0.7774059176445007,
                        0.7632592916488647,
                        0.6756414175033569,
                        0.8400770425796509,
                        0.8145725131034851,
                        0.7120981216430664,
                        0.6851232051849365,
                        0.7103234529495239,
                        0.7065713405609131,
                        0.6925768256187439,
                        0.6374099850654602,
                        0.6326944231987,
                        0.6501368880271912,
                        0.9797687530517578,
                        0.8824155330657959,
                        0.9913801550865173,
                        0.8588378429412842,
                        0.8639082908630371,
                        0.8552377820014954,
                        0.8634519577026367,
                        0.8659871816635132,
                        0.8684717416763306,
                        0.8659365177154541,
                        0.8712605237960815,
                        0.8707027435302734,
                        0.861930787563324,
                        0.7649832367897034,
                        0.858989953994751,
                        0.8685224652290344,
                        0.8632998466491699,
                        0.816702127456665,
                        0.7922117114067078,
                        0.813862681388855,
                        0.9949294924736023,
                        0.6217929124832153
                    ]
                },
                "test": {
                    "score": -5.448045141250509,
                    "pretrain_loss": 1.038238525390625,
                    "pretrain_component": 0.4004260301589966,
                    "supervised_component": 0.6378124952316284,
                    "features_accuracy": [
                        0.6671399474143982,
                        0.7612069249153137,
                        0.7720588445663452,
                        0.8079614639282227,
                        0.8254056572914124,
                        0.807251513004303,
                        0.7721095085144043,
                        0.80552738904953,
                        0.8360040783882141,
                        0.813843846321106,
                        0.992241382598877,
                        0.683874249458313,
                        0.7891480922698975,
                        0.8130831718444824,
                        0.8099391460418701,
                        0.8130831718444824,
                        0.7790060639381409,
                        0.7612069249153137,
                        0.6697261929512024,
                        0.841683566570282,
                        0.8184584379196167,
                        0.7124746441841125,
                        0.6833164095878601,
                        0.7088742256164551,
                        0.6989858150482178,
                        0.6943204998970032,
                        0.6391480565071106,
                        0.6315922737121582,
                        0.6479716300964355,
                        0.9812373518943787,
                        0.8828093409538269,
                        0.9917342662811279,
                        0.8634381294250488,
                        0.862271785736084,
                        0.8538539409637451,
                        0.8630831837654114,
                        0.8664807081222534,
                        0.8745943307876587,
                        0.8670385479927063,
                        0.8739351034164429,
                        0.8752028346061707,
                        0.8640973567962646,
                        0.7569980025291443,
                        0.8582150340080261,
                        0.8632352948188782,
                        0.863894522190094,
                        0.8132352828979492,
                        0.7910750508308411,
                        0.8079107403755188,
                        0.9959431886672974,
                        0.6171399354934692
                    ]
                }
            }
        },
        "train": {
            "score": -3.21277308654377
        },
        "val": {
            "score": -5.242436921825066
        },
        "test": {
            "score": -5.464509137086488
        }
    },
    "best_iteration": 10000,
    "time": "1:21:39"
}
