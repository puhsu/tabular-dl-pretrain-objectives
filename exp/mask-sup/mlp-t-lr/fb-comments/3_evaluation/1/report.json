{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised_fast___75be894165d6455980c5f3402079ee90.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0,1",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                },
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 1,
        "data": {
            "path": "data/fb-comments",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512
                ],
                "dropout": 0.2888693523114936
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear",
                "relu"
            ],
            "d_num_embedding": 119,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 512,
            "lr": 6.783213831164318e-05,
            "weight_decay": 8.11888266863989e-06,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 1024
        },
        "pretrain": {
            "corrupt_probability": 0.6419817966690281,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 6.783213831164318e-05,
            "weight_decay": 8.11888266863989e-06,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post"
        },
        "bins": {
            "count": 230,
            "value": "ratio",
            "tree": {
                "min_samples_leaf": 117,
                "min_impurity_decrease": 1.2301905954129383e-05
            },
            "subsample": null
        }
    },
    "n_parameters": 4680766,
    "epoch_size": 308,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -2.9477878556655264,
                    "pretrain_loss": 1.1469155251979828,
                    "pretrain_component": 0.46570852398872375,
                    "supervised_component": 0.681207001209259,
                    "features_accuracy": [
                        0.6393889784812927,
                        0.7172255516052246,
                        0.6645923256874084,
                        0.6919651627540588,
                        0.7221736311912537,
                        0.685767412185669,
                        0.6679100394248962,
                        0.6906774044036865,
                        0.7429553866386414,
                        0.6741141080856323,
                        0.9903386235237122,
                        0.6477689743041992,
                        0.6731435656547546,
                        0.6884063482284546,
                        0.6810667514801025,
                        0.6831918954849243,
                        0.6622007489204407,
                        0.669299304485321,
                        0.643410861492157,
                        0.7673150300979614,
                        0.6863129734992981,
                        0.6656960844993591,
                        0.670961320400238,
                        0.6855263710021973,
                        0.6702698469161987,
                        0.6463416218757629,
                        0.6328486800193787,
                        0.6314594149589539,
                        0.6336796879768372,
                        0.9762684106826782,
                        0.8674494624137878,
                        0.9904528260231018,
                        0.8458747267723083,
                        0.8444030284881592,
                        0.8372917771339417,
                        0.846318781375885,
                        0.8513810038566589,
                        0.857388436794281,
                        0.8567604422569275,
                        0.860122561454773,
                        0.8591139316558838,
                        0.8478095531463623,
                        0.6599297523498535,
                        0.8415420055389404,
                        0.846585214138031,
                        0.8461031317710876,
                        0.688381016254425,
                        0.6811492443084717,
                        0.6872137784957886,
                        0.9951027035713196,
                        0.5956749320030212
                    ]
                },
                "val": {
                    "score": -5.219697235918411,
                    "pretrain_loss": 1.091767817735672,
                    "pretrain_component": 0.4658375680446625,
                    "supervised_component": 0.6259302496910095,
                    "features_accuracy": [
                        0.6376634836196899,
                        0.7191967964172363,
                        0.6641821265220642,
                        0.6919176578521729,
                        0.7227968573570251,
                        0.6815738677978516,
                        0.6600243449211121,
                        0.6917148232460022,
                        0.7458675503730774,
                        0.6788358092308044,
                        0.9898083209991455,
                        0.6431396007537842,
                        0.6752357482910156,
                        0.6864922046661377,
                        0.6821315884590149,
                        0.6812189221382141,
                        0.66154545545578,
                        0.6736131906509399,
                        0.6433931589126587,
                        0.7671635746955872,
                        0.6805597543716431,
                        0.6678328514099121,
                        0.669303297996521,
                        0.6901429891586304,
                        0.6681877970695496,
                        0.6417198777198792,
                        0.6333028674125671,
                        0.6259506940841675,
                        0.6376634836196899,
                        0.9766757488250732,
                        0.8630970120429993,
                        0.9898589849472046,
                        0.8466686606407166,
                        0.8475813865661621,
                        0.8351079821586609,
                        0.8474799394607544,
                        0.8503194451332092,
                        0.8556433916091919,
                        0.857620894908905,
                        0.8590913414955139,
                        0.857570230960846,
                        0.8470743298530579,
                        0.6575397849082947,
                        0.8425108790397644,
                        0.8483419418334961,
                        0.8485954403877258,
                        0.6925768256187439,
                        0.6823851466178894,
                        0.6845147609710693,
                        0.994422435760498,
                        0.5937024354934692
                    ]
                },
                "test": {
                    "score": -5.500940855462796,
                    "pretrain_loss": 1.1424450278282166,
                    "pretrain_component": 0.4656030535697937,
                    "supervised_component": 0.6768419742584229,
                    "features_accuracy": [
                        0.6390466690063477,
                        0.71769779920578,
                        0.6658214926719666,
                        0.6922920942306519,
                        0.7190669178962708,
                        0.6855983734130859,
                        0.6680527329444885,
                        0.6867647171020508,
                        0.7471602559089661,
                        0.6815415620803833,
                        0.9910750389099121,
                        0.6604969501495361,
                        0.6796653270721436,
                        0.6846348643302917,
                        0.681643009185791,
                        0.6861562132835388,
                        0.6601420044898987,
                        0.668306291103363,
                        0.6408215165138245,
                        0.7721602320671082,
                        0.6839249730110168,
                        0.6669878363609314,
                        0.668914794921875,
                        0.6885395646095276,
                        0.6727180480957031,
                        0.648326575756073,
                        0.6398580074310303,
                        0.6304766535758972,
                        0.6323022246360779,
                        0.9775354862213135,
                        0.8668864369392395,
                        0.9908722043037415,
                        0.8432048559188843,
                        0.8437626957893372,
                        0.8365111351013184,
                        0.8465009927749634,
                        0.8497464656829834,
                        0.8615111708641052,
                        0.8570994138717651,
                        0.8606997728347778,
                        0.8582656979560852,
                        0.8457403779029846,
                        0.6567951440811157,
                        0.841582179069519,
                        0.8458924889564514,
                        0.8422414064407349,
                        0.6955375075340271,
                        0.6846348643302917,
                        0.6853955388069153,
                        0.9959939122200012,
                        0.5960953235626221
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -3.444044603502234,
                    "pretrain_loss": 1.0961698591709137,
                    "pretrain_component": 0.4302142560482025,
                    "supervised_component": 0.6659556031227112,
                    "features_accuracy": [
                        0.6434552669525146,
                        0.7344168424606323,
                        0.7212410569190979,
                        0.7358885407447815,
                        0.8017356395721436,
                        0.7539235353469849,
                        0.7093657851219177,
                        0.7695479393005371,
                        0.7962610721588135,
                        0.7470216751098633,
                        0.9911125898361206,
                        0.6707583069801331,
                        0.7327231168746948,
                        0.7607429623603821,
                        0.7447633147239685,
                        0.7376140356063843,
                        0.7084142565727234,
                        0.7388700842857361,
                        0.6560537815093994,
                        0.8045077919960022,
                        0.771952211856842,
                        0.6825194358825684,
                        0.6771971583366394,
                        0.694305956363678,
                        0.6840102076530457,
                        0.6751671433448792,
                        0.6315165162086487,
                        0.6305649876594543,
                        0.6456628441810608,
                        0.9785204529762268,
                        0.880200207233429,
                        0.9911506175994873,
                        0.8589807152748108,
                        0.8542420268058777,
                        0.8515650033950806,
                        0.8597736954689026,
                        0.8603636622428894,
                        0.866929292678833,
                        0.8683058619499207,
                        0.8711287975311279,
                        0.8709765672683716,
                        0.8635861873626709,
                        0.7155952453613281,
                        0.8546162843704224,
                        0.8647471070289612,
                        0.8660284876823425,
                        0.7663507461547852,
                        0.7566132545471191,
                        0.7463492751121521,
                        0.9950265884399414,
                        0.6021708250045776
                    ]
                },
                "val": {
                    "score": -5.234448371733863,
                    "pretrain_loss": 1.050345927476883,
                    "pretrain_component": 0.4304995834827423,
                    "supervised_component": 0.6198463439941406,
                    "features_accuracy": [
                        0.641871988773346,
                        0.7348645925521851,
                        0.7182334065437317,
                        0.7322279214859009,
                        0.8036710023880005,
                        0.7459689378738403,
                        0.7071797847747803,
                        0.7723354697227478,
                        0.7945441603660583,
                        0.7451576590538025,
                        0.9907717108726501,
                        0.6621538996696472,
                        0.7348138689994812,
                        0.7613325119018555,
                        0.7443971037864685,
                        0.7353209257125854,
                        0.7042388916015625,
                        0.7402899861335754,
                        0.654396116733551,
                        0.8054963946342468,
                        0.7759861946105957,
                        0.6843119263648987,
                        0.6769596934318542,
                        0.6995233297348022,
                        0.6817767024040222,
                        0.6709258556365967,
                        0.6338606476783752,
                        0.6259506940841675,
                        0.6456748843193054,
                        0.9785518646240234,
                        0.8787140846252441,
                        0.990163266658783,
                        0.8574180603027344,
                        0.8563025593757629,
                        0.8508771657943726,
                        0.8579758405685425,
                        0.8592434525489807,
                        0.8665956854820251,
                        0.868218183517456,
                        0.8693337440490723,
                        0.8691815733909607,
                        0.8633505702018738,
                        0.7118446230888367,
                        0.8546800017356873,
                        0.8675083518028259,
                        0.8688773512840271,
                        0.7664029598236084,
                        0.7551465034484863,
                        0.7481492757797241,
                        0.9942703247070312,
                        0.5964912176132202
                    ]
                },
                "test": {
                    "score": -5.505703159900728,
                    "pretrain_loss": 1.1059803068637848,
                    "pretrain_component": 0.43095383048057556,
                    "supervised_component": 0.6750264763832092,
                    "features_accuracy": [
                        0.6427484750747681,
                        0.7333164215087891,
                        0.7187626957893372,
                        0.7311866283416748,
                        0.7978194952011108,
                        0.7518762946128845,
                        0.707200825214386,
                        0.7668356895446777,
                        0.7956896424293518,
                        0.7442697882652283,
                        0.9917342662811279,
                        0.6792596578598022,
                        0.7329107522964478,
                        0.7592799067497253,
                        0.7455882430076599,
                        0.732758641242981,
                        0.7057809233665466,
                        0.729411780834198,
                        0.6538032293319702,
                        0.8066937327384949,
                        0.7740872502326965,
                        0.6876775026321411,
                        0.6778397560119629,
                        0.6950304508209229,
                        0.683874249458313,
                        0.6770284175872803,
                        0.6397566199302673,
                        0.6304766535758972,
                        0.64335697889328,
                        0.9791582226753235,
                        0.8802231550216675,
                        0.9907708168029785,
                        0.8572515249252319,
                        0.8526369333267212,
                        0.8491886258125305,
                        0.8581643104553223,
                        0.85780930519104,
                        0.8676470518112183,
                        0.8685091137886047,
                        0.8707403540611267,
                        0.8684584498405457,
                        0.85943204164505,
                        0.7204360961914062,
                        0.852281928062439,
                        0.8635902404785156,
                        0.8575558066368103,
                        0.7662779092788696,
                        0.7558316588401794,
                        0.7411764860153198,
                        0.9956896305084229,
                        0.5984280109405518
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -3.1310284229842584,
                    "pretrain_loss": 1.0744897425174713,
                    "pretrain_component": 0.4112500250339508,
                    "supervised_component": 0.6632397174835205,
                    "features_accuracy": [
                        0.6556921601295471,
                        0.7476116418838501,
                        0.7539045214653015,
                        0.7815184593200684,
                        0.8256321549415588,
                        0.7818546295166016,
                        0.7423527240753174,
                        0.8012217879295349,
                        0.8263046145439148,
                        0.8046663999557495,
                        0.9920704364776611,
                        0.683635950088501,
                        0.7581547498703003,
                        0.8011900782585144,
                        0.7782070636749268,
                        0.7905581593513489,
                        0.7408556342124939,
                        0.7592712640762329,
                        0.6628478169441223,
                        0.8280490636825562,
                        0.8116380572319031,
                        0.7000025510787964,
                        0.6788147687911987,
                        0.7040751576423645,
                        0.6969766616821289,
                        0.6899605393409729,
                        0.6364455223083496,
                        0.6316307187080383,
                        0.6493738889694214,
                        0.9800111651420593,
                        0.8832705616950989,
                        0.9923622608184814,
                        0.8625331521034241,
                        0.8580101132392883,
                        0.8525482416152954,
                        0.8632880449295044,
                        0.8616450428962708,
                        0.8705515265464783,
                        0.8703358769416809,
                        0.8748905658721924,
                        0.8735139966011047,
                        0.8617021441459656,
                        0.7668392062187195,
                        0.8539502024650574,
                        0.86546391248703,
                        0.8652989864349365,
                        0.799286961555481,
                        0.7826666235923767,
                        0.7858765125274658,
                        0.9951471090316772,
                        0.5991068482398987
                    ]
                },
                "val": {
                    "score": -5.234559641241224,
                    "pretrain_loss": 1.015995740890503,
                    "pretrain_component": 0.41095083951950073,
                    "supervised_component": 0.6050449013710022,
                    "features_accuracy": [
                        0.6507960557937622,
                        0.7470844388008118,
                        0.7529662251472473,
                        0.7852144837379456,
                        0.8238515257835388,
                        0.779991865158081,
                        0.7381097078323364,
                        0.8011864423751831,
                        0.8284656405448914,
                        0.8034681677818298,
                        0.9912280440330505,
                        0.6809147000312805,
                        0.7591015100479126,
                        0.8008315563201904,
                        0.7814115881919861,
                        0.7889159321784973,
                        0.736892819404602,
                        0.7643240690231323,
                        0.6666666269302368,
                        0.8289726972579956,
                        0.8134063482284546,
                        0.6995233297348022,
                        0.6833992600440979,
                        0.7087008953094482,
                        0.6973937749862671,
                        0.6866950392723083,
                        0.6337592601776123,
                        0.6259506940841675,
                        0.6525707244873047,
                        0.9802758097648621,
                        0.879525363445282,
                        0.991582989692688,
                        0.8627927899360657,
                        0.8604604005813599,
                        0.8524997234344482,
                        0.8616772890090942,
                        0.8611195087432861,
                        0.8690294623374939,
                        0.8699928522109985,
                        0.8724266886711121,
                        0.8699421882629395,
                        0.8620322346687317,
                        0.758797287940979,
                        0.8572152853012085,
                        0.8680154085159302,
                        0.8697900772094727,
                        0.7994117736816406,
                        0.7824257016181946,
                        0.7859243154525757,
                        0.9944731593132019,
                        0.5962883830070496
                    ]
                },
                "test": {
                    "score": -5.479597374457758,
                    "pretrain_loss": 1.0770640969276428,
                    "pretrain_component": 0.4121969938278198,
                    "supervised_component": 0.664867103099823,
                    "features_accuracy": [
                        0.6518255472183228,
                        0.7463995814323425,
                        0.7544117569923401,
                        0.7764706015586853,
                        0.8231237530708313,
                        0.7790060639381409,
                        0.7380324602127075,
                        0.7995436191558838,
                        0.8251014351844788,
                        0.7990872263908386,
                        0.9925963282585144,
                        0.6914300322532654,
                        0.7540060877799988,
                        0.7981744408607483,
                        0.7796146273612976,
                        0.7880324721336365,
                        0.7369675636291504,
                        0.7567444443702698,
                        0.6656186580657959,
                        0.8256592154502869,
                        0.8101927042007446,
                        0.7012170553207397,
                        0.6767748594284058,
                        0.7024340629577637,
                        0.6962981820106506,
                        0.6869675517082214,
                        0.6401622891426086,
                        0.6304766535758972,
                        0.645588219165802,
                        0.9808316230773926,
                        0.882758617401123,
                        0.9920892715454102,
                        0.862271785736084,
                        0.8560851812362671,
                        0.8492393493652344,
                        0.8612068891525269,
                        0.8602941036224365,
                        0.8728702068328857,
                        0.8709431886672974,
                        0.8723630905151367,
                        0.8719574213027954,
                        0.8579614758491516,
                        0.7671399712562561,
                        0.8532454371452332,
                        0.8639959692955017,
                        0.8581135869026184,
                        0.7996450066566467,
                        0.7820993661880493,
                        0.7803752422332764,
                        0.9957910776138306,
                        0.5985293984413147
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -3.429506267944267,
                    "pretrain_loss": 1.0564324855804443,
                    "pretrain_component": 0.3993048667907715,
                    "supervised_component": 0.6571276187896729,
                    "features_accuracy": [
                        0.6635265946388245,
                        0.7566132545471191,
                        0.7851153016090393,
                        0.8094431757926941,
                        0.8326736092567444,
                        0.8017229437828064,
                        0.7840051651000977,
                        0.8122153282165527,
                        0.837716817855835,
                        0.8261269927024841,
                        0.9926984906196594,
                        0.6847206950187683,
                        0.7844999432563782,
                        0.8189523220062256,
                        0.7964386940002441,
                        0.815177857875824,
                        0.753739595413208,
                        0.7765576839447021,
                        0.6726043224334717,
                        0.8414151668548584,
                        0.826780378818512,
                        0.7076339721679688,
                        0.6851457357406616,
                        0.710856556892395,
                        0.7094165086746216,
                        0.6950608491897583,
                        0.6352465748786926,
                        0.6313325762748718,
                        0.6508519649505615,
                        0.9799858331680298,
                        0.8846027255058289,
                        0.9927175045013428,
                        0.8629010915756226,
                        0.8609979748725891,
                        0.854394257068634,
                        0.8643410801887512,
                        0.8628376722335815,
                        0.8715728521347046,
                        0.869193971157074,
                        0.8740151524543762,
                        0.8729875087738037,
                        0.8647217154502869,
                        0.7823430895805359,
                        0.8563354015350342,
                        0.8663520216941833,
                        0.8668087720870972,
                        0.8140803575515747,
                        0.7992933392524719,
                        0.7927974462509155,
                        0.9959591031074524,
                        0.6191717982292175
                    ]
                },
                "val": {
                    "score": -5.224767546698851,
                    "pretrain_loss": 1.0000684559345245,
                    "pretrain_component": 0.3996099531650543,
                    "supervised_component": 0.6004585027694702,
                    "features_accuracy": [
                        0.6580975651741028,
                        0.7557549476623535,
                        0.7833890914916992,
                        0.8120372891426086,
                        0.8342459797859192,
                        0.7964709401130676,
                        0.7862285375595093,
                        0.8111246228218079,
                        0.8398742079734802,
                        0.8246120810508728,
                        0.9922928214073181,
                        0.6775681972503662,
                        0.7867355942726135,
                        0.8194401860237122,
                        0.797028660774231,
                        0.8139640688896179,
                        0.7513943910598755,
                        0.7777608633041382,
                        0.6746780276298523,
                        0.845603883266449,
                        0.8299868106842041,
                        0.7061150074005127,
                        0.6839062571525574,
                        0.715951681137085,
                        0.7112361788749695,
                        0.6895852088928223,
                        0.6345198154449463,
                        0.6259506940841675,
                        0.6522665023803711,
                        0.9804279208183289,
                        0.881553590297699,
                        0.9921407103538513,
                        0.8631477355957031,
                        0.8642125129699707,
                        0.8550856709480286,
                        0.861829400062561,
                        0.8609167337417603,
                        0.8701956868171692,
                        0.8672547936439514,
                        0.8739478588104248,
                        0.8704492449760437,
                        0.8639082908630371,
                        0.7763918042182922,
                        0.8567589521408081,
                        0.8682689070701599,
                        0.870246410369873,
                        0.8150289058685303,
                        0.8000202775001526,
                        0.7924652695655823,
                        0.9950308799743652,
                        0.6132745146751404
                    ]
                },
                "test": {
                    "score": -5.495759756990786,
                    "pretrain_loss": 1.0604908764362335,
                    "pretrain_component": 0.4006078541278839,
                    "supervised_component": 0.6598830223083496,
                    "features_accuracy": [
                        0.6598377227783203,
                        0.754462480545044,
                        0.7804766893386841,
                        0.8054766654968262,
                        0.8304259777069092,
                        0.7985293865203857,
                        0.7807302474975586,
                        0.8112576007843018,
                        0.8362069129943848,
                        0.8248986005783081,
                        0.9933062791824341,
                        0.6916835904121399,
                        0.7779918909072876,
                        0.8163793087005615,
                        0.7949796915054321,
                        0.8113083243370056,
                        0.7589756846427917,
                        0.7722616791725159,
                        0.6758113503456116,
                        0.8409736156463623,
                        0.8253549933433533,
                        0.7070487141609192,
                        0.6834685802459717,
                        0.709432065486908,
                        0.7144016027450562,
                        0.6921906471252441,
                        0.6406693458557129,
                        0.6304766535758972,
                        0.6492393612861633,
                        0.9806287884712219,
                        0.8834178447723389,
                        0.9930020570755005,
                        0.862170398235321,
                        0.8602434396743774,
                        0.8513184785842896,
                        0.8619168400764465,
                        0.8622211217880249,
                        0.8721095323562622,
                        0.8690162301063538,
                        0.8724138140678406,
                        0.872261643409729,
                        0.8610040545463562,
                        0.7801724076271057,
                        0.8550710082054138,
                        0.8647058606147766,
                        0.8585699796676636,
                        0.8121196627616882,
                        0.7984279990196228,
                        0.7880831956863403,
                        0.9963995814323425,
                        0.6152129769325256
                    ]
                }
            }
        },
        "train": {
            "score": -2.9477878556655264
        },
        "val": {
            "score": -5.219697235918411
        },
        "test": {
            "score": -5.500940855462796
        }
    },
    "best_iteration": 10000,
    "time": "1:33:08"
}
