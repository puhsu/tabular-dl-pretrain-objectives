{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised___04cac639803e446394e10b5218fdc2e0.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 2,
        "data": {
            "path": "data/california",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512
                ],
                "dropout": 0.37606718574444314
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear",
                "relu"
            ],
            "d_num_embedding": 96,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.0006535464774213995,
            "weight_decay": 0.0001731058757629251,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.5636154322228324,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.0006535464774213995,
            "weight_decay": 0.0001731058757629251,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post",
            "supervised_weight": 0.5
        },
        "bins": {
            "count": 254,
            "value": "ratio",
            "tree": {
                "min_samples_leaf": 19,
                "min_impurity_decrease": 0.0033532643064219814
            },
            "subsample": null
        }
    },
    "epoch_size": 104,
    "n_parameters": 672521,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -0.36596844913603294,
                    "pretrain_loss": 1.4323081970214844,
                    "pretrain_component": 0.6620849370956421,
                    "supervised_component": 0.7702232599258423,
                    "features_accuracy": [
                        0.5869483351707458,
                        0.5705201029777527,
                        0.5976985692977905,
                        0.5769551396369934,
                        0.564842164516449,
                        0.562192440032959,
                        0.6592475175857544,
                        0.6665909886360168
                    ]
                },
                "val": {
                    "score": -0.4465283919263321,
                    "pretrain_loss": 1.4087705612182617,
                    "pretrain_component": 0.6624323129653931,
                    "supervised_component": 0.7463382482528687,
                    "features_accuracy": [
                        0.5988495349884033,
                        0.5834090113639832,
                        0.5870420932769775,
                        0.5773538947105408,
                        0.548592209815979,
                        0.578262209892273,
                        0.6557675004005432,
                        0.6460793018341064
                    ]
                },
                "test": {
                    "score": -0.43867092137057756,
                    "pretrain_loss": 1.3951186537742615,
                    "pretrain_component": 0.6623004078865051,
                    "supervised_component": 0.7328182458877563,
                    "features_accuracy": [
                        0.6015019416809082,
                        0.5591084957122803,
                        0.5935077667236328,
                        0.555232584476471,
                        0.5731589198112488,
                        0.5726743936538696,
                        0.6511628031730652,
                        0.6681201457977295
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -0.3457437650829322,
                    "pretrain_loss": 1.4039435386657715,
                    "pretrain_component": 0.6556711196899414,
                    "supervised_component": 0.7482724189758301,
                    "features_accuracy": [
                        0.6009539365768433,
                        0.5780907273292542,
                        0.605571985244751,
                        0.5730184316635132,
                        0.5719585418701172,
                        0.5740025639533997,
                        0.6711333394050598,
                        0.6712090373039246
                    ]
                },
                "val": {
                    "score": -0.43788414387266295,
                    "pretrain_loss": 1.3938125967979431,
                    "pretrain_component": 0.6573384404182434,
                    "supervised_component": 0.7364741563796997,
                    "features_accuracy": [
                        0.6006660461425781,
                        0.5909779071807861,
                        0.5930972099304199,
                        0.5800787210464478,
                        0.5501059889793396,
                        0.5821980237960815,
                        0.6666666865348816,
                        0.6494096517562866
                    ]
                },
                "test": {
                    "score": -0.4328772704052507,
                    "pretrain_loss": 1.3754721283912659,
                    "pretrain_component": 0.6570639610290527,
                    "supervised_component": 0.7184081673622131,
                    "features_accuracy": [
                        0.6070736646652222,
                        0.5695251822471619,
                        0.601259708404541,
                        0.5608042478561401,
                        0.5765503644943237,
                        0.5746123790740967,
                        0.6552810072898865,
                        0.6785368323326111
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -0.3373862733772729,
                    "pretrain_loss": 1.3960971236228943,
                    "pretrain_component": 0.6536976099014282,
                    "supervised_component": 0.7423995137214661,
                    "features_accuracy": [
                        0.6020138263702393,
                        0.5810432434082031,
                        0.6083731055259705,
                        0.5768794417381287,
                        0.5769551396369934,
                        0.5813460946083069,
                        0.6759785413742065,
                        0.6744644045829773
                    ]
                },
                "val": {
                    "score": -0.43384186734363256,
                    "pretrain_loss": 1.3911444544792175,
                    "pretrain_component": 0.6559371948242188,
                    "supervised_component": 0.7352072596549988,
                    "features_accuracy": [
                        0.6039963364601135,
                        0.583106279373169,
                        0.5988495349884033,
                        0.5812897086143494,
                        0.553436279296875,
                        0.583106279373169,
                        0.672419011592865,
                        0.6548592448234558
                    ]
                },
                "test": {
                    "score": -0.4285799805082011,
                    "pretrain_loss": 1.3691716194152832,
                    "pretrain_component": 0.6550204157829285,
                    "supervised_component": 0.7141512036323547,
                    "features_accuracy": [
                        0.6053779125213623,
                        0.5811530947685242,
                        0.597141444683075,
                        0.5608042478561401,
                        0.5741279125213623,
                        0.5741279125213623,
                        0.6676356792449951,
                        0.6775678396224976
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -0.31273651674343544,
                    "pretrain_loss": 1.4007298946380615,
                    "pretrain_component": 0.65087890625,
                    "supervised_component": 0.7498509883880615,
                    "features_accuracy": [
                        0.599439799785614,
                        0.5905064940452576,
                        0.603679358959198,
                        0.5809675455093384,
                        0.5757438540458679,
                        0.5886138677597046,
                        0.6778711676597595,
                        0.675599992275238
                    ]
                },
                "val": {
                    "score": -0.4322364848522074,
                    "pretrain_loss": 1.397401511669159,
                    "pretrain_component": 0.6548698544502258,
                    "supervised_component": 0.7425316572189331,
                    "features_accuracy": [
                        0.6018770933151245,
                        0.5849227905273438,
                        0.5979412794113159,
                        0.5767484307289124,
                        0.5561610460281372,
                        0.5837118029594421,
                        0.6663638949394226,
                        0.6533454656600952
                    ]
                },
                "test": {
                    "score": -0.43234106971181585,
                    "pretrain_loss": 1.3685824275016785,
                    "pretrain_component": 0.6532589197158813,
                    "supervised_component": 0.7153235077857971,
                    "features_accuracy": [
                        0.6053779125213623,
                        0.5746123790740967,
                        0.5915697813034058,
                        0.564437985420227,
                        0.5758236646652222,
                        0.5784883499145508,
                        0.6673933863639832,
                        0.6862887740135193
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": -0.3143999373413098,
                    "pretrain_loss": 1.388800859451294,
                    "pretrain_component": 0.6499903798103333,
                    "supervised_component": 0.7388104796409607,
                    "features_accuracy": [
                        0.6061776280403137,
                        0.5860398411750793,
                        0.6051934361457825,
                        0.5768794417381287,
                        0.5756680965423584,
                        0.5810432434082031,
                        0.6808993816375732,
                        0.6735559105873108
                    ]
                },
                "val": {
                    "score": -0.42734242811290757,
                    "pretrain_loss": 1.3888928294181824,
                    "pretrain_component": 0.6529098749160767,
                    "supervised_component": 0.7359829545021057,
                    "features_accuracy": [
                        0.6042991280555725,
                        0.5921888947486877,
                        0.5946109294891357,
                        0.58280348777771,
                        0.555858314037323,
                        0.5894641280174255,
                        0.6769603490829468,
                        0.65516197681427
                    ]
                },
                "test": {
                    "score": -0.43043644569889233,
                    "pretrain_loss": 1.3610773086547852,
                    "pretrain_component": 0.6520437598228455,
                    "supervised_component": 0.7090335488319397,
                    "features_accuracy": [
                        0.6126453280448914,
                        0.5855135917663574,
                        0.5964147448539734,
                        0.560562014579773,
                        0.5811530947685242,
                        0.5801841020584106,
                        0.6686046719551086,
                        0.6860464811325073
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": -0.3284798726536533,
                    "pretrain_loss": 1.3859120607376099,
                    "pretrain_component": 0.6483287215232849,
                    "supervised_component": 0.737583339214325,
                    "features_accuracy": [
                        0.6107199788093567,
                        0.5885381102561951,
                        0.6135967969894409,
                        0.5798319578170776,
                        0.5767279863357544,
                        0.5902794003486633,
                        0.678022563457489,
                        0.682792067527771
                    ]
                },
                "val": {
                    "score": -0.42872401266339,
                    "pretrain_loss": 1.3882901072502136,
                    "pretrain_component": 0.6535037755966187,
                    "supervised_component": 0.734786331653595,
                    "features_accuracy": [
                        0.6064184308052063,
                        0.5909779071807861,
                        0.5946109294891357,
                        0.580684244632721,
                        0.5576748251914978,
                        0.5858310461044312,
                        0.6721162796020508,
                        0.6485013365745544
                    ]
                },
                "test": {
                    "score": -0.4243966820931288,
                    "pretrain_loss": 1.3685286045074463,
                    "pretrain_component": 0.6524403691291809,
                    "supervised_component": 0.7160882353782654,
                    "features_accuracy": [
                        0.6104651093482971,
                        0.5857558250427246,
                        0.5935077667236328,
                        0.5598352551460266,
                        0.5787306427955627,
                        0.5821220874786377,
                        0.663517415523529,
                        0.6821705102920532
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": -0.33708763071869113,
                    "pretrain_loss": 1.3952258825302124,
                    "pretrain_component": 0.6505488753318787,
                    "supervised_component": 0.7446770071983337,
                    "features_accuracy": [
                        0.6068589687347412,
                        0.5841472148895264,
                        0.601029634475708,
                        0.5752139091491699,
                        0.5715799927711487,
                        0.5823302268981934,
                        0.6701491475105286,
                        0.6839276552200317
                    ]
                },
                "val": {
                    "score": -0.4299321224891107,
                    "pretrain_loss": 1.3886626362800598,
                    "pretrain_component": 0.6529748439788818,
                    "supervised_component": 0.735687792301178,
                    "features_accuracy": [
                        0.6109597086906433,
                        0.5837118029594421,
                        0.6015743017196655,
                        0.583106279373169,
                        0.5616106390953064,
                        0.5882530808448792,
                        0.6751437783241272,
                        0.6621253490447998
                    ]
                },
                "test": {
                    "score": -0.4274849287165848,
                    "pretrain_loss": 1.3580548763275146,
                    "pretrain_component": 0.6513875722885132,
                    "supervised_component": 0.7066673040390015,
                    "features_accuracy": [
                        0.6078003644943237,
                        0.5804263353347778,
                        0.5983527302742004,
                        0.5634689927101135,
                        0.5789728760719299,
                        0.5772771239280701,
                        0.6727228760719299,
                        0.6853197813034058
                    ]
                }
            },
            "80000": {
                "train": {
                    "score": -0.3636885713030711,
                    "pretrain_loss": 1.4112223982810974,
                    "pretrain_component": 0.6491289138793945,
                    "supervised_component": 0.7620934844017029,
                    "features_accuracy": [
                        0.6073889136314392,
                        0.5799076557159424,
                        0.6068589687347412,
                        0.5715799927711487,
                        0.5761223435401917,
                        0.5883110165596008,
                        0.6807479858398438,
                        0.6846089959144592
                    ]
                },
                "val": {
                    "score": -0.4358459904020218,
                    "pretrain_loss": 1.3817065954208374,
                    "pretrain_component": 0.6519879102706909,
                    "supervised_component": 0.7297186851501465,
                    "features_accuracy": [
                        0.6118680238723755,
                        0.5861338376998901,
                        0.5961247086524963,
                        0.5821980237960815,
                        0.5591886043548584,
                        0.5937026739120483,
                        0.6730245351791382,
                        0.6587950587272644
                    ]
                },
                "test": {
                    "score": -0.430803899445867,
                    "pretrain_loss": 1.3583483695983887,
                    "pretrain_component": 0.650669276714325,
                    "supervised_component": 0.7076790928840637,
                    "features_accuracy": [
                        0.6099806427955627,
                        0.5859980583190918,
                        0.5947189927101135,
                        0.5615310072898865,
                        0.5789728760719299,
                        0.5847868323326111,
                        0.669089138507843,
                        0.6875
                    ]
                }
            }
        },
        "train": {
            "score": -0.3143999373413098
        },
        "val": {
            "score": -0.42734242811290757
        },
        "test": {
            "score": -0.43043644569889233
        }
    },
    "best_iteration": 50000,
    "time": "0:09:28"
}
