{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised___04cac639803e446394e10b5218fdc2e0.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 10,
        "data": {
            "path": "data/california",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512
                ],
                "dropout": 0.37606718574444314
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear",
                "relu"
            ],
            "d_num_embedding": 96,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.0006535464774213995,
            "weight_decay": 0.0001731058757629251,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.5636154322228324,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.0006535464774213995,
            "weight_decay": 0.0001731058757629251,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post",
            "supervised_weight": 0.5
        },
        "bins": {
            "count": 254,
            "value": "ratio",
            "tree": {
                "min_samples_leaf": 19,
                "min_impurity_decrease": 0.0033532643064219814
            },
            "subsample": null
        }
    },
    "epoch_size": 104,
    "n_parameters": 672521,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -0.3589740865173157,
                    "pretrain_loss": 1.4197040796279907,
                    "pretrain_component": 0.6612845659255981,
                    "supervised_component": 0.7584195137023926,
                    "features_accuracy": [
                        0.5976228713989258,
                        0.5686274766921997,
                        0.594897449016571,
                        0.5657506585121155,
                        0.5604512095451355,
                        0.5761223435401917,
                        0.6609887480735779,
                        0.6662124395370483
                    ]
                },
                "val": {
                    "score": -0.4448887776359292,
                    "pretrain_loss": 1.3994091153144836,
                    "pretrain_component": 0.6604665517807007,
                    "supervised_component": 0.738942563533783,
                    "features_accuracy": [
                        0.6003633141517639,
                        0.5573720932006836,
                        0.5943081974983215,
                        0.5673630237579346,
                        0.5761429071426392,
                        0.5815925002098083,
                        0.6645473837852478,
                        0.664850115776062
                    ]
                },
                "test": {
                    "score": -0.4338980517655564,
                    "pretrain_loss": 1.4128349423408508,
                    "pretrain_component": 0.6620706915855408,
                    "supervised_component": 0.7507642507553101,
                    "features_accuracy": [
                        0.5830910801887512,
                        0.5763081312179565,
                        0.5959302186965942,
                        0.5634689927101135,
                        0.5721899271011353,
                        0.560562014579773,
                        0.6579457521438599,
                        0.6736918687820435
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -0.3761419256645261,
                    "pretrain_loss": 1.4161180257797241,
                    "pretrain_component": 0.6570627689361572,
                    "supervised_component": 0.7590552568435669,
                    "features_accuracy": [
                        0.5996668934822083,
                        0.5729427337646484,
                        0.5993641018867493,
                        0.5615110993385315,
                        0.5668105483055115,
                        0.5842986106872559,
                        0.6721175312995911,
                        0.6682565212249756
                    ]
                },
                "val": {
                    "score": -0.44015430887997836,
                    "pretrain_loss": 1.3913885951042175,
                    "pretrain_component": 0.6566377282142639,
                    "supervised_component": 0.7347508668899536,
                    "features_accuracy": [
                        0.6073266863822937,
                        0.5697850584983826,
                        0.6033908724784851,
                        0.5685740113258362,
                        0.577959418296814,
                        0.5843172669410706,
                        0.6621253490447998,
                        0.6663638949394226
                    ]
                },
                "test": {
                    "score": -0.43758722395239,
                    "pretrain_loss": 1.4068260788917542,
                    "pretrain_component": 0.6585473418235779,
                    "supervised_component": 0.7482787370681763,
                    "features_accuracy": [
                        0.5947189927101135,
                        0.5796996355056763,
                        0.5915697813034058,
                        0.5639534592628479,
                        0.5721899271011353,
                        0.5562015771865845,
                        0.6715116500854492,
                        0.6814438104629517
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -0.3734978794545964,
                    "pretrain_loss": 1.4076440334320068,
                    "pretrain_component": 0.6527571082115173,
                    "supervised_component": 0.7548869252204895,
                    "features_accuracy": [
                        0.605571985244751,
                        0.5815731883049011,
                        0.6009539365768433,
                        0.5704444050788879,
                        0.5713528990745544,
                        0.5892195105552673,
                        0.6721175312995911,
                        0.6698463559150696
                    ]
                },
                "val": {
                    "score": -0.4404660171793442,
                    "pretrain_loss": 1.3798577785491943,
                    "pretrain_component": 0.6527925729751587,
                    "supervised_component": 0.7270652055740356,
                    "features_accuracy": [
                        0.6094459295272827,
                        0.5767484307289124,
                        0.6018770933151245,
                        0.5670602321624756,
                        0.5849227905273438,
                        0.5921888947486877,
                        0.664850115776062,
                        0.6733272671699524
                    ]
                },
                "test": {
                    "score": -0.43597079545232603,
                    "pretrain_loss": 1.4023171663284302,
                    "pretrain_component": 0.6566260457038879,
                    "supervised_component": 0.7456911206245422,
                    "features_accuracy": [
                        0.5886628031730652,
                        0.5782461166381836,
                        0.5954457521438599,
                        0.5656492114067078,
                        0.5748546719551086,
                        0.5639534592628479,
                        0.6734496355056763,
                        0.6775678396224976
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -0.3679167884486872,
                    "pretrain_loss": 1.3862044215202332,
                    "pretrain_component": 0.6504184007644653,
                    "supervised_component": 0.7357860207557678,
                    "features_accuracy": [
                        0.6061776280403137,
                        0.5827844738960266,
                        0.604512095451355,
                        0.5721099376678467,
                        0.5758952498435974,
                        0.5818760395050049,
                        0.6790067553520203,
                        0.6792338490486145
                    ]
                },
                "val": {
                    "score": -0.4381954745387719,
                    "pretrain_loss": 1.382209300994873,
                    "pretrain_component": 0.6526928544044495,
                    "supervised_component": 0.7295164465904236,
                    "features_accuracy": [
                        0.6024826169013977,
                        0.5722070932388306,
                        0.6006660461425781,
                        0.5694822669029236,
                        0.5873448252677917,
                        0.5961247086524963,
                        0.6681804656982422,
                        0.6790796518325806
                    ]
                },
                "test": {
                    "score": -0.433732577169709,
                    "pretrain_loss": 1.3913440704345703,
                    "pretrain_component": 0.6554468870162964,
                    "supervised_component": 0.7358971834182739,
                    "features_accuracy": [
                        0.5913274884223938,
                        0.5775193572044373,
                        0.6000484228134155,
                        0.5637112259864807,
                        0.573401153087616,
                        0.5598352551460266,
                        0.6722383499145508,
                        0.6734496355056763
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": -0.3469830190745592,
                    "pretrain_loss": 1.3886446356773376,
                    "pretrain_component": 0.6500521898269653,
                    "supervised_component": 0.7385924458503723,
                    "features_accuracy": [
                        0.609584391117096,
                        0.5875539779663086,
                        0.6024680137634277,
                        0.5708229541778564,
                        0.5708986520767212,
                        0.5861912369728088,
                        0.6804451942443848,
                        0.67507004737854
                    ]
                },
                "val": {
                    "score": -0.43565430442832465,
                    "pretrain_loss": 1.3764184713363647,
                    "pretrain_component": 0.651178777217865,
                    "supervised_component": 0.7252396941184998,
                    "features_accuracy": [
                        0.6006660461425781,
                        0.578262209892273,
                        0.5976384878158569,
                        0.565546452999115,
                        0.5834090113639832,
                        0.5903723835945129,
                        0.669996976852417,
                        0.6754465699195862
                    ]
                },
                "test": {
                    "score": -0.42997238648306685,
                    "pretrain_loss": 1.3875877261161804,
                    "pretrain_component": 0.6540408730506897,
                    "supervised_component": 0.7335468530654907,
                    "features_accuracy": [
                        0.5913274884223938,
                        0.5826066136360168,
                        0.601017415523529,
                        0.5634689927101135,
                        0.5750969052314758,
                        0.5646802186965942,
                        0.6749030947685242,
                        0.6828972697257996
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": -0.32877185027349876,
                    "pretrain_loss": 1.3944610357284546,
                    "pretrain_component": 0.6492899060249329,
                    "supervised_component": 0.7451711297035217,
                    "features_accuracy": [
                        0.6134454011917114,
                        0.5855098962783813,
                        0.607691764831543,
                        0.5786206722259521,
                        0.5783178210258484,
                        0.5833144187927246,
                        0.6870315670967102,
                        0.6787039637565613
                    ]
                },
                "val": {
                    "score": -0.43402794893992164,
                    "pretrain_loss": 1.379204511642456,
                    "pretrain_component": 0.6499334573745728,
                    "supervised_component": 0.7292710542678833,
                    "features_accuracy": [
                        0.6058129072189331,
                        0.5818952322006226,
                        0.6100514531135559,
                        0.570390522480011,
                        0.583106279373169,
                        0.5912806391716003,
                        0.674841046333313,
                        0.674841046333313
                    ]
                },
                "test": {
                    "score": -0.4291599815585545,
                    "pretrain_loss": 1.3873551487922668,
                    "pretrain_component": 0.6535539627075195,
                    "supervised_component": 0.7338011860847473,
                    "features_accuracy": [
                        0.5954457521438599,
                        0.573401153087616,
                        0.595687985420227,
                        0.5654069781303406,
                        0.5743701457977295,
                        0.5671027302742004,
                        0.6756298542022705,
                        0.6836240291595459
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": -0.3277988353872758,
                    "pretrain_loss": 1.4019886255264282,
                    "pretrain_component": 0.6516990661621094,
                    "supervised_component": 0.7502895593643188,
                    "features_accuracy": [
                        0.597547173500061,
                        0.5784692168235779,
                        0.6033765077590942,
                        0.5788477659225464,
                        0.5693845152854919,
                        0.5886895656585693,
                        0.6743887066841125,
                        0.6831706166267395
                    ]
                },
                "val": {
                    "score": -0.4293437212975392,
                    "pretrain_loss": 1.3716001510620117,
                    "pretrain_component": 0.6491491794586182,
                    "supervised_component": 0.7224509716033936,
                    "features_accuracy": [
                        0.6049046516418457,
                        0.5752346515655518,
                        0.6039963364601135,
                        0.5664547085762024,
                        0.5825007557868958,
                        0.5940054655075073,
                        0.6712079644203186,
                        0.67756587266922
                    ]
                },
                "test": {
                    "score": -0.42764284719417894,
                    "pretrain_loss": 1.3860833048820496,
                    "pretrain_component": 0.6530429124832153,
                    "supervised_component": 0.7330403923988342,
                    "features_accuracy": [
                        0.5932654738426208,
                        0.5874515771865845,
                        0.6007751822471619,
                        0.5666182041168213,
                        0.5743701457977295,
                        0.5632267594337463,
                        0.6785368323326111,
                        0.6828972697257996
                    ]
                }
            },
            "80000": {
                "train": {
                    "score": -0.32502914193834576,
                    "pretrain_loss": 1.3913520574569702,
                    "pretrain_component": 0.6511217355728149,
                    "supervised_component": 0.7402303218841553,
                    "features_accuracy": [
                        0.5989855527877808,
                        0.5855855941772461,
                        0.5982285141944885,
                        0.5755167007446289,
                        0.5663563013076782,
                        0.5904307961463928,
                        0.6741615533828735,
                        0.6746158003807068
                    ]
                },
                "val": {
                    "score": -0.43128630801994966,
                    "pretrain_loss": 1.3736494779586792,
                    "pretrain_component": 0.6489577889442444,
                    "supervised_component": 0.7246916890144348,
                    "features_accuracy": [
                        0.6058129072189331,
                        0.577959418296814,
                        0.6121707558631897,
                        0.5667575001716614,
                        0.5900696516036987,
                        0.5849227905273438,
                        0.6736300587654114,
                        0.6784741282463074
                    ]
                },
                "test": {
                    "score": -0.4262348026129232,
                    "pretrain_loss": 1.385533094406128,
                    "pretrain_component": 0.6526175141334534,
                    "supervised_component": 0.7329155802726746,
                    "features_accuracy": [
                        0.5973837375640869,
                        0.5823643207550049,
                        0.6019864082336426,
                        0.5639534592628479,
                        0.5801841020584106,
                        0.5675871968269348,
                        0.6727228760719299,
                        0.6838662624359131
                    ]
                }
            },
            "90000": {
                "train": {
                    "score": -0.31605711182848695,
                    "pretrain_loss": 1.401267170906067,
                    "pretrain_component": 0.6502297520637512,
                    "supervised_component": 0.7510374188423157,
                    "features_accuracy": [
                        0.6001968383789062,
                        0.5795291066169739,
                        0.6126883625984192,
                        0.5786963701248169,
                        0.5662049055099487,
                        0.5891438126564026,
                        0.6755242943763733,
                        0.6816564798355103
                    ]
                },
                "val": {
                    "score": -0.42707523763069083,
                    "pretrain_loss": 1.373338520526886,
                    "pretrain_component": 0.6487430334091187,
                    "supervised_component": 0.7245954871177673,
                    "features_accuracy": [
                        0.6033908724784851,
                        0.5719043016433716,
                        0.6182258725166321,
                        0.5652437210083008,
                        0.5888586044311523,
                        0.5912806391716003,
                        0.6736300587654114,
                        0.6802906394004822
                    ]
                },
                "test": {
                    "score": -0.42947401452621237,
                    "pretrain_loss": 1.3856425285339355,
                    "pretrain_component": 0.652459442615509,
                    "supervised_component": 0.7331830859184265,
                    "features_accuracy": [
                        0.5949612259864807,
                        0.5857558250427246,
                        0.6031976938247681,
                        0.5632267594337463,
                        0.5712209343910217,
                        0.5649224519729614,
                        0.6785368323326111,
                        0.6860464811325073
                    ]
                }
            },
            "100000": {
                "train": {
                    "score": -0.32304152980501755,
                    "pretrain_loss": 1.382454514503479,
                    "pretrain_component": 0.6482183933258057,
                    "supervised_component": 0.7342361211776733,
                    "features_accuracy": [
                        0.6042092442512512,
                        0.5847528576850891,
                        0.6101900339126587,
                        0.5766522884368896,
                        0.5744568109512329,
                        0.5939889550209045,
                        0.6821107268333435,
                        0.6855174899101257
                    ]
                },
                "val": {
                    "score": -0.4303327738822413,
                    "pretrain_loss": 1.3712965846061707,
                    "pretrain_component": 0.6482293605804443,
                    "supervised_component": 0.7230672240257263,
                    "features_accuracy": [
                        0.6052073836326599,
                        0.580684244632721,
                        0.6073266863822937,
                        0.5670602321624756,
                        0.5870420932769775,
                        0.5909779071807861,
                        0.6742355227470398,
                        0.6854375004768372
                    ]
                },
                "test": {
                    "score": -0.4296148503481416,
                    "pretrain_loss": 1.383496880531311,
                    "pretrain_component": 0.6520610451698303,
                    "supervised_component": 0.7314358353614807,
                    "features_accuracy": [
                        0.6029554009437561,
                        0.5816376209259033,
                        0.5995639562606812,
                        0.5627422332763672,
                        0.5787306427955627,
                        0.5617732405662537,
                        0.6780523061752319,
                        0.6875
                    ]
                }
            }
        },
        "train": {
            "score": -0.31605711182848695
        },
        "val": {
            "score": -0.42707523763069083
        },
        "test": {
            "score": -0.42947401452621237
        }
    },
    "best_iteration": 90000,
    "time": "0:11:44"
}
