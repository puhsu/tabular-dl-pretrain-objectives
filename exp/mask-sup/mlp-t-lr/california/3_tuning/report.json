{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/tune.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 0,
        "program": "bin/pretrain_mask_supervised.py",
        "base_config": {
            "seed": 0,
            "data": {
                "T_cache": true,
                "path": "data/california",
                "T": {
                    "normalization": "quantile"
                }
            },
            "model": {
                "kind": "mlp",
                "num_embedding_arch": [
                    "linear",
                    "relu"
                ]
            },
            "training": {
                "batch_size": 128,
                "patience": 16
            },
            "pretrain": {
                "corrupt_strategy": "resample",
                "patience": 2,
                "d_hidden_head": 512
            }
        },
        "space": {
            "model": {
                "d_num_embedding": [
                    "int",
                    1,
                    128
                ],
                "config": {
                    "d_layers": [
                        "$fixed_mlp_d_layers",
                        1,
                        8,
                        512
                    ],
                    "dropout": [
                        "?uniform",
                        0.0,
                        0.0,
                        0.5
                    ]
                }
            },
            "pretrain": {
                "corrupt_probability": [
                    "uniform",
                    0.2,
                    0.8
                ]
            },
            "training": {
                "lr": [
                    "loguniform",
                    5e-05,
                    0.005
                ],
                "weight_decay": [
                    "?loguniform",
                    0.0,
                    1e-06,
                    0.001
                ]
            },
            "bins": {
                "count": [
                    "int",
                    2,
                    256
                ],
                "tree": {
                    "min_samples_leaf": [
                        "int",
                        1,
                        128
                    ],
                    "min_impurity_decrease": [
                        "loguniform",
                        1e-09,
                        0.01
                    ]
                }
            }
        },
        "n_trials": 100,
        "timeout": null,
        "sampler": {
            "seed": 0
        }
    },
    "best": {
        "program": "bin/pretrain_mask_supervised.py",
        "environment": {
            "CUDA_VISIBLE_DEVICES": "0",
            "gpus": {
                "driver": "450.119.04",
                "devices": [
                    {
                        "name": "A100-SXM-80GB",
                        "memory_total": 85199093760,
                        "memory_free": 85195948032,
                        "memory_used": 3145728,
                        "utilization": 0
                    }
                ]
            },
            "torch.version.cuda": "11.1",
            "torch.backends.cudnn.version()": 8005,
            "torch.cuda.nccl.version()": [
                2,
                10,
                3
            ]
        },
        "config": {
            "seed": 0,
            "data": {
                "path": "data/california",
                "T": {
                    "seed": 0,
                    "normalization": "quantile",
                    "num_nan_policy": null,
                    "cat_nan_policy": null,
                    "cat_min_frequency": null,
                    "cat_encoding": null,
                    "y_policy": "default"
                },
                "T_cache": true
            },
            "model": {
                "kind": "mlp",
                "config": {
                    "d_layers": [
                        512
                    ],
                    "dropout": 0.37606718574444314
                },
                "default": true,
                "checkpoint": null,
                "num_embedding_arch": [
                    "linear",
                    "relu"
                ],
                "d_num_embedding": 96,
                "positional_encoding": null,
                "d_cat_embedding": null
            },
            "training": {
                "batch_size": 128,
                "lr": 0.0006535464774213995,
                "weight_decay": 0.0001731058757629251,
                "optimizer": "AdamW",
                "patience": 16,
                "n_epochs": Infinity,
                "eval_batch_size": 8192
            },
            "pretrain": {
                "corrupt_probability": 0.5636154322228324,
                "corrupt_strategy": "resample",
                "d_hidden_head": 512,
                "lr": 0.0006535464774213995,
                "weight_decay": 0.0001731058757629251,
                "patience": 2,
                "n_iterations": 100000,
                "validate_every": 10000,
                "replace_strategy": "shuffle",
                "n_neighbors": 20,
                "use_target": false,
                "early_stop_type": "finetune",
                "target_injection_type": "post",
                "supervised_weight": 0.5
            },
            "bins": {
                "count": 254,
                "value": "ratio",
                "tree": {
                    "min_samples_leaf": 19,
                    "min_impurity_decrease": 0.0033532643064219814
                },
                "subsample": null
            }
        },
        "epoch_size": 104,
        "n_parameters": 672521,
        "metrics": {
            "iteration_scores": {
                "10000": {
                    "train": {
                        "score": -0.3735530116323014,
                        "pretrain_loss": 1.427350401878357,
                        "pretrain_component": 0.6616722345352173,
                        "supervised_component": 0.7656781673431396,
                        "features_accuracy": [
                            0.5995154976844788,
                            0.5646150708198547,
                            0.59520024061203,
                            0.5665076971054077,
                            0.5729427337646484,
                            0.5753653049468994,
                            0.6611401438713074,
                            0.6565220952033997
                        ]
                    },
                    "val": {
                        "score": -0.4470180775222099,
                        "pretrain_loss": 1.4483025074005127,
                        "pretrain_component": 0.6631025075912476,
                        "supervised_component": 0.7851999998092651,
                        "features_accuracy": [
                            0.6061156392097473,
                            0.565546452999115,
                            0.5933999419212341,
                            0.573115348815918,
                            0.5564638376235962,
                            0.5767484307289124,
                            0.6481986045837402,
                            0.6712079644203186
                        ]
                    },
                    "test": {
                        "score": -0.44094042689164153,
                        "pretrain_loss": 1.4090828895568848,
                        "pretrain_component": 0.659685492515564,
                        "supervised_component": 0.7493973970413208,
                        "features_accuracy": [
                            0.5961724519729614,
                            0.5743701457977295,
                            0.5959302186965942,
                            0.5758236646652222,
                            0.5714631676673889,
                            0.575339138507843,
                            0.6523740291595459,
                            0.6753876209259033
                        ]
                    }
                },
                "20000": {
                    "train": {
                        "score": -0.35078841646240716,
                        "pretrain_loss": 1.4140931963920593,
                        "pretrain_component": 0.6557697057723999,
                        "supervised_component": 0.7583234906196594,
                        "features_accuracy": [
                            0.5998940467834473,
                            0.5739268660545349,
                            0.5953516960144043,
                            0.5763494968414307,
                            0.5766522884368896,
                            0.5793020129203796,
                            0.6645469069480896,
                            0.676962673664093
                        ]
                    },
                    "val": {
                        "score": -0.4400876581786068,
                        "pretrain_loss": 1.4264137148857117,
                        "pretrain_component": 0.6586979031562805,
                        "supervised_component": 0.7677158117294312,
                        "features_accuracy": [
                            0.6012715697288513,
                            0.5785649418830872,
                            0.5882530808448792,
                            0.5746291279792786,
                            0.5588858723640442,
                            0.580381453037262,
                            0.645473837852478,
                            0.6793823838233948
                        ]
                    },
                    "test": {
                        "score": -0.43508042363729416,
                        "pretrain_loss": 1.393853783607483,
                        "pretrain_component": 0.6549983024597168,
                        "supervised_component": 0.7388554811477661,
                        "features_accuracy": [
                            0.5952034592628479,
                            0.5775193572044373,
                            0.6024709343910217,
                            0.575339138507843,
                            0.5738856792449951,
                            0.5799418687820435,
                            0.6683623790740967,
                            0.6841084957122803
                        ]
                    }
                },
                "30000": {
                    "train": {
                        "score": -0.3527453069640822,
                        "pretrain_loss": 1.4075922966003418,
                        "pretrain_component": 0.6529320478439331,
                        "supervised_component": 0.7546602487564087,
                        "features_accuracy": [
                            0.6048906445503235,
                            0.5833144187927246,
                            0.5993641018867493,
                            0.5655992031097412,
                            0.5727912783622742,
                            0.5736997723579407,
                            0.6818835735321045,
                            0.6753728985786438
                        ]
                    },
                    "val": {
                        "score": -0.438528073691533,
                        "pretrain_loss": 1.4258441925048828,
                        "pretrain_component": 0.6566130518913269,
                        "supervised_component": 0.7692311406135559,
                        "features_accuracy": [
                            0.6015743017196655,
                            0.5746291279792786,
                            0.5958219766616821,
                            0.5764456391334534,
                            0.5625188946723938,
                            0.5809869766235352,
                            0.6563729643821716,
                            0.6827126741409302
                        ]
                    },
                    "test": {
                        "score": -0.43423391940736056,
                        "pretrain_loss": 1.3855177760124207,
                        "pretrain_component": 0.653129518032074,
                        "supervised_component": 0.7323882579803467,
                        "features_accuracy": [
                            0.5964147448539734,
                            0.580910861492157,
                            0.5954457521438599,
                            0.5789728760719299,
                            0.5833333134651184,
                            0.5782461166381836,
                            0.6710271239280701,
                            0.6843507885932922
                        ]
                    }
                },
                "40000": {
                    "train": {
                        "score": -0.3491830248999227,
                        "pretrain_loss": 1.3989627957344055,
                        "pretrain_component": 0.6521947383880615,
                        "supervised_component": 0.746768057346344,
                        "features_accuracy": [
                            0.602089524269104,
                            0.570671558380127,
                            0.6022409200668335,
                            0.5771065354347229,
                            0.5696873664855957,
                            0.5889166593551636,
                            0.6674237251281738,
                            0.6830191612243652
                        ]
                    },
                    "val": {
                        "score": -0.43747696542449643,
                        "pretrain_loss": 1.4266412854194641,
                        "pretrain_component": 0.6562564969062805,
                        "supervised_component": 0.7703847885131836,
                        "features_accuracy": [
                            0.5976384878158569,
                            0.5797759890556335,
                            0.5988495349884033,
                            0.575537383556366,
                            0.5616106390953064,
                            0.5812897086143494,
                            0.6590977907180786,
                            0.679987907409668
                        ]
                    },
                    "test": {
                        "score": -0.43291795592916515,
                        "pretrain_loss": 1.3873801827430725,
                        "pretrain_component": 0.6526362895965576,
                        "supervised_component": 0.7347438931465149,
                        "features_accuracy": [
                            0.5896317958831787,
                            0.5852712988853455,
                            0.6034399271011353,
                            0.5799418687820435,
                            0.580910861492157,
                            0.5833333134651184,
                            0.6729651093482971,
                            0.6853197813034058
                        ]
                    }
                },
                "50000": {
                    "train": {
                        "score": -0.3379584921877319,
                        "pretrain_loss": 1.3958645462989807,
                        "pretrain_component": 0.6509109735488892,
                        "supervised_component": 0.7449535727500916,
                        "features_accuracy": [
                            0.6139753460884094,
                            0.5721856355667114,
                            0.603982150554657,
                            0.5770308375358582,
                            0.5774850845336914,
                            0.5805132985115051,
                            0.68036949634552,
                            0.6740858554840088
                        ]
                    },
                    "val": {
                        "score": -0.4357252723848984,
                        "pretrain_loss": 1.4210060834884644,
                        "pretrain_component": 0.6546521186828613,
                        "supervised_component": 0.766353964805603,
                        "features_accuracy": [
                            0.6021798253059387,
                            0.580684244632721,
                            0.5961247086524963,
                            0.5770511627197266,
                            0.5688768029212952,
                            0.5873448252677917,
                            0.6587950587272644,
                            0.6866484880447388
                        ]
                    },
                    "test": {
                        "score": -0.4359497093377675,
                        "pretrain_loss": 1.3864604830741882,
                        "pretrain_component": 0.6520134210586548,
                        "supervised_component": 0.7344470620155334,
                        "features_accuracy": [
                            0.5947189927101135,
                            0.586482584476471,
                            0.6053779125213623,
                            0.5758236646652222,
                            0.5775193572044373,
                            0.5833333134651184,
                            0.6729651093482971,
                            0.6865310072898865
                        ]
                    }
                },
                "60000": {
                    "train": {
                        "score": -0.3365800262869158,
                        "pretrain_loss": 1.3898628950119019,
                        "pretrain_component": 0.6483632922172546,
                        "supervised_component": 0.7414996027946472,
                        "features_accuracy": [
                            0.6091301441192627,
                            0.5853585004806519,
                            0.6054205894470215,
                            0.5702173113822937,
                            0.5705958008766174,
                            0.594670295715332,
                            0.6805965900421143,
                            0.6754485964775085
                        ]
                    },
                    "val": {
                        "score": -0.4312758367320962,
                        "pretrain_loss": 1.414612591266632,
                        "pretrain_component": 0.65397047996521,
                        "supervised_component": 0.7606421113014221,
                        "features_accuracy": [
                            0.5970330238342285,
                            0.5800787210464478,
                            0.6012715697288513,
                            0.5773538947105408,
                            0.5676657557487488,
                            0.5855283141136169,
                            0.6578867435455322,
                            0.6805933713912964
                        ]
                    },
                    "test": {
                        "score": -0.4317750110752657,
                        "pretrain_loss": 1.3828969597816467,
                        "pretrain_component": 0.6515437960624695,
                        "supervised_component": 0.7313531637191772,
                        "features_accuracy": [
                            0.5932654738426208,
                            0.5915697813034058,
                            0.6036821603775024,
                            0.580910861492157,
                            0.5804263353347778,
                            0.5789728760719299,
                            0.6741763353347778,
                            0.6862887740135193
                        ]
                    }
                },
                "70000": {
                    "train": {
                        "score": -0.3497660142138179,
                        "pretrain_loss": 1.3891960978507996,
                        "pretrain_component": 0.6520833969116211,
                        "supervised_component": 0.7371127009391785,
                        "features_accuracy": [
                            0.6033765077590942,
                            0.5718828439712524,
                            0.6070103645324707,
                            0.5732455253601074,
                            0.5712014436721802,
                            0.5816488862037659,
                            0.6776440739631653,
                            0.680142343044281
                        ]
                    },
                    "val": {
                        "score": -0.4333359028975164,
                        "pretrain_loss": 1.4121211767196655,
                        "pretrain_component": 0.6526022553443909,
                        "supervised_component": 0.7595189213752747,
                        "features_accuracy": [
                            0.5988495349884033,
                            0.5891613960266113,
                            0.6046018600463867,
                            0.5752346515655518,
                            0.570390522480011,
                            0.5818952322006226,
                            0.6584922671318054,
                            0.6930063366889954
                        ]
                    },
                    "test": {
                        "score": -0.4323496350310646,
                        "pretrain_loss": 1.3755410313606262,
                        "pretrain_component": 0.6499974727630615,
                        "supervised_component": 0.7255435585975647,
                        "features_accuracy": [
                            0.6056201457977295,
                            0.5799418687820435,
                            0.5983527302742004,
                            0.575339138507843,
                            0.5746123790740967,
                            0.5838178396224976,
                            0.6744186282157898,
                            0.6887112259864807
                        ]
                    }
                },
                "80000": {
                    "train": {
                        "score": -0.3215097152961627,
                        "pretrain_loss": 1.3895079493522644,
                        "pretrain_component": 0.6493105292320251,
                        "supervised_component": 0.7401974201202393,
                        "features_accuracy": [
                            0.6017866730690002,
                            0.5900522470474243,
                            0.6042850017547607,
                            0.5786206722259521,
                            0.5713528990745544,
                            0.5882353186607361,
                            0.676432728767395,
                            0.6866530776023865
                        ]
                    },
                    "val": {
                        "score": -0.42993125881430916,
                        "pretrain_loss": 1.4108264446258545,
                        "pretrain_component": 0.6537536978721619,
                        "supervised_component": 0.7570727467536926,
                        "features_accuracy": [
                            0.6024826169013977,
                            0.5834090113639832,
                            0.5946109294891357,
                            0.5837118029594421,
                            0.5664547085762024,
                            0.5870420932769775,
                            0.6597033143043518,
                            0.6951256394386292
                        ]
                    },
                    "test": {
                        "score": -0.4300027512099925,
                        "pretrain_loss": 1.3749042749404907,
                        "pretrain_component": 0.6498590111732483,
                        "supervised_component": 0.7250452637672424,
                        "features_accuracy": [
                            0.601259708404541,
                            0.5823643207550049,
                            0.6056201457977295,
                            0.5780038833618164,
                            0.5743701457977295,
                            0.5823643207550049,
                            0.6734496355056763,
                            0.693071722984314
                        ]
                    }
                },
                "90000": {
                    "train": {
                        "score": -0.3050562682702251,
                        "pretrain_loss": 1.3932044506072998,
                        "pretrain_component": 0.6507253646850586,
                        "supervised_component": 0.7424790859222412,
                        "features_accuracy": [
                            0.6111742258071899,
                            0.5846014022827148,
                            0.606934666633606,
                            0.5668105483055115,
                            0.5718071460723877,
                            0.5812703371047974,
                            0.6739344596862793,
                            0.6751457452774048
                        ]
                    },
                    "val": {
                        "score": -0.4248988836523778,
                        "pretrain_loss": 1.413737952709198,
                        "pretrain_component": 0.6530053615570068,
                        "supervised_component": 0.7607325911521912,
                        "features_accuracy": [
                            0.6015743017196655,
                            0.5812897086143494,
                            0.6021798253059387,
                            0.5776566863059998,
                            0.5740236043930054,
                            0.5873448252677917,
                            0.6645473837852478,
                            0.6917953491210938
                        ]
                    },
                    "test": {
                        "score": -0.4331875660747571,
                        "pretrain_loss": 1.3764044642448425,
                        "pretrain_component": 0.6498036980628967,
                        "supervised_component": 0.7266007661819458,
                        "features_accuracy": [
                            0.6085271239280701,
                            0.586482584476471,
                            0.6068313717842102,
                            0.5796996355056763,
                            0.5748546719551086,
                            0.5816376209259033,
                            0.6768410801887512,
                            0.6906492114067078
                        ]
                    }
                },
                "100000": {
                    "train": {
                        "score": -0.3376008631889,
                        "pretrain_loss": 1.3746666312217712,
                        "pretrain_component": 0.6463255882263184,
                        "supervised_component": 0.7283410429954529,
                        "features_accuracy": [
                            0.6111742258071899,
                            0.5858884453773499,
                            0.6065561771392822,
                            0.5827844738960266,
                            0.5719585418701172,
                            0.5899765491485596,
                            0.6802937388420105,
                            0.6877886652946472
                        ]
                    },
                    "val": {
                        "score": -0.43146288545049627,
                        "pretrain_loss": 1.4074167013168335,
                        "pretrain_component": 0.651941180229187,
                        "supervised_component": 0.7554755210876465,
                        "features_accuracy": [
                            0.6009688377380371,
                            0.5885558724403381,
                            0.6067211627960205,
                            0.575537383556366,
                            0.563427209854126,
                            0.583106279373169,
                            0.6636391282081604,
                            0.6933091282844543
                        ]
                    },
                    "test": {
                        "score": -0.4331410208351455,
                        "pretrain_loss": 1.3761115670204163,
                        "pretrain_component": 0.6490659713745117,
                        "supervised_component": 0.7270455956459045,
                        "features_accuracy": [
                            0.5981104373931885,
                            0.5889050364494324,
                            0.6058623790740967,
                            0.5816376209259033,
                            0.5801841020584106,
                            0.5843023061752319,
                            0.6744186282157898,
                            0.6957364082336426
                        ]
                    }
                }
            },
            "train": {
                "score": -0.3050562682702251
            },
            "val": {
                "score": -0.4248988836523778
            },
            "test": {
                "score": -0.4331875660747571
            }
        },
        "best_iteration": 90000,
        "time": "0:11:22",
        "trial_id": 70,
        "tuning_time": "9:43:00"
    },
    "time": "14:26:10"
}
