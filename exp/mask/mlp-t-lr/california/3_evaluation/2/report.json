{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask___6922bb9e514d49998c508175b225e3b9.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 2,
        "data": {
            "path": "data/california",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512
                ],
                "dropout": 0.3893717306237359
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear",
                "relu"
            ],
            "d_num_embedding": 62,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.0008155379619198897,
            "weight_decay": 0.0,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.26038816213350024,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.0008155379619198897,
            "weight_decay": 0.0,
            "patience": 2,
            "n_iterations": 100000,
            "finetune_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "target_injection_type": "post"
        },
        "bins": {
            "count": 197,
            "value": "ratio",
            "tree": {
                "min_samples_leaf": 113,
                "min_impurity_decrease": 0.0004238924124681992
            },
            "subsample": null
        }
    },
    "epoch_size": 104,
    "n_parameters": 539576,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -0.36554465217113274,
                    "pretrain_loss": 0.4968504309654236,
                    "features_accuracy": [
                        0.7760617733001709,
                        0.7622076272964478,
                        0.7785601019859314,
                        0.7458551526069641,
                        0.7407070994377136,
                        0.7598607540130615,
                        0.8127034902572632,
                        0.8136119842529297
                    ]
                },
                "val": {
                    "score": -0.4451328536348959,
                    "pretrain_loss": 0.4997096657752991,
                    "features_accuracy": [
                        0.7714199423789978,
                        0.7559794187545776,
                        0.783832848072052,
                        0.7487133145332336,
                        0.7574931979179382,
                        0.7556766271591187,
                        0.8019981980323792,
                        0.8159249424934387
                    ]
                },
                "test": {
                    "score": -0.43017490971009137,
                    "pretrain_loss": 0.49660882353782654,
                    "features_accuracy": [
                        0.7875484228134155,
                        0.7688953280448914,
                        0.7705910801887512,
                        0.7708333134651184,
                        0.742490291595459,
                        0.742490291595459,
                        0.801598846912384,
                        0.8134689927101135
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -0.3539317657142826,
                    "pretrain_loss": 0.4887954294681549,
                    "features_accuracy": [
                        0.7835566997528076,
                        0.766144335269928,
                        0.7797713875770569,
                        0.7537285685539246,
                        0.7497161030769348,
                        0.7616776823997498,
                        0.8201983571052551,
                        0.8229994773864746
                    ]
                },
                "val": {
                    "score": -0.43472487239440427,
                    "pretrain_loss": 0.4943901598453522,
                    "features_accuracy": [
                        0.77414470911026,
                        0.761731743812561,
                        0.7805025577545166,
                        0.749621570110321,
                        0.7602179646492004,
                        0.7623372673988342,
                        0.8010899424552917,
                        0.8213744759559631
                    ]
                },
                "test": {
                    "score": -0.429590882548053,
                    "pretrain_loss": 0.49170613288879395,
                    "features_accuracy": [
                        0.7877907156944275,
                        0.7708333134651184,
                        0.7747092843055725,
                        0.7722868323326111,
                        0.7437015771865845,
                        0.7458817958831787,
                        0.8064438104629517,
                        0.8161337375640869
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -0.34876235494598096,
                    "pretrain_loss": 0.4831976592540741,
                    "features_accuracy": [
                        0.7902188301086426,
                        0.7738663554191589,
                        0.7865849137306213,
                        0.7462336421012878,
                        0.7538042664527893,
                        0.7597092986106873,
                        0.8211068511009216,
                        0.8258005976676941
                    ]
                },
                "val": {
                    "score": -0.4312135622216228,
                    "pretrain_loss": 0.49185624718666077,
                    "features_accuracy": [
                        0.7711171507835388,
                        0.7677868604660034,
                        0.7826218605041504,
                        0.752043604850769,
                        0.761731743812561,
                        0.7571904063224792,
                        0.8041174411773682,
                        0.8210717439651489
                    ]
                },
                "test": {
                    "score": -0.425445195315247,
                    "pretrain_loss": 0.48880207538604736,
                    "features_accuracy": [
                        0.7904554009437561,
                        0.773982584476471,
                        0.7742248177528381,
                        0.7747092843055725,
                        0.7437015771865845,
                        0.7463662624359131,
                        0.8125,
                        0.8243701457977295
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -0.3048626027193712,
                    "pretrain_loss": 0.4799853265285492,
                    "features_accuracy": [
                        0.7905216217041016,
                        0.770686686038971,
                        0.7889317870140076,
                        0.7474449276924133,
                        0.7391172647476196,
                        0.76561439037323,
                        0.8271633386611938,
                        0.8311000466346741
                    ]
                },
                "val": {
                    "score": -0.4275693172046202,
                    "pretrain_loss": 0.49007946252822876,
                    "features_accuracy": [
                        0.776566743850708,
                        0.7656675577163696,
                        0.7886769771575928,
                        0.7502270340919495,
                        0.7602179646492004,
                        0.7608234882354736,
                        0.813502848148346,
                        0.8234937787055969
                    ]
                },
                "test": {
                    "score": -0.4241937423342626,
                    "pretrain_loss": 0.48560982942581177,
                    "features_accuracy": [
                        0.7873061895370483,
                        0.7759205102920532,
                        0.775678277015686,
                        0.7722868323326111,
                        0.7439438104629517,
                        0.7470930218696594,
                        0.8141957521438599,
                        0.8231589198112488
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": -0.3227536498667122,
                    "pretrain_loss": 0.47033652663230896,
                    "features_accuracy": [
                        0.7940798401832581,
                        0.7810583710670471,
                        0.7909001708030701,
                        0.7504732012748718,
                        0.754182755947113,
                        0.7692482471466064,
                        0.8345068097114563,
                        0.8376864790916443
                    ]
                },
                "val": {
                    "score": -0.4280166852923752,
                    "pretrain_loss": 0.487586110830307,
                    "features_accuracy": [
                        0.7780805230140686,
                        0.7671813368797302,
                        0.7856494188308716,
                        0.7517408132553101,
                        0.7599152326583862,
                        0.7626399993896484,
                        0.8153194189071655,
                        0.8204662203788757
                    ]
                },
                "test": {
                    "score": -0.4196756670345006,
                    "pretrain_loss": 0.4834560751914978,
                    "features_accuracy": [
                        0.7892441749572754,
                        0.7766472697257996,
                        0.779312014579773,
                        0.7732558250427246,
                        0.7437015771865845,
                        0.7483042478561401,
                        0.8149224519729614,
                        0.8207364082336426
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": -0.2968830107203407,
                    "pretrain_loss": 0.47111234068870544,
                    "features_accuracy": [
                        0.7969566583633423,
                        0.7829510569572449,
                        0.7886289954185486,
                        0.7511545419692993,
                        0.7461579442024231,
                        0.7658414840698242,
                        0.8298130631446838,
                        0.8301158547401428
                    ]
                },
                "val": {
                    "score": -0.4254364202212214,
                    "pretrain_loss": 0.4873199462890625,
                    "features_accuracy": [
                        0.779291570186615,
                        0.764456570148468,
                        0.7868604063987732,
                        0.7523463368415833,
                        0.7623372673988342,
                        0.7590069770812988,
                        0.8128973841667175,
                        0.8186497092247009
                    ]
                },
                "test": {
                    "score": -0.4235662620393433,
                    "pretrain_loss": 0.48297119140625,
                    "features_accuracy": [
                        0.7909399271011353,
                        0.7759205102920532,
                        0.7797964811325073,
                        0.7744670510292053,
                        0.7437015771865845,
                        0.7468507885932922,
                        0.8221899271011353,
                        0.825339138507843
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": -0.2925749249273862,
                    "pretrain_loss": 0.4753527343273163,
                    "features_accuracy": [
                        0.7935498952865601,
                        0.7824968099594116,
                        0.7937012910842896,
                        0.754182755947113,
                        0.7515330910682678,
                        0.761601984500885,
                        0.8261791467666626,
                        0.8276175856590271
                    ]
                },
                "val": {
                    "score": -0.42577497932538944,
                    "pretrain_loss": 0.4871581196784973,
                    "features_accuracy": [
                        0.7762640118598938,
                        0.7656675577163696,
                        0.7880714535713196,
                        0.7517408132553101,
                        0.756887674331665,
                        0.7614290118217468,
                        0.8095670342445374,
                        0.8168331980705261
                    ]
                },
                "test": {
                    "score": -0.42133193754248877,
                    "pretrain_loss": 0.48294612765312195,
                    "features_accuracy": [
                        0.7894864082336426,
                        0.78125,
                        0.779312014579773,
                        0.7720445990562439,
                        0.7434592843055725,
                        0.7466084957122803,
                        0.817829430103302,
                        0.8263081312179565
                    ]
                }
            },
            "80000": {
                "train": {
                    "score": -0.30784689765301865,
                    "pretrain_loss": 0.47408029437065125,
                    "features_accuracy": [
                        0.7912787199020386,
                        0.7780301570892334,
                        0.7912030220031738,
                        0.753652811050415,
                        0.7446438074111938,
                        0.7667499780654907,
                        0.8261034488677979,
                        0.8354153037071228
                    ]
                },
                "val": {
                    "score": -0.42818509540873617,
                    "pretrain_loss": 0.48524630069732666,
                    "features_accuracy": [
                        0.781410813331604,
                        0.766575813293457,
                        0.7910990118980408,
                        0.7484105229377747,
                        0.7614290118217468,
                        0.7632455229759216,
                        0.8119890689849854,
                        0.8240993022918701
                    ]
                },
                "test": {
                    "score": -0.42334931747904037,
                    "pretrain_loss": 0.48107877373695374,
                    "features_accuracy": [
                        0.7904554009437561,
                        0.7802810072898865,
                        0.7783430218696594,
                        0.7732558250427246,
                        0.7422480583190918,
                        0.744428277015686,
                        0.8209787011146545,
                        0.8263081312179565
                    ]
                }
            },
            "90000": {
                "train": {
                    "score": -0.3028343955911736,
                    "pretrain_loss": 0.47064340114593506,
                    "features_accuracy": [
                        0.7899159789085388,
                        0.7774245142936707,
                        0.7915815114974976,
                        0.761904776096344,
                        0.7516087889671326,
                        0.7697781920433044,
                        0.8304944038391113,
                        0.8371565341949463
                    ]
                },
                "val": {
                    "score": -0.4280331447699191,
                    "pretrain_loss": 0.4851623773574829,
                    "features_accuracy": [
                        0.7805025577545166,
                        0.766878604888916,
                        0.791401743888855,
                        0.7499243021011353,
                        0.7587041854858398,
                        0.7647593021392822,
                        0.8104753494262695,
                        0.8228882551193237
                    ]
                },
                "test": {
                    "score": -0.42620395751978707,
                    "pretrain_loss": 0.4811566472053528,
                    "features_accuracy": [
                        0.7899709343910217,
                        0.7790697813034058,
                        0.78125,
                        0.7751938104629517,
                        0.7398256063461304,
                        0.7492732405662537,
                        0.817829430103302,
                        0.8304263353347778
                    ]
                }
            }
        },
        "train": {
            "score": -0.2968830107203407
        },
        "val": {
            "score": -0.4254364202212214
        },
        "test": {
            "score": -0.4235662620393433
        }
    },
    "best_iteration": 60000,
    "time": "0:09:24"
}
