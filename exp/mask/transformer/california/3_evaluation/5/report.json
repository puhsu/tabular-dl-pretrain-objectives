{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask___244f7ca57aa341f2a26a23fbf225738b.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 5,
        "data": {
            "path": "data/california",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "transformer",
            "config": {
                "n_blocks": 4,
                "attention_dropout": 0.23378684224099733,
                "ffn_dropout": 0.16676607141878652,
                "ffn_d_hidden": 865
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear"
            ],
            "d_num_embedding": 512,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.00010485453984042361,
            "weight_decay": 0.0005622737615666989,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.2829421149532736,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.00010485453984042361,
            "weight_decay": 0.0005622737615666989,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "epoch_size": 104,
    "n_parameters": 9805065,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -0.36591072058028634,
                    "pretrain_loss": 0.5173173546791077,
                    "features_accuracy": [
                        0.760844886302948,
                        0.7506245970726013,
                        0.7579680681228638,
                        0.7270800471305847,
                        0.7320009469985962,
                        0.7343478202819824,
                        0.7985464930534363,
                        0.7934741973876953
                    ]
                },
                "val": {
                    "score": -0.4514253095856204,
                    "pretrain_loss": 0.520260214805603,
                    "features_accuracy": [
                        0.7674841284751892,
                        0.7475022673606873,
                        0.766878604888916,
                        0.7241901159286499,
                        0.7378141283988953,
                        0.7232818603515625,
                        0.7859521508216858,
                        0.7901907563209534
                    ]
                },
                "test": {
                    "score": -0.4564750402949966,
                    "pretrain_loss": 0.5200546383857727,
                    "features_accuracy": [
                        0.7623546719551086,
                        0.7470930218696594,
                        0.7630813717842102,
                        0.7214147448539734,
                        0.729651153087616,
                        0.7429748177528381,
                        0.7851259708404541,
                        0.7960271239280701
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -0.3021999094639414,
                    "pretrain_loss": 0.5127512812614441,
                    "features_accuracy": [
                        0.7599364519119263,
                        0.7560754418373108,
                        0.7569081783294678,
                        0.7338935732841492,
                        0.7260958552360535,
                        0.7375274896621704,
                        0.795669674873352,
                        0.80157470703125
                    ]
                },
                "val": {
                    "score": -0.4491344227020037,
                    "pretrain_loss": 0.5156647562980652,
                    "features_accuracy": [
                        0.7738419771194458,
                        0.7505298256874084,
                        0.7674841284751892,
                        0.7241901159286499,
                        0.7381168603897095,
                        0.7260066866874695,
                        0.7907962203025818,
                        0.798667848110199
                    ]
                },
                "test": {
                    "score": -0.4546570673179759,
                    "pretrain_loss": 0.5155404210090637,
                    "features_accuracy": [
                        0.7587209343910217,
                        0.7463662624359131,
                        0.7679263353347778,
                        0.7245639562606812,
                        0.7289243936538696,
                        0.7453972697257996,
                        0.7972383499145508,
                        0.801598846912384
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -0.3068843709475411,
                    "pretrain_loss": 0.5028032064437866,
                    "features_accuracy": [
                        0.7686426043510437,
                        0.7601635456085205,
                        0.767507016658783,
                        0.7321523427963257,
                        0.7336664795875549,
                        0.7422212362289429,
                        0.8046029210090637,
                        0.8076311945915222
                    ]
                },
                "val": {
                    "score": -0.447129260222922,
                    "pretrain_loss": 0.5123715996742249,
                    "features_accuracy": [
                        0.7735391855239868,
                        0.7541629076004028,
                        0.7759612202644348,
                        0.7238873839378357,
                        0.7359975576400757,
                        0.7290341854095459,
                        0.7968513369560242,
                        0.798970639705658
                    ]
                },
                "test": {
                    "score": -0.44330433937938646,
                    "pretrain_loss": 0.5132042765617371,
                    "features_accuracy": [
                        0.7662306427955627,
                        0.7461240291595459,
                        0.7698643207550049,
                        0.7257751822471619,
                        0.7328003644943237,
                        0.7451550364494324,
                        0.7960271239280701,
                        0.7977228760719299
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -0.2674386691044804,
                    "pretrain_loss": 0.4955023527145386,
                    "features_accuracy": [
                        0.7693997025489807,
                        0.7609963417053223,
                        0.7700810432434082,
                        0.7425997853279114,
                        0.7426754832267761,
                        0.7521387338638306,
                        0.8118706941604614,
                        0.8105837106704712
                    ]
                },
                "val": {
                    "score": -0.4465767778911698,
                    "pretrain_loss": 0.51262366771698,
                    "features_accuracy": [
                        0.7756584882736206,
                        0.7508325576782227,
                        0.7656675577163696,
                        0.7244929075241089,
                        0.7356948256492615,
                        0.7293369770050049,
                        0.798970639705658,
                        0.8004844188690186
                    ]
                },
                "test": {
                    "score": -0.4470590924093592,
                    "pretrain_loss": 0.5113511085510254,
                    "features_accuracy": [
                        0.7679263353347778,
                        0.7560561895370483,
                        0.7696220874786377,
                        0.7279554009437561,
                        0.731589138507843,
                        0.748062014579773,
                        0.7911821603775024,
                        0.8083817958831787
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": -0.27904622646852734,
                    "pretrain_loss": 0.4895431697368622,
                    "features_accuracy": [
                        0.7853736281394958,
                        0.764554500579834,
                        0.7714437246322632,
                        0.7423726320266724,
                        0.7414641976356506,
                        0.7545613050460815,
                        0.8168672919273376,
                        0.8198955655097961
                    ]
                },
                "val": {
                    "score": -0.44114549034818595,
                    "pretrain_loss": 0.5085501074790955,
                    "features_accuracy": [
                        0.77414470911026,
                        0.754465639591217,
                        0.7756584882736206,
                        0.7190433144569397,
                        0.7332727909088135,
                        0.7287314534187317,
                        0.8019981980323792,
                        0.8119890689849854
                    ]
                },
                "test": {
                    "score": -0.44179936376166484,
                    "pretrain_loss": 0.5086227655410767,
                    "features_accuracy": [
                        0.7676841020584106,
                        0.7514534592628479,
                        0.7686530947685242,
                        0.724321722984314,
                        0.7347383499145508,
                        0.7463662624359131,
                        0.801598846912384,
                        0.8025678396224976
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": -0.33884531571833565,
                    "pretrain_loss": 0.4849722981452942,
                    "features_accuracy": [
                        0.7784844040870667,
                        0.7643274068832397,
                        0.7824211120605469,
                        0.7415398955345154,
                        0.7406314015388489,
                        0.7528200745582581,
                        0.8133848309516907,
                        0.8233780264854431
                    ]
                },
                "val": {
                    "score": -0.4415535814937348,
                    "pretrain_loss": 0.50813889503479,
                    "features_accuracy": [
                        0.7786860466003418,
                        0.7523463368415833,
                        0.7744474411010742,
                        0.7199515700340271,
                        0.7378141283988953,
                        0.7335755228996277,
                        0.8004844188690186,
                        0.8053284883499146
                    ]
                },
                "test": {
                    "score": -0.42426456940269586,
                    "pretrain_loss": 0.5076954960823059,
                    "features_accuracy": [
                        0.760901153087616,
                        0.7531492114067078,
                        0.7688953280448914,
                        0.7245639562606812,
                        0.7274709343910217,
                        0.7483042478561401,
                        0.7982073426246643,
                        0.8103197813034058
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": -0.32854029889249814,
                    "pretrain_loss": 0.49654674530029297,
                    "features_accuracy": [
                        0.7729578614234924,
                        0.766447126865387,
                        0.7768188714981079,
                        0.7335150241851807,
                        0.7356348037719727,
                        0.7491861581802368,
                        0.8130820393562317,
                        0.8136876821517944
                    ]
                },
                "val": {
                    "score": -0.4431088588501906,
                    "pretrain_loss": 0.5064298510551453,
                    "features_accuracy": [
                        0.7753557562828064,
                        0.7529518604278564,
                        0.7774749994277954,
                        0.7235845923423767,
                        0.7347865700721741,
                        0.7341810464859009,
                        0.7983651161193848,
                        0.806236743927002
                    ]
                },
                "test": {
                    "score": -0.42523879113162893,
                    "pretrain_loss": 0.508331835269928,
                    "features_accuracy": [
                        0.7667151093482971,
                        0.7492732405662537,
                        0.7674418687820435,
                        0.7281976938247681,
                        0.7311046719551086,
                        0.7417635917663574,
                        0.806928277015686,
                        0.806928277015686
                    ]
                }
            },
            "80000": {
                "train": {
                    "score": -0.35021811873586706,
                    "pretrain_loss": 0.49379175901412964,
                    "features_accuracy": [
                        0.7768945693969727,
                        0.7646301984786987,
                        0.7743963003158569,
                        0.7356348037719727,
                        0.7349534630775452,
                        0.7497918605804443,
                        0.8158831596374512,
                        0.8126277923583984
                    ]
                },
                "val": {
                    "score": -0.43225354981425457,
                    "pretrain_loss": 0.5067551732063293,
                    "features_accuracy": [
                        0.7744474411010742,
                        0.7465940117835999,
                        0.7720254063606262,
                        0.7223736047744751,
                        0.7338783144950867,
                        0.7347865700721741,
                        0.7956403493881226,
                        0.8122918605804443
                    ]
                },
                "test": {
                    "score": -0.4281583989472972,
                    "pretrain_loss": 0.5045162439346313,
                    "features_accuracy": [
                        0.7691376209259033,
                        0.7570251822471619,
                        0.7691376209259033,
                        0.726017415523529,
                        0.7308623790740967,
                        0.748062014579773,
                        0.8074128031730652,
                        0.8083817958831787
                    ]
                }
            },
            "90000": {
                "train": {
                    "score": -0.3289747930680392,
                    "pretrain_loss": 0.48739954829216003,
                    "features_accuracy": [
                        0.7773488163948059,
                        0.7646301984786987,
                        0.7792414426803589,
                        0.7403286099433899,
                        0.7326822876930237,
                        0.7488833665847778,
                        0.8210311532020569,
                        0.8203498125076294
                    ]
                },
                "val": {
                    "score": -0.43823793344332657,
                    "pretrain_loss": 0.5068984627723694,
                    "features_accuracy": [
                        0.7696033716201782,
                        0.7547683715820312,
                        0.7680895924568176,
                        0.7235845923423767,
                        0.7320617437362671,
                        0.7329699993133545,
                        0.8032091856002808,
                        0.8083560466766357
                    ]
                },
                "test": {
                    "score": -0.4258992952927235,
                    "pretrain_loss": 0.5035647749900818,
                    "features_accuracy": [
                        0.7671996355056763,
                        0.7579941749572754,
                        0.7730135917663574,
                        0.7308623790740967,
                        0.7255329489707947,
                        0.7502422332763672,
                        0.8095930218696594,
                        0.8076550364494324
                    ]
                }
            },
            "100000": {
                "train": {
                    "score": -0.3490628975374079,
                    "pretrain_loss": 0.48512575030326843,
                    "features_accuracy": [
                        0.7762132287025452,
                        0.770156741142273,
                        0.7767431735992432,
                        0.7391172647476196,
                        0.7441896200180054,
                        0.7525172233581543,
                        0.8127034902572632,
                        0.8221667408943176
                    ]
                },
                "val": {
                    "score": -0.43184066730092635,
                    "pretrain_loss": 0.5046722888946533,
                    "features_accuracy": [
                        0.7811080813407898,
                        0.7514380812644958,
                        0.7774749994277954,
                        0.7244929075241089,
                        0.7366030812263489,
                        0.7302452325820923,
                        0.8056312203407288,
                        0.8059340119361877
                    ]
                },
                "test": {
                    "score": -0.4268453115837336,
                    "pretrain_loss": 0.5046535730361938,
                    "features_accuracy": [
                        0.7691376209259033,
                        0.751937985420227,
                        0.773982584476471,
                        0.7250484228134155,
                        0.7289243936538696,
                        0.7456395030021667,
                        0.8062015771865845,
                        0.8122577667236328
                    ]
                }
            }
        },
        "train": {
            "score": -0.3490628975374079
        },
        "val": {
            "score": -0.43184066730092635
        },
        "test": {
            "score": -0.4268453115837336
        }
    },
    "best_iteration": 100000,
    "time": "0:42:23"
}
