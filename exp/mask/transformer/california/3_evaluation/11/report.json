{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask___244f7ca57aa341f2a26a23fbf225738b.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 11,
        "data": {
            "path": "data/california",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "transformer",
            "config": {
                "n_blocks": 4,
                "attention_dropout": 0.23378684224099733,
                "ffn_dropout": 0.16676607141878652,
                "ffn_d_hidden": 865
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear"
            ],
            "d_num_embedding": 512,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.00010485453984042361,
            "weight_decay": 0.0005622737615666989,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.2829421149532736,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.00010485453984042361,
            "weight_decay": 0.0005622737615666989,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "epoch_size": 104,
    "n_parameters": 9805065,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -0.34224383663493857,
                    "pretrain_loss": 0.5141814351081848,
                    "features_accuracy": [
                        0.7665985822677612,
                        0.7516844868659973,
                        0.7644788026809692,
                        0.7311681509017944,
                        0.729124128818512,
                        0.7385116219520569,
                        0.7957453727722168,
                        0.7968052625656128
                    ]
                },
                "val": {
                    "score": -0.4463667677216942,
                    "pretrain_loss": 0.5208166241645813,
                    "features_accuracy": [
                        0.7635483145713806,
                        0.7487133145332336,
                        0.766575813293457,
                        0.7223736047744751,
                        0.7199515700340271,
                        0.7287314534187317,
                        0.7901907563209534,
                        0.7953375577926636
                    ]
                },
                "test": {
                    "score": -0.45807322873648976,
                    "pretrain_loss": 0.5220553874969482,
                    "features_accuracy": [
                        0.7589631676673889,
                        0.7485464811325073,
                        0.7635658979415894,
                        0.7148740291595459,
                        0.7265019416809082,
                        0.7245639562606812,
                        0.7979651093482971,
                        0.7919089198112488
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -0.37060081750641144,
                    "pretrain_loss": 0.5051758885383606,
                    "features_accuracy": [
                        0.7704595327377319,
                        0.7566053867340088,
                        0.7651601433753967,
                        0.7316223978996277,
                        0.7282913327217102,
                        0.7438867688179016,
                        0.7998334765434265,
                        0.8064199090003967
                    ]
                },
                "val": {
                    "score": -0.4438255315055786,
                    "pretrain_loss": 0.5130537152290344,
                    "features_accuracy": [
                        0.7680895924568176,
                        0.7584014534950256,
                        0.7656675577163696,
                        0.7275204062461853,
                        0.7254011631011963,
                        0.7338783144950867,
                        0.791704535484314,
                        0.8019981980323792
                    ]
                },
                "test": {
                    "score": -0.4452972921023298,
                    "pretrain_loss": 0.5173762440681458,
                    "features_accuracy": [
                        0.7577519416809082,
                        0.7548449635505676,
                        0.7662306427955627,
                        0.7165697813034058,
                        0.7303779125213623,
                        0.7298933863639832,
                        0.7999030947685242,
                        0.8076550364494324
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -0.3456285544995054,
                    "pretrain_loss": 0.5016908049583435,
                    "features_accuracy": [
                        0.7736392021179199,
                        0.7637974619865417,
                        0.7717465758323669,
                        0.7291998267173767,
                        0.7335150241851807,
                        0.7453252077102661,
                        0.8055114150047302,
                        0.8051328659057617
                    ]
                },
                "val": {
                    "score": -0.4375060523359278,
                    "pretrain_loss": 0.5111756920814514,
                    "features_accuracy": [
                        0.76203453540802,
                        0.7526491284370422,
                        0.769300639629364,
                        0.7269149422645569,
                        0.7238873839378357,
                        0.7353920936584473,
                        0.8041174411773682,
                        0.8044202327728271
                    ]
                },
                "test": {
                    "score": -0.43496267717239623,
                    "pretrain_loss": 0.5155118107795715,
                    "features_accuracy": [
                        0.7577519416809082,
                        0.755329430103302,
                        0.7669573426246643,
                        0.7185077667236328,
                        0.726017415523529,
                        0.7272287011146545,
                        0.8001453280448914,
                        0.806928277015686
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -0.3425828509510055,
                    "pretrain_loss": 0.4970988631248474,
                    "features_accuracy": [
                        0.7694754004478455,
                        0.76561439037323,
                        0.7728064656257629,
                        0.7329093813896179,
                        0.7357862591743469,
                        0.753879964351654,
                        0.8048300743103027,
                        0.8083882331848145
                    ]
                },
                "val": {
                    "score": -0.44048233043175666,
                    "pretrain_loss": 0.5079906582832336,
                    "features_accuracy": [
                        0.764153778553009,
                        0.7499243021011353,
                        0.7680895924568176,
                        0.7235845923423767,
                        0.7302452325820923,
                        0.7369058132171631,
                        0.7947320342063904,
                        0.803814709186554
                    ]
                },
                "test": {
                    "score": -0.4322106887802775,
                    "pretrain_loss": 0.5141783952713013,
                    "features_accuracy": [
                        0.757267415523529,
                        0.755571722984314,
                        0.7679263353347778,
                        0.7175387740135193,
                        0.7250484228134155,
                        0.7332848906517029,
                        0.8028100728988647,
                        0.8028100728988647
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": -0.3390089566018857,
                    "pretrain_loss": 0.4922342300415039,
                    "features_accuracy": [
                        0.7778030633926392,
                        0.760844886302948,
                        0.7792414426803589,
                        0.7382088303565979,
                        0.7337421774864197,
                        0.7540313601493835,
                        0.8106594085693359,
                        0.8162616491317749
                    ]
                },
                "val": {
                    "score": -0.43688179604349814,
                    "pretrain_loss": 0.5100081562995911,
                    "features_accuracy": [
                        0.7696033716201782,
                        0.7508325576782227,
                        0.7732364535331726,
                        0.7250983715057373,
                        0.7214653491973877,
                        0.7335755228996277,
                        0.7983651161193848,
                        0.8074477910995483
                    ]
                },
                "test": {
                    "score": -0.428384153063659,
                    "pretrain_loss": 0.5141948461532593,
                    "features_accuracy": [
                        0.7577519416809082,
                        0.7531492114067078,
                        0.7640503644943237,
                        0.7182654738426208,
                        0.726259708404541,
                        0.7284399271011353,
                        0.7989341020584106,
                        0.8093507885932922
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": -0.32442166910743464,
                    "pretrain_loss": 0.48712778091430664,
                    "features_accuracy": [
                        0.7757589817047119,
                        0.7663714289665222,
                        0.7796199917793274,
                        0.7401014566421509,
                        0.7320766448974609,
                        0.7582709193229675,
                        0.8102809190750122,
                        0.8210311532020569
                    ]
                },
                "val": {
                    "score": -0.43581559527215813,
                    "pretrain_loss": 0.5076087713241577,
                    "features_accuracy": [
                        0.771722674369812,
                        0.7550711631774902,
                        0.7780805230140686,
                        0.7302452325820923,
                        0.7250983715057373,
                        0.7372086048126221,
                        0.806236743927002,
                        0.8083560466766357
                    ]
                },
                "test": {
                    "score": -0.41969893374552125,
                    "pretrain_loss": 0.5107323527336121,
                    "features_accuracy": [
                        0.7592054009437561,
                        0.7526647448539734,
                        0.7693798542022705,
                        0.7192344665527344,
                        0.7279554009437561,
                        0.7332848906517029,
                        0.8110464811325073,
                        0.8086240291595459
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": -0.36785894278652936,
                    "pretrain_loss": 0.49735939502716064,
                    "features_accuracy": [
                        0.768036961555481,
                        0.7642516493797302,
                        0.7678855657577515,
                        0.7329851388931274,
                        0.7386630773544312,
                        0.7500189542770386,
                        0.8067983984947205,
                        0.8102809190750122
                    ]
                },
                "val": {
                    "score": -0.4394962069115189,
                    "pretrain_loss": 0.5057051181793213,
                    "features_accuracy": [
                        0.766878604888916,
                        0.7502270340919495,
                        0.7750529646873474,
                        0.7296397089958191,
                        0.7244929075241089,
                        0.7359975576400757,
                        0.8065395355224609,
                        0.8101725578308105
                    ]
                },
                "test": {
                    "score": -0.430609549487366,
                    "pretrain_loss": 0.5111699104309082,
                    "features_accuracy": [
                        0.7582364082336426,
                        0.7562984228134155,
                        0.768410861492157,
                        0.7182654738426208,
                        0.7311046719551086,
                        0.7284399271011353,
                        0.8032945990562439,
                        0.8091084957122803
                    ]
                }
            },
            "80000": {
                "train": {
                    "score": -0.30154743186440436,
                    "pretrain_loss": 0.4921935796737671,
                    "features_accuracy": [
                        0.7779544591903687,
                        0.7678098678588867,
                        0.7715951800346375,
                        0.7429782748222351,
                        0.7379059791564941,
                        0.7486562728881836,
                        0.8062684535980225,
                        0.8116436004638672
                    ]
                },
                "val": {
                    "score": -0.4342590868758309,
                    "pretrain_loss": 0.5054274797439575,
                    "features_accuracy": [
                        0.766878604888916,
                        0.7538601160049438,
                        0.776869535446167,
                        0.7284287214279175,
                        0.7260066866874695,
                        0.7335755228996277,
                        0.8065395355224609,
                        0.8044202327728271
                    ]
                },
                "test": {
                    "score": -0.42784839653605283,
                    "pretrain_loss": 0.5089848041534424,
                    "features_accuracy": [
                        0.7621123790740967,
                        0.7546027302742004,
                        0.7722868323326111,
                        0.7216569781303406,
                        0.7265019416809082,
                        0.7328003644943237,
                        0.8066860437393188,
                        0.810562014579773
                    ]
                }
            },
            "90000": {
                "train": {
                    "score": -0.313944265551828,
                    "pretrain_loss": 0.4875129759311676,
                    "features_accuracy": [
                        0.7788628935813904,
                        0.7715194225311279,
                        0.7734878063201904,
                        0.7419941425323486,
                        0.7336664795875549,
                        0.7575895190238953,
                        0.8200469613075256,
                        0.8197441697120667
                    ]
                },
                "val": {
                    "score": -0.432024498108795,
                    "pretrain_loss": 0.5026457905769348,
                    "features_accuracy": [
                        0.7735391855239868,
                        0.7605207562446594,
                        0.778988778591156,
                        0.7254011631011963,
                        0.7296397089958191,
                        0.7326672673225403,
                        0.803814709186554,
                        0.80865877866745
                    ]
                },
                "test": {
                    "score": -0.42497285207309565,
                    "pretrain_loss": 0.5073618292808533,
                    "features_accuracy": [
                        0.7613856792449951,
                        0.753391444683075,
                        0.7708333134651184,
                        0.7218992114067078,
                        0.7255329489707947,
                        0.7357073426246643,
                        0.8078972697257996,
                        0.8110464811325073
                    ]
                }
            },
            "100000": {
                "train": {
                    "score": -0.29438153751479024,
                    "pretrain_loss": 0.4856767952442169,
                    "features_accuracy": [
                        0.7768188714981079,
                        0.7709137797355652,
                        0.7795442938804626,
                        0.7456279993057251,
                        0.7348020672798157,
                        0.7567567825317383,
                        0.8162616491317749,
                        0.8236808776855469
                    ]
                },
                "val": {
                    "score": -0.43788132487138093,
                    "pretrain_loss": 0.5028560757637024,
                    "features_accuracy": [
                        0.7656675577163696,
                        0.7529518604278564,
                        0.7823191285133362,
                        0.7266121506690979,
                        0.7293369770050049,
                        0.7335755228996277,
                        0.8056312203407288,
                        0.8056312203407288
                    ]
                },
                "test": {
                    "score": -0.42511541515179224,
                    "pretrain_loss": 0.5096394419670105,
                    "features_accuracy": [
                        0.7558139562606812,
                        0.755329430103302,
                        0.7725290656089783,
                        0.7228682041168213,
                        0.726017415523529,
                        0.7291666865348816,
                        0.8032945990562439,
                        0.8091084957122803
                    ]
                }
            }
        },
        "train": {
            "score": -0.313944265551828
        },
        "val": {
            "score": -0.432024498108795
        },
        "test": {
            "score": -0.42497285207309565
        }
    },
    "best_iteration": 90000,
    "time": "0:40:54"
}
