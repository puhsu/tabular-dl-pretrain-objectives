{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask___244f7ca57aa341f2a26a23fbf225738b.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 2,
        "data": {
            "path": "data/california",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "transformer",
            "config": {
                "n_blocks": 4,
                "attention_dropout": 0.23378684224099733,
                "ffn_dropout": 0.16676607141878652,
                "ffn_d_hidden": 865
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear"
            ],
            "d_num_embedding": 512,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.00010485453984042361,
            "weight_decay": 0.0005622737615666989,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.2829421149532736,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.00010485453984042361,
            "weight_decay": 0.0005622737615666989,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "epoch_size": 104,
    "n_parameters": 9805065,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -0.31911798036524447,
                    "pretrain_loss": 0.5178431868553162,
                    "features_accuracy": [
                        0.761374831199646,
                        0.7527443766593933,
                        0.767734169960022,
                        0.7304111123085022,
                        0.7189037799835205,
                        0.7325308918952942,
                        0.7905973196029663,
                        0.7930199503898621
                    ]
                },
                "val": {
                    "score": -0.45013160324499957,
                    "pretrain_loss": 0.5237509608268738,
                    "features_accuracy": [
                        0.7523463368415833,
                        0.7344837784767151,
                        0.7599152326583862,
                        0.7311534881591797,
                        0.7250983715057373,
                        0.7405388951301575,
                        0.7907962203025818,
                        0.7901907563209534
                    ]
                },
                "test": {
                    "score": -0.4606257117318025,
                    "pretrain_loss": 0.5211334824562073,
                    "features_accuracy": [
                        0.7691376209259033,
                        0.7529069781303406,
                        0.7550871968269348,
                        0.7512112259864807,
                        0.7097868323326111,
                        0.7233527302742004,
                        0.7805232405662537,
                        0.7856104373931885
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -0.33856310755483515,
                    "pretrain_loss": 0.510270893573761,
                    "features_accuracy": [
                        0.765084445476532,
                        0.7539556622505188,
                        0.7697781920433044,
                        0.7374517917633057,
                        0.7185252904891968,
                        0.7407827973365784,
                        0.7980165481567383,
                        0.8027859926223755
                    ]
                },
                "val": {
                    "score": -0.45084158661209633,
                    "pretrain_loss": 0.5207779407501221,
                    "features_accuracy": [
                        0.7571904063224792,
                        0.7384195923805237,
                        0.7602179646492004,
                        0.7317590117454529,
                        0.7411444187164307,
                        0.7396306395530701,
                        0.791704535484314,
                        0.7935210466384888
                    ]
                },
                "test": {
                    "score": -0.44367488854391807,
                    "pretrain_loss": 0.515785276889801,
                    "features_accuracy": [
                        0.7650193572044373,
                        0.7560561895370483,
                        0.7579941749572754,
                        0.7526647448539734,
                        0.7170542478561401,
                        0.7250484228134155,
                        0.788759708404541,
                        0.7863371968269348
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -0.3211998731182897,
                    "pretrain_loss": 0.49880334734916687,
                    "features_accuracy": [
                        0.7678098678588867,
                        0.7591793537139893,
                        0.7734878063201904,
                        0.7351805567741394,
                        0.7416912913322449,
                        0.7419941425323486,
                        0.8070255517959595,
                        0.8188356757164001
                    ]
                },
                "val": {
                    "score": -0.4466254507250905,
                    "pretrain_loss": 0.5148673057556152,
                    "features_accuracy": [
                        0.7550711631774902,
                        0.7423554062843323,
                        0.76203453540802,
                        0.7338783144950867,
                        0.7387223839759827,
                        0.7411444187164307,
                        0.791704535484314,
                        0.8047229647636414
                    ]
                },
                "test": {
                    "score": -0.43975222205559955,
                    "pretrain_loss": 0.5119428038597107,
                    "features_accuracy": [
                        0.7727712988853455,
                        0.7577519416809082,
                        0.7630813717842102,
                        0.7546027302742004,
                        0.7192344665527344,
                        0.7257751822471619,
                        0.7916666865348816,
                        0.7979651093482971
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -0.32664738678976357,
                    "pretrain_loss": 0.49603113532066345,
                    "features_accuracy": [
                        0.7779544591903687,
                        0.7569838762283325,
                        0.7728821635246277,
                        0.7414641976356506,
                        0.7377545833587646,
                        0.757059633731842,
                        0.8109622597694397,
                        0.8099780678749084
                    ]
                },
                "val": {
                    "score": -0.4468590559386836,
                    "pretrain_loss": 0.514019250869751,
                    "features_accuracy": [
                        0.761731743812561,
                        0.7408416271209717,
                        0.7626399993896484,
                        0.7350893020629883,
                        0.7372086048126221,
                        0.7441719770431519,
                        0.7956403493881226,
                        0.8010899424552917
                    ]
                },
                "test": {
                    "score": -0.4314818417083818,
                    "pretrain_loss": 0.5087044835090637,
                    "features_accuracy": [
                        0.7696220874786377,
                        0.753391444683075,
                        0.7604166865348816,
                        0.753391444683075,
                        0.7185077667236328,
                        0.7235949635505676,
                        0.7991763353347778,
                        0.7984496355056763
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": -0.3596951188133965,
                    "pretrain_loss": 0.49120745062828064,
                    "features_accuracy": [
                        0.7756075859069824,
                        0.761374831199646,
                        0.7750019431114197,
                        0.7372246384620667,
                        0.7482020258903503,
                        0.7553183436393738,
                        0.808766782283783,
                        0.8115679025650024
                    ]
                },
                "val": {
                    "score": -0.44546712179967907,
                    "pretrain_loss": 0.5114406943321228,
                    "features_accuracy": [
                        0.7590069770812988,
                        0.7363003492355347,
                        0.769300639629364,
                        0.7338783144950867,
                        0.7438691854476929,
                        0.7450802326202393,
                        0.7983651161193848,
                        0.8071449995040894
                    ]
                },
                "test": {
                    "score": -0.4423807260094633,
                    "pretrain_loss": 0.5082333087921143,
                    "features_accuracy": [
                        0.773982584476471,
                        0.7521802186965942,
                        0.7601743936538696,
                        0.7538759708404541,
                        0.7218992114067078,
                        0.7279554009437561,
                        0.7986918687820435,
                        0.806928277015686
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": -0.3145292673303056,
                    "pretrain_loss": 0.4848051071166992,
                    "features_accuracy": [
                        0.7788628935813904,
                        0.767734169960022,
                        0.7806798815727234,
                        0.7371489405632019,
                        0.7433568239212036,
                        0.7561511397361755,
                        0.8217881917953491,
                        0.8251192569732666
                    ]
                },
                "val": {
                    "score": -0.44270213338301395,
                    "pretrain_loss": 0.5123868584632874,
                    "features_accuracy": [
                        0.7626399993896484,
                        0.7399333715438843,
                        0.7626399993896484,
                        0.7293369770050049,
                        0.7456857562065125,
                        0.7414471507072449,
                        0.7977595925331116,
                        0.8044202327728271
                    ]
                },
                "test": {
                    "score": -0.43167459003114506,
                    "pretrain_loss": 0.5052093863487244,
                    "features_accuracy": [
                        0.7730135917663574,
                        0.755329430103302,
                        0.7674418687820435,
                        0.7560561895370483,
                        0.7238371968269348,
                        0.7335271239280701,
                        0.7977228760719299,
                        0.8032945990562439
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": -0.3411587684747296,
                    "pretrain_loss": 0.4929690957069397,
                    "features_accuracy": [
                        0.7747747898101807,
                        0.7667499780654907,
                        0.7778787612915039,
                        0.7354077100753784,
                        0.7362404465675354,
                        0.7439624667167664,
                        0.8091453313827515,
                        0.8198198676109314
                    ]
                },
                "val": {
                    "score": -0.4370837582580685,
                    "pretrain_loss": 0.510283350944519,
                    "features_accuracy": [
                        0.7559794187545776,
                        0.7426581978797913,
                        0.7608234882354736,
                        0.7293369770050049,
                        0.7420526742935181,
                        0.7462912201881409,
                        0.8007871508598328,
                        0.8071449995040894
                    ]
                },
                "test": {
                    "score": -0.4309520321030659,
                    "pretrain_loss": 0.5073879957199097,
                    "features_accuracy": [
                        0.7734980583190918,
                        0.755571722984314,
                        0.7589631676673889,
                        0.755329430103302,
                        0.7223837375640869,
                        0.726017415523529,
                        0.8008720874786377,
                        0.7994186282157898
                    ]
                }
            },
            "80000": {
                "train": {
                    "score": -0.3374821888263934,
                    "pretrain_loss": 0.4952787458896637,
                    "features_accuracy": [
                        0.768036961555481,
                        0.764024555683136,
                        0.7788628935813904,
                        0.7376031875610352,
                        0.7362404465675354,
                        0.7474449276924133,
                        0.8120978474617004,
                        0.8115679025650024
                    ]
                },
                "val": {
                    "score": -0.44048096342262444,
                    "pretrain_loss": 0.5104571580886841,
                    "features_accuracy": [
                        0.7602179646492004,
                        0.7441719770431519,
                        0.7674841284751892,
                        0.7326672673225403,
                        0.7399333715438843,
                        0.7411444187164307,
                        0.7944293022155762,
                        0.8141083717346191
                    ]
                },
                "test": {
                    "score": -0.43117469427333616,
                    "pretrain_loss": 0.5060113668441772,
                    "features_accuracy": [
                        0.7790697813034058,
                        0.7558139562606812,
                        0.7633236646652222,
                        0.7546027302742004,
                        0.7189922332763672,
                        0.7277131676673889,
                        0.8023256063461304,
                        0.8020833134651184
                    ]
                }
            },
            "90000": {
                "train": {
                    "score": -0.3372400279112806,
                    "pretrain_loss": 0.4865370988845825,
                    "features_accuracy": [
                        0.7853736281394958,
                        0.7709894776344299,
                        0.7773488163948059,
                        0.7430540323257446,
                        0.7435082197189331,
                        0.7471421360969543,
                        0.8175486922264099,
                        0.8182300329208374
                    ]
                },
                "val": {
                    "score": -0.4379750068365187,
                    "pretrain_loss": 0.5120724439620972,
                    "features_accuracy": [
                        0.7577959299087524,
                        0.7372086048126221,
                        0.7671813368797302,
                        0.7320617437362671,
                        0.7423554062843323,
                        0.7399333715438843,
                        0.7968513369560242,
                        0.8056312203407288
                    ]
                },
                "test": {
                    "score": -0.4289446728905591,
                    "pretrain_loss": 0.5048605799674988,
                    "features_accuracy": [
                        0.7751938104629517,
                        0.7587209343910217,
                        0.7662306427955627,
                        0.7521802186965942,
                        0.7214147448539734,
                        0.7303779125213623,
                        0.806928277015686,
                        0.8042635917663574
                    ]
                }
            },
            "100000": {
                "train": {
                    "score": -0.33325753648449963,
                    "pretrain_loss": 0.4853813052177429,
                    "features_accuracy": [
                        0.7743963003158569,
                        0.7659928798675537,
                        0.7846165895462036,
                        0.7397986650466919,
                        0.7375274896621704,
                        0.754712700843811,
                        0.8176243901252747,
                        0.8218638896942139
                    ]
                },
                "val": {
                    "score": -0.4393026184540761,
                    "pretrain_loss": 0.5093297958374023,
                    "features_accuracy": [
                        0.7574931979179382,
                        0.7402361631393433,
                        0.7708144187927246,
                        0.7308507561683655,
                        0.7405388951301575,
                        0.7387223839759827,
                        0.7977595925331116,
                        0.8089615702629089
                    ]
                },
                "test": {
                    "score": -0.4326494999426506,
                    "pretrain_loss": 0.5056047439575195,
                    "features_accuracy": [
                        0.7810077667236328,
                        0.760901153087616,
                        0.7696220874786377,
                        0.7546027302742004,
                        0.7177810072898865,
                        0.7252907156944275,
                        0.7977228760719299,
                        0.804990291595459
                    ]
                }
            }
        },
        "train": {
            "score": -0.3411587684747296
        },
        "val": {
            "score": -0.4370837582580685
        },
        "test": {
            "score": -0.4309520321030659
        }
    },
    "best_iteration": 70000,
    "time": "0:41:27"
}
