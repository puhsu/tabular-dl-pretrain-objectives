{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask___244f7ca57aa341f2a26a23fbf225738b.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 12,
        "data": {
            "path": "data/california",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "transformer",
            "config": {
                "n_blocks": 4,
                "attention_dropout": 0.23378684224099733,
                "ffn_dropout": 0.16676607141878652,
                "ffn_d_hidden": 865
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear"
            ],
            "d_num_embedding": 512,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.00010485453984042361,
            "weight_decay": 0.0005622737615666989,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.2829421149532736,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.00010485453984042361,
            "weight_decay": 0.0005622737615666989,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "epoch_size": 104,
    "n_parameters": 9805065,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -0.3549864575974297,
                    "pretrain_loss": 0.5210110545158386,
                    "features_accuracy": [
                        0.7558482885360718,
                        0.7455523014068604,
                        0.7602392435073853,
                        0.7236732840538025,
                        0.7250359654426575,
                        0.7394201159477234,
                        0.7839352488517761,
                        0.7993792295455933
                    ]
                },
                "val": {
                    "score": -0.44964653599507787,
                    "pretrain_loss": 0.5200172662734985,
                    "features_accuracy": [
                        0.7535573840141296,
                        0.7517408132553101,
                        0.7696033716201782,
                        0.7363003492355347,
                        0.7235845923423767,
                        0.7263094186782837,
                        0.7862549424171448,
                        0.7829245924949646
                    ]
                },
                "test": {
                    "score": -0.4559044308448058,
                    "pretrain_loss": 0.5239201188087463,
                    "features_accuracy": [
                        0.7473352551460266,
                        0.7512112259864807,
                        0.7577519416809082,
                        0.7177810072898865,
                        0.7117248177528381,
                        0.7420058250427246,
                        0.7810077667236328,
                        0.7950581312179565
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -0.3328612419322416,
                    "pretrain_loss": 0.5055438280105591,
                    "features_accuracy": [
                        0.7691725492477417,
                        0.758422315120697,
                        0.7678098678588867,
                        0.7233704328536987,
                        0.7350291609764099,
                        0.7438867688179016,
                        0.8001362681388855,
                        0.8132334351539612
                    ]
                },
                "val": {
                    "score": -0.44675986895437936,
                    "pretrain_loss": 0.5137104392051697,
                    "features_accuracy": [
                        0.7662730813026428,
                        0.749621570110321,
                        0.7723281979560852,
                        0.7356948256492615,
                        0.7266121506690979,
                        0.7356948256492615,
                        0.79654860496521,
                        0.7980623841285706
                    ]
                },
                "test": {
                    "score": -0.4488771408792787,
                    "pretrain_loss": 0.5185765624046326,
                    "features_accuracy": [
                        0.7633236646652222,
                        0.748062014579773,
                        0.7599321603775024,
                        0.7170542478561401,
                        0.7124515771865845,
                        0.7439438104629517,
                        0.788759708404541,
                        0.8059592843055725
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -0.34008550962481676,
                    "pretrain_loss": 0.5009140968322754,
                    "features_accuracy": [
                        0.7746990919113159,
                        0.7609963417053223,
                        0.7693997025489807,
                        0.7295783162117004,
                        0.7295026183128357,
                        0.7492619156837463,
                        0.8078582882881165,
                        0.8159588575363159
                    ]
                },
                "val": {
                    "score": -0.4473721811651852,
                    "pretrain_loss": 0.5107120871543884,
                    "features_accuracy": [
                        0.7647593021392822,
                        0.7511353492736816,
                        0.77414470911026,
                        0.7317590117454529,
                        0.7311534881591797,
                        0.7350893020629883,
                        0.7932182550430298,
                        0.801392674446106
                    ]
                },
                "test": {
                    "score": -0.4445887481028563,
                    "pretrain_loss": 0.5162133574485779,
                    "features_accuracy": [
                        0.7693798542022705,
                        0.7466084957122803,
                        0.7647771239280701,
                        0.7197189927101135,
                        0.7160852551460266,
                        0.7398256063461304,
                        0.7919089198112488,
                        0.8042635917663574
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -0.3748104596930802,
                    "pretrain_loss": 0.4984317719936371,
                    "features_accuracy": [
                        0.7706109881401062,
                        0.7619804739952087,
                        0.7688697576522827,
                        0.7350291609764099,
                        0.7313196063041687,
                        0.7457793951034546,
                        0.8069498538970947,
                        0.8083882331848145
                    ]
                },
                "val": {
                    "score": -0.4451828791113192,
                    "pretrain_loss": 0.5068435668945312,
                    "features_accuracy": [
                        0.7647593021392822,
                        0.7511353492736816,
                        0.7762640118598938,
                        0.7366030812263489,
                        0.7311534881591797,
                        0.7390251159667969,
                        0.798667848110199,
                        0.8032091856002808
                    ]
                },
                "test": {
                    "score": -0.43428104077656005,
                    "pretrain_loss": 0.5118587017059326,
                    "features_accuracy": [
                        0.7676841020584106,
                        0.7521802186965942,
                        0.7642926573753357,
                        0.7165697813034058,
                        0.7218992114067078,
                        0.7434592843055725,
                        0.7991763353347778,
                        0.8103197813034058
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": -0.3135273210121137,
                    "pretrain_loss": 0.4917319416999817,
                    "features_accuracy": [
                        0.7763646245002747,
                        0.7619804739952087,
                        0.7768945693969727,
                        0.7395715117454529,
                        0.7269286513328552,
                        0.754182755947113,
                        0.8138390779495239,
                        0.8172458410263062
                    ]
                },
                "val": {
                    "score": -0.4419139260475655,
                    "pretrain_loss": 0.5055903196334839,
                    "features_accuracy": [
                        0.7659703493118286,
                        0.7499243021011353,
                        0.7780805230140686,
                        0.7329699993133545,
                        0.7335755228996277,
                        0.7423554062843323,
                        0.798667848110199,
                        0.8010899424552917
                    ]
                },
                "test": {
                    "score": -0.43298853798100984,
                    "pretrain_loss": 0.5102301239967346,
                    "features_accuracy": [
                        0.7618701457977295,
                        0.7543604373931885,
                        0.7701066136360168,
                        0.7194767594337463,
                        0.7185077667236328,
                        0.742732584476471,
                        0.7969961166381836,
                        0.8117732405662537
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": -0.29013433378730563,
                    "pretrain_loss": 0.48685482144355774,
                    "features_accuracy": [
                        0.7775759100914001,
                        0.7672799229621887,
                        0.7759860754013062,
                        0.7381331324577332,
                        0.7400257587432861,
                        0.7556211948394775,
                        0.8153532147407532,
                        0.8259520530700684
                    ]
                },
                "val": {
                    "score": -0.438989558274285,
                    "pretrain_loss": 0.5050391554832458,
                    "features_accuracy": [
                        0.7650620341300964,
                        0.759612500667572,
                        0.7798970341682434,
                        0.7369058132171631,
                        0.7366030812263489,
                        0.7417499423027039,
                        0.8032091856002808,
                        0.8004844188690186
                    ]
                },
                "test": {
                    "score": -0.42794279741770747,
                    "pretrain_loss": 0.5102140307426453,
                    "features_accuracy": [
                        0.7667151093482971,
                        0.7526647448539734,
                        0.7686530947685242,
                        0.7245639562606812,
                        0.7211724519729614,
                        0.75,
                        0.8025678396224976,
                        0.8071705102920532
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": -0.3159809276112457,
                    "pretrain_loss": 0.49530622363090515,
                    "features_accuracy": [
                        0.7703838348388672,
                        0.76031494140625,
                        0.7750776410102844,
                        0.7413884997367859,
                        0.7351048588752747,
                        0.7516087889671326,
                        0.8105837106704712,
                        0.811416506767273
                    ]
                },
                "val": {
                    "score": -0.44204625802994313,
                    "pretrain_loss": 0.5045469999313354,
                    "features_accuracy": [
                        0.7650620341300964,
                        0.7571904063224792,
                        0.7777777910232544,
                        0.7353920936584473,
                        0.7326672673225403,
                        0.7441719770431519,
                        0.806236743927002,
                        0.8007871508598328
                    ]
                },
                "test": {
                    "score": -0.4254062485572433,
                    "pretrain_loss": 0.5089174509048462,
                    "features_accuracy": [
                        0.768410861492157,
                        0.7543604373931885,
                        0.7671996355056763,
                        0.7209302186965942,
                        0.7153584957122803,
                        0.742732584476471,
                        0.8006298542022705,
                        0.8054748177528381
                    ]
                }
            },
            "80000": {
                "train": {
                    "score": -0.2964239243454837,
                    "pretrain_loss": 0.4936235547065735,
                    "features_accuracy": [
                        0.7813612222671509,
                        0.7606177926063538,
                        0.7733364105224609,
                        0.7379059791564941,
                        0.7431297302246094,
                        0.7538042664527893,
                        0.8065713047981262,
                        0.8126277923583984
                    ]
                },
                "val": {
                    "score": -0.4340536138900946,
                    "pretrain_loss": 0.5016360878944397,
                    "features_accuracy": [
                        0.7656675577163696,
                        0.7599152326583862,
                        0.781410813331604,
                        0.7366030812263489,
                        0.7278231978416443,
                        0.7408416271209717,
                        0.8032091856002808,
                        0.8077505230903625
                    ]
                },
                "test": {
                    "score": -0.43056960146452444,
                    "pretrain_loss": 0.5078743696212769,
                    "features_accuracy": [
                        0.7679263353347778,
                        0.7543604373931885,
                        0.7701066136360168,
                        0.7180232405662537,
                        0.7175387740135193,
                        0.748062014579773,
                        0.8045058250427246,
                        0.8081395030021667
                    ]
                }
            },
            "90000": {
                "train": {
                    "score": -0.323157308715406,
                    "pretrain_loss": 0.4882829785346985,
                    "features_accuracy": [
                        0.7749261856079102,
                        0.767734169960022,
                        0.7733364105224609,
                        0.7407827973365784,
                        0.7414641976356506,
                        0.7579680681228638,
                        0.8150503635406494,
                        0.8173215389251709
                    ]
                },
                "val": {
                    "score": -0.4353221838381983,
                    "pretrain_loss": 0.5011765956878662,
                    "features_accuracy": [
                        0.7653648257255554,
                        0.7611262202262878,
                        0.7795943021774292,
                        0.7381168603897095,
                        0.7302452325820923,
                        0.7369058132171631,
                        0.8035119771957397,
                        0.8010899424552917
                    ]
                },
                "test": {
                    "score": -0.4268093612238346,
                    "pretrain_loss": 0.50690096616745,
                    "features_accuracy": [
                        0.7710756063461304,
                        0.7546027302742004,
                        0.7701066136360168,
                        0.7216569781303406,
                        0.7189922332763672,
                        0.7478197813034058,
                        0.8078972697257996,
                        0.8071705102920532
                    ]
                }
            },
            "100000": {
                "train": {
                    "score": -0.28424967960761943,
                    "pretrain_loss": 0.48568230867385864,
                    "features_accuracy": [
                        0.7890075445175171,
                        0.7625104188919067,
                        0.7756075859069824,
                        0.7366189956665039,
                        0.7425997853279114,
                        0.7539556622505188,
                        0.8195927143096924,
                        0.8211068511009216
                    ]
                },
                "val": {
                    "score": -0.43289041537726636,
                    "pretrain_loss": 0.5005322694778442,
                    "features_accuracy": [
                        0.7726309299468994,
                        0.756887674331665,
                        0.778988778591156,
                        0.7375113368034363,
                        0.7359975576400757,
                        0.7441719770431519,
                        0.8041174411773682,
                        0.8074477910995483
                    ]
                },
                "test": {
                    "score": -0.42368056707002166,
                    "pretrain_loss": 0.5069381594657898,
                    "features_accuracy": [
                        0.7696220874786377,
                        0.7592054009437561,
                        0.7642926573753357,
                        0.7199612259864807,
                        0.7233527302742004,
                        0.7475774884223938,
                        0.8047480583190918,
                        0.8132267594337463
                    ]
                }
            }
        },
        "train": {
            "score": -0.28424967960761943
        },
        "val": {
            "score": -0.43289041537726636
        },
        "test": {
            "score": -0.42368056707002166
        }
    },
    "best_iteration": 100000,
    "time": "0:41:48"
}
