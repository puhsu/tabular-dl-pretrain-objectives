{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask___244f7ca57aa341f2a26a23fbf225738b.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 13,
        "data": {
            "path": "data/california",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "transformer",
            "config": {
                "n_blocks": 4,
                "attention_dropout": 0.23378684224099733,
                "ffn_dropout": 0.16676607141878652,
                "ffn_d_hidden": 865
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear"
            ],
            "d_num_embedding": 512,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.00010485453984042361,
            "weight_decay": 0.0005622737615666989,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.2829421149532736,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.00010485453984042361,
            "weight_decay": 0.0005622737615666989,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "epoch_size": 104,
    "n_parameters": 9805065,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -0.3646301508087153,
                    "pretrain_loss": 0.5215646624565125,
                    "features_accuracy": [
                        0.759255051612854,
                        0.7475963830947876,
                        0.7615262866020203,
                        0.7286698818206787,
                        0.7220077514648438,
                        0.7336664795875549,
                        0.7869634628295898,
                        0.7905216217041016
                    ]
                },
                "val": {
                    "score": -0.45164494445550485,
                    "pretrain_loss": 0.5254144072532654,
                    "features_accuracy": [
                        0.7574931979179382,
                        0.7396306395530701,
                        0.7611262202262878,
                        0.7160157561302185,
                        0.7132909297943115,
                        0.7456857562065125,
                        0.7874659299850464,
                        0.7968513369560242
                    ]
                },
                "test": {
                    "score": -0.45353693266529,
                    "pretrain_loss": 0.5175103545188904,
                    "features_accuracy": [
                        0.7693798542022705,
                        0.7509689927101135,
                        0.7671996355056763,
                        0.7294089198112488,
                        0.7361918687820435,
                        0.7279554009437561,
                        0.788517415523529,
                        0.7994186282157898
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -0.34415995311185754,
                    "pretrain_loss": 0.5068851709365845,
                    "features_accuracy": [
                        0.7641759514808655,
                        0.7522901296615601,
                        0.766674280166626,
                        0.7320766448974609,
                        0.7268529534339905,
                        0.7482020258903503,
                        0.7983193397521973,
                        0.8072526454925537
                    ]
                },
                "val": {
                    "score": -0.44941232529072994,
                    "pretrain_loss": 0.5186759233474731,
                    "features_accuracy": [
                        0.759612500667572,
                        0.744777500629425,
                        0.766575813293457,
                        0.7166212797164917,
                        0.7135937213897705,
                        0.7468967437744141,
                        0.7995761632919312,
                        0.8019981980323792
                    ]
                },
                "test": {
                    "score": -0.4461474361923825,
                    "pretrain_loss": 0.5112048983573914,
                    "features_accuracy": [
                        0.7698643207550049,
                        0.748062014579773,
                        0.7715600728988647,
                        0.7257751822471619,
                        0.739098846912384,
                        0.7277131676673889,
                        0.7982073426246643,
                        0.8001453280448914
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -0.29553758832770394,
                    "pretrain_loss": 0.4989158511161804,
                    "features_accuracy": [
                        0.7774245142936707,
                        0.758422315120697,
                        0.7753804326057434,
                        0.7424483299255371,
                        0.7297297716140747,
                        0.7432811260223389,
                        0.8030131459236145,
                        0.8168672919273376
                    ]
                },
                "val": {
                    "score": -0.4438058135522741,
                    "pretrain_loss": 0.5173805356025696,
                    "features_accuracy": [
                        0.7584014534950256,
                        0.7441719770431519,
                        0.7608234882354736,
                        0.7145019769668579,
                        0.7135937213897705,
                        0.7450802326202393,
                        0.79654860496521,
                        0.8077505230903625
                    ]
                },
                "test": {
                    "score": -0.43790408263189273,
                    "pretrain_loss": 0.5077769160270691,
                    "features_accuracy": [
                        0.7701066136360168,
                        0.7490310072898865,
                        0.7732558250427246,
                        0.7281976938247681,
                        0.7386143207550049,
                        0.729651153087616,
                        0.8037790656089783,
                        0.806928277015686
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -0.33392913906387517,
                    "pretrain_loss": 0.4952963888645172,
                    "features_accuracy": [
                        0.7738663554191589,
                        0.7678098678588867,
                        0.768566906452179,
                        0.7330608367919922,
                        0.7371489405632019,
                        0.7479748725891113,
                        0.8109622597694397,
                        0.8124006390571594
                    ]
                },
                "val": {
                    "score": -0.4431599054063016,
                    "pretrain_loss": 0.5153500437736511,
                    "features_accuracy": [
                        0.7577959299087524,
                        0.7459884881973267,
                        0.764153778553009,
                        0.7160157561302185,
                        0.7169240117073059,
                        0.7490160465240479,
                        0.7998788952827454,
                        0.8056312203407288
                    ]
                },
                "test": {
                    "score": -0.4467092787068107,
                    "pretrain_loss": 0.5060023069381714,
                    "features_accuracy": [
                        0.7705910801887512,
                        0.7548449635505676,
                        0.7810077667236328,
                        0.7313469052314758,
                        0.7378876209259033,
                        0.7349806427955627,
                        0.8030523061752319,
                        0.8071705102920532
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": -0.3530568423507019,
                    "pretrain_loss": 0.4916004240512848,
                    "features_accuracy": [
                        0.7750776410102844,
                        0.7602392435073853,
                        0.7715951800346375,
                        0.7425240874290466,
                        0.7295783162117004,
                        0.7511545419692993,
                        0.8136876821517944,
                        0.8207283020019531
                    ]
                },
                "val": {
                    "score": -0.43858088905034587,
                    "pretrain_loss": 0.5130416750907898,
                    "features_accuracy": [
                        0.764153778553009,
                        0.7456857562065125,
                        0.7708144187927246,
                        0.7175295352935791,
                        0.7175295352935791,
                        0.7535573840141296,
                        0.8032091856002808,
                        0.8068422675132751
                    ]
                },
                "test": {
                    "score": -0.43822863589045025,
                    "pretrain_loss": 0.5066835880279541,
                    "features_accuracy": [
                        0.775678277015686,
                        0.7541182041168213,
                        0.7713178396224976,
                        0.7298933863639832,
                        0.737160861492157,
                        0.7323158979415894,
                        0.8045058250427246,
                        0.8120154738426208
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": -0.3751309181824852,
                    "pretrain_loss": 0.4842900037765503,
                    "features_accuracy": [
                        0.7836323976516724,
                        0.7607691884040833,
                        0.7830267548561096,
                        0.7394201159477234,
                        0.7388144731521606,
                        0.7558482885360718,
                        0.8194413185119629,
                        0.8305701017379761
                    ]
                },
                "val": {
                    "score": -0.4366929318036767,
                    "pretrain_loss": 0.5127845406532288,
                    "features_accuracy": [
                        0.7626399993896484,
                        0.7453829646110535,
                        0.7708144187927246,
                        0.7163184881210327,
                        0.7123826742172241,
                        0.7505298256874084,
                        0.8056312203407288,
                        0.8029064536094666
                    ]
                },
                "test": {
                    "score": -0.43206647175185264,
                    "pretrain_loss": 0.5047925710678101,
                    "features_accuracy": [
                        0.7705910801887512,
                        0.7497577667236328,
                        0.7747092843055725,
                        0.7286821603775024,
                        0.7398256063461304,
                        0.7337693572044373,
                        0.804990291595459,
                        0.8112887740135193
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": -0.3460889202381544,
                    "pretrain_loss": 0.4944181740283966,
                    "features_accuracy": [
                        0.7796956896781921,
                        0.7555454969406128,
                        0.7739420533180237,
                        0.7340449690818787,
                        0.7256416082382202,
                        0.7571353316307068,
                        0.8144447207450867,
                        0.8183814287185669
                    ]
                },
                "val": {
                    "score": -0.43764389065940595,
                    "pretrain_loss": 0.5119910836219788,
                    "features_accuracy": [
                        0.7686951160430908,
                        0.7475022673606873,
                        0.7677868604660034,
                        0.7172267436981201,
                        0.7138964533805847,
                        0.7532545924186707,
                        0.8059340119361877,
                        0.8101725578308105
                    ]
                },
                "test": {
                    "score": -0.42181842185864027,
                    "pretrain_loss": 0.5011203289031982,
                    "features_accuracy": [
                        0.7749515771865845,
                        0.7550871968269348,
                        0.7754360437393188,
                        0.729651153087616,
                        0.7407945990562439,
                        0.7340116500854492,
                        0.8062015771865845,
                        0.8127422332763672
                    ]
                }
            },
            "80000": {
                "train": {
                    "score": -0.3471569314422448,
                    "pretrain_loss": 0.49128201603889465,
                    "features_accuracy": [
                        0.7796199917793274,
                        0.7625104188919067,
                        0.7770459651947021,
                        0.7358619570732117,
                        0.7335907816886902,
                        0.7556211948394775,
                        0.8189113736152649,
                        0.8175486922264099
                    ]
                },
                "val": {
                    "score": -0.43732709588789587,
                    "pretrain_loss": 0.5116685032844543,
                    "features_accuracy": [
                        0.7656675577163696,
                        0.7468967437744141,
                        0.7647593021392822,
                        0.7145019769668579,
                        0.7148047089576721,
                        0.744777500629425,
                        0.8044202327728271,
                        0.8159249424934387
                    ]
                },
                "test": {
                    "score": -0.4262510719116996,
                    "pretrain_loss": 0.5014252066612244,
                    "features_accuracy": [
                        0.7725290656089783,
                        0.757267415523529,
                        0.7781007885932922,
                        0.7328003644943237,
                        0.739098846912384,
                        0.7366763353347778,
                        0.8112887740135193,
                        0.8117732405662537
                    ]
                }
            },
            "90000": {
                "train": {
                    "score": -0.33321722649865543,
                    "pretrain_loss": 0.4869685471057892,
                    "features_accuracy": [
                        0.7810583710670471,
                        0.7642516493797302,
                        0.7759103775024414,
                        0.7436596751213074,
                        0.7408585548400879,
                        0.757892370223999,
                        0.8127791881561279,
                        0.8218638896942139
                    ]
                },
                "val": {
                    "score": -0.43588787233924176,
                    "pretrain_loss": 0.5098301768302917,
                    "features_accuracy": [
                        0.7671813368797302,
                        0.7481077909469604,
                        0.77414470911026,
                        0.7126854062080383,
                        0.7154102325439453,
                        0.7456857562065125,
                        0.8053284883499146,
                        0.8098698258399963
                    ]
                },
                "test": {
                    "score": -0.42778360554340933,
                    "pretrain_loss": 0.5016381740570068,
                    "features_accuracy": [
                        0.773982584476471,
                        0.7562984228134155,
                        0.7720445990562439,
                        0.726259708404541,
                        0.7376453280448914,
                        0.7335271239280701,
                        0.8091084957122803,
                        0.8166182041168213
                    ]
                }
            },
            "100000": {
                "train": {
                    "score": -0.34452768306475423,
                    "pretrain_loss": 0.4804939031600952,
                    "features_accuracy": [
                        0.7772731184959412,
                        0.7775759100914001,
                        0.7855250239372253,
                        0.7401771545410156,
                        0.7410856485366821,
                        0.7591793537139893,
                        0.8224695324897766,
                        0.8211068511009216
                    ]
                },
                "val": {
                    "score": -0.43247329097617593,
                    "pretrain_loss": 0.5094185471534729,
                    "features_accuracy": [
                        0.7650620341300964,
                        0.7481077909469604,
                        0.7680895924568176,
                        0.7175295352935791,
                        0.7220708131790161,
                        0.7529518604278564,
                        0.801392674446106,
                        0.8147138953208923
                    ]
                },
                "test": {
                    "score": -0.4194164177889102,
                    "pretrain_loss": 0.5005511045455933,
                    "features_accuracy": [
                        0.7725290656089783,
                        0.7579941749572754,
                        0.7749515771865845,
                        0.7303779125213623,
                        0.7412790656089783,
                        0.7357073426246643,
                        0.8088662624359131,
                        0.8132267594337463
                    ]
                }
            }
        },
        "train": {
            "score": -0.34452768306475423
        },
        "val": {
            "score": -0.43247329097617593
        },
        "test": {
            "score": -0.4194164177889102
        }
    },
    "best_iteration": 100000,
    "time": "0:41:01"
}
