{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask___244f7ca57aa341f2a26a23fbf225738b.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 7,
        "data": {
            "path": "data/california",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "transformer",
            "config": {
                "n_blocks": 4,
                "attention_dropout": 0.23378684224099733,
                "ffn_dropout": 0.16676607141878652,
                "ffn_d_hidden": 865
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear"
            ],
            "d_num_embedding": 512,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.00010485453984042361,
            "weight_decay": 0.0005622737615666989,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.2829421149532736,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.00010485453984042361,
            "weight_decay": 0.0005622737615666989,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "epoch_size": 104,
    "n_parameters": 9805065,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -0.37396431170144667,
                    "pretrain_loss": 0.5157446265220642,
                    "features_accuracy": [
                        0.7668256759643555,
                        0.7482777237892151,
                        0.7658414840698242,
                        0.7335907816886902,
                        0.7281399369239807,
                        0.7348777651786804,
                        0.7876448035240173,
                        0.7966538071632385
                    ]
                },
                "val": {
                    "score": -0.44997377120042303,
                    "pretrain_loss": 0.521379292011261,
                    "features_accuracy": [
                        0.7653648257255554,
                        0.7535573840141296,
                        0.7478049993515015,
                        0.7317590117454529,
                        0.7232818603515625,
                        0.7269149422645569,
                        0.7847411632537842,
                        0.8047229647636414
                    ]
                },
                "test": {
                    "score": -0.4480408673830992,
                    "pretrain_loss": 0.5226855278015137,
                    "features_accuracy": [
                        0.7616279125213623,
                        0.7473352551460266,
                        0.7611433863639832,
                        0.7185077667236328,
                        0.726259708404541,
                        0.7342538833618164,
                        0.7870639562606812,
                        0.788517415523529
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -0.35465013166241566,
                    "pretrain_loss": 0.5055350661277771,
                    "features_accuracy": [
                        0.7736392021179199,
                        0.7569838762283325,
                        0.7712923288345337,
                        0.7375274896621704,
                        0.7279885411262512,
                        0.7494890093803406,
                        0.794912576675415,
                        0.8064199090003967
                    ]
                },
                "val": {
                    "score": -0.44636350766075794,
                    "pretrain_loss": 0.5147690176963806,
                    "features_accuracy": [
                        0.7638510465621948,
                        0.7529518604278564,
                        0.7481077909469604,
                        0.7278231978416443,
                        0.7266121506690979,
                        0.7278231978416443,
                        0.7971541285514832,
                        0.8023009300231934
                    ]
                },
                "test": {
                    "score": -0.43990252012226305,
                    "pretrain_loss": 0.515762448310852,
                    "features_accuracy": [
                        0.7630813717842102,
                        0.7514534592628479,
                        0.760901153087616,
                        0.7223837375640869,
                        0.7250484228134155,
                        0.7340116500854492,
                        0.7877907156944275,
                        0.7960271239280701
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -0.34982247675455014,
                    "pretrain_loss": 0.5006497502326965,
                    "features_accuracy": [
                        0.7711409330368042,
                        0.7542585134506226,
                        0.7734878063201904,
                        0.7345749139785767,
                        0.7326822876930237,
                        0.7486562728881836,
                        0.8065713047981262,
                        0.8086910843849182
                    ]
                },
                "val": {
                    "score": -0.4407274804870667,
                    "pretrain_loss": 0.5141589641571045,
                    "features_accuracy": [
                        0.7686951160430908,
                        0.754465639591217,
                        0.7511353492736816,
                        0.7275204062461853,
                        0.7214653491973877,
                        0.7281259298324585,
                        0.7959430813789368,
                        0.8068422675132751
                    ]
                },
                "test": {
                    "score": -0.4353207084106296,
                    "pretrain_loss": 0.5143633484840393,
                    "features_accuracy": [
                        0.7715600728988647,
                        0.7550871968269348,
                        0.7681686282157898,
                        0.722141444683075,
                        0.726017415523529,
                        0.7366763353347778,
                        0.7870639562606812,
                        0.8035368323326111
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -0.3374098160812055,
                    "pretrain_loss": 0.4971388280391693,
                    "features_accuracy": [
                        0.7751533389091492,
                        0.7644031047821045,
                        0.7689454555511475,
                        0.7382088303565979,
                        0.7272314429283142,
                        0.7491861581802368,
                        0.8064956068992615,
                        0.8110379576683044
                    ]
                },
                "val": {
                    "score": -0.4428472832028052,
                    "pretrain_loss": 0.5118394494056702,
                    "features_accuracy": [
                        0.7723281979560852,
                        0.7559794187545776,
                        0.7526491284370422,
                        0.7314562201499939,
                        0.7241901159286499,
                        0.7329699993133545,
                        0.794126570224762,
                        0.8116863369941711
                    ]
                },
                "test": {
                    "score": -0.432306667451845,
                    "pretrain_loss": 0.5134251117706299,
                    "features_accuracy": [
                        0.7715600728988647,
                        0.7546027302742004,
                        0.7662306427955627,
                        0.7228682041168213,
                        0.7306201457977295,
                        0.7400678396224976,
                        0.786579430103302,
                        0.8018410801887512
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": -0.3308510682377585,
                    "pretrain_loss": 0.48862648010253906,
                    "features_accuracy": [
                        0.7806798815727234,
                        0.7662200331687927,
                        0.7789386510848999,
                        0.7379816770553589,
                        0.7376788854598999,
                        0.7548641562461853,
                        0.8136876821517944,
                        0.8194413185119629
                    ]
                },
                "val": {
                    "score": -0.44402250466664706,
                    "pretrain_loss": 0.5089747309684753,
                    "features_accuracy": [
                        0.7744474411010742,
                        0.7553738951683044,
                        0.7550711631774902,
                        0.7293369770050049,
                        0.7244929075241089,
                        0.7335755228996277,
                        0.8026036620140076,
                        0.8125945925712585
                    ]
                },
                "test": {
                    "score": -0.43271662375518605,
                    "pretrain_loss": 0.5107719898223877,
                    "features_accuracy": [
                        0.7647771239280701,
                        0.7495154738426208,
                        0.7679263353347778,
                        0.7238371968269348,
                        0.7267441749572754,
                        0.7417635917663574,
                        0.8008720874786377,
                        0.8011143207550049
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": -0.32252214962716697,
                    "pretrain_loss": 0.48837050795555115,
                    "features_accuracy": [
                        0.7734878063201904,
                        0.7633432149887085,
                        0.7751533389091492,
                        0.7447195053100586,
                        0.7398743629455566,
                        0.757362425327301,
                        0.8136119842529297,
                        0.8167158961296082
                    ]
                },
                "val": {
                    "score": -0.4418617134952046,
                    "pretrain_loss": 0.510254442691803,
                    "features_accuracy": [
                        0.7686951160430908,
                        0.7526491284370422,
                        0.7547683715820312,
                        0.7260066866874695,
                        0.7217680811882019,
                        0.7326672673225403,
                        0.7995761632919312,
                        0.8068422675132751
                    ]
                },
                "test": {
                    "score": -0.4347718482224526,
                    "pretrain_loss": 0.5099104046821594,
                    "features_accuracy": [
                        0.770348846912384,
                        0.7550871968269348,
                        0.7659883499145508,
                        0.7226259708404541,
                        0.7279554009437561,
                        0.7357073426246643,
                        0.7984496355056763,
                        0.8047480583190918
                    ]
                }
            }
        },
        "train": {
            "score": -0.34982247675455014
        },
        "val": {
            "score": -0.4407274804870667
        },
        "test": {
            "score": -0.4353207084106296
        }
    },
    "best_iteration": 30000,
    "time": "0:24:17"
}
