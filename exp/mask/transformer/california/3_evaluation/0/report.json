{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask___244f7ca57aa341f2a26a23fbf225738b.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 0,
        "data": {
            "path": "data/california",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "transformer",
            "config": {
                "n_blocks": 4,
                "attention_dropout": 0.23378684224099733,
                "ffn_dropout": 0.16676607141878652,
                "ffn_d_hidden": 865
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear"
            ],
            "d_num_embedding": 512,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.00010485453984042361,
            "weight_decay": 0.0005622737615666989,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.2829421149532736,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.00010485453984042361,
            "weight_decay": 0.0005622737615666989,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "epoch_size": 104,
    "n_parameters": 9805065,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -0.3353703056039459,
                    "pretrain_loss": 0.5166831016540527,
                    "features_accuracy": [
                        0.7644788026809692,
                        0.7469907402992249,
                        0.764024555683136,
                        0.729124128818512,
                        0.7228404879570007,
                        0.7395715117454529,
                        0.7930956482887268,
                        0.8000605702400208
                    ]
                },
                "val": {
                    "score": -0.4520630267541294,
                    "pretrain_loss": 0.5241090655326843,
                    "features_accuracy": [
                        0.752043604850769,
                        0.7405388951301575,
                        0.7608234882354736,
                        0.7211625576019287,
                        0.7178322672843933,
                        0.7299425005912781,
                        0.8016954064369202,
                        0.7944293022155762
                    ]
                },
                "test": {
                    "score": -0.45236466575486706,
                    "pretrain_loss": 0.5224179625511169,
                    "features_accuracy": [
                        0.7550871968269348,
                        0.7449128031730652,
                        0.7611433863639832,
                        0.7303779125213623,
                        0.7117248177528381,
                        0.7335271239280701,
                        0.7856104373931885,
                        0.7955426573753357
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -0.345728932258974,
                    "pretrain_loss": 0.5041525959968567,
                    "features_accuracy": [
                        0.767204225063324,
                        0.7572110295295715,
                        0.7611477375030518,
                        0.7379059791564941,
                        0.7313953042030334,
                        0.7447195053100586,
                        0.80157470703125,
                        0.8089938759803772
                    ]
                },
                "val": {
                    "score": -0.4438028738741057,
                    "pretrain_loss": 0.5195519924163818,
                    "features_accuracy": [
                        0.7599152326583862,
                        0.7432637214660645,
                        0.7614290118217468,
                        0.7202543020248413,
                        0.7166212797164917,
                        0.7323645353317261,
                        0.8010899424552917,
                        0.798970639705658
                    ]
                },
                "test": {
                    "score": -0.44131591718759416,
                    "pretrain_loss": 0.518699586391449,
                    "features_accuracy": [
                        0.7560561895370483,
                        0.7475774884223938,
                        0.7587209343910217,
                        0.7291666865348816,
                        0.7139050364494324,
                        0.7349806427955627,
                        0.7856104373931885,
                        0.7972383499145508
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -0.3567008498108404,
                    "pretrain_loss": 0.49953097105026245,
                    "features_accuracy": [
                        0.7753047347068787,
                        0.7581194639205933,
                        0.7691725492477417,
                        0.7391172647476196,
                        0.729956865310669,
                        0.7456279993057251,
                        0.8074040412902832,
                        0.8114922046661377
                    ]
                },
                "val": {
                    "score": -0.43865467802343255,
                    "pretrain_loss": 0.5162944197654724,
                    "features_accuracy": [
                        0.7638510465621948,
                        0.7478049993515015,
                        0.7638510465621948,
                        0.7190433144569397,
                        0.7163184881210327,
                        0.7399333715438843,
                        0.8101725578308105,
                        0.8001816272735596
                    ]
                },
                "test": {
                    "score": -0.43344533939675395,
                    "pretrain_loss": 0.5152616500854492,
                    "features_accuracy": [
                        0.7616279125213623,
                        0.7512112259864807,
                        0.7633236646652222,
                        0.7274709343910217,
                        0.7129360437393188,
                        0.7349806427955627,
                        0.7933623790740967,
                        0.8035368323326111
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -0.3440085210311713,
                    "pretrain_loss": 0.49460703134536743,
                    "features_accuracy": [
                        0.7715951800346375,
                        0.7646301984786987,
                        0.7728821635246277,
                        0.7380574345588684,
                        0.7402529120445251,
                        0.753652811050415,
                        0.8053600192070007,
                        0.8127034902572632
                    ]
                },
                "val": {
                    "score": -0.43520012140793407,
                    "pretrain_loss": 0.5144422650337219,
                    "features_accuracy": [
                        0.764456570148468,
                        0.7475022673606873,
                        0.766878604888916,
                        0.7220708131790161,
                        0.7160157561302185,
                        0.7438691854476929,
                        0.7980623841285706,
                        0.8016954064369202
                    ]
                },
                "test": {
                    "score": -0.42723222700162256,
                    "pretrain_loss": 0.5123230814933777,
                    "features_accuracy": [
                        0.7623546719551086,
                        0.7473352551460266,
                        0.7674418687820435,
                        0.7284399271011353,
                        0.7146317958831787,
                        0.7344961166381836,
                        0.7957848906517029,
                        0.8083817958831787
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": -0.30011804966167843,
                    "pretrain_loss": 0.4917098879814148,
                    "features_accuracy": [
                        0.7756075859069824,
                        0.7637217044830322,
                        0.7710652351379395,
                        0.7360890507698059,
                        0.7286698818206787,
                        0.754182755947113,
                        0.8158074021339417,
                        0.8133091330528259
                    ]
                },
                "val": {
                    "score": -0.4384717959087417,
                    "pretrain_loss": 0.5126799941062927,
                    "features_accuracy": [
                        0.7577959299087524,
                        0.749621570110321,
                        0.7726309299468994,
                        0.7241901159286499,
                        0.7208598256111145,
                        0.7381168603897095,
                        0.8044202327728271,
                        0.8065395355224609
                    ]
                },
                "test": {
                    "score": -0.438608461266563,
                    "pretrain_loss": 0.5107687711715698,
                    "features_accuracy": [
                        0.7638081312179565,
                        0.7529069781303406,
                        0.7679263353347778,
                        0.7267441749572754,
                        0.713178277015686,
                        0.7364341020584106,
                        0.7989341020584106,
                        0.8125
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": -0.30933991174267794,
                    "pretrain_loss": 0.4867331385612488,
                    "features_accuracy": [
                        0.7837837934494019,
                        0.7631917595863342,
                        0.7756832838058472,
                        0.7410856485366821,
                        0.7365432977676392,
                        0.7558482885360718,
                        0.8210311532020569,
                        0.8192142248153687
                    ]
                },
                "val": {
                    "score": -0.438356814812522,
                    "pretrain_loss": 0.5131286978721619,
                    "features_accuracy": [
                        0.7632455229759216,
                        0.7429609298706055,
                        0.7735391855239868,
                        0.7241901159286499,
                        0.7172267436981201,
                        0.7353920936584473,
                        0.811080813407898,
                        0.8053284883499146
                    ]
                },
                "test": {
                    "score": -0.43486289993149757,
                    "pretrain_loss": 0.509316623210907,
                    "features_accuracy": [
                        0.7618701457977295,
                        0.7526647448539734,
                        0.7567829489707947,
                        0.7286821603775024,
                        0.7151162624359131,
                        0.7400678396224976,
                        0.7984496355056763,
                        0.810562014579773
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": -0.28162665741737153,
                    "pretrain_loss": 0.5003294348716736,
                    "features_accuracy": [
                        0.767204225063324,
                        0.7606177926063538,
                        0.7731849551200867,
                        0.7364675998687744,
                        0.7368460893630981,
                        0.7475963830947876,
                        0.809826672077179,
                        0.8089938759803772
                    ]
                },
                "val": {
                    "score": -0.4323311578704231,
                    "pretrain_loss": 0.5120523571968079,
                    "features_accuracy": [
                        0.7599152326583862,
                        0.744777500629425,
                        0.7696033716201782,
                        0.7202543020248413,
                        0.7141991853713989,
                        0.7405388951301575,
                        0.8119890689849854,
                        0.8074477910995483
                    ]
                },
                "test": {
                    "score": -0.43397161945841406,
                    "pretrain_loss": 0.5106421709060669,
                    "features_accuracy": [
                        0.7635658979415894,
                        0.7507267594337463,
                        0.7652616500854492,
                        0.729651153087616,
                        0.71875,
                        0.7342538833618164,
                        0.7982073426246643,
                        0.8047480583190918
                    ]
                }
            },
            "80000": {
                "train": {
                    "score": -0.3237884478492788,
                    "pretrain_loss": 0.49491506814956665,
                    "features_accuracy": [
                        0.7741691470146179,
                        0.763494610786438,
                        0.7746990919113159,
                        0.7366946935653687,
                        0.7379059791564941,
                        0.7503218054771423,
                        0.8100537657737732,
                        0.8097509741783142
                    ]
                },
                "val": {
                    "score": -0.4316529453064004,
                    "pretrain_loss": 0.5092970728874207,
                    "features_accuracy": [
                        0.764456570148468,
                        0.7432637214660645,
                        0.7686951160430908,
                        0.7238873839378357,
                        0.7184377908706665,
                        0.7459884881973267,
                        0.80865877866745,
                        0.8077505230903625
                    ]
                },
                "test": {
                    "score": -0.42228293370782466,
                    "pretrain_loss": 0.5081056356430054,
                    "features_accuracy": [
                        0.7621123790740967,
                        0.7487887740135193,
                        0.760901153087616,
                        0.7330426573753357,
                        0.7139050364494324,
                        0.737160861492157,
                        0.8006298542022705,
                        0.8127422332763672
                    ]
                }
            },
            "90000": {
                "train": {
                    "score": -0.32446172635333426,
                    "pretrain_loss": 0.488463431596756,
                    "features_accuracy": [
                        0.7799227833747864,
                        0.767204225063324,
                        0.7809069752693176,
                        0.7378302812576294,
                        0.7391172647476196,
                        0.7623590230941772,
                        0.8113408088684082,
                        0.8152017593383789
                    ]
                },
                "val": {
                    "score": -0.42479719148055256,
                    "pretrain_loss": 0.5086190104484558,
                    "features_accuracy": [
                        0.764153778553009,
                        0.747199535369873,
                        0.7702088952064514,
                        0.7229791283607483,
                        0.7169240117073059,
                        0.7426581978797913,
                        0.8107780814170837,
                        0.8098698258399963
                    ]
                },
                "test": {
                    "score": -0.41961423002216275,
                    "pretrain_loss": 0.5088717341423035,
                    "features_accuracy": [
                        0.7652616500854492,
                        0.75,
                        0.7589631676673889,
                        0.7265019416809082,
                        0.7153584957122803,
                        0.7352228760719299,
                        0.7948158979415894,
                        0.8127422332763672
                    ]
                }
            },
            "100000": {
                "train": {
                    "score": -0.3176702303000624,
                    "pretrain_loss": 0.4839763045310974,
                    "features_accuracy": [
                        0.7839352488517761,
                        0.7707623839378357,
                        0.7787114977836609,
                        0.7389658689498901,
                        0.7425240874290466,
                        0.756529688835144,
                        0.8140661716461182,
                        0.8198955655097961
                    ]
                },
                "val": {
                    "score": -0.4232560023468482,
                    "pretrain_loss": 0.508202850818634,
                    "features_accuracy": [
                        0.7608234882354736,
                        0.7456857562065125,
                        0.7747502326965332,
                        0.7229791283607483,
                        0.7199515700340271,
                        0.7444747090339661,
                        0.8125945925712585,
                        0.8189524412155151
                    ]
                },
                "test": {
                    "score": -0.41573065726324965,
                    "pretrain_loss": 0.5073472857475281,
                    "features_accuracy": [
                        0.7635658979415894,
                        0.7531492114067078,
                        0.7664728760719299,
                        0.7279554009437561,
                        0.7153584957122803,
                        0.7340116500854492,
                        0.8011143207550049,
                        0.8163759708404541
                    ]
                }
            }
        },
        "train": {
            "score": -0.3176702303000624
        },
        "val": {
            "score": -0.4232560023468482
        },
        "test": {
            "score": -0.41573065726324965
        }
    },
    "best_iteration": 100000,
    "time": "0:41:36"
}
