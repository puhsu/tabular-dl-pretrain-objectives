{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask___244f7ca57aa341f2a26a23fbf225738b.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 10,
        "data": {
            "path": "data/california",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "transformer",
            "config": {
                "n_blocks": 4,
                "attention_dropout": 0.23378684224099733,
                "ffn_dropout": 0.16676607141878652,
                "ffn_d_hidden": 865
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear"
            ],
            "d_num_embedding": 512,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.00010485453984042361,
            "weight_decay": 0.0005622737615666989,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.2829421149532736,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.00010485453984042361,
            "weight_decay": 0.0005622737615666989,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "epoch_size": 104,
    "n_parameters": 9805065,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -0.3541144376842635,
                    "pretrain_loss": 0.5168133974075317,
                    "features_accuracy": [
                        0.7596336007118225,
                        0.7500189542770386,
                        0.7575138211250305,
                        0.726247251033783,
                        0.7327579855918884,
                        0.7359376549720764,
                        0.795139729976654,
                        0.7984707951545715
                    ]
                },
                "val": {
                    "score": -0.4572845221283811,
                    "pretrain_loss": 0.5173541903495789,
                    "features_accuracy": [
                        0.7702088952064514,
                        0.7369058132171631,
                        0.7629427909851074,
                        0.7456857562065125,
                        0.7290341854095459,
                        0.7290341854095459,
                        0.791704535484314,
                        0.793823778629303
                    ]
                },
                "test": {
                    "score": -0.44696046624073515,
                    "pretrain_loss": 0.5197975039482117,
                    "features_accuracy": [
                        0.7589631676673889,
                        0.7344961166381836,
                        0.7640503644943237,
                        0.7410368323326111,
                        0.7323158979415894,
                        0.7420058250427246,
                        0.786821722984314,
                        0.7962693572044373
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -0.3450201335978614,
                    "pretrain_loss": 0.5055304765701294,
                    "features_accuracy": [
                        0.7743963003158569,
                        0.7576652765274048,
                        0.7679612636566162,
                        0.7384359240531921,
                        0.7210235595703125,
                        0.7485805153846741,
                        0.8030131459236145,
                        0.8081611394882202
                    ]
                },
                "val": {
                    "score": -0.4446715833407296,
                    "pretrain_loss": 0.5101024508476257,
                    "features_accuracy": [
                        0.7699061632156372,
                        0.7408416271209717,
                        0.7674841284751892,
                        0.7456857562065125,
                        0.7332727909088135,
                        0.7308507561683655,
                        0.7995761632919312,
                        0.798970639705658
                    ]
                },
                "test": {
                    "score": -0.43924566309110713,
                    "pretrain_loss": 0.5138102173805237,
                    "features_accuracy": [
                        0.7635658979415894,
                        0.7359496355056763,
                        0.768410861492157,
                        0.7369186282157898,
                        0.7303779125213623,
                        0.7529069781303406,
                        0.7890019416809082,
                        0.7994186282157898
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -0.3174648185624233,
                    "pretrain_loss": 0.5010537505149841,
                    "features_accuracy": [
                        0.7714437246322632,
                        0.7594065070152283,
                        0.7663714289665222,
                        0.7349534630775452,
                        0.7361647486686707,
                        0.7487319707870483,
                        0.805057168006897,
                        0.8154289126396179
                    ]
                },
                "val": {
                    "score": -0.4475416271329161,
                    "pretrain_loss": 0.5079140663146973,
                    "features_accuracy": [
                        0.7786860466003418,
                        0.7414471507072449,
                        0.766575813293457,
                        0.7435664534568787,
                        0.7296397089958191,
                        0.7329699993133545,
                        0.7998788952827454,
                        0.7950348258018494
                    ]
                },
                "test": {
                    "score": -0.44392476373175677,
                    "pretrain_loss": 0.5130746364593506,
                    "features_accuracy": [
                        0.7650193572044373,
                        0.7340116500854492,
                        0.7679263353347778,
                        0.739098846912384,
                        0.7364341020584106,
                        0.7463662624359131,
                        0.7870639562606812,
                        0.8018410801887512
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -0.3294482107111833,
                    "pretrain_loss": 0.4963894784450531,
                    "features_accuracy": [
                        0.7784844040870667,
                        0.7581952214241028,
                        0.7686426043510437,
                        0.7340449690818787,
                        0.7375274896621704,
                        0.7506245970726013,
                        0.8104323148727417,
                        0.8099780678749084
                    ]
                },
                "val": {
                    "score": -0.4386454808193359,
                    "pretrain_loss": 0.5070531964302063,
                    "features_accuracy": [
                        0.7747502326965332,
                        0.7465940117835999,
                        0.7662730813026428,
                        0.7435664534568787,
                        0.7293369770050049,
                        0.7359975576400757,
                        0.8092643022537231,
                        0.8068422675132751
                    ]
                },
                "test": {
                    "score": -0.4327340872281491,
                    "pretrain_loss": 0.5089465379714966,
                    "features_accuracy": [
                        0.762839138507843,
                        0.7386143207550049,
                        0.7686530947685242,
                        0.7405523061752319,
                        0.737160861492157,
                        0.7529069781303406,
                        0.7873061895370483,
                        0.7994186282157898
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": -0.3176383369903455,
                    "pretrain_loss": 0.4936927556991577,
                    "features_accuracy": [
                        0.7781058549880981,
                        0.760844886302948,
                        0.7725036144256592,
                        0.7310167551040649,
                        0.7328336834907532,
                        0.7560754418373108,
                        0.8133848309516907,
                        0.8189113736152649
                    ]
                },
                "val": {
                    "score": -0.44533251618815844,
                    "pretrain_loss": 0.50618577003479,
                    "features_accuracy": [
                        0.7720254063606262,
                        0.747199535369873,
                        0.7732364535331726,
                        0.7429609298706055,
                        0.7287314534187317,
                        0.7293369770050049,
                        0.8001816272735596,
                        0.8023009300231934
                    ]
                },
                "test": {
                    "score": -0.4255197527235986,
                    "pretrain_loss": 0.5084371566772461,
                    "features_accuracy": [
                        0.7625969052314758,
                        0.7398256063461304,
                        0.7667151093482971,
                        0.7403100728988647,
                        0.7378876209259033,
                        0.7558139562606812,
                        0.7938469052314758,
                        0.804990291595459
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": -0.31880760800897273,
                    "pretrain_loss": 0.4886387884616852,
                    "features_accuracy": [
                        0.7770459651947021,
                        0.7641002535820007,
                        0.7775002121925354,
                        0.7425240874290466,
                        0.7375274896621704,
                        0.7556968927383423,
                        0.8151260614395142,
                        0.8142933249473572
                    ]
                },
                "val": {
                    "score": -0.4363872214189314,
                    "pretrain_loss": 0.5038732290267944,
                    "features_accuracy": [
                        0.77414470911026,
                        0.7432637214660645,
                        0.7677868604660034,
                        0.7441719770431519,
                        0.7244929075241089,
                        0.7341810464859009,
                        0.8065395355224609,
                        0.8044202327728271
                    ]
                },
                "test": {
                    "score": -0.42938876165229695,
                    "pretrain_loss": 0.5087106227874756,
                    "features_accuracy": [
                        0.7698643207550049,
                        0.7405523061752319,
                        0.7657461166381836,
                        0.7398256063461304,
                        0.7332848906517029,
                        0.7531492114067078,
                        0.7933623790740967,
                        0.8054748177528381
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": -0.27490303825311074,
                    "pretrain_loss": 0.4976895749568939,
                    "features_accuracy": [
                        0.7737149000167847,
                        0.7669013738632202,
                        0.7693997025489807,
                        0.7304868102073669,
                        0.7342721223831177,
                        0.7500946521759033,
                        0.807176947593689,
                        0.8117949962615967
                    ]
                },
                "val": {
                    "score": -0.43239501214372694,
                    "pretrain_loss": 0.5041608810424805,
                    "features_accuracy": [
                        0.7756584882736206,
                        0.7414471507072449,
                        0.7756584882736206,
                        0.7408416271209717,
                        0.7320617437362671,
                        0.7344837784767151,
                        0.806236743927002,
                        0.8047229647636414
                    ]
                },
                "test": {
                    "score": -0.4307095431368819,
                    "pretrain_loss": 0.5087490677833557,
                    "features_accuracy": [
                        0.7650193572044373,
                        0.742490291595459,
                        0.7633236646652222,
                        0.7398256063461304,
                        0.7352228760719299,
                        0.7529069781303406,
                        0.7950581312179565,
                        0.8088662624359131
                    ]
                }
            },
            "80000": {
                "train": {
                    "score": -0.29990518382779224,
                    "pretrain_loss": 0.4898892045021057,
                    "features_accuracy": [
                        0.7738663554191589,
                        0.767204225063324,
                        0.7766674757003784,
                        0.7407827973365784,
                        0.7363161444664001,
                        0.7553941011428833,
                        0.8155803084373474,
                        0.8262548446655273
                    ]
                },
                "val": {
                    "score": -0.438230147328729,
                    "pretrain_loss": 0.503653883934021,
                    "features_accuracy": [
                        0.7759612202644348,
                        0.7411444187164307,
                        0.7753557562828064,
                        0.7399333715438843,
                        0.7272176742553711,
                        0.7378141283988953,
                        0.8035119771957397,
                        0.8026036620140076
                    ]
                },
                "test": {
                    "score": -0.4220378654684525,
                    "pretrain_loss": 0.5051664710044861,
                    "features_accuracy": [
                        0.7708333134651184,
                        0.7410368323326111,
                        0.768410861492157,
                        0.742732584476471,
                        0.7364341020584106,
                        0.7529069781303406,
                        0.7916666865348816,
                        0.8103197813034058
                    ]
                }
            },
            "90000": {
                "train": {
                    "score": -0.3009858130408232,
                    "pretrain_loss": 0.4854722321033478,
                    "features_accuracy": [
                        0.7758346796035767,
                        0.7695510983467102,
                        0.7788628935813904,
                        0.7343478202819824,
                        0.7438110709190369,
                        0.7556211948394775,
                        0.8189113736152649,
                        0.8212582468986511
                    ]
                },
                "val": {
                    "score": -0.44291578446250157,
                    "pretrain_loss": 0.5018094778060913,
                    "features_accuracy": [
                        0.778988778591156,
                        0.7417499423027039,
                        0.7744474411010742,
                        0.7414471507072449,
                        0.7329699993133545,
                        0.7363003492355347,
                        0.8071449995040894,
                        0.8026036620140076
                    ]
                },
                "test": {
                    "score": -0.4249780237128845,
                    "pretrain_loss": 0.5054458379745483,
                    "features_accuracy": [
                        0.7747092843055725,
                        0.7453972697257996,
                        0.7696220874786377,
                        0.7398256063461304,
                        0.7376453280448914,
                        0.7524224519729614,
                        0.8013566136360168,
                        0.8032945990562439
                    ]
                }
            },
            "100000": {
                "train": {
                    "score": -0.30801767255530094,
                    "pretrain_loss": 0.4827469289302826,
                    "features_accuracy": [
                        0.7764403223991394,
                        0.7707623839378357,
                        0.7795442938804626,
                        0.7407070994377136,
                        0.7364675998687744,
                        0.7614505290985107,
                        0.8187599778175354,
                        0.8252706527709961
                    ]
                },
                "val": {
                    "score": -0.44237117523542385,
                    "pretrain_loss": 0.5008887052536011,
                    "features_accuracy": [
                        0.778988778591156,
                        0.7414471507072449,
                        0.7714199423789978,
                        0.7429609298706055,
                        0.7308507561683655,
                        0.7396306395530701,
                        0.8089615702629089,
                        0.8104753494262695
                    ]
                },
                "test": {
                    "score": -0.42707493214765363,
                    "pretrain_loss": 0.5062803626060486,
                    "features_accuracy": [
                        0.7688953280448914,
                        0.7388566136360168,
                        0.7701066136360168,
                        0.7412790656089783,
                        0.7361918687820435,
                        0.7507267594337463,
                        0.7914243936538696,
                        0.8059592843055725
                    ]
                }
            }
        },
        "train": {
            "score": -0.27490303825311074
        },
        "val": {
            "score": -0.43239501214372694
        },
        "test": {
            "score": -0.4307095431368819
        }
    },
    "best_iteration": 70000,
    "time": "0:41:04"
}
