{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask___244f7ca57aa341f2a26a23fbf225738b.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 6,
        "data": {
            "path": "data/california",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "transformer",
            "config": {
                "n_blocks": 4,
                "attention_dropout": 0.23378684224099733,
                "ffn_dropout": 0.16676607141878652,
                "ffn_d_hidden": 865
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear"
            ],
            "d_num_embedding": 512,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.00010485453984042361,
            "weight_decay": 0.0005622737615666989,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.2829421149532736,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.00010485453984042361,
            "weight_decay": 0.0005622737615666989,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "epoch_size": 104,
    "n_parameters": 9805065,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -0.3130512733254236,
                    "pretrain_loss": 0.5214587450027466,
                    "features_accuracy": [
                        0.7596336007118225,
                        0.7432811260223389,
                        0.75493985414505,
                        0.7276099920272827,
                        0.728367030620575,
                        0.7341964244842529,
                        0.7883261442184448,
                        0.7946854829788208
                    ]
                },
                "val": {
                    "score": -0.45709756720112144,
                    "pretrain_loss": 0.5265009999275208,
                    "features_accuracy": [
                        0.7608234882354736,
                        0.7244929075241089,
                        0.7662730813026428,
                        0.7320617437362671,
                        0.7287314534187317,
                        0.7356948256492615,
                        0.7844383716583252,
                        0.7756584882736206
                    ]
                },
                "test": {
                    "score": -0.46695165064662353,
                    "pretrain_loss": 0.5279802680015564,
                    "features_accuracy": [
                        0.7594476938247681,
                        0.7432170510292053,
                        0.757267415523529,
                        0.7214147448539734,
                        0.7143895030021667,
                        0.7376453280448914,
                        0.7841569781303406,
                        0.7860949635505676
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -0.3626144386581114,
                    "pretrain_loss": 0.5058264136314392,
                    "features_accuracy": [
                        0.7619804739952087,
                        0.7542585134506226,
                        0.7638731598854065,
                        0.7359376549720764,
                        0.7313953042030334,
                        0.7528957724571228,
                        0.8006662130355835,
                        0.8083882331848145
                    ]
                },
                "val": {
                    "score": -0.44671260364142396,
                    "pretrain_loss": 0.5193365812301636,
                    "features_accuracy": [
                        0.766575813293457,
                        0.7347865700721741,
                        0.771722674369812,
                        0.7335755228996277,
                        0.7266121506690979,
                        0.7323645353317261,
                        0.784135639667511,
                        0.7926127910614014
                    ]
                },
                "test": {
                    "score": -0.44422499321342024,
                    "pretrain_loss": 0.5197935104370117,
                    "features_accuracy": [
                        0.7618701457977295,
                        0.7504844665527344,
                        0.7621123790740967,
                        0.726259708404541,
                        0.7148740291595459,
                        0.7432170510292053,
                        0.7906976938247681,
                        0.7923933863639832
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -0.37537686734741865,
                    "pretrain_loss": 0.4994146227836609,
                    "features_accuracy": [
                        0.7687183022499084,
                        0.760844886302948,
                        0.7722765207290649,
                        0.7396472096443176,
                        0.7312438488006592,
                        0.7477477788925171,
                        0.8086153864860535,
                        0.811416506767273
                    ]
                },
                "val": {
                    "score": -0.44659749707739727,
                    "pretrain_loss": 0.5173096656799316,
                    "features_accuracy": [
                        0.7656675577163696,
                        0.7356948256492615,
                        0.7705116271972656,
                        0.7347865700721741,
                        0.7287314534187317,
                        0.7350893020629883,
                        0.788979709148407,
                        0.7935210466384888
                    ]
                },
                "test": {
                    "score": -0.43262428523269725,
                    "pretrain_loss": 0.5168552398681641,
                    "features_accuracy": [
                        0.7606589198112488,
                        0.7531492114067078,
                        0.7676841020584106,
                        0.7303779125213623,
                        0.7170542478561401,
                        0.7412790656089783,
                        0.7984496355056763,
                        0.794089138507843
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -0.36821227185001987,
                    "pretrain_loss": 0.4955240488052368,
                    "features_accuracy": [
                        0.7718979716300964,
                        0.7581952214241028,
                        0.7692482471466064,
                        0.7367703914642334,
                        0.7364675998687744,
                        0.7489590644836426,
                        0.8074040412902832,
                        0.8163373470306396
                    ]
                },
                "val": {
                    "score": -0.44318101078228017,
                    "pretrain_loss": 0.5160057544708252,
                    "features_accuracy": [
                        0.7696033716201782,
                        0.7402361631393433,
                        0.7729337215423584,
                        0.7344837784767151,
                        0.7326672673225403,
                        0.7399333715438843,
                        0.7886769771575928,
                        0.7883741855621338
                    ]
                },
                "test": {
                    "score": -0.43431235205157614,
                    "pretrain_loss": 0.5170751810073853,
                    "features_accuracy": [
                        0.7616279125213623,
                        0.7536337375640869,
                        0.7696220874786377,
                        0.7272287011146545,
                        0.7143895030021667,
                        0.7398256063461304,
                        0.7943313717842102,
                        0.8008720874786377
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": -0.3180492138685851,
                    "pretrain_loss": 0.48841384053230286,
                    "features_accuracy": [
                        0.7796956896781921,
                        0.7683398127555847,
                        0.7754561305046082,
                        0.7429025769233704,
                        0.7394201159477234,
                        0.7545613050460815,
                        0.8174729347229004,
                        0.8156560063362122
                    ]
                },
                "val": {
                    "score": -0.44262829361097045,
                    "pretrain_loss": 0.5116825699806213,
                    "features_accuracy": [
                        0.7711171507835388,
                        0.7344837784767151,
                        0.7801998257637024,
                        0.7347865700721741,
                        0.7278231978416443,
                        0.7381168603897095,
                        0.7980623841285706,
                        0.7898879647254944
                    ]
                },
                "test": {
                    "score": -0.43366885041796693,
                    "pretrain_loss": 0.5119691491127014,
                    "features_accuracy": [
                        0.7618701457977295,
                        0.7521802186965942,
                        0.7710756063461304,
                        0.7313469052314758,
                        0.711482584476471,
                        0.7466084957122803,
                        0.8001453280448914,
                        0.8035368323326111
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": -0.367076553196238,
                    "pretrain_loss": 0.4844946265220642,
                    "features_accuracy": [
                        0.7851465344429016,
                        0.7647815942764282,
                        0.7821182608604431,
                        0.7388144731521606,
                        0.7413127422332764,
                        0.7509274482727051,
                        0.8180786371231079,
                        0.8249678611755371
                    ]
                },
                "val": {
                    "score": -0.43827979288842367,
                    "pretrain_loss": 0.5106951594352722,
                    "features_accuracy": [
                        0.7671813368797302,
                        0.7375113368034363,
                        0.776869535446167,
                        0.7359975576400757,
                        0.7299425005912781,
                        0.7326672673225403,
                        0.7953375577926636,
                        0.8041174411773682
                    ]
                },
                "test": {
                    "score": -0.42354669087319474,
                    "pretrain_loss": 0.5127297043800354,
                    "features_accuracy": [
                        0.7647771239280701,
                        0.7541182041168213,
                        0.7718023061752319,
                        0.7286821603775024,
                        0.7109980583190918,
                        0.7388566136360168,
                        0.7999030947685242,
                        0.8003876209259033
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": -0.33947407186738826,
                    "pretrain_loss": 0.49324578046798706,
                    "features_accuracy": [
                        0.7785601019859314,
                        0.7734121084213257,
                        0.7741691470146179,
                        0.7326065897941589,
                        0.7365432977676392,
                        0.7496404051780701,
                        0.8107351064682007,
                        0.812476396560669
                    ]
                },
                "val": {
                    "score": -0.4407675552328416,
                    "pretrain_loss": 0.5102145075798035,
                    "features_accuracy": [
                        0.7623372673988342,
                        0.7390251159667969,
                        0.77414470911026,
                        0.7338783144950867,
                        0.7305479645729065,
                        0.7399333715438843,
                        0.7959430813789368,
                        0.8019981980323792
                    ]
                },
                "test": {
                    "score": -0.4213059263868856,
                    "pretrain_loss": 0.5124406218528748,
                    "features_accuracy": [
                        0.7611433863639832,
                        0.7548449635505676,
                        0.7679263353347778,
                        0.7306201457977295,
                        0.7117248177528381,
                        0.7437015771865845,
                        0.7969961166381836,
                        0.7999030947685242
                    ]
                }
            },
            "80000": {
                "train": {
                    "score": -0.3436402063185092,
                    "pretrain_loss": 0.4914003014564514,
                    "features_accuracy": [
                        0.7796199917793274,
                        0.7708380818367004,
                        0.7718979716300964,
                        0.7385873794555664,
                        0.7351805567741394,
                        0.7558482885360718,
                        0.8167915940284729,
                        0.8169430494308472
                    ]
                },
                "val": {
                    "score": -0.4381712202762079,
                    "pretrain_loss": 0.5117966532707214,
                    "features_accuracy": [
                        0.7608234882354736,
                        0.7402361631393433,
                        0.771722674369812,
                        0.7332727909088135,
                        0.7269149422645569,
                        0.7305479645729065,
                        0.798667848110199,
                        0.798667848110199
                    ]
                },
                "test": {
                    "score": -0.4245589404183232,
                    "pretrain_loss": 0.5112621784210205,
                    "features_accuracy": [
                        0.7657461166381836,
                        0.7579941749572754,
                        0.7691376209259033,
                        0.7284399271011353,
                        0.7182654738426208,
                        0.7434592843055725,
                        0.7979651093482971,
                        0.8078972697257996
                    ]
                }
            },
            "90000": {
                "train": {
                    "score": -0.2903699593861749,
                    "pretrain_loss": 0.4884487986564636,
                    "features_accuracy": [
                        0.7740177512168884,
                        0.7725793123245239,
                        0.7793171405792236,
                        0.7368460893630981,
                        0.7382845282554626,
                        0.7551669478416443,
                        0.8211825489997864,
                        0.8141419291496277
                    ]
                },
                "val": {
                    "score": -0.43915764533459656,
                    "pretrain_loss": 0.5086572766304016,
                    "features_accuracy": [
                        0.77414470911026,
                        0.7372086048126221,
                        0.7771722674369812,
                        0.7363003492355347,
                        0.7317590117454529,
                        0.7372086048126221,
                        0.8023009300231934,
                        0.7983651161193848
                    ]
                },
                "test": {
                    "score": -0.43476988618870305,
                    "pretrain_loss": 0.5095722079277039,
                    "features_accuracy": [
                        0.7638081312179565,
                        0.7560561895370483,
                        0.7667151093482971,
                        0.7294089198112488,
                        0.7199612259864807,
                        0.7432170510292053,
                        0.8003876209259033,
                        0.8076550364494324
                    ]
                }
            },
            "100000": {
                "train": {
                    "score": -0.34243839985084407,
                    "pretrain_loss": 0.4847218692302704,
                    "features_accuracy": [
                        0.7751533389091492,
                        0.7699296474456787,
                        0.7784844040870667,
                        0.7428268790245056,
                        0.7410099506378174,
                        0.7560754418373108,
                        0.8189870715141296,
                        0.8220153450965881
                    ]
                },
                "val": {
                    "score": -0.43575733201385053,
                    "pretrain_loss": 0.5091947913169861,
                    "features_accuracy": [
                        0.7726309299468994,
                        0.7363003492355347,
                        0.7780805230140686,
                        0.7329699993133545,
                        0.7263094186782837,
                        0.7366030812263489,
                        0.7950348258018494,
                        0.8047229647636414
                    ]
                },
                "test": {
                    "score": -0.4219889488951259,
                    "pretrain_loss": 0.5113251209259033,
                    "features_accuracy": [
                        0.7674418687820435,
                        0.7548449635505676,
                        0.770348846912384,
                        0.726017415523529,
                        0.7148740291595459,
                        0.7400678396224976,
                        0.8011143207550049,
                        0.8035368323326111
                    ]
                }
            }
        },
        "train": {
            "score": -0.34243839985084407
        },
        "val": {
            "score": -0.43575733201385053
        },
        "test": {
            "score": -0.4219889488951259
        }
    },
    "best_iteration": 100000,
    "time": "0:41:01"
}
