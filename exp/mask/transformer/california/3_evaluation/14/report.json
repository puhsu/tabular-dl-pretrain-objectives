{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask___244f7ca57aa341f2a26a23fbf225738b.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 14,
        "data": {
            "path": "data/california",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "transformer",
            "config": {
                "n_blocks": 4,
                "attention_dropout": 0.23378684224099733,
                "ffn_dropout": 0.16676607141878652,
                "ffn_d_hidden": 865
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear"
            ],
            "d_num_embedding": 512,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.00010485453984042361,
            "weight_decay": 0.0005622737615666989,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.2829421149532736,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.00010485453984042361,
            "weight_decay": 0.0005622737615666989,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "epoch_size": 104,
    "n_parameters": 9805065,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -0.34194240733049613,
                    "pretrain_loss": 0.516116201877594,
                    "features_accuracy": [
                        0.7641002535820007,
                        0.7541070580482483,
                        0.7584980130195618,
                        0.7257173657417297,
                        0.7309410572052002,
                        0.7346506714820862,
                        0.7918843626976013,
                        0.796502411365509
                    ]
                },
                "val": {
                    "score": -0.4529207236352672,
                    "pretrain_loss": 0.5212909579277039,
                    "features_accuracy": [
                        0.7626399993896484,
                        0.7517408132553101,
                        0.7671813368797302,
                        0.7323645353317261,
                        0.7254011631011963,
                        0.7320617437362671,
                        0.7920072674751282,
                        0.7935210466384888
                    ]
                },
                "test": {
                    "score": -0.44839729670490625,
                    "pretrain_loss": 0.5190362930297852,
                    "features_accuracy": [
                        0.7747092843055725,
                        0.7487887740135193,
                        0.7621123790740967,
                        0.7289243936538696,
                        0.7269864082336426,
                        0.7223837375640869,
                        0.788517415523529,
                        0.7858527302742004
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -0.3393979989935214,
                    "pretrain_loss": 0.5082229375839233,
                    "features_accuracy": [
                        0.7670527696609497,
                        0.7631917595863342,
                        0.7663714289665222,
                        0.7306382060050964,
                        0.7397229671478271,
                        0.7368460893630981,
                        0.7977136969566345,
                        0.8078582882881165
                    ]
                },
                "val": {
                    "score": -0.4403226350643591,
                    "pretrain_loss": 0.5190078020095825,
                    "features_accuracy": [
                        0.7623372673988342,
                        0.7526491284370422,
                        0.7647593021392822,
                        0.7323645353317261,
                        0.7217680811882019,
                        0.7314562201499939,
                        0.7968513369560242,
                        0.7977595925331116
                    ]
                },
                "test": {
                    "score": -0.44628208834708777,
                    "pretrain_loss": 0.5143374800682068,
                    "features_accuracy": [
                        0.7805232405662537,
                        0.7550871968269348,
                        0.7596899271011353,
                        0.7313469052314758,
                        0.7274709343910217,
                        0.7281976938247681,
                        0.7914243936538696,
                        0.7938469052314758
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -0.3277985598481545,
                    "pretrain_loss": 0.5027308464050293,
                    "features_accuracy": [
                        0.7692482471466064,
                        0.7540313601493835,
                        0.7740177512168884,
                        0.7301082611083984,
                        0.7325308918952942,
                        0.7517601847648621,
                        0.8009690642356873,
                        0.8132334351539612
                    ]
                },
                "val": {
                    "score": -0.4383293641391553,
                    "pretrain_loss": 0.5125749707221985,
                    "features_accuracy": [
                        0.7674841284751892,
                        0.7541629076004028,
                        0.7759612202644348,
                        0.7302452325820923,
                        0.7244929075241089,
                        0.7332727909088135,
                        0.7968513369560242,
                        0.8026036620140076
                    ]
                },
                "test": {
                    "score": -0.44240093848787,
                    "pretrain_loss": 0.511059582233429,
                    "features_accuracy": [
                        0.7742248177528381,
                        0.7497577667236328,
                        0.7642926573753357,
                        0.7354651093482971,
                        0.7235949635505676,
                        0.7357073426246643,
                        0.7977228760719299,
                        0.8023256063461304
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -0.3345796725044028,
                    "pretrain_loss": 0.4928153455257416,
                    "features_accuracy": [
                        0.7772731184959412,
                        0.7678855657577515,
                        0.7681883573532104,
                        0.7425997853279114,
                        0.7402529120445251,
                        0.7596336007118225,
                        0.8089938759803772,
                        0.8146718144416809
                    ]
                },
                "val": {
                    "score": -0.4390788668225408,
                    "pretrain_loss": 0.513427197933197,
                    "features_accuracy": [
                        0.769300639629364,
                        0.7499243021011353,
                        0.77414470911026,
                        0.7344837784767151,
                        0.7263094186782837,
                        0.7350893020629883,
                        0.7968513369560242,
                        0.8032091856002808
                    ]
                },
                "test": {
                    "score": -0.43829261555086685,
                    "pretrain_loss": 0.5098550319671631,
                    "features_accuracy": [
                        0.7822189927101135,
                        0.7529069781303406,
                        0.7616279125213623,
                        0.7340116500854492,
                        0.7279554009437561,
                        0.731589138507843,
                        0.7982073426246643,
                        0.8008720874786377
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": -0.3427354107232967,
                    "pretrain_loss": 0.49442505836486816,
                    "features_accuracy": [
                        0.7740934491157532,
                        0.7639488577842712,
                        0.7771216630935669,
                        0.7444924116134644,
                        0.726777195930481,
                        0.7515330910682678,
                        0.8141419291496277,
                        0.8122492432594299
                    ]
                },
                "val": {
                    "score": -0.4384398203190829,
                    "pretrain_loss": 0.5099722743034363,
                    "features_accuracy": [
                        0.7729337215423584,
                        0.7511353492736816,
                        0.7774749994277954,
                        0.7320617437362671,
                        0.7241901159286499,
                        0.7314562201499939,
                        0.8056312203407288,
                        0.8071449995040894
                    ]
                },
                "test": {
                    "score": -0.4292465190030942,
                    "pretrain_loss": 0.5072757005691528,
                    "features_accuracy": [
                        0.7788274884223938,
                        0.7558139562606812,
                        0.7671996355056763,
                        0.7369186282157898,
                        0.7265019416809082,
                        0.729651153087616,
                        0.7994186282157898,
                        0.7999030947685242
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": -0.35405181426760374,
                    "pretrain_loss": 0.48396044969558716,
                    "features_accuracy": [
                        0.7803770303726196,
                        0.7732606530189514,
                        0.7740177512168884,
                        0.7369218468666077,
                        0.7351048588752747,
                        0.7562268376350403,
                        0.8223938345909119,
                        0.8202740550041199
                    ]
                },
                "val": {
                    "score": -0.44025785625030167,
                    "pretrain_loss": 0.5103772878646851,
                    "features_accuracy": [
                        0.7689979076385498,
                        0.754465639591217,
                        0.7750529646873474,
                        0.7269149422645569,
                        0.7260066866874695,
                        0.7326672673225403,
                        0.8035119771957397,
                        0.8059340119361877
                    ]
                },
                "test": {
                    "score": -0.4306446000091812,
                    "pretrain_loss": 0.5105453133583069,
                    "features_accuracy": [
                        0.7788274884223938,
                        0.755329430103302,
                        0.7652616500854492,
                        0.7328003644943237,
                        0.724321722984314,
                        0.7325581312179565,
                        0.8013566136360168,
                        0.8003876209259033
                    ]
                }
            }
        },
        "train": {
            "score": -0.3277985598481545
        },
        "val": {
            "score": -0.4383293641391553
        },
        "test": {
            "score": -0.44240093848787
        }
    },
    "best_iteration": 30000,
    "time": "0:24:47"
}
