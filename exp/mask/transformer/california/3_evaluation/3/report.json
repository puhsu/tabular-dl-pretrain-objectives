{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask___244f7ca57aa341f2a26a23fbf225738b.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 3,
        "data": {
            "path": "data/california",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "transformer",
            "config": {
                "n_blocks": 4,
                "attention_dropout": 0.23378684224099733,
                "ffn_dropout": 0.16676607141878652,
                "ffn_d_hidden": 865
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear"
            ],
            "d_num_embedding": 512,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.00010485453984042361,
            "weight_decay": 0.0005622737615666989,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.2829421149532736,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.00010485453984042361,
            "weight_decay": 0.0005622737615666989,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "epoch_size": 104,
    "n_parameters": 9805065,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -0.30472841266802997,
                    "pretrain_loss": 0.5174580812454224,
                    "features_accuracy": [
                        0.7591793537139893,
                        0.7422212362289429,
                        0.7617533802986145,
                        0.7336664795875549,
                        0.7277613878250122,
                        0.7391930222511292,
                        0.7890832424163818,
                        0.7957453727722168
                    ]
                },
                "val": {
                    "score": -0.4493517825919981,
                    "pretrain_loss": 0.5213504433631897,
                    "features_accuracy": [
                        0.76203453540802,
                        0.7580987215042114,
                        0.7490160465240479,
                        0.7238873839378357,
                        0.7241901159286499,
                        0.7308507561683655,
                        0.7953375577926636,
                        0.784135639667511
                    ]
                },
                "test": {
                    "score": -0.4528517191240971,
                    "pretrain_loss": 0.5150551795959473,
                    "features_accuracy": [
                        0.7669573426246643,
                        0.7516957521438599,
                        0.7671996355056763,
                        0.7272287011146545,
                        0.7231104373931885,
                        0.7349806427955627,
                        0.7899709343910217,
                        0.8006298542022705
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -0.31901275284116776,
                    "pretrain_loss": 0.5090972781181335,
                    "features_accuracy": [
                        0.7719736695289612,
                        0.756302535533905,
                        0.7620561718940735,
                        0.7348020672798157,
                        0.7340449690818787,
                        0.7377545833587646,
                        0.7966538071632385,
                        0.802634596824646
                    ]
                },
                "val": {
                    "score": -0.44670957076286955,
                    "pretrain_loss": 0.5176499485969543,
                    "features_accuracy": [
                        0.7656675577163696,
                        0.7629427909851074,
                        0.7577959299087524,
                        0.7220708131790161,
                        0.7226763367652893,
                        0.7344837784767151,
                        0.803814709186554,
                        0.7877687215805054
                    ]
                },
                "test": {
                    "score": -0.4455104645302069,
                    "pretrain_loss": 0.5092723965644836,
                    "features_accuracy": [
                        0.7633236646652222,
                        0.7567829489707947,
                        0.7710756063461304,
                        0.7272287011146545,
                        0.7250484228134155,
                        0.7393410801887512,
                        0.7928779125213623,
                        0.8081395030021667
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -0.30691465142880126,
                    "pretrain_loss": 0.5030857920646667,
                    "features_accuracy": [
                        0.7705352902412415,
                        0.7546370029449463,
                        0.7756832838058472,
                        0.7372246384620667,
                        0.7276856899261475,
                        0.7412370443344116,
                        0.8065713047981262,
                        0.806117057800293
                    ]
                },
                "val": {
                    "score": -0.4434676228278052,
                    "pretrain_loss": 0.5145666003227234,
                    "features_accuracy": [
                        0.7677868604660034,
                        0.7584014534950256,
                        0.7577959299087524,
                        0.7226763367652893,
                        0.7266121506690979,
                        0.7363003492355347,
                        0.8035119771957397,
                        0.794126570224762
                    ]
                },
                "test": {
                    "score": -0.43272288563928857,
                    "pretrain_loss": 0.5066385865211487,
                    "features_accuracy": [
                        0.7701066136360168,
                        0.7582364082336426,
                        0.7710756063461304,
                        0.7291666865348816,
                        0.7267441749572754,
                        0.739098846912384,
                        0.8008720874786377,
                        0.8028100728988647
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -0.30257921520807496,
                    "pretrain_loss": 0.49548789858818054,
                    "features_accuracy": [
                        0.7765160202980042,
                        0.7550155520439148,
                        0.7790143489837646,
                        0.7388901710510254,
                        0.7315467000007629,
                        0.7530471682548523,
                        0.8106594085693359,
                        0.8088424801826477
                    ]
                },
                "val": {
                    "score": -0.43856725103132205,
                    "pretrain_loss": 0.5107064247131348,
                    "features_accuracy": [
                        0.7729337215423584,
                        0.7611262202262878,
                        0.7547683715820312,
                        0.7235845923423767,
                        0.7232818603515625,
                        0.7423554062843323,
                        0.8074477910995483,
                        0.7929155230522156
                    ]
                },
                "test": {
                    "score": -0.4351460423887137,
                    "pretrain_loss": 0.5042661428451538,
                    "features_accuracy": [
                        0.7696220874786377,
                        0.7589631676673889,
                        0.7730135917663574,
                        0.7277131676673889,
                        0.7218992114067078,
                        0.7403100728988647,
                        0.8057170510292053,
                        0.8146802186965942
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": -0.3277675142906274,
                    "pretrain_loss": 0.4902876615524292,
                    "features_accuracy": [
                        0.7714437246322632,
                        0.7726550102233887,
                        0.7725793123245239,
                        0.7384359240531921,
                        0.7392687201499939,
                        0.7580437660217285,
                        0.8123249411582947,
                        0.8150503635406494
                    ]
                },
                "val": {
                    "score": -0.43948958483611167,
                    "pretrain_loss": 0.510013997554779,
                    "features_accuracy": [
                        0.7744474411010742,
                        0.7638510465621948,
                        0.7526491284370422,
                        0.7272176742553711,
                        0.7244929075241089,
                        0.7369058132171631,
                        0.8068422675132751,
                        0.7953375577926636
                    ]
                },
                "test": {
                    "score": -0.4338631252942607,
                    "pretrain_loss": 0.5019810199737549,
                    "features_accuracy": [
                        0.7701066136360168,
                        0.7642926573753357,
                        0.7771317958831787,
                        0.7311046719551086,
                        0.7252907156944275,
                        0.7415212988853455,
                        0.8032945990562439,
                        0.8115310072898865
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": -0.3102335426174675,
                    "pretrain_loss": 0.4846060574054718,
                    "features_accuracy": [
                        0.7797713875770569,
                        0.7706109881401062,
                        0.7769702672958374,
                        0.7438110709190369,
                        0.7450223565101624,
                        0.755999743938446,
                        0.8139904737472534,
                        0.8217881917953491
                    ]
                },
                "val": {
                    "score": -0.43557650510591034,
                    "pretrain_loss": 0.5073292255401611,
                    "features_accuracy": [
                        0.7723281979560852,
                        0.759612500667572,
                        0.7538601160049438,
                        0.7241901159286499,
                        0.7220708131790161,
                        0.7332727909088135,
                        0.8107780814170837,
                        0.7983651161193848
                    ]
                },
                "test": {
                    "score": -0.43376228535276157,
                    "pretrain_loss": 0.5014017224311829,
                    "features_accuracy": [
                        0.7727712988853455,
                        0.7659883499145508,
                        0.7691376209259033,
                        0.7250484228134155,
                        0.7233527302742004,
                        0.7432170510292053,
                        0.8064438104629517,
                        0.8103197813034058
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": -0.2848166133765561,
                    "pretrain_loss": 0.49449655413627625,
                    "features_accuracy": [
                        0.7790143489837646,
                        0.7643274068832397,
                        0.7756832838058472,
                        0.7425240874290466,
                        0.7415398955345154,
                        0.7465364933013916,
                        0.8130820393562317,
                        0.806344211101532
                    ]
                },
                "val": {
                    "score": -0.4386191007039573,
                    "pretrain_loss": 0.5096948146820068,
                    "features_accuracy": [
                        0.7735391855239868,
                        0.764153778553009,
                        0.759612500667572,
                        0.7250983715057373,
                        0.7235845923423767,
                        0.7344837784767151,
                        0.8074477910995483,
                        0.7950348258018494
                    ]
                },
                "test": {
                    "score": -0.4389346657621399,
                    "pretrain_loss": 0.503371000289917,
                    "features_accuracy": [
                        0.7698643207550049,
                        0.7604166865348816,
                        0.775678277015686,
                        0.7291666865348816,
                        0.7177810072898865,
                        0.7376453280448914,
                        0.8059592843055725,
                        0.8093507885932922
                    ]
                }
            },
            "80000": {
                "train": {
                    "score": -0.27119545812317214,
                    "pretrain_loss": 0.49207425117492676,
                    "features_accuracy": [
                        0.7781815528869629,
                        0.7630403637886047,
                        0.7787114977836609,
                        0.7401771545410156,
                        0.7398743629455566,
                        0.7477477788925171,
                        0.8104323148727417,
                        0.8133848309516907
                    ]
                },
                "val": {
                    "score": -0.436567643564021,
                    "pretrain_loss": 0.5067331790924072,
                    "features_accuracy": [
                        0.7689979076385498,
                        0.759309709072113,
                        0.7538601160049438,
                        0.7272176742553711,
                        0.7250983715057373,
                        0.7323645353317261,
                        0.8165304064750671,
                        0.7959430813789368
                    ]
                },
                "test": {
                    "score": -0.43262338053778143,
                    "pretrain_loss": 0.50045245885849,
                    "features_accuracy": [
                        0.7761628031730652,
                        0.7594476938247681,
                        0.7676841020584106,
                        0.7291666865348816,
                        0.7228682041168213,
                        0.7446705102920532,
                        0.8074128031730652,
                        0.8110464811325073
                    ]
                }
            },
            "90000": {
                "train": {
                    "score": -0.309105459509975,
                    "pretrain_loss": 0.48538485169410706,
                    "features_accuracy": [
                        0.7832538485527039,
                        0.7614505290985107,
                        0.7813612222671509,
                        0.7450223565101624,
                        0.7394201159477234,
                        0.7535771131515503,
                        0.8179271817207336,
                        0.8221667408943176
                    ]
                },
                "val": {
                    "score": -0.4420004186111935,
                    "pretrain_loss": 0.5080205202102661,
                    "features_accuracy": [
                        0.776869535446167,
                        0.7629427909851074,
                        0.756887674331665,
                        0.7226763367652893,
                        0.7266121506690979,
                        0.7390251159667969,
                        0.813502848148346,
                        0.7974568605422974
                    ]
                },
                "test": {
                    "score": -0.42474509581732656,
                    "pretrain_loss": 0.49916762113571167,
                    "features_accuracy": [
                        0.7691376209259033,
                        0.7560561895370483,
                        0.7778584957122803,
                        0.7313469052314758,
                        0.7265019416809082,
                        0.7439438104629517,
                        0.801598846912384,
                        0.8108042478561401
                    ]
                }
            }
        },
        "train": {
            "score": -0.3102335426174675
        },
        "val": {
            "score": -0.43557650510591034
        },
        "test": {
            "score": -0.43376228535276157
        }
    },
    "best_iteration": 60000,
    "time": "0:39:08"
}
