{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask___244f7ca57aa341f2a26a23fbf225738b.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 4,
        "data": {
            "path": "data/california",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "transformer",
            "config": {
                "n_blocks": 4,
                "attention_dropout": 0.23378684224099733,
                "ffn_dropout": 0.16676607141878652,
                "ffn_d_hidden": 865
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear"
            ],
            "d_num_embedding": 512,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.00010485453984042361,
            "weight_decay": 0.0005622737615666989,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.2829421149532736,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.00010485453984042361,
            "weight_decay": 0.0005622737615666989,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "epoch_size": 104,
    "n_parameters": 9805065,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -0.33669159681218075,
                    "pretrain_loss": 0.5162115097045898,
                    "features_accuracy": [
                        0.758952260017395,
                        0.7485048174858093,
                        0.7670527696609497,
                        0.7284427285194397,
                        0.7245060205459595,
                        0.7391930222511292,
                        0.7914301156997681,
                        0.8038458824157715
                    ]
                },
                "val": {
                    "score": -0.45355512123018743,
                    "pretrain_loss": 0.5240439772605896,
                    "features_accuracy": [
                        0.7659703493118286,
                        0.7481077909469604,
                        0.7608234882354736,
                        0.7260066866874695,
                        0.7281259298324585,
                        0.7247956395149231,
                        0.7777777910232544,
                        0.791401743888855
                    ]
                },
                "test": {
                    "score": -0.456481306041596,
                    "pretrain_loss": 0.5256619453430176,
                    "features_accuracy": [
                        0.7473352551460266,
                        0.7386143207550049,
                        0.7521802186965942,
                        0.7211724519729614,
                        0.7226259708404541,
                        0.7422480583190918,
                        0.7759205102920532,
                        0.7989341020584106
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -0.3170518390946896,
                    "pretrain_loss": 0.5097016096115112,
                    "features_accuracy": [
                        0.7700810432434082,
                        0.756302535533905,
                        0.7654629945755005,
                        0.7363919019699097,
                        0.7223863005638123,
                        0.7344992160797119,
                        0.802104651927948,
                        0.8033159375190735
                    ]
                },
                "val": {
                    "score": -0.45025273825498985,
                    "pretrain_loss": 0.5176386833190918,
                    "features_accuracy": [
                        0.7723281979560852,
                        0.744777500629425,
                        0.7638510465621948,
                        0.7235845923423767,
                        0.7275204062461853,
                        0.7281259298324585,
                        0.7801998257637024,
                        0.79654860496521
                    ]
                },
                "test": {
                    "score": -0.4498207474818174,
                    "pretrain_loss": 0.5208185911178589,
                    "features_accuracy": [
                        0.7538759708404541,
                        0.7398256063461304,
                        0.7550871968269348,
                        0.7216569781303406,
                        0.7245639562606812,
                        0.7458817958831787,
                        0.783187985420227,
                        0.7986918687820435
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -0.31087587630806013,
                    "pretrain_loss": 0.5004611015319824,
                    "features_accuracy": [
                        0.7774245142936707,
                        0.7625861167907715,
                        0.7739420533180237,
                        0.7284427285194397,
                        0.7385116219520569,
                        0.7391930222511292,
                        0.8090695738792419,
                        0.8099023699760437
                    ]
                },
                "val": {
                    "score": -0.43860656215704463,
                    "pretrain_loss": 0.516676664352417,
                    "features_accuracy": [
                        0.7774749994277954,
                        0.7478049993515015,
                        0.761731743812561,
                        0.7254011631011963,
                        0.7317590117454529,
                        0.7311534881591797,
                        0.7904934883117676,
                        0.794126570224762
                    ]
                },
                "test": {
                    "score": -0.43556212787345616,
                    "pretrain_loss": 0.5170949697494507,
                    "features_accuracy": [
                        0.7548449635505676,
                        0.7492732405662537,
                        0.7592054009437561,
                        0.7214147448539734,
                        0.7277131676673889,
                        0.7432170510292053,
                        0.7851259708404541,
                        0.799660861492157
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -0.33428625302652654,
                    "pretrain_loss": 0.49386775493621826,
                    "features_accuracy": [
                        0.7792414426803589,
                        0.7644031047821045,
                        0.7731092572212219,
                        0.7376031875610352,
                        0.7385873794555664,
                        0.7538042664527893,
                        0.8091453313827515,
                        0.8105837106704712
                    ]
                },
                "val": {
                    "score": -0.44109434718076374,
                    "pretrain_loss": 0.5117201209068298,
                    "features_accuracy": [
                        0.779291570186615,
                        0.7502270340919495,
                        0.7677868604660034,
                        0.7241901159286499,
                        0.7338783144950867,
                        0.7372086048126221,
                        0.7880714535713196,
                        0.8023009300231934
                    ]
                },
                "test": {
                    "score": -0.42609993894371384,
                    "pretrain_loss": 0.5165188908576965,
                    "features_accuracy": [
                        0.755571722984314,
                        0.7453972697257996,
                        0.7565407156944275,
                        0.7272287011146545,
                        0.7228682041168213,
                        0.7398256063461304,
                        0.7890019416809082,
                        0.8030523061752319
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": -0.3290428449303078,
                    "pretrain_loss": 0.4912257492542267,
                    "features_accuracy": [
                        0.7780301570892334,
                        0.7618290781974792,
                        0.7744719982147217,
                        0.7381331324577332,
                        0.7331365346908569,
                        0.7535014152526855,
                        0.8112650513648987,
                        0.8167158961296082
                    ]
                },
                "val": {
                    "score": -0.43985782624500525,
                    "pretrain_loss": 0.5122923254966736,
                    "features_accuracy": [
                        0.7786860466003418,
                        0.7502270340919495,
                        0.7635483145713806,
                        0.7202543020248413,
                        0.7299425005912781,
                        0.7347865700721741,
                        0.7907962203025818,
                        0.7998788952827454
                    ]
                },
                "test": {
                    "score": -0.4278242828596823,
                    "pretrain_loss": 0.5148652791976929,
                    "features_accuracy": [
                        0.7618701457977295,
                        0.748062014579773,
                        0.7606589198112488,
                        0.7248061895370483,
                        0.7279554009437561,
                        0.742732584476471,
                        0.7914243936538696,
                        0.7977228760719299
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": -0.2787498849730675,
                    "pretrain_loss": 0.4869976043701172,
                    "features_accuracy": [
                        0.7783330082893372,
                        0.7703838348388672,
                        0.7775002121925354,
                        0.7362404465675354,
                        0.7396472096443176,
                        0.7588765621185303,
                        0.8167158961296082,
                        0.8176243901252747
                    ]
                },
                "val": {
                    "score": -0.439396751102711,
                    "pretrain_loss": 0.5102150440216064,
                    "features_accuracy": [
                        0.7801998257637024,
                        0.7505298256874084,
                        0.7708144187927246,
                        0.7211625576019287,
                        0.7272176742553711,
                        0.7299425005912781,
                        0.7920072674751282,
                        0.80865877866745
                    ]
                },
                "test": {
                    "score": -0.42557781401333084,
                    "pretrain_loss": 0.5150379538536072,
                    "features_accuracy": [
                        0.7592054009437561,
                        0.7437015771865845,
                        0.7633236646652222,
                        0.7279554009437561,
                        0.7281976938247681,
                        0.7453972697257996,
                        0.7948158979415894,
                        0.8059592843055725
                    ]
                }
            }
        },
        "train": {
            "score": -0.31087587630806013
        },
        "val": {
            "score": -0.43860656215704463
        },
        "test": {
            "score": -0.43556212787345616
        }
    },
    "best_iteration": 30000,
    "time": "0:25:24"
}
