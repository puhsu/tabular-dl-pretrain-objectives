{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask___244f7ca57aa341f2a26a23fbf225738b.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 1,
        "data": {
            "path": "data/california",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "transformer",
            "config": {
                "n_blocks": 4,
                "attention_dropout": 0.23378684224099733,
                "ffn_dropout": 0.16676607141878652,
                "ffn_d_hidden": 865
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear"
            ],
            "d_num_embedding": 512,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.00010485453984042361,
            "weight_decay": 0.0005622737615666989,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.2829421149532736,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.00010485453984042361,
            "weight_decay": 0.0005622737615666989,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "epoch_size": 104,
    "n_parameters": 9805065,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -0.3860712580349404,
                    "pretrain_loss": 0.5149907469749451,
                    "features_accuracy": [
                        0.767204225063324,
                        0.7535771131515503,
                        0.7609963417053223,
                        0.7338178753852844,
                        0.7194337248802185,
                        0.7387387752532959,
                        0.7967295050621033,
                        0.7971837520599365
                    ]
                },
                "val": {
                    "score": -0.46205162856026605,
                    "pretrain_loss": 0.5188824534416199,
                    "features_accuracy": [
                        0.7744474411010742,
                        0.7556766271591187,
                        0.7553738951683044,
                        0.7244929075241089,
                        0.7184377908706665,
                        0.7317590117454529,
                        0.7910990118980408,
                        0.8004844188690186
                    ]
                },
                "test": {
                    "score": -0.45513968309192526,
                    "pretrain_loss": 0.5195078253746033,
                    "features_accuracy": [
                        0.7604166865348816,
                        0.751937985420227,
                        0.7645348906517029,
                        0.7354651093482971,
                        0.7325581312179565,
                        0.7277131676673889,
                        0.7899709343910217,
                        0.7926356792449951
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -0.286080277348075,
                    "pretrain_loss": 0.5138431787490845,
                    "features_accuracy": [
                        0.766977071762085,
                        0.7528200745582581,
                        0.7651601433753967,
                        0.7314710021018982,
                        0.7263230085372925,
                        0.7333636283874512,
                        0.7910515666007996,
                        0.7960481643676758
                    ]
                },
                "val": {
                    "score": -0.4600746909322583,
                    "pretrain_loss": 0.5144525170326233,
                    "features_accuracy": [
                        0.778988778591156,
                        0.7580987215042114,
                        0.7562821507453918,
                        0.7260066866874695,
                        0.7196487784385681,
                        0.7308507561683655,
                        0.8016954064369202,
                        0.8050257563591003
                    ]
                },
                "test": {
                    "score": -0.45586456402349396,
                    "pretrain_loss": 0.5169737339019775,
                    "features_accuracy": [
                        0.7621123790740967,
                        0.7529069781303406,
                        0.7655038833618164,
                        0.7354651093482971,
                        0.7340116500854492,
                        0.7335271239280701,
                        0.7916666865348816,
                        0.7965116500854492
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -0.3559647591648915,
                    "pretrain_loss": 0.49970921874046326,
                    "features_accuracy": [
                        0.7757589817047119,
                        0.7591036558151245,
                        0.7746233940124512,
                        0.7381331324577332,
                        0.7303354144096375,
                        0.7464607954025269,
                        0.8122492432594299,
                        0.8158831596374512
                    ]
                },
                "val": {
                    "score": -0.4453509046231744,
                    "pretrain_loss": 0.5120655298233032,
                    "features_accuracy": [
                        0.778988778591156,
                        0.7605207562446594,
                        0.7538601160049438,
                        0.7266121506690979,
                        0.7211625576019287,
                        0.7305479645729065,
                        0.80865877866745,
                        0.801392674446106
                    ]
                },
                "test": {
                    "score": -0.43595417525938457,
                    "pretrain_loss": 0.514421820640564,
                    "features_accuracy": [
                        0.7659883499145508,
                        0.755571722984314,
                        0.7715600728988647,
                        0.7359496355056763,
                        0.7349806427955627,
                        0.729651153087616,
                        0.788517415523529,
                        0.7991763353347778
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -0.31779556100029416,
                    "pretrain_loss": 0.4955609440803528,
                    "features_accuracy": [
                        0.764024555683136,
                        0.7595579028129578,
                        0.7765917181968689,
                        0.7312438488006592,
                        0.7307896614074707,
                        0.7567567825317383,
                        0.807176947593689,
                        0.8172458410263062
                    ]
                },
                "val": {
                    "score": -0.4435845144092279,
                    "pretrain_loss": 0.5077616572380066,
                    "features_accuracy": [
                        0.7835301160812378,
                        0.7605207562446594,
                        0.761731743812561,
                        0.7205570936203003,
                        0.7202543020248413,
                        0.7378141283988953,
                        0.8041174411773682,
                        0.8098698258399963
                    ]
                },
                "test": {
                    "score": -0.44892187572483055,
                    "pretrain_loss": 0.5108122825622559,
                    "features_accuracy": [
                        0.7587209343910217,
                        0.7596899271011353,
                        0.7662306427955627,
                        0.7383720874786377,
                        0.739098846912384,
                        0.7403100728988647,
                        0.7904554009437561,
                        0.8013566136360168
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": -0.3165183661171055,
                    "pretrain_loss": 0.49034929275512695,
                    "features_accuracy": [
                        0.7698538899421692,
                        0.7633432149887085,
                        0.7703838348388672,
                        0.7368460893630981,
                        0.7356348037719727,
                        0.753350019454956,
                        0.8139904737472534,
                        0.8201226592063904
                    ]
                },
                "val": {
                    "score": -0.44233523888410425,
                    "pretrain_loss": 0.5079838037490845,
                    "features_accuracy": [
                        0.7777777910232544,
                        0.7602179646492004,
                        0.7608234882354736,
                        0.7202543020248413,
                        0.7244929075241089,
                        0.7335755228996277,
                        0.793823778629303,
                        0.8171359300613403
                    ]
                },
                "test": {
                    "score": -0.4342662277926988,
                    "pretrain_loss": 0.5103715062141418,
                    "features_accuracy": [
                        0.7613856792449951,
                        0.7546027302742004,
                        0.7747092843055725,
                        0.7410368323326111,
                        0.7383720874786377,
                        0.7347383499145508,
                        0.7936046719551086,
                        0.7989341020584106
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": -0.33222274977014876,
                    "pretrain_loss": 0.48520028591156006,
                    "features_accuracy": [
                        0.7784844040870667,
                        0.7676584124565125,
                        0.7767431735992432,
                        0.7417669892311096,
                        0.7441896200180054,
                        0.76031494140625,
                        0.8116436004638672,
                        0.8120978474617004
                    ]
                },
                "val": {
                    "score": -0.4335354659785971,
                    "pretrain_loss": 0.5082166790962219,
                    "features_accuracy": [
                        0.7744474411010742,
                        0.7584014534950256,
                        0.7608234882354736,
                        0.7226763367652893,
                        0.7187405228614807,
                        0.7329699993133545,
                        0.803814709186554,
                        0.813502848148346
                    ]
                },
                "test": {
                    "score": -0.42279970427711494,
                    "pretrain_loss": 0.5092779397964478,
                    "features_accuracy": [
                        0.7630813717842102,
                        0.757509708404541,
                        0.770348846912384,
                        0.7378876209259033,
                        0.7359496355056763,
                        0.7344961166381836,
                        0.7938469052314758,
                        0.801598846912384
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": -0.2976573366343416,
                    "pretrain_loss": 0.49545958638191223,
                    "features_accuracy": [
                        0.7692482471466064,
                        0.766144335269928,
                        0.7749261856079102,
                        0.7341207265853882,
                        0.7349534630775452,
                        0.7505488991737366,
                        0.808766782283783,
                        0.8155803084373474
                    ]
                },
                "val": {
                    "score": -0.4404854289700835,
                    "pretrain_loss": 0.5067192316055298,
                    "features_accuracy": [
                        0.776566743850708,
                        0.7590069770812988,
                        0.7574931979179382,
                        0.7238873839378357,
                        0.7211625576019287,
                        0.7356948256492615,
                        0.8026036620140076,
                        0.80865877866745
                    ]
                },
                "test": {
                    "score": -0.4292118219448384,
                    "pretrain_loss": 0.5093740224838257,
                    "features_accuracy": [
                        0.7633236646652222,
                        0.7541182041168213,
                        0.7691376209259033,
                        0.7354651093482971,
                        0.7364341020584106,
                        0.7388566136360168,
                        0.7945736646652222,
                        0.8020833134651184
                    ]
                }
            },
            "80000": {
                "train": {
                    "score": -0.3348098647023427,
                    "pretrain_loss": 0.4952588677406311,
                    "features_accuracy": [
                        0.7726550102233887,
                        0.765084445476532,
                        0.7709137797355652,
                        0.7429782748222351,
                        0.7351048588752747,
                        0.7515330910682678,
                        0.8099780678749084,
                        0.8102809190750122
                    ]
                },
                "val": {
                    "score": -0.4429026424685717,
                    "pretrain_loss": 0.5046592354774475,
                    "features_accuracy": [
                        0.7783833146095276,
                        0.76203453540802,
                        0.7629427909851074,
                        0.7223736047744751,
                        0.7241901159286499,
                        0.7378141283988953,
                        0.8125945925712585,
                        0.8207690119743347
                    ]
                },
                "test": {
                    "score": -0.43723540970163116,
                    "pretrain_loss": 0.5061937570571899,
                    "features_accuracy": [
                        0.7662306427955627,
                        0.7601743936538696,
                        0.7652616500854492,
                        0.7412790656089783,
                        0.737160861492157,
                        0.7383720874786377,
                        0.8071705102920532,
                        0.8078972697257996
                    ]
                }
            },
            "90000": {
                "train": {
                    "score": -0.2825299849559349,
                    "pretrain_loss": 0.48656561970710754,
                    "features_accuracy": [
                        0.7818154692649841,
                        0.7637217044830322,
                        0.7787871956825256,
                        0.7369975447654724,
                        0.7356348037719727,
                        0.759482204914093,
                        0.8261791467666626,
                        0.8179271817207336
                    ]
                },
                "val": {
                    "score": -0.43882783316391993,
                    "pretrain_loss": 0.5044788718223572,
                    "features_accuracy": [
                        0.7826218605041504,
                        0.7659703493118286,
                        0.7611262202262878,
                        0.7266121506690979,
                        0.7235845923423767,
                        0.7393279075622559,
                        0.8053284883499146,
                        0.8147138953208923
                    ]
                },
                "test": {
                    "score": -0.43834550506858627,
                    "pretrain_loss": 0.5050712823867798,
                    "features_accuracy": [
                        0.7691376209259033,
                        0.7596899271011353,
                        0.7722868323326111,
                        0.7388566136360168,
                        0.7354651093482971,
                        0.7434592843055725,
                        0.8025678396224976,
                        0.8023256063461304
                    ]
                }
            }
        },
        "train": {
            "score": -0.33222274977014876
        },
        "val": {
            "score": -0.4335354659785971
        },
        "test": {
            "score": -0.42279970427711494
        }
    },
    "best_iteration": 60000,
    "time": "0:37:40"
}
