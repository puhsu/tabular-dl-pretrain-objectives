{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/tune.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 0,
        "program": "bin/pretrain_mask.py",
        "base_config": {
            "seed": 0,
            "data": {
                "T_cache": true,
                "path": "data/adult_roc",
                "T": {
                    "normalization": "quantile"
                }
            },
            "model": {
                "kind": "transformer",
                "num_embedding_arch": [
                    "linear"
                ],
                "d_num_embedding": 512
            },
            "training": {
                "batch_size": 256,
                "patience": 16
            },
            "pretrain": {
                "corrupt_strategy": "resample",
                "patience": 2,
                "d_hidden_head": 512
            }
        },
        "space": {
            "model": {
                "config": {
                    "n_blocks": [
                        "int",
                        1,
                        4
                    ],
                    "attention_dropout": [
                        "uniform",
                        0.0,
                        0.5
                    ],
                    "ffn_d_hidden_factor": [
                        "uniform",
                        0.6666666666666666,
                        2.6666666666666665
                    ],
                    "ffn_dropout": [
                        "uniform",
                        0.0,
                        0.5
                    ]
                }
            },
            "pretrain": {
                "corrupt_probability": [
                    "uniform",
                    0.2,
                    0.8
                ]
            },
            "training": {
                "lr": [
                    "loguniform",
                    5e-05,
                    0.005
                ],
                "weight_decay": [
                    "?loguniform",
                    0.0,
                    1e-06,
                    0.001
                ]
            }
        },
        "n_trials": 100,
        "timeout": null,
        "sampler": {
            "seed": 0
        }
    },
    "best": {
        "program": "bin/pretrain_mask.py",
        "environment": {
            "CUDA_VISIBLE_DEVICES": "0",
            "gpus": {
                "driver": "450.119.04",
                "devices": [
                    {
                        "name": "A100-SXM-80GB",
                        "memory_total": 85199093760,
                        "memory_free": 85195948032,
                        "memory_used": 3145728,
                        "utilization": 0
                    }
                ]
            },
            "torch.version.cuda": "11.1",
            "torch.backends.cudnn.version()": 8005,
            "torch.cuda.nccl.version()": [
                2,
                10,
                3
            ]
        },
        "config": {
            "seed": 0,
            "data": {
                "path": "data/adult_roc",
                "T": {
                    "seed": 0,
                    "normalization": "quantile",
                    "num_nan_policy": null,
                    "cat_nan_policy": null,
                    "cat_min_frequency": null,
                    "cat_encoding": null,
                    "y_policy": "default"
                },
                "T_cache": true
            },
            "model": {
                "kind": "transformer",
                "config": {
                    "n_blocks": 4,
                    "attention_dropout": 0.3572304844404226,
                    "ffn_dropout": 0.33223899546615987,
                    "ffn_d_hidden": 1117
                },
                "default": true,
                "checkpoint": null,
                "num_embedding_arch": [
                    "linear"
                ],
                "d_num_embedding": 512,
                "positional_encoding": null,
                "d_cat_embedding": null
            },
            "training": {
                "batch_size": 256,
                "lr": 0.00020154708592539538,
                "weight_decay": 0.0,
                "optimizer": "AdamW",
                "patience": 16,
                "n_epochs": Infinity,
                "eval_batch_size": 8192
            },
            "pretrain": {
                "corrupt_probability": 0.43489200995679494,
                "corrupt_strategy": "resample",
                "d_hidden_head": 512,
                "lr": 0.00020154708592539538,
                "weight_decay": 0.0,
                "patience": 2,
                "n_iterations": 100000,
                "validate_every": 10000,
                "replace_strategy": "shuffle",
                "n_neighbors": 20,
                "use_target": false,
                "early_stop_type": "finetune",
                "target_injection_type": "post"
            },
            "bins": null
        },
        "epoch_size": 102,
        "n_parameters": 11409641,
        "metrics": {
            "iteration_scores": {
                "10000": {
                    "train": {
                        "score": 0.9313065385878072,
                        "pretrain_loss": 0.421036958694458,
                        "features_accuracy": [
                            0.6357493996620178,
                            0.5687576532363892,
                            0.7749922871589661,
                            0.9384597539901733,
                            0.9626075029373169,
                            0.7027410864830017,
                            0.8178746700286865,
                            0.7785242199897766,
                            0.7929975390434265,
                            0.6850813627243042,
                            0.7755298018455505,
                            0.893389105796814,
                            0.8364941477775574,
                            0.9255220890045166
                        ]
                    },
                    "val": {
                        "score": 0.9176893532944017,
                        "pretrain_loss": 0.42261290550231934,
                        "features_accuracy": [
                            0.6454782485961914,
                            0.5636419653892517,
                            0.7764471173286438,
                            0.9407339096069336,
                            0.9574697017669678,
                            0.7056655883789062,
                            0.8225088119506836,
                            0.7712267637252808,
                            0.7911868691444397,
                            0.6809458136558533,
                            0.7718409299850464,
                            0.903577446937561,
                            0.8406264185905457,
                            0.9241517186164856
                        ]
                    },
                    "test": {
                        "score": 0.9127802691520608,
                        "pretrain_loss": 0.42251020669937134,
                        "features_accuracy": [
                            0.6321479082107544,
                            0.5616362690925598,
                            0.7742767930030823,
                            0.9410970211029053,
                            0.9611203670501709,
                            0.7027209997177124,
                            0.810761034488678,
                            0.7802346348762512,
                            0.7939930558204651,
                            0.6791966557502747,
                            0.7740311026573181,
                            0.8960752487182617,
                            0.8350839018821716,
                            0.9275228977203369
                        ]
                    }
                },
                "20000": {
                    "train": {
                        "score": 0.9348948667890785,
                        "pretrain_loss": 0.4191432595252991,
                        "features_accuracy": [
                            0.640740156173706,
                            0.5658783912658691,
                            0.7784858345985413,
                            0.938421368598938,
                            0.9626458883285522,
                            0.6997466087341309,
                            0.8167997598648071,
                            0.7788697481155396,
                            0.7959920167922974,
                            0.6851197481155396,
                            0.7750306725502014,
                            0.8979576230049133,
                            0.8404867649078369,
                            0.9253301620483398
                        ]
                    },
                    "val": {
                        "score": 0.9197954282825365,
                        "pretrain_loss": 0.41941556334495544,
                        "features_accuracy": [
                            0.6468601226806641,
                            0.5639490485191345,
                            0.7746046185493469,
                            0.9418087005615234,
                            0.9602333903312683,
                            0.7079686522483826,
                            0.8228158950805664,
                            0.7758329510688782,
                            0.7905727028846741,
                            0.6818670630455017,
                            0.7750652432441711,
                            0.9043451547622681,
                            0.8393981456756592,
                            0.9250729084014893
                        ]
                    },
                    "test": {
                        "score": 0.913272344323608,
                        "pretrain_loss": 0.4202141761779785,
                        "features_accuracy": [
                            0.6349732875823975,
                            0.5615748763084412,
                            0.7788219451904297,
                            0.9409741759300232,
                            0.9601376056671143,
                            0.7033966183662415,
                            0.8100239634513855,
                            0.7799275517463684,
                            0.7943615317344666,
                            0.6823291182518005,
                            0.7740311026573181,
                            0.8979792594909668,
                            0.8359437584877014,
                            0.9284442663192749
                        ]
                    }
                },
                "30000": {
                    "train": {
                        "score": 0.9304650859552396,
                        "pretrain_loss": 0.4182157814502716,
                        "features_accuracy": [
                            0.6399339437484741,
                            0.5603117346763611,
                            0.7812883853912354,
                            0.9360027313232422,
                            0.9644502401351929,
                            0.7053132653236389,
                            0.8150721788406372,
                            0.7761824131011963,
                            0.7935733795166016,
                            0.6858875751495361,
                            0.7718826532363892,
                            0.8955006003379822,
                            0.8409474492073059,
                            0.9295530915260315
                        ]
                    },
                    "val": {
                        "score": 0.9199737288747653,
                        "pretrain_loss": 0.4192613363265991,
                        "features_accuracy": [
                            0.6453247666358948,
                            0.5621065497398376,
                            0.7755258679389954,
                            0.9425764083862305,
                            0.9585444331169128,
                            0.7038231492042542,
                            0.8212805390357971,
                            0.7744510769844055,
                            0.792415201663971,
                            0.6877015233039856,
                            0.7693843245506287,
                            0.9055734872817993,
                            0.8401658535003662,
                            0.9223092198371887
                        ]
                    },
                    "test": {
                        "score": 0.9146166305035797,
                        "pretrain_loss": 0.42002353072166443,
                        "features_accuracy": [
                            0.6370616555213928,
                            0.5620662569999695,
                            0.7767950892448425,
                            0.9413427114486694,
                            0.9627787470817566,
                            0.7022296190261841,
                            0.8108224868774414,
                            0.7799275517463684,
                            0.7941772937774658,
                            0.6831890344619751,
                            0.7748295664787292,
                            0.8958909511566162,
                            0.8365579843521118,
                            0.9285056591033936
                        ]
                    }
                },
                "40000": {
                    "train": {
                        "score": 0.931978501163758,
                        "pretrain_loss": 0.4187994599342346,
                        "features_accuracy": [
                            0.6404330134391785,
                            0.5634597539901733,
                            0.7791385054588318,
                            0.938997209072113,
                            0.9640663266181946,
                            0.7012438178062439,
                            0.816646158695221,
                            0.7789849638938904,
                            0.7939189076423645,
                            0.6956388354301453,
                            0.7724201083183289,
                            0.8954622149467468,
                            0.8370316028594971,
                            0.9277871251106262
                        ]
                    },
                    "val": {
                        "score": 0.9201061162584345,
                        "pretrain_loss": 0.41848939657211304,
                        "features_accuracy": [
                            0.6476278305053711,
                            0.5637955069541931,
                            0.7775219082832336,
                            0.9430370330810547,
                            0.9583908915519714,
                            0.7016735672950745,
                            0.8254261016845703,
                            0.7750652432441711,
                            0.7961001396179199,
                            0.6873944401741028,
                            0.7729157209396362,
                            0.9044986963272095,
                            0.8410870432853699,
                            0.9233840107917786
                        ]
                    },
                    "test": {
                        "score": 0.9149568813472283,
                        "pretrain_loss": 0.41968923807144165,
                        "features_accuracy": [
                            0.6394570469856262,
                            0.5623119473457336,
                            0.7783920168876648,
                            0.9414655566215515,
                            0.9616117477416992,
                            0.70536208152771,
                            0.8106381893157959,
                            0.7811560034751892,
                            0.794975757598877,
                            0.6841103434562683,
                            0.7736011743545532,
                            0.8973036408424377,
                            0.8358209133148193,
                            0.9275228977203369
                        ]
                    }
                },
                "50000": {
                    "train": {
                        "score": 0.9327329435263566,
                        "pretrain_loss": 0.4155048131942749,
                        "features_accuracy": [
                            0.6411240696907043,
                            0.5680666565895081,
                            0.7820945978164673,
                            0.9381142258644104,
                            0.9636056423187256,
                            0.7021268010139465,
                            0.8191415667533875,
                            0.7799063324928284,
                            0.7994855642318726,
                            0.6940264105796814,
                            0.7798295021057129,
                            0.8959228992462158,
                            0.8413313627243042,
                            0.9264434576034546
                        ]
                    },
                    "val": {
                        "score": 0.9211096293927077,
                        "pretrain_loss": 0.41829341650009155,
                        "features_accuracy": [
                            0.6471672058105469,
                            0.5641025900840759,
                            0.7752187848091125,
                            0.9425764083862305,
                            0.9591585993766785,
                            0.7099646925926208,
                            0.8237371444702148,
                            0.7741440534591675,
                            0.7930293083190918,
                            0.6893904805183411,
                            0.7713803052902222,
                            0.9071088433265686,
                            0.8417012095451355,
                            0.9239981770515442
                        ]
                    },
                    "test": {
                        "score": 0.9155516224669895,
                        "pretrain_loss": 0.419223427772522,
                        "features_accuracy": [
                            0.6389656662940979,
                            0.5620662569999695,
                            0.7764265537261963,
                            0.9420183300971985,
                            0.9636386632919312,
                            0.7056692242622375,
                            0.8097168803215027,
                            0.7828143835067749,
                            0.7965112924575806,
                            0.6846631169319153,
                            0.7758123278617859,
                            0.8959524035453796,
                            0.8350224494934082,
                            0.9277685880661011
                        ]
                    }
                },
                "60000": {
                    "train": {
                        "score": 0.9325464601266076,
                        "pretrain_loss": 0.4158444106578827,
                        "features_accuracy": [
                            0.6430819630622864,
                            0.5635749101638794,
                            0.7824016809463501,
                            0.9369240999221802,
                            0.9638359546661377,
                            0.7040079832077026,
                            0.815839946269989,
                            0.7855497598648071,
                            0.7959920167922974,
                            0.698594868183136,
                            0.7762207984924316,
                            0.8962300419807434,
                            0.8462837934494019,
                            0.9315494298934937
                        ]
                    },
                    "val": {
                        "score": 0.9210368904892593,
                        "pretrain_loss": 0.41902658343315125,
                        "features_accuracy": [
                            0.6483955383300781,
                            0.5644096732139587,
                            0.777675449848175,
                            0.9421157836914062,
                            0.9602333903312683,
                            0.7075080871582031,
                            0.8198986649513245,
                            0.7767542004585266,
                            0.7908797860145569,
                            0.6857055425643921,
                            0.7741440534591675,
                            0.9028097987174988,
                            0.8404728770256042,
                            0.9223092198371887
                        ]
                    },
                    "test": {
                        "score": 0.9152712775177674,
                        "pretrain_loss": 0.41958433389663696,
                        "features_accuracy": [
                            0.6398255825042725,
                            0.562557578086853,
                            0.7768564820289612,
                            0.9417112469673157,
                            0.9632086753845215,
                            0.7025367021560669,
                            0.8087955713272095,
                            0.7820773124694824,
                            0.7956514358520508,
                            0.6864443421363831,
                            0.7742767930030823,
                            0.8963208794593811,
                            0.8361280560493469,
                            0.9287513494491577
                        ]
                    }
                },
                "70000": {
                    "train": {
                        "score": 0.9317155920573856,
                        "pretrain_loss": 0.41649559140205383,
                        "features_accuracy": [
                            0.6469594240188599,
                            0.5654177069664001,
                            0.7822481393814087,
                            0.9379222989082336,
                            0.9631449580192566,
                            0.7010518908500671,
                            0.8192951083183289,
                            0.7826704382896423,
                            0.7977579832077026,
                            0.6911087036132812,
                            0.775337815284729,
                            0.8966907262802124,
                            0.8417920470237732,
                            0.9281710386276245
                        ]
                    },
                    "val": {
                        "score": 0.9213152070737294,
                        "pretrain_loss": 0.41765156388282776,
                        "features_accuracy": [
                            0.6462459564208984,
                            0.5633348822593689,
                            0.7750652432441711,
                            0.9424228668212891,
                            0.9591585993766785,
                            0.7091969847679138,
                            0.8232765197753906,
                            0.7759864926338196,
                            0.7925686836242676,
                            0.6901581287384033,
                            0.7730692625045776,
                            0.9040380716323853,
                            0.8400123119354248,
                            0.9232304692268372
                        ]
                    },
                    "test": {
                        "score": 0.9161251090172277,
                        "pretrain_loss": 0.4189054071903229,
                        "features_accuracy": [
                            0.6384743452072144,
                            0.5628032684326172,
                            0.7775935530662537,
                            0.9418340921401978,
                            0.9637615084648132,
                            0.7011854648590088,
                            0.8098397254943848,
                            0.7809717059135437,
                            0.7950372099876404,
                            0.6874271035194397,
                            0.7756894826889038,
                            0.8970579504966736,
                            0.8356980681419373,
                            0.9274615049362183
                        ]
                    }
                },
                "80000": {
                    "train": {
                        "score": 0.9318957513216094,
                        "pretrain_loss": 0.4148387610912323,
                        "features_accuracy": [
                            0.6429668068885803,
                            0.5682585835456848,
                            0.7871621251106262,
                            0.9404560923576355,
                            0.9652564525604248,
                            0.7075015306472778,
                            0.8193719387054443,
                            0.7793304324150085,
                            0.7962607145309448,
                            0.6931050419807434,
                            0.7758368849754333,
                            0.8994932174682617,
                            0.8435580134391785,
                            0.9287084937095642
                        ]
                    },
                    "val": {
                        "score": 0.9216381471698892,
                        "pretrain_loss": 0.41751405596733093,
                        "features_accuracy": [
                            0.6500844359397888,
                            0.5634884238243103,
                            0.7793643474578857,
                            0.9411945343017578,
                            0.9585444331169128,
                            0.7098111510276794,
                            0.8212805390357971,
                            0.7789037227630615,
                            0.7921081185340881,
                            0.6900045871734619,
                            0.775372326374054,
                            0.9048057794570923,
                            0.8420082926750183,
                            0.9232304692268372
                        ]
                    },
                    "test": {
                        "score": 0.9154598713100115,
                        "pretrain_loss": 0.4185875952243805,
                        "features_accuracy": [
                            0.6367545127868652,
                            0.5641545653343201,
                            0.7777777910232544,
                            0.9421411752700806,
                            0.9624716639518738,
                            0.70536208152771,
                            0.8100239634513855,
                            0.7814016938209534,
                            0.7962656021118164,
                            0.6858915686607361,
                            0.7744610905647278,
                            0.8971807956695557,
                            0.8361280560493469,
                            0.9288741946220398
                        ]
                    }
                },
                "90000": {
                    "train": {
                        "score": 0.9366536213737239,
                        "pretrain_loss": 0.4132857620716095,
                        "features_accuracy": [
                            0.6428900361061096,
                            0.5684505701065063,
                            0.7871237397193909,
                            0.9406480193138123,
                            0.9654867649078369,
                            0.7067720890045166,
                            0.8212146759033203,
                            0.7860104441642761,
                            0.7943412065505981,
                            0.6909167766571045,
                            0.7752994298934937,
                            0.8998387455940247,
                            0.8443642258644104,
                            0.9310887455940247
                        ]
                    },
                    "val": {
                        "score": 0.9215643765089454,
                        "pretrain_loss": 0.41912826895713806,
                        "features_accuracy": [
                            0.6503915190696716,
                            0.5633348822593689,
                            0.7781360149383545,
                            0.9438046813011169,
                            0.9593121409416199,
                            0.7072010040283203,
                            0.8245048522949219,
                            0.775372326374054,
                            0.792415201663971,
                            0.6846307516098022,
                            0.7735298871994019,
                            0.9046522378921509,
                            0.8410870432853699,
                            0.9233840107917786
                        ]
                    },
                    "test": {
                        "score": 0.9153559716976536,
                        "pretrain_loss": 0.4196681082248688,
                        "features_accuracy": [
                            0.6388428807258606,
                            0.5636017918586731,
                            0.7771636247634888,
                            0.942202627658844,
                            0.9630858302116394,
                            0.7003255486488342,
                            0.8110681772232056,
                            0.782937228679657,
                            0.7970026731491089,
                            0.6866286396980286,
                            0.7754437923431396,
                            0.8969965577125549,
                            0.8345925211906433,
                            0.9286898970603943
                        ]
                    }
                },
                "100000": {
                    "train": {
                        "score": 0.9328319450666804,
                        "pretrain_loss": 0.4126584529876709,
                        "features_accuracy": [
                            0.6450783014297485,
                            0.5626919269561768,
                            0.7845131754875183,
                            0.9391891956329346,
                            0.9647573232650757,
                            0.7065801620483398,
                            0.8206003904342651,
                            0.787738025188446,
                            0.7978731393814087,
                            0.695370078086853,
                            0.7773341536521912,
                            0.9033706784248352,
                            0.8408706784248352,
                            0.9312422871589661
                        ]
                    },
                    "val": {
                        "score": 0.9227475444171602,
                        "pretrain_loss": 0.41814881563186646,
                        "features_accuracy": [
                            0.6483955383300781,
                            0.5653308629989624,
                            0.7746046185493469,
                            0.9448794722557068,
                            0.9608475565910339,
                            0.7084292769432068,
                            0.8209734559059143,
                            0.7759864926338196,
                            0.793489933013916,
                            0.6853984594345093,
                            0.7730692625045776,
                            0.9040380716323853,
                            0.8407799601554871,
                            0.9232304692268372
                        ]
                    },
                    "test": {
                        "score": 0.9167767345997418,
                        "pretrain_loss": 0.4184756577014923,
                        "features_accuracy": [
                            0.6379215121269226,
                            0.5648301839828491,
                            0.778084933757782,
                            0.9428167939186096,
                            0.9641299843788147,
                            0.7013083100318909,
                            0.8092254996299744,
                            0.782015860080719,
                            0.7961427569389343,
                            0.6865057945251465,
                            0.7779006361961365,
                            0.8974879384040833,
                            0.8366808295249939,
                            0.9278300404548645
                        ]
                    }
                }
            },
            "train": {
                "score": 0.9328319450666804
            },
            "val": {
                "score": 0.9227475444171602
            },
            "test": {
                "score": 0.9167767345997418
            }
        },
        "best_iteration": 100000,
        "time": "0:39:33",
        "trial_id": 77,
        "tuning_time": "1 day, 10:50:47"
    },
    "time": "1 day, 21:43:41",
    "continuations": [
        5
    ]
}
