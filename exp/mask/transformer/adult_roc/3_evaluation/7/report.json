{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask___38232d9c099046c9a63825936c99cd7a.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 7,
        "data": {
            "path": "data/adult_roc",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "transformer",
            "config": {
                "n_blocks": 4,
                "attention_dropout": 0.3572304844404226,
                "ffn_dropout": 0.33223899546615987,
                "ffn_d_hidden": 1117
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear"
            ],
            "d_num_embedding": 512,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 256,
            "lr": 0.00020154708592539538,
            "weight_decay": 0.0,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.43489200995679494,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.00020154708592539538,
            "weight_decay": 0.0,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "epoch_size": 102,
    "n_parameters": 11409641,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": 0.930809563914781,
                    "pretrain_loss": 0.42144548892974854,
                    "features_accuracy": [
                        0.6371314525604248,
                        0.5677978992462158,
                        0.7759904861450195,
                        0.9387285113334656,
                        0.9621083736419678,
                        0.6978271007537842,
                        0.8141508102416992,
                        0.7746083736419678,
                        0.7924984693527222,
                        0.6872696280479431,
                        0.7709228992462158,
                        0.8937730193138123,
                        0.8371083736419678,
                        0.9284014105796814
                    ]
                },
                "val": {
                    "score": 0.9173033470213162,
                    "pretrain_loss": 0.42384567856788635,
                    "features_accuracy": [
                        0.629510223865509,
                        0.5713189244270325,
                        0.7713803052902222,
                        0.9367418885231018,
                        0.9614617228507996,
                        0.6998311281204224,
                        0.8169814348220825,
                        0.7741440534591675,
                        0.7871948480606079,
                        0.6861661076545715,
                        0.7735298871994019,
                        0.8982036113739014,
                        0.8332565426826477,
                        0.9238446354866028
                    ]
                },
                "test": {
                    "score": 0.912886855643104,
                    "pretrain_loss": 0.4250948131084442,
                    "features_accuracy": [
                        0.6338677406311035,
                        0.5627418756484985,
                        0.7735397219657898,
                        0.9412198662757874,
                        0.9616731405258179,
                        0.6963331699371338,
                        0.812358021736145,
                        0.7714514136314392,
                        0.789017915725708,
                        0.6805478930473328,
                        0.7673976421356201,
                        0.8941097259521484,
                        0.8334255218505859,
                        0.9250046610832214
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": 0.9302281344223422,
                    "pretrain_loss": 0.4196285307407379,
                    "features_accuracy": [
                        0.6379760503768921,
                        0.5714066028594971,
                        0.7794840335845947,
                        0.9362331032752991,
                        0.9650260806083679,
                        0.6997466087341309,
                        0.815724790096283,
                        0.7770653963088989,
                        0.7921913266181946,
                        0.6843519806861877,
                        0.7730727791786194,
                        0.8946560025215149,
                        0.8414081335067749,
                        0.9302441477775574
                    ]
                },
                "val": {
                    "score": 0.9189606074988135,
                    "pretrain_loss": 0.42266714572906494,
                    "features_accuracy": [
                        0.6356517672538757,
                        0.572547197341919,
                        0.7695378661155701,
                        0.9375095963478088,
                        0.9608475565910339,
                        0.7032089829444885,
                        0.8175956010818481,
                        0.7739905118942261,
                        0.7833563685417175,
                        0.6892369389533997,
                        0.7729157209396362,
                        0.9008137583732605,
                        0.8337171673774719,
                        0.9246123433113098
                    ]
                },
                "test": {
                    "score": 0.9134160871058888,
                    "pretrain_loss": 0.4235605299472809,
                    "features_accuracy": [
                        0.6376758217811584,
                        0.5626804232597351,
                        0.7761194109916687,
                        0.9410356283187866,
                        0.9614889025688171,
                        0.7024139165878296,
                        0.8127879500389099,
                        0.7725570201873779,
                        0.7910448312759399,
                        0.6809778809547424,
                        0.7721270322799683,
                        0.8961366415023804,
                        0.8345925211906433,
                        0.9254345893859863
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": 0.9307189905244779,
                    "pretrain_loss": 0.4180714786052704,
                    "features_accuracy": [
                        0.6480727791786194,
                        0.5704468488693237,
                        0.7790617346763611,
                        0.9369240999221802,
                        0.9630681872367859,
                        0.7007831335067749,
                        0.8170300722122192,
                        0.783092737197876,
                        0.7980650663375854,
                        0.6887668967247009,
                        0.7787545919418335,
                        0.894425630569458,
                        0.8360334634780884,
                        0.9270193576812744
                    ]
                },
                "val": {
                    "score": 0.9208908968036155,
                    "pretrain_loss": 0.421550989151001,
                    "features_accuracy": [
                        0.6356517672538757,
                        0.574082612991333,
                        0.7692307829856873,
                        0.937202513217926,
                        0.961615264415741,
                        0.7012129426002502,
                        0.8163672685623169,
                        0.7736834287643433,
                        0.7870413064956665,
                        0.68708735704422,
                        0.7764471173286438,
                        0.902502715587616,
                        0.8311070203781128,
                        0.9244588017463684
                    ]
                },
                "test": {
                    "score": 0.9149161286113687,
                    "pretrain_loss": 0.42246270179748535,
                    "features_accuracy": [
                        0.6384128928184509,
                        0.5642159581184387,
                        0.7767336368560791,
                        0.9425097107887268,
                        0.9623488187789917,
                        0.7006326913833618,
                        0.8136478662490845,
                        0.7745224833488464,
                        0.7914133667945862,
                        0.6815306544303894,
                        0.7702844142913818,
                        0.8968122601509094,
                        0.8333640694618225,
                        0.9261102080345154
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": 0.9300216830382776,
                    "pretrain_loss": 0.41723400354385376,
                    "features_accuracy": [
                        0.642582893371582,
                        0.5755144357681274,
                        0.777180552482605,
                        0.9362331032752991,
                        0.9640279412269592,
                        0.7033169269561768,
                        0.8170300722122192,
                        0.782286524772644,
                        0.7940724492073059,
                        0.6903024911880493,
                        0.7760288715362549,
                        0.8981495499610901,
                        0.8407939076423645,
                        0.929745078086853
                    ]
                },
                "val": {
                    "score": 0.920449433565135,
                    "pretrain_loss": 0.42156219482421875,
                    "features_accuracy": [
                        0.6328880786895752,
                        0.5746967792510986,
                        0.7713803052902222,
                        0.9382773041725159,
                        0.961922287940979,
                        0.704437255859375,
                        0.818977415561676,
                        0.7730692625045776,
                        0.7907262444496155,
                        0.6857055425643921,
                        0.7710732221603394,
                        0.8998925089836121,
                        0.8338707089424133,
                        0.9244588017463684
                    ]
                },
                "test": {
                    "score": 0.9145870225641354,
                    "pretrain_loss": 0.4223877489566803,
                    "features_accuracy": [
                        0.635157585144043,
                        0.5652601718902588,
                        0.775382399559021,
                        0.9418340921401978,
                        0.9620416760444641,
                        0.6997727751731873,
                        0.8146305680274963,
                        0.7748295664787292,
                        0.7912290692329407,
                        0.681469202041626,
                        0.7707757949829102,
                        0.8977335691452026,
                        0.8348996043205261,
                        0.9258645176887512
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": 0.9299177721307962,
                    "pretrain_loss": 0.41619205474853516,
                    "features_accuracy": [
                        0.6469978094100952,
                        0.5672220587730408,
                        0.7834766507148743,
                        0.9378070831298828,
                        0.9649876952171326,
                        0.7037392258644104,
                        0.8195638656616211,
                        0.7780251502990723,
                        0.795492947101593,
                        0.6914158463478088,
                        0.7732647061347961,
                        0.8977272510528564,
                        0.840141236782074,
                        0.9274800419807434
                    ]
                },
                "val": {
                    "score": 0.9210147077031016,
                    "pretrain_loss": 0.42039376497268677,
                    "features_accuracy": [
                        0.631659746170044,
                        0.5754644870758057,
                        0.771687388420105,
                        0.9387379288673401,
                        0.9620758295059204,
                        0.7012129426002502,
                        0.8198986649513245,
                        0.7715338468551636,
                        0.7885767221450806,
                        0.6858590841293335,
                        0.7756794095039368,
                        0.9018885493278503,
                        0.8335636258125305,
                        0.9247658848762512
                    ]
                },
                "test": {
                    "score": 0.9152007913850932,
                    "pretrain_loss": 0.42144834995269775,
                    "features_accuracy": [
                        0.6387200355529785,
                        0.5649530291557312,
                        0.7755052447319031,
                        0.9420797824859619,
                        0.9629629850387573,
                        0.7008169293403625,
                        0.8134021759033203,
                        0.7740311026573181,
                        0.7916589975357056,
                        0.6859529614448547,
                        0.7712671756744385,
                        0.8966894149780273,
                        0.8348996043205261,
                        0.9269087314605713
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": 0.9317848350938331,
                    "pretrain_loss": 0.41799548268318176,
                    "features_accuracy": [
                        0.6414312124252319,
                        0.5675675272941589,
                        0.7807125449180603,
                        0.9360411167144775,
                        0.9643734693527222,
                        0.7035089135169983,
                        0.8151489496231079,
                        0.7797143459320068,
                        0.7982186675071716,
                        0.6892275810241699,
                        0.7751458883285522,
                        0.900337815284729,
                        0.8407171368598938,
                        0.9284781813621521
                    ]
                },
                "val": {
                    "score": 0.9205894946451786,
                    "pretrain_loss": 0.4219066798686981,
                    "features_accuracy": [
                        0.6282818913459778,
                        0.5737755298614502,
                        0.771687388420105,
                        0.9390450119972229,
                        0.9614617228507996,
                        0.7036696076393127,
                        0.8218947052955627,
                        0.7762935757637024,
                        0.7905727028846741,
                        0.68708735704422,
                        0.7750652432441711,
                        0.8991248607635498,
                        0.8341777920722961,
                        0.9252264499664307
                    ]
                },
                "test": {
                    "score": 0.9150476288452423,
                    "pretrain_loss": 0.42259880900382996,
                    "features_accuracy": [
                        0.6360788941383362,
                        0.5654444098472595,
                        0.779313325881958,
                        0.9421411752700806,
                        0.9616117477416992,
                        0.6992813944816589,
                        0.8116823434829712,
                        0.7743996381759644,
                        0.7911062240600586,
                        0.6846017241477966,
                        0.7719427943229675,
                        0.8965665698051453,
                        0.8355752229690552,
                        0.9253117442131042
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": 0.9302987801351204,
                    "pretrain_loss": 0.4136342704296112,
                    "features_accuracy": [
                        0.6427364945411682,
                        0.5625383853912354,
                        0.784014105796814,
                        0.9382293820381165,
                        0.9654483795166016,
                        0.7022804021835327,
                        0.8210610747337341,
                        0.7801366448402405,
                        0.8017506003379822,
                        0.6950245499610901,
                        0.7776796817779541,
                        0.9016430974006653,
                        0.8403332233428955,
                        0.9295914769172668
                    ]
                },
                "val": {
                    "score": 0.9207914611749655,
                    "pretrain_loss": 0.42130473256111145,
                    "features_accuracy": [
                        0.6350376009941101,
                        0.5734684467315674,
                        0.7703055739402771,
                        0.9376631379127502,
                        0.9605404734611511,
                        0.7078151702880859,
                        0.8175956010818481,
                        0.776140034198761,
                        0.7878090143203735,
                        0.6873944401741028,
                        0.7762935757637024,
                        0.9006602168083191,
                        0.8334100842475891,
                        0.9241517186164856
                    ]
                },
                "test": {
                    "score": 0.915619181261018,
                    "pretrain_loss": 0.42136338353157043,
                    "features_accuracy": [
                        0.6387814283370972,
                        0.5643388032913208,
                        0.7779620885848999,
                        0.9420183300971985,
                        0.9632701277732849,
                        0.6994656920433044,
                        0.8151834011077881,
                        0.7753209471702576,
                        0.7921503782272339,
                        0.6824519634246826,
                        0.7715128660202026,
                        0.897672176361084,
                        0.8345310688018799,
                        0.9269087314605713
                    ]
                }
            },
            "80000": {
                "train": {
                    "score": 0.931411852171619,
                    "pretrain_loss": 0.41398829221725464,
                    "features_accuracy": [
                        0.644310474395752,
                        0.5650337934494019,
                        0.7786778211593628,
                        0.9378070831298828,
                        0.9643734693527222,
                        0.7083077430725098,
                        0.8214833736419678,
                        0.7885826230049133,
                        0.8020193576812744,
                        0.6933353543281555,
                        0.7759521007537842,
                        0.8981111645698547,
                        0.8426750302314758,
                        0.9299753904342651
                    ]
                },
                "val": {
                    "score": 0.9214437898516332,
                    "pretrain_loss": 0.42120224237442017,
                    "features_accuracy": [
                        0.6305850148200989,
                        0.5737755298614502,
                        0.7696914076805115,
                        0.9398126602172852,
                        0.962689995765686,
                        0.7022877335548401,
                        0.8188238739967346,
                        0.7703055739402771,
                        0.789804995059967,
                        0.6889298558235168,
                        0.7739905118942261,
                        0.8991248607635498,
                        0.8337171673774719,
                        0.92353755235672
                    ]
                },
                "test": {
                    "score": 0.915979745743911,
                    "pretrain_loss": 0.4215424358844757,
                    "features_accuracy": [
                        0.6393956542015076,
                        0.5646459460258484,
                        0.7788833975791931,
                        0.9416497945785522,
                        0.9632086753845215,
                        0.7000798583030701,
                        0.8132793307304382,
                        0.7764879465103149,
                        0.7905534505844116,
                        0.6839261054992676,
                        0.7718813419342041,
                        0.8969965577125549,
                        0.8355138301849365,
                        0.9258031249046326
                    ]
                }
            },
            "90000": {
                "train": {
                    "score": 0.9314901158679171,
                    "pretrain_loss": 0.4146104156970978,
                    "features_accuracy": [
                        0.6365939974784851,
                        0.5676443576812744,
                        0.7835150361061096,
                        0.9391508102416992,
                        0.9661010503768921,
                        0.7052364945411682,
                        0.8183737397193909,
                        0.7829391956329346,
                        0.7960304021835327,
                        0.6942183375358582,
                        0.780328631401062,
                        0.8991476893424988,
                        0.8407939076423645,
                        0.9333537817001343
                    ]
                },
                "val": {
                    "score": 0.9208932182579805,
                    "pretrain_loss": 0.42167341709136963,
                    "features_accuracy": [
                        0.6318132877349854,
                        0.5743896961212158,
                        0.7713803052902222,
                        0.9398126602172852,
                        0.9628435373306274,
                        0.6995240449905396,
                        0.817902684211731,
                        0.7744510769844055,
                        0.7881160974502563,
                        0.6860125660896301,
                        0.7759864926338196,
                        0.8978965282440186,
                        0.8338707089424133,
                        0.9238446354866028
                    ]
                },
                "test": {
                    "score": 0.9153779476470575,
                    "pretrain_loss": 0.4214562475681305,
                    "features_accuracy": [
                        0.6370002031326294,
                        0.5647687911987305,
                        0.7801732420921326,
                        0.9433081746101379,
                        0.9637615084648132,
                        0.702659547328949,
                        0.8137707114219666,
                        0.7745224833488464,
                        0.7928874492645264,
                        0.6851544976234436,
                        0.7741539478302002,
                        0.8965051770210266,
                        0.8350224494934082,
                        0.9264787435531616
                    ]
                }
            },
            "100000": {
                "train": {
                    "score": 0.938443956329204,
                    "pretrain_loss": 0.4128640294075012,
                    "features_accuracy": [
                        0.6457309722900391,
                        0.5689496397972107,
                        0.7830543518066406,
                        0.940839946269989,
                        0.9667920470237732,
                        0.7096897959709167,
                        0.823594868183136,
                        0.7825936675071716,
                        0.7956848740577698,
                        0.6933737397193909,
                        0.7754529714584351,
                        0.9006833434104919,
                        0.8407939076423645,
                        0.9306280612945557
                    ]
                },
                "val": {
                    "score": 0.9207696008130248,
                    "pretrain_loss": 0.420269250869751,
                    "features_accuracy": [
                        0.6335022449493408,
                        0.574082612991333,
                        0.7727621793746948,
                        0.9407339096069336,
                        0.9623829126358032,
                        0.7048978805541992,
                        0.8214340806007385,
                        0.77982497215271,
                        0.7885767221450806,
                        0.6887763142585754,
                        0.7726086378097534,
                        0.9012743830680847,
                        0.8334100842475891,
                        0.9246123433113098
                    ]
                },
                "test": {
                    "score": 0.9150657051613791,
                    "pretrain_loss": 0.42066264152526855,
                    "features_accuracy": [
                        0.637982964515686,
                        0.5653215646743774,
                        0.7781463265419006,
                        0.9430010914802551,
                        0.9634543657302856,
                        0.7013083100318909,
                        0.8145077228546143,
                        0.7740311026573181,
                        0.7924575209617615,
                        0.6855230331420898,
                        0.7739697098731995,
                        0.8970579504966736,
                        0.8341625332832336,
                        0.9261102080345154
                    ]
                }
            }
        },
        "train": {
            "score": 0.931411852171619
        },
        "val": {
            "score": 0.9214437898516332
        },
        "test": {
            "score": 0.915979745743911
        }
    },
    "best_iteration": 80000,
    "time": "0:38:09"
}
