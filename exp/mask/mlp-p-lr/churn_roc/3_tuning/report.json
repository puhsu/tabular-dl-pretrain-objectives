{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/tune.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 0,
        "program": "bin/pretrain_mask.py",
        "base_config": {
            "seed": 0,
            "data": {
                "T_cache": true,
                "path": "data/churn_roc",
                "T": {
                    "normalization": "quantile"
                }
            },
            "model": {
                "kind": "mlp",
                "num_embedding_arch": [
                    "positional",
                    "linear",
                    "relu"
                ],
                "positional_encoding": {
                    "trainable": true,
                    "initialization": "normal"
                }
            },
            "training": {
                "batch_size": 128,
                "patience": 16
            },
            "pretrain": {
                "corrupt_strategy": "resample",
                "patience": 2,
                "d_hidden_head": 512,
                "replace_strategy": "shuffle",
                "use_target": false
            }
        },
        "space": {
            "model": {
                "d_num_embedding": [
                    "int",
                    1,
                    128
                ],
                "config": {
                    "d_layers": [
                        "$fixed_mlp_d_layers",
                        1,
                        8,
                        512
                    ],
                    "dropout": [
                        "?uniform",
                        0.0,
                        0.0,
                        0.5
                    ]
                },
                "positional_encoding": {
                    "n": [
                        "int",
                        1,
                        128
                    ],
                    "sigma": [
                        "loguniform",
                        0.01,
                        100.0
                    ]
                }
            },
            "pretrain": {
                "corrupt_probability": [
                    "uniform",
                    0.2,
                    0.8
                ]
            },
            "training": {
                "lr": [
                    "loguniform",
                    5e-05,
                    0.005
                ],
                "weight_decay": [
                    "?loguniform",
                    0.0,
                    1e-06,
                    0.001
                ]
            }
        },
        "n_trials": 100,
        "timeout": null,
        "sampler": {
            "seed": 0
        }
    },
    "best": {
        "program": "bin/pretrain_mask.py",
        "environment": {
            "CUDA_VISIBLE_DEVICES": "0",
            "gpus": {
                "driver": "450.119.04",
                "devices": [
                    {
                        "name": "A100-SXM-80GB",
                        "memory_total": 85199093760,
                        "memory_free": 85195948032,
                        "memory_used": 3145728,
                        "utilization": 0
                    }
                ]
            },
            "torch.version.cuda": "11.1",
            "torch.backends.cudnn.version()": 8005,
            "torch.cuda.nccl.version()": [
                2,
                10,
                3
            ]
        },
        "config": {
            "seed": 0,
            "data": {
                "path": "data/churn_roc",
                "T": {
                    "seed": 0,
                    "normalization": "quantile",
                    "num_nan_policy": null,
                    "cat_nan_policy": null,
                    "cat_min_frequency": null,
                    "cat_encoding": null,
                    "y_policy": "default"
                },
                "T_cache": true
            },
            "model": {
                "kind": "mlp",
                "config": {
                    "d_layers": [
                        512,
                        512,
                        512,
                        512,
                        512
                    ],
                    "dropout": 0.0
                },
                "default": true,
                "checkpoint": null,
                "num_embedding_arch": [
                    "positional",
                    "linear",
                    "relu"
                ],
                "d_num_embedding": 85,
                "positional_encoding": {
                    "n": 8,
                    "sigma": 0.024076265449804925,
                    "trainable": true,
                    "initialization": "normal"
                },
                "d_cat_embedding": null
            },
            "training": {
                "batch_size": 128,
                "lr": 7.093343282853754e-05,
                "weight_decay": 3.72145591513699e-05,
                "optimizer": "AdamW",
                "patience": 16,
                "n_epochs": Infinity,
                "eval_batch_size": 8192
            },
            "pretrain": {
                "corrupt_probability": 0.4764413044396767,
                "corrupt_strategy": "resample",
                "d_hidden_head": 512,
                "lr": 7.093343282853754e-05,
                "weight_decay": 3.72145591513699e-05,
                "patience": 2,
                "n_iterations": 100000,
                "finetune_every": 10000,
                "replace_strategy": "shuffle",
                "n_neighbors": 20,
                "use_target": false,
                "target_injection_type": "post"
            },
            "bins": null
        },
        "epoch_size": 50,
        "n_parameters": 1770701,
        "metrics": {
            "iteration_scores": {
                "10000": {
                    "train": {
                        "score": 0.8959616468106828,
                        "pretrain_loss": 0.6181243658065796,
                        "features_accuracy": [
                            0.5201562643051147,
                            0.7643749713897705,
                            0.5310937166213989,
                            0.5681250095367432,
                            0.6276562213897705,
                            0.7473437190055847,
                            0.5218749642372131,
                            0.8023437261581421,
                            0.7651562094688416,
                            0.515625,
                            0.7042187452316284
                        ]
                    },
                    "val": {
                        "score": 0.8682041008947232,
                        "pretrain_loss": 0.6158348321914673,
                        "features_accuracy": [
                            0.5249999761581421,
                            0.768750011920929,
                            0.5118749737739563,
                            0.5799999833106995,
                            0.6068750023841858,
                            0.7574999928474426,
                            0.5293750166893005,
                            0.8006249666213989,
                            0.7718749642372131,
                            0.5212500095367432,
                            0.7137500047683716
                        ]
                    },
                    "test": {
                        "score": 0.8589930454337235,
                        "pretrain_loss": 0.6155434250831604,
                        "features_accuracy": [
                            0.5295000076293945,
                            0.768500030040741,
                            0.5225000381469727,
                            0.5530000329017639,
                            0.6135000586509705,
                            0.7535000443458557,
                            0.5275000333786011,
                            0.7980000376701355,
                            0.7690000534057617,
                            0.5065000057220459,
                            0.721500039100647
                        ]
                    }
                },
                "20000": {
                    "train": {
                        "score": 0.8878598395469561,
                        "pretrain_loss": 0.6170273423194885,
                        "features_accuracy": [
                            0.5329687595367432,
                            0.7724999785423279,
                            0.5378124713897705,
                            0.5660937428474426,
                            0.6131249666213989,
                            0.7464062571525574,
                            0.5218749642372131,
                            0.7992187142372131,
                            0.7628124952316284,
                            0.5243749618530273,
                            0.7167187333106995
                        ]
                    },
                    "val": {
                        "score": 0.8733109572285734,
                        "pretrain_loss": 0.6155539751052856,
                        "features_accuracy": [
                            0.5249999761581421,
                            0.768750011920929,
                            0.5106250047683716,
                            0.5799999833106995,
                            0.6100000143051147,
                            0.7574999928474426,
                            0.5293750166893005,
                            0.8006249666213989,
                            0.7718749642372131,
                            0.5212500095367432,
                            0.715624988079071
                        ]
                    },
                    "test": {
                        "score": 0.8634381685229143,
                        "pretrain_loss": 0.6155476570129395,
                        "features_accuracy": [
                            0.5295000076293945,
                            0.768500030040741,
                            0.5230000019073486,
                            0.5530000329017639,
                            0.612500011920929,
                            0.7540000081062317,
                            0.5275000333786011,
                            0.7980000376701355,
                            0.7690000534057617,
                            0.5065000057220459,
                            0.7250000238418579
                        ]
                    }
                },
                "30000": {
                    "train": {
                        "score": 0.88072038336335,
                        "pretrain_loss": 0.617793083190918,
                        "features_accuracy": [
                            0.5331249833106995,
                            0.7646874785423279,
                            0.5406249761581421,
                            0.5692187547683716,
                            0.6248437166213989,
                            0.7515624761581421,
                            0.522656261920929,
                            0.7885937094688416,
                            0.7696874737739563,
                            0.5284374952316284,
                            0.7153124809265137
                        ]
                    },
                    "val": {
                        "score": 0.8737612081170365,
                        "pretrain_loss": 0.6148680448532104,
                        "features_accuracy": [
                            0.5249999761581421,
                            0.768750011920929,
                            0.5143749713897705,
                            0.5799999833106995,
                            0.6106249690055847,
                            0.7593749761581421,
                            0.5293750166893005,
                            0.8006249666213989,
                            0.7718749642372131,
                            0.5212500095367432,
                            0.7168749570846558
                        ]
                    },
                    "test": {
                        "score": 0.8593200288115542,
                        "pretrain_loss": 0.6152337193489075,
                        "features_accuracy": [
                            0.5295000076293945,
                            0.768500030040741,
                            0.5260000228881836,
                            0.5530000329017639,
                            0.612500011920929,
                            0.7545000314712524,
                            0.5275000333786011,
                            0.7980000376701355,
                            0.7690000534057617,
                            0.5065000057220459,
                            0.7250000238418579
                        ]
                    }
                },
                "40000": {
                    "train": {
                        "score": 0.8842581334090975,
                        "pretrain_loss": 0.6174449324607849,
                        "features_accuracy": [
                            0.5332812666893005,
                            0.7659375071525574,
                            0.5420312285423279,
                            0.5731250047683716,
                            0.609375,
                            0.746874988079071,
                            0.5168749690055847,
                            0.8035937547683716,
                            0.7595312595367432,
                            0.5367187261581421,
                            0.7103124856948853
                        ]
                    },
                    "val": {
                        "score": 0.8739225279540791,
                        "pretrain_loss": 0.615121603012085,
                        "features_accuracy": [
                            0.5249999761581421,
                            0.768750011920929,
                            0.5199999809265137,
                            0.5799999833106995,
                            0.609375,
                            0.7587499618530273,
                            0.5293750166893005,
                            0.8006249666213989,
                            0.7718749642372131,
                            0.5212500095367432,
                            0.7168749570846558
                        ]
                    },
                    "test": {
                        "score": 0.8606449284415386,
                        "pretrain_loss": 0.6153023838996887,
                        "features_accuracy": [
                            0.5295000076293945,
                            0.768500030040741,
                            0.5235000252723694,
                            0.5530000329017639,
                            0.612000048160553,
                            0.7545000314712524,
                            0.5275000333786011,
                            0.7980000376701355,
                            0.7690000534057617,
                            0.5065000057220459,
                            0.7245000600814819
                        ]
                    }
                },
                "50000": {
                    "train": {
                        "score": 0.8862557455143454,
                        "pretrain_loss": 0.6190499067306519,
                        "features_accuracy": [
                            0.5292187333106995,
                            0.7589062452316284,
                            0.53515625,
                            0.571093738079071,
                            0.6065624952316284,
                            0.7406249642372131,
                            0.5181249976158142,
                            0.7965624928474426,
                            0.7637499570846558,
                            0.518750011920929,
                            0.7146874666213989
                        ]
                    },
                    "val": {
                        "score": 0.8729136770328707,
                        "pretrain_loss": 0.6145332455635071,
                        "features_accuracy": [
                            0.5249999761581421,
                            0.768750011920929,
                            0.5206249952316284,
                            0.5799999833106995,
                            0.6137499809265137,
                            0.7606250047683716,
                            0.5293750166893005,
                            0.8006249666213989,
                            0.7718749642372131,
                            0.5212500095367432,
                            0.7174999713897705
                        ]
                    },
                    "test": {
                        "score": 0.8616675226844717,
                        "pretrain_loss": 0.6151549220085144,
                        "features_accuracy": [
                            0.5295000076293945,
                            0.768500030040741,
                            0.530500054359436,
                            0.5530000329017639,
                            0.6135000586509705,
                            0.7540000081062317,
                            0.5275000333786011,
                            0.7980000376701355,
                            0.7690000534057617,
                            0.5065000057220459,
                            0.7225000262260437
                        ]
                    }
                },
                "60000": {
                    "train": {
                        "score": 0.8965771301441766,
                        "pretrain_loss": 0.5825681686401367,
                        "features_accuracy": [
                            0.5299999713897705,
                            0.7548437118530273,
                            0.550000011920929,
                            0.5684375166893005,
                            0.6070312261581421,
                            0.74609375,
                            0.7473437190055847,
                            0.8042187094688416,
                            0.7612499594688416,
                            0.7475000023841858,
                            0.7126562595367432
                        ]
                    },
                    "val": {
                        "score": 0.8752251254442314,
                        "pretrain_loss": 0.5796862840652466,
                        "features_accuracy": [
                            0.5249999761581421,
                            0.768750011920929,
                            0.5143749713897705,
                            0.5799999833106995,
                            0.6112499833106995,
                            0.7593749761581421,
                            0.7418749928474426,
                            0.8006249666213989,
                            0.7718749642372131,
                            0.7425000071525574,
                            0.7181249856948853
                        ]
                    },
                    "test": {
                        "score": 0.8636309653258806,
                        "pretrain_loss": 0.5785162448883057,
                        "features_accuracy": [
                            0.5295000076293945,
                            0.768500030040741,
                            0.5250000357627869,
                            0.5530000329017639,
                            0.6130000352859497,
                            0.7560000419616699,
                            0.7380000352859497,
                            0.7980000376701355,
                            0.7690000534057617,
                            0.7540000081062317,
                            0.7240000367164612
                        ]
                    }
                },
                "70000": {
                    "train": {
                        "score": 0.8873782877945893,
                        "pretrain_loss": 0.577880322933197,
                        "features_accuracy": [
                            0.5289062261581421,
                            0.7739062309265137,
                            0.5464062094688416,
                            0.5604687333106995,
                            0.624218761920929,
                            0.74609375,
                            0.7435937523841858,
                            0.8025000095367432,
                            0.7690624594688416,
                            0.7564062476158142,
                            0.6948437094688416
                        ]
                    },
                    "val": {
                        "score": 0.8746689331702476,
                        "pretrain_loss": 0.57879239320755,
                        "features_accuracy": [
                            0.5249999761581421,
                            0.768750011920929,
                            0.5212500095367432,
                            0.5799999833106995,
                            0.6068750023841858,
                            0.7593749761581421,
                            0.7412499785423279,
                            0.8006249666213989,
                            0.7718749642372131,
                            0.7431249618530273,
                            0.7143749594688416
                        ]
                    },
                    "test": {
                        "score": 0.8601359448817076,
                        "pretrain_loss": 0.5782032608985901,
                        "features_accuracy": [
                            0.5295000076293945,
                            0.768500030040741,
                            0.5265000462532043,
                            0.5530000329017639,
                            0.609000027179718,
                            0.7595000267028809,
                            0.7390000224113464,
                            0.7980000376701355,
                            0.7690000534057617,
                            0.7550000548362732,
                            0.7245000600814819
                        ]
                    }
                },
                "80000": {
                    "train": {
                        "score": 0.8965641884408317,
                        "pretrain_loss": 0.5780269503593445,
                        "features_accuracy": [
                            0.5318750143051147,
                            0.766406238079071,
                            0.5407812595367432,
                            0.5748437643051147,
                            0.6139062643051147,
                            0.7493749856948853,
                            0.7407812476158142,
                            0.8021875023841858,
                            0.7642187476158142,
                            0.7564062476158142,
                            0.7201562523841858
                        ]
                    },
                    "val": {
                        "score": 0.875593512534792,
                        "pretrain_loss": 0.5781488418579102,
                        "features_accuracy": [
                            0.5249999761581421,
                            0.768750011920929,
                            0.5212500095367432,
                            0.5799999833106995,
                            0.6100000143051147,
                            0.7606250047683716,
                            0.7387499809265137,
                            0.8006249666213989,
                            0.7718749642372131,
                            0.7456249594688416,
                            0.7162500023841858
                        ]
                    },
                    "test": {
                        "score": 0.8661404085132898,
                        "pretrain_loss": 0.5780596733093262,
                        "features_accuracy": [
                            0.5295000076293945,
                            0.768500030040741,
                            0.5245000123977661,
                            0.5530000329017639,
                            0.6100000143051147,
                            0.7545000314712524,
                            0.7385000586509705,
                            0.7980000376701355,
                            0.7690000534057617,
                            0.7555000185966492,
                            0.7250000238418579
                        ]
                    }
                },
                "90000": {
                    "train": {
                        "score": 0.895872108281727,
                        "pretrain_loss": 0.5791159868240356,
                        "features_accuracy": [
                            0.5160937309265137,
                            0.7590624690055847,
                            0.5545312166213989,
                            0.5648437142372131,
                            0.6187499761581421,
                            0.7465624809265137,
                            0.7635937333106995,
                            0.8025000095367432,
                            0.7596874833106995,
                            0.742968738079071,
                            0.7067187428474426
                        ]
                    },
                    "val": {
                        "score": 0.8775606514432106,
                        "pretrain_loss": 0.5781366229057312,
                        "features_accuracy": [
                            0.5249999761581421,
                            0.768750011920929,
                            0.5218749642372131,
                            0.5799999833106995,
                            0.6049999594688416,
                            0.7574999928474426,
                            0.7393749952316284,
                            0.8006249666213989,
                            0.7718749642372131,
                            0.7462499737739563,
                            0.715624988079071
                        ]
                    },
                    "test": {
                        "score": 0.8656854080582895,
                        "pretrain_loss": 0.5788553357124329,
                        "features_accuracy": [
                            0.5295000076293945,
                            0.768500030040741,
                            0.5290000438690186,
                            0.5530000329017639,
                            0.6045000553131104,
                            0.7570000290870667,
                            0.7390000224113464,
                            0.7980000376701355,
                            0.7690000534057617,
                            0.7540000081062317,
                            0.7245000600814819
                        ]
                    }
                },
                "100000": {
                    "train": {
                        "score": 0.8951487272587186,
                        "pretrain_loss": 0.5796738266944885,
                        "features_accuracy": [
                            0.5295312404632568,
                            0.7657812237739563,
                            0.5368750095367432,
                            0.5712499618530273,
                            0.6095312237739563,
                            0.7485937476158142,
                            0.7392187118530273,
                            0.7989062070846558,
                            0.7612499594688416,
                            0.7432812452316284,
                            0.7145312428474426
                        ]
                    },
                    "val": {
                        "score": 0.8756272211574578,
                        "pretrain_loss": 0.5770495533943176,
                        "features_accuracy": [
                            0.5249999761581421,
                            0.768750011920929,
                            0.5212500095367432,
                            0.5799999833106995,
                            0.6049999594688416,
                            0.7593749761581421,
                            0.7393749952316284,
                            0.8006249666213989,
                            0.7718749642372131,
                            0.7475000023841858,
                            0.715624988079071
                        ]
                    },
                    "test": {
                        "score": 0.8653491704339162,
                        "pretrain_loss": 0.5776398181915283,
                        "features_accuracy": [
                            0.5295000076293945,
                            0.768500030040741,
                            0.5270000100135803,
                            0.5530000329017639,
                            0.6100000143051147,
                            0.7550000548362732,
                            0.7410000562667847,
                            0.7980000376701355,
                            0.768500030040741,
                            0.7540000081062317,
                            0.7240000367164612
                        ]
                    }
                }
            },
            "train": {
                "score": 0.895872108281727
            },
            "val": {
                "score": 0.8775606514432106
            },
            "test": {
                "score": 0.8656854080582895
            }
        },
        "best_iteration": 90000,
        "time": "0:11:33",
        "trial_id": 51,
        "tuning_time": "5:22:12"
    },
    "time": "11:30:36"
}
