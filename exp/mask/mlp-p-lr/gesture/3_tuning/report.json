{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/tune.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 0,
        "program": "bin/pretrain_mask.py",
        "base_config": {
            "seed": 0,
            "data": {
                "T_cache": true,
                "path": "data/gesture",
                "T": {
                    "normalization": "quantile"
                }
            },
            "model": {
                "kind": "mlp",
                "num_embedding_arch": [
                    "positional",
                    "linear",
                    "relu"
                ],
                "positional_encoding": {
                    "trainable": true,
                    "initialization": "normal"
                }
            },
            "training": {
                "batch_size": 128,
                "patience": 16
            },
            "pretrain": {
                "corrupt_strategy": "resample",
                "patience": 2,
                "d_hidden_head": 512,
                "replace_strategy": "shuffle",
                "use_target": false
            }
        },
        "space": {
            "model": {
                "d_num_embedding": [
                    "int",
                    1,
                    128
                ],
                "config": {
                    "d_layers": [
                        "$fixed_mlp_d_layers",
                        1,
                        8,
                        512
                    ],
                    "dropout": [
                        "?uniform",
                        0.0,
                        0.0,
                        0.5
                    ]
                },
                "positional_encoding": {
                    "n": [
                        "int",
                        1,
                        128
                    ],
                    "sigma": [
                        "loguniform",
                        0.01,
                        100.0
                    ]
                }
            },
            "pretrain": {
                "corrupt_probability": [
                    "uniform",
                    0.2,
                    0.8
                ]
            },
            "training": {
                "lr": [
                    "loguniform",
                    5e-05,
                    0.005
                ],
                "weight_decay": [
                    "?loguniform",
                    0.0,
                    1e-06,
                    0.001
                ]
            }
        },
        "n_trials": 100,
        "timeout": null,
        "sampler": {
            "seed": 0
        }
    },
    "best": {
        "program": "bin/pretrain_mask.py",
        "environment": {
            "CUDA_VISIBLE_DEVICES": "0",
            "gpus": {
                "driver": "450.119.04",
                "devices": [
                    {
                        "name": "A100-SXM-80GB",
                        "memory_total": 85199093760,
                        "memory_free": 85195948032,
                        "memory_used": 3145728,
                        "utilization": 0
                    }
                ]
            },
            "torch.version.cuda": "11.1",
            "torch.backends.cudnn.version()": 8005,
            "torch.cuda.nccl.version()": [
                2,
                10,
                3
            ]
        },
        "config": {
            "seed": 0,
            "data": {
                "path": "data/gesture",
                "T": {
                    "seed": 0,
                    "normalization": "quantile",
                    "num_nan_policy": null,
                    "cat_nan_policy": null,
                    "cat_min_frequency": null,
                    "cat_encoding": null,
                    "y_policy": "default"
                },
                "T_cache": true
            },
            "model": {
                "kind": "mlp",
                "config": {
                    "d_layers": [
                        512,
                        512
                    ],
                    "dropout": 0.0
                },
                "default": true,
                "checkpoint": null,
                "num_embedding_arch": [
                    "positional",
                    "linear",
                    "relu"
                ],
                "d_num_embedding": 9,
                "positional_encoding": {
                    "n": 83,
                    "sigma": 0.9993430796255902,
                    "trainable": true,
                    "initialization": "normal"
                },
                "d_cat_embedding": null
            },
            "training": {
                "batch_size": 128,
                "lr": 0.0005841758208269677,
                "weight_decay": 8.458119286332084e-05,
                "optimizer": "AdamW",
                "patience": 16,
                "n_epochs": Infinity,
                "eval_batch_size": 8192
            },
            "pretrain": {
                "corrupt_probability": 0.3044260276580256,
                "corrupt_strategy": "resample",
                "d_hidden_head": 512,
                "lr": 0.0005841758208269677,
                "weight_decay": 8.458119286332084e-05,
                "patience": 2,
                "n_iterations": 100000,
                "finetune_every": 10000,
                "replace_strategy": "shuffle",
                "n_neighbors": 20,
                "use_target": false,
                "target_injection_type": "post"
            },
            "bins": null
        },
        "epoch_size": 50,
        "n_parameters": 740448,
        "metrics": {
            "iteration_scores": {
                "10000": {
                    "train": {
                        "score": 0.9946185501741057,
                        "pretrain_loss": 0.5066590905189514,
                        "features_accuracy": [
                            0.8057929873466492,
                            0.8173472881317139,
                            0.7850585579872131,
                            0.8125989437103271,
                            0.8357074856758118,
                            0.7812598943710327,
                            0.7894903421401978,
                            0.8181386590003967,
                            0.7845837473869324,
                            0.8088002800941467,
                            0.8311174511909485,
                            0.7867996096611023,
                            0.6983222365379333,
                            0.6992719173431396,
                            0.6894586682319641,
                            0.6940487623214722,
                            0.6910414695739746,
                            0.6972143054008484,
                            0.693415641784668,
                            0.6942070126533508,
                            0.688034176826477,
                            0.6881924867630005,
                            0.692307710647583,
                            0.7033871412277222,
                            0.8605571389198303,
                            0.8646723628044128,
                            0.8518518805503845,
                            0.8700538277626038,
                            0.7081354856491089,
                            0.7693890333175659,
                            0.7524533271789551,
                            0.6937322020530701
                        ]
                    },
                    "val": {
                        "score": 0.7215189873417721,
                        "pretrain_loss": 0.50559401512146,
                        "features_accuracy": [
                            0.791772186756134,
                            0.8227848410606384,
                            0.7936708927154541,
                            0.8037974834442139,
                            0.8398734331130981,
                            0.7784810066223145,
                            0.7835443019866943,
                            0.8398734331130981,
                            0.7860759496688843,
                            0.8202531933784485,
                            0.8405063152313232,
                            0.7740506529808044,
                            0.6867088675498962,
                            0.7126582264900208,
                            0.7101265788078308,
                            0.6898733973503113,
                            0.6898733973503113,
                            0.696835458278656,
                            0.6987341642379761,
                            0.6987341642379761,
                            0.698101282119751,
                            0.6873417496681213,
                            0.6911392211914062,
                            0.6765822768211365,
                            0.8689873218536377,
                            0.8753164410591125,
                            0.8487342000007629,
                            0.8721519112586975,
                            0.6873417496681213,
                            0.7537974715232849,
                            0.7664557099342346,
                            0.699999988079071
                        ]
                    },
                    "test": {
                        "score": 0.6840506329113925,
                        "pretrain_loss": 0.5100399851799011,
                        "features_accuracy": [
                            0.799493670463562,
                            0.8324050903320312,
                            0.7858228087425232,
                            0.8081012964248657,
                            0.8329113721847534,
                            0.7792404890060425,
                            0.8030380010604858,
                            0.8070886135101318,
                            0.7827848196029663,
                            0.8010126352310181,
                            0.8440506458282471,
                            0.7584810256958008,
                            0.6941772103309631,
                            0.697721540927887,
                            0.6789873242378235,
                            0.6911392211914062,
                            0.6906329393386841,
                            0.6845569610595703,
                            0.6810126900672913,
                            0.6946835517883301,
                            0.6865822672843933,
                            0.6921519041061401,
                            0.7174683809280396,
                            0.695189893245697,
                            0.8622784614562988,
                            0.8536708950996399,
                            0.8602531552314758,
                            0.8617721796035767,
                            0.693164587020874,
                            0.7559493780136108,
                            0.7372152209281921,
                            0.695696234703064
                        ]
                    }
                },
                "20000": {
                    "train": {
                        "score": 0.9914529914529915,
                        "pretrain_loss": 0.48854804039001465,
                        "features_accuracy": [
                            0.8062677979469299,
                            0.8358657956123352,
                            0.7943969368934631,
                            0.8217790722846985,
                            0.8452041745185852,
                            0.8004115223884583,
                            0.8057929873466492,
                            0.8252611756324768,
                            0.7977207899093628,
                            0.8124406337738037,
                            0.8366571664810181,
                            0.7924976348876953,
                            0.7046533823013306,
                            0.6992719173431396,
                            0.6932573914527893,
                            0.7467553019523621,
                            0.704178512096405,
                            0.6975308656692505,
                            0.6942070126533508,
                            0.6951566934585571,
                            0.6915162801742554,
                            0.6942070126533508,
                            0.693415641784668,
                            0.6961063742637634,
                            0.8735359311103821,
                            0.8786008358001709,
                            0.8626147508621216,
                            0.8752769827842712,
                            0.7747704982757568,
                            0.7874327301979065,
                            0.7704970240592957,
                            0.6986387968063354
                        ]
                    },
                    "val": {
                        "score": 0.7158227848101266,
                        "pretrain_loss": 0.4915412962436676,
                        "features_accuracy": [
                            0.7981012463569641,
                            0.8341771960258484,
                            0.8037974834442139,
                            0.8177215456962585,
                            0.847468376159668,
                            0.7924050688743591,
                            0.8101266026496887,
                            0.8481012582778931,
                            0.7936708927154541,
                            0.8183544278144836,
                            0.8392404913902283,
                            0.7708860635757446,
                            0.6867088675498962,
                            0.7126582264900208,
                            0.7101265788078308,
                            0.7234176993370056,
                            0.6898733973503113,
                            0.696835458278656,
                            0.6987341642379761,
                            0.6987341642379761,
                            0.698101282119751,
                            0.6873417496681213,
                            0.6911392211914062,
                            0.6765822768211365,
                            0.8683544397354126,
                            0.8816455602645874,
                            0.8658227920532227,
                            0.8784810304641724,
                            0.7550632953643799,
                            0.7841772437095642,
                            0.7848101258277893,
                            0.699999988079071
                        ]
                    },
                    "test": {
                        "score": 0.6825316455696202,
                        "pretrain_loss": 0.4945182204246521,
                        "features_accuracy": [
                            0.8070886135101318,
                            0.8389873504638672,
                            0.793417751789093,
                            0.8268354535102844,
                            0.8364557027816772,
                            0.7843037843704224,
                            0.8111392259597778,
                            0.8197468519210815,
                            0.7832911610603333,
                            0.8111392259597778,
                            0.8556962013244629,
                            0.7681012749671936,
                            0.6941772103309631,
                            0.697721540927887,
                            0.6789873242378235,
                            0.7579746842384338,
                            0.6906329393386841,
                            0.6845569610595703,
                            0.6810126900672913,
                            0.6946835517883301,
                            0.6865822672843933,
                            0.6921519041061401,
                            0.7174683809280396,
                            0.695189893245697,
                            0.8622784614562988,
                            0.8617721796035767,
                            0.8683544397354126,
                            0.8734177350997925,
                            0.7569620013237,
                            0.7756962180137634,
                            0.7686076164245605,
                            0.695696234703064
                        ]
                    }
                },
                "30000": {
                    "train": {
                        "score": 0.9925609370053815,
                        "pretrain_loss": 0.4837813377380371,
                        "features_accuracy": [
                            0.8182969093322754,
                            0.8366571664810181,
                            0.8080088496208191,
                            0.8306426405906677,
                            0.8439379334449768,
                            0.7924976348876953,
                            0.817663848400116,
                            0.8320671319961548,
                            0.797245979309082,
                            0.8195631504058838,
                            0.8412472605705261,
                            0.7891737818717957,
                            0.6984805464744568,
                            0.7014878392219543,
                            0.6926242709159851,
                            0.7681228518486023,
                            0.6916745901107788,
                            0.6949984431266785,
                            0.6935738921165466,
                            0.6894586682319641,
                            0.7070275545120239,
                            0.6872428059577942,
                            0.6980056762695312,
                            0.6889838576316833,
                            0.8697372674942017,
                            0.8779677152633667,
                            0.8776511549949646,
                            0.8781259655952454,
                            0.7777777910232544,
                            0.7940804362297058,
                            0.7728711366653442,
                            0.6940487623214722
                        ]
                    },
                    "val": {
                        "score": 0.7126582278481013,
                        "pretrain_loss": 0.4870033860206604,
                        "features_accuracy": [
                            0.7955695986747742,
                            0.844936728477478,
                            0.8050633072853088,
                            0.8183544278144836,
                            0.8556962013244629,
                            0.7778481245040894,
                            0.8037974834442139,
                            0.8468354344367981,
                            0.800000011920929,
                            0.8164557218551636,
                            0.8556962013244629,
                            0.7753164768218994,
                            0.6867088675498962,
                            0.7126582264900208,
                            0.7101265788078308,
                            0.7398734092712402,
                            0.6898733973503113,
                            0.696835458278656,
                            0.6987341642379761,
                            0.6987341642379761,
                            0.698101282119751,
                            0.6873417496681213,
                            0.6911392211914062,
                            0.6765822768211365,
                            0.8727847933769226,
                            0.8822785019874573,
                            0.8607594966888428,
                            0.8860759735107422,
                            0.7563291192054749,
                            0.7892405390739441,
                            0.791772186756134,
                            0.699999988079071
                        ]
                    },
                    "test": {
                        "score": 0.6926582278481013,
                        "pretrain_loss": 0.4923281669616699,
                        "features_accuracy": [
                            0.8151898980140686,
                            0.8400000333786011,
                            0.7944303750991821,
                            0.8253164887428284,
                            0.8400000333786011,
                            0.7822784781455994,
                            0.8126582503318787,
                            0.8156961798667908,
                            0.7812658548355103,
                            0.7984810471534729,
                            0.8597468137741089,
                            0.7686076164245605,
                            0.6941772103309631,
                            0.697721540927887,
                            0.6789873242378235,
                            0.7645569443702698,
                            0.6906329393386841,
                            0.6845569610595703,
                            0.6810126900672913,
                            0.6946835517883301,
                            0.6865822672843933,
                            0.6921519041061401,
                            0.7174683809280396,
                            0.695189893245697,
                            0.8663291335105896,
                            0.8698734045028687,
                            0.8759493827819824,
                            0.8663291335105896,
                            0.7544304132461548,
                            0.7746835350990295,
                            0.7762025594711304,
                            0.695696234703064
                        ]
                    }
                },
                "40000": {
                    "train": {
                        "score": 0.99335232668566,
                        "pretrain_loss": 0.48002684116363525,
                        "features_accuracy": [
                            0.8114909529685974,
                            0.8456790447235107,
                            0.7951883673667908,
                            0.8182969093322754,
                            0.8461538553237915,
                            0.7917062640190125,
                            0.8163976073265076,
                            0.8390313386917114,
                            0.8061095476150513,
                            0.8249446153640747,
                            0.8439379334449768,
                            0.7969294190406799,
                            0.6973726153373718,
                            0.7200063467025757,
                            0.6881924867630005,
                            0.7733460068702698,
                            0.6894586682319641,
                            0.6980056762695312,
                            0.691199779510498,
                            0.6870844960212708,
                            0.6930990815162659,
                            0.6968977451324463,
                            0.691199779510498,
                            0.6981639862060547,
                            0.8730611205101013,
                            0.8819246888160706,
                            0.8762266635894775,
                            0.8752769827842712,
                            0.7774612307548523,
                            0.8054764270782471,
                            0.7809433341026306,
                            0.6930990815162659
                        ]
                    },
                    "val": {
                        "score": 0.7145569620253165,
                        "pretrain_loss": 0.48377689719200134,
                        "features_accuracy": [
                            0.8164557218551636,
                            0.8348101377487183,
                            0.7981012463569641,
                            0.8215190172195435,
                            0.850632905960083,
                            0.7829114198684692,
                            0.8164557218551636,
                            0.8430379629135132,
                            0.7968354225158691,
                            0.8272151947021484,
                            0.8537974953651428,
                            0.7778481245040894,
                            0.6867088675498962,
                            0.7246835231781006,
                            0.7101265788078308,
                            0.7234176993370056,
                            0.6898733973503113,
                            0.696835458278656,
                            0.6987341642379761,
                            0.6987341642379761,
                            0.698101282119751,
                            0.6873417496681213,
                            0.6911392211914062,
                            0.6765822768211365,
                            0.8721519112586975,
                            0.8848101496696472,
                            0.8677214980125427,
                            0.8854430317878723,
                            0.7537974715232849,
                            0.7930379509925842,
                            0.791772186756134,
                            0.699999988079071
                        ]
                    },
                    "test": {
                        "score": 0.6870886075949367,
                        "pretrain_loss": 0.488725483417511,
                        "features_accuracy": [
                            0.8187341690063477,
                            0.8410126566886902,
                            0.7903797626495361,
                            0.8217721581459045,
                            0.8475949168205261,
                            0.7777215242385864,
                            0.8151898980140686,
                            0.8182278275489807,
                            0.7843037843704224,
                            0.8141772150993347,
                            0.8541772365570068,
                            0.7645569443702698,
                            0.6941772103309631,
                            0.7169620394706726,
                            0.6789873242378235,
                            0.7589873671531677,
                            0.6906329393386841,
                            0.6845569610595703,
                            0.6810126900672913,
                            0.6946835517883301,
                            0.6865822672843933,
                            0.6921519041061401,
                            0.7174683809280396,
                            0.695189893245697,
                            0.8688607811927795,
                            0.8718987107276917,
                            0.8729113936424255,
                            0.8718987107276917,
                            0.7564557194709778,
                            0.7711392641067505,
                            0.7827848196029663,
                            0.695696234703064
                        ]
                    }
                }
            },
            "train": {
                "score": 0.9946185501741057
            },
            "val": {
                "score": 0.7215189873417721
            },
            "test": {
                "score": 0.6840506329113925
            }
        },
        "best_iteration": 10000,
        "time": "0:03:54",
        "trial_id": 75,
        "tuning_time": "10:32:04"
    },
    "time": "13:37:59"
}
