{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask___e7dfeb810e3e49648ac8c52e61841f9f.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 14,
        "data": {
            "path": "data/fb-comments",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512
                ],
                "dropout": 0.23403030193220953
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "positional",
                "linear",
                "relu"
            ],
            "d_num_embedding": 62,
            "positional_encoding": {
                "n": 27,
                "sigma": 0.256513004712354,
                "trainable": true,
                "initialization": "normal"
            },
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 512,
            "lr": 5.7167751108465785e-05,
            "weight_decay": 0.0,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.4622170577097292,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 5.7167751108465785e-05,
            "weight_decay": 0.0,
            "patience": 2,
            "n_iterations": 100000,
            "finetune_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "target_injection_type": "post"
        },
        "bins": null
    },
    "epoch_size": 308,
    "n_parameters": 2089853,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -3.7582722110378985,
                    "pretrain_loss": 0.33693191409111023,
                    "features_accuracy": [
                        0.702711284160614,
                        0.7308834195137024,
                        0.8521803021430969,
                        0.8729938268661499,
                        0.884145975112915,
                        0.8790900707244873,
                        0.8556820154190063,
                        0.8810185790061951,
                        0.8795405030250549,
                        0.8805491328239441,
                        0.9947221279144287,
                        0.7381342053413391,
                        0.8587967753410339,
                        0.8778277039527893,
                        0.8596975803375244,
                        0.8758484721183777,
                        0.8470736742019653,
                        0.8528463840484619,
                        0.7208731770515442,
                        0.8916124701499939,
                        0.8813928365707397,
                        0.78708815574646,
                        0.7545769810676575,
                        0.8037465810775757,
                        0.7874751091003418,
                        0.7749210596084595,
                        0.6059516072273254,
                        0.5461246967315674,
                        0.6700922250747681,
                        0.9858600497245789,
                        0.9146652817726135,
                        0.9947665333747864,
                        0.9025743007659912,
                        0.8980512619018555,
                        0.8971758484840393,
                        0.9000558257102966,
                        0.8985587358474731,
                        0.9062789678573608,
                        0.9049341082572937,
                        0.9070972800254822,
                        0.9054352641105652,
                        0.898146390914917,
                        0.856126070022583,
                        0.8948286771774292,
                        0.8987871408462524,
                        0.9008170962333679,
                        0.886677086353302,
                        0.8600401282310486,
                        0.8779546022415161,
                        0.9976338148117065,
                        0.5691140294075012
                    ]
                },
                "val": {
                    "score": -5.306802536159314,
                    "pretrain_loss": 0.33783501386642456,
                    "features_accuracy": [
                        0.7055065035820007,
                        0.7337998151779175,
                        0.8536659479141235,
                        0.873795747756958,
                        0.882314145565033,
                        0.8782577514648438,
                        0.8547307252883911,
                        0.8796774744987488,
                        0.8808944225311279,
                        0.8787140846252441,
                        0.9943210482597351,
                        0.7389717102050781,
                        0.8580772280693054,
                        0.8791197538375854,
                        0.8601561188697815,
                        0.8734408020973206,
                        0.8415474891662598,
                        0.852651834487915,
                        0.7185376286506653,
                        0.8889057636260986,
                        0.8819084763526917,
                        0.783541202545166,
                        0.7522563338279724,
                        0.8041273355484009,
                        0.7889159321784973,
                        0.7739579677581787,
                        0.602981448173523,
                        0.550096333026886,
                        0.6670215725898743,
                        0.9868674278259277,
                        0.9156779050827026,
                        0.9944731593132019,
                        0.9032552242279053,
                        0.9012777209281921,
                        0.8969678282737732,
                        0.8981340527534485,
                        0.9029510021209717,
                        0.9050298929214478,
                        0.9067538380622864,
                        0.9032552242279053,
                        0.9053848385810852,
                        0.897880494594574,
                        0.8533110022544861,
                        0.8938241600990295,
                        0.9022918343544006,
                        0.9020383358001709,
                        0.8839367032051086,
                        0.8612209558486938,
                        0.8789676427841187,
                        0.9971604943275452,
                        0.5703275203704834
                    ]
                },
                "test": {
                    "score": -5.579870707874333,
                    "pretrain_loss": 0.337887167930603,
                    "features_accuracy": [
                        0.7051724195480347,
                        0.7253549695014954,
                        0.8517241477966309,
                        0.8732251524925232,
                        0.8812880516052246,
                        0.879969596862793,
                        0.8556795120239258,
                        0.8810344934463501,
                        0.8786511421203613,
                        0.8839756846427917,
                        0.9948782920837402,
                        0.7300710082054138,
                        0.8604969382286072,
                        0.8798174262046814,
                        0.8588235378265381,
                        0.8742900490760803,
                        0.8466024398803711,
                        0.8528397679328918,
                        0.7120182514190674,
                        0.8919878602027893,
                        0.8837728500366211,
                        0.7893002033233643,
                        0.7539553642272949,
                        0.8064908981323242,
                        0.7900101542472839,
                        0.7745943069458008,
                        0.60780930519104,
                        0.5465010404586792,
                        0.6697261929512024,
                        0.9870182871818542,
                        0.9140466451644897,
                        0.9952839612960815,
                        0.9053245186805725,
                        0.8937119841575623,
                        0.8943712115287781,
                        0.897210955619812,
                        0.897819459438324,
                        0.9094827771186829,
                        0.9034990072250366,
                        0.906085193157196,
                        0.9066430330276489,
                        0.8979716300964355,
                        0.8551217317581177,
                        0.8926977515220642,
                        0.8985801339149475,
                        0.8969573974609375,
                        0.8878803253173828,
                        0.8612068891525269,
                        0.876724123954773,
                        0.9983265995979309,
                        0.566734254360199
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -4.094355740926261,
                    "pretrain_loss": 0.31790995597839355,
                    "features_accuracy": [
                        0.7218374013900757,
                        0.7481001019477844,
                        0.8713889122009277,
                        0.8898932933807373,
                        0.8984699249267578,
                        0.8917329907417297,
                        0.8778340220451355,
                        0.8968967199325562,
                        0.896617591381073,
                        0.8987300395965576,
                        0.9961113929748535,
                        0.7524962425231934,
                        0.8785318732261658,
                        0.8965224027633667,
                        0.8795912265777588,
                        0.897416889667511,
                        0.8630406260490417,
                        0.8661426901817322,
                        0.7404369711875916,
                        0.9058603048324585,
                        0.9038302898406982,
                        0.7990586161613464,
                        0.7656402587890625,
                        0.8136807084083557,
                        0.7998325228691101,
                        0.7927974462509155,
                        0.6136274337768555,
                        0.5366536378860474,
                        0.6737779378890991,
                        0.9866402745246887,
                        0.9147413969039917,
                        0.9961494207382202,
                        0.9015148878097534,
                        0.8981273770332336,
                        0.8944988250732422,
                        0.9016227126121521,
                        0.9002842307090759,
                        0.905619204044342,
                        0.9047881960868835,
                        0.9069323539733887,
                        0.9064058065414429,
                        0.8997830748558044,
                        0.8788807392120361,
                        0.8959261178970337,
                        0.9006457924842834,
                        0.9027201533317566,
                        0.8977784514427185,
                        0.8777706027030945,
                        0.8979560732841492,
                        0.9977797269821167,
                        0.579980731010437
                    ]
                },
                "val": {
                    "score": -5.370438556545346,
                    "pretrain_loss": 0.3193355202674866,
                    "features_accuracy": [
                        0.7249771356582642,
                        0.7492647767066956,
                        0.873035192489624,
                        0.890731155872345,
                        0.8952438831329346,
                        0.8912888765335083,
                        0.8769901394844055,
                        0.8962072730064392,
                        0.8964100480079651,
                        0.8959537148475647,
                        0.9955379366874695,
                        0.7538788914680481,
                        0.8764830827713013,
                        0.8947875499725342,
                        0.8782070279121399,
                        0.8962579369544983,
                        0.8595476746559143,
                        0.8670520186424255,
                        0.7352195382118225,
                        0.9031538367271423,
                        0.9026974439620972,
                        0.7962173819541931,
                        0.7624480128288269,
                        0.8144204020500183,
                        0.7997667193412781,
                        0.7912483215332031,
                        0.6082547307014465,
                        0.5363553166389465,
                        0.6701145768165588,
                        0.9873237609863281,
                        0.916134238243103,
                        0.9957407712936401,
                        0.9029510021209717,
                        0.9009734988212585,
                        0.8954973816871643,
                        0.89995938539505,
                        0.9040157794952393,
                        0.9062467813491821,
                        0.9037622809410095,
                        0.9031538367271423,
                        0.906956672668457,
                        0.8979819416999817,
                        0.8739478588104248,
                        0.8962072730064392,
                        0.9021904468536377,
                        0.9037115573883057,
                        0.8960551619529724,
                        0.8791197538375854,
                        0.9000101089477539,
                        0.9978703856468201,
                        0.5790994763374329
                    ]
                },
                "test": {
                    "score": -5.580569499960749,
                    "pretrain_loss": 0.3193346858024597,
                    "features_accuracy": [
                        0.7200811505317688,
                        0.7440162301063538,
                        0.872261643409729,
                        0.8920385241508484,
                        0.8940162062644958,
                        0.8931034803390503,
                        0.8755578398704529,
                        0.8945233225822449,
                        0.8947261571884155,
                        0.9005070924758911,
                        0.9962474703788757,
                        0.746146023273468,
                        0.8806794881820679,
                        0.8966531753540039,
                        0.8771805167198181,
                        0.8940669298171997,
                        0.8654665350914001,
                        0.8677992224693298,
                        0.7297160029411316,
                        0.9047160148620605,
                        0.9030426144599915,
                        0.8010141849517822,
                        0.7666328549385071,
                        0.8163793087005615,
                        0.8006592392921448,
                        0.7935091257095337,
                        0.6145537495613098,
                        0.536156177520752,
                        0.6761663556098938,
                        0.9871196746826172,
                        0.912778913974762,
                        0.996653139591217,
                        0.9031947255134583,
                        0.8937627077102661,
                        0.8931541442871094,
                        0.8980730175971985,
                        0.8982758522033691,
                        0.9098884463310242,
                        0.9029918909072876,
                        0.9060344696044922,
                        0.908823549747467,
                        0.898833692073822,
                        0.8781440258026123,
                        0.8929005861282349,
                        0.8986815214157104,
                        0.8989858031272888,
                        0.9005070924758911,
                        0.878853976726532,
                        0.8943204879760742,
                        0.9983265995979309,
                        0.5720081329345703
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -4.19111231363107,
                    "pretrain_loss": 0.30846914649009705,
                    "features_accuracy": [
                        0.735057532787323,
                        0.7547101974487305,
                        0.886074423789978,
                        0.8974295854568481,
                        0.9037224650382996,
                        0.9008488059043884,
                        0.8846407532691956,
                        0.9027963280677795,
                        0.9041982293128967,
                        0.9030627608299255,
                        0.9966378808021545,
                        0.7623415589332581,
                        0.8891130685806274,
                        0.9049023985862732,
                        0.8873812556266785,
                        0.9062028527259827,
                        0.8716299533843994,
                        0.8803080916404724,
                        0.7488232851028442,
                        0.9136629700660706,
                        0.9090384244918823,
                        0.8065758347511292,
                        0.7690341472625732,
                        0.8202146887779236,
                        0.8099823594093323,
                        0.7980118989944458,
                        0.6346883773803711,
                        0.5440058708190918,
                        0.6784976124763489,
                        0.9869384765625,
                        0.9158451557159424,
                        0.9964856505393982,
                        0.9019652605056763,
                        0.8999670147895813,
                        0.8940674662590027,
                        0.8988759517669678,
                        0.9005950689315796,
                        0.9066596031188965,
                        0.9042426347732544,
                        0.9074398279190063,
                        0.9076428413391113,
                        0.9008615016937256,
                        0.8833022713661194,
                        0.8953425288200378,
                        0.9026060104370117,
                        0.9039064645767212,
                        0.9049468040466309,
                        0.8855035305023193,
                        0.9059744477272034,
                        0.9981603622436523,
                        0.6003755331039429
                    ]
                },
                "val": {
                    "score": -5.357765934608288,
                    "pretrain_loss": 0.30920109152793884,
                    "features_accuracy": [
                        0.7335969805717468,
                        0.7555014491081238,
                        0.8875367641448975,
                        0.8973227739334106,
                        0.9008213877677917,
                        0.8983368873596191,
                        0.8860663175582886,
                        0.9036608338356018,
                        0.9035594463348389,
                        0.9031538367271423,
                        0.9961463809013367,
                        0.7630057334899902,
                        0.8879930973052979,
                        0.904167890548706,
                        0.8850014805793762,
                        0.9070073962211609,
                        0.8695365190505981,
                        0.8791197538375854,
                        0.74835205078125,
                        0.9102017879486084,
                        0.910506010055542,
                        0.8072203397750854,
                        0.7681776285171509,
                        0.8204035758972168,
                        0.8103640675544739,
                        0.7977892756462097,
                        0.6300578117370605,
                        0.5506540536880493,
                        0.6740188598632812,
                        0.9876787066459656,
                        0.9157286286354065,
                        0.9960957169532776,
                        0.9033059477806091,
                        0.902748167514801,
                        0.8951931595802307,
                        0.8986411094665527,
                        0.904776394367218,
                        0.9054355025291443,
                        0.9042186141014099,
                        0.9027988910675049,
                        0.9070073962211609,
                        0.8987424969673157,
                        0.8813000321388245,
                        0.8966128826141357,
                        0.9040157794952393,
                        0.9044721126556396,
                        0.9038636684417725,
                        0.8868775963783264,
                        0.9073622822761536,
                        0.9980224967002869,
                        0.5986208319664001
                    ]
                },
                "test": {
                    "score": -5.615406320843754,
                    "pretrain_loss": 0.3093840479850769,
                    "features_accuracy": [
                        0.732758641242981,
                        0.7524340748786926,
                        0.8846855759620667,
                        0.898833692073822,
                        0.900050699710846,
                        0.9006592631340027,
                        0.8843813538551331,
                        0.9009634852409363,
                        0.9021298289299011,
                        0.9070993661880493,
                        0.9965517520904541,
                        0.7573529481887817,
                        0.8924949169158936,
                        0.9054259657859802,
                        0.8835699558258057,
                        0.9041582345962524,
                        0.8758620619773865,
                        0.8810344934463501,
                        0.7423428297042847,
                        0.913286030292511,
                        0.9102941155433655,
                        0.8117647171020508,
                        0.771095335483551,
                        0.823326587677002,
                        0.8120182752609253,
                        0.8002535700798035,
                        0.6290060877799988,
                        0.5468052625656128,
                        0.6806795001029968,
                        0.987778902053833,
                        0.9129817485809326,
                        0.9967545866966248,
                        0.9048681855201721,
                        0.8940669298171997,
                        0.8935091495513916,
                        0.8982251286506653,
                        0.900050699710846,
                        0.9104462265968323,
                        0.9033975601196289,
                        0.9060344696044922,
                        0.9086713790893555,
                        0.8987829685211182,
                        0.8872718214988708,
                        0.8940162062644958,
                        0.901673436164856,
                        0.8991379141807556,
                        0.9080628752708435,
                        0.8850913047790527,
                        0.9037525653839111,
                        0.9985294342041016,
                        0.5971602201461792
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -3.98575856276042,
                    "pretrain_loss": 0.29977431893348694,
                    "features_accuracy": [
                        0.7433677315711975,
                        0.76241135597229,
                        0.8920945525169373,
                        0.9032340049743652,
                        0.9089369773864746,
                        0.9041538238525391,
                        0.8913079500198364,
                        0.9072622060775757,
                        0.9087719917297363,
                        0.9095459580421448,
                        0.9965934753417969,
                        0.7745023369789124,
                        0.8967254161834717,
                        0.9096601009368896,
                        0.8918218016624451,
                        0.9120009541511536,
                        0.8809106945991516,
                        0.8867278099060059,
                        0.7590428590774536,
                        0.9169806838035583,
                        0.9147287011146545,
                        0.8211472034454346,
                        0.7726626992225647,
                        0.8219655156135559,
                        0.8192250728607178,
                        0.8033279180526733,
                        0.6359570622444153,
                        0.5444753170013428,
                        0.6789543032646179,
                        0.9863612055778503,
                        0.9149063229560852,
                        0.996536374092102,
                        0.9016100168228149,
                        0.898552417755127,
                        0.895088791847229,
                        0.9024981260299683,
                        0.9020287394523621,
                        0.9065771102905273,
                        0.9051054120063782,
                        0.9081376791000366,
                        0.9074018001556396,
                        0.9020350575447083,
                        0.8906608819961548,
                        0.895285427570343,
                        0.9011025428771973,
                        0.9041538238525391,
                        0.9122673869132996,
                        0.8924497961997986,
                        0.909419059753418,
                        0.9984521865844727,
                        0.6742092967033386
                    ]
                },
                "val": {
                    "score": -5.352318708651039,
                    "pretrain_loss": 0.3015945255756378,
                    "features_accuracy": [
                        0.7436872124671936,
                        0.760318398475647,
                        0.8935198783874512,
                        0.9035594463348389,
                        0.9040665030479431,
                        0.9030017256736755,
                        0.8902240991592407,
                        0.9067538380622864,
                        0.9068552851676941,
                        0.9064496159553528,
                        0.9965013265609741,
                        0.7707635760307312,
                        0.894331157207489,
                        0.9083763957023621,
                        0.8886522650718689,
                        0.9120271801948547,
                        0.8774464726448059,
                        0.8842916488647461,
                        0.7571747303009033,
                        0.9157792925834656,
                        0.9130919575691223,
                        0.8186289072036743,
                        0.7716255784034729,
                        0.8217219114303589,
                        0.8224824666976929,
                        0.7987019419670105,
                        0.634114146232605,
                        0.5503498315811157,
                        0.6765033602714539,
                        0.9876787066459656,
                        0.9163877367973328,
                        0.9960957169532776,
                        0.9031031131744385,
                        0.9010242223739624,
                        0.8965114951133728,
                        0.9009734988212585,
                        0.9040157794952393,
                        0.9057904481887817,
                        0.9062467813491821,
                        0.9036608338356018,
                        0.906297504901886,
                        0.9011256098747253,
                        0.8861677050590515,
                        0.8982861638069153,
                        0.9036608338356018,
                        0.9034580588340759,
                        0.909745454788208,
                        0.8924043774604797,
                        0.9117228984832764,
                        0.9982253313064575,
                        0.668542742729187
                    ]
                },
                "test": {
                    "score": -5.598464815260494,
                    "pretrain_loss": 0.3016492426395416,
                    "features_accuracy": [
                        0.738894522190094,
                        0.7569472789764404,
                        0.8905172348022461,
                        0.903346836566925,
                        0.9053245186805725,
                        0.9038539528846741,
                        0.8898072838783264,
                        0.9047667384147644,
                        0.9058823585510254,
                        0.9099898338317871,
                        0.9962981939315796,
                        0.7664300203323364,
                        0.8982758522033691,
                        0.9091784954071045,
                        0.888843834400177,
                        0.908316433429718,
                        0.8821501135826111,
                        0.8874239325523376,
                        0.7510141730308533,
                        0.9162778854370117,
                        0.914452314376831,
                        0.8246450424194336,
                        0.7754057049751282,
                        0.8260142207145691,
                        0.8211460709571838,
                        0.8049695491790771,
                        0.6363083124160767,
                        0.5464503169059753,
                        0.6819979548454285,
                        0.9872211217880249,
                        0.9132353067398071,
                        0.9966024160385132,
                        0.9038539528846741,
                        0.8957403898239136,
                        0.8939148187637329,
                        0.8993407487869263,
                        0.9009634852409363,
                        0.9103448390960693,
                        0.9057302474975586,
                        0.9069472551345825,
                        0.9085699915885925,
                        0.9006592631340027,
                        0.8919878602027893,
                        0.894472599029541,
                        0.901064932346344,
                        0.898833692073822,
                        0.9158214926719666,
                        0.8903651237487793,
                        0.9075050950050354,
                        0.9986308217048645,
                        0.674391508102417
                    ]
                }
            }
        },
        "train": {
            "score": -3.7582722110378985
        },
        "val": {
            "score": -5.306802536159314
        },
        "test": {
            "score": -5.579870707874333
        }
    },
    "best_iteration": 10000,
    "time": "0:15:29"
}
