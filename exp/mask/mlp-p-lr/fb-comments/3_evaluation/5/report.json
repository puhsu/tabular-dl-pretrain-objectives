{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask___e7dfeb810e3e49648ac8c52e61841f9f.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 5,
        "data": {
            "path": "data/fb-comments",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512
                ],
                "dropout": 0.23403030193220953
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "positional",
                "linear",
                "relu"
            ],
            "d_num_embedding": 62,
            "positional_encoding": {
                "n": 27,
                "sigma": 0.256513004712354,
                "trainable": true,
                "initialization": "normal"
            },
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 512,
            "lr": 5.7167751108465785e-05,
            "weight_decay": 0.0,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.4622170577097292,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 5.7167751108465785e-05,
            "weight_decay": 0.0,
            "patience": 2,
            "n_iterations": 100000,
            "finetune_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "target_injection_type": "post"
        },
        "bins": null
    },
    "epoch_size": 308,
    "n_parameters": 2089853,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -4.327398640568579,
                    "pretrain_loss": 0.33485203981399536,
                    "features_accuracy": [
                        0.7020325064659119,
                        0.7332369089126587,
                        0.8595008850097656,
                        0.8807901740074158,
                        0.8834481835365295,
                        0.8823380470275879,
                        0.8612517714500427,
                        0.8790456652641296,
                        0.8826932907104492,
                        0.8734949827194214,
                        0.995343804359436,
                        0.7393648624420166,
                        0.864404559135437,
                        0.8825410008430481,
                        0.85819411277771,
                        0.8839302659034729,
                        0.8515713214874268,
                        0.8575597405433655,
                        0.7206384539604187,
                        0.8908892869949341,
                        0.8829724192619324,
                        0.7847092747688293,
                        0.7568352818489075,
                        0.805637001991272,
                        0.7850391864776611,
                        0.7842779159545898,
                        0.6135386228561401,
                        0.543885350227356,
                        0.6688425540924072,
                        0.9865895509719849,
                        0.9144685864448547,
                        0.9951534867286682,
                        0.9029865860939026,
                        0.8975691199302673,
                        0.8945622444152832,
                        0.9022316932678223,
                        0.9009059071540833,
                        0.9054288864135742,
                        0.9041982293128967,
                        0.906551718711853,
                        0.906684935092926,
                        0.9014387726783752,
                        0.8601542711257935,
                        0.8945241570472717,
                        0.9001256227493286,
                        0.9025743007659912,
                        0.8838288187980652,
                        0.8607506155967712,
                        0.8812850117683411,
                        0.9973673820495605,
                        0.569037914276123
                    ]
                },
                "val": {
                    "score": -5.327993771163663,
                    "pretrain_loss": 0.33546778559684753,
                    "features_accuracy": [
                        0.6992191076278687,
                        0.7388702630996704,
                        0.856961727142334,
                        0.8777000308036804,
                        0.8801338076591492,
                        0.8834803700447083,
                        0.8582293391227722,
                        0.8785113096237183,
                        0.8804380893707275,
                        0.8782070279121399,
                        0.9947266578674316,
                        0.7379068732261658,
                        0.8588885068893433,
                        0.880945086479187,
                        0.8558969497680664,
                        0.8807929754257202,
                        0.8507757782936096,
                        0.8584321737289429,
                        0.7181320190429688,
                        0.8887536525726318,
                        0.8827197551727295,
                        0.7805496454238892,
                        0.7517492771148682,
                        0.8024033904075623,
                        0.7840989828109741,
                        0.7787749767303467,
                        0.6128688454627991,
                        0.5452286601066589,
                        0.6718385219573975,
                        0.9861575365066528,
                        0.9146637916564941,
                        0.994422435760498,
                        0.9038130044937134,
                        0.8988438844680786,
                        0.897880494594574,
                        0.9028496146202087,
                        0.9018861651420593,
                        0.9084271192550659,
                        0.9044721126556396,
                        0.9036101698875427,
                        0.9066524505615234,
                        0.8983368873596191,
                        0.855542004108429,
                        0.896359384059906,
                        0.9015312790870667,
                        0.9033059477806091,
                        0.8865733742713928,
                        0.8630970120429993,
                        0.8795760869979858,
                        0.997312605381012,
                        0.5700232982635498
                    ]
                },
                "test": {
                    "score": -5.612053389227203,
                    "pretrain_loss": 0.3339405059814453,
                    "features_accuracy": [
                        0.6956389546394348,
                        0.7291582226753235,
                        0.8617647290229797,
                        0.8806794881820679,
                        0.8833164572715759,
                        0.8807302117347717,
                        0.861156165599823,
                        0.8793103694915771,
                        0.8806288242340088,
                        0.8758113384246826,
                        0.994979739189148,
                        0.7407200932502747,
                        0.8600912690162659,
                        0.8828600645065308,
                        0.8588235378265381,
                        0.8836206793785095,
                        0.8531440496444702,
                        0.8587728142738342,
                        0.7143509387969971,
                        0.8916835784912109,
                        0.8792089223861694,
                        0.7846348881721497,
                        0.7566429972648621,
                        0.8057809472084045,
                        0.7859533429145813,
                        0.7826064825057983,
                        0.6083671450614929,
                        0.5484279990196228,
                        0.6704868078231812,
                        0.9868661165237427,
                        0.9134381413459778,
                        0.9952839612960815,
                        0.904462456703186,
                        0.8977687954902649,
                        0.8986815214157104,
                        0.9040060639381409,
                        0.9039046764373779,
                        0.9081135988235474,
                        0.9071500897407532,
                        0.9067951440811157,
                        0.9081643223762512,
                        0.9001014232635498,
                        0.8634888529777527,
                        0.897819459438324,
                        0.8995436429977417,
                        0.9002535343170166,
                        0.888336718082428,
                        0.8625253438949585,
                        0.8833164572715759,
                        0.9971602559089661,
                        0.5676977634429932
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -4.158858464085765,
                    "pretrain_loss": 0.31565001606941223,
                    "features_accuracy": [
                        0.722928524017334,
                        0.7465903162956238,
                        0.8759118914604187,
                        0.8943719267845154,
                        0.9010708332061768,
                        0.8930524587631226,
                        0.8800416588783264,
                        0.893686830997467,
                        0.8946129679679871,
                        0.8955962657928467,
                        0.9966886639595032,
                        0.7576092481613159,
                        0.884609043598175,
                        0.8988441824913025,
                        0.8811771273612976,
                        0.8996688723564148,
                        0.8669165968894958,
                        0.876876175403595,
                        0.7405257821083069,
                        0.9051688313484192,
                        0.9045471549034119,
                        0.7983418107032776,
                        0.767143726348877,
                        0.8175820708274841,
                        0.7990649342536926,
                        0.7923280000686646,
                        0.6287253499031067,
                        0.5391910672187805,
                        0.6763090491294861,
                        0.9872302412986755,
                        0.9155089855194092,
                        0.9956799745559692,
                        0.9020794630050659,
                        0.8995420336723328,
                        0.8961671590805054,
                        0.9016988277435303,
                        0.9004745483398438,
                        0.9079029560089111,
                        0.9043631553649902,
                        0.907623827457428,
                        0.9061140418052673,
                        0.9013308882713318,
                        0.876470148563385,
                        0.896681010723114,
                        0.9019081592559814,
                        0.9036082625389099,
                        0.9005696773529053,
                        0.8810122013092041,
                        0.8979180455207825,
                        0.9981222748756409,
                        0.5745378732681274
                    ]
                },
                "val": {
                    "score": -5.361381055066985,
                    "pretrain_loss": 0.3171314299106598,
                    "features_accuracy": [
                        0.7206672430038452,
                        0.7489098310470581,
                        0.8712098002433777,
                        0.8886522650718689,
                        0.8967649936676025,
                        0.8938241600990295,
                        0.8774464726448059,
                        0.8919480443000793,
                        0.8934692144393921,
                        0.9002129435539246,
                        0.9961463809013367,
                        0.7523070573806763,
                        0.8812493681907654,
                        0.896359384059906,
                        0.8786634206771851,
                        0.8969678282737732,
                        0.865378737449646,
                        0.8782577514648438,
                        0.7366899847984314,
                        0.9018861651420593,
                        0.9027988910675049,
                        0.7931244373321533,
                        0.7651353478431702,
                        0.8130514025688171,
                        0.7981441617012024,
                        0.7918567657470703,
                        0.6282324194908142,
                        0.5335158705711365,
                        0.674931526184082,
                        0.9871209263801575,
                        0.9160835146903992,
                        0.9949802160263062,
                        0.9044721126556396,
                        0.9022411108016968,
                        0.8978298306465149,
                        0.9044214487075806,
                        0.9021904468536377,
                        0.9081735610961914,
                        0.9048270583152771,
                        0.9042186141014099,
                        0.9066017270088196,
                        0.8991481065750122,
                        0.8736436367034912,
                        0.8966636061668396,
                        0.9035594463348389,
                        0.9042186141014099,
                        0.9014298319816589,
                        0.8830240368843079,
                        0.8953452706336975,
                        0.9977689385414124,
                        0.5700740218162537
                    ]
                },
                "test": {
                    "score": -5.640624062376485,
                    "pretrain_loss": 0.3158608078956604,
                    "features_accuracy": [
                        0.7184076905250549,
                        0.7425963282585144,
                        0.8791581988334656,
                        0.8906693458557129,
                        0.8987829685211182,
                        0.8907707929611206,
                        0.8809837698936462,
                        0.8939655423164368,
                        0.893306314945221,
                        0.8973124027252197,
                        0.9966024160385132,
                        0.7579107284545898,
                        0.881085216999054,
                        0.8992393612861633,
                        0.8797667622566223,
                        0.8982251286506653,
                        0.8674442172050476,
                        0.879462480545044,
                        0.7362068891525269,
                        0.9039553999900818,
                        0.9005070924758911,
                        0.7987322807312012,
                        0.7675963640213013,
                        0.8140466809272766,
                        0.8010649085044861,
                        0.7922413945198059,
                        0.6228702068328857,
                        0.5374239087104797,
                        0.6736815571784973,
                        0.9878803491592407,
                        0.9146551489830017,
                        0.9963489174842834,
                        0.9049188494682312,
                        0.8998985886573792,
                        0.8985294103622437,
                        0.9048681855201721,
                        0.9028904438018799,
                        0.9081135988235474,
                        0.9072515368461609,
                        0.9082657098770142,
                        0.9076064825057983,
                        0.9008620977401733,
                        0.8803245425224304,
                        0.8991886377334595,
                        0.9013691544532776,
                        0.901064932346344,
                        0.9025862216949463,
                        0.8819472789764404,
                        0.8987829685211182,
                        0.9976166486740112,
                        0.5717545747756958
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -4.034243416219446,
                    "pretrain_loss": 0.30720052123069763,
                    "features_accuracy": [
                        0.731194257736206,
                        0.7559154629707336,
                        0.8827123045921326,
                        0.8988759517669678,
                        0.9061901569366455,
                        0.9020350575447083,
                        0.886011004447937,
                        0.8989076614379883,
                        0.9006711840629578,
                        0.9047755002975464,
                        0.996809184551239,
                        0.7655070424079895,
                        0.8954566717147827,
                        0.9056636095046997,
                        0.888339102268219,
                        0.9062281847000122,
                        0.8732475638389587,
                        0.8848501443862915,
                        0.7499524354934692,
                        0.9139103889465332,
                        0.9091653227806091,
                        0.8111622929573059,
                        0.7717809081077576,
                        0.8215214610099792,
                        0.8117966651916504,
                        0.8011964559555054,
                        0.6386784911155701,
                        0.5444055199623108,
                        0.6790304780006409,
                        0.9871858358383179,
                        0.9163082838058472,
                        0.99640953540802,
                        0.9035702347755432,
                        0.898285984992981,
                        0.8952664136886597,
                        0.9015275835990906,
                        0.9015402793884277,
                        0.9063106775283813,
                        0.9041919112205505,
                        0.9091145992279053,
                        0.9075857400894165,
                        0.9006901979446411,
                        0.8885675072669983,
                        0.8956977725028992,
                        0.902694821357727,
                        0.9034560322761536,
                        0.909482479095459,
                        0.8889671564102173,
                        0.9042807221412659,
                        0.9981159567832947,
                        0.6078483462333679
                    ]
                },
                "val": {
                    "score": -5.3729774005736815,
                    "pretrain_loss": 0.3078573942184448,
                    "features_accuracy": [
                        0.7258391380310059,
                        0.7606733441352844,
                        0.8823648691177368,
                        0.894939661026001,
                        0.9034073352813721,
                        0.9022918343544006,
                        0.8856606483459473,
                        0.8986917734146118,
                        0.8994523882865906,
                        0.9088327288627625,
                        0.9962478280067444,
                        0.762346625328064,
                        0.8919480443000793,
                        0.9038130044937134,
                        0.8871310949325562,
                        0.9039651155471802,
                        0.8734915256500244,
                        0.8847987055778503,
                        0.7463238835334778,
                        0.9094918966293335,
                        0.9067031741142273,
                        0.8059527277946472,
                        0.7685325741767883,
                        0.8148260712623596,
                        0.809654176235199,
                        0.7982962727546692,
                        0.6411621570587158,
                        0.5462427735328674,
                        0.6797991991043091,
                        0.987273097038269,
                        0.9163877367973328,
                        0.9957407712936401,
                        0.9056383371353149,
                        0.8995537757873535,
                        0.8975256085395813,
                        0.9052327275276184,
                        0.9032045006752014,
                        0.909745454788208,
                        0.9050806164741516,
                        0.9056890606880188,
                        0.906196117401123,
                        0.8991481065750122,
                        0.8864719271659851,
                        0.8980833292007446,
                        0.904776394367218,
                        0.9049285054206848,
                        0.9113172888755798,
                        0.8913396000862122,
                        0.9030017256736755,
                        0.9982759952545166,
                        0.5995842218399048
                    ]
                },
                "test": {
                    "score": -5.601081085720185,
                    "pretrain_loss": 0.3065451979637146,
                    "features_accuracy": [
                        0.7290061116218567,
                        0.7512170672416687,
                        0.8871703743934631,
                        0.8980730175971985,
                        0.9057302474975586,
                        0.8995436429977417,
                        0.8893508911132812,
                        0.899442195892334,
                        0.8997971415519714,
                        0.9051216840744019,
                        0.9967038631439209,
                        0.7673428058624268,
                        0.8924442529678345,
                        0.9075050950050354,
                        0.8883874416351318,
                        0.9048174619674683,
                        0.8756592273712158,
                        0.886105477809906,
                        0.7486815452575684,
                        0.9103955626487732,
                        0.9069472551345825,
                        0.8137931227684021,
                        0.7712474465370178,
                        0.8139959573745728,
                        0.8144523501396179,
                        0.7976673245429993,
                        0.6330628991127014,
                        0.5484279990196228,
                        0.68052738904953,
                        0.9879310131072998,
                        0.9148073196411133,
                        0.9971095323562622,
                        0.9048174619674683,
                        0.8993407487869263,
                        0.8992393612861633,
                        0.9054766893386841,
                        0.903296172618866,
                        0.9084178805351257,
                        0.9068458676338196,
                        0.9106491208076477,
                        0.9084685444831848,
                        0.9003042578697205,
                        0.8905172348022461,
                        0.8995436429977417,
                        0.901673436164856,
                        0.9018255472183228,
                        0.9102433919906616,
                        0.8911257386207581,
                        0.9059838056564331,
                        0.9981237649917603,
                        0.6053245663642883
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -4.033339486074264,
                    "pretrain_loss": 0.2986542880535126,
                    "features_accuracy": [
                        0.7405067682266235,
                        0.7732272744178772,
                        0.8909717202186584,
                        0.9059047102928162,
                        0.9095649719238281,
                        0.9066342115402222,
                        0.8912381529808044,
                        0.9041221141815186,
                        0.9072431921958923,
                        0.9083723425865173,
                        0.996809184551239,
                        0.775479257106781,
                        0.8982225060462952,
                        0.9108020067214966,
                        0.8956660628318787,
                        0.9097298979759216,
                        0.8804032206535339,
                        0.889804482460022,
                        0.7556363344192505,
                        0.9185031652450562,
                        0.9140816330909729,
                        0.8241984844207764,
                        0.7753334045410156,
                        0.8236593008041382,
                        0.8244014978408813,
                        0.8047869205474854,
                        0.6446352005004883,
                        0.5447037220001221,
                        0.682697057723999,
                        0.9870970249176025,
                        0.9164351224899292,
                        0.9962890148162842,
                        0.9035131335258484,
                        0.9005125761032104,
                        0.896884024143219,
                        0.9025806188583374,
                        0.9008297920227051,
                        0.9074652194976807,
                        0.9053654670715332,
                        0.907623827457428,
                        0.907560408115387,
                        0.9027265310287476,
                        0.8926782011985779,
                        0.8967254161834717,
                        0.9024537205696106,
                        0.9034560322761536,
                        0.9109034538269043,
                        0.8938961625099182,
                        0.9090130925178528,
                        0.9983887076377869,
                        0.675560474395752
                    ]
                },
                "val": {
                    "score": -5.3440234716996855,
                    "pretrain_loss": 0.29985567927360535,
                    "features_accuracy": [
                        0.7375519275665283,
                        0.7746678590774536,
                        0.8896663188934326,
                        0.8995537757873535,
                        0.9059932827949524,
                        0.9064496159553528,
                        0.8904269337654114,
                        0.9037115573883057,
                        0.9044721126556396,
                        0.9125849008560181,
                        0.9960449934005737,
                        0.7688875198364258,
                        0.8960551619529724,
                        0.9075651168823242,
                        0.8928607106208801,
                        0.905536949634552,
                        0.8782577514648438,
                        0.890122652053833,
                        0.7533718347549438,
                        0.9152215719223022,
                        0.9110130667686462,
                        0.8205050230026245,
                        0.771574854850769,
                        0.8177162408828735,
                        0.821671187877655,
                        0.801135778427124,
                        0.6418213248252869,
                        0.5462427735328674,
                        0.6844640374183655,
                        0.9870702624320984,
                        0.9167934060096741,
                        0.9955886602401733,
                        0.9058918952941895,
                        0.9015312790870667,
                        0.8989453315734863,
                        0.906196117401123,
                        0.9026467800140381,
                        0.9095933437347412,
                        0.9054862260818481,
                        0.906196117401123,
                        0.9064496159553528,
                        0.9004157781600952,
                        0.8932663798332214,
                        0.8984889984130859,
                        0.9033059477806091,
                        0.9036608338356018,
                        0.9151201248168945,
                        0.8981340527534485,
                        0.9076665639877319,
                        0.9982759952545166,
                        0.6733089685440063
                    ]
                },
                "test": {
                    "score": -5.564337037055008,
                    "pretrain_loss": 0.29876968264579773,
                    "features_accuracy": [
                        0.7391480803489685,
                        0.7682048678398132,
                        0.89335697889328,
                        0.9020283818244934,
                        0.9106491208076477,
                        0.9041075110435486,
                        0.8925456404685974,
                        0.9047160148620605,
                        0.9041582345962524,
                        0.9083671569824219,
                        0.9967545866966248,
                        0.7768255472183228,
                        0.8962981700897217,
                        0.909939169883728,
                        0.8937119841575623,
                        0.9090263843536377,
                        0.8796145915985107,
                        0.8901622891426086,
                        0.7551724314689636,
                        0.9161764979362488,
                        0.9126268029212952,
                        0.8232758641242981,
                        0.7726673483848572,
                        0.8176470398902893,
                        0.8245943188667297,
                        0.8025354743003845,
                        0.6352434158325195,
                        0.5481237173080444,
                        0.6815415620803833,
                        0.9876775145530701,
                        0.9151622653007507,
                        0.9965517520904541,
                        0.9055274128913879,
                        0.8998478651046753,
                        0.8996957540512085,
                        0.9050202965736389,
                        0.9034990072250366,
                        0.9087728261947632,
                        0.9076572060585022,
                        0.910040557384491,
                        0.9079614877700806,
                        0.901673436164856,
                        0.8951825499534607,
                        0.8997971415519714,
                        0.9011155962944031,
                        0.9012170433998108,
                        0.9141480922698975,
                        0.8961967825889587,
                        0.9098884463310242,
                        0.9981744289398193,
                        0.6748479008674622
                    ]
                }
            }
        },
        "train": {
            "score": -4.327398640568579
        },
        "val": {
            "score": -5.327993771163663
        },
        "test": {
            "score": -5.612053389227203
        }
    },
    "best_iteration": 10000,
    "time": "0:13:41"
}
