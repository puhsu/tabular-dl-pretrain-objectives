{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask___41a66d9e6e4a450aa73b706f17e60857.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 4,
        "data": {
            "path": "data/california",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512,
                    512
                ],
                "dropout": 0.14983331229346294
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "positional",
                "linear",
                "relu"
            ],
            "d_num_embedding": 78,
            "positional_encoding": {
                "n": 51,
                "sigma": 0.11813809836285846,
                "trainable": true,
                "initialization": "normal"
            },
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.00019893106949684752,
            "weight_decay": 1.792730113200251e-05,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.5105571398137524,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.00019893106949684752,
            "weight_decay": 1.792730113200251e-05,
            "patience": 2,
            "n_iterations": 100000,
            "finetune_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "target_injection_type": "post"
        },
        "bins": null
    },
    "epoch_size": 104,
    "n_parameters": 914096,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -0.3172427612294713,
                    "pretrain_loss": 0.6529724597930908,
                    "features_accuracy": [
                        0.5936104655265808,
                        0.5795291066169739,
                        0.605344831943512,
                        0.5451586246490479,
                        0.5553789138793945,
                        0.5667348504066467,
                        0.6772655248641968,
                        0.6744644045829773
                    ]
                },
                "val": {
                    "score": -0.45298001391165416,
                    "pretrain_loss": 0.653119683265686,
                    "features_accuracy": [
                        0.6027853488922119,
                        0.5906751155853271,
                        0.6206479072570801,
                        0.551014244556427,
                        0.5652437210083008,
                        0.5740236043930054,
                        0.6727217435836792,
                        0.6657583713531494
                    ]
                },
                "test": {
                    "score": -0.44780944742757617,
                    "pretrain_loss": 0.6553472280502319,
                    "features_accuracy": [
                        0.5857558250427246,
                        0.573401153087616,
                        0.6133720874786377,
                        0.5310077667236328,
                        0.5528100728988647,
                        0.5692829489707947,
                        0.6664243936538696,
                        0.6887112259864807
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -0.3123941378718075,
                    "pretrain_loss": 0.6485734581947327,
                    "features_accuracy": [
                        0.6072375178337097,
                        0.5894466042518616,
                        0.6118555665016174,
                        0.5502309203147888,
                        0.5586342811584473,
                        0.5786206722259521,
                        0.6823378205299377,
                        0.6811265349388123
                    ]
                },
                "val": {
                    "score": -0.44980182781491074,
                    "pretrain_loss": 0.6506615281105042,
                    "features_accuracy": [
                        0.5973357558250427,
                        0.5891613960266113,
                        0.6142900586128235,
                        0.553436279296875,
                        0.5694822669029236,
                        0.5716015696525574,
                        0.6721162796020508,
                        0.6733272671699524
                    ]
                },
                "test": {
                    "score": -0.44399190077664374,
                    "pretrain_loss": 0.6523127555847168,
                    "features_accuracy": [
                        0.5954457521438599,
                        0.586240291595459,
                        0.6208817958831787,
                        0.529312014579773,
                        0.5566860437393188,
                        0.5792151093482971,
                        0.6681201457977295,
                        0.689437985420227
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -0.30290349962973045,
                    "pretrain_loss": 0.6457931399345398,
                    "features_accuracy": [
                        0.6096600890159607,
                        0.5869483351707458,
                        0.6085245013237,
                        0.5600727200508118,
                        0.5644636154174805,
                        0.5727912783622742,
                        0.6848361492156982,
                        0.6890756487846375
                    ]
                },
                "val": {
                    "score": -0.44812588625821304,
                    "pretrain_loss": 0.6485193967819214,
                    "features_accuracy": [
                        0.5979412794113159,
                        0.6030880808830261,
                        0.6173176169395447,
                        0.548592209815979,
                        0.5688768029212952,
                        0.5737208724021912,
                        0.6709052324295044,
                        0.6781713366508484
                    ]
                },
                "test": {
                    "score": -0.4403243672311584,
                    "pretrain_loss": 0.6497378349304199,
                    "features_accuracy": [
                        0.5968992114067078,
                        0.5833333134651184,
                        0.6179748177528381,
                        0.536579430103302,
                        0.5656492114067078,
                        0.5746123790740967,
                        0.6804748177528381,
                        0.6942829489707947
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -0.29684786982398503,
                    "pretrain_loss": 0.642729640007019,
                    "features_accuracy": [
                        0.6092058420181274,
                        0.6039064526557922,
                        0.6088273525238037,
                        0.5574229955673218,
                        0.5572715997695923,
                        0.5835415720939636,
                        0.6852903366088867,
                        0.6931637525558472
                    ]
                },
                "val": {
                    "score": -0.4483094639441679,
                    "pretrain_loss": 0.6475771069526672,
                    "features_accuracy": [
                        0.6015743017196655,
                        0.5982440114021301,
                        0.6288222670555115,
                        0.5594913959503174,
                        0.5761429071426392,
                        0.580381453037262,
                        0.6730245351791382,
                        0.6787768602371216
                    ]
                },
                "test": {
                    "score": -0.44251838397861815,
                    "pretrain_loss": 0.6490645408630371,
                    "features_accuracy": [
                        0.5927810072898865,
                        0.5906007885932922,
                        0.6172480583190918,
                        0.5382751822471619,
                        0.5622577667236328,
                        0.570009708404541,
                        0.6717538833618164,
                        0.6959787011146545
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": -0.3122278941957866,
                    "pretrain_loss": 0.6388218998908997,
                    "features_accuracy": [
                        0.6085245013237,
                        0.5995154976844788,
                        0.6238170862197876,
                        0.5718828439712524,
                        0.5679461359977722,
                        0.5787720680236816,
                        0.6923310160636902,
                        0.6949049830436707
                    ]
                },
                "val": {
                    "score": -0.4457381248387299,
                    "pretrain_loss": 0.6465368270874023,
                    "features_accuracy": [
                        0.6033908724784851,
                        0.5970330238342285,
                        0.6327580809593201,
                        0.5470784306526184,
                        0.5694822669029236,
                        0.5749318599700928,
                        0.6787768602371216,
                        0.6769603490829468
                    ]
                },
                "test": {
                    "score": -0.4355100064271006,
                    "pretrain_loss": 0.6489059925079346,
                    "features_accuracy": [
                        0.5942344665527344,
                        0.588420569896698,
                        0.6143410801887512,
                        0.538759708404541,
                        0.5578972697257996,
                        0.5794573426246643,
                        0.6749030947685242,
                        0.693071722984314
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": -0.3318999437886945,
                    "pretrain_loss": 0.6357075572013855,
                    "features_accuracy": [
                        0.6182148456573486,
                        0.6051177382469177,
                        0.6221516132354736,
                        0.5684003233909607,
                        0.5749867558479309,
                        0.5873268246650696,
                        0.6986902952194214,
                        0.7033084034919739
                    ]
                },
                "val": {
                    "score": -0.44209436273891384,
                    "pretrain_loss": 0.6449077725410461,
                    "features_accuracy": [
                        0.5973357558250427,
                        0.5982440114021301,
                        0.6257947087287903,
                        0.5491976737976074,
                        0.5643354654312134,
                        0.5837118029594421,
                        0.684831976890564,
                        0.6802906394004822
                    ]
                },
                "test": {
                    "score": -0.42772096335706733,
                    "pretrain_loss": 0.6469249725341797,
                    "features_accuracy": [
                        0.5983527302742004,
                        0.5968992114067078,
                        0.6133720874786377,
                        0.529312014579773,
                        0.5581395626068115,
                        0.5668604373931885,
                        0.6785368323326111,
                        0.6971899271011353
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": -0.30153153991516474,
                    "pretrain_loss": 0.6420634388923645,
                    "features_accuracy": [
                        0.6088273525238037,
                        0.5920206308364868,
                        0.6092058420181274,
                        0.5611326098442078,
                        0.568324625492096,
                        0.5822545289993286,
                        0.6902869343757629,
                        0.6946778893470764
                    ]
                },
                "val": {
                    "score": -0.4425778660068636,
                    "pretrain_loss": 0.6447065472602844,
                    "features_accuracy": [
                        0.6000605225563049,
                        0.6024826169013977,
                        0.6209506392478943,
                        0.5443536043167114,
                        0.5776566863059998,
                        0.5722070932388306,
                        0.6830154657363892,
                        0.6830154657363892
                    ]
                },
                "test": {
                    "score": -0.43495132531935277,
                    "pretrain_loss": 0.6452849507331848,
                    "features_accuracy": [
                        0.6056201457977295,
                        0.5859980583190918,
                        0.6116763353347778,
                        0.5477228760719299,
                        0.5528100728988647,
                        0.5804263353347778,
                        0.6790212988853455,
                        0.7080910801887512
                    ]
                }
            },
            "80000": {
                "train": {
                    "score": -0.2852170848453998,
                    "pretrain_loss": 0.6380075216293335,
                    "features_accuracy": [
                        0.6138239502906799,
                        0.5916420817375183,
                        0.6100386381149292,
                        0.5540919303894043,
                        0.5712014436721802,
                        0.5830116271972656,
                        0.6967976689338684,
                        0.6982360482215881
                    ]
                },
                "val": {
                    "score": -0.44146625120791494,
                    "pretrain_loss": 0.6444975137710571,
                    "features_accuracy": [
                        0.6136845350265503,
                        0.5967302322387695,
                        0.6182258725166321,
                        0.546170175075531,
                        0.5697850584983826,
                        0.5643354654312134,
                        0.6815016865730286,
                        0.684831976890564
                    ]
                },
                "test": {
                    "score": -0.42878194433184724,
                    "pretrain_loss": 0.6446570754051208,
                    "features_accuracy": [
                        0.5973837375640869,
                        0.597141444683075,
                        0.6124030947685242,
                        0.5460271239280701,
                        0.5501453280448914,
                        0.5804263353347778,
                        0.6836240291595459,
                        0.7008236646652222
                    ]
                }
            },
            "90000": {
                "train": {
                    "score": -0.28497958462723755,
                    "pretrain_loss": 0.6386207342147827,
                    "features_accuracy": [
                        0.6216973662376404,
                        0.5992884039878845,
                        0.6128397583961487,
                        0.5618139505386353,
                        0.5574229955673218,
                        0.5881596207618713,
                        0.7004315257072449,
                        0.7011886239051819
                    ]
                },
                "val": {
                    "score": -0.4391693454921841,
                    "pretrain_loss": 0.6425475478172302,
                    "features_accuracy": [
                        0.6024826169013977,
                        0.5921888947486877,
                        0.6282167434692383,
                        0.546170175075531,
                        0.5709960460662842,
                        0.5867393016815186,
                        0.6878595352172852,
                        0.6784741282463074
                    ]
                },
                "test": {
                    "score": -0.42835482159672056,
                    "pretrain_loss": 0.6444782614707947,
                    "features_accuracy": [
                        0.5939922332763672,
                        0.5944767594337463,
                        0.6208817958831787,
                        0.5467538833618164,
                        0.5545058250427246,
                        0.5784883499145508,
                        0.685562014579773,
                        0.7010658979415894
                    ]
                }
            },
            "100000": {
                "train": {
                    "score": -0.28686778394736223,
                    "pretrain_loss": 0.6364594101905823,
                    "features_accuracy": [
                        0.6174578070640564,
                        0.597547173500061,
                        0.6126883625984192,
                        0.5630252361297607,
                        0.5719585418701172,
                        0.5920963287353516,
                        0.6941479444503784,
                        0.7047467827796936
                    ]
                },
                "val": {
                    "score": -0.44224293442022794,
                    "pretrain_loss": 0.642774224281311,
                    "features_accuracy": [
                        0.6067211627960205,
                        0.5976384878158569,
                        0.6209506392478943,
                        0.54828941822052,
                        0.5725098252296448,
                        0.5788676738739014,
                        0.6851347088813782,
                        0.6818044185638428
                    ]
                },
                "test": {
                    "score": -0.4276243309381857,
                    "pretrain_loss": 0.6422080397605896,
                    "features_accuracy": [
                        0.6051356792449951,
                        0.5959302186965942,
                        0.617490291595459,
                        0.5375484228134155,
                        0.557170569896698,
                        0.5830910801887512,
                        0.6814438104629517,
                        0.705910861492157
                    ]
                }
            }
        },
        "train": {
            "score": -0.28497958462723755
        },
        "val": {
            "score": -0.4391693454921841
        },
        "test": {
            "score": -0.42835482159672056
        }
    },
    "best_iteration": 90000,
    "time": "0:09:10"
}
