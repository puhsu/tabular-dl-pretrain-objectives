{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/tune.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 0,
        "program": "bin/pretrain_mask.py",
        "base_config": {
            "seed": 0,
            "data": {
                "T_cache": true,
                "path": "data/churn_roc",
                "T": {
                    "normalization": "quantile"
                }
            },
            "model": {
                "kind": "mlp"
            },
            "training": {
                "batch_size": 128,
                "patience": 16
            },
            "pretrain": {
                "corrupt_strategy": "resample",
                "patience": 2,
                "d_hidden_head": 512
            }
        },
        "space": {
            "model": {
                "config": {
                    "d_layers": [
                        "$fixed_mlp_d_layers",
                        1,
                        8,
                        512
                    ],
                    "dropout": [
                        "?uniform",
                        0.0,
                        0.0,
                        0.5
                    ]
                }
            },
            "pretrain": {
                "corrupt_probability": [
                    "uniform",
                    0.2,
                    0.8
                ]
            },
            "training": {
                "lr": [
                    "loguniform",
                    5e-05,
                    0.005
                ],
                "weight_decay": [
                    "?loguniform",
                    0.0,
                    1e-06,
                    0.001
                ]
            }
        },
        "n_trials": 100,
        "timeout": null,
        "sampler": {
            "seed": 0
        }
    },
    "best": {
        "program": "bin/pretrain_mask.py",
        "environment": {
            "CUDA_VISIBLE_DEVICES": "0",
            "gpus": {
                "driver": "450.119.04",
                "devices": [
                    {
                        "name": "A100-SXM-80GB",
                        "memory_total": 85199093760,
                        "memory_free": 85195948032,
                        "memory_used": 3145728,
                        "utilization": 0
                    }
                ]
            },
            "torch.version.cuda": "11.1",
            "torch.backends.cudnn.version()": 8005,
            "torch.cuda.nccl.version()": [
                2,
                10,
                3
            ]
        },
        "config": {
            "seed": 0,
            "data": {
                "path": "data/churn_roc",
                "T": {
                    "seed": 0,
                    "normalization": "quantile",
                    "num_nan_policy": null,
                    "cat_nan_policy": null,
                    "cat_min_frequency": null,
                    "cat_encoding": null,
                    "y_policy": "default"
                },
                "T_cache": true
            },
            "model": {
                "kind": "mlp",
                "config": {
                    "d_layers": [
                        512,
                        512,
                        512
                    ],
                    "dropout": 0.0
                },
                "default": true,
                "checkpoint": null,
                "num_embedding_arch": [],
                "d_num_embedding": null,
                "positional_encoding": null,
                "d_cat_embedding": null
            },
            "training": {
                "batch_size": 128,
                "lr": 0.0004704225294130533,
                "weight_decay": 6.197463738782054e-05,
                "optimizer": "AdamW",
                "patience": 16,
                "n_epochs": Infinity,
                "eval_batch_size": 8192
            },
            "pretrain": {
                "corrupt_probability": 0.44506055766727737,
                "corrupt_strategy": "resample",
                "d_hidden_head": 512,
                "lr": 0.0004704225294130533,
                "weight_decay": 6.197463738782054e-05,
                "patience": 2,
                "n_iterations": 100000,
                "finetune_every": 10000,
                "replace_strategy": "shuffle",
                "n_neighbors": 20,
                "use_target": false,
                "target_injection_type": "post"
            },
            "bins": null
        },
        "epoch_size": 50,
        "n_parameters": 800779,
        "metrics": {
            "iteration_scores": {
                "10000": {
                    "train": {
                        "score": 0.897689063237376,
                        "pretrain_loss": 0.5682539343833923,
                        "features_accuracy": [
                            0.5514062643051147,
                            0.7792187333106995,
                            0.5637499690055847,
                            0.596875011920929,
                            0.6443749666213989,
                            0.7640624642372131,
                            0.74281245470047,
                            0.8159374594688416,
                            0.7787500023841858,
                            0.7501562237739563,
                            0.7231249809265137
                        ]
                    },
                    "val": {
                        "score": 0.8673035991177973,
                        "pretrain_loss": 0.5664967894554138,
                        "features_accuracy": [
                            0.5581249594688416,
                            0.7849999666213989,
                            0.546875,
                            0.6068750023841858,
                            0.6293749809265137,
                            0.7749999761581421,
                            0.7418749928474426,
                            0.81312495470047,
                            0.7831249833106995,
                            0.7462499737739563,
                            0.7337499856948853
                        ]
                    },
                    "test": {
                        "score": 0.8577128746620271,
                        "pretrain_loss": 0.5682353377342224,
                        "features_accuracy": [
                            0.562000036239624,
                            0.7845000624656677,
                            0.5605000257492065,
                            0.5805000066757202,
                            0.6320000290870667,
                            0.7700000405311584,
                            0.737000048160553,
                            0.8100000619888306,
                            0.7845000624656677,
                            0.7505000233650208,
                            0.7360000610351562
                        ]
                    }
                },
                "20000": {
                    "train": {
                        "score": 0.896344405211353,
                        "pretrain_loss": 0.5659961104393005,
                        "features_accuracy": [
                            0.5649999976158142,
                            0.7901562452316284,
                            0.5640624761581421,
                            0.5953124761581421,
                            0.632031261920929,
                            0.7621874809265137,
                            0.7529687285423279,
                            0.8120312094688416,
                            0.7789062261581421,
                            0.7445312142372131,
                            0.7412499785423279
                        ]
                    },
                    "val": {
                        "score": 0.8623628781385136,
                        "pretrain_loss": 0.5654152631759644,
                        "features_accuracy": [
                            0.5581249594688416,
                            0.7849999666213989,
                            0.5525000095367432,
                            0.6068750023841858,
                            0.6312499642372131,
                            0.7756249904632568,
                            0.7431249618530273,
                            0.81312495470047,
                            0.7831249833106995,
                            0.7493749856948853,
                            0.7337499856948853
                        ]
                    },
                    "test": {
                        "score": 0.8552065162234653,
                        "pretrain_loss": 0.5676337480545044,
                        "features_accuracy": [
                            0.562000036239624,
                            0.7845000624656677,
                            0.5560000538825989,
                            0.5805000066757202,
                            0.6385000348091125,
                            0.7680000066757202,
                            0.7380000352859497,
                            0.8100000619888306,
                            0.7845000624656677,
                            0.7520000338554382,
                            0.737000048160553
                        ]
                    }
                },
                "30000": {
                    "train": {
                        "score": 0.9100908266798932,
                        "pretrain_loss": 0.5647028088569641,
                        "features_accuracy": [
                            0.5625,
                            0.780468761920929,
                            0.569531261920929,
                            0.5951562523841858,
                            0.6396874785423279,
                            0.7668749690055847,
                            0.7573437094688416,
                            0.8034374713897705,
                            0.7854687571525574,
                            0.7504687309265137,
                            0.733593761920929
                        ]
                    },
                    "val": {
                        "score": 0.8748543305949091,
                        "pretrain_loss": 0.5645322203636169,
                        "features_accuracy": [
                            0.5581249594688416,
                            0.7849999666213989,
                            0.5525000095367432,
                            0.6068750023841858,
                            0.6274999976158142,
                            0.7756249904632568,
                            0.7431249618530273,
                            0.81312495470047,
                            0.7831249833106995,
                            0.7481249570846558,
                            0.7356249690055847
                        ]
                    },
                    "test": {
                        "score": 0.8540543625289387,
                        "pretrain_loss": 0.5650179982185364,
                        "features_accuracy": [
                            0.562000036239624,
                            0.7845000624656677,
                            0.5605000257492065,
                            0.5805000066757202,
                            0.6300000548362732,
                            0.7695000171661377,
                            0.7385000586509705,
                            0.8100000619888306,
                            0.7845000624656677,
                            0.7555000185966492,
                            0.737500011920929
                        ]
                    }
                },
                "40000": {
                    "train": {
                        "score": 0.9053266245148366,
                        "pretrain_loss": 0.5649514198303223,
                        "features_accuracy": [
                            0.5681250095367432,
                            0.7834374904632568,
                            0.5660937428474426,
                            0.6015625,
                            0.6207812428474426,
                            0.7640624642372131,
                            0.7565624713897705,
                            0.8159374594688416,
                            0.7743749618530273,
                            0.7406249642372131,
                            0.7306249737739563
                        ]
                    },
                    "val": {
                        "score": 0.8733494813687627,
                        "pretrain_loss": 0.5644157528877258,
                        "features_accuracy": [
                            0.5581249594688416,
                            0.7849999666213989,
                            0.5518749952316284,
                            0.6068750023841858,
                            0.6268749833106995,
                            0.7749999761581421,
                            0.7437499761581421,
                            0.81312495470047,
                            0.7831249833106995,
                            0.75,
                            0.734375
                        ]
                    },
                    "test": {
                        "score": 0.853704243534752,
                        "pretrain_loss": 0.565888524055481,
                        "features_accuracy": [
                            0.562000036239624,
                            0.7845000624656677,
                            0.5585000514984131,
                            0.5805000066757202,
                            0.6295000314712524,
                            0.7700000405311584,
                            0.7410000562667847,
                            0.8100000619888306,
                            0.784000039100647,
                            0.7540000081062317,
                            0.734000027179718
                        ]
                    }
                },
                "50000": {
                    "train": {
                        "score": 0.9017307872889601,
                        "pretrain_loss": 0.5682457685470581,
                        "features_accuracy": [
                            0.5567187666893005,
                            0.7748437523841858,
                            0.5626562237739563,
                            0.6003124713897705,
                            0.6204687356948853,
                            0.7573437094688416,
                            0.7490624785423279,
                            0.8104687333106995,
                            0.7774999737739563,
                            0.7475000023841858,
                            0.7345312237739563
                        ]
                    },
                    "val": {
                        "score": 0.8687843707563253,
                        "pretrain_loss": 0.5636659264564514,
                        "features_accuracy": [
                            0.5581249594688416,
                            0.7849999666213989,
                            0.5506249666213989,
                            0.6068750023841858,
                            0.6343749761581421,
                            0.7756249904632568,
                            0.7443749904632568,
                            0.81312495470047,
                            0.7831249833106995,
                            0.7493749856948853,
                            0.737500011920929
                        ]
                    },
                    "test": {
                        "score": 0.8531150565048871,
                        "pretrain_loss": 0.5654891729354858,
                        "features_accuracy": [
                            0.562000036239624,
                            0.7845000624656677,
                            0.5590000152587891,
                            0.5805000066757202,
                            0.6340000033378601,
                            0.7690000534057617,
                            0.7410000562667847,
                            0.8100000619888306,
                            0.784000039100647,
                            0.7550000548362732,
                            0.7325000166893005
                        ]
                    }
                },
                "60000": {
                    "train": {
                        "score": 0.9073501952692354,
                        "pretrain_loss": 0.5665512681007385,
                        "features_accuracy": [
                            0.5607812404632568,
                            0.7712500095367432,
                            0.5759375095367432,
                            0.5974999666213989,
                            0.62890625,
                            0.7620312571525574,
                            0.7526562213897705,
                            0.8179687261581421,
                            0.7806249856948853,
                            0.75,
                            0.7326562404632568
                        ]
                    },
                    "val": {
                        "score": 0.8774330402288333,
                        "pretrain_loss": 0.5644561052322388,
                        "features_accuracy": [
                            0.5581249594688416,
                            0.7849999666213989,
                            0.5450000166893005,
                            0.6068750023841858,
                            0.6287499666213989,
                            0.7768749594688416,
                            0.7425000071525574,
                            0.81312495470047,
                            0.7831249833106995,
                            0.7512499690055847,
                            0.7324999570846558
                        ]
                    },
                    "test": {
                        "score": 0.8547021597869056,
                        "pretrain_loss": 0.5660089254379272,
                        "features_accuracy": [
                            0.562000036239624,
                            0.7845000624656677,
                            0.5590000152587891,
                            0.5805000066757202,
                            0.6330000162124634,
                            0.7690000534057617,
                            0.7420000433921814,
                            0.8100000619888306,
                            0.7845000624656677,
                            0.753000020980835,
                            0.7320000529289246
                        ]
                    }
                },
                "70000": {
                    "train": {
                        "score": 0.9100363511379069,
                        "pretrain_loss": 0.5636790990829468,
                        "features_accuracy": [
                            0.5587499737739563,
                            0.7878124713897705,
                            0.5726562142372131,
                            0.5873437523841858,
                            0.6378124952316284,
                            0.7601562142372131,
                            0.7459374666213989,
                            0.8148437142372131,
                            0.7846874594688416,
                            0.7610937356948853,
                            0.71484375
                        ]
                    },
                    "val": {
                        "score": 0.8744161185002552,
                        "pretrain_loss": 0.5639593601226807,
                        "features_accuracy": [
                            0.5581249594688416,
                            0.7849999666213989,
                            0.550000011920929,
                            0.6068750023841858,
                            0.6299999952316284,
                            0.7749999761581421,
                            0.7431249618530273,
                            0.81312495470047,
                            0.7831249833106995,
                            0.75062495470047,
                            0.73499995470047
                        ]
                    },
                    "test": {
                        "score": 0.856060991654212,
                        "pretrain_loss": 0.5654041767120361,
                        "features_accuracy": [
                            0.562000036239624,
                            0.7845000624656677,
                            0.5545000433921814,
                            0.5805000066757202,
                            0.6350000500679016,
                            0.7695000171661377,
                            0.7420000433921814,
                            0.8100000619888306,
                            0.7845000624656677,
                            0.7535000443458557,
                            0.7350000143051147
                        ]
                    }
                },
                "80000": {
                    "train": {
                        "score": 0.9221615232926584,
                        "pretrain_loss": 0.5633161067962646,
                        "features_accuracy": [
                            0.5651562213897705,
                            0.7796874642372131,
                            0.5693749785423279,
                            0.6029687523841858,
                            0.6349999904632568,
                            0.7640624642372131,
                            0.7457812428474426,
                            0.8143749833106995,
                            0.782031238079071,
                            0.7581250071525574,
                            0.7362499833106995
                        ]
                    },
                    "val": {
                        "score": 0.8707659562173148,
                        "pretrain_loss": 0.5638036131858826,
                        "features_accuracy": [
                            0.5581249594688416,
                            0.7849999666213989,
                            0.5512499809265137,
                            0.6068750023841858,
                            0.6293749809265137,
                            0.7749999761581421,
                            0.7431249618530273,
                            0.81312495470047,
                            0.7837499976158142,
                            0.75062495470047,
                            0.7368749976158142
                        ]
                    },
                    "test": {
                        "score": 0.8505022742310878,
                        "pretrain_loss": 0.5663779377937317,
                        "features_accuracy": [
                            0.562000036239624,
                            0.7845000624656677,
                            0.5565000176429749,
                            0.5805000066757202,
                            0.6340000033378601,
                            0.7690000534057617,
                            0.7425000071525574,
                            0.8100000619888306,
                            0.7855000495910645,
                            0.753000020980835,
                            0.7330000400543213
                        ]
                    }
                },
                "90000": {
                    "train": {
                        "score": 0.9093129701148983,
                        "pretrain_loss": 0.5640397667884827,
                        "features_accuracy": [
                            0.5518749952316284,
                            0.7734375,
                            0.574999988079071,
                            0.5973437428474426,
                            0.635937511920929,
                            0.7640624642372131,
                            0.7679687142372131,
                            0.8159374594688416,
                            0.774218738079071,
                            0.7431249618530273,
                            0.725781261920929
                        ]
                    },
                    "val": {
                        "score": 0.8714786528108175,
                        "pretrain_loss": 0.5629989504814148,
                        "features_accuracy": [
                            0.5581249594688416,
                            0.7849999666213989,
                            0.5493749976158142,
                            0.6068750023841858,
                            0.628125011920929,
                            0.7774999737739563,
                            0.7418749928474426,
                            0.81312495470047,
                            0.7837499976158142,
                            0.7518749833106995,
                            0.73499995470047
                        ]
                    },
                    "test": {
                        "score": 0.8552589569538722,
                        "pretrain_loss": 0.5650595426559448,
                        "features_accuracy": [
                            0.562000036239624,
                            0.7845000624656677,
                            0.550000011920929,
                            0.5805000066757202,
                            0.6300000548362732,
                            0.7675000429153442,
                            0.7425000071525574,
                            0.8100000619888306,
                            0.784000039100647,
                            0.7535000443458557,
                            0.7345000505447388
                        ]
                    }
                }
            },
            "train": {
                "score": 0.9073501952692354
            },
            "val": {
                "score": 0.8774330402288333
            },
            "test": {
                "score": 0.8547021597869056
            }
        },
        "best_iteration": 60000,
        "time": "0:06:49",
        "trial_id": 98,
        "tuning_time": "8:44:37"
    },
    "time": "8:52:11",
    "continuations": [
        11,
        30,
        31
    ]
}
