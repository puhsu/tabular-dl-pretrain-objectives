{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/tune.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 0,
        "program": "bin/pretrain_mask.py",
        "base_config": {
            "seed": 0,
            "data": {
                "T_cache": true,
                "path": "data/california",
                "T": {
                    "normalization": "quantile"
                }
            },
            "model": {
                "kind": "mlp"
            },
            "training": {
                "batch_size": 128,
                "patience": 16
            },
            "pretrain": {
                "corrupt_strategy": "resample",
                "patience": 2,
                "d_hidden_head": 512
            }
        },
        "space": {
            "model": {
                "config": {
                    "d_layers": [
                        "$fixed_mlp_d_layers",
                        1,
                        8,
                        512
                    ],
                    "dropout": [
                        "?uniform",
                        0.0,
                        0.0,
                        0.5
                    ]
                }
            },
            "pretrain": {
                "corrupt_probability": [
                    "uniform",
                    0.2,
                    0.8
                ]
            },
            "training": {
                "lr": [
                    "loguniform",
                    5e-05,
                    0.005
                ],
                "weight_decay": [
                    "?loguniform",
                    0.0,
                    1e-06,
                    0.001
                ]
            }
        },
        "n_trials": 100,
        "timeout": null,
        "sampler": {
            "seed": 0
        }
    },
    "best": {
        "program": "bin/pretrain_mask.py",
        "environment": {
            "CUDA_VISIBLE_DEVICES": "0",
            "gpus": {
                "driver": "450.119.04",
                "devices": [
                    {
                        "name": "A100-SXM-80GB",
                        "memory_total": 85199093760,
                        "memory_free": 85195948032,
                        "memory_used": 3145728,
                        "utilization": 0
                    }
                ]
            },
            "torch.version.cuda": "11.1",
            "torch.backends.cudnn.version()": 8005,
            "torch.cuda.nccl.version()": [
                2,
                10,
                3
            ]
        },
        "config": {
            "seed": 0,
            "data": {
                "path": "data/california",
                "T": {
                    "seed": 0,
                    "normalization": "quantile",
                    "num_nan_policy": null,
                    "cat_nan_policy": null,
                    "cat_min_frequency": null,
                    "cat_encoding": null,
                    "y_policy": "default"
                },
                "T_cache": true
            },
            "model": {
                "kind": "mlp",
                "config": {
                    "d_layers": [
                        512,
                        512,
                        512,
                        512
                    ],
                    "dropout": 0.0
                },
                "default": true,
                "checkpoint": null,
                "num_embedding_arch": [],
                "d_num_embedding": null,
                "positional_encoding": null,
                "d_cat_embedding": null
            },
            "training": {
                "batch_size": 128,
                "lr": 0.00022114625812590918,
                "weight_decay": 0.0008346563753758091,
                "optimizer": "AdamW",
                "patience": 16,
                "n_epochs": Infinity,
                "eval_batch_size": 8192
            },
            "pretrain": {
                "corrupt_probability": 0.4537096775322986,
                "corrupt_strategy": "resample",
                "d_hidden_head": 512,
                "lr": 0.00022114625812590918,
                "weight_decay": 0.0008346563753758091,
                "patience": 2,
                "n_iterations": 100000,
                "finetune_every": 10000,
                "replace_strategy": "shuffle",
                "n_neighbors": 20,
                "use_target": false,
                "target_injection_type": "post"
            },
            "bins": null
        },
        "epoch_size": 104,
        "n_parameters": 1059336,
        "metrics": {
            "iteration_scores": {
                "10000": {
                    "train": {
                        "score": -0.35680421615814356,
                        "pretrain_loss": 0.6441658735275269,
                        "features_accuracy": [
                            0.6122341156005859,
                            0.601029634475708,
                            0.6313877105712891,
                            0.5757438540458679,
                            0.5790749192237854,
                            0.5883867144584656,
                            0.6814293265342712,
                            0.6811265349388123
                        ]
                    },
                    "val": {
                        "score": -0.4736106297036929,
                        "pretrain_loss": 0.6484586596488953,
                        "features_accuracy": [
                            0.6209506392478943,
                            0.6052073836326599,
                            0.6164093017578125,
                            0.5749318599700928,
                            0.5673630237579346,
                            0.5937026739120483,
                            0.6702997088432312,
                            0.6815016865730286
                        ]
                    },
                    "test": {
                        "score": -0.47957246354302263,
                        "pretrain_loss": 0.6452789306640625,
                        "features_accuracy": [
                            0.6206395030021667,
                            0.6019864082336426,
                            0.6329941749572754,
                            0.5559592843055725,
                            0.5738856792449951,
                            0.5821220874786377,
                            0.6838662624359131,
                            0.6901647448539734
                        ]
                    }
                },
                "20000": {
                    "train": {
                        "score": -0.3390641914382745,
                        "pretrain_loss": 0.6361069679260254,
                        "features_accuracy": [
                            0.6314634084701538,
                            0.6037550568580627,
                            0.6267696619033813,
                            0.5869483351707458,
                            0.5702173113822937,
                            0.5955030918121338,
                            0.6890756487846375,
                            0.6990688443183899
                        ]
                    },
                    "val": {
                        "score": -0.47052020904417063,
                        "pretrain_loss": 0.6442858576774597,
                        "features_accuracy": [
                            0.6294277906417847,
                            0.6085376739501953,
                            0.6221616864204407,
                            0.5773538947105408,
                            0.5625188946723938,
                            0.6027853488922119,
                            0.6805933713912964,
                            0.687254011631012
                        ]
                    },
                    "test": {
                        "score": -0.47140582853370483,
                        "pretrain_loss": 0.6398317813873291,
                        "features_accuracy": [
                            0.6300871968269348,
                            0.6058623790740967,
                            0.6388081312179565,
                            0.5687984228134155,
                            0.570009708404541,
                            0.5859980583190918,
                            0.6875,
                            0.7017926573753357
                        ]
                    }
                },
                "30000": {
                    "train": {
                        "score": -0.3298574442539468,
                        "pretrain_loss": 0.6323303580284119,
                        "features_accuracy": [
                            0.634340226650238,
                            0.6156408786773682,
                            0.6332046389579773,
                            0.5805889964103699,
                            0.5862669348716736,
                            0.5905064940452576,
                            0.6911954283714294,
                            0.7058823704719543
                        ]
                    },
                    "val": {
                        "score": -0.46551465764607164,
                        "pretrain_loss": 0.6432604193687439,
                        "features_accuracy": [
                            0.6191341280937195,
                            0.6009688377380371,
                            0.6155010461807251,
                            0.5761429071426392,
                            0.5664547085762024,
                            0.5967302322387695,
                            0.6742355227470398,
                            0.6966394186019897
                        ]
                    },
                    "test": {
                        "score": -0.46342943844360357,
                        "pretrain_loss": 0.637246310710907,
                        "features_accuracy": [
                            0.6334787011146545,
                            0.6085271239280701,
                            0.6349321603775024,
                            0.5656492114067078,
                            0.5731589198112488,
                            0.5908430218696594,
                            0.6913759708404541,
                            0.7049418687820435
                        ]
                    }
                },
                "40000": {
                    "train": {
                        "score": -0.3168462323328094,
                        "pretrain_loss": 0.6262993216514587,
                        "features_accuracy": [
                            0.6463775038719177,
                            0.6167007684707642,
                            0.6413052082061768,
                            0.5771065354347229,
                            0.5889923572540283,
                            0.6171550154685974,
                            0.6960406303405762,
                            0.7083806991577148
                        ]
                    },
                    "val": {
                        "score": -0.46861870780263026,
                        "pretrain_loss": 0.6412542462348938,
                        "features_accuracy": [
                            0.6185286045074463,
                            0.6103542447090149,
                            0.6218588948249817,
                            0.5758401155471802,
                            0.5776566863059998,
                            0.6106569766998291,
                            0.677263081073761,
                            0.6939145922660828
                        ]
                    },
                    "test": {
                        "score": -0.46188489837748037,
                        "pretrain_loss": 0.6352198719978333,
                        "features_accuracy": [
                            0.6351743936538696,
                            0.6107073426246643,
                            0.6407461166381836,
                            0.5690407156944275,
                            0.5675871968269348,
                            0.5988371968269348,
                            0.6933139562606812,
                            0.7090600728988647
                        ]
                    }
                },
                "50000": {
                    "train": {
                        "score": -0.313756517960736,
                        "pretrain_loss": 0.6253229379653931,
                        "features_accuracy": [
                            0.6386554837226868,
                            0.6168521642684937,
                            0.641532301902771,
                            0.5920206308364868,
                            0.5968657732009888,
                            0.6068589687347412,
                            0.7011129260063171,
                            0.7114089131355286
                        ]
                    },
                    "val": {
                        "score": -0.45965354679374326,
                        "pretrain_loss": 0.6389357447624207,
                        "features_accuracy": [
                            0.6179230809211731,
                            0.6139872670173645,
                            0.6200423836708069,
                            0.5921888947486877,
                            0.5770511627197266,
                            0.6021798253059387,
                            0.682107150554657,
                            0.6948229074478149
                        ]
                    },
                    "test": {
                        "score": -0.4572699276002771,
                        "pretrain_loss": 0.6342215538024902,
                        "features_accuracy": [
                            0.6380813717842102,
                            0.6068313717842102,
                            0.6429263353347778,
                            0.560562014579773,
                            0.5743701457977295,
                            0.5913274884223938,
                            0.6952519416809082,
                            0.7117248177528381
                        ]
                    }
                },
                "60000": {
                    "train": {
                        "score": -0.32255656245769815,
                        "pretrain_loss": 0.6205280423164368,
                        "features_accuracy": [
                            0.6413052082061768,
                            0.6378227472305298,
                            0.641532301902771,
                            0.5884624123573303,
                            0.5876296758651733,
                            0.606404721736908,
                            0.7085320949554443,
                            0.7181467413902283
                        ]
                    },
                    "val": {
                        "score": -0.4594853785674504,
                        "pretrain_loss": 0.639089047908783,
                        "features_accuracy": [
                            0.6212534308433533,
                            0.6052073836326599,
                            0.6245837211608887,
                            0.5764456391334534,
                            0.5812897086143494,
                            0.6049046516418457,
                            0.6860429644584656,
                            0.6978504657745361
                        ]
                    },
                    "test": {
                        "score": -0.44978366597094227,
                        "pretrain_loss": 0.6338569521903992,
                        "features_accuracy": [
                            0.6385658979415894,
                            0.617732584476471,
                            0.6346899271011353,
                            0.5663759708404541,
                            0.5673449635505676,
                            0.5896317958831787,
                            0.6906492114067078,
                            0.7044573426246643
                        ]
                    }
                },
                "70000": {
                    "train": {
                        "score": -0.30503373238389064,
                        "pretrain_loss": 0.6319212317466736,
                        "features_accuracy": [
                            0.6293436288833618,
                            0.6186690926551819,
                            0.6366870999336243,
                            0.5752896070480347,
                            0.5731698274612427,
                            0.6102657318115234,
                            0.7011129260063171,
                            0.7008100748062134
                        ]
                    },
                    "val": {
                        "score": -0.45792420464013056,
                        "pretrain_loss": 0.638205885887146,
                        "features_accuracy": [
                            0.6297305226325989,
                            0.6021798253059387,
                            0.6227671504020691,
                            0.5858310461044312,
                            0.5728126168251038,
                            0.6094459295272827,
                            0.6869512796401978,
                            0.7087495923042297
                        ]
                    },
                    "test": {
                        "score": -0.4530001743824891,
                        "pretrain_loss": 0.6328490376472473,
                        "features_accuracy": [
                            0.6346899271011353,
                            0.6203972697257996,
                            0.6385658979415894,
                            0.568071722984314,
                            0.570009708404541,
                            0.6017441749572754,
                            0.6962209343910217,
                            0.7122092843055725
                        ]
                    }
                },
                "80000": {
                    "train": {
                        "score": -0.31431872187609294,
                        "pretrain_loss": 0.6276989579200745,
                        "features_accuracy": [
                            0.636989951133728,
                            0.6177606582641602,
                            0.6416836977005005,
                            0.5825573801994324,
                            0.5842986106872559,
                            0.6042092442512512,
                            0.7059580683708191,
                            0.7105004191398621
                        ]
                    },
                    "val": {
                        "score": -0.4583882744815263,
                        "pretrain_loss": 0.6388399600982666,
                        "features_accuracy": [
                            0.6248864531517029,
                            0.6079322099685669,
                            0.6218588948249817,
                            0.5837118029594421,
                            0.5767484307289124,
                            0.6012715697288513,
                            0.6851347088813782,
                            0.7042083144187927
                        ]
                    },
                    "test": {
                        "score": -0.45124869295032644,
                        "pretrain_loss": 0.6320326328277588,
                        "features_accuracy": [
                            0.6380813717842102,
                            0.6182170510292053,
                            0.6349321603775024,
                            0.5637112259864807,
                            0.5731589198112488,
                            0.6058623790740967,
                            0.6964631676673889,
                            0.7122092843055725
                        ]
                    }
                },
                "90000": {
                    "train": {
                        "score": -0.30134047142061104,
                        "pretrain_loss": 0.6243841052055359,
                        "features_accuracy": [
                            0.6416079998016357,
                            0.6241956353187561,
                            0.6462261080741882,
                            0.5781664252281189,
                            0.5858127474784851,
                            0.6036036014556885,
                            0.7145885825157166,
                            0.7127715945243835
                        ]
                    },
                    "val": {
                        "score": -0.4530322742036435,
                        "pretrain_loss": 0.6356915831565857,
                        "features_accuracy": [
                            0.6276112794876099,
                            0.6058129072189331,
                            0.6179230809211731,
                            0.585225522518158,
                            0.5785649418830872,
                            0.6142900586128235,
                            0.6827126741409302,
                            0.7039055228233337
                        ]
                    },
                    "test": {
                        "score": -0.45461907786397204,
                        "pretrain_loss": 0.6309037804603577,
                        "features_accuracy": [
                            0.6400193572044373,
                            0.6184592843055725,
                            0.6407461166381836,
                            0.5683139562606812,
                            0.5721899271011353,
                            0.6044089198112488,
                            0.6904069781303406,
                            0.7102712988853455
                        ]
                    }
                },
                "100000": {
                    "train": {
                        "score": -0.2993336109337612,
                        "pretrain_loss": 0.6213986873626709,
                        "features_accuracy": [
                            0.642062246799469,
                            0.6229086518287659,
                            0.6425164937973022,
                            0.5909607410430908,
                            0.5906578898429871,
                            0.6085245013237,
                            0.7109546661376953,
                            0.7186009883880615
                        ]
                    },
                    "val": {
                        "score": -0.4458738009232293,
                        "pretrain_loss": 0.634793758392334,
                        "features_accuracy": [
                            0.6333636045455933,
                            0.6055101156234741,
                            0.6264002323150635,
                            0.5773538947105408,
                            0.5791704654693604,
                            0.6067211627960205,
                            0.6936118602752686,
                            0.7063275575637817
                        ]
                    },
                    "test": {
                        "score": -0.4477621136027937,
                        "pretrain_loss": 0.6288658976554871,
                        "features_accuracy": [
                            0.637839138507843,
                            0.6155523061752319,
                            0.6468023061752319,
                            0.5704941749572754,
                            0.5833333134651184,
                            0.5973837375640869,
                            0.6952519416809082,
                            0.7136628031730652
                        ]
                    }
                }
            },
            "train": {
                "score": -0.2993336109337612
            },
            "val": {
                "score": -0.4458738009232293
            },
            "test": {
                "score": -0.4477621136027937
            }
        },
        "best_iteration": 100000,
        "time": "0:08:45",
        "trial_id": 13,
        "tuning_time": "2:13:12"
    },
    "time": "14:16:36",
    "continuations": [
        9,
        21,
        22
    ]
}
