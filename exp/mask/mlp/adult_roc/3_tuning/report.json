{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/tune.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 0,
        "program": "bin/pretrain_mask.py",
        "base_config": {
            "seed": 0,
            "data": {
                "T_cache": true,
                "path": "data/adult_roc",
                "T": {
                    "normalization": "quantile"
                }
            },
            "model": {
                "kind": "mlp"
            },
            "training": {
                "batch_size": 256,
                "patience": 16
            },
            "pretrain": {
                "corrupt_strategy": "resample",
                "patience": 2,
                "d_hidden_head": 512
            }
        },
        "space": {
            "model": {
                "config": {
                    "d_layers": [
                        "$fixed_mlp_d_layers",
                        1,
                        8,
                        512
                    ],
                    "dropout": [
                        "?uniform",
                        0.0,
                        0.0,
                        0.5
                    ]
                }
            },
            "pretrain": {
                "corrupt_probability": [
                    "uniform",
                    0.2,
                    0.8
                ]
            },
            "training": {
                "lr": [
                    "loguniform",
                    5e-05,
                    0.005
                ],
                "weight_decay": [
                    "?loguniform",
                    0.0,
                    1e-06,
                    0.001
                ]
            }
        },
        "n_trials": 100,
        "timeout": null,
        "sampler": {
            "seed": 0
        }
    },
    "best": {
        "program": "bin/pretrain_mask.py",
        "environment": {
            "CUDA_VISIBLE_DEVICES": "0",
            "gpus": {
                "driver": "450.119.04",
                "devices": [
                    {
                        "name": "A100-SXM-80GB",
                        "memory_total": 85199093760,
                        "memory_free": 85195948032,
                        "memory_used": 3145728,
                        "utilization": 0
                    }
                ]
            },
            "torch.version.cuda": "11.1",
            "torch.backends.cudnn.version()": 8005,
            "torch.cuda.nccl.version()": [
                2,
                10,
                3
            ]
        },
        "config": {
            "seed": 0,
            "data": {
                "path": "data/adult_roc",
                "T": {
                    "seed": 0,
                    "normalization": "quantile",
                    "num_nan_policy": null,
                    "cat_nan_policy": null,
                    "cat_min_frequency": null,
                    "cat_encoding": null,
                    "y_policy": "default"
                },
                "T_cache": true
            },
            "model": {
                "kind": "mlp",
                "config": {
                    "d_layers": [
                        512,
                        512,
                        512,
                        512,
                        512,
                        512,
                        512
                    ],
                    "dropout": 0.014614005660571399
                },
                "default": true,
                "checkpoint": null,
                "num_embedding_arch": [],
                "d_num_embedding": null,
                "positional_encoding": null,
                "d_cat_embedding": null
            },
            "training": {
                "batch_size": 256,
                "lr": 5.707074773175946e-05,
                "weight_decay": 0.0,
                "optimizer": "AdamW",
                "patience": 16,
                "n_epochs": Infinity,
                "eval_batch_size": 8192
            },
            "pretrain": {
                "corrupt_probability": 0.4729916382759906,
                "corrupt_strategy": "resample",
                "d_hidden_head": 512,
                "lr": 5.707074773175946e-05,
                "weight_decay": 0.0,
                "patience": 2,
                "n_iterations": 100000,
                "finetune_every": 10000,
                "replace_strategy": "shuffle",
                "n_neighbors": 20,
                "use_target": false,
                "target_injection_type": "post"
            },
            "bins": null
        },
        "epoch_size": 102,
        "n_parameters": 1901582,
        "metrics": {
            "iteration_scores": {
                "10000": {
                    "train": {
                        "score": 0.9261575999563074,
                        "pretrain_loss": 0.4631459712982178,
                        "features_accuracy": [
                            0.5629222989082336,
                            0.5262207984924316,
                            0.7242398262023926,
                            0.9295530915260315,
                            0.9604576230049133,
                            0.6403178572654724,
                            0.7898879051208496,
                            0.7299216985702515,
                            0.7582923769950867,
                            0.609375,
                            0.7449707984924316,
                            0.8812576532363892,
                            0.8196022510528564,
                            0.9136977791786194
                        ]
                    },
                    "val": {
                        "score": 0.9141602267802977,
                        "pretrain_loss": 0.46285074949264526,
                        "features_accuracy": [
                            0.5642561316490173,
                            0.5221863985061646,
                            0.7239367365837097,
                            0.9310609698295593,
                            0.9560878276824951,
                            0.6439428925514221,
                            0.7970213294029236,
                            0.730692446231842,
                            0.758790135383606,
                            0.6015660762786865,
                            0.7369875907897949,
                            0.8903731107711792,
                            0.8223552703857422,
                            0.9101796746253967
                        ]
                    },
                    "test": {
                        "score": 0.9117529510187241,
                        "pretrain_loss": 0.46292397379875183,
                        "features_accuracy": [
                            0.5597936511039734,
                            0.5239236354827881,
                            0.722068727016449,
                            0.9290584325790405,
                            0.9601990580558777,
                            0.6412997245788574,
                            0.7872366905212402,
                            0.7363184690475464,
                            0.7562803626060486,
                            0.6105890274047852,
                            0.7387753129005432,
                            0.884036660194397,
                            0.8151834011077881,
                            0.9143787622451782
                        ]
                    }
                },
                "20000": {
                    "train": {
                        "score": 0.9278861566930534,
                        "pretrain_loss": 0.4521354138851166,
                        "features_accuracy": [
                            0.5762438178062439,
                            0.5253762006759644,
                            0.744548499584198,
                            0.9285549521446228,
                            0.9589603543281555,
                            0.6536010503768921,
                            0.7987561225891113,
                            0.7479268908500671,
                            0.7667766809463501,
                            0.6537545919418335,
                            0.7478501200675964,
                            0.8812192678451538,
                            0.8222895860671997,
                            0.9128531813621521
                        ]
                    },
                    "val": {
                        "score": 0.9161448768081552,
                        "pretrain_loss": 0.45164334774017334,
                        "features_accuracy": [
                            0.5773069262504578,
                            0.523107647895813,
                            0.7465069890022278,
                            0.9362812638282776,
                            0.9543988704681396,
                            0.6592968106269836,
                            0.8033164739608765,
                            0.7415937185287476,
                            0.7684630751609802,
                            0.6473207473754883,
                            0.7437433004379272,
                            0.8931367993354797,
                            0.8246583938598633,
                            0.9114079475402832
                        ]
                    },
                    "test": {
                        "score": 0.9121566310179547,
                        "pretrain_loss": 0.45128849148750305,
                        "features_accuracy": [
                            0.5760703086853027,
                            0.5237393379211426,
                            0.7452859282493591,
                            0.9302254319190979,
                            0.9600147604942322,
                            0.6581291556358337,
                            0.7900006771087646,
                            0.7484184503555298,
                            0.7680118083953857,
                            0.6506971716880798,
                            0.7474356889724731,
                            0.8891960382461548,
                            0.8173945546150208,
                            0.9146244525909424
                        ]
                    }
                },
                "30000": {
                    "train": {
                        "score": 0.9284194397235114,
                        "pretrain_loss": 0.44801703095436096,
                        "features_accuracy": [
                            0.5927134156227112,
                            0.5279867649078369,
                            0.750460684299469,
                            0.9290924072265625,
                            0.9624539017677307,
                            0.6620469689369202,
                            0.7951858043670654,
                            0.7561424970626831,
                            0.7755298018455505,
                            0.659589946269989,
                            0.7530328631401062,
                            0.8864020109176636,
                            0.819448709487915,
                            0.9148110747337341
                        ]
                    },
                    "val": {
                        "score": 0.9166864850085636,
                        "pretrain_loss": 0.4476858675479889,
                        "features_accuracy": [
                            0.5938891768455505,
                            0.5229541063308716,
                            0.7468140721321106,
                            0.9356671571731567,
                            0.9548594951629639,
                            0.6662060618400574,
                            0.80531245470047,
                            0.7528020739555359,
                            0.768770158290863,
                            0.6566866040229797,
                            0.7471211552619934,
                            0.8963611125946045,
                            0.822662353515625,
                            0.9126362800598145
                        ]
                    },
                    "test": {
                        "score": 0.9121431129862806,
                        "pretrain_loss": 0.4476499855518341,
                        "features_accuracy": [
                            0.5870646834373474,
                            0.5245378017425537,
                            0.751489520072937,
                            0.933173656463623,
                            0.9598305225372314,
                            0.6668509840965271,
                            0.7931331396102905,
                            0.7529636025428772,
                            0.7700387239456177,
                            0.6631656885147095,
                            0.7492783069610596,
                            0.8869848847389221,
                            0.8181930184364319,
                            0.9149929881095886
                        ]
                    }
                },
                "40000": {
                    "train": {
                        "score": 0.9296701755743666,
                        "pretrain_loss": 0.44482147693634033,
                        "features_accuracy": [
                            0.6000460386276245,
                            0.5281787514686584,
                            0.752418577671051,
                            0.9291307926177979,
                            0.9614173769950867,
                            0.6743319630622864,
                            0.7999078631401062,
                            0.7556818127632141,
                            0.7737638354301453,
                            0.6643503904342651,
                            0.750460684299469,
                            0.8859413266181946,
                            0.8225583434104919,
                            0.9140433073043823
                        ]
                    },
                    "val": {
                        "score": 0.9161279172943192,
                        "pretrain_loss": 0.44483843445777893,
                        "features_accuracy": [
                            0.591432511806488,
                            0.5247965455055237,
                            0.7474282383918762,
                            0.9359742403030396,
                            0.9557807445526123,
                            0.6775679588317871,
                            0.8010133504867554,
                            0.7500383853912354,
                            0.7699984908103943,
                            0.6591432690620422,
                            0.7491171360015869,
                            0.8952863812446594,
                            0.8223552703857422,
                            0.9126362800598145
                        ]
                    },
                    "test": {
                        "score": 0.9127670124899087,
                        "pretrain_loss": 0.4450583755970001,
                        "features_accuracy": [
                            0.5921626687049866,
                            0.5240464806556702,
                            0.7552362084388733,
                            0.9318224191665649,
                            0.9597076773643494,
                            0.6754499673843384,
                            0.7947300672531128,
                            0.7559118270874023,
                            0.7707143425941467,
                            0.6610773801803589,
                            0.7498311400413513,
                            0.889564573764801,
                            0.8173945546150208,
                            0.9165899157524109
                        ]
                    }
                },
                "50000": {
                    "train": {
                        "score": 0.9278226976811301,
                        "pretrain_loss": 0.44141334295272827,
                        "features_accuracy": [
                            0.6122927069664001,
                            0.5280635356903076,
                            0.7552978992462158,
                            0.9322788715362549,
                            0.9615325331687927,
                            0.6819333434104919,
                            0.797911524772644,
                            0.7617475390434265,
                            0.7756449580192566,
                            0.6674216985702515,
                            0.7520346641540527,
                            0.887016236782074,
                            0.8230190277099609,
                            0.9171529412269592
                        ]
                    },
                    "val": {
                        "score": 0.9154032366232641,
                        "pretrain_loss": 0.4432264566421509,
                        "features_accuracy": [
                            0.6021802425384521,
                            0.5247965455055237,
                            0.750652551651001,
                            0.9370489716529846,
                            0.9556272029876709,
                            0.6846307516098022,
                            0.7993244528770447,
                            0.7555658221244812,
                            0.7692307829856873,
                            0.6591432690620422,
                            0.7541839480400085,
                            0.8959004878997803,
                            0.8274220824241638,
                            0.916935384273529
                        ]
                    },
                    "test": {
                        "score": 0.9123878698613967,
                        "pretrain_loss": 0.44319993257522583,
                        "features_accuracy": [
                            0.6001474261283875,
                            0.5242921710014343,
                            0.7560961246490479,
                            0.9337878823280334,
                            0.9597076773643494,
                            0.6785824298858643,
                            0.7963270545005798,
                            0.7589215040206909,
                            0.7715742588043213,
                            0.6650697588920593,
                            0.7495854496955872,
                            0.8909158110618591,
                            0.8193600177764893,
                            0.9175112247467041
                        ]
                    }
                },
                "60000": {
                    "train": {
                        "score": 0.9284008784462054,
                        "pretrain_loss": 0.44011184573173523,
                        "features_accuracy": [
                            0.611678421497345,
                            0.5254914164543152,
                            0.7561041116714478,
                            0.929745078086853,
                            0.9602272510528564,
                            0.6830466985702515,
                            0.8002533912658691,
                            0.7652027010917664,
                            0.7748387455940247,
                            0.6663851141929626,
                            0.7542997598648071,
                            0.8869010806083679,
                            0.8255144357681274,
                            0.921414315700531
                        ]
                    },
                    "val": {
                        "score": 0.9155889529724934,
                        "pretrain_loss": 0.4420664310455322,
                        "features_accuracy": [
                            0.6097036600112915,
                            0.5204974412918091,
                            0.7546445727348328,
                            0.9361277222633362,
                            0.9543988704681396,
                            0.6832488775253296,
                            0.8037770390510559,
                            0.7547981142997742,
                            0.767234742641449,
                            0.6605250835418701,
                            0.7503454685211182,
                            0.8960540294647217,
                            0.8248119354248047,
                            0.9203132390975952
                        ]
                    },
                    "test": {
                        "score": 0.9124007396966566,
                        "pretrain_loss": 0.4420914649963379,
                        "features_accuracy": [
                            0.6053068041801453,
                            0.5234322547912598,
                            0.7571402788162231,
                            0.9349548816680908,
                            0.9594005942344666,
                            0.6777839660644531,
                            0.797125518321991,
                            0.7607026696205139,
                            0.767827570438385,
                            0.6634727716445923,
                            0.7505067586898804,
                            0.8908544182777405,
                            0.8202199339866638,
                            0.9208894371986389
                        ]
                    }
                }
            },
            "train": {
                "score": 0.9284194397235114
            },
            "val": {
                "score": 0.9166864850085636
            },
            "test": {
                "score": 0.9121431129862806
            }
        },
        "best_iteration": 30000,
        "time": "0:07:07",
        "trial_id": 85,
        "tuning_time": "8:46:48"
    },
    "time": "10:03:15",
    "continuations": [
        12,
        29,
        34
    ]
}
