{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised___c5d431054f9e4a49a363cdf2d3d50606.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 12,
        "data": {
            "path": "data/adult_roc",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512,
                    512,
                    512
                ],
                "dropout": 0.0
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "positional",
                "linear",
                "relu"
            ],
            "d_num_embedding": 15,
            "positional_encoding": {
                "n": 127,
                "sigma": 1.597156847774413,
                "trainable": true,
                "initialization": "normal"
            },
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 256,
            "lr": 0.0005455591338039753,
            "weight_decay": 0.00015584561238689073,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.6843458568815967,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.0005455591338039753,
            "weight_decay": 0.00015584561238689073,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post",
            "supervised_weight": 1.0
        },
        "bins": null
    },
    "epoch_size": 102,
    "n_parameters": 918191,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": 0.9452386575178312,
                    "pretrain_loss": 0.9911555647850037,
                    "pretrain_component": 0.6922235488891602,
                    "supervised_component": 0.49557778239250183,
                    "features_accuracy": [
                        0.33000612258911133,
                        0.5688344240188599,
                        0.466024249792099,
                        0.8925061225891113,
                        0.9371928572654724,
                        0.5056818127632141,
                        0.6271882653236389,
                        0.5547834634780884,
                        0.5351274609565735,
                        0.37745699286460876,
                        0.4767736494541168,
                        0.4406864047050476,
                        0.3458614945411682,
                        0.6315647959709167
                    ]
                },
                "val": {
                    "score": 0.926334384866181,
                    "pretrain_loss": 0.998307466506958,
                    "pretrain_component": 0.692297101020813,
                    "supervised_component": 0.499153733253479,
                    "features_accuracy": [
                        0.3310302495956421,
                        0.5601105690002441,
                        0.4658375680446625,
                        0.8892983198165894,
                        0.9329034090042114,
                        0.4999232292175293,
                        0.6315062046051025,
                        0.54337477684021,
                        0.5473667979240417,
                        0.3816981315612793,
                        0.4836480915546417,
                        0.4286811053752899,
                        0.3505297005176544,
                        0.6313526630401611
                    ]
                },
                "test": {
                    "score": 0.9191495412128508,
                    "pretrain_loss": 0.9846200346946716,
                    "pretrain_component": 0.6922821402549744,
                    "supervised_component": 0.4923100173473358,
                    "features_accuracy": [
                        0.32737547159194946,
                        0.5631718039512634,
                        0.46409928798675537,
                        0.8963823318481445,
                        0.9393772482872009,
                        0.5069099068641663,
                        0.6229347586631775,
                        0.5498433709144592,
                        0.5359007716178894,
                        0.3770653009414673,
                        0.4781033396720886,
                        0.42786070704460144,
                        0.3536638021469116,
                        0.6433265805244446
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": 0.9362780628475578,
                    "pretrain_loss": 0.9911767244338989,
                    "pretrain_component": 0.6948692202568054,
                    "supervised_component": 0.49558836221694946,
                    "features_accuracy": [
                        0.34440264105796814,
                        0.6851197481155396,
                        0.5207309722900391,
                        0.8912776112556458,
                        0.9385749101638794,
                        0.4858338236808777,
                        0.35522881150245667,
                        0.5587376952171326,
                        0.5331695079803467,
                        0.3852503001689911,
                        0.47143733501434326,
                        0.29411086440086365,
                        0.3024800419807434,
                        0.1341753602027893
                    ]
                },
                "val": {
                    "score": 0.9269640793627865,
                    "pretrain_loss": 0.9953827261924744,
                    "pretrain_component": 0.6949959993362427,
                    "supervised_component": 0.4976913630962372,
                    "features_accuracy": [
                        0.3399355113506317,
                        0.679717481136322,
                        0.5228005647659302,
                        0.890680193901062,
                        0.9324427843093872,
                        0.4833410084247589,
                        0.35344696044921875,
                        0.54337477684021,
                        0.5380009412765503,
                        0.38139107823371887,
                        0.48011669516563416,
                        0.28788575530052185,
                        0.3058498501777649,
                        0.13849224150180817
                    ]
                },
                "test": {
                    "score": 0.9225853585812109,
                    "pretrain_loss": 0.9861748814582825,
                    "pretrain_component": 0.6949067115783691,
                    "supervised_component": 0.49308744072914124,
                    "features_accuracy": [
                        0.33916836977005005,
                        0.6824519634246826,
                        0.5199926495552063,
                        0.8974264860153198,
                        0.9388244152069092,
                        0.48829928040504456,
                        0.36643943190574646,
                        0.5508261322975159,
                        0.5272403359413147,
                        0.3770653009414673,
                        0.47466373443603516,
                        0.28843438625335693,
                        0.3050181269645691,
                        0.1329156756401062
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": 0.9347505362314723,
                    "pretrain_loss": 0.9950445890426636,
                    "pretrain_component": 0.6967393755912781,
                    "supervised_component": 0.4975222945213318,
                    "features_accuracy": [
                        0.33695483207702637,
                        0.6868857145309448,
                        0.5396575331687927,
                        0.8929668068885803,
                        0.9384597539901733,
                        0.4776182472705841,
                        0.347857803106308,
                        0.5545531511306763,
                        0.5241093039512634,
                        0.38382983207702637,
                        0.47911545634269714,
                        0.29153868556022644,
                        0.3039388656616211,
                        0.1318335384130478
                    ]
                },
                "val": {
                    "score": 0.928077539155197,
                    "pretrain_loss": 1.0011128187179565,
                    "pretrain_component": 0.6969010233879089,
                    "supervised_component": 0.5005564093589783,
                    "features_accuracy": [
                        0.33824658393859863,
                        0.679717481136322,
                        0.538922131061554,
                        0.890680193901062,
                        0.9329034090042114,
                        0.48395517468452454,
                        0.34884077310562134,
                        0.5444495677947998,
                        0.5294027328491211,
                        0.3815446197986603,
                        0.47996315360069275,
                        0.2843543589115143,
                        0.3058498501777649,
                        0.13803163170814514
                    ]
                },
                "test": {
                    "score": 0.9239379981311034,
                    "pretrain_loss": 0.9886467456817627,
                    "pretrain_component": 0.6969525814056396,
                    "supervised_component": 0.49432337284088135,
                    "features_accuracy": [
                        0.3334561884403229,
                        0.6824519634246826,
                        0.5370063781738281,
                        0.8974264860153198,
                        0.9393772482872009,
                        0.4721454679965973,
                        0.359683096408844,
                        0.5511332750320435,
                        0.5225109457969666,
                        0.3772495687007904,
                        0.4755236506462097,
                        0.288495808839798,
                        0.3050181269645691,
                        0.13266998529434204
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": 0.9378421920606503,
                    "pretrain_loss": 0.9882824420928955,
                    "pretrain_component": 0.6977149844169617,
                    "supervised_component": 0.49414122104644775,
                    "features_accuracy": [
                        0.33484336733818054,
                        0.6836225390434265,
                        0.5398879051208496,
                        0.8889741897583008,
                        0.9379222989082336,
                        0.4819563925266266,
                        0.34325090050697327,
                        0.5508292317390442,
                        0.5183123350143433,
                        0.3828316926956177,
                        0.4755067527294159,
                        0.3563421368598938,
                        0.30063727498054504,
                        0.13141123950481415
                    ]
                },
                "val": {
                    "score": 0.9288047992199915,
                    "pretrain_loss": 0.9924125671386719,
                    "pretrain_component": 0.6977361440658569,
                    "supervised_component": 0.49620628356933594,
                    "features_accuracy": [
                        0.3397819697856903,
                        0.679717481136322,
                        0.5321664214134216,
                        0.890680193901062,
                        0.9329034090042114,
                        0.48241978883743286,
                        0.345770001411438,
                        0.5436818599700928,
                        0.523107647895813,
                        0.3823122978210449,
                        0.47535696625709534,
                        0.34530937671661377,
                        0.3058498501777649,
                        0.13803163170814514
                    ]
                },
                "test": {
                    "score": 0.9234145586169245,
                    "pretrain_loss": 0.9830870032310486,
                    "pretrain_component": 0.6978361010551453,
                    "supervised_component": 0.4915435016155243,
                    "features_accuracy": [
                        0.3351759910583496,
                        0.6824519634246826,
                        0.5368220806121826,
                        0.8974264860153198,
                        0.9393772482872009,
                        0.47220689058303833,
                        0.3552607595920563,
                        0.5491677522659302,
                        0.5148946642875671,
                        0.3782937228679657,
                        0.4726368486881256,
                        0.3434678614139557,
                        0.3050181269645691,
                        0.13266998529434204
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": 0.9354996984044354,
                    "pretrain_loss": 0.986586332321167,
                    "pretrain_component": 0.697772741317749,
                    "supervised_component": 0.4932931661605835,
                    "features_accuracy": [
                        0.3457079231739044,
                        0.6855420470237732,
                        0.5342444777488708,
                        0.889703631401062,
                        0.9390355944633484,
                        0.48130375146865845,
                        0.34931662678718567,
                        0.553823709487915,
                        0.5079084634780884,
                        0.3793381452560425,
                        0.48214831948280334,
                        0.3918534815311432,
                        0.29887130856513977,
                        0.12830159068107605
                    ]
                },
                "val": {
                    "score": 0.9281987061761003,
                    "pretrain_loss": 0.9952983260154724,
                    "pretrain_component": 0.6975841522216797,
                    "supervised_component": 0.4976491630077362,
                    "features_accuracy": [
                        0.3479195535182953,
                        0.6794103980064392,
                        0.5390756726264954,
                        0.890680193901062,
                        0.9329034090042114,
                        0.48426225781440735,
                        0.35083678364753723,
                        0.5452172756195068,
                        0.5099032521247864,
                        0.38139107823371887,
                        0.49454936385154724,
                        0.37908798456192017,
                        0.3058498501777649,
                        0.13803163170814514
                    ]
                },
                "test": {
                    "score": 0.9244710874080317,
                    "pretrain_loss": 0.9837329387664795,
                    "pretrain_component": 0.697729229927063,
                    "supervised_component": 0.49186646938323975,
                    "features_accuracy": [
                        0.34187090396881104,
                        0.6815306544303894,
                        0.5384804606437683,
                        0.8974264860153198,
                        0.9393772482872009,
                        0.47159266471862793,
                        0.35913029313087463,
                        0.5502733588218689,
                        0.5044530630111694,
                        0.3780480623245239,
                        0.4784104526042938,
                        0.3757140338420868,
                        0.3050181269645691,
                        0.13266998529434204
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": 0.9402014049738179,
                    "pretrain_loss": 0.9988762140274048,
                    "pretrain_component": 0.7011977434158325,
                    "supervised_component": 0.4994381070137024,
                    "features_accuracy": [
                        0.36259981989860535,
                        0.625115156173706,
                        0.5356649160385132,
                        0.8914695978164673,
                        0.9359259605407715,
                        0.48038235306739807,
                        0.35499846935272217,
                        0.5513666868209839,
                        0.4742014706134796,
                        0.39461761713027954,
                        0.4831848740577698,
                        0.3743857443332672,
                        0.30367013812065125,
                        0.13574938476085663
                    ]
                },
                "val": {
                    "score": 0.9282546790202432,
                    "pretrain_loss": 0.9936215281486511,
                    "pretrain_component": 0.7012181282043457,
                    "supervised_component": 0.49681076407432556,
                    "features_accuracy": [
                        0.3608168363571167,
                        0.6173806190490723,
                        0.5372332334518433,
                        0.890680193901062,
                        0.9310609698295593,
                        0.48257333040237427,
                        0.3542146384716034,
                        0.5450637340545654,
                        0.4704437255859375,
                        0.3972055912017822,
                        0.4899432063102722,
                        0.3669583797454834,
                        0.3058498501777649,
                        0.13803163170814514
                    ]
                },
                "test": {
                    "score": 0.9231711504085415,
                    "pretrain_loss": 0.9829061031341553,
                    "pretrain_component": 0.7014241814613342,
                    "supervised_component": 0.49145305156707764,
                    "features_accuracy": [
                        0.3581475615501404,
                        0.6252687573432922,
                        0.5311713218688965,
                        0.8973650932312012,
                        0.9378417134284973,
                        0.4724525809288025,
                        0.36459678411483765,
                        0.5502119064331055,
                        0.47859469056129456,
                        0.3898409307003021,
                        0.4836926758289337,
                        0.36699220538139343,
                        0.30507954955101013,
                        0.13266998529434204
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": 0.9387454874028178,
                    "pretrain_loss": 0.9871283173561096,
                    "pretrain_component": 0.70082688331604,
                    "supervised_component": 0.4935641586780548,
                    "features_accuracy": [
                        0.332693487405777,
                        0.5059121251106262,
                        0.5226120948791504,
                        0.8899339437484741,
                        0.9399569630622864,
                        0.47842442989349365,
                        0.3582232594490051,
                        0.5588144659996033,
                        0.46583229303359985,
                        0.38475123047828674,
                        0.47827088832855225,
                        0.37519195675849915,
                        0.30608874559402466,
                        0.13329237699508667
                    ]
                },
                "val": {
                    "score": 0.9282958848352284,
                    "pretrain_loss": 0.9952861666679382,
                    "pretrain_component": 0.7008146643638611,
                    "supervised_component": 0.4976430833339691,
                    "features_accuracy": [
                        0.3311837911605835,
                        0.5042223334312439,
                        0.5260248780250549,
                        0.8903731107711792,
                        0.9329034090042114,
                        0.4827268421649933,
                        0.358513742685318,
                        0.5419929623603821,
                        0.4679871201515198,
                        0.3820052146911621,
                        0.49854138493537903,
                        0.362966388463974,
                        0.3056963086128235,
                        0.13803163170814514
                    ]
                },
                "test": {
                    "score": 0.9238651805822937,
                    "pretrain_loss": 0.9830640554428101,
                    "pretrain_component": 0.7009275555610657,
                    "supervised_component": 0.49153202772140503,
                    "features_accuracy": [
                        0.3277440071105957,
                        0.49708250164985657,
                        0.5226337909698486,
                        0.8972422480583191,
                        0.9393772482872009,
                        0.47146981954574585,
                        0.3693876564502716,
                        0.5499662160873413,
                        0.4742951989173889,
                        0.37780237197875977,
                        0.4845525622367859,
                        0.3579018712043762,
                        0.30514097213745117,
                        0.13266998529434204
                    ]
                }
            }
        },
        "train": {
            "score": 0.9378421920606503
        },
        "val": {
            "score": 0.9288047992199915
        },
        "test": {
            "score": 0.9234145586169245
        }
    },
    "best_iteration": 40000,
    "time": "0:07:13"
}
