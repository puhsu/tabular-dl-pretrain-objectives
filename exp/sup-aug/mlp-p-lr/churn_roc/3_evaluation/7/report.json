{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised___68b7559fdcba4c0f97d7e6e53f83eb2d.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 7,
        "data": {
            "path": "data/churn_roc",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512,
                    512,
                    512,
                    512,
                    512,
                    512
                ],
                "dropout": 0.3085549196336293
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "positional",
                "linear",
                "relu"
            ],
            "d_num_embedding": 60,
            "positional_encoding": {
                "n": 1,
                "sigma": 0.01522256003646429,
                "trainable": true,
                "initialization": "normal"
            },
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.002925766775588696,
            "weight_decay": 0.0,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.2713419990009716,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.002925766775588696,
            "weight_decay": 0.0,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post",
            "supervised_weight": 1.0
        },
        "bins": null
    },
    "epoch_size": 50,
    "n_parameters": 1893150,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": 0.876286570845894,
                    "pretrain_loss": 0.8454153537750244,
                    "pretrain_component": 0.6899852156639099,
                    "supervised_component": 0.4227076768875122,
                    "features_accuracy": [
                        0.3682812452316284,
                        0.13109374046325684,
                        0.7337499856948853,
                        0.37937498092651367,
                        0.71156245470047,
                        0.1418749988079071,
                        0.7328124642372131,
                        0.3828125,
                        0.8659374713897705,
                        0.3812499940395355,
                        0.8323437571525574
                    ]
                },
                "val": {
                    "score": 0.8630683514557309,
                    "pretrain_loss": 0.8490251898765564,
                    "pretrain_component": 0.6899366974830627,
                    "supervised_component": 0.4245125949382782,
                    "features_accuracy": [
                        0.3556250035762787,
                        0.1274999976158142,
                        0.7549999952316284,
                        0.3824999928474426,
                        0.7124999761581421,
                        0.14374999701976776,
                        0.7243750095367432,
                        0.39374998211860657,
                        0.8631249666213989,
                        0.40312498807907104,
                        0.8324999809265137
                    ]
                },
                "test": {
                    "score": 0.8575092812380947,
                    "pretrain_loss": 0.8351852297782898,
                    "pretrain_component": 0.6899158954620361,
                    "supervised_component": 0.4175926148891449,
                    "features_accuracy": [
                        0.3800000250339508,
                        0.1315000057220459,
                        0.7095000147819519,
                        0.3915000259876251,
                        0.7240000367164612,
                        0.14150001108646393,
                        0.7345000505447388,
                        0.41100001335144043,
                        0.8700000643730164,
                        0.35500001907348633,
                        0.8405000567436218
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": 0.8785585169650683,
                    "pretrain_loss": 0.8576719760894775,
                    "pretrain_component": 0.6890551447868347,
                    "supervised_component": 0.42883598804473877,
                    "features_accuracy": [
                        0.5132812261581421,
                        0.2254687398672104,
                        0.7278124690055847,
                        0.4568749964237213,
                        0.7237499952316284,
                        0.14890624582767487,
                        0.7326562404632568,
                        0.33031249046325684,
                        0.8643749952316284,
                        0.4087499976158142,
                        0.8267187476158142
                    ]
                },
                "val": {
                    "score": 0.8739153046777937,
                    "pretrain_loss": 0.848434329032898,
                    "pretrain_component": 0.688930869102478,
                    "supervised_component": 0.424217164516449,
                    "features_accuracy": [
                        0.5274999737739563,
                        0.22624999284744263,
                        0.7549999952316284,
                        0.4593749940395355,
                        0.7256249785423279,
                        0.14374999701976776,
                        0.7243750095367432,
                        0.3349999785423279,
                        0.8631249666213989,
                        0.40562498569488525,
                        0.8324999809265137
                    ]
                },
                "test": {
                    "score": 0.8638322451881775,
                    "pretrain_loss": 0.8379839062690735,
                    "pretrain_component": 0.6889699697494507,
                    "supervised_component": 0.41899195313453674,
                    "features_accuracy": [
                        0.5040000081062317,
                        0.23200000822544098,
                        0.7095000147819519,
                        0.46250003576278687,
                        0.7460000514984131,
                        0.14150001108646393,
                        0.7345000505447388,
                        0.3400000035762787,
                        0.8700000643730164,
                        0.3785000145435333,
                        0.8405000567436218
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": 0.875310450395354,
                    "pretrain_loss": 0.8693088293075562,
                    "pretrain_component": 0.6896601319313049,
                    "supervised_component": 0.4346544146537781,
                    "features_accuracy": [
                        0.45140624046325684,
                        0.1407812535762787,
                        0.7051562070846558,
                        0.49140623211860657,
                        0.7178124785423279,
                        0.14421874284744263,
                        0.7192187309265137,
                        0.3504687547683716,
                        0.86328125,
                        0.4178124964237213,
                        0.8259375095367432
                    ]
                },
                "val": {
                    "score": 0.8732098313605763,
                    "pretrain_loss": 0.8582661151885986,
                    "pretrain_component": 0.6894961595535278,
                    "supervised_component": 0.4291330575942993,
                    "features_accuracy": [
                        0.45374998450279236,
                        0.1274999976158142,
                        0.7306249737739563,
                        0.4756249785423279,
                        0.7231249809265137,
                        0.14374999701976776,
                        0.7243750095367432,
                        0.35624998807907104,
                        0.8631249666213989,
                        0.41874998807907104,
                        0.8324999809265137
                    ]
                },
                "test": {
                    "score": 0.8621348621348621,
                    "pretrain_loss": 0.8497841954231262,
                    "pretrain_component": 0.6896053552627563,
                    "supervised_component": 0.4248920977115631,
                    "features_accuracy": [
                        0.4750000238418579,
                        0.1315000057220459,
                        0.6875000596046448,
                        0.4790000319480896,
                        0.7400000095367432,
                        0.14150001108646393,
                        0.7345000505447388,
                        0.32450002431869507,
                        0.8700000643730164,
                        0.3790000081062317,
                        0.8405000567436218
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": 0.8800082134670763,
                    "pretrain_loss": 0.856399655342102,
                    "pretrain_component": 0.690405011177063,
                    "supervised_component": 0.428199827671051,
                    "features_accuracy": [
                        0.2784374952316284,
                        0.13640624284744263,
                        0.7478125095367432,
                        0.6526562571525574,
                        0.7017187476158142,
                        0.15078124403953552,
                        0.7254687547683716,
                        0.13906249403953552,
                        0.8637499809265137,
                        0.3493749797344208,
                        0.8295312523841858
                    ]
                },
                "val": {
                    "score": 0.8748446995598617,
                    "pretrain_loss": 0.8460642695426941,
                    "pretrain_component": 0.6903455853462219,
                    "supervised_component": 0.42303213477134705,
                    "features_accuracy": [
                        0.2862499952316284,
                        0.1274999976158142,
                        0.7549999952316284,
                        0.6775000095367432,
                        0.6981250047683716,
                        0.14374999701976776,
                        0.7243750095367432,
                        0.1431249976158142,
                        0.8631249666213989,
                        0.3656249940395355,
                        0.8312499523162842
                    ]
                },
                "test": {
                    "score": 0.8639101350965758,
                    "pretrain_loss": 0.8402402997016907,
                    "pretrain_component": 0.6903883218765259,
                    "supervised_component": 0.42012014985084534,
                    "features_accuracy": [
                        0.28450000286102295,
                        0.1315000057220459,
                        0.7095000147819519,
                        0.6525000333786011,
                        0.7120000123977661,
                        0.14150001108646393,
                        0.7345000505447388,
                        0.13350000977516174,
                        0.8700000643730164,
                        0.3290000259876251,
                        0.8405000567436218
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": 0.8782014162437036,
                    "pretrain_loss": 0.8427558541297913,
                    "pretrain_component": 0.688696563243866,
                    "supervised_component": 0.42137792706489563,
                    "features_accuracy": [
                        0.2735937535762787,
                        0.1395312398672104,
                        0.7498437166213989,
                        0.5220312476158142,
                        0.7590624690055847,
                        0.14624999463558197,
                        0.7285937070846558,
                        0.12890625,
                        0.860156238079071,
                        0.33421874046325684,
                        0.8368749618530273
                    ]
                },
                "val": {
                    "score": 0.8739706831293159,
                    "pretrain_loss": 0.8400881886482239,
                    "pretrain_component": 0.6887187361717224,
                    "supervised_component": 0.42004409432411194,
                    "features_accuracy": [
                        0.2762500047683716,
                        0.1274999976158142,
                        0.7549999952316284,
                        0.5231249928474426,
                        0.7568749785423279,
                        0.14374999701976776,
                        0.7243750095367432,
                        0.1393750011920929,
                        0.8631249666213989,
                        0.3493749797344208,
                        0.8324999809265137
                    ]
                },
                "test": {
                    "score": 0.8630957614008462,
                    "pretrain_loss": 0.8328684568405151,
                    "pretrain_component": 0.6888312101364136,
                    "supervised_component": 0.41643422842025757,
                    "features_accuracy": [
                        0.27650001645088196,
                        0.1315000057220459,
                        0.7095000147819519,
                        0.5105000138282776,
                        0.7770000100135803,
                        0.14150001108646393,
                        0.7345000505447388,
                        0.1315000057220459,
                        0.8700000643730164,
                        0.31550002098083496,
                        0.8405000567436218
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": 0.875389530222188,
                    "pretrain_loss": 0.8345791697502136,
                    "pretrain_component": 0.6890215873718262,
                    "supervised_component": 0.4172895848751068,
                    "features_accuracy": [
                        0.3762499988079071,
                        0.13609375059604645,
                        0.74609375,
                        0.5562499761581421,
                        0.7301562428474426,
                        0.1457812488079071,
                        0.7303124666213989,
                        0.2942187488079071,
                        0.8614062070846558,
                        0.29249998927116394,
                        0.8021875023841858
                    ]
                },
                "val": {
                    "score": 0.8722431162177,
                    "pretrain_loss": 0.8393048048019409,
                    "pretrain_component": 0.6890486478805542,
                    "supervised_component": 0.41965240240097046,
                    "features_accuracy": [
                        0.3856250047683716,
                        0.1274999976158142,
                        0.7549999952316284,
                        0.5587499737739563,
                        0.7274999618530273,
                        0.14374999701976776,
                        0.7243750095367432,
                        0.2906250059604645,
                        0.8631249666213989,
                        0.31062498688697815,
                        0.8018749952316284
                    ]
                },
                "test": {
                    "score": 0.8601799025527839,
                    "pretrain_loss": 0.8330899477005005,
                    "pretrain_component": 0.6891815066337585,
                    "supervised_component": 0.41654497385025024,
                    "features_accuracy": [
                        0.3680000305175781,
                        0.1315000057220459,
                        0.7095000147819519,
                        0.5265000462532043,
                        0.7390000224113464,
                        0.14150001108646393,
                        0.7345000505447388,
                        0.30150002241134644,
                        0.8700000643730164,
                        0.2815000116825104,
                        0.8090000152587891
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": 0.873886712542497,
                    "pretrain_loss": 0.8455256223678589,
                    "pretrain_component": 0.6889199614524841,
                    "supervised_component": 0.42276281118392944,
                    "features_accuracy": [
                        0.5517187118530273,
                        0.1404687464237213,
                        0.7426562309265137,
                        0.4764062464237213,
                        0.7504687309265137,
                        0.14546874165534973,
                        0.7282812595367432,
                        0.2549999952316284,
                        0.8634374737739563,
                        0.2760937511920929,
                        0.8376562595367432
                    ]
                },
                "val": {
                    "score": 0.8733085494698116,
                    "pretrain_loss": 0.8456792831420898,
                    "pretrain_component": 0.6889456510543823,
                    "supervised_component": 0.4228396415710449,
                    "features_accuracy": [
                        0.528124988079071,
                        0.1274999976158142,
                        0.7549999952316284,
                        0.4743749797344208,
                        0.7568749785423279,
                        0.14374999701976776,
                        0.7243750095367432,
                        0.26124998927116394,
                        0.8631249666213989,
                        0.2787500023841858,
                        0.8324999809265137
                    ]
                },
                "test": {
                    "score": 0.8610305220474712,
                    "pretrain_loss": 0.837807297706604,
                    "pretrain_component": 0.6889402866363525,
                    "supervised_component": 0.418903648853302,
                    "features_accuracy": [
                        0.5435000061988831,
                        0.1315000057220459,
                        0.7095000147819519,
                        0.468500018119812,
                        0.7770000100135803,
                        0.14150001108646393,
                        0.7345000505447388,
                        0.24750001728534698,
                        0.8700000643730164,
                        0.2600000202655792,
                        0.8405000567436218
                    ]
                }
            }
        },
        "train": {
            "score": 0.8800082134670763
        },
        "val": {
            "score": 0.8748446995598617
        },
        "test": {
            "score": 0.8639101350965758
        }
    },
    "best_iteration": 40000,
    "time": "0:08:52"
}
