{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised___68b7559fdcba4c0f97d7e6e53f83eb2d.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 14,
        "data": {
            "path": "data/churn_roc",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512,
                    512,
                    512,
                    512,
                    512,
                    512
                ],
                "dropout": 0.3085549196336293
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "positional",
                "linear",
                "relu"
            ],
            "d_num_embedding": 60,
            "positional_encoding": {
                "n": 1,
                "sigma": 0.01522256003646429,
                "trainable": true,
                "initialization": "normal"
            },
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.002925766775588696,
            "weight_decay": 0.0,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.2713419990009716,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.002925766775588696,
            "weight_decay": 0.0,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post",
            "supervised_weight": 1.0
        },
        "bins": null
    },
    "epoch_size": 50,
    "n_parameters": 1893150,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": 0.8783111949947512,
                    "pretrain_loss": 0.8395388126373291,
                    "pretrain_component": 0.6956523060798645,
                    "supervised_component": 0.41976940631866455,
                    "features_accuracy": [
                        0.41015625,
                        0.2239062488079071,
                        0.5095312595367432,
                        0.2512499988079071,
                        0.6876562237739563,
                        0.8626562356948853,
                        0.27171874046325684,
                        0.16312499344348907,
                        0.21281249821186066,
                        0.7334374785423279,
                        0.8314062356948853
                    ]
                },
                "val": {
                    "score": 0.8662514085388757,
                    "pretrain_loss": 0.8492928743362427,
                    "pretrain_component": 0.6958298683166504,
                    "supervised_component": 0.42464643716812134,
                    "features_accuracy": [
                        0.4274999797344208,
                        0.21812500059604645,
                        0.5131250023841858,
                        0.2331250011920929,
                        0.7024999856948853,
                        0.8481249809265137,
                        0.26249998807907104,
                        0.1668749898672104,
                        0.22062499821186066,
                        0.7331249713897705,
                        0.8324999809265137
                    ]
                },
                "test": {
                    "score": 0.8585380449787229,
                    "pretrain_loss": 0.8367364406585693,
                    "pretrain_component": 0.6957736611366272,
                    "supervised_component": 0.41836822032928467,
                    "features_accuracy": [
                        0.39900001883506775,
                        0.21150000393390656,
                        0.5125000476837158,
                        0.24150000512599945,
                        0.6965000033378601,
                        0.8615000247955322,
                        0.27400001883506775,
                        0.17600001394748688,
                        0.23400001227855682,
                        0.7270000576972961,
                        0.8280000686645508
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": 0.8773201012944111,
                    "pretrain_loss": 0.8535706996917725,
                    "pretrain_component": 0.6950724720954895,
                    "supervised_component": 0.42678534984588623,
                    "features_accuracy": [
                        0.6065624952316284,
                        0.21031250059604645,
                        0.35468748211860657,
                        0.25484374165534973,
                        0.4493750035762787,
                        0.8528124690055847,
                        0.2706249952316284,
                        0.10890624672174454,
                        0.2357812374830246,
                        0.5839062333106995,
                        0.8146874904632568
                    ]
                },
                "val": {
                    "score": 0.8670893085879939,
                    "pretrain_loss": 0.8645870089530945,
                    "pretrain_component": 0.6953284740447998,
                    "supervised_component": 0.43229350447654724,
                    "features_accuracy": [
                        0.5987499952316284,
                        0.20874999463558197,
                        0.3712500035762787,
                        0.2331250011920929,
                        0.44624999165534973,
                        0.8481249809265137,
                        0.26249998807907104,
                        0.11187499761581421,
                        0.2306249886751175,
                        0.5806249976158142,
                        0.8112499713897705
                    ]
                },
                "test": {
                    "score": 0.8617739465197092,
                    "pretrain_loss": 0.8406395316123962,
                    "pretrain_component": 0.6951033473014832,
                    "supervised_component": 0.4203197658061981,
                    "features_accuracy": [
                        0.5830000042915344,
                        0.19950000941753387,
                        0.3840000033378601,
                        0.24150000512599945,
                        0.453000009059906,
                        0.8615000247955322,
                        0.27400001883506775,
                        0.11500000208616257,
                        0.2410000115633011,
                        0.5820000171661377,
                        0.8055000305175781
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": 0.8807758370573336,
                    "pretrain_loss": 0.8401758670806885,
                    "pretrain_component": 0.6944676041603088,
                    "supervised_component": 0.42008793354034424,
                    "features_accuracy": [
                        0.46828123927116394,
                        0.3360937535762787,
                        0.28578123450279236,
                        0.24312499165534973,
                        0.5495312213897705,
                        0.8540624976158142,
                        0.25968748331069946,
                        0.11406249552965164,
                        0.23796874284744263,
                        0.5278124809265137,
                        0.8293749690055847
                    ]
                },
                "val": {
                    "score": 0.8722611744084137,
                    "pretrain_loss": 0.851702094078064,
                    "pretrain_component": 0.6946326494216919,
                    "supervised_component": 0.425851047039032,
                    "features_accuracy": [
                        0.4793749749660492,
                        0.35499998927116394,
                        0.28062498569488525,
                        0.2331250011920929,
                        0.5512499809265137,
                        0.8481249809265137,
                        0.26249998807907104,
                        0.11187499761581421,
                        0.23250000178813934,
                        0.5318750143051147,
                        0.8318749666213989
                    ]
                },
                "test": {
                    "score": 0.8553676943507451,
                    "pretrain_loss": 0.8195483088493347,
                    "pretrain_component": 0.6944319009780884,
                    "supervised_component": 0.40977415442466736,
                    "features_accuracy": [
                        0.48100003600120544,
                        0.34550002217292786,
                        0.30100002884864807,
                        0.24150000512599945,
                        0.5575000047683716,
                        0.8615000247955322,
                        0.27400001883506775,
                        0.11500000208616257,
                        0.24550001323223114,
                        0.5205000042915344,
                        0.8280000686645508
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": 0.8739593967601198,
                    "pretrain_loss": 0.8422081470489502,
                    "pretrain_component": 0.6938413977622986,
                    "supervised_component": 0.4211040735244751,
                    "features_accuracy": [
                        0.6645312309265137,
                        0.4996874928474426,
                        0.2576562464237213,
                        0.25687500834465027,
                        0.5162500143051147,
                        0.8596875071525574,
                        0.2645312547683716,
                        0.11406249552965164,
                        0.5924999713897705,
                        0.5815624594688416,
                        0.8315624594688416
                    ]
                },
                "val": {
                    "score": 0.8695801350271114,
                    "pretrain_loss": 0.8536111116409302,
                    "pretrain_component": 0.694074273109436,
                    "supervised_component": 0.4268055558204651,
                    "features_accuracy": [
                        0.659375011920929,
                        0.4937499761581421,
                        0.2668749988079071,
                        0.2331250011920929,
                        0.5318750143051147,
                        0.8481249809265137,
                        0.26249998807907104,
                        0.11187499761581421,
                        0.5806249976158142,
                        0.5743749737739563,
                        0.8324999809265137
                    ]
                },
                "test": {
                    "score": 0.8637150247319738,
                    "pretrain_loss": 0.8315126299858093,
                    "pretrain_component": 0.6939108371734619,
                    "supervised_component": 0.41575631499290466,
                    "features_accuracy": [
                        0.6625000238418579,
                        0.4975000321865082,
                        0.2824999988079071,
                        0.24150000512599945,
                        0.4960000216960907,
                        0.8615000247955322,
                        0.27400001883506775,
                        0.11500000208616257,
                        0.5705000162124634,
                        0.5740000009536743,
                        0.8280000686645508
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": 0.8744189024713236,
                    "pretrain_loss": 0.846331000328064,
                    "pretrain_component": 0.6953499913215637,
                    "supervised_component": 0.423165500164032,
                    "features_accuracy": [
                        0.36531248688697815,
                        0.469062477350235,
                        0.25999999046325684,
                        0.24296873807907104,
                        0.4637499749660492,
                        0.8545312285423279,
                        0.2942187488079071,
                        0.11562499403953552,
                        0.6090624928474426,
                        0.6695312261581421,
                        0.8034374713897705
                    ]
                },
                "val": {
                    "score": 0.8686290703161867,
                    "pretrain_loss": 0.8563798069953918,
                    "pretrain_component": 0.6954783201217651,
                    "supervised_component": 0.4281899034976959,
                    "features_accuracy": [
                        0.3725000023841858,
                        0.47062498331069946,
                        0.2668749988079071,
                        0.2331250011920929,
                        0.4437499940395355,
                        0.8481249809265137,
                        0.28125,
                        0.11187499761581421,
                        0.6181249618530273,
                        0.671875,
                        0.8056249618530273
                    ]
                },
                "test": {
                    "score": 0.8598328683074447,
                    "pretrain_loss": 0.8314042091369629,
                    "pretrain_component": 0.6952831149101257,
                    "supervised_component": 0.41570210456848145,
                    "features_accuracy": [
                        0.35850000381469727,
                        0.4645000100135803,
                        0.2824999988079071,
                        0.24150000512599945,
                        0.460500031709671,
                        0.8615000247955322,
                        0.3060000240802765,
                        0.11500000208616257,
                        0.6070000529289246,
                        0.6570000052452087,
                        0.7980000376701355
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": 0.8778987158218644,
                    "pretrain_loss": 0.8355700373649597,
                    "pretrain_component": 0.6951131820678711,
                    "supervised_component": 0.41778501868247986,
                    "features_accuracy": [
                        0.4099999964237213,
                        0.690625011920929,
                        0.26749998331069946,
                        0.24718749523162842,
                        0.4090625047683716,
                        0.8449999690055847,
                        0.36765623092651367,
                        0.11390624940395355,
                        0.5620312094688416,
                        0.7176562547683716,
                        0.7057812213897705
                    ]
                },
                "val": {
                    "score": 0.8727944929741599,
                    "pretrain_loss": 0.8519255518913269,
                    "pretrain_component": 0.6952550411224365,
                    "supervised_component": 0.42596277594566345,
                    "features_accuracy": [
                        0.4256249964237213,
                        0.6918749809265137,
                        0.26874998211860657,
                        0.2331250011920929,
                        0.37562498450279236,
                        0.8481249809265137,
                        0.3568750023841858,
                        0.11187499761581421,
                        0.5637499690055847,
                        0.7337499856948853,
                        0.6912499666213989
                    ]
                },
                "test": {
                    "score": 0.8595814612763766,
                    "pretrain_loss": 0.8279397487640381,
                    "pretrain_component": 0.6950963139533997,
                    "supervised_component": 0.41396987438201904,
                    "features_accuracy": [
                        0.406000018119812,
                        0.6915000081062317,
                        0.28300002217292786,
                        0.24150000512599945,
                        0.4050000309944153,
                        0.8615000247955322,
                        0.3785000145435333,
                        0.11500000208616257,
                        0.5665000081062317,
                        0.7270000576972961,
                        0.690000057220459
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": 0.8789113288661383,
                    "pretrain_loss": 0.8451181054115295,
                    "pretrain_component": 0.6956304907798767,
                    "supervised_component": 0.42255905270576477,
                    "features_accuracy": [
                        0.5323437452316284,
                        0.14249999821186066,
                        0.2640624940395355,
                        0.24953123927116394,
                        0.5835937261581421,
                        0.8590624928474426,
                        0.27671873569488525,
                        0.11390624940395355,
                        0.31187498569488525,
                        0.7282812595367432,
                        0.7571874856948853
                    ]
                },
                "val": {
                    "score": 0.8715195847097688,
                    "pretrain_loss": 0.8540164232254028,
                    "pretrain_component": 0.6958609819412231,
                    "supervised_component": 0.4270082116127014,
                    "features_accuracy": [
                        0.49812498688697815,
                        0.1525000035762787,
                        0.2668749988079071,
                        0.2331250011920929,
                        0.590624988079071,
                        0.8481249809265137,
                        0.26249998807907104,
                        0.11187499761581421,
                        0.32999998331069946,
                        0.7337499856948853,
                        0.7612499594688416
                    ]
                },
                "test": {
                    "score": 0.8624279132753709,
                    "pretrain_loss": 0.8366295695304871,
                    "pretrain_component": 0.6956748962402344,
                    "supervised_component": 0.41831478476524353,
                    "features_accuracy": [
                        0.5190000534057617,
                        0.13850000500679016,
                        0.2824999988079071,
                        0.24150000512599945,
                        0.5745000243186951,
                        0.8615000247955322,
                        0.27400001883506775,
                        0.11500000208616257,
                        0.32500001788139343,
                        0.7270000576972961,
                        0.7455000281333923
                    ]
                }
            },
            "80000": {
                "train": {
                    "score": 0.8735733276911519,
                    "pretrain_loss": 0.8492524027824402,
                    "pretrain_component": 0.696060299873352,
                    "supervised_component": 0.4246262013912201,
                    "features_accuracy": [
                        0.6946874856948853,
                        0.13609375059604645,
                        0.26765623688697815,
                        0.23624999821186066,
                        0.5718749761581421,
                        0.8551562428474426,
                        0.2603124976158142,
                        0.11531249433755875,
                        0.4985937476158142,
                        0.727343738079071,
                        0.5368750095367432
                    ]
                },
                "val": {
                    "score": 0.86840996426886,
                    "pretrain_loss": 0.8575958013534546,
                    "pretrain_component": 0.6960863471031189,
                    "supervised_component": 0.4287979006767273,
                    "features_accuracy": [
                        0.6918749809265137,
                        0.140625,
                        0.2668749988079071,
                        0.2331250011920929,
                        0.5843749642372131,
                        0.8481249809265137,
                        0.26249998807907104,
                        0.11187499761581421,
                        0.4856249988079071,
                        0.7337499856948853,
                        0.5543749928474426
                    ]
                },
                "test": {
                    "score": 0.8612904121378697,
                    "pretrain_loss": 0.8407789468765259,
                    "pretrain_component": 0.6959640383720398,
                    "supervised_component": 0.42038947343826294,
                    "features_accuracy": [
                        0.6910000443458557,
                        0.1275000125169754,
                        0.2824999988079071,
                        0.24150000512599945,
                        0.5740000009536743,
                        0.8615000247955322,
                        0.27400001883506775,
                        0.11500000208616257,
                        0.49500003457069397,
                        0.7270000576972961,
                        0.5290000438690186
                    ]
                }
            },
            "90000": {
                "train": {
                    "score": 0.8769426851084936,
                    "pretrain_loss": 0.8578936457633972,
                    "pretrain_component": 0.6961972713470459,
                    "supervised_component": 0.4289468228816986,
                    "features_accuracy": [
                        0.7265625,
                        0.1443749964237213,
                        0.27015623450279236,
                        0.24531249701976776,
                        0.5501562356948853,
                        0.8565624952316284,
                        0.2732812464237213,
                        0.1146874949336052,
                        0.3489062488079071,
                        0.7385937571525574,
                        0.6032812595367432
                    ]
                },
                "val": {
                    "score": 0.8691383112943148,
                    "pretrain_loss": 0.8671173453330994,
                    "pretrain_component": 0.6965462565422058,
                    "supervised_component": 0.4335586726665497,
                    "features_accuracy": [
                        0.7131249904632568,
                        0.140625,
                        0.2668749988079071,
                        0.2331250011920929,
                        0.5337499976158142,
                        0.8481249809265137,
                        0.26249998807907104,
                        0.11187499761581421,
                        0.36374998092651367,
                        0.7337499856948853,
                        0.6056249737739563
                    ]
                },
                "test": {
                    "score": 0.8658566116193234,
                    "pretrain_loss": 0.8443422317504883,
                    "pretrain_component": 0.6963445544242859,
                    "supervised_component": 0.42217111587524414,
                    "features_accuracy": [
                        0.7125000357627869,
                        0.1275000125169754,
                        0.2824999988079071,
                        0.24150000512599945,
                        0.5415000319480896,
                        0.8615000247955322,
                        0.27400001883506775,
                        0.11500000208616257,
                        0.3540000021457672,
                        0.7270000576972961,
                        0.6165000200271606
                    ]
                }
            }
        },
        "train": {
            "score": 0.8778987158218644
        },
        "val": {
            "score": 0.8727944929741599
        },
        "test": {
            "score": 0.8595814612763766
        }
    },
    "best_iteration": 60000,
    "time": "0:10:47"
}
