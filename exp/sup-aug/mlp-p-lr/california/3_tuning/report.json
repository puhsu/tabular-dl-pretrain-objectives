{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/tune.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 0,
        "program": "bin/pretrain_mask_supervised.py",
        "base_config": {
            "seed": 0,
            "data": {
                "T_cache": true,
                "path": "data/california",
                "T": {
                    "normalization": "quantile"
                }
            },
            "model": {
                "kind": "mlp",
                "num_embedding_arch": [
                    "positional",
                    "linear",
                    "relu"
                ],
                "positional_encoding": {
                    "trainable": true,
                    "initialization": "normal"
                }
            },
            "training": {
                "batch_size": 128,
                "patience": 16
            },
            "pretrain": {
                "corrupt_strategy": "resample",
                "patience": 2,
                "d_hidden_head": 512,
                "replace_strategy": "shuffle",
                "use_target": false,
                "supervised_weight": 1.0
            }
        },
        "space": {
            "model": {
                "d_num_embedding": [
                    "int",
                    1,
                    128
                ],
                "config": {
                    "d_layers": [
                        "$fixed_mlp_d_layers",
                        1,
                        8,
                        512
                    ],
                    "dropout": [
                        "?uniform",
                        0.0,
                        0.0,
                        0.5
                    ]
                },
                "positional_encoding": {
                    "n": [
                        "int",
                        1,
                        128
                    ],
                    "sigma": [
                        "loguniform",
                        0.01,
                        100.0
                    ]
                }
            },
            "pretrain": {
                "corrupt_probability": [
                    "uniform",
                    0.2,
                    0.8
                ]
            },
            "training": {
                "lr": [
                    "loguniform",
                    5e-05,
                    0.005
                ],
                "weight_decay": [
                    "?loguniform",
                    0.0,
                    1e-06,
                    0.001
                ]
            }
        },
        "n_trials": 100,
        "timeout": null,
        "sampler": {
            "seed": 0
        }
    },
    "best": {
        "program": "bin/pretrain_mask_supervised.py",
        "environment": {
            "CUDA_VISIBLE_DEVICES": "0",
            "gpus": {
                "driver": "450.119.04",
                "devices": [
                    {
                        "name": "A100-SXM-80GB",
                        "memory_total": 85199093760,
                        "memory_free": 85195948032,
                        "memory_used": 3145728,
                        "utilization": 0
                    }
                ]
            },
            "torch.version.cuda": "11.1",
            "torch.backends.cudnn.version()": 8005,
            "torch.cuda.nccl.version()": [
                2,
                10,
                3
            ]
        },
        "config": {
            "seed": 0,
            "data": {
                "path": "data/california",
                "T": {
                    "seed": 0,
                    "normalization": "quantile",
                    "num_nan_policy": null,
                    "cat_nan_policy": null,
                    "cat_min_frequency": null,
                    "cat_encoding": null,
                    "y_policy": "default"
                },
                "T_cache": true
            },
            "model": {
                "kind": "mlp",
                "config": {
                    "d_layers": [
                        512,
                        512
                    ],
                    "dropout": 0.0
                },
                "default": true,
                "checkpoint": null,
                "num_embedding_arch": [
                    "positional",
                    "linear",
                    "relu"
                ],
                "d_num_embedding": 126,
                "positional_encoding": {
                    "n": 43,
                    "sigma": 0.021371444170736765,
                    "trainable": true,
                    "initialization": "normal"
                },
                "d_cat_embedding": null
            },
            "training": {
                "batch_size": 128,
                "lr": 0.0001093080842538706,
                "weight_decay": 1.4529840437784787e-06,
                "optimizer": "AdamW",
                "patience": 16,
                "n_epochs": Infinity,
                "eval_batch_size": 8192
            },
            "pretrain": {
                "corrupt_probability": 0.42184426713203266,
                "corrupt_strategy": "resample",
                "d_hidden_head": 512,
                "lr": 0.0001093080842538706,
                "weight_decay": 1.4529840437784787e-06,
                "patience": 2,
                "n_iterations": 100000,
                "validate_every": 10000,
                "replace_strategy": "shuffle",
                "n_neighbors": 20,
                "use_target": false,
                "early_stop_type": "finetune",
                "target_injection_type": "post",
                "supervised_weight": 1.0
            },
            "bins": null
        },
        "epoch_size": 104,
        "n_parameters": 1134577,
        "metrics": {
            "iteration_scores": {
                "10000": {
                    "train": {
                        "score": -0.36863454017222663,
                        "pretrain_loss": 1.2337610721588135,
                        "pretrain_component": 0.6941824555397034,
                        "supervised_component": 0.6168805360794067,
                        "features_accuracy": [
                            0.5717313885688782,
                            0.46195778250694275,
                            0.42266637086868286,
                            0.5794534087181091,
                            0.4276629686355591,
                            0.458172470331192,
                            0.4140358865261078,
                            0.4402301609516144
                        ]
                    },
                    "val": {
                        "score": -0.4611586649396,
                        "pretrain_loss": 1.2741190195083618,
                        "pretrain_component": 0.6941524744033813,
                        "supervised_component": 0.6370595097541809,
                        "features_accuracy": [
                            0.5728126168251038,
                            0.48107782006263733,
                            0.41447168588638306,
                            0.5800787210464478,
                            0.42597639560699463,
                            0.46563729643821716,
                            0.41083863377571106,
                            0.4511050581932068
                        ]
                    },
                    "test": {
                        "score": -0.45309095184856973,
                        "pretrain_loss": 1.2535388469696045,
                        "pretrain_component": 0.6941531896591187,
                        "supervised_component": 0.6267694234848022,
                        "features_accuracy": [
                            0.5755813717842102,
                            0.4583333432674408,
                            0.4229651093482971,
                            0.5775193572044373,
                            0.4319283068180084,
                            0.455910861492157,
                            0.41618216037750244,
                            0.44064921140670776
                        ]
                    }
                },
                "20000": {
                    "train": {
                        "score": -0.34070699915571584,
                        "pretrain_loss": 1.202966570854187,
                        "pretrain_component": 0.694256067276001,
                        "supervised_component": 0.6014832854270935,
                        "features_accuracy": [
                            0.5802105069160461,
                            0.4537058174610138,
                            0.4252403676509857,
                            0.5836172699928284,
                            0.4247104525566101,
                            0.5083655118942261,
                            0.41857826709747314,
                            0.43129685521125793
                        ]
                    },
                    "val": {
                        "score": -0.4546993354084464,
                        "pretrain_loss": 1.2460063695907593,
                        "pretrain_component": 0.6943641901016235,
                        "supervised_component": 0.6230031847953796,
                        "features_accuracy": [
                            0.5728126168251038,
                            0.4610959589481354,
                            0.41447168588638306,
                            0.5788676738739014,
                            0.4287011921405792,
                            0.5207387208938599,
                            0.41628822684288025,
                            0.4411141276359558
                        ]
                    },
                    "test": {
                        "score": -0.4485515667385292,
                        "pretrain_loss": 1.217423915863037,
                        "pretrain_component": 0.6943488121032715,
                        "supervised_component": 0.6087119579315186,
                        "features_accuracy": [
                            0.5741279125213623,
                            0.4430716931819916,
                            0.4229651093482971,
                            0.5772771239280701,
                            0.4353197515010834,
                            0.5191376209259033,
                            0.4193314015865326,
                            0.4205426275730133
                        ]
                    }
                },
                "30000": {
                    "train": {
                        "score": -0.3584925739888766,
                        "pretrain_loss": 1.2051512002944946,
                        "pretrain_component": 0.6944895386695862,
                        "supervised_component": 0.6025756001472473,
                        "features_accuracy": [
                            0.5690060257911682,
                            0.42970702052116394,
                            0.4213036596775055,
                            0.5711257457733154,
                            0.42728444933891296,
                            0.5126050710678101,
                            0.4166856110095978,
                            0.424634724855423
                        ]
                    },
                    "val": {
                        "score": -0.4512276313124891,
                        "pretrain_loss": 1.224653959274292,
                        "pretrain_component": 0.6945468187332153,
                        "supervised_component": 0.612326979637146,
                        "features_accuracy": [
                            0.5667575001716614,
                            0.432939738035202,
                            0.41447168588638306,
                            0.5752346515655518,
                            0.4353618025779724,
                            0.5052981972694397,
                            0.41659098863601685,
                            0.42325159907341003
                        ]
                    },
                    "test": {
                        "score": -0.4446962729303857,
                        "pretrain_loss": 1.2164992094039917,
                        "pretrain_component": 0.6944816708564758,
                        "supervised_component": 0.6082496047019958,
                        "features_accuracy": [
                            0.5641957521438599,
                            0.43289729952812195,
                            0.4229651093482971,
                            0.5726743936538696,
                            0.44186046719551086,
                            0.5290697813034058,
                            0.4193314015865326,
                            0.4130329489707947
                        ]
                    }
                },
                "40000": {
                    "train": {
                        "score": -0.3583993132297931,
                        "pretrain_loss": 1.1545686721801758,
                        "pretrain_component": 0.6946479082107544,
                        "supervised_component": 0.5772843360900879,
                        "features_accuracy": [
                            0.5826330780982971,
                            0.43379515409469604,
                            0.41804832220077515,
                            0.5566659569740295,
                            0.43591493368148804,
                            0.4937542676925659,
                            0.4174426794052124,
                            0.4194110333919525
                        ]
                    },
                    "val": {
                        "score": -0.44468338667024276,
                        "pretrain_loss": 1.2277870178222656,
                        "pretrain_component": 0.6947377324104309,
                        "supervised_component": 0.6138935089111328,
                        "features_accuracy": [
                            0.5700877904891968,
                            0.4344535171985626,
                            0.41447168588638306,
                            0.5491976737976074,
                            0.4283984303474426,
                            0.4974265694618225,
                            0.41628822684288025,
                            0.43021494150161743
                        ]
                    },
                    "test": {
                        "score": -0.43749722094660054,
                        "pretrain_loss": 1.1945511102676392,
                        "pretrain_component": 0.6946015954017639,
                        "supervised_component": 0.5972755551338196,
                        "features_accuracy": [
                            0.5736433863639832,
                            0.4285368323326111,
                            0.4229651093482971,
                            0.5612887740135193,
                            0.4467054307460785,
                            0.510901153087616,
                            0.41981589794158936,
                            0.4203003942966461
                        ]
                    }
                },
                "50000": {
                    "train": {
                        "score": -0.34548043862373196,
                        "pretrain_loss": 1.126270055770874,
                        "pretrain_component": 0.694675087928772,
                        "supervised_component": 0.563135027885437,
                        "features_accuracy": [
                            0.5766522884368896,
                            0.4285714328289032,
                            0.42402908205986023,
                            0.560829758644104,
                            0.4293285012245178,
                            0.5051859021186829,
                            0.4204708933830261,
                            0.4287228584289551
                        ]
                    },
                    "val": {
                        "score": -0.44160796666812857,
                        "pretrain_loss": 1.2223103046417236,
                        "pretrain_component": 0.6948208212852478,
                        "supervised_component": 0.6111551523208618,
                        "features_accuracy": [
                            0.57069331407547,
                            0.42537087202072144,
                            0.41447168588638306,
                            0.5522252321243286,
                            0.4311232268810272,
                            0.5101422667503357,
                            0.41598546504974365,
                            0.4362700581550598
                        ]
                    },
                    "test": {
                        "score": -0.43479800013265485,
                        "pretrain_loss": 1.1840890645980835,
                        "pretrain_component": 0.694709062576294,
                        "supervised_component": 0.5920445322990417,
                        "features_accuracy": [
                            0.5719476938247681,
                            0.43144381046295166,
                            0.4229651093482971,
                            0.5654069781303406,
                            0.4360465109348297,
                            0.5179263353347778,
                            0.42611435055732727,
                            0.4282945692539215
                        ]
                    }
                },
                "60000": {
                    "train": {
                        "score": -0.3343295559442519,
                        "pretrain_loss": 1.1341432332992554,
                        "pretrain_component": 0.6949508786201477,
                        "supervised_component": 0.5670716166496277,
                        "features_accuracy": [
                            0.5698387622833252,
                            0.4204708933830261,
                            0.4268302023410797,
                            0.5506094694137573,
                            0.4330380856990814,
                            0.4924672842025757,
                            0.4250132739543915,
                            0.42917710542678833
                        ]
                    },
                    "val": {
                        "score": -0.43660580155908824,
                        "pretrain_loss": 1.2125391960144043,
                        "pretrain_component": 0.6949925422668457,
                        "supervised_component": 0.6062695980072021,
                        "features_accuracy": [
                            0.5619134306907654,
                            0.42204058170318604,
                            0.41447168588638306,
                            0.5479866862297058,
                            0.4326370060443878,
                            0.4907659590244293,
                            0.41931578516960144,
                            0.4368755519390106
                        ]
                    },
                    "test": {
                        "score": -0.42931789166611173,
                        "pretrain_loss": 1.1672910451889038,
                        "pretrain_component": 0.6949005722999573,
                        "supervised_component": 0.5836455225944519,
                        "features_accuracy": [
                            0.5661337375640869,
                            0.4219961166381836,
                            0.4229651093482971,
                            0.5581395626068115,
                            0.4384689927101135,
                            0.489825576543808,
                            0.4193314015865326,
                            0.42490309476852417
                        ]
                    }
                },
                "70000": {
                    "train": {
                        "score": -0.32551378601772474,
                        "pretrain_loss": 1.153629183769226,
                        "pretrain_component": 0.6951380372047424,
                        "supervised_component": 0.576814591884613,
                        "features_accuracy": [
                            0.5693845152854919,
                            0.4153228998184204,
                            0.4250889718532562,
                            0.5417518615722656,
                            0.44658946990966797,
                            0.5129835605621338,
                            0.41607996821403503,
                            0.4294799268245697
                        ]
                    },
                    "val": {
                        "score": -0.4408074442022035,
                        "pretrain_loss": 1.2129685878753662,
                        "pretrain_component": 0.695156991481781,
                        "supervised_component": 0.6064842939376831,
                        "features_accuracy": [
                            0.5728126168251038,
                            0.40962761640548706,
                            0.41447168588638306,
                            0.5331516861915588,
                            0.439297616481781,
                            0.5019679069519043,
                            0.42234331369400024,
                            0.4362700581550598
                        ]
                    },
                    "test": {
                        "score": -0.4295336440873705,
                        "pretrain_loss": 1.1729549169540405,
                        "pretrain_component": 0.6951178908348083,
                        "supervised_component": 0.5864774584770203,
                        "features_accuracy": [
                            0.5712209343910217,
                            0.4156976640224457,
                            0.4229651093482971,
                            0.5530523061752319,
                            0.4387112259864807,
                            0.5193798542022705,
                            0.4241763651371002,
                            0.42005813121795654
                        ]
                    }
                },
                "80000": {
                    "train": {
                        "score": -0.3180852148816878,
                        "pretrain_loss": 1.1004624366760254,
                        "pretrain_component": 0.6954047679901123,
                        "supervised_component": 0.5502312183380127,
                        "features_accuracy": [
                            0.5696873664855957,
                            0.4165341854095459,
                            0.42493754625320435,
                            0.5303959846496582,
                            0.4315996766090393,
                            0.5065485835075378,
                            0.42478615045547485,
                            0.4232720136642456
                        ]
                    },
                    "val": {
                        "score": -0.4363566340007872,
                        "pretrain_loss": 1.212785005569458,
                        "pretrain_component": 0.6954240798950195,
                        "supervised_component": 0.606392502784729,
                        "features_accuracy": [
                            0.5661519765853882,
                            0.41416892409324646,
                            0.41447168588638306,
                            0.5289130806922913,
                            0.438086599111557,
                            0.5077202320098877,
                            0.42143505811691284,
                            0.4389948546886444
                        ]
                    },
                    "test": {
                        "score": -0.4289276868590873,
                        "pretrain_loss": 1.1697864532470703,
                        "pretrain_component": 0.6953393220901489,
                        "supervised_component": 0.5848932266235352,
                        "features_accuracy": [
                            0.5687984228134155,
                            0.41739341616630554,
                            0.4229651093482971,
                            0.5394864082336426,
                            0.4425871968269348,
                            0.5058139562606812,
                            0.42272287607192993,
                            0.41375967860221863
                        ]
                    }
                },
                "90000": {
                    "train": {
                        "score": -0.3104980921719636,
                        "pretrain_loss": 1.1356449127197266,
                        "pretrain_component": 0.6956409811973572,
                        "supervised_component": 0.5678224563598633,
                        "features_accuracy": [
                            0.568854570388794,
                            0.4121432602405548,
                            0.41713982820510864,
                            0.5274434089660645,
                            0.4366719722747803,
                            0.5188886523246765,
                            0.43046408891677856,
                            0.43682339787483215
                        ]
                    },
                    "val": {
                        "score": -0.44084869543539457,
                        "pretrain_loss": 1.2237398624420166,
                        "pretrain_component": 0.695527195930481,
                        "supervised_component": 0.6118699312210083,
                        "features_accuracy": [
                            0.5670602321624756,
                            0.41174688935279846,
                            0.41447168588638306,
                            0.5328488945960999,
                            0.4414168894290924,
                            0.5198304653167725,
                            0.42718741297721863,
                            0.444141685962677
                        ]
                    },
                    "test": {
                        "score": -0.4303503807307544,
                        "pretrain_loss": 1.170815110206604,
                        "pretrain_component": 0.6954410076141357,
                        "supervised_component": 0.585407555103302,
                        "features_accuracy": [
                            0.5656492114067078,
                            0.41593992710113525,
                            0.4229651093482971,
                            0.5343992114067078,
                            0.4404069781303406,
                            0.5150193572044373,
                            0.42877906560897827,
                            0.4295058250427246
                        ]
                    }
                },
                "100000": {
                    "train": {
                        "score": -0.30483578918779775,
                        "pretrain_loss": 1.1146105527877808,
                        "pretrain_component": 0.6955409646034241,
                        "supervised_component": 0.5573052763938904,
                        "features_accuracy": [
                            0.5591642260551453,
                            0.41221895813941956,
                            0.4219093322753906,
                            0.5416004657745361,
                            0.44605952501296997,
                            0.5148005485534668,
                            0.4303126931190491,
                            0.4261488616466522
                        ]
                    },
                    "val": {
                        "score": -0.441076486626151,
                        "pretrain_loss": 1.2028169631958008,
                        "pretrain_component": 0.6955528855323792,
                        "supervised_component": 0.6014084815979004,
                        "features_accuracy": [
                            0.5613079071044922,
                            0.40993037819862366,
                            0.41447168588638306,
                            0.5473811626434326,
                            0.4414168894290924,
                            0.5210414528846741,
                            0.4311232268810272,
                            0.4396003484725952
                        ]
                    },
                    "test": {
                        "score": -0.42820489987319316,
                        "pretrain_loss": 1.1645270586013794,
                        "pretrain_component": 0.695433497428894,
                        "supervised_component": 0.5822635293006897,
                        "features_accuracy": [
                            0.5620154738426208,
                            0.41739341616630554,
                            0.4229651093482971,
                            0.5523256063461304,
                            0.4404069781303406,
                            0.5092054009437561,
                            0.4338662922382355,
                            0.4205426275730133
                        ]
                    }
                }
            },
            "train": {
                "score": -0.3180852148816878
            },
            "val": {
                "score": -0.4363566340007872
            },
            "test": {
                "score": -0.4289276868590873
            }
        },
        "best_iteration": 80000,
        "time": "0:09:45",
        "trial_id": 91,
        "tuning_time": "13:53:59"
    },
    "time": "15:18:49"
}
