{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised___6dee678da31042e5ac2f58534076ba29.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 2,
        "data": {
            "path": "data/california",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512,
                    512
                ],
                "dropout": 0.0
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "positional",
                "linear",
                "relu"
            ],
            "d_num_embedding": 126,
            "positional_encoding": {
                "n": 43,
                "sigma": 0.021371444170736765,
                "trainable": true,
                "initialization": "normal"
            },
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.0001093080842538706,
            "weight_decay": 1.4529840437784787e-06,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.42184426713203266,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.0001093080842538706,
            "weight_decay": 1.4529840437784787e-06,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post",
            "supervised_weight": 1.0
        },
        "bins": null
    },
    "epoch_size": 104,
    "n_parameters": 1134577,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -0.379109009892899,
                    "pretrain_loss": 1.2581833600997925,
                    "pretrain_component": 0.6925005912780762,
                    "supervised_component": 0.6290916800498962,
                    "features_accuracy": [
                        0.5775607824325562,
                        0.4132031202316284,
                        0.5415247082710266,
                        0.4490877687931061,
                        0.5786963701248169,
                        0.43205392360687256,
                        0.5778635740280151,
                        0.4730108380317688
                    ]
                },
                "val": {
                    "score": -0.466548179665478,
                    "pretrain_loss": 1.2309950590133667,
                    "pretrain_component": 0.6925232410430908,
                    "supervised_component": 0.6154975295066833,
                    "features_accuracy": [
                        0.5594913959503174,
                        0.4332424998283386,
                        0.541023313999176,
                        0.4456554651260376,
                        0.5794731974601746,
                        0.4402058720588684,
                        0.5794731974601746,
                        0.47562822699546814
                    ]
                },
                "test": {
                    "score": -0.4602157353608826,
                    "pretrain_loss": 1.2009421586990356,
                    "pretrain_component": 0.6924521923065186,
                    "supervised_component": 0.6004710793495178,
                    "features_accuracy": [
                        0.5898740291595459,
                        0.4098837077617645,
                        0.5295542478561401,
                        0.4377422332763672,
                        0.564437985420227,
                        0.4442829489707947,
                        0.5777616500854492,
                        0.48134690523147583
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -0.34412532385931555,
                    "pretrain_loss": 1.1973000764846802,
                    "pretrain_component": 0.6924492120742798,
                    "supervised_component": 0.5986500382423401,
                    "features_accuracy": [
                        0.5718071460723877,
                        0.41115906834602356,
                        0.5556817650794983,
                        0.4963282644748688,
                        0.560299813747406,
                        0.42319631576538086,
                        0.5821788311004639,
                        0.48035430908203125
                    ]
                },
                "val": {
                    "score": -0.4537068412031394,
                    "pretrain_loss": 1.1999424695968628,
                    "pretrain_component": 0.6924188137054443,
                    "supervised_component": 0.5999712347984314,
                    "features_accuracy": [
                        0.5594913959503174,
                        0.4341507852077484,
                        0.5646381974220276,
                        0.4992431104183197,
                        0.565849244594574,
                        0.4338480234146118,
                        0.5794731974601746,
                        0.47926127910614014
                    ]
                },
                "test": {
                    "score": -0.4541036881294432,
                    "pretrain_loss": 1.172730803489685,
                    "pretrain_component": 0.6923298239707947,
                    "supervised_component": 0.5863654017448425,
                    "features_accuracy": [
                        0.5898740291595459,
                        0.4156976640224457,
                        0.5530523061752319,
                        0.49176356196403503,
                        0.5537790656089783,
                        0.4321705400943756,
                        0.5777616500854492,
                        0.48909884691238403
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -0.34551220175756986,
                    "pretrain_loss": 1.1724646091461182,
                    "pretrain_component": 0.6924615502357483,
                    "supervised_component": 0.5862323045730591,
                    "features_accuracy": [
                        0.5730184316635132,
                        0.42296919226646423,
                        0.5671133399009705,
                        0.4986751675605774,
                        0.5331213474273682,
                        0.42720872163772583,
                        0.5800590515136719,
                        0.42781439423561096
                    ]
                },
                "val": {
                    "score": -0.4508212628276375,
                    "pretrain_loss": 1.1849802732467651,
                    "pretrain_component": 0.6924645304679871,
                    "supervised_component": 0.5924901366233826,
                    "features_accuracy": [
                        0.5597941279411316,
                        0.4353618025779724,
                        0.5716015696525574,
                        0.5049954652786255,
                        0.546170175075531,
                        0.4323342442512512,
                        0.5791704654693604,
                        0.42506811022758484
                    ]
                },
                "test": {
                    "score": -0.4429002179546717,
                    "pretrain_loss": 1.1639153957366943,
                    "pretrain_component": 0.6923198699951172,
                    "supervised_component": 0.5819576978683472,
                    "features_accuracy": [
                        0.5889050364494324,
                        0.416424423456192,
                        0.5559592843055725,
                        0.49563953280448914,
                        0.5382751822471619,
                        0.43968021869659424,
                        0.5777616500854492,
                        0.4416182041168213
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -0.3678244574795691,
                    "pretrain_loss": 1.167077660560608,
                    "pretrain_component": 0.6924635171890259,
                    "supervised_component": 0.583538830280304,
                    "features_accuracy": [
                        0.5853585004806519,
                        0.43099403381347656,
                        0.5511394143104553,
                        0.5175259709358215,
                        0.5167688727378845,
                        0.4303126931190491,
                        0.5779393315315247,
                        0.43932169675827026
                    ]
                },
                "val": {
                    "score": -0.44757046356499003,
                    "pretrain_loss": 1.1778873205184937,
                    "pretrain_component": 0.6925933361053467,
                    "supervised_component": 0.5889436602592468,
                    "features_accuracy": [
                        0.5588858723640442,
                        0.4450499415397644,
                        0.5585830807685852,
                        0.5122615694999695,
                        0.5234634876251221,
                        0.4314259886741638,
                        0.5794731974601746,
                        0.41810473799705505
                    ]
                },
                "test": {
                    "score": -0.4390095154079007,
                    "pretrain_loss": 1.1394505500793457,
                    "pretrain_component": 0.6924301385879517,
                    "supervised_component": 0.5697252750396729,
                    "features_accuracy": [
                        0.5910852551460266,
                        0.43047481775283813,
                        0.5433623790740967,
                        0.5232558250427246,
                        0.5196220874786377,
                        0.4365310072898865,
                        0.5775193572044373,
                        0.4336240291595459
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": -0.32709223473015125,
                    "pretrain_loss": 1.1519657373428345,
                    "pretrain_component": 0.6921796798706055,
                    "supervised_component": 0.5759828686714172,
                    "features_accuracy": [
                        0.5843743085861206,
                        0.45665836334228516,
                        0.5564388036727905,
                        0.513437807559967,
                        0.5380422472953796,
                        0.4309183359146118,
                        0.5782421231269836,
                        0.44711941480636597
                    ]
                },
                "val": {
                    "score": -0.4457191444534923,
                    "pretrain_loss": 1.158933162689209,
                    "pretrain_component": 0.6924018859863281,
                    "supervised_component": 0.5794665813446045,
                    "features_accuracy": [
                        0.5591886043548584,
                        0.458976686000824,
                        0.553436279296875,
                        0.5101422667503357,
                        0.5395095348358154,
                        0.4368755519390106,
                        0.5800787210464478,
                        0.4389948546886444
                    ]
                },
                "test": {
                    "score": -0.4379021804676005,
                    "pretrain_loss": 1.1360572576522827,
                    "pretrain_component": 0.6921586394309998,
                    "supervised_component": 0.5680286288261414,
                    "features_accuracy": [
                        0.5913274884223938,
                        0.455910861492157,
                        0.538759708404541,
                        0.5152616500854492,
                        0.5339147448539734,
                        0.4375,
                        0.5772771239280701,
                        0.44743216037750244
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": -0.3155713330206638,
                    "pretrain_loss": 1.115206003189087,
                    "pretrain_component": 0.6924433708190918,
                    "supervised_component": 0.5576030015945435,
                    "features_accuracy": [
                        0.5805132985115051,
                        0.4742978513240814,
                        0.518207311630249,
                        0.4707396626472473,
                        0.5384207963943481,
                        0.4353092610836029,
                        0.5792263150215149,
                        0.4312211573123932
                    ]
                },
                "val": {
                    "score": -0.4419892929239151,
                    "pretrain_loss": 1.1556495428085327,
                    "pretrain_component": 0.6926482915878296,
                    "supervised_component": 0.5778247714042664,
                    "features_accuracy": [
                        0.5600968599319458,
                        0.46775656938552856,
                        0.5137753486633301,
                        0.4910687208175659,
                        0.5422343015670776,
                        0.4359672963619232,
                        0.5809869766235352,
                        0.42264607548713684
                    ]
                },
                "test": {
                    "score": -0.4378916611206926,
                    "pretrain_loss": 1.1321029663085938,
                    "pretrain_component": 0.6923586130142212,
                    "supervised_component": 0.5660514831542969,
                    "features_accuracy": [
                        0.5896317958831787,
                        0.4665697515010834,
                        0.5171996355056763,
                        0.4765019416809082,
                        0.5314922332763672,
                        0.4430716931819916,
                        0.5782461166381836,
                        0.4362887442111969
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": -0.3345113669853637,
                    "pretrain_loss": 1.1186546087265015,
                    "pretrain_component": 0.6922942399978638,
                    "supervised_component": 0.5593273043632507,
                    "features_accuracy": [
                        0.5780150294303894,
                        0.4742978513240814,
                        0.5323643088340759,
                        0.4838367998600006,
                        0.5363767147064209,
                        0.45347869396209717,
                        0.5792263150215149,
                        0.43538498878479004
                    ]
                },
                "val": {
                    "score": -0.4470403926018661,
                    "pretrain_loss": 1.1568776369094849,
                    "pretrain_component": 0.6925426125526428,
                    "supervised_component": 0.5784388184547424,
                    "features_accuracy": [
                        0.5616106390953064,
                        0.46775656938552856,
                        0.5252800583839417,
                        0.4916742444038391,
                        0.5467756390571594,
                        0.4432334303855896,
                        0.5794731974601746,
                        0.42264607548713684
                    ]
                },
                "test": {
                    "score": -0.43223163224337174,
                    "pretrain_loss": 1.1163554191589355,
                    "pretrain_component": 0.6922439336776733,
                    "supervised_component": 0.5581777095794678,
                    "features_accuracy": [
                        0.5906007885932922,
                        0.4595445692539215,
                        0.520348846912384,
                        0.4893410801887512,
                        0.5314922332763672,
                        0.44985464215278625,
                        0.5765503644943237,
                        0.4360465109348297
                    ]
                }
            },
            "80000": {
                "train": {
                    "score": -0.32408459020989533,
                    "pretrain_loss": 1.1437276601791382,
                    "pretrain_component": 0.6922939419746399,
                    "supervised_component": 0.5718638300895691,
                    "features_accuracy": [
                        0.5772579312324524,
                        0.4634718894958496,
                        0.5483382940292358,
                        0.4669543504714966,
                        0.5273677110671997,
                        0.45204028487205505,
                        0.5869483351707458,
                        0.44053298234939575
                    ]
                },
                "val": {
                    "score": -0.44707155103060187,
                    "pretrain_loss": 1.1545305252075195,
                    "pretrain_component": 0.6926248669624329,
                    "supervised_component": 0.5772652626037598,
                    "features_accuracy": [
                        0.5585830807685852,
                        0.46563729643821716,
                        0.5331516861915588,
                        0.47956404089927673,
                        0.5277020931243896,
                        0.4468664824962616,
                        0.5815925002098083,
                        0.42567363381385803
                    ]
                },
                "test": {
                    "score": -0.4296451001947867,
                    "pretrain_loss": 1.1083016395568848,
                    "pretrain_component": 0.6922970414161682,
                    "supervised_component": 0.5541508197784424,
                    "features_accuracy": [
                        0.5869670510292053,
                        0.46681201457977295,
                        0.5268895626068115,
                        0.4740794599056244,
                        0.5167151093482971,
                        0.45518410205841064,
                        0.5767926573753357,
                        0.43168604373931885
                    ]
                }
            },
            "90000": {
                "train": {
                    "score": -0.31640037988587355,
                    "pretrain_loss": 1.0923423767089844,
                    "pretrain_component": 0.6925554871559143,
                    "supervised_component": 0.5461711883544922,
                    "features_accuracy": [
                        0.5794534087181091,
                        0.45559847354888916,
                        0.5278976559638977,
                        0.47384360432624817,
                        0.5285789966583252,
                        0.460292249917984,
                        0.5789234638214111,
                        0.42940419912338257
                    ]
                },
                "val": {
                    "score": -0.44553456703088506,
                    "pretrain_loss": 1.138164758682251,
                    "pretrain_component": 0.6927396059036255,
                    "supervised_component": 0.5690823793411255,
                    "features_accuracy": [
                        0.5573720932006836,
                        0.454132616519928,
                        0.5301241278648376,
                        0.47532546520233154,
                        0.5392068028450012,
                        0.4583711624145508,
                        0.5809869766235352,
                        0.42385709285736084
                    ]
                },
                "test": {
                    "score": -0.43244528117497705,
                    "pretrain_loss": 1.1069936752319336,
                    "pretrain_component": 0.6925258636474609,
                    "supervised_component": 0.5534968376159668,
                    "features_accuracy": [
                        0.5867248177528381,
                        0.4542151093482971,
                        0.5174418687820435,
                        0.4597868323326111,
                        0.5210756063461304,
                        0.4672965109348297,
                        0.575339138507843,
                        0.4268410801887512
                    ]
                }
            }
        },
        "train": {
            "score": -0.3155713330206638
        },
        "val": {
            "score": -0.4419892929239151
        },
        "test": {
            "score": -0.4378916611206926
        }
    },
    "best_iteration": 60000,
    "time": "0:08:27"
}
