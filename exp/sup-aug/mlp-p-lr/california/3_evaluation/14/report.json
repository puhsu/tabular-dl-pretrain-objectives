{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised___6dee678da31042e5ac2f58534076ba29.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 14,
        "data": {
            "path": "data/california",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512,
                    512
                ],
                "dropout": 0.0
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "positional",
                "linear",
                "relu"
            ],
            "d_num_embedding": 126,
            "positional_encoding": {
                "n": 43,
                "sigma": 0.021371444170736765,
                "trainable": true,
                "initialization": "normal"
            },
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.0001093080842538706,
            "weight_decay": 1.4529840437784787e-06,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.42184426713203266,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.0001093080842538706,
            "weight_decay": 1.4529840437784787e-06,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post",
            "supervised_weight": 1.0
        },
        "bins": null
    },
    "epoch_size": 104,
    "n_parameters": 1134577,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -0.3687846091577597,
                    "pretrain_loss": 1.2670120000839233,
                    "pretrain_component": 0.692486584186554,
                    "supervised_component": 0.6335060000419617,
                    "features_accuracy": [
                        0.5774093866348267,
                        0.40722236037254333,
                        0.5718828439712524,
                        0.4340979754924774,
                        0.5793777108192444,
                        0.5719585418701172,
                        0.5733212232589722,
                        0.41698843240737915
                    ]
                },
                "val": {
                    "score": -0.4600955220790863,
                    "pretrain_loss": 1.2000681161880493,
                    "pretrain_component": 0.6922845840454102,
                    "supervised_component": 0.6000340580940247,
                    "features_accuracy": [
                        0.5761429071426392,
                        0.4017559885978699,
                        0.5937026739120483,
                        0.42658188939094543,
                        0.5797759890556335,
                        0.5825007557868958,
                        0.577959418296814,
                        0.42809566855430603
                    ]
                },
                "test": {
                    "score": -0.4564382795157888,
                    "pretrain_loss": 1.251798391342163,
                    "pretrain_component": 0.6925050020217896,
                    "supervised_component": 0.6258991956710815,
                    "features_accuracy": [
                        0.5806686282157898,
                        0.4060077369213104,
                        0.569767415523529,
                        0.42126938700675964,
                        0.5804263353347778,
                        0.5671027302742004,
                        0.5777616500854492,
                        0.42514535784721375
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -0.33656563941944756,
                    "pretrain_loss": 1.2128463983535767,
                    "pretrain_component": 0.692477822303772,
                    "supervised_component": 0.6064231991767883,
                    "features_accuracy": [
                        0.5661291480064392,
                        0.41184043884277344,
                        0.5814217925071716,
                        0.4140358865261078,
                        0.5740025639533997,
                        0.5689302682876587,
                        0.6004239916801453,
                        0.42198503017425537
                    ]
                },
                "val": {
                    "score": -0.45284535883422583,
                    "pretrain_loss": 1.182114601135254,
                    "pretrain_component": 0.6922972798347473,
                    "supervised_component": 0.591057300567627,
                    "features_accuracy": [
                        0.568271279335022,
                        0.4017559885978699,
                        0.5937026739120483,
                        0.42627912759780884,
                        0.5791704654693604,
                        0.5825007557868958,
                        0.5906751155853271,
                        0.42597639560699463
                    ]
                },
                "test": {
                    "score": -0.44586002584227596,
                    "pretrain_loss": 1.2467014789581299,
                    "pretrain_component": 0.6925221681594849,
                    "supervised_component": 0.6233507394790649,
                    "features_accuracy": [
                        0.5702519416809082,
                        0.4060077369213104,
                        0.569767415523529,
                        0.4181201457977295,
                        0.5818798542022705,
                        0.5671027302742004,
                        0.5872092843055725,
                        0.4229651093482971
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -0.3525055032859809,
                    "pretrain_loss": 1.1860487461090088,
                    "pretrain_component": 0.6924850940704346,
                    "supervised_component": 0.5930243730545044,
                    "features_accuracy": [
                        0.5710500478744507,
                        0.397304892539978,
                        0.5815731883049011,
                        0.4228934943675995,
                        0.5796805620193481,
                        0.5801347494125366,
                        0.593837559223175,
                        0.41978955268859863
                    ]
                },
                "val": {
                    "score": -0.4515753671908226,
                    "pretrain_loss": 1.1490583419799805,
                    "pretrain_component": 0.6923096179962158,
                    "supervised_component": 0.5745291709899902,
                    "features_accuracy": [
                        0.5797759890556335,
                        0.4017559885978699,
                        0.5949137210845947,
                        0.4283984303474426,
                        0.5812897086143494,
                        0.5825007557868958,
                        0.6049046516418457,
                        0.42658188939094543
                    ]
                },
                "test": {
                    "score": -0.444897281841151,
                    "pretrain_loss": 1.2243812084197998,
                    "pretrain_component": 0.6925734281539917,
                    "supervised_component": 0.6121906042098999,
                    "features_accuracy": [
                        0.5687984228134155,
                        0.4060077369213104,
                        0.5712209343910217,
                        0.42248061299324036,
                        0.5835756063461304,
                        0.5671027302742004,
                        0.5944767594337463,
                        0.4241763651371002
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -0.31607127327268464,
                    "pretrain_loss": 1.1774591207504272,
                    "pretrain_component": 0.692487895488739,
                    "supervised_component": 0.5887295603752136,
                    "features_accuracy": [
                        0.5652207136154175,
                        0.41290029883384705,
                        0.5755923986434937,
                        0.42758727073669434,
                        0.5761223435401917,
                        0.5752139091491699,
                        0.6001968383789062,
                        0.42599743604660034
                    ]
                },
                "val": {
                    "score": -0.44763351156192,
                    "pretrain_loss": 1.130679965019226,
                    "pretrain_component": 0.6924021244049072,
                    "supervised_component": 0.565339982509613,
                    "features_accuracy": [
                        0.5676657557487488,
                        0.40326976776123047,
                        0.5958219766616821,
                        0.42900392413139343,
                        0.5770511627197266,
                        0.5825007557868958,
                        0.6049046516418457,
                        0.4283984303474426
                    ]
                },
                "test": {
                    "score": -0.4432584262978643,
                    "pretrain_loss": 1.2079522609710693,
                    "pretrain_component": 0.6926026940345764,
                    "supervised_component": 0.6039761304855347,
                    "features_accuracy": [
                        0.5629844665527344,
                        0.4060077369213104,
                        0.5726743936538696,
                        0.419089138507843,
                        0.5780038833618164,
                        0.5671027302742004,
                        0.5947189927101135,
                        0.4229651093482971
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": -0.3030671260222644,
                    "pretrain_loss": 1.136481761932373,
                    "pretrain_component": 0.6926880478858948,
                    "supervised_component": 0.5682408809661865,
                    "features_accuracy": [
                        0.5692331194877625,
                        0.41713982820510864,
                        0.5858127474784851,
                        0.4202437996864319,
                        0.5627980828285217,
                        0.5736240744590759,
                        0.5858884453773499,
                        0.4193353056907654
                    ]
                },
                "val": {
                    "score": -0.4453825417712156,
                    "pretrain_loss": 1.124142050743103,
                    "pretrain_component": 0.6925176382064819,
                    "supervised_component": 0.5620710253715515,
                    "features_accuracy": [
                        0.5637299418449402,
                        0.40326976776123047,
                        0.5955192446708679,
                        0.42688465118408203,
                        0.5743263959884644,
                        0.5821980237960815,
                        0.5903723835945129,
                        0.42930668592453003
                    ]
                },
                "test": {
                    "score": -0.445041039214862,
                    "pretrain_loss": 1.1974376440048218,
                    "pretrain_component": 0.6927717328071594,
                    "supervised_component": 0.5987188220024109,
                    "features_accuracy": [
                        0.5666182041168213,
                        0.4074612259864807,
                        0.5717054009437561,
                        0.42102712392807007,
                        0.5714631676673889,
                        0.5671027302742004,
                        0.5840600728988647,
                        0.42490309476852417
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": -0.2928082352598584,
                    "pretrain_loss": 1.1247632503509521,
                    "pretrain_component": 0.6927769184112549,
                    "supervised_component": 0.5623816251754761,
                    "features_accuracy": [
                        0.558180034160614,
                        0.4281929135322571,
                        0.5731698274612427,
                        0.41963812708854675,
                        0.564009428024292,
                        0.5806646943092346,
                        0.5786206722259521,
                        0.4248618483543396
                    ]
                },
                "val": {
                    "score": -0.4395308912558763,
                    "pretrain_loss": 1.1254358291625977,
                    "pretrain_component": 0.6926212310791016,
                    "supervised_component": 0.5627179145812988,
                    "features_accuracy": [
                        0.5585830807685852,
                        0.40417802333831787,
                        0.5943081974983215,
                        0.42930668592453003,
                        0.5752346515655518,
                        0.5821980237960815,
                        0.583106279373169,
                        0.42688465118408203
                    ]
                },
                "test": {
                    "score": -0.4385384175815669,
                    "pretrain_loss": 1.1853848695755005,
                    "pretrain_component": 0.6929214000701904,
                    "supervised_component": 0.5926924347877502,
                    "features_accuracy": [
                        0.5617732405662537,
                        0.4118216931819916,
                        0.5692829489707947,
                        0.41860464215278625,
                        0.5741279125213623,
                        0.5673449635505676,
                        0.5799418687820435,
                        0.4217538833618164
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": -0.3481681588029341,
                    "pretrain_loss": 1.1532293558120728,
                    "pretrain_component": 0.6930710673332214,
                    "supervised_component": 0.5766146779060364,
                    "features_accuracy": [
                        0.5612840056419373,
                        0.4130517244338989,
                        0.5808161497116089,
                        0.4257703125476837,
                        0.563252329826355,
                        0.5675675868988037,
                        0.5666590929031372,
                        0.4213793873786926
                    ]
                },
                "val": {
                    "score": -0.44435534961148,
                    "pretrain_loss": 1.1221081018447876,
                    "pretrain_component": 0.6927841901779175,
                    "supervised_component": 0.5610540509223938,
                    "features_accuracy": [
                        0.5610051155090332,
                        0.4017559885978699,
                        0.5964275002479553,
                        0.42779290676116943,
                        0.5697850584983826,
                        0.5834090113639832,
                        0.5825007557868958,
                        0.42900392413139343
                    ]
                },
                "test": {
                    "score": -0.43299634881787064,
                    "pretrain_loss": 1.194763422012329,
                    "pretrain_component": 0.6929917335510254,
                    "supervised_component": 0.5973817110061646,
                    "features_accuracy": [
                        0.5646802186965942,
                        0.4060077369213104,
                        0.5726743936538696,
                        0.419089138507843,
                        0.5714631676673889,
                        0.5663759708404541,
                        0.573401153087616,
                        0.42223837971687317
                    ]
                }
            },
            "80000": {
                "train": {
                    "score": -0.32091224870828156,
                    "pretrain_loss": 1.1558774709701538,
                    "pretrain_component": 0.6927500367164612,
                    "supervised_component": 0.5779387354850769,
                    "features_accuracy": [
                        0.5657506585121155,
                        0.41698843240737915,
                        0.5771822333335876,
                        0.4368990957736969,
                        0.5705201029777527,
                        0.5796048641204834,
                        0.5858127474784851,
                        0.4218336045742035
                    ]
                },
                "val": {
                    "score": -0.4419782577819326,
                    "pretrain_loss": 1.1287755966186523,
                    "pretrain_component": 0.6926556825637817,
                    "supervised_component": 0.5643877983093262,
                    "features_accuracy": [
                        0.5528307557106018,
                        0.4008477032184601,
                        0.5961247086524963,
                        0.4299122095108032,
                        0.573115348815918,
                        0.5821980237960815,
                        0.5903723835945129,
                        0.42658188939094543
                    ]
                },
                "test": {
                    "score": -0.43443223834590244,
                    "pretrain_loss": 1.204923391342163,
                    "pretrain_component": 0.6929091811180115,
                    "supervised_component": 0.6024616956710815,
                    "features_accuracy": [
                        0.5627422332763672,
                        0.4072189927101135,
                        0.5765503644943237,
                        0.42369186878204346,
                        0.5687984228134155,
                        0.5646802186965942,
                        0.5796996355056763,
                        0.4219961166381836
                    ]
                }
            },
            "90000": {
                "train": {
                    "score": -0.33497745429714576,
                    "pretrain_loss": 1.1332498788833618,
                    "pretrain_component": 0.6928701400756836,
                    "supervised_component": 0.5666249394416809,
                    "features_accuracy": [
                        0.5546218752861023,
                        0.4141116142272949,
                        0.5810432434082031,
                        0.421152263879776,
                        0.5533348917961121,
                        0.5759709477424622,
                        0.5697630643844604,
                        0.4239533841609955
                    ]
                },
                "val": {
                    "score": -0.4417492277395487,
                    "pretrain_loss": 1.1156073808670044,
                    "pretrain_component": 0.692680835723877,
                    "supervised_component": 0.5578036904335022,
                    "features_accuracy": [
                        0.5567665696144104,
                        0.40448078513145447,
                        0.6006660461425781,
                        0.4335452616214752,
                        0.5594913959503174,
                        0.5815925002098083,
                        0.5761429071426392,
                        0.42658188939094543
                    ]
                },
                "test": {
                    "score": -0.42782128028342625,
                    "pretrain_loss": 1.1913312673568726,
                    "pretrain_component": 0.6929317116737366,
                    "supervised_component": 0.5956656336784363,
                    "features_accuracy": [
                        0.5639534592628479,
                        0.4091569781303406,
                        0.5741279125213623,
                        0.42538759112358093,
                        0.5578972697257996,
                        0.5637112259864807,
                        0.5651647448539734,
                        0.4229651093482971
                    ]
                }
            }
        },
        "train": {
            "score": -0.2928082352598584
        },
        "val": {
            "score": -0.4395308912558763
        },
        "test": {
            "score": -0.4385384175815669
        }
    },
    "best_iteration": 60000,
    "time": "0:08:40"
}
