{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised___6dee678da31042e5ac2f58534076ba29.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 12,
        "data": {
            "path": "data/california",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512,
                    512
                ],
                "dropout": 0.0
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "positional",
                "linear",
                "relu"
            ],
            "d_num_embedding": 126,
            "positional_encoding": {
                "n": 43,
                "sigma": 0.021371444170736765,
                "trainable": true,
                "initialization": "normal"
            },
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.0001093080842538706,
            "weight_decay": 1.4529840437784787e-06,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.42184426713203266,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.0001093080842538706,
            "weight_decay": 1.4529840437784787e-06,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post",
            "supervised_weight": 1.0
        },
        "bins": null
    },
    "epoch_size": 104,
    "n_parameters": 1134577,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -0.36513924571392364,
                    "pretrain_loss": 1.2487869262695312,
                    "pretrain_component": 0.6918259263038635,
                    "supervised_component": 0.6243934631347656,
                    "features_accuracy": [
                        0.5825573801994324,
                        0.5908850431442261,
                        0.42243924736976624,
                        0.5379665493965149,
                        0.42349913716316223,
                        0.5537890791893005,
                        0.5803619027137756,
                        0.5749867558479309
                    ]
                },
                "val": {
                    "score": -0.46532488431700386,
                    "pretrain_loss": 1.2094314098358154,
                    "pretrain_component": 0.691946804523468,
                    "supervised_component": 0.6047157049179077,
                    "features_accuracy": [
                        0.5716015696525574,
                        0.5994550585746765,
                        0.41659098863601685,
                        0.5525280237197876,
                        0.41749924421310425,
                        0.5528307557106018,
                        0.573115348815918,
                        0.5555555820465088
                    ]
                },
                "test": {
                    "score": -0.45974947185965,
                    "pretrain_loss": 1.228861689567566,
                    "pretrain_component": 0.6917575597763062,
                    "supervised_component": 0.614430844783783,
                    "features_accuracy": [
                        0.5726743936538696,
                        0.595687985420227,
                        0.42151162028312683,
                        0.5491763353347778,
                        0.4203003942966461,
                        0.5627422332763672,
                        0.580910861492157,
                        0.5641957521438599
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -0.34190497048423385,
                    "pretrain_loss": 1.2078431844711304,
                    "pretrain_component": 0.6917018294334412,
                    "supervised_component": 0.6039215922355652,
                    "features_accuracy": [
                        0.5779393315315247,
                        0.5891438126564026,
                        0.4440154731273651,
                        0.518510103225708,
                        0.4257703125476837,
                        0.5430388450622559,
                        0.5878567695617676,
                        0.558937132358551
                    ]
                },
                "val": {
                    "score": -0.45777861774051865,
                    "pretrain_loss": 1.164997935295105,
                    "pretrain_component": 0.6918883919715881,
                    "supervised_component": 0.5824989676475525,
                    "features_accuracy": [
                        0.5716015696525574,
                        0.5994550585746765,
                        0.42385709285736084,
                        0.5213442444801331,
                        0.41810473799705505,
                        0.5525280237197876,
                        0.573115348815918,
                        0.5522252321243286
                    ]
                },
                "test": {
                    "score": -0.4567895625172788,
                    "pretrain_loss": 1.1851170063018799,
                    "pretrain_component": 0.6917281746864319,
                    "supervised_component": 0.5925585031509399,
                    "features_accuracy": [
                        0.5726743936538696,
                        0.595687985420227,
                        0.43435075879096985,
                        0.5234980583190918,
                        0.42005813121795654,
                        0.5656492114067078,
                        0.580910861492157,
                        0.5591084957122803
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -0.3554941045359262,
                    "pretrain_loss": 1.2006230354309082,
                    "pretrain_component": 0.6917816996574402,
                    "supervised_component": 0.6003115177154541,
                    "features_accuracy": [
                        0.5894466042518616,
                        0.5826330780982971,
                        0.4402301609516144,
                        0.4954954981803894,
                        0.4339465796947479,
                        0.5388750433921814,
                        0.5839200615882874,
                        0.5437201857566833
                    ]
                },
                "val": {
                    "score": -0.4517477907303747,
                    "pretrain_loss": 1.1624253988265991,
                    "pretrain_component": 0.6919301748275757,
                    "supervised_component": 0.5812126994132996,
                    "features_accuracy": [
                        0.5716015696525574,
                        0.5994550585746765,
                        0.41507720947265625,
                        0.5010596513748169,
                        0.41780200600624084,
                        0.5446563959121704,
                        0.573115348815918,
                        0.5395095348358154
                    ]
                },
                "test": {
                    "score": -0.4441338723638696,
                    "pretrain_loss": 1.1789846420288086,
                    "pretrain_component": 0.6917901635169983,
                    "supervised_component": 0.5894923210144043,
                    "features_accuracy": [
                        0.5729166865348816,
                        0.595687985420227,
                        0.4353197515010834,
                        0.49563953280448914,
                        0.41981589794158936,
                        0.5535368323326111,
                        0.580910861492157,
                        0.5455426573753357
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -0.3679055501071388,
                    "pretrain_loss": 1.1371102333068848,
                    "pretrain_component": 0.6916880011558533,
                    "supervised_component": 0.5685551166534424,
                    "features_accuracy": [
                        0.5823302268981934,
                        0.5932319164276123,
                        0.4531758725643158,
                        0.49367856979370117,
                        0.4280414879322052,
                        0.5521993041038513,
                        0.5811189413070679,
                        0.5229767560958862
                    ]
                },
                "val": {
                    "score": -0.4508670512657365,
                    "pretrain_loss": 1.1332988739013672,
                    "pretrain_component": 0.6919015049934387,
                    "supervised_component": 0.5666494369506836,
                    "features_accuracy": [
                        0.5712988376617432,
                        0.5994550585746765,
                        0.4359672963619232,
                        0.5025734305381775,
                        0.41840749979019165,
                        0.5519225001335144,
                        0.573115348815918,
                        0.5298213958740234
                    ]
                },
                "test": {
                    "score": -0.4383381329731379,
                    "pretrain_loss": 1.1438825130462646,
                    "pretrain_component": 0.6917338967323303,
                    "supervised_component": 0.5719412565231323,
                    "features_accuracy": [
                        0.573401153087616,
                        0.595687985420227,
                        0.43968021869659424,
                        0.49539729952812195,
                        0.4207848906517029,
                        0.5564438104629517,
                        0.580910861492157,
                        0.523982584476471
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": -0.3257931587609311,
                    "pretrain_loss": 1.1233022212982178,
                    "pretrain_component": 0.6918874382972717,
                    "supervised_component": 0.5616511106491089,
                    "features_accuracy": [
                        0.5747596621513367,
                        0.5901279449462891,
                        0.49118027091026306,
                        0.4730108380317688,
                        0.4294799268245697,
                        0.5397834777832031,
                        0.5728669762611389,
                        0.4929972290992737
                    ]
                },
                "val": {
                    "score": -0.4456874186123858,
                    "pretrain_loss": 1.130058765411377,
                    "pretrain_component": 0.6919221878051758,
                    "supervised_component": 0.5650293827056885,
                    "features_accuracy": [
                        0.5697850584983826,
                        0.5994550585746765,
                        0.48440811038017273,
                        0.4931880235671997,
                        0.41961851716041565,
                        0.5343626737594604,
                        0.5746291279792786,
                        0.5007568597793579
                    ]
                },
                "test": {
                    "score": -0.4411588211782894,
                    "pretrain_loss": 1.1322283744812012,
                    "pretrain_component": 0.6918116211891174,
                    "supervised_component": 0.5661141872406006,
                    "features_accuracy": [
                        0.5724321603775024,
                        0.595687985420227,
                        0.471414715051651,
                        0.48619186878204346,
                        0.42223837971687317,
                        0.5453003644943237,
                        0.5821220874786377,
                        0.49006783962249756
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": -0.3434026217437648,
                    "pretrain_loss": 1.1218186616897583,
                    "pretrain_component": 0.6918509006500244,
                    "supervised_component": 0.5609093308448792,
                    "features_accuracy": [
                        0.5782421231269836,
                        0.5998940467834473,
                        0.48565372824668884,
                        0.47255662083625793,
                        0.423574835062027,
                        0.5300174355506897,
                        0.5827087759971619,
                        0.4686198830604553
                    ]
                },
                "val": {
                    "score": -0.44692487645040346,
                    "pretrain_loss": 1.1171667575836182,
                    "pretrain_component": 0.6920561194419861,
                    "supervised_component": 0.5585833787918091,
                    "features_accuracy": [
                        0.5716015696525574,
                        0.5994550585746765,
                        0.46594005823135376,
                        0.46533453464508057,
                        0.41961851716041565,
                        0.5273993611335754,
                        0.5734180808067322,
                        0.48319709300994873
                    ]
                },
                "test": {
                    "score": -0.4360032513430714,
                    "pretrain_loss": 1.1285868883132935,
                    "pretrain_component": 0.6919423341751099,
                    "supervised_component": 0.5642934441566467,
                    "features_accuracy": [
                        0.5717054009437561,
                        0.595687985420227,
                        0.46802324056625366,
                        0.4699612259864807,
                        0.42393410205841064,
                        0.5302810072898865,
                        0.5811530947685242,
                        0.4568798542022705
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": -0.3578802521483205,
                    "pretrain_loss": 1.155941367149353,
                    "pretrain_component": 0.6920285820960999,
                    "supervised_component": 0.5779706835746765,
                    "features_accuracy": [
                        0.5793020129203796,
                        0.5880839228630066,
                        0.4864864945411682,
                        0.4659701883792877,
                        0.4275115728378296,
                        0.5245665907859802,
                        0.5808161497116089,
                        0.4719509482383728
                    ]
                },
                "val": {
                    "score": -0.4451693306302108,
                    "pretrain_loss": 1.127488374710083,
                    "pretrain_component": 0.6921039819717407,
                    "supervised_component": 0.5637441873550415,
                    "features_accuracy": [
                        0.5697850584983826,
                        0.5994550585746765,
                        0.47986677289009094,
                        0.46654555201530457,
                        0.42113229632377625,
                        0.5098395347595215,
                        0.5737208724021912,
                        0.4868301451206207
                    ]
                },
                "test": {
                    "score": -0.4351199575252787,
                    "pretrain_loss": 1.126276969909668,
                    "pretrain_component": 0.6919323801994324,
                    "supervised_component": 0.563138484954834,
                    "features_accuracy": [
                        0.5719476938247681,
                        0.595687985420227,
                        0.4755329489707947,
                        0.4777131676673889,
                        0.42781007289886475,
                        0.5101743936538696,
                        0.580910861492157,
                        0.4689922332763672
                    ]
                }
            },
            "80000": {
                "train": {
                    "score": -0.29432918640981026,
                    "pretrain_loss": 1.1381999254226685,
                    "pretrain_component": 0.6919707655906677,
                    "supervised_component": 0.5690999627113342,
                    "features_accuracy": [
                        0.5744568109512329,
                        0.5873268246650696,
                        0.4999621510505676,
                        0.47308653593063354,
                        0.43023696541786194,
                        0.524112343788147,
                        0.5841472148895264,
                        0.48815202713012695
                    ]
                },
                "val": {
                    "score": -0.44216229973734755,
                    "pretrain_loss": 1.116377592086792,
                    "pretrain_component": 0.6920696496963501,
                    "supervised_component": 0.558188796043396,
                    "features_accuracy": [
                        0.5716015696525574,
                        0.5994550585746765,
                        0.5001513957977295,
                        0.47532546520233154,
                        0.42082953453063965,
                        0.5198304653167725,
                        0.5743263959884644,
                        0.4913714826107025
                    ]
                },
                "test": {
                    "score": -0.43476580051353797,
                    "pretrain_loss": 1.1316722631454468,
                    "pretrain_component": 0.6919346451759338,
                    "supervised_component": 0.5658361315727234,
                    "features_accuracy": [
                        0.5721899271011353,
                        0.595687985420227,
                        0.4920058250427246,
                        0.4752906858921051,
                        0.427325576543808,
                        0.5208333134651184,
                        0.5806686282157898,
                        0.47989341616630554
                    ]
                }
            },
            "90000": {
                "train": {
                    "score": -0.3156329587126031,
                    "pretrain_loss": 1.126489520072937,
                    "pretrain_component": 0.6921497583389282,
                    "supervised_component": 0.5632447600364685,
                    "features_accuracy": [
                        0.5646150708198547,
                        0.596790075302124,
                        0.5132864117622375,
                        0.465894490480423,
                        0.42758727073669434,
                        0.4926943778991699,
                        0.5835415720939636,
                        0.47626620531082153
                    ]
                },
                "val": {
                    "score": -0.4447850222649891,
                    "pretrain_loss": 1.1181225776672363,
                    "pretrain_component": 0.6922664642333984,
                    "supervised_component": 0.5590612888336182,
                    "features_accuracy": [
                        0.5594913959503174,
                        0.5994550585746765,
                        0.5186194181442261,
                        0.46321526169776917,
                        0.42052680253982544,
                        0.5134726166725159,
                        0.5734180808067322,
                        0.4919769763946533
                    ]
                },
                "test": {
                    "score": -0.43256658974697504,
                    "pretrain_loss": 1.1216486692428589,
                    "pretrain_component": 0.6921149492263794,
                    "supervised_component": 0.5608243346214294,
                    "features_accuracy": [
                        0.565891444683075,
                        0.595687985420227,
                        0.4975775182247162,
                        0.4704457223415375,
                        0.4285368323326111,
                        0.5070251822471619,
                        0.580910861492157,
                        0.47311046719551086
                    ]
                }
            },
            "100000": {
                "train": {
                    "score": -0.32608632640491614,
                    "pretrain_loss": 1.1074856519699097,
                    "pretrain_component": 0.6921993494033813,
                    "supervised_component": 0.5537428259849548,
                    "features_accuracy": [
                        0.5705958008766174,
                        0.5939889550209045,
                        0.499432235956192,
                        0.4624119997024536,
                        0.42054662108421326,
                        0.5099553465843201,
                        0.5766522884368896,
                        0.47891589999198914
                    ]
                },
                "val": {
                    "score": -0.4440514114261358,
                    "pretrain_loss": 1.1057524681091309,
                    "pretrain_component": 0.6923372745513916,
                    "supervised_component": 0.5528762340545654,
                    "features_accuracy": [
                        0.5610051155090332,
                        0.5994550585746765,
                        0.4950045347213745,
                        0.45958220958709717,
                        0.42506811022758484,
                        0.5019679069519043,
                        0.5737208724021912,
                        0.4862246513366699
                    ]
                },
                "test": {
                    "score": -0.4274051022983261,
                    "pretrain_loss": 1.1418555974960327,
                    "pretrain_component": 0.6921721696853638,
                    "supervised_component": 0.5709277987480164,
                    "features_accuracy": [
                        0.5668604373931885,
                        0.595687985420227,
                        0.4818314015865326,
                        0.4622093141078949,
                        0.4312015473842621,
                        0.5043604373931885,
                        0.580910861492157,
                        0.46826550364494324
                    ]
                }
            }
        },
        "train": {
            "score": -0.29432918640981026
        },
        "val": {
            "score": -0.44216229973734755
        },
        "test": {
            "score": -0.43476580051353797
        }
    },
    "best_iteration": 80000,
    "time": "0:09:24"
}
