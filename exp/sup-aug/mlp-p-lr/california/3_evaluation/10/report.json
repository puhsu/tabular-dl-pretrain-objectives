{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised___6dee678da31042e5ac2f58534076ba29.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 10,
        "data": {
            "path": "data/california",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512,
                    512
                ],
                "dropout": 0.0
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "positional",
                "linear",
                "relu"
            ],
            "d_num_embedding": 126,
            "positional_encoding": {
                "n": 43,
                "sigma": 0.021371444170736765,
                "trainable": true,
                "initialization": "normal"
            },
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.0001093080842538706,
            "weight_decay": 1.4529840437784787e-06,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.42184426713203266,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.0001093080842538706,
            "weight_decay": 1.4529840437784787e-06,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post",
            "supervised_weight": 1.0
        },
        "bins": null
    },
    "epoch_size": 104,
    "n_parameters": 1134577,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -0.33263087787665,
                    "pretrain_loss": 1.2687665224075317,
                    "pretrain_component": 0.6939076781272888,
                    "supervised_component": 0.6343832612037659,
                    "features_accuracy": [
                        0.44318270683288574,
                        0.5899008512496948,
                        0.516087532043457,
                        0.5492467284202576,
                        0.42009237408638,
                        0.5056400895118713,
                        0.4203951954841614,
                        0.4779317378997803
                    ]
                },
                "val": {
                    "score": -0.46420409433440873,
                    "pretrain_loss": 1.2568844556808472,
                    "pretrain_component": 0.6939993500709534,
                    "supervised_component": 0.6284422278404236,
                    "features_accuracy": [
                        0.4408113956451416,
                        0.5834090113639832,
                        0.5171056389808655,
                        0.538298487663269,
                        0.42779290676116943,
                        0.4889494478702545,
                        0.41356343030929565,
                        0.46533453464508057
                    ]
                },
                "test": {
                    "score": -0.4632599113404228,
                    "pretrain_loss": 1.282049298286438,
                    "pretrain_component": 0.6940193772315979,
                    "supervised_component": 0.641024649143219,
                    "features_accuracy": [
                        0.4389534890651703,
                        0.5835756063461304,
                        0.5167151093482971,
                        0.5671027302742004,
                        0.4178779125213623,
                        0.5058139562606812,
                        0.41497093439102173,
                        0.4765019416809082
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -0.37347416635399944,
                    "pretrain_loss": 1.199374794960022,
                    "pretrain_component": 0.6938773393630981,
                    "supervised_component": 0.599687397480011,
                    "features_accuracy": [
                        0.4478764533996582,
                        0.5918691754341125,
                        0.5266863703727722,
                        0.5366795659065247,
                        0.42516466975212097,
                        0.5306987762451172,
                        0.4163827896118164,
                        0.46725720167160034
                    ]
                },
                "val": {
                    "score": -0.4571242860017258,
                    "pretrain_loss": 1.2196470499038696,
                    "pretrain_component": 0.693993866443634,
                    "supervised_component": 0.6098235249519348,
                    "features_accuracy": [
                        0.4471692442893982,
                        0.5837118029594421,
                        0.5349681973457336,
                        0.5292158722877502,
                        0.42779290676116943,
                        0.5198304653167725,
                        0.41356343030929565,
                        0.4535270929336548
                    ]
                },
                "test": {
                    "score": -0.4501233540003914,
                    "pretrain_loss": 1.2227802276611328,
                    "pretrain_component": 0.6939166188240051,
                    "supervised_component": 0.6113901138305664,
                    "features_accuracy": [
                        0.44573643803596497,
                        0.5833333134651184,
                        0.5302810072898865,
                        0.5499030947685242,
                        0.4178779125213623,
                        0.5443313717842102,
                        0.41497093439102173,
                        0.45639535784721375
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -0.36396952384575,
                    "pretrain_loss": 1.2005177736282349,
                    "pretrain_component": 0.6938411593437195,
                    "supervised_component": 0.6002588868141174,
                    "features_accuracy": [
                        0.4636233150959015,
                        0.5854341983795166,
                        0.5335755944252014,
                        0.5107881426811218,
                        0.4213793873786926,
                        0.5137406587600708,
                        0.4325081408023834,
                        0.457642525434494
                    ]
                },
                "val": {
                    "score": -0.4475488476269779,
                    "pretrain_loss": 1.2025253772735596,
                    "pretrain_component": 0.6940078139305115,
                    "supervised_component": 0.6012626886367798,
                    "features_accuracy": [
                        0.46624282002449036,
                        0.5837118029594421,
                        0.5373902320861816,
                        0.5104450583457947,
                        0.42688465118408203,
                        0.5134726166725159,
                        0.41356343030929565,
                        0.4462609589099884
                    ]
                },
                "test": {
                    "score": -0.44416952762762973,
                    "pretrain_loss": 1.2281792163848877,
                    "pretrain_component": 0.6939501166343689,
                    "supervised_component": 0.6140896081924438,
                    "features_accuracy": [
                        0.45251938700675964,
                        0.5826066136360168,
                        0.5314922332763672,
                        0.5227712988853455,
                        0.41860464215278625,
                        0.5125969052314758,
                        0.41497093439102173,
                        0.4508236348628998
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -0.3474283318514057,
                    "pretrain_loss": 1.1577764749526978,
                    "pretrain_component": 0.693839430809021,
                    "supervised_component": 0.5788882374763489,
                    "features_accuracy": [
                        0.46869561076164246,
                        0.5907335877418518,
                        0.5245665907859802,
                        0.518207311630249,
                        0.4256189167499542,
                        0.5291846394538879,
                        0.41751837730407715,
                        0.46460747718811035
                    ]
                },
                "val": {
                    "score": -0.44619516622497235,
                    "pretrain_loss": 1.1946285963058472,
                    "pretrain_component": 0.6939560770988464,
                    "supervised_component": 0.5973142981529236,
                    "features_accuracy": [
                        0.47471994161605835,
                        0.5834090113639832,
                        0.5207387208938599,
                        0.5016651749610901,
                        0.431728720664978,
                        0.5155918598175049,
                        0.41356343030929565,
                        0.448985755443573
                    ]
                },
                "test": {
                    "score": -0.4374632929904004,
                    "pretrain_loss": 1.209330439567566,
                    "pretrain_component": 0.6938450336456299,
                    "supervised_component": 0.604665219783783,
                    "features_accuracy": [
                        0.4607558250427246,
                        0.5835756063461304,
                        0.5244670510292053,
                        0.5297964811325073,
                        0.42102712392807007,
                        0.5297964811325073,
                        0.41497093439102173,
                        0.4568798542022705
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": -0.3372137800239534,
                    "pretrain_loss": 1.1517996788024902,
                    "pretrain_component": 0.6939432621002197,
                    "supervised_component": 0.5758998394012451,
                    "features_accuracy": [
                        0.47785601019859314,
                        0.5892195105552673,
                        0.5148762464523315,
                        0.5142706036567688,
                        0.4225906729698181,
                        0.5004920959472656,
                        0.4252403676509857,
                        0.4572640061378479
                    ]
                },
                "val": {
                    "score": -0.445574074291099,
                    "pretrain_loss": 1.198054552078247,
                    "pretrain_component": 0.6941342949867249,
                    "supervised_component": 0.5990272760391235,
                    "features_accuracy": [
                        0.48440811038017273,
                        0.5834090113639832,
                        0.5025734305381775,
                        0.4986375868320465,
                        0.4296094477176666,
                        0.4919769763946533,
                        0.41356343030929565,
                        0.447774738073349
                    ]
                },
                "test": {
                    "score": -0.43597222264157004,
                    "pretrain_loss": 1.223816156387329,
                    "pretrain_component": 0.6940566897392273,
                    "supervised_component": 0.6119080781936646,
                    "features_accuracy": [
                        0.4711724817752838,
                        0.5833333134651184,
                        0.5179263353347778,
                        0.5244670510292053,
                        0.4217538833618164,
                        0.4944283068180084,
                        0.41497093439102173,
                        0.4595445692539215
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": -0.3223508086906236,
                    "pretrain_loss": 1.133170485496521,
                    "pretrain_component": 0.69394850730896,
                    "supervised_component": 0.5665852427482605,
                    "features_accuracy": [
                        0.479067325592041,
                        0.5824816823005676,
                        0.4979937970638275,
                        0.5244151949882507,
                        0.42478615045547485,
                        0.5131350159645081,
                        0.41607996821403503,
                        0.4726323187351227
                    ]
                },
                "val": {
                    "score": -0.4459810609331607,
                    "pretrain_loss": 1.2018197774887085,
                    "pretrain_component": 0.6940668821334839,
                    "supervised_component": 0.6009098887443542,
                    "features_accuracy": [
                        0.47835302352905273,
                        0.5791704654693604,
                        0.4977293312549591,
                        0.5065092444419861,
                        0.42749014496803284,
                        0.5007568597793579,
                        0.41326066851615906,
                        0.46200424432754517
                    ]
                },
                "test": {
                    "score": -0.4307812092235173,
                    "pretrain_loss": 1.2058862447738647,
                    "pretrain_component": 0.6940015554428101,
                    "supervised_component": 0.6029431223869324,
                    "features_accuracy": [
                        0.4609980583190918,
                        0.5780038833618164,
                        0.4963662624359131,
                        0.5264050364494324,
                        0.4217538833618164,
                        0.5196220874786377,
                        0.41497093439102173,
                        0.4794089198112488
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": -0.3179195954061614,
                    "pretrain_loss": 1.142676591873169,
                    "pretrain_component": 0.6939772367477417,
                    "supervised_component": 0.5713382959365845,
                    "features_accuracy": [
                        0.4873949885368347,
                        0.5945945978164673,
                        0.5072299242019653,
                        0.5455371737480164,
                        0.42440760135650635,
                        0.4823983907699585,
                        0.4191839098930359,
                        0.4924672842025757
                    ]
                },
                "val": {
                    "score": -0.44068514757929766,
                    "pretrain_loss": 1.1743900775909424,
                    "pretrain_component": 0.6941512823104858,
                    "supervised_component": 0.5871950387954712,
                    "features_accuracy": [
                        0.48652738332748413,
                        0.580684244632721,
                        0.4989403486251831,
                        0.5331516861915588,
                        0.43021494150161743,
                        0.4871329069137573,
                        0.41356343030929565,
                        0.46927034854888916
                    ]
                },
                "test": {
                    "score": -0.4364755679211723,
                    "pretrain_loss": 1.193748950958252,
                    "pretrain_component": 0.6940740942955017,
                    "supervised_component": 0.596874475479126,
                    "features_accuracy": [
                        0.4738371968269348,
                        0.5801841020584106,
                        0.5106589198112488,
                        0.5545058250427246,
                        0.42538759112358093,
                        0.487160861492157,
                        0.41497093439102173,
                        0.4765019416809082
                    ]
                }
            },
            "80000": {
                "train": {
                    "score": -0.30664498130007045,
                    "pretrain_loss": 1.151886224746704,
                    "pretrain_component": 0.6940555572509766,
                    "supervised_component": 0.575943112373352,
                    "features_accuracy": [
                        0.48550233244895935,
                        0.5822545289993286,
                        0.5038988590240479,
                        0.5418275594711304,
                        0.42849573493003845,
                        0.47838595509529114,
                        0.41645848751068115,
                        0.4760390818119049
                    ]
                },
                "val": {
                    "score": -0.4397084258443077,
                    "pretrain_loss": 1.1785484552383423,
                    "pretrain_component": 0.6941767334938049,
                    "supervised_component": 0.5892742276191711,
                    "features_accuracy": [
                        0.4974265694618225,
                        0.5734180808067322,
                        0.4892521798610687,
                        0.5367847681045532,
                        0.4308204650878906,
                        0.48168331384658813,
                        0.41356343030929565,
                        0.46503180265426636
                    ]
                },
                "test": {
                    "score": -0.43031621579126444,
                    "pretrain_loss": 1.1815106868743896,
                    "pretrain_component": 0.6941381096839905,
                    "supervised_component": 0.5907553434371948,
                    "features_accuracy": [
                        0.4857073724269867,
                        0.565891444683075,
                        0.5067829489707947,
                        0.5557170510292053,
                        0.42369186878204346,
                        0.46438953280448914,
                        0.41497093439102173,
                        0.4689922332763672
                    ]
                }
            },
            "90000": {
                "train": {
                    "score": -0.3006359104580435,
                    "pretrain_loss": 1.1205562353134155,
                    "pretrain_component": 0.694034218788147,
                    "supervised_component": 0.5602781176567078,
                    "features_accuracy": [
                        0.48126280307769775,
                        0.5771822333335876,
                        0.4976152777671814,
                        0.5540162324905396,
                        0.424104779958725,
                        0.46990689635276794,
                        0.41910821199417114,
                        0.4863350987434387
                    ]
                },
                "val": {
                    "score": -0.4414007989948876,
                    "pretrain_loss": 1.160394310951233,
                    "pretrain_component": 0.6940887570381165,
                    "supervised_component": 0.5801971554756165,
                    "features_accuracy": [
                        0.4874356687068939,
                        0.5688768029212952,
                        0.4834998548030853,
                        0.5416288375854492,
                        0.4350590407848358,
                        0.47714197635650635,
                        0.41386619210243225,
                        0.48077505826950073
                    ]
                },
                "test": {
                    "score": -0.4290878108106777,
                    "pretrain_loss": 1.1787539720535278,
                    "pretrain_component": 0.6940783262252808,
                    "supervised_component": 0.5893769860267639,
                    "features_accuracy": [
                        0.47214147448539734,
                        0.5702519416809082,
                        0.505329430103302,
                        0.5506298542022705,
                        0.4232073724269867,
                        0.4636628031730652,
                        0.41497093439102173,
                        0.4830426275730133
                    ]
                }
            },
            "100000": {
                "train": {
                    "score": -0.3082668209961001,
                    "pretrain_loss": 1.1235630512237549,
                    "pretrain_component": 0.693936288356781,
                    "supervised_component": 0.5617815256118774,
                    "features_accuracy": [
                        0.48194414377212524,
                        0.5802862048149109,
                        0.4788402020931244,
                        0.5591642260551453,
                        0.4298584461212158,
                        0.48588085174560547,
                        0.42243924736976624,
                        0.5008706450462341
                    ]
                },
                "val": {
                    "score": -0.4416352590017371,
                    "pretrain_loss": 1.1661458015441895,
                    "pretrain_component": 0.6941090226173401,
                    "supervised_component": 0.5830729007720947,
                    "features_accuracy": [
                        0.4889494478702545,
                        0.5691795349121094,
                        0.46442627906799316,
                        0.5473811626434326,
                        0.4389948546886444,
                        0.4871329069137573,
                        0.41386619210243225,
                        0.4971238374710083
                    ]
                },
                "test": {
                    "score": -0.42999369569721635,
                    "pretrain_loss": 1.1691406965255737,
                    "pretrain_component": 0.6940798759460449,
                    "supervised_component": 0.5845703482627869,
                    "features_accuracy": [
                        0.4699612259864807,
                        0.5683139562606812,
                        0.4767441749572754,
                        0.5600774884223938,
                        0.4377422332763672,
                        0.48498061299324036,
                        0.4152131676673889,
                        0.4949128031730652
                    ]
                }
            }
        },
        "train": {
            "score": -0.30664498130007045
        },
        "val": {
            "score": -0.4397084258443077
        },
        "test": {
            "score": -0.43031621579126444
        }
    },
    "best_iteration": 80000,
    "time": "0:09:05"
}
