{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised___6dee678da31042e5ac2f58534076ba29.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 8,
        "data": {
            "path": "data/california",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512,
                    512
                ],
                "dropout": 0.0
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "positional",
                "linear",
                "relu"
            ],
            "d_num_embedding": 126,
            "positional_encoding": {
                "n": 43,
                "sigma": 0.021371444170736765,
                "trainable": true,
                "initialization": "normal"
            },
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.0001093080842538706,
            "weight_decay": 1.4529840437784787e-06,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.42184426713203266,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.0001093080842538706,
            "weight_decay": 1.4529840437784787e-06,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post",
            "supervised_weight": 1.0
        },
        "bins": null
    },
    "epoch_size": 104,
    "n_parameters": 1134577,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -0.3636270309564625,
                    "pretrain_loss": 1.2468937635421753,
                    "pretrain_component": 0.6937123537063599,
                    "supervised_component": 0.6234468817710876,
                    "features_accuracy": [
                        0.4818684458732605,
                        0.419562429189682,
                        0.49065032601356506,
                        0.5802862048149109,
                        0.42296919226646423,
                        0.4269816279411316,
                        0.5840714573860168,
                        0.4213036596775055
                    ]
                },
                "val": {
                    "score": -0.4652559939074745,
                    "pretrain_loss": 1.2289379835128784,
                    "pretrain_component": 0.6937423348426819,
                    "supervised_component": 0.6144689917564392,
                    "features_accuracy": [
                        0.47956404089927673,
                        0.4432334303855896,
                        0.48410534858703613,
                        0.5800787210464478,
                        0.43021494150161743,
                        0.4311232268810272,
                        0.5712988376617432,
                        0.41265517473220825
                    ]
                },
                "test": {
                    "score": -0.4580375383643889,
                    "pretrain_loss": 1.2910194396972656,
                    "pretrain_component": 0.6937612891197205,
                    "supervised_component": 0.6455097198486328,
                    "features_accuracy": [
                        0.4777131676673889,
                        0.424660861492157,
                        0.4844961166381836,
                        0.5712209343910217,
                        0.42514535784721375,
                        0.42756783962249756,
                        0.5789728760719299,
                        0.42223837971687317
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -0.3763739089920115,
                    "pretrain_loss": 1.1947598457336426,
                    "pretrain_component": 0.6938071250915527,
                    "supervised_component": 0.5973799228668213,
                    "features_accuracy": [
                        0.4799000918865204,
                        0.41221895813941956,
                        0.5326671600341797,
                        0.5739268660545349,
                        0.42637598514556885,
                        0.42546749114990234,
                        0.5821788311004639,
                        0.4186539649963379
                    ]
                },
                "val": {
                    "score": -0.4555813233655236,
                    "pretrain_loss": 1.176231026649475,
                    "pretrain_component": 0.6937612295150757,
                    "supervised_component": 0.5881155133247375,
                    "features_accuracy": [
                        0.47714197635650635,
                        0.4353618025779724,
                        0.5143808722496033,
                        0.5788676738739014,
                        0.4314259886741638,
                        0.4308204650878906,
                        0.5719043016433716,
                        0.41447168588638306
                    ]
                },
                "test": {
                    "score": -0.4470151814191398,
                    "pretrain_loss": 1.2446579933166504,
                    "pretrain_component": 0.6938341856002808,
                    "supervised_component": 0.6223289966583252,
                    "features_accuracy": [
                        0.48352712392807007,
                        0.4166666567325592,
                        0.5099321603775024,
                        0.5719476938247681,
                        0.42514535784721375,
                        0.427325576543808,
                        0.5787306427955627,
                        0.42369186878204346
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -0.35513399986635874,
                    "pretrain_loss": 1.1657135486602783,
                    "pretrain_component": 0.6938326358795166,
                    "supervised_component": 0.5828567743301392,
                    "features_accuracy": [
                        0.48512378334999084,
                        0.4266788065433502,
                        0.4969339370727539,
                        0.5751382112503052,
                        0.4248618483543396,
                        0.4261488616466522,
                        0.5838443636894226,
                        0.419562429189682
                    ]
                },
                "val": {
                    "score": -0.45141810663307086,
                    "pretrain_loss": 1.1749169826507568,
                    "pretrain_component": 0.6938513517379761,
                    "supervised_component": 0.5874584913253784,
                    "features_accuracy": [
                        0.4862246513366699,
                        0.4447472095489502,
                        0.47744473814964294,
                        0.5764456391334534,
                        0.4368755519390106,
                        0.4326370060443878,
                        0.5716015696525574,
                        0.41235241293907166
                    ]
                },
                "test": {
                    "score": -0.43880242458066543,
                    "pretrain_loss": 1.2234894037246704,
                    "pretrain_component": 0.6939178109169006,
                    "supervised_component": 0.6117447018623352,
                    "features_accuracy": [
                        0.49539729952812195,
                        0.42659884691238403,
                        0.48255813121795654,
                        0.5690407156944275,
                        0.43023255467414856,
                        0.4282945692539215,
                        0.5789728760719299,
                        0.4219961166381836
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -0.34879709927181574,
                    "pretrain_loss": 1.1706750392913818,
                    "pretrain_component": 0.6937376260757446,
                    "supervised_component": 0.5853375196456909,
                    "features_accuracy": [
                        0.5066999793052673,
                        0.42084944248199463,
                        0.46793854236602783,
                        0.5736240744590759,
                        0.4252403676509857,
                        0.4376561641693115,
                        0.5765008926391602,
                        0.445529580116272
                    ]
                },
                "val": {
                    "score": -0.44617343867173176,
                    "pretrain_loss": 1.1593352556228638,
                    "pretrain_component": 0.6937316060066223,
                    "supervised_component": 0.5796676278114319,
                    "features_accuracy": [
                        0.5080230236053467,
                        0.4438389241695404,
                        0.46412351727485657,
                        0.5746291279792786,
                        0.4365728199481964,
                        0.431728720664978,
                        0.5716015696525574,
                        0.42506811022758484
                    ]
                },
                "test": {
                    "score": -0.43800607695723026,
                    "pretrain_loss": 1.203874111175537,
                    "pretrain_component": 0.6937917470932007,
                    "supervised_component": 0.6019370555877686,
                    "features_accuracy": [
                        0.5099321603775024,
                        0.42611435055732727,
                        0.47189921140670776,
                        0.570009708404541,
                        0.42781007289886475,
                        0.42490309476852417,
                        0.5789728760719299,
                        0.4336240291595459
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": -0.33588309960944907,
                    "pretrain_loss": 1.153286099433899,
                    "pretrain_component": 0.6937456130981445,
                    "supervised_component": 0.5766430497169495,
                    "features_accuracy": [
                        0.5042774081230164,
                        0.43235674500465393,
                        0.4736922085285187,
                        0.5744568109512329,
                        0.4326595664024353,
                        0.42016807198524475,
                        0.5808161497116089,
                        0.45045047998428345
                    ]
                },
                "val": {
                    "score": -0.4430373973818476,
                    "pretrain_loss": 1.16019868850708,
                    "pretrain_component": 0.6938027739524841,
                    "supervised_component": 0.58009934425354,
                    "features_accuracy": [
                        0.4989403486251831,
                        0.4386920928955078,
                        0.4580684304237366,
                        0.5743263959884644,
                        0.438086599111557,
                        0.4320314824581146,
                        0.5709960460662842,
                        0.4408113956451416
                    ]
                },
                "test": {
                    "score": -0.43592493875634103,
                    "pretrain_loss": 1.2110381126403809,
                    "pretrain_component": 0.6937898993492126,
                    "supervised_component": 0.6055190563201904,
                    "features_accuracy": [
                        0.5191376209259033,
                        0.4307170510292053,
                        0.46535852551460266,
                        0.5709787011146545,
                        0.43168604373931885,
                        0.4282945692539215,
                        0.5794573426246643,
                        0.4571220874786377
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": -0.3264757670677898,
                    "pretrain_loss": 1.1218581199645996,
                    "pretrain_component": 0.6936966776847839,
                    "supervised_component": 0.5609290599822998,
                    "features_accuracy": [
                        0.4843667447566986,
                        0.4324324429035187,
                        0.4657430648803711,
                        0.5752139091491699,
                        0.4250889718532562,
                        0.4236505627632141,
                        0.5774850845336914,
                        0.4731622636318207
                    ]
                },
                "val": {
                    "score": -0.4432034737692754,
                    "pretrain_loss": 1.1382663249969482,
                    "pretrain_component": 0.6937459707260132,
                    "supervised_component": 0.5691331624984741,
                    "features_accuracy": [
                        0.4880411624908447,
                        0.4377838373184204,
                        0.46442627906799316,
                        0.5737208724021912,
                        0.4323342442512512,
                        0.4283984303474426,
                        0.5691795349121094,
                        0.46230700612068176
                    ]
                },
                "test": {
                    "score": -0.4344620603807716,
                    "pretrain_loss": 1.2148882150650024,
                    "pretrain_component": 0.6937257051467896,
                    "supervised_component": 0.6074441075325012,
                    "features_accuracy": [
                        0.49660852551460266,
                        0.4282945692539215,
                        0.47189921140670776,
                        0.569767415523529,
                        0.42877906560897827,
                        0.4270833432674408,
                        0.5784883499145508,
                        0.46947672963142395
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": -0.35449410744881305,
                    "pretrain_loss": 1.157165765762329,
                    "pretrain_component": 0.6936229467391968,
                    "supervised_component": 0.5785828828811646,
                    "features_accuracy": [
                        0.47755318880081177,
                        0.44409117102622986,
                        0.4649102985858917,
                        0.5800590515136719,
                        0.4199409782886505,
                        0.42743584513664246,
                        0.5819517374038696,
                        0.47331365942955017
                    ]
                },
                "val": {
                    "score": -0.4411804772312444,
                    "pretrain_loss": 1.1410102844238281,
                    "pretrain_component": 0.6936924457550049,
                    "supervised_component": 0.5705051422119141,
                    "features_accuracy": [
                        0.48198607563972473,
                        0.4474720060825348,
                        0.46654555201530457,
                        0.575537383556366,
                        0.431728720664978,
                        0.42930668592453003,
                        0.57069331407547,
                        0.47441720962524414
                    ]
                },
                "test": {
                    "score": -0.4293221460652454,
                    "pretrain_loss": 1.1958292722702026,
                    "pretrain_component": 0.6937249898910522,
                    "supervised_component": 0.5979146361351013,
                    "features_accuracy": [
                        0.4910368323326111,
                        0.43047481775283813,
                        0.46802324056625366,
                        0.5712209343910217,
                        0.4244185984134674,
                        0.4282945692539215,
                        0.5765503644943237,
                        0.47722867131233215
                    ]
                }
            },
            "80000": {
                "train": {
                    "score": -0.3459120193846836,
                    "pretrain_loss": 1.1640092134475708,
                    "pretrain_component": 0.6936929821968079,
                    "supervised_component": 0.5820046067237854,
                    "features_accuracy": [
                        0.497842401266098,
                        0.4291013777256012,
                        0.47187525033950806,
                        0.5695359706878662,
                        0.4294799268245697,
                        0.4213793873786926,
                        0.5858884453773499,
                        0.46581876277923584
                    ]
                },
                "val": {
                    "score": -0.44268222936997553,
                    "pretrain_loss": 1.1338504552841187,
                    "pretrain_component": 0.6937559843063354,
                    "supervised_component": 0.5669252276420593,
                    "features_accuracy": [
                        0.4901604652404785,
                        0.4444444477558136,
                        0.47805026173591614,
                        0.5716015696525574,
                        0.4299122095108032,
                        0.4296094477176666,
                        0.5709960460662842,
                        0.4577656686306
                    ]
                },
                "test": {
                    "score": -0.43137823501427375,
                    "pretrain_loss": 1.181586503982544,
                    "pretrain_component": 0.6938072443008423,
                    "supervised_component": 0.590793251991272,
                    "features_accuracy": [
                        0.49951550364494324,
                        0.4280523359775543,
                        0.4738371968269348,
                        0.5671027302742004,
                        0.4234496057033539,
                        0.42877906560897827,
                        0.5782461166381836,
                        0.458575576543808
                    ]
                }
            },
            "90000": {
                "train": {
                    "score": -0.30381074463920055,
                    "pretrain_loss": 1.1151494979858398,
                    "pretrain_component": 0.6935710906982422,
                    "supervised_component": 0.5575747489929199,
                    "features_accuracy": [
                        0.49102887511253357,
                        0.42917710542678833,
                        0.4662730097770691,
                        0.5801347494125366,
                        0.42796579003334045,
                        0.42516466975212097,
                        0.5836172699928284,
                        0.4708910882472992
                    ]
                },
                "val": {
                    "score": -0.44181219785038145,
                    "pretrain_loss": 1.1432019472122192,
                    "pretrain_component": 0.6936535239219666,
                    "supervised_component": 0.5716009736061096,
                    "features_accuracy": [
                        0.48531636595726013,
                        0.4462609589099884,
                        0.47048136591911316,
                        0.5758401155471802,
                        0.4311232268810272,
                        0.42688465118408203,
                        0.5712988376617432,
                        0.4583711624145508
                    ]
                },
                "test": {
                    "score": -0.43202061876713777,
                    "pretrain_loss": 1.1819770336151123,
                    "pretrain_component": 0.6937320232391357,
                    "supervised_component": 0.5909885168075562,
                    "features_accuracy": [
                        0.49176356196403503,
                        0.4282945692539215,
                        0.4675387442111969,
                        0.5719476938247681,
                        0.4234496057033539,
                        0.43047481775283813,
                        0.5792151093482971,
                        0.45760658383369446
                    ]
                }
            },
            "100000": {
                "train": {
                    "score": -0.33393200915159704,
                    "pretrain_loss": 1.0862820148468018,
                    "pretrain_component": 0.6934735774993896,
                    "supervised_component": 0.5431410074234009,
                    "features_accuracy": [
                        0.49224016070365906,
                        0.4334166347980499,
                        0.481489896774292,
                        0.5766522884368896,
                        0.42622455954551697,
                        0.43182680010795593,
                        0.5766522884368896,
                        0.45627981424331665
                    ]
                },
                "val": {
                    "score": -0.43929441715416173,
                    "pretrain_loss": 1.1262694597244263,
                    "pretrain_component": 0.6935060024261475,
                    "supervised_component": 0.5631347298622131,
                    "features_accuracy": [
                        0.4838026165962219,
                        0.442930668592453,
                        0.47774749994277954,
                        0.578262209892273,
                        0.4287011921405792,
                        0.431728720664978,
                        0.5716015696525574,
                        0.4514078199863434
                    ]
                },
                "test": {
                    "score": -0.4293268445559576,
                    "pretrain_loss": 1.1894699335098267,
                    "pretrain_component": 0.6935809254646301,
                    "supervised_component": 0.5947349667549133,
                    "features_accuracy": [
                        0.5004844665527344,
                        0.4234496057033539,
                        0.47335270047187805,
                        0.5707364082336426,
                        0.42659884691238403,
                        0.43580424785614014,
                        0.5792151093482971,
                        0.44888564944267273
                    ]
                }
            }
        },
        "train": {
            "score": -0.33393200915159704
        },
        "val": {
            "score": -0.43929441715416173
        },
        "test": {
            "score": -0.4293268445559576
        }
    },
    "best_iteration": 100000,
    "time": "0:09:16"
}
