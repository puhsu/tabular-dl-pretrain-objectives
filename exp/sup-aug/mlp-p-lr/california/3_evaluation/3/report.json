{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised___6dee678da31042e5ac2f58534076ba29.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 3,
        "data": {
            "path": "data/california",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512,
                    512
                ],
                "dropout": 0.0
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "positional",
                "linear",
                "relu"
            ],
            "d_num_embedding": 126,
            "positional_encoding": {
                "n": 43,
                "sigma": 0.021371444170736765,
                "trainable": true,
                "initialization": "normal"
            },
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.0001093080842538706,
            "weight_decay": 1.4529840437784787e-06,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.42184426713203266,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.0001093080842538706,
            "weight_decay": 1.4529840437784787e-06,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post",
            "supervised_weight": 1.0
        },
        "bins": null
    },
    "epoch_size": 104,
    "n_parameters": 1134577,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -0.37017390606323186,
                    "pretrain_loss": 1.2309561967849731,
                    "pretrain_component": 0.6933091878890991,
                    "supervised_component": 0.6154780983924866,
                    "features_accuracy": [
                        0.5719585418701172,
                        0.49367856979370117,
                        0.5220683217048645,
                        0.42955562472343445,
                        0.5479597449302673,
                        0.43508216738700867,
                        0.4266030788421631,
                        0.419032484292984
                    ]
                },
                "val": {
                    "score": -0.46440580060612485,
                    "pretrain_loss": 1.2152965068817139,
                    "pretrain_component": 0.6931126713752747,
                    "supervised_component": 0.6076482534408569,
                    "features_accuracy": [
                        0.5912806391716003,
                        0.4968210756778717,
                        0.5158946514129639,
                        0.42597639560699463,
                        0.5455646514892578,
                        0.4371783137321472,
                        0.431728720664978,
                        0.42809566855430603
                    ]
                },
                "test": {
                    "score": -0.4609740214371824,
                    "pretrain_loss": 1.2396725416183472,
                    "pretrain_component": 0.693239152431488,
                    "supervised_component": 0.6198362708091736,
                    "features_accuracy": [
                        0.5867248177528381,
                        0.48885658383369446,
                        0.5307654738426208,
                        0.4154554307460785,
                        0.5433623790740967,
                        0.45009690523147583,
                        0.4142441749572754,
                        0.419089138507843
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -0.33176065738363264,
                    "pretrain_loss": 1.2247158288955688,
                    "pretrain_component": 0.693311333656311,
                    "supervised_component": 0.6123579144477844,
                    "features_accuracy": [
                        0.570141613483429,
                        0.49965932965278625,
                        0.5425845980644226,
                        0.4257703125476837,
                        0.5544704794883728,
                        0.43167537450790405,
                        0.42902567982673645,
                        0.420622318983078
                    ]
                },
                "val": {
                    "score": -0.4588021368438825,
                    "pretrain_loss": 1.1707720756530762,
                    "pretrain_component": 0.6931094527244568,
                    "supervised_component": 0.5853860378265381,
                    "features_accuracy": [
                        0.5912806391716003,
                        0.5016651749610901,
                        0.5343626737594604,
                        0.4283984303474426,
                        0.5498031973838806,
                        0.42446261644363403,
                        0.43021494150161743,
                        0.42749014496803284
                    ]
                },
                "test": {
                    "score": -0.4558837163827139,
                    "pretrain_loss": 1.2081902027130127,
                    "pretrain_component": 0.6932260990142822,
                    "supervised_component": 0.6040951013565063,
                    "features_accuracy": [
                        0.5867248177528381,
                        0.49660852551460266,
                        0.551598846912384,
                        0.416424423456192,
                        0.5489341020584106,
                        0.4467054307460785,
                        0.41593992710113525,
                        0.4156976640224457
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -0.3474076779688498,
                    "pretrain_loss": 1.1880555152893066,
                    "pretrain_component": 0.6933075785636902,
                    "supervised_component": 0.5940277576446533,
                    "features_accuracy": [
                        0.5757438540458679,
                        0.5036717653274536,
                        0.5425845980644226,
                        0.421682208776474,
                        0.5522750020027161,
                        0.44227421283721924,
                        0.42069801688194275,
                        0.41978955268859863
                    ]
                },
                "val": {
                    "score": -0.45004914859293116,
                    "pretrain_loss": 1.1477841138839722,
                    "pretrain_component": 0.6931200623512268,
                    "supervised_component": 0.5738920569419861,
                    "features_accuracy": [
                        0.5912806391716003,
                        0.5089312791824341,
                        0.5407205820083618,
                        0.4283984303474426,
                        0.548592209815979,
                        0.42506811022758484,
                        0.42749014496803284,
                        0.42718741297721863
                    ]
                },
                "test": {
                    "score": -0.4449948993768906,
                    "pretrain_loss": 1.1877694129943848,
                    "pretrain_component": 0.6932700872421265,
                    "supervised_component": 0.5938847064971924,
                    "features_accuracy": [
                        0.5867248177528381,
                        0.4997577369213104,
                        0.5460271239280701,
                        0.41739341616630554,
                        0.5448158979415894,
                        0.4442829489707947,
                        0.4127906858921051,
                        0.41860464215278625
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -0.35336601566527154,
                    "pretrain_loss": 1.1487358808517456,
                    "pretrain_component": 0.6935164332389832,
                    "supervised_component": 0.5743679404258728,
                    "features_accuracy": [
                        0.5844500064849854,
                        0.5020819306373596,
                        0.5260807275772095,
                        0.4186539649963379,
                        0.5489439368247986,
                        0.43735334277153015,
                        0.4298584461212158,
                        0.41842684149742126
                    ]
                },
                "val": {
                    "score": -0.4450647387089287,
                    "pretrain_loss": 1.1446341276168823,
                    "pretrain_component": 0.6932229399681091,
                    "supervised_component": 0.5723170638084412,
                    "features_accuracy": [
                        0.5912806391716003,
                        0.4971238374710083,
                        0.5367847681045532,
                        0.4320314824581146,
                        0.5464729070663452,
                        0.4389948546886444,
                        0.4347562789916992,
                        0.42476537823677063
                    ]
                },
                "test": {
                    "score": -0.4387962951972065,
                    "pretrain_loss": 1.1766458749771118,
                    "pretrain_component": 0.6934337615966797,
                    "supervised_component": 0.5883229374885559,
                    "features_accuracy": [
                        0.5867248177528381,
                        0.4937015473842621,
                        0.5399709343910217,
                        0.4178779125213623,
                        0.5438469052314758,
                        0.44961240887641907,
                        0.42126938700675964,
                        0.41448643803596497
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": -0.3405338007654462,
                    "pretrain_loss": 1.1401642560958862,
                    "pretrain_component": 0.6935356259346008,
                    "supervised_component": 0.5700821280479431,
                    "features_accuracy": [
                        0.5771822333335876,
                        0.5063971877098083,
                        0.5063971877098083,
                        0.4172912538051605,
                        0.5383450984954834,
                        0.4523431062698364,
                        0.4421985149383545,
                        0.42281779646873474
                    ]
                },
                "val": {
                    "score": -0.44147436669701884,
                    "pretrain_loss": 1.1353859901428223,
                    "pretrain_component": 0.6932864785194397,
                    "supervised_component": 0.5676929950714111,
                    "features_accuracy": [
                        0.5912806391716003,
                        0.5028761625289917,
                        0.5134726166725159,
                        0.43021494150161743,
                        0.5443536043167114,
                        0.4535270929336548,
                        0.4462609589099884,
                        0.4283984303474426
                    ]
                },
                "test": {
                    "score": -0.43786913190886206,
                    "pretrain_loss": 1.1576836109161377,
                    "pretrain_component": 0.6934537291526794,
                    "supervised_component": 0.5788418054580688,
                    "features_accuracy": [
                        0.5867248177528381,
                        0.5060561895370483,
                        0.5281007885932922,
                        0.41860464215278625,
                        0.5465116500854492,
                        0.45639535784721375,
                        0.42490309476852417,
                        0.41618216037750244
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": -0.3392374005622929,
                    "pretrain_loss": 1.1348166465759277,
                    "pretrain_component": 0.6938558220863342,
                    "supervised_component": 0.5674083232879639,
                    "features_accuracy": [
                        0.5762737989425659,
                        0.5063971877098083,
                        0.4936028718948364,
                        0.4259217381477356,
                        0.5235067009925842,
                        0.44106292724609375,
                        0.4572640061378479,
                        0.4110833704471588
                    ]
                },
                "val": {
                    "score": -0.44270140796772833,
                    "pretrain_loss": 1.1318004131317139,
                    "pretrain_component": 0.6935961246490479,
                    "supervised_component": 0.5659002065658569,
                    "features_accuracy": [
                        0.5912806391716003,
                        0.5092340111732483,
                        0.4916742444038391,
                        0.4326370060443878,
                        0.5201331973075867,
                        0.4423251450061798,
                        0.4586739242076874,
                        0.41356343030929565
                    ]
                },
                "test": {
                    "score": -0.4364965826497738,
                    "pretrain_loss": 1.1488479375839233,
                    "pretrain_component": 0.6938085556030273,
                    "supervised_component": 0.5744239687919617,
                    "features_accuracy": [
                        0.5867248177528381,
                        0.5084787011146545,
                        0.5079941749572754,
                        0.41497093439102173,
                        0.5276162624359131,
                        0.44985464215278625,
                        0.43313953280448914,
                        0.4086724817752838
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": -0.35306780009075395,
                    "pretrain_loss": 1.162114143371582,
                    "pretrain_component": 0.6936892867088318,
                    "supervised_component": 0.581057071685791,
                    "features_accuracy": [
                        0.5855098962783813,
                        0.5046559572219849,
                        0.4867893159389496,
                        0.42251497507095337,
                        0.5210084319114685,
                        0.4386403262615204,
                        0.45908093452453613,
                        0.41645848751068115
                    ]
                },
                "val": {
                    "score": -0.44368355173050783,
                    "pretrain_loss": 1.1338809728622437,
                    "pretrain_component": 0.6935349702835083,
                    "supervised_component": 0.5669404864311218,
                    "features_accuracy": [
                        0.5912806391716003,
                        0.5101422667503357,
                        0.47865575551986694,
                        0.4353618025779724,
                        0.5152891278266907,
                        0.4420224130153656,
                        0.46079322695732117,
                        0.42537087202072144
                    ]
                },
                "test": {
                    "score": -0.4330131288929699,
                    "pretrain_loss": 1.1528927087783813,
                    "pretrain_component": 0.6937745809555054,
                    "supervised_component": 0.5764463543891907,
                    "features_accuracy": [
                        0.5867248177528381,
                        0.5138081312179565,
                        0.4937015473842621,
                        0.4244185984134674,
                        0.512839138507843,
                        0.45227712392807007,
                        0.4430716931819916,
                        0.41593992710113525
                    ]
                }
            },
            "80000": {
                "train": {
                    "score": -0.3444258334286181,
                    "pretrain_loss": 1.1415215730667114,
                    "pretrain_component": 0.6939271688461304,
                    "supervised_component": 0.5707607865333557,
                    "features_accuracy": [
                        0.5671133399009705,
                        0.5074570775032043,
                        0.49519267678260803,
                        0.4314482808113098,
                        0.49277010560035706,
                        0.45113182067871094,
                        0.45961087942123413,
                        0.41312742233276367
                    ]
                },
                "val": {
                    "score": -0.44315675762997403,
                    "pretrain_loss": 1.1245838403701782,
                    "pretrain_component": 0.6936445236206055,
                    "supervised_component": 0.5622919201850891,
                    "features_accuracy": [
                        0.5912806391716003,
                        0.5046926736831665,
                        0.46957311034202576,
                        0.4356645345687866,
                        0.4977293312549591,
                        0.4501968026161194,
                        0.460187703371048,
                        0.42355433106422424
                    ]
                },
                "test": {
                    "score": -0.4313869590338289,
                    "pretrain_loss": 1.1432499885559082,
                    "pretrain_component": 0.6939327716827393,
                    "supervised_component": 0.5716249942779541,
                    "features_accuracy": [
                        0.5867248177528381,
                        0.5067829489707947,
                        0.49297481775283813,
                        0.4195736348628998,
                        0.48861435055732727,
                        0.4532461166381836,
                        0.4350775182247162,
                        0.41375967860221863
                    ]
                }
            }
        },
        "train": {
            "score": -0.3405338007654462
        },
        "val": {
            "score": -0.44147436669701884
        },
        "test": {
            "score": -0.43786913190886206
        }
    },
    "best_iteration": 50000,
    "time": "0:07:18"
}
