{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised___6dee678da31042e5ac2f58534076ba29.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 7,
        "data": {
            "path": "data/california",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512,
                    512
                ],
                "dropout": 0.0
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "positional",
                "linear",
                "relu"
            ],
            "d_num_embedding": 126,
            "positional_encoding": {
                "n": 43,
                "sigma": 0.021371444170736765,
                "trainable": true,
                "initialization": "normal"
            },
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.0001093080842538706,
            "weight_decay": 1.4529840437784787e-06,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.42184426713203266,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.0001093080842538706,
            "weight_decay": 1.4529840437784787e-06,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post",
            "supervised_weight": 1.0
        },
        "bins": null
    },
    "epoch_size": 104,
    "n_parameters": 1134577,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -0.34744004480142476,
                    "pretrain_loss": 1.2503609657287598,
                    "pretrain_component": 0.6936973929405212,
                    "supervised_component": 0.6251804828643799,
                    "features_accuracy": [
                        0.42478615045547485,
                        0.4166856110095978,
                        0.5808161497116089,
                        0.5764251947402954,
                        0.42281779646873474,
                        0.42796579003334045,
                        0.5868725776672363,
                        0.4213793873786926
                    ]
                },
                "val": {
                    "score": -0.4614879578598239,
                    "pretrain_loss": 1.2569186687469482,
                    "pretrain_component": 0.6939244270324707,
                    "supervised_component": 0.6284593343734741,
                    "features_accuracy": [
                        0.42779290676116943,
                        0.41295790672302246,
                        0.5725098252296448,
                        0.5691795349121094,
                        0.41416892409324646,
                        0.42809566855430603,
                        0.563427209854126,
                        0.41326066851615906
                    ]
                },
                "test": {
                    "score": -0.45852042627485656,
                    "pretrain_loss": 1.2720673084259033,
                    "pretrain_component": 0.6936954259872437,
                    "supervised_component": 0.6360336542129517,
                    "features_accuracy": [
                        0.4219961166381836,
                        0.4140019416809082,
                        0.5901162624359131,
                        0.5789728760719299,
                        0.4258720874786377,
                        0.42102712392807007,
                        0.5780038833618164,
                        0.4217538833618164
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -0.35998822068020925,
                    "pretrain_loss": 1.1965065002441406,
                    "pretrain_component": 0.6939694881439209,
                    "supervised_component": 0.5982532501220703,
                    "features_accuracy": [
                        0.41895678639411926,
                        0.41736695170402527,
                        0.5838443636894226,
                        0.5720342397689819,
                        0.42652738094329834,
                        0.43114545941352844,
                        0.5773336291313171,
                        0.4147929549217224
                    ]
                },
                "val": {
                    "score": -0.44991689528339,
                    "pretrain_loss": 1.2298405170440674,
                    "pretrain_component": 0.6940401196479797,
                    "supervised_component": 0.6149202585220337,
                    "features_accuracy": [
                        0.42779290676116943,
                        0.41780200600624084,
                        0.5725098252296448,
                        0.5667575001716614,
                        0.41780200600624084,
                        0.42537087202072144,
                        0.563427209854126,
                        0.41326066851615906
                    ]
                },
                "test": {
                    "score": -0.44641647508094384,
                    "pretrain_loss": 1.2505788803100586,
                    "pretrain_component": 0.6938120126724243,
                    "supervised_component": 0.6252894401550293,
                    "features_accuracy": [
                        0.4219961166381836,
                        0.41763564944267273,
                        0.5901162624359131,
                        0.5741279125213623,
                        0.4280523359775543,
                        0.42102712392807007,
                        0.5777616500854492,
                        0.4217538833618164
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -0.34165857162866853,
                    "pretrain_loss": 1.175880789756775,
                    "pretrain_component": 0.6941346526145935,
                    "supervised_component": 0.5879403948783875,
                    "features_accuracy": [
                        0.4225906729698181,
                        0.41131049394607544,
                        0.5742297172546387,
                        0.562722384929657,
                        0.43008556962013245,
                        0.42637598514556885,
                        0.5799833536148071,
                        0.4194110333919525
                    ]
                },
                "val": {
                    "score": -0.4480676334948614,
                    "pretrain_loss": 1.2093982696533203,
                    "pretrain_component": 0.6941595077514648,
                    "supervised_component": 0.6046991348266602,
                    "features_accuracy": [
                        0.42779290676116943,
                        0.41447168588638306,
                        0.5719043016433716,
                        0.5673630237579346,
                        0.42506811022758484,
                        0.4350590407848358,
                        0.5637299418449402,
                        0.41326066851615906
                    ]
                },
                "test": {
                    "score": -0.4453820911153695,
                    "pretrain_loss": 1.2376413345336914,
                    "pretrain_component": 0.6939225196838379,
                    "supervised_component": 0.6188206672668457,
                    "features_accuracy": [
                        0.4217538833618164,
                        0.41206395626068115,
                        0.5901162624359131,
                        0.5736433863639832,
                        0.4348352551460266,
                        0.4282945692539215,
                        0.5760658979415894,
                        0.4217538833618164
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -0.32750643462848855,
                    "pretrain_loss": 1.156880497932434,
                    "pretrain_component": 0.694053053855896,
                    "supervised_component": 0.578440248966217,
                    "features_accuracy": [
                        0.4225906729698181,
                        0.41645848751068115,
                        0.5827844738960266,
                        0.566431999206543,
                        0.45128321647644043,
                        0.42705732583999634,
                        0.564009428024292,
                        0.4214550852775574
                    ]
                },
                "val": {
                    "score": -0.4447128597733687,
                    "pretrain_loss": 1.1873347759246826,
                    "pretrain_component": 0.6941576600074768,
                    "supervised_component": 0.5936673879623413,
                    "features_accuracy": [
                        0.42779290676116943,
                        0.41598546504974365,
                        0.573115348815918,
                        0.5616106390953064,
                        0.439297616481781,
                        0.4353618025779724,
                        0.5573720932006836,
                        0.41326066851615906
                    ]
                },
                "test": {
                    "score": -0.4427688211733385,
                    "pretrain_loss": 1.2130614519119263,
                    "pretrain_component": 0.693920910358429,
                    "supervised_component": 0.6065307259559631,
                    "features_accuracy": [
                        0.4219961166381836,
                        0.4125484526157379,
                        0.5896317958831787,
                        0.5666182041168213,
                        0.46002906560897827,
                        0.4375,
                        0.5675871968269348,
                        0.4217538833618164
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": -0.33962055208763964,
                    "pretrain_loss": 1.14490807056427,
                    "pretrain_component": 0.6942448019981384,
                    "supervised_component": 0.572454035282135,
                    "features_accuracy": [
                        0.42319631576538086,
                        0.42546749114990234,
                        0.5754410028457642,
                        0.5623438954353333,
                        0.44605952501296997,
                        0.4347793459892273,
                        0.5792263150215149,
                        0.41683700680732727
                    ]
                },
                "val": {
                    "score": -0.43852551056601774,
                    "pretrain_loss": 1.2075139284133911,
                    "pretrain_component": 0.6943950653076172,
                    "supervised_component": 0.6037569642066956,
                    "features_accuracy": [
                        0.42779290676116943,
                        0.42325159907341003,
                        0.5728126168251038,
                        0.560702383518219,
                        0.43051770329475403,
                        0.4320314824581146,
                        0.5616106390953064,
                        0.41326066851615906
                    ]
                },
                "test": {
                    "score": -0.43223504532799706,
                    "pretrain_loss": 1.2243375778198242,
                    "pretrain_component": 0.6941589117050171,
                    "supervised_component": 0.6121687889099121,
                    "features_accuracy": [
                        0.4217538833618164,
                        0.4280523359775543,
                        0.588420569896698,
                        0.568071722984314,
                        0.4580910801887512,
                        0.42999032139778137,
                        0.567829430103302,
                        0.4217538833618164
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": -0.3323948743461337,
                    "pretrain_loss": 1.1482675075531006,
                    "pretrain_component": 0.6941739916801453,
                    "supervised_component": 0.5741337537765503,
                    "features_accuracy": [
                        0.43114545941352844,
                        0.441517174243927,
                        0.5705201029777527,
                        0.5676432847976685,
                        0.4474979341030121,
                        0.41592854261398315,
                        0.568021833896637,
                        0.420622318983078
                    ]
                },
                "val": {
                    "score": -0.4378231531351485,
                    "pretrain_loss": 1.1927192211151123,
                    "pretrain_component": 0.6943013668060303,
                    "supervised_component": 0.5963596105575562,
                    "features_accuracy": [
                        0.42809566855430603,
                        0.4356645345687866,
                        0.5676657557487488,
                        0.5579776167869568,
                        0.4389948546886444,
                        0.42749014496803284,
                        0.5546472668647766,
                        0.41326066851615906
                    ]
                },
                "test": {
                    "score": -0.4312061845631113,
                    "pretrain_loss": 1.2229650020599365,
                    "pretrain_component": 0.6941296458244324,
                    "supervised_component": 0.6114825010299683,
                    "features_accuracy": [
                        0.42223837971687317,
                        0.43701550364494324,
                        0.588420569896698,
                        0.5683139562606812,
                        0.45373061299324036,
                        0.42538759112358093,
                        0.5629844665527344,
                        0.4217538833618164
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": -0.3218308906957647,
                    "pretrain_loss": 1.1644017696380615,
                    "pretrain_component": 0.6942669749259949,
                    "supervised_component": 0.5822008848190308,
                    "features_accuracy": [
                        0.42054662108421326,
                        0.4361420273780823,
                        0.5690060257911682,
                        0.5604512095451355,
                        0.44424256682395935,
                        0.4402301609516144,
                        0.5745325088500977,
                        0.42728444933891296
                    ]
                },
                "val": {
                    "score": -0.4359192523740456,
                    "pretrain_loss": 1.175339698791504,
                    "pretrain_component": 0.6944337487220764,
                    "supervised_component": 0.587669849395752,
                    "features_accuracy": [
                        0.4296094477176666,
                        0.4314259886741638,
                        0.5667575001716614,
                        0.551014244556427,
                        0.4332424998283386,
                        0.4359672963619232,
                        0.5594913959503174,
                        0.41356343030929565
                    ]
                },
                "test": {
                    "score": -0.4306678333905253,
                    "pretrain_loss": 1.211273431777954,
                    "pretrain_component": 0.6942576766014099,
                    "supervised_component": 0.605636715888977,
                    "features_accuracy": [
                        0.4234496057033539,
                        0.4333817958831787,
                        0.5838178396224976,
                        0.5617732405662537,
                        0.447674423456192,
                        0.4375,
                        0.5620154738426208,
                        0.4217538833618164
                    ]
                }
            },
            "80000": {
                "train": {
                    "score": -0.3452530443279981,
                    "pretrain_loss": 1.1259039640426636,
                    "pretrain_component": 0.6942275166511536,
                    "supervised_component": 0.5629519820213318,
                    "features_accuracy": [
                        0.42175790667533875,
                        0.4371262192726135,
                        0.5687788724899292,
                        0.5534862875938416,
                        0.46498599648475647,
                        0.4368990957736969,
                        0.570671558380127,
                        0.41963812708854675
                    ]
                },
                "val": {
                    "score": -0.4322633009186641,
                    "pretrain_loss": 1.1881203651428223,
                    "pretrain_component": 0.6942686438560486,
                    "supervised_component": 0.5940601825714111,
                    "features_accuracy": [
                        0.43051770329475403,
                        0.4308204650878906,
                        0.5670602321624756,
                        0.553436279296875,
                        0.454132616519928,
                        0.442930668592453,
                        0.5576748251914978,
                        0.41356343030929565
                    ]
                },
                "test": {
                    "score": -0.43030844959388986,
                    "pretrain_loss": 1.215663194656372,
                    "pretrain_component": 0.6941239833831787,
                    "supervised_component": 0.607831597328186,
                    "features_accuracy": [
                        0.4241763651371002,
                        0.4280523359775543,
                        0.5830910801887512,
                        0.5608042478561401,
                        0.46560075879096985,
                        0.4399224817752838,
                        0.5641957521438599,
                        0.4217538833618164
                    ]
                }
            },
            "90000": {
                "train": {
                    "score": -0.3368800275369636,
                    "pretrain_loss": 1.131537914276123,
                    "pretrain_component": 0.6941096782684326,
                    "supervised_component": 0.5657689571380615,
                    "features_accuracy": [
                        0.4209251403808594,
                        0.43909457325935364,
                        0.5654478073120117,
                        0.55659019947052,
                        0.4443182945251465,
                        0.4303126931190491,
                        0.5678704380989075,
                        0.42705732583999634
                    ]
                },
                "val": {
                    "score": -0.43641318454495204,
                    "pretrain_loss": 1.1844183206558228,
                    "pretrain_component": 0.6941724419593811,
                    "supervised_component": 0.5922091603279114,
                    "features_accuracy": [
                        0.4323342442512512,
                        0.4386920928955078,
                        0.5676657557487488,
                        0.5516197085380554,
                        0.445352703332901,
                        0.4335452616214752,
                        0.5498031973838806,
                        0.41326066851615906
                    ]
                },
                "test": {
                    "score": -0.42844967305662274,
                    "pretrain_loss": 1.2027612924575806,
                    "pretrain_component": 0.6939337253570557,
                    "supervised_component": 0.6013806462287903,
                    "features_accuracy": [
                        0.42611435055732727,
                        0.43701550364494324,
                        0.5889050364494324,
                        0.5603197813034058,
                        0.45881783962249756,
                        0.4360465109348297,
                        0.5608042478561401,
                        0.4217538833618164
                    ]
                }
            },
            "100000": {
                "train": {
                    "score": -0.33050153838321666,
                    "pretrain_loss": 1.1006932258605957,
                    "pretrain_component": 0.6940996646881104,
                    "supervised_component": 0.5503466129302979,
                    "features_accuracy": [
                        0.4297827482223511,
                        0.441517174243927,
                        0.5647664666175842,
                        0.55923992395401,
                        0.44068440794944763,
                        0.4289499819278717,
                        0.5558331608772278,
                        0.4145658314228058
                    ]
                },
                "val": {
                    "score": -0.435880573797509,
                    "pretrain_loss": 1.1782166957855225,
                    "pretrain_component": 0.6940401196479797,
                    "supervised_component": 0.5891083478927612,
                    "features_accuracy": [
                        0.4386920928955078,
                        0.4374810755252838,
                        0.5646381974220276,
                        0.5464729070663452,
                        0.4344535171985626,
                        0.4432334303855896,
                        0.5495004653930664,
                        0.41356343030929565
                    ]
                },
                "test": {
                    "score": -0.4298915512424634,
                    "pretrain_loss": 1.1926888227462769,
                    "pretrain_component": 0.693766176700592,
                    "supervised_component": 0.5963444113731384,
                    "features_accuracy": [
                        0.43410852551460266,
                        0.4309593141078949,
                        0.5816376209259033,
                        0.5620154738426208,
                        0.45009690523147583,
                        0.4324128031730652,
                        0.5627422332763672,
                        0.42151162028312683
                    ]
                }
            }
        },
        "train": {
            "score": -0.3452530443279981
        },
        "val": {
            "score": -0.4322633009186641
        },
        "test": {
            "score": -0.43030844959388986
        }
    },
    "best_iteration": 80000,
    "time": "0:09:13"
}
