{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised___6dee678da31042e5ac2f58534076ba29.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 6,
        "data": {
            "path": "data/california",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512,
                    512
                ],
                "dropout": 0.0
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "positional",
                "linear",
                "relu"
            ],
            "d_num_embedding": 126,
            "positional_encoding": {
                "n": 43,
                "sigma": 0.021371444170736765,
                "trainable": true,
                "initialization": "normal"
            },
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.0001093080842538706,
            "weight_decay": 1.4529840437784787e-06,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.42184426713203266,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.0001093080842538706,
            "weight_decay": 1.4529840437784787e-06,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post",
            "supervised_weight": 1.0
        },
        "bins": null
    },
    "epoch_size": 104,
    "n_parameters": 1134577,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -0.37941568106750145,
                    "pretrain_loss": 1.272085189819336,
                    "pretrain_component": 0.6923466920852661,
                    "supervised_component": 0.636042594909668,
                    "features_accuracy": [
                        0.5729427337646484,
                        0.560299813747406,
                        0.5310773253440857,
                        0.438337504863739,
                        0.5831630229949951,
                        0.5771822333335876,
                        0.5816488862037659,
                        0.4260731339454651
                    ]
                },
                "val": {
                    "score": -0.4646520219984769,
                    "pretrain_loss": 1.2710729837417603,
                    "pretrain_component": 0.6923094987869263,
                    "supervised_component": 0.6355364918708801,
                    "features_accuracy": [
                        0.5712988376617432,
                        0.5579776167869568,
                        0.5346654653549194,
                        0.4471692442893982,
                        0.5737208724021912,
                        0.5800787210464478,
                        0.5770511627197266,
                        0.42385709285736084
                    ]
                },
                "test": {
                    "score": -0.4555865440558028,
                    "pretrain_loss": 1.3116050958633423,
                    "pretrain_component": 0.6924830079078674,
                    "supervised_component": 0.6558025479316711,
                    "features_accuracy": [
                        0.5796996355056763,
                        0.569767415523529,
                        0.5472383499145508,
                        0.4389534890651703,
                        0.5654069781303406,
                        0.5629844665527344,
                        0.5741279125213623,
                        0.4362887442111969
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -0.3589014618135018,
                    "pretrain_loss": 1.201198935508728,
                    "pretrain_component": 0.6924741268157959,
                    "supervised_component": 0.600599467754364,
                    "features_accuracy": [
                        0.5517450571060181,
                        0.5319857597351074,
                        0.525399386882782,
                        0.4464380443096161,
                        0.5752896070480347,
                        0.5798319578170776,
                        0.5793020129203796,
                        0.4253917932510376
                    ]
                },
                "val": {
                    "score": -0.4550589959768852,
                    "pretrain_loss": 1.2237651348114014,
                    "pretrain_component": 0.6924280524253845,
                    "supervised_component": 0.6118825674057007,
                    "features_accuracy": [
                        0.538298487663269,
                        0.526188313961029,
                        0.531335175037384,
                        0.4526188373565674,
                        0.5725098252296448,
                        0.5800787210464478,
                        0.5749318599700928,
                        0.4299122095108032
                    ]
                },
                "test": {
                    "score": -0.4487863608235304,
                    "pretrain_loss": 1.2490484714508057,
                    "pretrain_component": 0.6925774812698364,
                    "supervised_component": 0.6245242357254028,
                    "features_accuracy": [
                        0.5554748177528381,
                        0.536579430103302,
                        0.5479651093482971,
                        0.44089147448539734,
                        0.5639534592628479,
                        0.5629844665527344,
                        0.5724321603775024,
                        0.43798449635505676
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -0.34677631883600546,
                    "pretrain_loss": 1.1833611726760864,
                    "pretrain_component": 0.692230224609375,
                    "supervised_component": 0.5916805863380432,
                    "features_accuracy": [
                        0.554167628288269,
                        0.5293360948562622,
                        0.5278976559638977,
                        0.49095314741134644,
                        0.5709743499755859,
                        0.5769551396369934,
                        0.5768036842346191,
                        0.4314482808113098
                    ]
                },
                "val": {
                    "score": -0.4515030452509232,
                    "pretrain_loss": 1.1971172094345093,
                    "pretrain_component": 0.6922439336776733,
                    "supervised_component": 0.5985586047172546,
                    "features_accuracy": [
                        0.5552527904510498,
                        0.5201331973075867,
                        0.5234634876251221,
                        0.4898577034473419,
                        0.563124418258667,
                        0.5800787210464478,
                        0.5746291279792786,
                        0.4283984303474426
                    ]
                },
                "test": {
                    "score": -0.4432467435122286,
                    "pretrain_loss": 1.236280918121338,
                    "pretrain_component": 0.6923748850822449,
                    "supervised_component": 0.618140459060669,
                    "features_accuracy": [
                        0.5627422332763672,
                        0.5334302186965942,
                        0.5336724519729614,
                        0.4791666567325592,
                        0.5554748177528381,
                        0.5629844665527344,
                        0.5709787011146545,
                        0.4416182041168213
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -0.3234194012864905,
                    "pretrain_loss": 1.1595548391342163,
                    "pretrain_component": 0.6924009323120117,
                    "supervised_component": 0.5797774195671082,
                    "features_accuracy": [
                        0.557347297668457,
                        0.48353397846221924,
                        0.5058672428131104,
                        0.4868650436401367,
                        0.5745325088500977,
                        0.5740783214569092,
                        0.5749110579490662,
                        0.440457284450531
                    ]
                },
                "val": {
                    "score": -0.45153136198151905,
                    "pretrain_loss": 1.2047568559646606,
                    "pretrain_component": 0.6923573613166809,
                    "supervised_component": 0.6023784279823303,
                    "features_accuracy": [
                        0.5588858723640442,
                        0.4922797381877899,
                        0.5165001749992371,
                        0.4877384305000305,
                        0.565849244594574,
                        0.5800787210464478,
                        0.5725098252296448,
                        0.446563720703125
                    ]
                },
                "test": {
                    "score": -0.4452931452576,
                    "pretrain_loss": 1.2237459421157837,
                    "pretrain_component": 0.6925212740898132,
                    "supervised_component": 0.6118729710578918,
                    "features_accuracy": [
                        0.5518410801887512,
                        0.4975775182247162,
                        0.5264050364494324,
                        0.47577518224716187,
                        0.5625,
                        0.5629844665527344,
                        0.5668604373931885,
                        0.4546996057033539
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": -0.3184930574948753,
                    "pretrain_loss": 1.1242495775222778,
                    "pretrain_component": 0.692328155040741,
                    "supervised_component": 0.5621247887611389,
                    "features_accuracy": [
                        0.5489439368247986,
                        0.4724808931350708,
                        0.5216140747070312,
                        0.4882277548313141,
                        0.56453937292099,
                        0.5732455253601074,
                        0.5638579726219177,
                        0.4485578238964081
                    ]
                },
                "val": {
                    "score": -0.4466199230525122,
                    "pretrain_loss": 1.191522479057312,
                    "pretrain_component": 0.6923254728317261,
                    "supervised_component": 0.595761239528656,
                    "features_accuracy": [
                        0.5389040112495422,
                        0.46957311034202576,
                        0.5225552320480347,
                        0.5037844181060791,
                        0.553133487701416,
                        0.5800787210464478,
                        0.5652437210083008,
                        0.445352703332901
                    ]
                },
                "test": {
                    "score": -0.4459718572988114,
                    "pretrain_loss": 1.2298585176467896,
                    "pretrain_component": 0.6924677491188049,
                    "supervised_component": 0.6149292588233948,
                    "features_accuracy": [
                        0.544089138507843,
                        0.47698643803596497,
                        0.536579430103302,
                        0.49394381046295166,
                        0.5576550364494324,
                        0.5629844665527344,
                        0.5625,
                        0.45397287607192993
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": -0.30620259620982143,
                    "pretrain_loss": 1.1356440782546997,
                    "pretrain_component": 0.692229151725769,
                    "supervised_component": 0.5678220391273499,
                    "features_accuracy": [
                        0.5474298000335693,
                        0.4804300367832184,
                        0.5350897312164307,
                        0.4969339370727539,
                        0.5751382112503052,
                        0.5707472562789917,
                        0.5642365217208862,
                        0.44159287214279175
                    ]
                },
                "val": {
                    "score": -0.4483404446394801,
                    "pretrain_loss": 1.1827895641326904,
                    "pretrain_component": 0.6921629905700684,
                    "supervised_component": 0.5913947820663452,
                    "features_accuracy": [
                        0.543445348739624,
                        0.47290343046188354,
                        0.5370875000953674,
                        0.4977293312549591,
                        0.5555555820465088,
                        0.5800787210464478,
                        0.5728126168251038,
                        0.4511050581932068
                    ]
                },
                "test": {
                    "score": -0.4480776451776537,
                    "pretrain_loss": 1.2112417221069336,
                    "pretrain_component": 0.6922819018363953,
                    "supervised_component": 0.6056208610534668,
                    "features_accuracy": [
                        0.5428779125213623,
                        0.4869185984134674,
                        0.5358527302742004,
                        0.49951550364494324,
                        0.5627422332763672,
                        0.5629844665527344,
                        0.5615310072898865,
                        0.4622093141078949
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": -0.3498864164633005,
                    "pretrain_loss": 1.169332504272461,
                    "pretrain_component": 0.6922996640205383,
                    "supervised_component": 0.5846662521362305,
                    "features_accuracy": [
                        0.5429631471633911,
                        0.47346508502960205,
                        0.5280490517616272,
                        0.5022333264350891,
                        0.5401620268821716,
                        0.5786206722259521,
                        0.5478840470314026,
                        0.4521159827709198
                    ]
                },
                "val": {
                    "score": -0.4464456314583625,
                    "pretrain_loss": 1.1752139329910278,
                    "pretrain_component": 0.6922562122344971,
                    "supervised_component": 0.5876069664955139,
                    "features_accuracy": [
                        0.5280048251152039,
                        0.48077505826950073,
                        0.5298213958740234,
                        0.4986375868320465,
                        0.5304268598556519,
                        0.5800787210464478,
                        0.5513169765472412,
                        0.46503180265426636
                    ]
                },
                "test": {
                    "score": -0.4396134696233781,
                    "pretrain_loss": 1.206246256828308,
                    "pretrain_component": 0.6924164295196533,
                    "supervised_component": 0.603123128414154,
                    "features_accuracy": [
                        0.5281007885932922,
                        0.4830426275730133,
                        0.5310077667236328,
                        0.49685075879096985,
                        0.5414243936538696,
                        0.5629844665527344,
                        0.5457848906517029,
                        0.4651162624359131
                    ]
                }
            },
            "80000": {
                "train": {
                    "score": -0.3410625187187416,
                    "pretrain_loss": 1.1534018516540527,
                    "pretrain_component": 0.6923705339431763,
                    "supervised_component": 0.5767009258270264,
                    "features_accuracy": [
                        0.5506094694137573,
                        0.4696797728538513,
                        0.5338027477264404,
                        0.4898175597190857,
                        0.5440987348556519,
                        0.5742297172546387,
                        0.5474298000335693,
                        0.45060187578201294
                    ]
                },
                "val": {
                    "score": -0.44554258589157086,
                    "pretrain_loss": 1.168578863143921,
                    "pretrain_component": 0.6923869252204895,
                    "supervised_component": 0.5842894315719604,
                    "features_accuracy": [
                        0.53617924451828,
                        0.47653648257255554,
                        0.5267938375473022,
                        0.4850136339664459,
                        0.528610348701477,
                        0.5797759890556335,
                        0.5464729070663452,
                        0.4580684304237366
                    ]
                },
                "test": {
                    "score": -0.4366506444340545,
                    "pretrain_loss": 1.2157251834869385,
                    "pretrain_component": 0.6924951076507568,
                    "supervised_component": 0.6078625917434692,
                    "features_accuracy": [
                        0.5419089198112488,
                        0.47311046719551086,
                        0.5329457521438599,
                        0.4883720874786377,
                        0.5348837375640869,
                        0.5632267594337463,
                        0.5394864082336426,
                        0.4634205400943756
                    ]
                }
            },
            "90000": {
                "train": {
                    "score": -0.33616599030994093,
                    "pretrain_loss": 1.1173648834228516,
                    "pretrain_component": 0.6926013827323914,
                    "supervised_component": 0.5586824417114258,
                    "features_accuracy": [
                        0.5352411270141602,
                        0.4689227342605591,
                        0.5422061085700989,
                        0.47876450419425964,
                        0.5290332436561584,
                        0.5689302682876587,
                        0.5253236889839172,
                        0.4696797728538513
                    ]
                },
                "val": {
                    "score": -0.4437384900388219,
                    "pretrain_loss": 1.1749582290649414,
                    "pretrain_component": 0.6924636960029602,
                    "supervised_component": 0.5874791145324707,
                    "features_accuracy": [
                        0.5255827903747559,
                        0.48259156942367554,
                        0.535876452922821,
                        0.4838026165962219,
                        0.5304268598556519,
                        0.5800787210464478,
                        0.5110505819320679,
                        0.47593095898628235
                    ]
                },
                "test": {
                    "score": -0.4364998704205985,
                    "pretrain_loss": 1.20697021484375,
                    "pretrain_component": 0.6925532817840576,
                    "supervised_component": 0.603485107421875,
                    "features_accuracy": [
                        0.5363371968269348,
                        0.4702034890651703,
                        0.5479651093482971,
                        0.48643410205841064,
                        0.5322189927101135,
                        0.5629844665527344,
                        0.5174418687820435,
                        0.4765019416809082
                    ]
                }
            },
            "100000": {
                "train": {
                    "score": -0.3364381732390044,
                    "pretrain_loss": 1.1222625970840454,
                    "pretrain_component": 0.6923670172691345,
                    "supervised_component": 0.5611312985420227,
                    "features_accuracy": [
                        0.5324400067329407,
                        0.4641532301902771,
                        0.5425089001655579,
                        0.49171021580696106,
                        0.5160118341445923,
                        0.5774850845336914,
                        0.5409190654754639,
                        0.47255662083625793
                    ]
                },
                "val": {
                    "score": -0.4446169860443488,
                    "pretrain_loss": 1.1496467590332031,
                    "pretrain_component": 0.6924323439598083,
                    "supervised_component": 0.5748233795166016,
                    "features_accuracy": [
                        0.5125643610954285,
                        0.4859218895435333,
                        0.5325461626052856,
                        0.4889494478702545,
                        0.523766279220581,
                        0.5800787210464478,
                        0.5255827903747559,
                        0.4850136339664459
                    ]
                },
                "test": {
                    "score": -0.4321841481003074,
                    "pretrain_loss": 1.199198603630066,
                    "pretrain_component": 0.6925376653671265,
                    "supervised_component": 0.599599301815033,
                    "features_accuracy": [
                        0.5324612259864807,
                        0.4685077369213104,
                        0.5525678396224976,
                        0.4881298542022705,
                        0.5191376209259033,
                        0.5629844665527344,
                        0.5302810072898865,
                        0.48255813121795654
                    ]
                }
            }
        },
        "train": {
            "score": -0.33616599030994093
        },
        "val": {
            "score": -0.4437384900388219
        },
        "test": {
            "score": -0.4364998704205985
        }
    },
    "best_iteration": 90000,
    "time": "0:09:09"
}
