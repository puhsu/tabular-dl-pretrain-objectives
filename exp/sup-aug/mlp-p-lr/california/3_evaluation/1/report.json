{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised___09e7e863c0ff405c99b73242c37e24be.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 1,
        "data": {
            "path": "data/california",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512,
                    512
                ],
                "dropout": 0.0
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "positional",
                "linear",
                "relu"
            ],
            "d_num_embedding": 126,
            "positional_encoding": {
                "n": 43,
                "sigma": 0.021371444170736765,
                "trainable": true,
                "initialization": "normal"
            },
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.0001093080842538706,
            "weight_decay": 1.4529840437784787e-06,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.42184426713203266,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.0001093080842538706,
            "weight_decay": 1.4529840437784787e-06,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post",
            "supervised_weight": 1.0
        },
        "bins": null
    },
    "epoch_size": 104,
    "n_parameters": 1134577,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -0.3573067246102979,
                    "pretrain_loss": 1.2670317888259888,
                    "pretrain_component": 0.6929066181182861,
                    "supervised_component": 0.6335158944129944,
                    "features_accuracy": [
                        0.525399386882782,
                        0.5831630229949951,
                        0.5293360948562622,
                        0.5112423300743103,
                        0.41978955268859863,
                        0.45400863885879517,
                        0.5760466456413269,
                        0.5583314299583435
                    ]
                },
                "val": {
                    "score": -0.4566798307139137,
                    "pretrain_loss": 1.2211500406265259,
                    "pretrain_component": 0.692721426486969,
                    "supervised_component": 0.6105750203132629,
                    "features_accuracy": [
                        0.5240690112113953,
                        0.5924916863441467,
                        0.5307296514511108,
                        0.5119588375091553,
                        0.4335452616214752,
                        0.4547381103038788,
                        0.5927944183349609,
                        0.5549500584602356
                    ]
                },
                "test": {
                    "score": -0.45399534083408316,
                    "pretrain_loss": 1.2527713775634766,
                    "pretrain_component": 0.6928756833076477,
                    "supervised_component": 0.6263856887817383,
                    "features_accuracy": [
                        0.5176841020584106,
                        0.5891472697257996,
                        0.5213178396224976,
                        0.5155038833618164,
                        0.4152131676673889,
                        0.44622093439102173,
                        0.5826066136360168,
                        0.5578972697257996
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -0.32292031740189125,
                    "pretrain_loss": 1.2093172073364258,
                    "pretrain_component": 0.692937970161438,
                    "supervised_component": 0.6046586036682129,
                    "features_accuracy": [
                        0.5163146257400513,
                        0.5833901166915894,
                        0.5256264805793762,
                        0.5057157874107361,
                        0.4245590269565582,
                        0.44848209619522095,
                        0.5834658145904541,
                        0.5780907273292542
                    ]
                },
                "val": {
                    "score": -0.454421375501603,
                    "pretrain_loss": 1.1889333724975586,
                    "pretrain_component": 0.6927516460418701,
                    "supervised_component": 0.5944666862487793,
                    "features_accuracy": [
                        0.5301241278648376,
                        0.5927944183349609,
                        0.5216469764709473,
                        0.5225552320480347,
                        0.4374810755252838,
                        0.4450499415397644,
                        0.5937026739120483,
                        0.5661519765853882
                    ]
                },
                "test": {
                    "score": -0.4509260329204696,
                    "pretrain_loss": 1.2175850868225098,
                    "pretrain_component": 0.6929412484169006,
                    "supervised_component": 0.6087925434112549,
                    "features_accuracy": [
                        0.5125969052314758,
                        0.5886628031730652,
                        0.5113856792449951,
                        0.5138081312179565,
                        0.41327518224716187,
                        0.4508236348628998,
                        0.5818798542022705,
                        0.5663759708404541
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -0.35664504006811093,
                    "pretrain_loss": 1.1957142353057861,
                    "pretrain_component": 0.6928366422653198,
                    "supervised_component": 0.5978571176528931,
                    "features_accuracy": [
                        0.518510103225708,
                        0.597547173500061,
                        0.5285032987594604,
                        0.5048830509185791,
                        0.4210008382797241,
                        0.44764935970306396,
                        0.5806646943092346,
                        0.5868725776672363
                    ]
                },
                "val": {
                    "score": -0.4507634029192159,
                    "pretrain_loss": 1.1745797395706177,
                    "pretrain_component": 0.6927235722541809,
                    "supervised_component": 0.5872898697853088,
                    "features_accuracy": [
                        0.5292158722877502,
                        0.5909779071807861,
                        0.5210414528846741,
                        0.5165001749992371,
                        0.4359672963619232,
                        0.45958220958709717,
                        0.5927944183349609,
                        0.5728126168251038
                    ]
                },
                "test": {
                    "score": -0.43918385599680076,
                    "pretrain_loss": 1.2121392488479614,
                    "pretrain_component": 0.6929716467857361,
                    "supervised_component": 0.6060696244239807,
                    "features_accuracy": [
                        0.5152616500854492,
                        0.5879360437393188,
                        0.5193798542022705,
                        0.5101743936538696,
                        0.41206395626068115,
                        0.45251938700675964,
                        0.5821220874786377,
                        0.5792151093482971
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -0.3429589876754221,
                    "pretrain_loss": 1.137739896774292,
                    "pretrain_component": 0.69281405210495,
                    "supervised_component": 0.568869948387146,
                    "features_accuracy": [
                        0.5040503144264221,
                        0.5904307961463928,
                        0.5223711133003235,
                        0.5112423300743103,
                        0.43008556962013245,
                        0.4562041163444519,
                        0.5829358696937561,
                        0.5612083077430725
                    ]
                },
                "val": {
                    "score": -0.4439250802264934,
                    "pretrain_loss": 1.1645034551620483,
                    "pretrain_component": 0.6927003264427185,
                    "supervised_component": 0.5822517275810242,
                    "features_accuracy": [
                        0.5149863958358765,
                        0.5924916863441467,
                        0.5225552320480347,
                        0.5143808722496033,
                        0.4344535171985626,
                        0.4526188373565674,
                        0.5937026739120483,
                        0.5440508723258972
                    ]
                },
                "test": {
                    "score": -0.4354235383520976,
                    "pretrain_loss": 1.1905089616775513,
                    "pretrain_component": 0.6929574012756348,
                    "supervised_component": 0.5952544808387756,
                    "features_accuracy": [
                        0.4997577369213104,
                        0.5879360437393188,
                        0.5116279125213623,
                        0.523740291595459,
                        0.41230618953704834,
                        0.4556685984134674,
                        0.5823643207550049,
                        0.5482073426246643
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": -0.34895009138595284,
                    "pretrain_loss": 1.1249797344207764,
                    "pretrain_component": 0.6927417516708374,
                    "supervised_component": 0.5624898672103882,
                    "features_accuracy": [
                        0.49806952476501465,
                        0.5923991203308105,
                        0.5145733952522278,
                        0.526459276676178,
                        0.42834433913230896,
                        0.4792187213897705,
                        0.5821031332015991,
                        0.5452343225479126
                    ]
                },
                "val": {
                    "score": -0.445217886838015,
                    "pretrain_loss": 1.1520649194717407,
                    "pretrain_component": 0.6927778124809265,
                    "supervised_component": 0.5760324597358704,
                    "features_accuracy": [
                        0.5101422667503357,
                        0.5924916863441467,
                        0.5192249417304993,
                        0.5192249417304993,
                        0.438086599111557,
                        0.46382075548171997,
                        0.5927944183349609,
                        0.528610348701477
                    ]
                },
                "test": {
                    "score": -0.4356830753696936,
                    "pretrain_loss": 1.1934497356414795,
                    "pretrain_component": 0.6929954886436462,
                    "supervised_component": 0.5967248678207397,
                    "features_accuracy": [
                        0.4893410801887512,
                        0.588178277015686,
                        0.4987887442111969,
                        0.5266472697257996,
                        0.4181201457977295,
                        0.47577518224716187,
                        0.5823643207550049,
                        0.5377907156944275
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": -0.3531626676793694,
                    "pretrain_loss": 1.1382548809051514,
                    "pretrain_component": 0.6928951144218445,
                    "supervised_component": 0.5691274404525757,
                    "features_accuracy": [
                        0.4894390404224396,
                        0.5852071046829224,
                        0.5197214484214783,
                        0.518510103225708,
                        0.424104779958725,
                        0.4838367998600006,
                        0.5787720680236816,
                        0.5563631057739258
                    ]
                },
                "val": {
                    "score": -0.44653088663979523,
                    "pretrain_loss": 1.1574316024780273,
                    "pretrain_component": 0.6927861571311951,
                    "supervised_component": 0.5787158012390137,
                    "features_accuracy": [
                        0.4883439242839813,
                        0.5909779071807861,
                        0.5168029069900513,
                        0.5201331973075867,
                        0.4432334303855896,
                        0.47411444783210754,
                        0.5937026739120483,
                        0.5446563959121704
                    ]
                },
                "test": {
                    "score": -0.43502000873284397,
                    "pretrain_loss": 1.1886192560195923,
                    "pretrain_component": 0.6929598450660706,
                    "supervised_component": 0.5943096280097961,
                    "features_accuracy": [
                        0.48885658383369446,
                        0.5872092843055725,
                        0.512839138507843,
                        0.5319767594337463,
                        0.41836240887641907,
                        0.48231589794158936,
                        0.5816376209259033,
                        0.5501453280448914
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": -0.34395104572534424,
                    "pretrain_loss": 1.1625384092330933,
                    "pretrain_component": 0.6932740211486816,
                    "supervised_component": 0.5812692046165466,
                    "features_accuracy": [
                        0.4951169788837433,
                        0.5834658145904541,
                        0.5083655118942261,
                        0.48974186182022095,
                        0.42440760135650635,
                        0.45438718795776367,
                        0.5789234638214111,
                        0.5417518615722656
                    ]
                },
                "val": {
                    "score": -0.44412811031304633,
                    "pretrain_loss": 1.1408435106277466,
                    "pretrain_component": 0.6931511759757996,
                    "supervised_component": 0.5704217553138733,
                    "features_accuracy": [
                        0.4934907555580139,
                        0.5930972099304199,
                        0.5089312791824341,
                        0.4904632270336151,
                        0.4420224130153656,
                        0.4480774998664856,
                        0.5903723835945129,
                        0.5289130806922913
                    ]
                },
                "test": {
                    "score": -0.4345335694851306,
                    "pretrain_loss": 1.190850019454956,
                    "pretrain_component": 0.6933185458183289,
                    "supervised_component": 0.595425009727478,
                    "features_accuracy": [
                        0.4949128031730652,
                        0.586240291595459,
                        0.49006783962249756,
                        0.49273255467414856,
                        0.42272287607192993,
                        0.46293604373931885,
                        0.5792151093482971,
                        0.5426356792449951
                    ]
                }
            }
        },
        "train": {
            "score": -0.3429589876754221
        },
        "val": {
            "score": -0.4439250802264934
        },
        "test": {
            "score": -0.4354235383520976
        }
    },
    "best_iteration": 40000,
    "time": "0:06:33"
}
