{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised___6dee678da31042e5ac2f58534076ba29.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 4,
        "data": {
            "path": "data/california",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512,
                    512
                ],
                "dropout": 0.0
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "positional",
                "linear",
                "relu"
            ],
            "d_num_embedding": 126,
            "positional_encoding": {
                "n": 43,
                "sigma": 0.021371444170736765,
                "trainable": true,
                "initialization": "normal"
            },
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.0001093080842538706,
            "weight_decay": 1.4529840437784787e-06,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.42184426713203266,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.0001093080842538706,
            "weight_decay": 1.4529840437784787e-06,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post",
            "supervised_weight": 1.0
        },
        "bins": null
    },
    "epoch_size": 104,
    "n_parameters": 1134577,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -0.34285793068442033,
                    "pretrain_loss": 1.2763043642044067,
                    "pretrain_component": 0.6931304931640625,
                    "supervised_component": 0.6381521821022034,
                    "features_accuracy": [
                        0.5132107138633728,
                        0.4329623878002167,
                        0.5800590515136719,
                        0.4381103813648224,
                        0.5397834777832031,
                        0.4563555419445038,
                        0.42213642597198486,
                        0.419562429189682
                    ]
                },
                "val": {
                    "score": -0.46164687502240825,
                    "pretrain_loss": 1.2822784185409546,
                    "pretrain_component": 0.6931400895118713,
                    "supervised_component": 0.6411392092704773,
                    "features_accuracy": [
                        0.5222525000572205,
                        0.4483802616596222,
                        0.5673630237579346,
                        0.4492885172367096,
                        0.5437480807304382,
                        0.4523160755634308,
                        0.431728720664978,
                        0.42415985465049744
                    ]
                },
                "test": {
                    "score": -0.4565762050979952,
                    "pretrain_loss": 1.2804597616195679,
                    "pretrain_component": 0.6932166218757629,
                    "supervised_component": 0.6402298808097839,
                    "features_accuracy": [
                        0.505329430103302,
                        0.43677324056625366,
                        0.5743701457977295,
                        0.42902132868766785,
                        0.542151153087616,
                        0.45518410205841064,
                        0.4256298542022705,
                        0.42635658383369446
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -0.3541490536613236,
                    "pretrain_loss": 1.2038772106170654,
                    "pretrain_component": 0.6933936476707458,
                    "supervised_component": 0.6019386053085327,
                    "features_accuracy": [
                        0.48421531915664673,
                        0.44356122612953186,
                        0.5786963701248169,
                        0.43432509899139404,
                        0.5221440196037292,
                        0.45431146025657654,
                        0.423574835062027,
                        0.4228934943675995
                    ]
                },
                "val": {
                    "score": -0.4537903120084447,
                    "pretrain_loss": 1.2138525247573853,
                    "pretrain_component": 0.6933251023292542,
                    "supervised_component": 0.6069262623786926,
                    "features_accuracy": [
                        0.4968210756778717,
                        0.46321526169776917,
                        0.5673630237579346,
                        0.4474720060825348,
                        0.526188313961029,
                        0.4580684304237366,
                        0.4311232268810272,
                        0.4320314824581146
                    ]
                },
                "test": {
                    "score": -0.4451769277494339,
                    "pretrain_loss": 1.2307910919189453,
                    "pretrain_component": 0.6934170722961426,
                    "supervised_component": 0.6153955459594727,
                    "features_accuracy": [
                        0.47989341616630554,
                        0.4430716931819916,
                        0.5743701457977295,
                        0.42999032139778137,
                        0.5138081312179565,
                        0.4597868323326111,
                        0.4256298542022705,
                        0.4309593141078949
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -0.33937959170418885,
                    "pretrain_loss": 1.1793383359909058,
                    "pretrain_component": 0.6934516429901123,
                    "supervised_component": 0.5896691679954529,
                    "features_accuracy": [
                        0.4811113774776459,
                        0.440457284450531,
                        0.5794534087181091,
                        0.42993414402008057,
                        0.529941737651825,
                        0.462184876203537,
                        0.4303126931190491,
                        0.43273526430130005
                    ]
                },
                "val": {
                    "score": -0.4469284018747068,
                    "pretrain_loss": 1.204242467880249,
                    "pretrain_component": 0.693344235420227,
                    "supervised_component": 0.6021212339401245,
                    "features_accuracy": [
                        0.4871329069137573,
                        0.460187703371048,
                        0.5673630237579346,
                        0.4423251450061798,
                        0.5401150584220886,
                        0.4577656686306,
                        0.438086599111557,
                        0.4323342442512512
                    ]
                },
                "test": {
                    "score": -0.4415184423364231,
                    "pretrain_loss": 1.2092926502227783,
                    "pretrain_component": 0.6934313774108887,
                    "supervised_component": 0.6046463251113892,
                    "features_accuracy": [
                        0.48740309476852417,
                        0.43677324056625366,
                        0.5743701457977295,
                        0.43701550364494324,
                        0.536579430103302,
                        0.4702034890651703,
                        0.42514535784721375,
                        0.4508236348628998
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -0.34037205762605033,
                    "pretrain_loss": 1.1554241180419922,
                    "pretrain_component": 0.69375079870224,
                    "supervised_component": 0.5777120590209961,
                    "features_accuracy": [
                        0.4611250162124634,
                        0.45537135004997253,
                        0.5781664252281189,
                        0.43470361828804016,
                        0.524339497089386,
                        0.4437883496284485,
                        0.4313725531101227,
                        0.42531609535217285
                    ]
                },
                "val": {
                    "score": -0.4462488732761945,
                    "pretrain_loss": 1.1844768524169922,
                    "pretrain_component": 0.6936121582984924,
                    "supervised_component": 0.5922384262084961,
                    "features_accuracy": [
                        0.460187703371048,
                        0.46805933117866516,
                        0.5673630237579346,
                        0.4471692442893982,
                        0.535876452922821,
                        0.4508022964000702,
                        0.4320314824581146,
                        0.42597639560699463
                    ]
                },
                "test": {
                    "score": -0.44186546101308366,
                    "pretrain_loss": 1.2066344022750854,
                    "pretrain_component": 0.6937435865402222,
                    "supervised_component": 0.6033172011375427,
                    "features_accuracy": [
                        0.45663759112358093,
                        0.4479166567325592,
                        0.5743701457977295,
                        0.42902132868766785,
                        0.5244670510292053,
                        0.45009690523147583,
                        0.4282945692539215,
                        0.4360465109348297
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": -0.3292210673960254,
                    "pretrain_loss": 1.175086498260498,
                    "pretrain_component": 0.6940491795539856,
                    "supervised_component": 0.587543249130249,
                    "features_accuracy": [
                        0.4565069377422333,
                        0.4537058174610138,
                        0.5790749192237854,
                        0.42955562472343445,
                        0.5257778763771057,
                        0.440987229347229,
                        0.43682339787483215,
                        0.42493754625320435
                    ]
                },
                "val": {
                    "score": -0.44549715128154516,
                    "pretrain_loss": 1.1930474042892456,
                    "pretrain_component": 0.6938424706459045,
                    "supervised_component": 0.5965237021446228,
                    "features_accuracy": [
                        0.4538298547267914,
                        0.46503180265426636,
                        0.5673630237579346,
                        0.4474720060825348,
                        0.53617924451828,
                        0.4414168894290924,
                        0.4411141276359558,
                        0.42627912759780884
                    ]
                },
                "test": {
                    "score": -0.44025575909916326,
                    "pretrain_loss": 1.214058518409729,
                    "pretrain_component": 0.6940066814422607,
                    "supervised_component": 0.6070292592048645,
                    "features_accuracy": [
                        0.4622093141078949,
                        0.4493701457977295,
                        0.5743701457977295,
                        0.4345930218696594,
                        0.5409399271011353,
                        0.43943798542022705,
                        0.4333817958831787,
                        0.4295058250427246
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": -0.3546140222316532,
                    "pretrain_loss": 1.1052780151367188,
                    "pretrain_component": 0.6940990686416626,
                    "supervised_component": 0.5526390075683594,
                    "features_accuracy": [
                        0.4624119997024536,
                        0.45347869396209717,
                        0.5765765905380249,
                        0.44144144654273987,
                        0.5275948643684387,
                        0.4363691508769989,
                        0.4325081408023834,
                        0.4238019585609436
                    ]
                },
                "val": {
                    "score": -0.44635491897243595,
                    "pretrain_loss": 1.1805928945541382,
                    "pretrain_component": 0.6939492225646973,
                    "supervised_component": 0.5902964472770691,
                    "features_accuracy": [
                        0.46503180265426636,
                        0.46200424432754517,
                        0.5673630237579346,
                        0.440508633852005,
                        0.5352709889411926,
                        0.4426279067993164,
                        0.4438389241695404,
                        0.42264607548713684
                    ]
                },
                "test": {
                    "score": -0.4342211617863568,
                    "pretrain_loss": 1.2008897066116333,
                    "pretrain_component": 0.6941476464271545,
                    "supervised_component": 0.6004448533058167,
                    "features_accuracy": [
                        0.46947672963142395,
                        0.4391957223415375,
                        0.5743701457977295,
                        0.43047481775283813,
                        0.5392441749572754,
                        0.43047481775283813,
                        0.4324128031730652,
                        0.4285368323326111
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": -0.3468036949969461,
                    "pretrain_loss": 1.1690895557403564,
                    "pretrain_component": 0.6941165924072266,
                    "supervised_component": 0.5845447778701782,
                    "features_accuracy": [
                        0.4700583219528198,
                        0.463774710893631,
                        0.5905064940452576,
                        0.42690590023994446,
                        0.5366795659065247,
                        0.4420470893383026,
                        0.4502233564853668,
                        0.41555002331733704
                    ]
                },
                "val": {
                    "score": -0.444540958467544,
                    "pretrain_loss": 1.1907484531402588,
                    "pretrain_component": 0.6940275430679321,
                    "supervised_component": 0.5953742265701294,
                    "features_accuracy": [
                        0.47108688950538635,
                        0.47229790687561035,
                        0.5673630237579346,
                        0.4432334303855896,
                        0.5364819765090942,
                        0.440508633852005,
                        0.4550408720970154,
                        0.41871026158332825
                    ]
                },
                "test": {
                    "score": -0.43146044317266125,
                    "pretrain_loss": 1.1910260915756226,
                    "pretrain_component": 0.6941911578178406,
                    "supervised_component": 0.5955130457878113,
                    "features_accuracy": [
                        0.46875,
                        0.45130813121795654,
                        0.5743701457977295,
                        0.42223837971687317,
                        0.5445736646652222,
                        0.42926356196403503,
                        0.4416182041168213,
                        0.4229651093482971
                    ]
                }
            },
            "80000": {
                "train": {
                    "score": -0.3048137473241047,
                    "pretrain_loss": 1.114966869354248,
                    "pretrain_component": 0.694439172744751,
                    "supervised_component": 0.557483434677124,
                    "features_accuracy": [
                        0.4705125391483307,
                        0.4420470893383026,
                        0.5780907273292542,
                        0.4354606866836548,
                        0.5397834777832031,
                        0.44333410263061523,
                        0.4400787353515625,
                        0.4188810884952545
                    ]
                },
                "val": {
                    "score": -0.4443558013086246,
                    "pretrain_loss": 1.177552580833435,
                    "pretrain_component": 0.6942958831787109,
                    "supervised_component": 0.5887762904167175,
                    "features_accuracy": [
                        0.47138965129852295,
                        0.4450499415397644,
                        0.5673630237579346,
                        0.447774738073349,
                        0.5440508723258972,
                        0.4389948546886444,
                        0.4444444477558136,
                        0.42052680253982544
                    ]
                },
                "test": {
                    "score": -0.4362352751139915,
                    "pretrain_loss": 1.1886168718338013,
                    "pretrain_component": 0.6944448351860046,
                    "supervised_component": 0.5943084359169006,
                    "features_accuracy": [
                        0.4622093141078949,
                        0.4338662922382355,
                        0.5743701457977295,
                        0.42781007289886475,
                        0.5566860437393188,
                        0.4345930218696594,
                        0.4391957223415375,
                        0.4234496057033539
                    ]
                }
            },
            "90000": {
                "train": {
                    "score": -0.2961756903052026,
                    "pretrain_loss": 1.1186007261276245,
                    "pretrain_component": 0.694756031036377,
                    "supervised_component": 0.5593003630638123,
                    "features_accuracy": [
                        0.45696118474006653,
                        0.4298584461212158,
                        0.5807404518127441,
                        0.4371262192726135,
                        0.5318343639373779,
                        0.4412900507450104,
                        0.4446968138217926,
                        0.4245590269565582
                    ]
                },
                "val": {
                    "score": -0.4424988345744867,
                    "pretrain_loss": 1.1770825386047363,
                    "pretrain_component": 0.6946189999580383,
                    "supervised_component": 0.5885412693023682,
                    "features_accuracy": [
                        0.46260973811149597,
                        0.4444444477558136,
                        0.5673630237579346,
                        0.444141685962677,
                        0.533757209777832,
                        0.4423251450061798,
                        0.4432334303855896,
                        0.42415985465049744
                    ]
                },
                "test": {
                    "score": -0.4331086516846603,
                    "pretrain_loss": 1.1770095825195312,
                    "pretrain_component": 0.6947728991508484,
                    "supervised_component": 0.5885047912597656,
                    "features_accuracy": [
                        0.45227712392807007,
                        0.43144381046295166,
                        0.5743701457977295,
                        0.4285368323326111,
                        0.5406976938247681,
                        0.4348352551460266,
                        0.4425871968269348,
                        0.42659884691238403
                    ]
                }
            },
            "100000": {
                "train": {
                    "score": -0.3255015461346543,
                    "pretrain_loss": 1.1513208150863647,
                    "pretrain_component": 0.6947062611579895,
                    "supervised_component": 0.5756604075431824,
                    "features_accuracy": [
                        0.45559847354888916,
                        0.42584604024887085,
                        0.5777121782302856,
                        0.43129685521125793,
                        0.526989221572876,
                        0.44886064529418945,
                        0.4491634666919708,
                        0.4255432188510895
                    ]
                },
                "val": {
                    "score": -0.44433822995121197,
                    "pretrain_loss": 1.1713787317276,
                    "pretrain_component": 0.6946356892585754,
                    "supervised_component": 0.5856893658638,
                    "features_accuracy": [
                        0.46260973811149597,
                        0.4323342442512512,
                        0.5673630237579346,
                        0.4450499415397644,
                        0.5249772667884827,
                        0.442930668592453,
                        0.4474720060825348,
                        0.42749014496803284
                    ]
                },
                "test": {
                    "score": -0.43154126359829714,
                    "pretrain_loss": 1.171927809715271,
                    "pretrain_component": 0.6947469711303711,
                    "supervised_component": 0.5859639048576355,
                    "features_accuracy": [
                        0.45494186878204346,
                        0.43144381046295166,
                        0.5743701457977295,
                        0.4338662922382355,
                        0.5399709343910217,
                        0.43943798542022705,
                        0.4404069781303406,
                        0.42877906560897827
                    ]
                }
            }
        },
        "train": {
            "score": -0.2961756903052026
        },
        "val": {
            "score": -0.4424988345744867
        },
        "test": {
            "score": -0.4331086516846603
        }
    },
    "best_iteration": 90000,
    "time": "0:09:21"
}
