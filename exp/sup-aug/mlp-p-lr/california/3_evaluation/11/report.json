{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised___6dee678da31042e5ac2f58534076ba29.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 11,
        "data": {
            "path": "data/california",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512,
                    512
                ],
                "dropout": 0.0
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "positional",
                "linear",
                "relu"
            ],
            "d_num_embedding": 126,
            "positional_encoding": {
                "n": 43,
                "sigma": 0.021371444170736765,
                "trainable": true,
                "initialization": "normal"
            },
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.0001093080842538706,
            "weight_decay": 1.4529840437784787e-06,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.42184426713203266,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.0001093080842538706,
            "weight_decay": 1.4529840437784787e-06,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post",
            "supervised_weight": 1.0
        },
        "bins": null
    },
    "epoch_size": 104,
    "n_parameters": 1134577,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -0.3507297774074184,
                    "pretrain_loss": 1.2336851358413696,
                    "pretrain_component": 0.6931406855583191,
                    "supervised_component": 0.6168425679206848,
                    "features_accuracy": [
                        0.5721856355667114,
                        0.569611668586731,
                        0.4931486248970032,
                        0.4213036596775055,
                        0.5775607824325562,
                        0.5110152363777161,
                        0.5213869214057922,
                        0.44764935970306396
                    ]
                },
                "val": {
                    "score": -0.46086539483150846,
                    "pretrain_loss": 1.202394962310791,
                    "pretrain_component": 0.6932427287101746,
                    "supervised_component": 0.6011974811553955,
                    "features_accuracy": [
                        0.5597941279411316,
                        0.565546452999115,
                        0.5040872097015381,
                        0.41871026158332825,
                        0.5694822669029236,
                        0.5004541277885437,
                        0.5216469764709473,
                        0.4480774998664856
                    ]
                },
                "test": {
                    "score": -0.4600724659791516,
                    "pretrain_loss": 1.21483314037323,
                    "pretrain_component": 0.6929810643196106,
                    "supervised_component": 0.607416570186615,
                    "features_accuracy": [
                        0.5704941749572754,
                        0.5704941749572754,
                        0.507509708404541,
                        0.44573643803596497,
                        0.5847868323326111,
                        0.5,
                        0.5215600728988647,
                        0.44064921140670776
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -0.3366251508445168,
                    "pretrain_loss": 1.2082908153533936,
                    "pretrain_component": 0.6930971145629883,
                    "supervised_component": 0.6041454076766968,
                    "features_accuracy": [
                        0.5731698274612427,
                        0.5758952498435974,
                        0.4806571304798126,
                        0.4175940752029419,
                        0.5739268660545349,
                        0.515557587146759,
                        0.5378151535987854,
                        0.462184876203537
                    ]
                },
                "val": {
                    "score": -0.45489905692714433,
                    "pretrain_loss": 1.173072099685669,
                    "pretrain_component": 0.6931912899017334,
                    "supervised_component": 0.5865360498428345,
                    "features_accuracy": [
                        0.5552527904510498,
                        0.5637299418449402,
                        0.47108688950538635,
                        0.41871026158332825,
                        0.5646381974220276,
                        0.5134726166725159,
                        0.5325461626052856,
                        0.4517105519771576
                    ]
                },
                "test": {
                    "score": -0.4539923345021235,
                    "pretrain_loss": 1.185181736946106,
                    "pretrain_component": 0.6929888725280762,
                    "supervised_component": 0.592590868473053,
                    "features_accuracy": [
                        0.5637112259864807,
                        0.5721899271011353,
                        0.48498061299324036,
                        0.44573643803596497,
                        0.5801841020584106,
                        0.5125969052314758,
                        0.5196220874786377,
                        0.44089147448539734
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -0.37167672438096966,
                    "pretrain_loss": 1.2096506357192993,
                    "pretrain_component": 0.6932429075241089,
                    "supervised_component": 0.6048253178596497,
                    "features_accuracy": [
                        0.5663563013076782,
                        0.5756680965423584,
                        0.4886062741279602,
                        0.4135059714317322,
                        0.5654478073120117,
                        0.47808313369750977,
                        0.5078355669975281,
                        0.49806952476501465
                    ]
                },
                "val": {
                    "score": -0.4550864519302895,
                    "pretrain_loss": 1.2053923606872559,
                    "pretrain_component": 0.6933258175849915,
                    "supervised_component": 0.6026961803436279,
                    "features_accuracy": [
                        0.5389040112495422,
                        0.568271279335022,
                        0.47805026173591614,
                        0.41901302337646484,
                        0.563427209854126,
                        0.48410534858703613,
                        0.5043899416923523,
                        0.4950045347213745
                    ]
                },
                "test": {
                    "score": -0.44411866490724194,
                    "pretrain_loss": 1.2020244598388672,
                    "pretrain_component": 0.6930869221687317,
                    "supervised_component": 0.6010122299194336,
                    "features_accuracy": [
                        0.5547480583190918,
                        0.573401153087616,
                        0.49176356196403503,
                        0.44573643803596497,
                        0.5772771239280701,
                        0.4791666567325592,
                        0.5157461166381836,
                        0.49297481775283813
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -0.35646349600188426,
                    "pretrain_loss": 1.1957429647445679,
                    "pretrain_component": 0.693077802658081,
                    "supervised_component": 0.5978714823722839,
                    "features_accuracy": [
                        0.5535619854927063,
                        0.5644636154174805,
                        0.518737256526947,
                        0.4252403676509857,
                        0.5482625961303711,
                        0.4788402020931244,
                        0.5419789552688599,
                        0.5072299242019653
                    ]
                },
                "val": {
                    "score": -0.44924175310288317,
                    "pretrain_loss": 1.168705701828003,
                    "pretrain_component": 0.6932628154754639,
                    "supervised_component": 0.5843528509140015,
                    "features_accuracy": [
                        0.5473811626434326,
                        0.5619134306907654,
                        0.5095368027687073,
                        0.41901302337646484,
                        0.5522252321243286,
                        0.47835302352905273,
                        0.531335175037384,
                        0.4992431104183197
                    ]
                },
                "test": {
                    "score": -0.4382828383047223,
                    "pretrain_loss": 1.1692627668380737,
                    "pretrain_component": 0.6930224895477295,
                    "supervised_component": 0.5846313834190369,
                    "features_accuracy": [
                        0.5598352551460266,
                        0.5663759708404541,
                        0.5234980583190918,
                        0.4452519416809082,
                        0.5499030947685242,
                        0.47989341616630554,
                        0.5406976938247681,
                        0.505571722984314
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": -0.3485534275625079,
                    "pretrain_loss": 1.125745177268982,
                    "pretrain_component": 0.6932210922241211,
                    "supervised_component": 0.562872588634491,
                    "features_accuracy": [
                        0.5503066182136536,
                        0.5614354014396667,
                        0.5034446120262146,
                        0.41789689660072327,
                        0.5523506999015808,
                        0.49012038111686707,
                        0.5244151949882507,
                        0.5020819306373596
                    ]
                },
                "val": {
                    "score": -0.443852800534202,
                    "pretrain_loss": 1.1475025415420532,
                    "pretrain_component": 0.6933279037475586,
                    "supervised_component": 0.5737512707710266,
                    "features_accuracy": [
                        0.5398122668266296,
                        0.5570693016052246,
                        0.5019679069519043,
                        0.42113229632377625,
                        0.5540418028831482,
                        0.48259156942367554,
                        0.5131698250770569,
                        0.4986375868320465
                    ]
                },
                "test": {
                    "score": -0.43461245605861454,
                    "pretrain_loss": 1.1531585454940796,
                    "pretrain_component": 0.6930937170982361,
                    "supervised_component": 0.5765792727470398,
                    "features_accuracy": [
                        0.5525678396224976,
                        0.5641957521438599,
                        0.5101743936538696,
                        0.4454941749572754,
                        0.5457848906517029,
                        0.49394381046295166,
                        0.5232558250427246,
                        0.4920058250427246
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": -0.3504293470379548,
                    "pretrain_loss": 1.1190476417541504,
                    "pretrain_component": 0.6932125687599182,
                    "supervised_component": 0.5595238208770752,
                    "features_accuracy": [
                        0.516087532043457,
                        0.5640851259231567,
                        0.5257778763771057,
                        0.41766977310180664,
                        0.5428874492645264,
                        0.49557122588157654,
                        0.5087440609931946,
                        0.5001893043518066
                    ]
                },
                "val": {
                    "score": -0.44333220639132526,
                    "pretrain_loss": 1.1381272077560425,
                    "pretrain_component": 0.6933566927909851,
                    "supervised_component": 0.5690636038780212,
                    "features_accuracy": [
                        0.5086285471916199,
                        0.5576748251914978,
                        0.526188313961029,
                        0.42415985465049744,
                        0.546170175075531,
                        0.4947017729282379,
                        0.4901604652404785,
                        0.48410534858703613
                    ]
                },
                "test": {
                    "score": -0.4323147227473747,
                    "pretrain_loss": 1.1297001838684082,
                    "pretrain_component": 0.6931058168411255,
                    "supervised_component": 0.5648500919342041,
                    "features_accuracy": [
                        0.5327034592628479,
                        0.5639534592628479,
                        0.5273740291595459,
                        0.44500967860221863,
                        0.5307654738426208,
                        0.4985465109348297,
                        0.5031492114067078,
                        0.4910368323326111
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": -0.33960765337062,
                    "pretrain_loss": 1.1337238550186157,
                    "pretrain_component": 0.6931182146072388,
                    "supervised_component": 0.5668619275093079,
                    "features_accuracy": [
                        0.49859946966171265,
                        0.5724884867668152,
                        0.5270649194717407,
                        0.4250889718532562,
                        0.5338027477264404,
                        0.47558483481407166,
                        0.5117722749710083,
                        0.5132864117622375
                    ]
                },
                "val": {
                    "score": -0.4405096697235478,
                    "pretrain_loss": 1.1274162530899048,
                    "pretrain_component": 0.6932526230812073,
                    "supervised_component": 0.5637081265449524,
                    "features_accuracy": [
                        0.4910687208175659,
                        0.553436279296875,
                        0.5280048251152039,
                        0.4308204650878906,
                        0.5416288375854492,
                        0.47562822699546814,
                        0.5071147680282593,
                        0.4916742444038391
                    ]
                },
                "test": {
                    "score": -0.4294103101666631,
                    "pretrain_loss": 1.138453722000122,
                    "pretrain_component": 0.6930266618728638,
                    "supervised_component": 0.569226861000061,
                    "features_accuracy": [
                        0.5070251822471619,
                        0.5668604373931885,
                        0.5242248177528381,
                        0.44597867131233215,
                        0.5411821603775024,
                        0.4777131676673889,
                        0.5218023061752319,
                        0.5058139562606812
                    ]
                }
            },
            "80000": {
                "train": {
                    "score": -0.33131945745169555,
                    "pretrain_loss": 1.1514321565628052,
                    "pretrain_component": 0.6927539706230164,
                    "supervised_component": 0.5757160782814026,
                    "features_accuracy": [
                        0.5060943365097046,
                        0.5752896070480347,
                        0.5294874906539917,
                        0.43773186206817627,
                        0.5540919303894043,
                        0.49102887511253357,
                        0.5149519443511963,
                        0.5088197588920593
                    ]
                },
                "val": {
                    "score": -0.44120902429023606,
                    "pretrain_loss": 1.1369950771331787,
                    "pretrain_component": 0.6930285096168518,
                    "supervised_component": 0.5684975385665894,
                    "features_accuracy": [
                        0.4928852617740631,
                        0.5491976737976074,
                        0.5304268598556519,
                        0.4362700581550598,
                        0.553436279296875,
                        0.4871329069137573,
                        0.5125643610954285,
                        0.48531636595726013
                    ]
                },
                "test": {
                    "score": -0.4294386815071393,
                    "pretrain_loss": 1.1260981559753418,
                    "pretrain_component": 0.6927775144577026,
                    "supervised_component": 0.5630490779876709,
                    "features_accuracy": [
                        0.5150193572044373,
                        0.5673449635505676,
                        0.5394864082336426,
                        0.4467054307460785,
                        0.5591084957122803,
                        0.4830426275730133,
                        0.5155038833618164,
                        0.5084787011146545
                    ]
                }
            },
            "90000": {
                "train": {
                    "score": -0.3490018262887565,
                    "pretrain_loss": 1.1157350540161133,
                    "pretrain_component": 0.692955732345581,
                    "supervised_component": 0.5578675270080566,
                    "features_accuracy": [
                        0.5015519857406616,
                        0.558180034160614,
                        0.515557587146759,
                        0.43485504388809204,
                        0.5289575457572937,
                        0.48974186182022095,
                        0.5257778763771057,
                        0.5081384181976318
                    ]
                },
                "val": {
                    "score": -0.44158601340892334,
                    "pretrain_loss": 1.1235123872756958,
                    "pretrain_component": 0.69303959608078,
                    "supervised_component": 0.5617561936378479,
                    "features_accuracy": [
                        0.5056009888648987,
                        0.546170175075531,
                        0.5149863958358765,
                        0.4414168894290924,
                        0.5431426167488098,
                        0.5010596513748169,
                        0.5131698250770569,
                        0.4919769763946533
                    ]
                },
                "test": {
                    "score": -0.4300953725537793,
                    "pretrain_loss": 1.1293226480484009,
                    "pretrain_component": 0.6928081512451172,
                    "supervised_component": 0.5646613240242004,
                    "features_accuracy": [
                        0.5196220874786377,
                        0.5617732405662537,
                        0.5300387740135193,
                        0.4491279125213623,
                        0.5438469052314758,
                        0.48619186878204346,
                        0.5264050364494324,
                        0.5084787011146545
                    ]
                }
            },
            "100000": {
                "train": {
                    "score": -0.3168756400416847,
                    "pretrain_loss": 1.1170324087142944,
                    "pretrain_component": 0.692776083946228,
                    "supervised_component": 0.5585162043571472,
                    "features_accuracy": [
                        0.5017790794372559,
                        0.5516693592071533,
                        0.5451586246490479,
                        0.4457567036151886,
                        0.5378151535987854,
                        0.47732609510421753,
                        0.5170717239379883,
                        0.525172233581543
                    ]
                },
                "val": {
                    "score": -0.44308575687869256,
                    "pretrain_loss": 1.1171412467956543,
                    "pretrain_component": 0.6929224729537964,
                    "supervised_component": 0.5585706233978271,
                    "features_accuracy": [
                        0.48531636595726013,
                        0.53617924451828,
                        0.541023313999176,
                        0.4571601450443268,
                        0.5392068028450012,
                        0.47926127910614014,
                        0.4992431104183197,
                        0.5110505819320679
                    ]
                },
                "test": {
                    "score": -0.4291309837536813,
                    "pretrain_loss": 1.1153476238250732,
                    "pretrain_component": 0.692665159702301,
                    "supervised_component": 0.5576738119125366,
                    "features_accuracy": [
                        0.5247092843055725,
                        0.5564438104629517,
                        0.5469961166381836,
                        0.4636628031730652,
                        0.5423933863639832,
                        0.4857073724269867,
                        0.5155038833618164,
                        0.5300387740135193
                    ]
                }
            }
        },
        "train": {
            "score": -0.33960765337062
        },
        "val": {
            "score": -0.4405096697235478
        },
        "test": {
            "score": -0.4294103101666631
        }
    },
    "best_iteration": 70000,
    "time": "0:09:15"
}
