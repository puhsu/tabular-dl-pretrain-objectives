{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised___6dee678da31042e5ac2f58534076ba29.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 9,
        "data": {
            "path": "data/california",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512,
                    512
                ],
                "dropout": 0.0
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "positional",
                "linear",
                "relu"
            ],
            "d_num_embedding": 126,
            "positional_encoding": {
                "n": 43,
                "sigma": 0.021371444170736765,
                "trainable": true,
                "initialization": "normal"
            },
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.0001093080842538706,
            "weight_decay": 1.4529840437784787e-06,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.42184426713203266,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.0001093080842538706,
            "weight_decay": 1.4529840437784787e-06,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post",
            "supervised_weight": 1.0
        },
        "bins": null
    },
    "epoch_size": 104,
    "n_parameters": 1134577,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -0.38131942242027067,
                    "pretrain_loss": 1.2726837396621704,
                    "pretrain_component": 0.6941988468170166,
                    "supervised_component": 0.6363418698310852,
                    "features_accuracy": [
                        0.4727837145328522,
                        0.4278900921344757,
                        0.4920887351036072,
                        0.5417518615722656,
                        0.44976910948753357,
                        0.4338708519935608,
                        0.42569461464881897,
                        0.4213793873786926
                    ]
                },
                "val": {
                    "score": -0.4638304079054142,
                    "pretrain_loss": 1.2344132661819458,
                    "pretrain_component": 0.694083571434021,
                    "supervised_component": 0.6172066330909729,
                    "features_accuracy": [
                        0.4971238374710083,
                        0.41386619210243225,
                        0.4931880235671997,
                        0.5476838946342468,
                        0.4535270929336548,
                        0.42264607548713684,
                        0.42264607548713684,
                        0.4432334303855896
                    ]
                },
                "test": {
                    "score": -0.45822879664050215,
                    "pretrain_loss": 1.2740821838378906,
                    "pretrain_component": 0.6942358016967773,
                    "supervised_component": 0.6370410919189453,
                    "features_accuracy": [
                        0.4791666567325592,
                        0.4321705400943756,
                        0.4978197515010834,
                        0.5428779125213623,
                        0.4597868323326111,
                        0.42126938700675964,
                        0.40697672963142395,
                        0.42611435055732727
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -0.37559824821952364,
                    "pretrain_loss": 1.2326264381408691,
                    "pretrain_component": 0.6942409873008728,
                    "supervised_component": 0.6163132190704346,
                    "features_accuracy": [
                        0.496782511472702,
                        0.46142783761024475,
                        0.5156332850456238,
                        0.520099937915802,
                        0.4252403676509857,
                        0.4339465796947479,
                        0.418502539396286,
                        0.4354606866836548
                    ]
                },
                "val": {
                    "score": -0.4528169248084044,
                    "pretrain_loss": 1.1907620429992676,
                    "pretrain_component": 0.6940969228744507,
                    "supervised_component": 0.5953810214996338,
                    "features_accuracy": [
                        0.5104450583457947,
                        0.4456554651260376,
                        0.5074175000190735,
                        0.5280048251152039,
                        0.4365728199481964,
                        0.4365728199481964,
                        0.42173781991004944,
                        0.4483802616596222
                    ]
                },
                "test": {
                    "score": -0.4477345671373427,
                    "pretrain_loss": 1.2308530807495117,
                    "pretrain_component": 0.6941863298416138,
                    "supervised_component": 0.6154265403747559,
                    "features_accuracy": [
                        0.510901153087616,
                        0.47068798542022705,
                        0.5244670510292053,
                        0.5164728760719299,
                        0.447674423456192,
                        0.42902132868766785,
                        0.4072189927101135,
                        0.42926356196403503
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -0.35570057749183626,
                    "pretrain_loss": 1.175394892692566,
                    "pretrain_component": 0.6944447755813599,
                    "supervised_component": 0.587697446346283,
                    "features_accuracy": [
                        0.5125293731689453,
                        0.47876450419425964,
                        0.47293514013290405,
                        0.5218411684036255,
                        0.43273526430130005,
                        0.4292528033256531,
                        0.42243924736976624,
                        0.43288668990135193
                    ]
                },
                "val": {
                    "score": -0.4480355811669271,
                    "pretrain_loss": 1.1607098579406738,
                    "pretrain_component": 0.6941894292831421,
                    "supervised_component": 0.5803549289703369,
                    "features_accuracy": [
                        0.5343626737594604,
                        0.47350892424583435,
                        0.47502270340919495,
                        0.5376930236816406,
                        0.4399031102657318,
                        0.4432334303855896,
                        0.4283984303474426,
                        0.4586739242076874
                    ]
                },
                "test": {
                    "score": -0.4380202135908662,
                    "pretrain_loss": 1.2064305543899536,
                    "pretrain_component": 0.694320559501648,
                    "supervised_component": 0.6032152771949768,
                    "features_accuracy": [
                        0.5271317958831787,
                        0.4910368323326111,
                        0.4883720874786377,
                        0.5300387740135193,
                        0.4469476640224457,
                        0.4324128031730652,
                        0.4103682041168213,
                        0.4345930218696594
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -0.3400178969498989,
                    "pretrain_loss": 1.1706230640411377,
                    "pretrain_component": 0.6944926381111145,
                    "supervised_component": 0.5853115320205688,
                    "features_accuracy": [
                        0.5200242400169373,
                        0.48830345273017883,
                        0.4522674083709717,
                        0.5341812372207642,
                        0.42652738094329834,
                        0.4411386251449585,
                        0.43879175186157227,
                        0.44015446305274963
                    ]
                },
                "val": {
                    "score": -0.4470794749820374,
                    "pretrain_loss": 1.1410284042358398,
                    "pretrain_component": 0.694240927696228,
                    "supervised_component": 0.5705142021179199,
                    "features_accuracy": [
                        0.5343626737594604,
                        0.4913714826107025,
                        0.47017863392829895,
                        0.5428398251533508,
                        0.446563720703125,
                        0.4459582269191742,
                        0.4420224130153656,
                        0.4568574130535126
                    ]
                },
                "test": {
                    "score": -0.43600272194012374,
                    "pretrain_loss": 1.2030285596847534,
                    "pretrain_component": 0.6943811178207397,
                    "supervised_component": 0.6015142798423767,
                    "features_accuracy": [
                        0.5382751822471619,
                        0.4910368323326111,
                        0.4743216931819916,
                        0.5334302186965942,
                        0.45251938700675964,
                        0.43701550364494324,
                        0.42611435055732727,
                        0.4362887442111969
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": -0.32759023190813574,
                    "pretrain_loss": 1.1230186223983765,
                    "pretrain_component": 0.6946025490760803,
                    "supervised_component": 0.5615093111991882,
                    "features_accuracy": [
                        0.5292603969573975,
                        0.48088425397872925,
                        0.45325160026550293,
                        0.5489439368247986,
                        0.4421985149383545,
                        0.43932169675827026,
                        0.4313725531101227,
                        0.44409117102622986
                    ]
                },
                "val": {
                    "score": -0.4466513579698022,
                    "pretrain_loss": 1.1500529050827026,
                    "pretrain_component": 0.6944321990013123,
                    "supervised_component": 0.5750264525413513,
                    "features_accuracy": [
                        0.545867383480072,
                        0.48047229647636414,
                        0.4556463658809662,
                        0.5516197085380554,
                        0.442930668592453,
                        0.4368755519390106,
                        0.4341507852077484,
                        0.4598849415779114
                    ]
                },
                "test": {
                    "score": -0.4351942410726411,
                    "pretrain_loss": 1.1918492317199707,
                    "pretrain_component": 0.6946163177490234,
                    "supervised_component": 0.5959246158599854,
                    "features_accuracy": [
                        0.5411821603775024,
                        0.48086240887641907,
                        0.4609980583190918,
                        0.5460271239280701,
                        0.44573643803596497,
                        0.43144381046295166,
                        0.4195736348628998,
                        0.4377422332763672
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": -0.3143937288021282,
                    "pretrain_loss": 1.1453462839126587,
                    "pretrain_component": 0.6946991682052612,
                    "supervised_component": 0.5726731419563293,
                    "features_accuracy": [
                        0.5378908514976501,
                        0.47702324390411377,
                        0.4501476287841797,
                        0.5383450984954834,
                        0.43076691031455994,
                        0.43523356318473816,
                        0.43447649478912354,
                        0.4499962329864502
                    ]
                },
                "val": {
                    "score": -0.4446015919612699,
                    "pretrain_loss": 1.13465416431427,
                    "pretrain_component": 0.6943748593330383,
                    "supervised_component": 0.567327082157135,
                    "features_accuracy": [
                        0.5398122668266296,
                        0.46382075548171997,
                        0.461398720741272,
                        0.5452618598937988,
                        0.4444444477558136,
                        0.448985755443573,
                        0.4371783137321472,
                        0.46230700612068176
                    ]
                },
                "test": {
                    "score": -0.43498796397513323,
                    "pretrain_loss": 1.1836320161819458,
                    "pretrain_component": 0.6946065425872803,
                    "supervised_component": 0.5918160080909729,
                    "features_accuracy": [
                        0.5462693572044373,
                        0.47625967860221863,
                        0.4583333432674408,
                        0.5414243936538696,
                        0.4452519416809082,
                        0.4425871968269348,
                        0.4229651093482971,
                        0.4440406858921051
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": -0.3069170874715844,
                    "pretrain_loss": 1.1670525074005127,
                    "pretrain_component": 0.6947416067123413,
                    "supervised_component": 0.5835262537002563,
                    "features_accuracy": [
                        0.5279733538627625,
                        0.47702324390411377,
                        0.43826180696487427,
                        0.5391778349876404,
                        0.43826180696487427,
                        0.45521995425224304,
                        0.4370505213737488,
                        0.44848209619522095
                    ]
                },
                "val": {
                    "score": -0.4453993283766434,
                    "pretrain_loss": 1.140065312385559,
                    "pretrain_component": 0.694366991519928,
                    "supervised_component": 0.5700326561927795,
                    "features_accuracy": [
                        0.5331516861915588,
                        0.48198607563972473,
                        0.4456554651260376,
                        0.5473811626434326,
                        0.4389948546886444,
                        0.4571601450443268,
                        0.4435361921787262,
                        0.46472904086112976
                    ]
                },
                "test": {
                    "score": -0.4327822298865893,
                    "pretrain_loss": 1.1919612884521484,
                    "pretrain_component": 0.6946276426315308,
                    "supervised_component": 0.5959806442260742,
                    "features_accuracy": [
                        0.5363371968269348,
                        0.47068798542022705,
                        0.4469476640224457,
                        0.5436046719551086,
                        0.4520348906517029,
                        0.4530038833618164,
                        0.424660861492157,
                        0.44452518224716187
                    ]
                }
            },
            "80000": {
                "train": {
                    "score": -0.2998552697087502,
                    "pretrain_loss": 1.1563396453857422,
                    "pretrain_component": 0.6947507262229919,
                    "supervised_component": 0.5781698226928711,
                    "features_accuracy": [
                        0.522749662399292,
                        0.45469000935554504,
                        0.44091150164604187,
                        0.565902054309845,
                        0.4245590269565582,
                        0.4528730511665344,
                        0.41819971799850464,
                        0.4617306590080261
                    ]
                },
                "val": {
                    "score": -0.443223558157487,
                    "pretrain_loss": 1.1228370666503906,
                    "pretrain_component": 0.6944015026092529,
                    "supervised_component": 0.5614185333251953,
                    "features_accuracy": [
                        0.535876452922821,
                        0.461398720741272,
                        0.4544353485107422,
                        0.5685740113258362,
                        0.4377838373184204,
                        0.454132616519928,
                        0.42688465118408203,
                        0.4610959589481354
                    ]
                },
                "test": {
                    "score": -0.4300276062121685,
                    "pretrain_loss": 1.183570146560669,
                    "pretrain_component": 0.6945850253105164,
                    "supervised_component": 0.5917850732803345,
                    "features_accuracy": [
                        0.534641444683075,
                        0.4651162624359131,
                        0.4520348906517029,
                        0.5661337375640869,
                        0.44355618953704834,
                        0.4505814015865326,
                        0.4103682041168213,
                        0.45106589794158936
                    ]
                }
            },
            "90000": {
                "train": {
                    "score": -0.3169311541035126,
                    "pretrain_loss": 1.1382960081100464,
                    "pretrain_component": 0.6948428153991699,
                    "supervised_component": 0.5691480040550232,
                    "features_accuracy": [
                        0.529411792755127,
                        0.4356878101825714,
                        0.4535544216632843,
                        0.5724127888679504,
                        0.42955562472343445,
                        0.44530245661735535,
                        0.41925960779190063,
                        0.4533272981643677
                    ]
                },
                "val": {
                    "score": -0.444350335742339,
                    "pretrain_loss": 1.1241731643676758,
                    "pretrain_component": 0.6943935751914978,
                    "supervised_component": 0.5620865821838379,
                    "features_accuracy": [
                        0.5389040112495422,
                        0.4386920928955078,
                        0.4526188373565674,
                        0.5791704654693604,
                        0.4423251450061798,
                        0.461398720741272,
                        0.42385709285736084,
                        0.46805933117866516
                    ]
                },
                "test": {
                    "score": -0.4329601906446386,
                    "pretrain_loss": 1.179054617881775,
                    "pretrain_component": 0.6945226788520813,
                    "supervised_component": 0.5895273089408875,
                    "features_accuracy": [
                        0.536821722984314,
                        0.4481589198112488,
                        0.4624515473842621,
                        0.588420569896698,
                        0.4440406858921051,
                        0.4532461166381836,
                        0.4072189927101135,
                        0.4479166567325592
                    ]
                }
            },
            "100000": {
                "train": {
                    "score": -0.3318267769479138,
                    "pretrain_loss": 1.1013883352279663,
                    "pretrain_component": 0.6945662498474121,
                    "supervised_component": 0.5506941676139832,
                    "features_accuracy": [
                        0.5378908514976501,
                        0.4418199956417084,
                        0.44795218110084534,
                        0.5788477659225464,
                        0.43273526430130005,
                        0.4577939510345459,
                        0.4169127345085144,
                        0.45431146025657654
                    ]
                },
                "val": {
                    "score": -0.4441759217733952,
                    "pretrain_loss": 1.1355183124542236,
                    "pretrain_component": 0.6942633986473083,
                    "supervised_component": 0.5677591562271118,
                    "features_accuracy": [
                        0.5419315695762634,
                        0.4423251450061798,
                        0.4498940408229828,
                        0.5821980237960815,
                        0.442930668592453,
                        0.4610959589481354,
                        0.42385709285736084,
                        0.47320616245269775
                    ]
                },
                "test": {
                    "score": -0.42811866759298733,
                    "pretrain_loss": 1.1817377805709839,
                    "pretrain_component": 0.6943796873092651,
                    "supervised_component": 0.5908688902854919,
                    "features_accuracy": [
                        0.5457848906517029,
                        0.45639535784721375,
                        0.4622093141078949,
                        0.5886628031730652,
                        0.4423449635505676,
                        0.45251938700675964,
                        0.40188953280448914,
                        0.4583333432674408
                    ]
                }
            }
        },
        "train": {
            "score": -0.2998552697087502
        },
        "val": {
            "score": -0.443223558157487
        },
        "test": {
            "score": -0.4300276062121685
        }
    },
    "best_iteration": 80000,
    "time": "0:09:31"
}
