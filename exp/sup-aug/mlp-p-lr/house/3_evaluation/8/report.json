{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised___2ce16b2742a141469a2f8b9f798dabd8.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 8,
        "data": {
            "path": "data/house",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512,
                    512,
                    512,
                    512,
                    512,
                    512
                ],
                "dropout": 0.43544635527962955
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "positional",
                "linear",
                "relu"
            ],
            "d_num_embedding": 89,
            "positional_encoding": {
                "n": 128,
                "sigma": 0.014915969010256101,
                "trainable": true,
                "initialization": "normal"
            },
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.00013155855545440585,
            "weight_decay": 3.813532862281361e-05,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.7024225910408017,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.00013155855545440585,
            "weight_decay": 3.813532862281361e-05,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post",
            "supervised_weight": 1.0
        },
        "bins": null
    },
    "epoch_size": 114,
    "n_parameters": 2682273,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -23834.753375250875,
                    "pretrain_loss": 1.7899465560913086,
                    "pretrain_component": 0.6927095055580139,
                    "supervised_component": 0.8949732780456543,
                    "features_accuracy": [
                        0.7016665935516357,
                        0.29792195558547974,
                        0.37494000792503357,
                        0.6981688737869263,
                        0.6608600616455078,
                        0.6721075773239136,
                        0.5166312456130981,
                        0.299430787563324,
                        0.3761744797229767,
                        0.2951100766658783,
                        0.7018723487854004,
                        0.4037446081638336,
                        0.5911117792129517,
                        0.7034497261047363,
                        0.30292847752571106,
                        0.597764253616333
                    ]
                },
                "val": {
                    "score": -29211.412134854698,
                    "pretrain_loss": 2.0142295360565186,
                    "pretrain_component": 0.6927363872528076,
                    "supervised_component": 1.0071147680282593,
                    "features_accuracy": [
                        0.7024136185646057,
                        0.2948436737060547,
                        0.3521667718887329,
                        0.7043335437774658,
                        0.669775128364563,
                        0.6708722114562988,
                        0.5153593420982361,
                        0.2967635989189148,
                        0.3447614014148712,
                        0.30115196108818054,
                        0.7076248526573181,
                        0.4031815826892853,
                        0.5899616479873657,
                        0.700767993927002,
                        0.3055403232574463,
                        0.5885902643203735
                    ]
                },
                "test": {
                    "score": -31495.22291226764,
                    "pretrain_loss": 1.9324613809585571,
                    "pretrain_component": 0.6927367448806763,
                    "supervised_component": 0.9662306904792786,
                    "features_accuracy": [
                        0.696291446685791,
                        0.29756417870521545,
                        0.36164143681526184,
                        0.6971691846847534,
                        0.6504279375076294,
                        0.6796137690544128,
                        0.5192012190818787,
                        0.29668641090393066,
                        0.36910247802734375,
                        0.2931753396987915,
                        0.7186746001243591,
                        0.40048277378082275,
                        0.5848146080970764,
                        0.7057274580001831,
                        0.3021724820137024,
                        0.5867895483970642
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -22708.505808729904,
                    "pretrain_loss": 1.7823195457458496,
                    "pretrain_component": 0.6931922435760498,
                    "supervised_component": 0.8911597728729248,
                    "features_accuracy": [
                        0.7029696702957153,
                        0.29565873742103577,
                        0.38097524642944336,
                        0.6323297619819641,
                        0.6900075674057007,
                        0.6309581398963928,
                        0.523352324962616,
                        0.2946300208568573,
                        0.37411701679229736,
                        0.2963445782661438,
                        0.7052328586578369,
                        0.4106714427471161,
                        0.5371373891830444,
                        0.617378830909729,
                        0.29607024788856506,
                        0.4979768395423889
                    ]
                },
                "val": {
                    "score": -28964.639540883334,
                    "pretrain_loss": 2.0073649883270264,
                    "pretrain_component": 0.6933042407035828,
                    "supervised_component": 1.0036824941635132,
                    "features_accuracy": [
                        0.7021393775939941,
                        0.2948436737060547,
                        0.3521667718887329,
                        0.6300055384635925,
                        0.6936368942260742,
                        0.6267142295837402,
                        0.5153593420982361,
                        0.2967635989189148,
                        0.3447614014148712,
                        0.30115196108818054,
                        0.7076248526573181,
                        0.4048272371292114,
                        0.5367526412010193,
                        0.613274872303009,
                        0.3055403232574463,
                        0.5167306661605835
                    ]
                },
                "test": {
                    "score": -31205.69070444784,
                    "pretrain_loss": 1.9198758602142334,
                    "pretrain_component": 0.6932588815689087,
                    "supervised_component": 0.9599379301071167,
                    "features_accuracy": [
                        0.695852518081665,
                        0.29756417870521545,
                        0.36164143681526184,
                        0.617950439453125,
                        0.6809304356575012,
                        0.630678117275238,
                        0.5192012190818787,
                        0.29668641090393066,
                        0.36910247802734375,
                        0.2938336730003357,
                        0.7186746001243591,
                        0.4031161069869995,
                        0.5310511589050293,
                        0.6221198439598083,
                        0.3021724820137024,
                        0.5069124698638916
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -19582.54861665549,
                    "pretrain_loss": 1.7853819131851196,
                    "pretrain_component": 0.6931328773498535,
                    "supervised_component": 0.8926909565925598,
                    "features_accuracy": [
                        0.6941225528717041,
                        0.3026541471481323,
                        0.3723338842391968,
                        0.6878129243850708,
                        0.6802688837051392,
                        0.6413140892982483,
                        0.5247925519943237,
                        0.2993622124195099,
                        0.3739798665046692,
                        0.3117756247520447,
                        0.7051643133163452,
                        0.41554078459739685,
                        0.5414580702781677,
                        0.5839791893959045,
                        0.3001165986061096,
                        0.4575132131576538
                    ]
                },
                "val": {
                    "score": -28715.472977292004,
                    "pretrain_loss": 2.004495143890381,
                    "pretrain_component": 0.6932511329650879,
                    "supervised_component": 1.0022475719451904,
                    "features_accuracy": [
                        0.7015908360481262,
                        0.2948436737060547,
                        0.3521667718887329,
                        0.6911684274673462,
                        0.6769062280654907,
                        0.6379594206809998,
                        0.5153593420982361,
                        0.2967635989189148,
                        0.3447614014148712,
                        0.30362042784690857,
                        0.7076248526573181,
                        0.4048272371292114,
                        0.5471749901771545,
                        0.5806363224983215,
                        0.3055403232574463,
                        0.46626442670822144
                    ]
                },
                "test": {
                    "score": -31288.221818723254,
                    "pretrain_loss": 1.9229636192321777,
                    "pretrain_component": 0.6931673288345337,
                    "supervised_component": 0.9614818096160889,
                    "features_accuracy": [
                        0.696071982383728,
                        0.29756417870521545,
                        0.36164143681526184,
                        0.677638828754425,
                        0.6578889489173889,
                        0.6414307951927185,
                        0.5192012190818787,
                        0.29668641090393066,
                        0.36910247802734375,
                        0.3004169464111328,
                        0.7186746001243591,
                        0.4031161069869995,
                        0.5387316346168518,
                        0.5841562747955322,
                        0.3021724820137024,
                        0.46543779969215393
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -22818.369309232578,
                    "pretrain_loss": 1.7742623090744019,
                    "pretrain_component": 0.6931122541427612,
                    "supervised_component": 0.8871311545372009,
                    "features_accuracy": [
                        0.7009121775627136,
                        0.30423155426979065,
                        0.3739798665046692,
                        0.7040669918060303,
                        0.6851382255554199,
                        0.7097592949867249,
                        0.5235580801963806,
                        0.29613882303237915,
                        0.3739798665046692,
                        0.29531583189964294,
                        0.7078390121459961,
                        0.4029902219772339,
                        0.5898772478103638,
                        0.42363351583480835,
                        0.3073177635669708,
                        0.47356149554252625
                    ]
                },
                "val": {
                    "score": -29201.342541747377,
                    "pretrain_loss": 2.0007688999176025,
                    "pretrain_component": 0.693304181098938,
                    "supervised_component": 1.0003844499588013,
                    "features_accuracy": [
                        0.700219452381134,
                        0.2948436737060547,
                        0.3521667718887329,
                        0.7043335437774658,
                        0.6736149787902832,
                        0.700767993927002,
                        0.5153593420982361,
                        0.2967635989189148,
                        0.3447614014148712,
                        0.30115196108818054,
                        0.7076248526573181,
                        0.38919365406036377,
                        0.6012068390846252,
                        0.42951181530952454,
                        0.30526605248451233,
                        0.4917718172073364
                    ]
                },
                "test": {
                    "score": -31898.859352019736,
                    "pretrain_loss": 1.9169187545776367,
                    "pretrain_component": 0.6932682991027832,
                    "supervised_component": 0.9584593772888184,
                    "features_accuracy": [
                        0.6956331133842468,
                        0.29756417870521545,
                        0.36164143681526184,
                        0.6971691846847534,
                        0.6605222821235657,
                        0.7055079936981201,
                        0.5192012190818787,
                        0.29668641090393066,
                        0.36910247802734375,
                        0.2931753396987915,
                        0.7186746001243591,
                        0.3897300958633423,
                        0.5889840126037598,
                        0.42352426052093506,
                        0.3019530475139618,
                        0.48167654871940613
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": -23092.798517288804,
                    "pretrain_loss": 1.7631335258483887,
                    "pretrain_component": 0.692612886428833,
                    "supervised_component": 0.8815667629241943,
                    "features_accuracy": [
                        0.7082505226135254,
                        0.2908579707145691,
                        0.3700020909309387,
                        0.6994719505310059,
                        0.682463526725769,
                        0.7029010653495789,
                        0.526781439781189,
                        0.3002537786960602,
                        0.3719223737716675,
                        0.2996365427970886,
                        0.7050957083702087,
                        0.4259653091430664,
                        0.5172485113143921,
                        0.7053014636039734,
                        0.3095124065876007,
                        0.5328853130340576
                    ]
                },
                "val": {
                    "score": -29259.171866426546,
                    "pretrain_loss": 2.0110385417938232,
                    "pretrain_component": 0.6927242279052734,
                    "supervised_component": 1.0055192708969116,
                    "features_accuracy": [
                        0.7021393775939941,
                        0.2948436737060547,
                        0.3521667718887329,
                        0.7043335437774658,
                        0.6804717779159546,
                        0.700767993927002,
                        0.5153593420982361,
                        0.2967635989189148,
                        0.3447614014148712,
                        0.30115196108818054,
                        0.7076248526573181,
                        0.4264948070049286,
                        0.5290729999542236,
                        0.700219452381134,
                        0.3066374361515045,
                        0.5515633821487427
                    ]
                },
                "test": {
                    "score": -32145.50819845028,
                    "pretrain_loss": 1.925681233406067,
                    "pretrain_component": 0.692658543586731,
                    "supervised_component": 0.9628406167030334,
                    "features_accuracy": [
                        0.695852518081665,
                        0.29756417870521545,
                        0.36164143681526184,
                        0.6971691846847534,
                        0.6690805554389954,
                        0.7055079936981201,
                        0.5192012190818787,
                        0.29668641090393066,
                        0.36910247802734375,
                        0.2931753396987915,
                        0.7186746001243591,
                        0.42615756392478943,
                        0.5211762189865112,
                        0.7055079936981201,
                        0.302611380815506,
                        0.5345622301101685
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": -23265.434053391193,
                    "pretrain_loss": 1.8112423419952393,
                    "pretrain_component": 0.6925662159919739,
                    "supervised_component": 0.9056211709976196,
                    "features_accuracy": [
                        0.7063301801681519,
                        0.2954530119895935,
                        0.36815035343170166,
                        0.7005006670951843,
                        0.705507218837738,
                        0.7068102955818176,
                        0.528633177280426,
                        0.296481728553772,
                        0.37542009353637695,
                        0.3010767698287964,
                        0.7003635168075562,
                        0.4118373394012451,
                        0.5903573632240295,
                        0.7037926316261292,
                        0.30347713828086853,
                        0.574240505695343
                    ]
                },
                "val": {
                    "score": -30067.34267996421,
                    "pretrain_loss": 2.028630256652832,
                    "pretrain_component": 0.6927280426025391,
                    "supervised_component": 1.014315128326416,
                    "features_accuracy": [
                        0.7021393775939941,
                        0.2945694029331207,
                        0.3535381257534027,
                        0.7043335437774658,
                        0.6993966102600098,
                        0.700767993927002,
                        0.5153593420982361,
                        0.2967635989189148,
                        0.3447614014148712,
                        0.30115196108818054,
                        0.7076248526573181,
                        0.4048272371292114,
                        0.6031267642974854,
                        0.700767993927002,
                        0.30526605248451233,
                        0.5866703391075134
                    ]
                },
                "test": {
                    "score": -32639.062159278586,
                    "pretrain_loss": 1.9505542516708374,
                    "pretrain_component": 0.6926164627075195,
                    "supervised_component": 0.9752771258354187,
                    "features_accuracy": [
                        0.695852518081665,
                        0.29734474420547485,
                        0.35966646671295166,
                        0.6971691846847534,
                        0.6903665065765381,
                        0.7055079936981201,
                        0.5192012190818787,
                        0.29668641090393066,
                        0.36910247802734375,
                        0.29602810740470886,
                        0.7186746001243591,
                        0.4031161069869995,
                        0.5946894884109497,
                        0.7057274580001831,
                        0.3021724820137024,
                        0.5685757994651794
                    ]
                }
            }
        },
        "train": {
            "score": -19582.54861665549
        },
        "val": {
            "score": -28715.472977292004
        },
        "test": {
            "score": -31288.221818723254
        }
    },
    "best_iteration": 30000,
    "time": "0:10:14"
}
