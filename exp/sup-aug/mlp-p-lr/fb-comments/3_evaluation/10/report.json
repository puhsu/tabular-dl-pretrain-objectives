{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised_fast___4f643edbe1e143c690241bc155a29af9.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0,1",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                },
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 10,
        "data": {
            "path": "data/fb-comments",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512
                ],
                "dropout": 0.44744397584213635
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "positional",
                "linear",
                "relu"
            ],
            "d_num_embedding": 80,
            "positional_encoding": {
                "n": 17,
                "sigma": 0.2786440030986657,
                "trainable": true,
                "initialization": "normal"
            },
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 512,
            "lr": 0.00015540039302508303,
            "weight_decay": 7.309044283047996e-06,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 1024
        },
        "pretrain": {
            "corrupt_probability": 0.4251617309148788,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.00015540039302508303,
            "weight_decay": 7.309044283047996e-06,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post",
            "supervised_weight": 1.0
        },
        "bins": null
    },
    "n_parameters": 2520166,
    "epoch_size": 308,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -3.9994176268022494,
                    "pretrain_loss": 0.9455259442329407,
                    "pretrain_component": 0.6967416405677795,
                    "supervised_component": 0.47276297211647034,
                    "features_accuracy": [
                        0.5755401849746704,
                        0.5896801948547363,
                        0.5134802460670471,
                        0.5553039312362671,
                        0.4281962513923645,
                        0.44935232400894165,
                        0.5325682759284973,
                        0.47956711053848267,
                        0.6488093137741089,
                        0.5710552334785461,
                        0.612123966217041,
                        0.46131008863449097,
                        0.45201030373573303,
                        0.5381507277488708,
                        0.5859754681587219,
                        0.5413289070129395,
                        0.530417799949646,
                        0.474086195230484,
                        0.5658661127090454,
                        0.346122145652771,
                        0.4666070342063904,
                        0.5504130125045776,
                        0.36734798550605774,
                        0.4395323693752289,
                        0.5711947679519653,
                        0.5113804936408997,
                        0.4368743598461151,
                        0.41963866353034973,
                        0.5140194892883301,
                        0.11665969341993332,
                        0.13381291925907135,
                        0.8945749402046204,
                        0.8963321447372437,
                        0.2757774293422699,
                        0.11483272165060043,
                        0.14540275931358337,
                        0.7202451229095459,
                        0.7752636075019836,
                        0.11768101900815964,
                        0.899681568145752,
                        0.10779126733541489,
                        0.1391352415084839,
                        0.44826754927635193,
                        0.1127583459019661,
                        0.8834608793258667,
                        0.6066747903823853,
                        0.43224984407424927,
                        0.4351488947868347,
                        0.515751302242279,
                        0.47857117652893066,
                        0.3964906930923462
                    ]
                },
                "val": {
                    "score": -5.276284087224187,
                    "pretrain_loss": 0.915069043636322,
                    "pretrain_component": 0.6967579126358032,
                    "supervised_component": 0.457534521818161,
                    "features_accuracy": [
                        0.5705810785293579,
                        0.5870094299316406,
                        0.5201297998428345,
                        0.5553188920021057,
                        0.4276442527770996,
                        0.443971186876297,
                        0.5309805870056152,
                        0.4784504473209381,
                        0.6454720497131348,
                        0.570530354976654,
                        0.6125138998031616,
                        0.46050095558166504,
                        0.4468613564968109,
                        0.5386877655982971,
                        0.5852854251861572,
                        0.5418314337730408,
                        0.5244904160499573,
                        0.47419124841690063,
                        0.5721021890640259,
                        0.34621232748031616,
                        0.4693235754966736,
                        0.5481695532798767,
                        0.37420138716697693,
                        0.43793731927871704,
                        0.5742825269699097,
                        0.5154142379760742,
                        0.43661898374557495,
                        0.41816243529319763,
                        0.514146625995636,
                        0.11530270427465439,
                        0.1327451467514038,
                        0.8975762724876404,
                        0.8980326056480408,
                        0.26949599385261536,
                        0.11454213410615921,
                        0.14516782760620117,
                        0.7184362411499023,
                        0.7754284143447876,
                        0.11621539294719696,
                        0.9002129435539246,
                        0.10485751926898956,
                        0.14131426811218262,
                        0.4491937756538391,
                        0.11439001560211182,
                        0.8870803713798523,
                        0.6041476130485535,
                        0.43383023142814636,
                        0.43443867564201355,
                        0.5130818486213684,
                        0.47748705744743347,
                        0.3904269337654114
                    ]
                },
                "test": {
                    "score": -5.535632293729505,
                    "pretrain_loss": 0.9623774886131287,
                    "pretrain_component": 0.6968231797218323,
                    "supervised_component": 0.48118874430656433,
                    "features_accuracy": [
                        0.5724138021469116,
                        0.5948275923728943,
                        0.5149087309837341,
                        0.5502535700798035,
                        0.42540568113327026,
                        0.44878295063972473,
                        0.531693696975708,
                        0.4824543595314026,
                        0.6438133716583252,
                        0.5751014351844788,
                        0.6169371008872986,
                        0.4614097476005554,
                        0.45476675033569336,
                        0.5417850017547607,
                        0.5831136107444763,
                        0.5457910895347595,
                        0.5336207151412964,
                        0.4724138081073761,
                        0.5635902881622314,
                        0.3469066917896271,
                        0.4595334827899933,
                        0.5417850017547607,
                        0.3620689809322357,
                        0.4448275864124298,
                        0.570486843585968,
                        0.5199289917945862,
                        0.4363590180873871,
                        0.41790062189102173,
                        0.5103955268859863,
                        0.11242393404245377,
                        0.13164299726486206,
                        0.9002535343170166,
                        0.8954361081123352,
                        0.27287018299102783,
                        0.11582150310277939,
                        0.14827586710453033,
                        0.7233772873878479,
                        0.7797667384147644,
                        0.11541581898927689,
                        0.900050699710846,
                        0.10786004364490509,
                        0.13493914902210236,
                        0.4492393434047699,
                        0.11034482717514038,
                        0.886612594127655,
                        0.6163285970687866,
                        0.4275861978530884,
                        0.4320486783981323,
                        0.5077078938484192,
                        0.488590270280838,
                        0.38580122590065
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -4.211835089727726,
                    "pretrain_loss": 0.9345428943634033,
                    "pretrain_component": 0.6970906853675842,
                    "supervised_component": 0.46727144718170166,
                    "features_accuracy": [
                        0.5765234231948853,
                        0.5251462459564209,
                        0.5238330960273743,
                        0.558704137802124,
                        0.41777363419532776,
                        0.45882973074913025,
                        0.5497532486915588,
                        0.4856189489364624,
                        0.6448001265525818,
                        0.5708903074264526,
                        0.4719927906990051,
                        0.45203569531440735,
                        0.43875208497047424,
                        0.5347315073013306,
                        0.5911265015602112,
                        0.5386835932731628,
                        0.5345602035522461,
                        0.48953932523727417,
                        0.5548027753829956,
                        0.38701963424682617,
                        0.4634478986263275,
                        0.5400981903076172,
                        0.35773101449012756,
                        0.45247340202331543,
                        0.5576511025428772,
                        0.5100356340408325,
                        0.42864665389060974,
                        0.41902968287467957,
                        0.48646265268325806,
                        0.16726931929588318,
                        0.1923457533121109,
                        0.9393103122711182,
                        0.8910415172576904,
                        0.2875131666660309,
                        0.12578819692134857,
                        0.1319098174571991,
                        0.6826273202896118,
                        0.7472310066223145,
                        0.10546315461397171,
                        0.8963321447372437,
                        0.14023268222808838,
                        0.1488727331161499,
                        0.43659526109695435,
                        0.11141349375247955,
                        0.866263210773468,
                        0.6358873248100281,
                        0.43523135781288147,
                        0.44739848375320435,
                        0.5116406083106995,
                        0.5501211881637573,
                        0.39866024255752563
                    ]
                },
                "val": {
                    "score": -5.301337466710624,
                    "pretrain_loss": 0.8931057453155518,
                    "pretrain_component": 0.6970747709274292,
                    "supervised_component": 0.4465528726577759,
                    "features_accuracy": [
                        0.5708345770835876,
                        0.5194706320762634,
                        0.5336679816246033,
                        0.5564344525337219,
                        0.41172292828559875,
                        0.45918262004852295,
                        0.5496399998664856,
                        0.4882364869117737,
                        0.6423790454864502,
                        0.5715444684028625,
                        0.4730757474899292,
                        0.4525403082370758,
                        0.43306964635849,
                        0.5379271507263184,
                        0.5890883207321167,
                        0.5408173203468323,
                        0.529712975025177,
                        0.4950309097766876,
                        0.554304838180542,
                        0.39215087890625,
                        0.46820807456970215,
                        0.5385863184928894,
                        0.36760976910591125,
                        0.4509177505970001,
                        0.5586654543876648,
                        0.5118141770362854,
                        0.43403303623199463,
                        0.41811174154281616,
                        0.48478853702545166,
                        0.16514551639556885,
                        0.19004157185554504,
                        0.9422979354858398,
                        0.8939762711524963,
                        0.2842510938644409,
                        0.1248859092593193,
                        0.13127471506595612,
                        0.6835006475448608,
                        0.7488084435462952,
                        0.10602372884750366,
                        0.8957509398460388,
                        0.1395903080701828,
                        0.1502383053302765,
                        0.4349457323551178,
                        0.11449142545461655,
                        0.8693337440490723,
                        0.6295507550239563,
                        0.43677109479904175,
                        0.4480275809764862,
                        0.5118141770362854,
                        0.5472568273544312,
                        0.3966636061668396
                    ]
                },
                "test": {
                    "score": -5.558537819631589,
                    "pretrain_loss": 0.9513465762138367,
                    "pretrain_component": 0.6971818804740906,
                    "supervised_component": 0.47567328810691833,
                    "features_accuracy": [
                        0.5722616910934448,
                        0.5273326635360718,
                        0.5233772993087769,
                        0.5521805286407471,
                        0.4118154048919678,
                        0.46369168162345886,
                        0.5452332496643066,
                        0.4893001914024353,
                        0.6436612606048584,
                        0.5756592154502869,
                        0.4704868197441101,
                        0.4539046585559845,
                        0.4356490969657898,
                        0.5401115417480469,
                        0.5866125822067261,
                        0.5424949526786804,
                        0.5361054539680481,
                        0.49087220430374146,
                        0.5489351153373718,
                        0.389148086309433,
                        0.4596855938434601,
                        0.5400101542472839,
                        0.3542596399784088,
                        0.46135902404785156,
                        0.5557809472084045,
                        0.5149087309837341,
                        0.4312880337238312,
                        0.41678500175476074,
                        0.4844827651977539,
                        0.16597363352775574,
                        0.1878296136856079,
                        0.9433062672615051,
                        0.8912271857261658,
                        0.28722110390663147,
                        0.12545639276504517,
                        0.13438133895397186,
                        0.6844320297241211,
                        0.7538032531738281,
                        0.1063387393951416,
                        0.8966024518013,
                        0.1378803253173828,
                        0.14203853905200958,
                        0.43184584379196167,
                        0.11039553582668304,
                        0.8672921061515808,
                        0.6425963640213013,
                        0.42996957898139954,
                        0.44863083958625793,
                        0.5027890205383301,
                        0.556744396686554,
                        0.39001014828681946
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -4.122423648915334,
                    "pretrain_loss": 0.9217541217803955,
                    "pretrain_component": 0.696786642074585,
                    "supervised_component": 0.46087706089019775,
                    "features_accuracy": [
                        0.5770245790481567,
                        0.5370088815689087,
                        0.5364379286766052,
                        0.5641914010047913,
                        0.42161789536476135,
                        0.4615321159362793,
                        0.5469874143600464,
                        0.4890064597129822,
                        0.6446986198425293,
                        0.5748867988586426,
                        0.3419416844844818,
                        0.4669369161128998,
                        0.4345589280128479,
                        0.5327585935592651,
                        0.5900290608406067,
                        0.5385313034057617,
                        0.5327014923095703,
                        0.4694046080112457,
                        0.5623517036437988,
                        0.3767302334308624,
                        0.46886539459228516,
                        0.5436125993728638,
                        0.36131516098976135,
                        0.4520420432090759,
                        0.5573148727416992,
                        0.4871414303779602,
                        0.43096843361854553,
                        0.4205648601055145,
                        0.5255649089813232,
                        0.3462934195995331,
                        0.31727123260498047,
                        0.9306893348693848,
                        0.8765082359313965,
                        0.21900177001953125,
                        0.12200738489627838,
                        0.1673581302165985,
                        0.6604499220848083,
                        0.7715462446212769,
                        0.10832414031028748,
                        0.8944417238235474,
                        0.11843591183423996,
                        0.1611984521150589,
                        0.43799084424972534,
                        0.11107727885246277,
                        0.8192631602287292,
                        0.671094536781311,
                        0.4399954378604889,
                        0.44809627532958984,
                        0.49537548422813416,
                        0.5696088671684265,
                        0.4008234143257141
                    ]
                },
                "val": {
                    "score": -5.324186371410464,
                    "pretrain_loss": 0.8825132250785828,
                    "pretrain_component": 0.6967679262161255,
                    "supervised_component": 0.4412566125392914,
                    "features_accuracy": [
                        0.5709866881370544,
                        0.5319440364837646,
                        0.5425919890403748,
                        0.5616570115089417,
                        0.4194807708263397,
                        0.4599432051181793,
                        0.5495385527610779,
                        0.4885407090187073,
                        0.6421762108802795,
                        0.5688064098358154,
                        0.34418416023254395,
                        0.4681066572666168,
                        0.4310414791107178,
                        0.533262312412262,
                        0.5891390442848206,
                        0.5400567650794983,
                        0.5276848077774048,
                        0.4738363027572632,
                        0.5597809553146362,
                        0.3801845610141754,
                        0.47302502393722534,
                        0.5431497693061829,
                        0.36847174167633057,
                        0.4484332203865051,
                        0.5564344525337219,
                        0.49163368344306946,
                        0.4342358708381653,
                        0.41887232661247253,
                        0.5258594155311584,
                        0.3439813256263733,
                        0.3162965178489685,
                        0.9298245310783386,
                        0.8798295855522156,
                        0.21316295862197876,
                        0.12011966109275818,
                        0.1689990758895874,
                        0.6575905084609985,
                        0.773603081703186,
                        0.10820402950048447,
                        0.8940269351005554,
                        0.11449142545461655,
                        0.16002433001995087,
                        0.43778520822525024,
                        0.11439001560211182,
                        0.8232430815696716,
                        0.6664638519287109,
                        0.4410303235054016,
                        0.44812896847724915,
                        0.4912787675857544,
                        0.5662711262702942,
                        0.39762699604034424
                    ]
                },
                "test": {
                    "score": -5.602091769099448,
                    "pretrain_loss": 0.9429237842559814,
                    "pretrain_component": 0.6968725919723511,
                    "supervised_component": 0.4714618921279907,
                    "features_accuracy": [
                        0.5722616910934448,
                        0.5361054539680481,
                        0.5341784954071045,
                        0.5588235259056091,
                        0.41830629110336304,
                        0.4629817605018616,
                        0.5449796915054321,
                        0.4901115596294403,
                        0.6439655423164368,
                        0.5723123550415039,
                        0.3417849838733673,
                        0.4707910716533661,
                        0.43280932307243347,
                        0.5354462265968323,
                        0.5856997966766357,
                        0.5430020093917847,
                        0.5345335006713867,
                        0.4717545807361603,
                        0.5547160506248474,
                        0.3799188733100891,
                        0.46181541681289673,
                        0.5404158234596252,
                        0.35557809472084045,
                        0.45684584975242615,
                        0.5592799186706543,
                        0.4857504963874817,
                        0.4325050711631775,
                        0.4177992045879364,
                        0.5279918909072876,
                        0.3484787046909332,
                        0.31359025835990906,
                        0.9324036836624146,
                        0.8768255710601807,
                        0.21957403421401978,
                        0.12109533697366714,
                        0.16977687180042267,
                        0.6623225212097168,
                        0.7769269943237305,
                        0.10862068831920624,
                        0.8941683769226074,
                        0.11612576246261597,
                        0.15400607883930206,
                        0.43463489413261414,
                        0.11034482717514038,
                        0.8206896781921387,
                        0.6746450066566467,
                        0.43463489413261414,
                        0.4437626898288727,
                        0.4901115596294403,
                        0.5760142207145691,
                        0.39031440019607544
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -4.101096189884011,
                    "pretrain_loss": 0.9104608297348022,
                    "pretrain_component": 0.6973863840103149,
                    "supervised_component": 0.4552304148674011,
                    "features_accuracy": [
                        0.5746901035308838,
                        0.4625471234321594,
                        0.5184917449951172,
                        0.5591862201690674,
                        0.4182303845882416,
                        0.46002867817878723,
                        0.54909348487854,
                        0.47675687074661255,
                        0.6472487449645996,
                        0.5702242255210876,
                        0.25446274876594543,
                        0.47351527214050293,
                        0.43868231773376465,
                        0.5351818799972534,
                        0.5917418599128723,
                        0.5440122485160828,
                        0.5349852442741394,
                        0.47738489508628845,
                        0.5603534579277039,
                        0.4492952227592468,
                        0.4689795672893524,
                        0.520007848739624,
                        0.36154353618621826,
                        0.4830434322357178,
                        0.5400537848472595,
                        0.5105494856834412,
                        0.43205320835113525,
                        0.4194420278072357,
                        0.4947030544281006,
                        0.3375835716724396,
                        0.250497967004776,
                        0.9229246973991394,
                        0.8798259496688843,
                        0.19982491433620453,
                        0.12415788322687149,
                        0.13442189991474152,
                        0.6728580594062805,
                        0.7607873678207397,
                        0.11109631508588791,
                        0.896484375,
                        0.12865552306175232,
                        0.1420089155435562,
                        0.43242111802101135,
                        0.11128027737140656,
                        0.8475431203842163,
                        0.6463479995727539,
                        0.43421638011932373,
                        0.453475683927536,
                        0.4885624051094055,
                        0.6202438473701477,
                        0.4068625569343567
                    ]
                },
                "val": {
                    "score": -5.312287884658322,
                    "pretrain_loss": 0.8698258996009827,
                    "pretrain_component": 0.6973632574081421,
                    "supervised_component": 0.43491294980049133,
                    "features_accuracy": [
                        0.5714430212974548,
                        0.46278268098831177,
                        0.523222804069519,
                        0.5587161183357239,
                        0.41466382145881653,
                        0.4547713100910187,
                        0.5499442219734192,
                        0.4758138060569763,
                        0.6440523266792297,
                        0.5696176886558533,
                        0.25448736548423767,
                        0.4803265333175659,
                        0.43606123328208923,
                        0.5383328199386597,
                        0.5892404317855835,
                        0.5449751615524292,
                        0.5336679816246033,
                        0.48058006167411804,
                        0.5594260096549988,
                        0.454872727394104,
                        0.47185882925987244,
                        0.5185579657554626,
                        0.369587242603302,
                        0.4825575351715088,
                        0.5382820963859558,
                        0.5143494606018066,
                        0.4320048689842224,
                        0.4184666872024536,
                        0.49498021602630615,
                        0.337846040725708,
                        0.24865631759166718,
                        0.9231821894645691,
                        0.8833789229393005,
                        0.19546698033809662,
                        0.1253422498703003,
                        0.13350573182106018,
                        0.6724976897239685,
                        0.7606733441352844,
                        0.11104350537061691,
                        0.8980326056480408,
                        0.12407463043928146,
                        0.1442551463842392,
                        0.42931750416755676,
                        0.11449142545461655,
                        0.8497616648674011,
                        0.6413649320602417,
                        0.4359598159790039,
                        0.4557346999645233,
                        0.4869181513786316,
                        0.618547797203064,
                        0.4052327275276184
                    ]
                },
                "test": {
                    "score": -5.59626913418461,
                    "pretrain_loss": 0.935421884059906,
                    "pretrain_component": 0.697489857673645,
                    "supervised_component": 0.467710942029953,
                    "features_accuracy": [
                        0.5719066858291626,
                        0.46232250332832336,
                        0.519472599029541,
                        0.55390465259552,
                        0.4131338894367218,
                        0.4581643044948578,
                        0.5474137663841248,
                        0.4793103337287903,
                        0.6448783278465271,
                        0.5730730295181274,
                        0.25228193402290344,
                        0.47373226284980774,
                        0.43884381651878357,
                        0.5372717976570129,
                        0.5862576365470886,
                        0.5470080971717834,
                        0.536663293838501,
                        0.477180540561676,
                        0.5533468723297119,
                        0.454158216714859,
                        0.4634888470172882,
                        0.5218052864074707,
                        0.3561866283416748,
                        0.489705890417099,
                        0.5354462265968323,
                        0.5114604234695435,
                        0.42981743812561035,
                        0.4177992045879364,
                        0.4931034445762634,
                        0.3440162241458893,
                        0.24934077262878418,
                        0.9268762469291687,
                        0.8816937208175659,
                        0.20147058367729187,
                        0.12383367121219635,
                        0.137221097946167,
                        0.6737322807312012,
                        0.7657200694084167,
                        0.11166328936815262,
                        0.8985294103622437,
                        0.12626774609088898,
                        0.13828600943088531,
                        0.42677485942840576,
                        0.1105983778834343,
                        0.8480223417282104,
                        0.6520791053771973,
                        0.43093305826187134,
                        0.4502028524875641,
                        0.4891480803489685,
                        0.626724123954773,
                        0.3976166248321533
                    ]
                }
            }
        },
        "train": {
            "score": -3.9994176268022494
        },
        "val": {
            "score": -5.276284087224187
        },
        "test": {
            "score": -5.535632293729505
        }
    },
    "best_iteration": 10000,
    "time": "0:22:14"
}
