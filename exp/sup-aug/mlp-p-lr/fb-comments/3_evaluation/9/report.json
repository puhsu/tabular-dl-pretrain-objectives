{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised_fast___4f643edbe1e143c690241bc155a29af9.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0,1",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                },
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 9,
        "data": {
            "path": "data/fb-comments",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512
                ],
                "dropout": 0.44744397584213635
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "positional",
                "linear",
                "relu"
            ],
            "d_num_embedding": 80,
            "positional_encoding": {
                "n": 17,
                "sigma": 0.2786440030986657,
                "trainable": true,
                "initialization": "normal"
            },
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 512,
            "lr": 0.00015540039302508303,
            "weight_decay": 7.309044283047996e-06,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 1024
        },
        "pretrain": {
            "corrupt_probability": 0.4251617309148788,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.00015540039302508303,
            "weight_decay": 7.309044283047996e-06,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post",
            "supervised_weight": 1.0
        },
        "bins": null
    },
    "n_parameters": 2520166,
    "epoch_size": 308,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -3.814815521464338,
                    "pretrain_loss": 0.9668761491775513,
                    "pretrain_component": 0.697407603263855,
                    "supervised_component": 0.48343807458877563,
                    "features_accuracy": [
                        0.5342937707901001,
                        0.3041017949581146,
                        0.46661972999572754,
                        0.5469747185707092,
                        0.5747599005699158,
                        0.5761301517486572,
                        0.42779025435447693,
                        0.45521384477615356,
                        0.41499513387680054,
                        0.5501846075057983,
                        0.8802192807197571,
                        0.45213085412979126,
                        0.4521498680114746,
                        0.5576320290565491,
                        0.44474050402641296,
                        0.47476497292518616,
                        0.5700212121009827,
                        0.5628719329833984,
                        0.5626245141029358,
                        0.463752418756485,
                        0.4635747969150543,
                        0.4994734823703766,
                        0.5459597706794739,
                        0.6753384470939636,
                        0.57023686170578,
                        0.4019208550453186,
                        0.4664040505886078,
                        0.5119133591651917,
                        0.4262424111366272,
                        0.06721094995737076,
                        0.7197883725166321,
                        0.6709803342819214,
                        0.1071886271238327,
                        0.8068866729736328,
                        0.1462210863828659,
                        0.1055646538734436,
                        0.2678605616092682,
                        0.7436848878860474,
                        0.8951078057289124,
                        0.48788997530937195,
                        0.6699717044830322,
                        0.20378969609737396,
                        0.4323386549949646,
                        0.23623111844062805,
                        0.8508101105690002,
                        0.21930626034736633,
                        0.4882071614265442,
                        0.4152742326259613,
                        0.45449700951576233,
                        0.43950697779655457,
                        0.4308732748031616
                    ]
                },
                "val": {
                    "score": -5.27344031259248,
                    "pretrain_loss": 0.9226658344268799,
                    "pretrain_component": 0.6973584890365601,
                    "supervised_component": 0.46133291721343994,
                    "features_accuracy": [
                        0.5371665954589844,
                        0.3029104471206665,
                        0.4708954393863678,
                        0.544468104839325,
                        0.5729641914367676,
                        0.5756515264511108,
                        0.4315992295742035,
                        0.4554304778575897,
                        0.4141567647457123,
                        0.5529865026473999,
                        0.8830240368843079,
                        0.4533008635044098,
                        0.4478754699230194,
                        0.5559780597686768,
                        0.438697874546051,
                        0.474647581577301,
                        0.5716458559036255,
                        0.5643950700759888,
                        0.5633809566497803,
                        0.4703376889228821,
                        0.47023627161979675,
                        0.5013183355331421,
                        0.5406652092933655,
                        0.6764019727706909,
                        0.5687556862831116,
                        0.39935097098350525,
                        0.46998274326324463,
                        0.523222804069519,
                        0.42891186475753784,
                        0.06510495394468307,
                        0.7199574112892151,
                        0.6687455177307129,
                        0.10759557783603668,
                        0.8113274574279785,
                        0.146891787648201,
                        0.10845755785703659,
                        0.2664029896259308,
                        0.7403914332389832,
                        0.8975762724876404,
                        0.4912787675857544,
                        0.6650440692901611,
                        0.20373186469078064,
                        0.4324612021446228,
                        0.23598012328147888,
                        0.851891279220581,
                        0.22061656415462494,
                        0.4831152856349945,
                        0.4167934060096741,
                        0.45685020089149475,
                        0.4399147927761078,
                        0.4282526969909668
                    ]
                },
                "test": {
                    "score": -5.551632026284573,
                    "pretrain_loss": 0.9692327380180359,
                    "pretrain_component": 0.6974104642868042,
                    "supervised_component": 0.48461636900901794,
                    "features_accuracy": [
                        0.5363590121269226,
                        0.30182555317878723,
                        0.46744421124458313,
                        0.5490365028381348,
                        0.5759634971618652,
                        0.5746957659721375,
                        0.43610548973083496,
                        0.46110546588897705,
                        0.41982758045196533,
                        0.550000011920929,
                        0.8862069249153137,
                        0.45314401388168335,
                        0.4521298110485077,
                        0.5586714148521423,
                        0.4436105489730835,
                        0.4703346788883209,
                        0.5730223059654236,
                        0.5653144121170044,
                        0.5623732209205627,
                        0.467494934797287,
                        0.46688640117645264,
                        0.49472618103027344,
                        0.5485293865203857,
                        0.6722109317779541,
                        0.5687119960784912,
                        0.4008113741874695,
                        0.4700811505317688,
                        0.5109026432037354,
                        0.43321502208709717,
                        0.06359026581048965,
                        0.7245942950248718,
                        0.6720588207244873,
                        0.10628803074359894,
                        0.8093306422233582,
                        0.14629817008972168,
                        0.10573022067546844,
                        0.26293104887008667,
                        0.7479208707809448,
                        0.8945233225822449,
                        0.4843813478946686,
                        0.6754564046859741,
                        0.20557808876037598,
                        0.4272819459438324,
                        0.23488843441009521,
                        0.85502028465271,
                        0.2214502990245819,
                        0.4913285970687866,
                        0.41815415024757385,
                        0.44776877760887146,
                        0.4440162181854248,
                        0.4302738308906555
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -3.9027815948145497,
                    "pretrain_loss": 0.9145320653915405,
                    "pretrain_component": 0.6978777647018433,
                    "supervised_component": 0.45726603269577026,
                    "features_accuracy": [
                        0.5375924706459045,
                        0.3134460151195526,
                        0.48070263862609863,
                        0.548700213432312,
                        0.568244993686676,
                        0.5750009417533875,
                        0.43192631006240845,
                        0.4325416684150696,
                        0.42447254061698914,
                        0.5648130774497986,
                        0.7969461679458618,
                        0.4618873596191406,
                        0.4713394045829773,
                        0.5518149137496948,
                        0.48477524518966675,
                        0.4625280797481537,
                        0.5742080211639404,
                        0.5606072545051575,
                        0.5203567743301392,
                        0.42135146260261536,
                        0.46181759238243103,
                        0.5006787776947021,
                        0.5517261028289795,
                        0.6784849166870117,
                        0.5442723035812378,
                        0.39951661229133606,
                        0.45630496740341187,
                        0.5501084923744202,
                        0.42933177947998047,
                        0.03785889223217964,
                        0.7851470112800598,
                        0.35030895471572876,
                        0.10548218339681625,
                        0.7834786176681519,
                        0.16456691920757294,
                        0.12307946383953094,
                        0.2712417244911194,
                        0.7566449642181396,
                        0.894416332244873,
                        0.5212004780769348,
                        0.7918522357940674,
                        0.13419987261295319,
                        0.4286910593509674,
                        0.23911114037036896,
                        0.8553077578544617,
                        0.1943376660346985,
                        0.5002981424331665,
                        0.4114236533641815,
                        0.46614396572113037,
                        0.22872023284435272,
                        0.41807812452316284
                    ]
                },
                "val": {
                    "score": -5.298843711468693,
                    "pretrain_loss": 0.8974719047546387,
                    "pretrain_component": 0.6978543996810913,
                    "supervised_component": 0.44873595237731934,
                    "features_accuracy": [
                        0.5389412641525269,
                        0.3100091218948364,
                        0.4863604009151459,
                        0.5482709407806396,
                        0.568350076675415,
                        0.5752459168434143,
                        0.4395598769187927,
                        0.43124428391456604,
                        0.4195314645767212,
                        0.5652063488960266,
                        0.7970793843269348,
                        0.46323901414871216,
                        0.46547001600265503,
                        0.5484737753868103,
                        0.4848392605781555,
                        0.4614136517047882,
                        0.5760064721107483,
                        0.5584626197814941,
                        0.5151607394218445,
                        0.42698508501052856,
                        0.4643038213253021,
                        0.5008619427680969,
                        0.5483216643333435,
                        0.6791907548904419,
                        0.5425413250923157,
                        0.39554810523986816,
                        0.458117812871933,
                        0.5542033910751343,
                        0.42845553159713745,
                        0.0359496995806694,
                        0.7889665961265564,
                        0.35123211145401,
                        0.10374201089143753,
                        0.7839975357055664,
                        0.16671736538410187,
                        0.12437885999679565,
                        0.26746779680252075,
                        0.7548422813415527,
                        0.8965622186660767,
                        0.5228171348571777,
                        0.7875468730926514,
                        0.13462123274803162,
                        0.42992594838142395,
                        0.24039143323898315,
                        0.8565561175346375,
                        0.19582192599773407,
                        0.49350976943969727,
                        0.41314268112182617,
                        0.4714531898498535,
                        0.23400263488292694,
                        0.41755399107933044
                    ]
                },
                "test": {
                    "score": -5.572805814667496,
                    "pretrain_loss": 0.9447372555732727,
                    "pretrain_component": 0.697900116443634,
                    "supervised_component": 0.47236862778663635,
                    "features_accuracy": [
                        0.5388438105583191,
                        0.3116125762462616,
                        0.48250508308410645,
                        0.5473631024360657,
                        0.5712981820106506,
                        0.5741886496543884,
                        0.44148072600364685,
                        0.43351927399635315,
                        0.42667344212532043,
                        0.5620182752609253,
                        0.8033468723297119,
                        0.45948275923728943,
                        0.47013184428215027,
                        0.5540568232536316,
                        0.49426978826522827,
                        0.45709940791130066,
                        0.5757099390029907,
                        0.5628803372383118,
                        0.518306314945221,
                        0.4172920882701874,
                        0.46465516090393066,
                        0.49497970938682556,
                        0.5522312521934509,
                        0.6751013994216919,
                        0.5421399474143982,
                        0.39731237292289734,
                        0.4617139995098114,
                        0.5470588207244873,
                        0.4363590180873871,
                        0.03453346714377403,
                        0.7891988158226013,
                        0.3461967706680298,
                        0.10299188643693924,
                        0.785040557384491,
                        0.16526369750499725,
                        0.12079107761383057,
                        0.2650608420372009,
                        0.7626774907112122,
                        0.8928499221801758,
                        0.5158215165138245,
                        0.7910750508308411,
                        0.13828600943088531,
                        0.4228701889514923,
                        0.23630832135677338,
                        0.8592292070388794,
                        0.19655172526836395,
                        0.503853976726532,
                        0.41511157155036926,
                        0.46125760674476624,
                        0.2321501076221466,
                        0.4185091257095337
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -3.872752370226057,
                    "pretrain_loss": 0.9117401242256165,
                    "pretrain_component": 0.6976392269134521,
                    "supervised_component": 0.4558700621128082,
                    "features_accuracy": [
                        0.5371991395950317,
                        0.30677881836891174,
                        0.48679253458976746,
                        0.5484527945518494,
                        0.5566233992576599,
                        0.5758320093154907,
                        0.4252147376537323,
                        0.43457797169685364,
                        0.4383270740509033,
                        0.5556147694587708,
                        0.9091780185699463,
                        0.44756975769996643,
                        0.49315521121025085,
                        0.5529250502586365,
                        0.5090968012809753,
                        0.45359623432159424,
                        0.568505048751831,
                        0.5365140438079834,
                        0.5541810989379883,
                        0.3744148015975952,
                        0.45260027050971985,
                        0.5346617102622986,
                        0.4989723265171051,
                        0.671024739742279,
                        0.508272111415863,
                        0.40031591057777405,
                        0.4579923748970032,
                        0.5298659205436707,
                        0.42870375514030457,
                        0.05720701813697815,
                        0.7659384608268738,
                        0.7514051198959351,
                        0.10526015609502792,
                        0.8324134945869446,
                        0.1580139398574829,
                        0.10847638547420502,
                        0.3143467903137207,
                        0.7757076621055603,
                        0.894955575466156,
                        0.5245499014854431,
                        0.7442177534103394,
                        0.1413555145263672,
                        0.42416805028915405,
                        0.25651174783706665,
                        0.8453672528266907,
                        0.16136972606182098,
                        0.5051764249801636,
                        0.4177292287349701,
                        0.464551717042923,
                        0.2907167077064514,
                        0.4214402735233307
                    ]
                },
                "val": {
                    "score": -5.315414729757332,
                    "pretrain_loss": 0.8864455819129944,
                    "pretrain_component": 0.6975914835929871,
                    "supervised_component": 0.4432227909564972,
                    "features_accuracy": [
                        0.5379778742790222,
                        0.30559781193733215,
                        0.4918365180492401,
                        0.5439103245735168,
                        0.552885115146637,
                        0.5750938057899475,
                        0.43033158779144287,
                        0.4325118958950043,
                        0.4342358708381653,
                        0.5547611713409424,
                        0.9093905091285706,
                        0.4468613564968109,
                        0.48463642597198486,
                        0.5552682280540466,
                        0.5023323893547058,
                        0.4534022808074951,
                        0.5693134665489197,
                        0.5356961488723755,
                        0.5569921731948853,
                        0.37866342067718506,
                        0.45948684215545654,
                        0.5363045930862427,
                        0.4991379976272583,
                        0.6712300777435303,
                        0.5098873972892761,
                        0.39717066287994385,
                        0.4604502320289612,
                        0.5338708162307739,
                        0.4288104474544525,
                        0.054406244307756424,
                        0.7668086290359497,
                        0.7491126656532288,
                        0.10470540076494217,
                        0.8330798149108887,
                        0.16255956888198853,
                        0.11215900629758835,
                        0.3109218180179596,
                        0.7741608023643494,
                        0.8953452706336975,
                        0.5328059792518616,
                        0.7387181520462036,
                        0.14217624068260193,
                        0.4260216951370239,
                        0.25859445333480835,
                        0.8451475501060486,
                        0.1621539294719696,
                        0.49893519282341003,
                        0.42130613327026367,
                        0.466534823179245,
                        0.29439204931259155,
                        0.4200892150402069
                    ]
                },
                "test": {
                    "score": -5.570661650225696,
                    "pretrain_loss": 0.9275330305099487,
                    "pretrain_component": 0.6976346969604492,
                    "supervised_component": 0.46376651525497437,
                    "features_accuracy": [
                        0.5393002033233643,
                        0.3076064884662628,
                        0.4870689809322357,
                        0.5492393374443054,
                        0.5605983734130859,
                        0.5738843679428101,
                        0.4353955388069153,
                        0.440010130405426,
                        0.44173428416252136,
                        0.5500507354736328,
                        0.9133874177932739,
                        0.4446754455566406,
                        0.49198782444000244,
                        0.5587221384048462,
                        0.5123732089996338,
                        0.44999998807907104,
                        0.5730223059654236,
                        0.5375760793685913,
                        0.5550709962844849,
                        0.3684076964855194,
                        0.45562881231307983,
                        0.5297160148620605,
                        0.5021805167198181,
                        0.670030415058136,
                        0.5046653151512146,
                        0.3969573974609375,
                        0.46384382247924805,
                        0.5290060639381409,
                        0.4343813359737396,
                        0.05420892685651779,
                        0.7681034803390503,
                        0.7497464418411255,
                        0.10380324721336365,
                        0.8332657217979431,
                        0.15872211754322052,
                        0.10851927101612091,
                        0.3068965673446655,
                        0.7828600406646729,
                        0.8927991986274719,
                        0.518306314945221,
                        0.7447261810302734,
                        0.148174449801445,
                        0.42185598611831665,
                        0.2562880218029022,
                        0.8474137783050537,
                        0.16293103992938995,
                        0.5045638680458069,
                        0.42074036598205566,
                        0.457200825214386,
                        0.28945234417915344,
                        0.4219067096710205
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -3.726870241933794,
                    "pretrain_loss": 0.9020963907241821,
                    "pretrain_component": 0.697928786277771,
                    "supervised_component": 0.45104819536209106,
                    "features_accuracy": [
                        0.5339195132255554,
                        0.31662416458129883,
                        0.48049962520599365,
                        0.550635039806366,
                        0.5458835959434509,
                        0.5739288926124573,
                        0.4236986041069031,
                        0.43977341055870056,
                        0.43682995438575745,
                        0.5566551089286804,
                        0.9209074378013611,
                        0.4592991769313812,
                        0.5098960995674133,
                        0.5548471808433533,
                        0.4985726773738861,
                        0.45717403292655945,
                        0.5730153918266296,
                        0.5277153849601746,
                        0.5628021359443665,
                        0.37164896726608276,
                        0.471891313791275,
                        0.46356210112571716,
                        0.5368502736091614,
                        0.662226140499115,
                        0.5011038184165955,
                        0.39700454473495483,
                        0.4563366770744324,
                        0.5341288447380066,
                        0.4319072961807251,
                        0.03763686493039131,
                        0.728935956954956,
                        0.6180489659309387,
                        0.10442914068698883,
                        0.8365368843078613,
                        0.1538778692483902,
                        0.11332927644252777,
                        0.325708270072937,
                        0.811111569404602,
                        0.8801113963127136,
                        0.5321369171142578,
                        0.713451087474823,
                        0.1314784586429596,
                        0.4303150475025177,
                        0.2542407214641571,
                        0.8528527617454529,
                        0.1848221868276596,
                        0.5016239881515503,
                        0.4167967140674591,
                        0.4662708342075348,
                        0.1853487193584442,
                        0.42626145482063293
                    ]
                },
                "val": {
                    "score": -5.300069815796955,
                    "pretrain_loss": 0.8751804232597351,
                    "pretrain_component": 0.6979158520698547,
                    "supervised_component": 0.43759021162986755,
                    "features_accuracy": [
                        0.5337693691253662,
                        0.31548523902893066,
                        0.48392656445503235,
                        0.5455836057662964,
                        0.5462934374809265,
                        0.575499415397644,
                        0.4300273656845093,
                        0.44184157252311707,
                        0.4311428666114807,
                        0.5546597838401794,
                        0.9234864115715027,
                        0.4643545150756836,
                        0.5063380599021912,
                        0.5556738376617432,
                        0.49716052412986755,
                        0.457357257604599,
                        0.5710881352424622,
                        0.5221073031425476,
                        0.5642936825752258,
                        0.37197038531303406,
                        0.4763208329677582,
                        0.46557143330574036,
                        0.5354426503181458,
                        0.6622046232223511,
                        0.5020788908004761,
                        0.3956495225429535,
                        0.4574586749076843,
                        0.5393469333648682,
                        0.4337795376777649,
                        0.03569617494940758,
                        0.7323293685913086,
                        0.6136801242828369,
                        0.10516174882650375,
                        0.8386573195457458,
                        0.15586653351783752,
                        0.11555622518062592,
                        0.3234458863735199,
                        0.8105161786079407,
                        0.8811986446380615,
                        0.5448737144470215,
                        0.7078389525413513,
                        0.12929722666740417,
                        0.43109217286109924,
                        0.2546902000904083,
                        0.8550349473953247,
                        0.18578237295150757,
                        0.49457457661628723,
                        0.4161342680454254,
                        0.470743328332901,
                        0.19059932231903076,
                        0.4246019423007965
                    ]
                },
                "test": {
                    "score": -5.520892716353651,
                    "pretrain_loss": 0.9277171492576599,
                    "pretrain_component": 0.6979489326477051,
                    "supervised_component": 0.46385857462882996,
                    "features_accuracy": [
                        0.5359026193618774,
                        0.3143509030342102,
                        0.4748478829860687,
                        0.5461967587471008,
                        0.5519269704818726,
                        0.5741379261016846,
                        0.43336713314056396,
                        0.4436105489730835,
                        0.44051724672317505,
                        0.5540568232536316,
                        0.9245943427085876,
                        0.4576064944267273,
                        0.5069472789764404,
                        0.5603955388069153,
                        0.499695748090744,
                        0.4529411792755127,
                        0.573326587677002,
                        0.5280426144599915,
                        0.5637423992156982,
                        0.36572009325027466,
                        0.47332656383514404,
                        0.4620182514190674,
                        0.5409229397773743,
                        0.6598884463310242,
                        0.5070486664772034,
                        0.398022323846817,
                        0.4609026312828064,
                        0.5358012318611145,
                        0.4333164393901825,
                        0.034077078104019165,
                        0.7324543595314026,
                        0.6212981939315796,
                        0.10425963252782822,
                        0.8412778973579407,
                        0.15223123133182526,
                        0.11135903000831604,
                        0.31947261095046997,
                        0.8144016265869141,
                        0.8798174262046814,
                        0.5262170433998108,
                        0.7164300084114075,
                        0.13549695909023285,
                        0.42611563205718994,
                        0.25486814975738525,
                        0.8552738428115845,
                        0.18488843739032745,
                        0.49802231788635254,
                        0.4177992045879364,
                        0.4610547721385956,
                        0.18240365386009216,
                        0.42484787106513977
                    ]
                }
            }
        },
        "train": {
            "score": -3.814815521464338
        },
        "val": {
            "score": -5.27344031259248
        },
        "test": {
            "score": -5.551632026284573
        }
    },
    "best_iteration": 10000,
    "time": "0:26:34"
}
