{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised___d14c02fdb00e4c8987338bfb75cda94f.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 14,
        "data": {
            "path": "data/churn_roc",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512,
                    512
                ],
                "dropout": 0.0
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [],
            "d_num_embedding": null,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.00024290782239574845,
            "weight_decay": 7.789819508316286e-06,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.5679555272162643,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.00024290782239574845,
            "weight_decay": 7.789819508316286e-06,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post",
            "supervised_weight": 1
        },
        "bins": null
    },
    "epoch_size": 50,
    "n_parameters": 538636,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": 0.8974227049243483,
                    "pretrain_loss": 0.9426791667938232,
                    "pretrain_component": 0.6958865523338318,
                    "supervised_component": 0.4713395833969116,
                    "features_accuracy": [
                        0.4542187452316284,
                        0.559374988079071,
                        0.5439062118530273,
                        0.49296873807907104,
                        0.5,
                        0.5392187237739563,
                        0.4560937285423279,
                        0.3257812559604645,
                        0.706250011920929,
                        0.43062499165534973,
                        0.35609373450279236
                    ]
                },
                "val": {
                    "score": 0.8666655430459111,
                    "pretrain_loss": 0.9416807293891907,
                    "pretrain_component": 0.6956761479377747,
                    "supervised_component": 0.47084036469459534,
                    "features_accuracy": [
                        0.46937498450279236,
                        0.5462499856948853,
                        0.5381249785423279,
                        0.49812498688697815,
                        0.512499988079071,
                        0.5587499737739563,
                        0.4468749761581421,
                        0.3387500047683716,
                        0.6856249570846558,
                        0.4325000047683716,
                        0.3581250011920929
                    ]
                },
                "test": {
                    "score": 0.8548409734850413,
                    "pretrain_loss": 0.9332530498504639,
                    "pretrain_component": 0.6959615349769592,
                    "supervised_component": 0.46662652492523193,
                    "features_accuracy": [
                        0.45350003242492676,
                        0.5590000152587891,
                        0.5555000305175781,
                        0.4855000376701355,
                        0.515500009059906,
                        0.5115000009536743,
                        0.4360000193119049,
                        0.3100000023841858,
                        0.687000036239624,
                        0.4360000193119049,
                        0.3530000150203705
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": 0.8927648955995802,
                    "pretrain_loss": 0.9502938389778137,
                    "pretrain_component": 0.696949303150177,
                    "supervised_component": 0.47514691948890686,
                    "features_accuracy": [
                        0.42265623807907104,
                        0.43437498807907104,
                        0.5467187166213989,
                        0.4896875023841858,
                        0.49796873331069946,
                        0.6190624833106995,
                        0.47312498092651367,
                        0.3245312571525574,
                        0.71546870470047,
                        0.4387499988079071,
                        0.35749998688697815
                    ]
                },
                "val": {
                    "score": 0.8669761439261877,
                    "pretrain_loss": 0.9371932744979858,
                    "pretrain_component": 0.6964473128318787,
                    "supervised_component": 0.4685966372489929,
                    "features_accuracy": [
                        0.4468749761581421,
                        0.42499998211860657,
                        0.543749988079071,
                        0.49812498688697815,
                        0.512499988079071,
                        0.6306250095367432,
                        0.4749999940395355,
                        0.3331249952316284,
                        0.7024999856948853,
                        0.43062499165534973,
                        0.3568750023841858
                    ]
                },
                "test": {
                    "score": 0.856346330922602,
                    "pretrain_loss": 0.9326314330101013,
                    "pretrain_component": 0.6965963840484619,
                    "supervised_component": 0.46631571650505066,
                    "features_accuracy": [
                        0.4415000081062317,
                        0.4130000174045563,
                        0.5534999966621399,
                        0.4880000352859497,
                        0.515500009059906,
                        0.6130000352859497,
                        0.46650001406669617,
                        0.31800001859664917,
                        0.7005000114440918,
                        0.44450002908706665,
                        0.3530000150203705
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": 0.8938149793895849,
                    "pretrain_loss": 0.9453579783439636,
                    "pretrain_component": 0.6957368850708008,
                    "supervised_component": 0.4726789891719818,
                    "features_accuracy": [
                        0.42906248569488525,
                        0.410468727350235,
                        0.5424999594688416,
                        0.49265623092651367,
                        0.507031261920929,
                        0.6846874952316284,
                        0.5295312404632568,
                        0.32078123092651367,
                        0.7123437523841858,
                        0.44624999165534973,
                        0.37171873450279236
                    ]
                },
                "val": {
                    "score": 0.8671928422147528,
                    "pretrain_loss": 0.9418487548828125,
                    "pretrain_component": 0.6953227519989014,
                    "supervised_component": 0.47092437744140625,
                    "features_accuracy": [
                        0.4493750035762787,
                        0.3968749940395355,
                        0.5418750047683716,
                        0.4975000023841858,
                        0.512499988079071,
                        0.6856249570846558,
                        0.5206249952316284,
                        0.3387500047683716,
                        0.7018749713897705,
                        0.4325000047683716,
                        0.37187498807907104
                    ]
                },
                "test": {
                    "score": 0.8551833806071094,
                    "pretrain_loss": 0.9342512488365173,
                    "pretrain_component": 0.695505678653717,
                    "supervised_component": 0.46712562441825867,
                    "features_accuracy": [
                        0.4375000298023224,
                        0.4010000228881836,
                        0.5545000433921814,
                        0.48850002884864807,
                        0.515500009059906,
                        0.6875000596046448,
                        0.5355000495910645,
                        0.31850001215934753,
                        0.6970000267028809,
                        0.44600000977516174,
                        0.36550000309944153
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": 0.8953341246833797,
                    "pretrain_loss": 0.9453254342079163,
                    "pretrain_component": 0.6949049830436707,
                    "supervised_component": 0.47266271710395813,
                    "features_accuracy": [
                        0.4424999952316284,
                        0.42765623331069946,
                        0.5467187166213989,
                        0.48390623927116394,
                        0.4884375035762787,
                        0.6860937476158142,
                        0.532031238079071,
                        0.3709374964237213,
                        0.7020312547683716,
                        0.43796873092651367,
                        0.40828123688697815
                    ]
                },
                "val": {
                    "score": 0.8664705145862027,
                    "pretrain_loss": 0.9388778209686279,
                    "pretrain_component": 0.6943795680999756,
                    "supervised_component": 0.46943891048431396,
                    "features_accuracy": [
                        0.4543749988079071,
                        0.4181250035762787,
                        0.5424999594688416,
                        0.4987500011920929,
                        0.512499988079071,
                        0.6781249642372131,
                        0.5206249952316284,
                        0.3725000023841858,
                        0.7006250023841858,
                        0.43687498569488525,
                        0.414374977350235
                    ]
                },
                "test": {
                    "score": 0.854842515859465,
                    "pretrain_loss": 0.9287776350975037,
                    "pretrain_component": 0.6942996978759766,
                    "supervised_component": 0.46438881754875183,
                    "features_accuracy": [
                        0.43800002336502075,
                        0.4310000240802765,
                        0.5490000247955322,
                        0.48850002884864807,
                        0.515500009059906,
                        0.690500020980835,
                        0.5405000448226929,
                        0.3660000264644623,
                        0.6895000338554382,
                        0.4440000355243683,
                        0.42100003361701965
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": 0.8965915766967476,
                    "pretrain_loss": 0.9472904801368713,
                    "pretrain_component": 0.6938642263412476,
                    "supervised_component": 0.47364524006843567,
                    "features_accuracy": [
                        0.4334374964237213,
                        0.535937488079071,
                        0.5576562285423279,
                        0.4909375011920929,
                        0.504687488079071,
                        0.6729687452316284,
                        0.5054687261581421,
                        0.3728124797344208,
                        0.7082812190055847,
                        0.44609373807907104,
                        0.3814062476158142
                    ]
                },
                "val": {
                    "score": 0.8666751740809584,
                    "pretrain_loss": 0.9373612999916077,
                    "pretrain_component": 0.6939283609390259,
                    "supervised_component": 0.46868064999580383,
                    "features_accuracy": [
                        0.45124998688697815,
                        0.5149999856948853,
                        0.5424999594688416,
                        0.4975000023841858,
                        0.512499988079071,
                        0.6674999594688416,
                        0.5118749737739563,
                        0.37312498688697815,
                        0.7049999833106995,
                        0.43812498450279236,
                        0.3806249797344208
                    ]
                },
                "test": {
                    "score": 0.8555674318386184,
                    "pretrain_loss": 0.9286236763000488,
                    "pretrain_component": 0.6936899423599243,
                    "supervised_component": 0.4643118381500244,
                    "features_accuracy": [
                        0.43800002336502075,
                        0.5370000004768372,
                        0.549500048160553,
                        0.4880000352859497,
                        0.5135000348091125,
                        0.6795000433921814,
                        0.5135000348091125,
                        0.367000013589859,
                        0.7010000348091125,
                        0.44850000739097595,
                        0.38750001788139343
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": 0.89817678487157,
                    "pretrain_loss": 0.9306136965751648,
                    "pretrain_component": 0.6926267147064209,
                    "supervised_component": 0.4653068482875824,
                    "features_accuracy": [
                        0.4348437488079071,
                        0.6631249785423279,
                        0.5448437333106995,
                        0.4821874797344208,
                        0.5118749737739563,
                        0.6889062523841858,
                        0.5271874666213989,
                        0.3540624976158142,
                        0.7210937142372131,
                        0.43687498569488525,
                        0.38218748569488525
                    ]
                },
                "val": {
                    "score": 0.8678092284577823,
                    "pretrain_loss": 0.938765823841095,
                    "pretrain_component": 0.6929212212562561,
                    "supervised_component": 0.4693829119205475,
                    "features_accuracy": [
                        0.45749998092651367,
                        0.6443749666213989,
                        0.5431249737739563,
                        0.49812498688697815,
                        0.5118749737739563,
                        0.6812499761581421,
                        0.5256249904632568,
                        0.37187498807907104,
                        0.7043749690055847,
                        0.4350000023841858,
                        0.3725000023841858
                    ]
                },
                "test": {
                    "score": 0.8552635840771435,
                    "pretrain_loss": 0.9288542866706848,
                    "pretrain_component": 0.6926614046096802,
                    "supervised_component": 0.4644271433353424,
                    "features_accuracy": [
                        0.4415000081062317,
                        0.6390000581741333,
                        0.5509999990463257,
                        0.4880000352859497,
                        0.5120000243186951,
                        0.6865000128746033,
                        0.527999997138977,
                        0.3615000247955322,
                        0.7020000219345093,
                        0.4440000355243683,
                        0.3790000081062317
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": 0.8988655543623774,
                    "pretrain_loss": 0.9534985423088074,
                    "pretrain_component": 0.6923548579216003,
                    "supervised_component": 0.4767492711544037,
                    "features_accuracy": [
                        0.4467187523841858,
                        0.6693750023841858,
                        0.5435937643051147,
                        0.4860937297344208,
                        0.5079687237739563,
                        0.6881250143051147,
                        0.5303124785423279,
                        0.35593748092651367,
                        0.7098437547683716,
                        0.43437498807907104,
                        0.3553124964237213
                    ]
                },
                "val": {
                    "score": 0.867190434455991,
                    "pretrain_loss": 0.9334932565689087,
                    "pretrain_component": 0.6923782229423523,
                    "supervised_component": 0.46674662828445435,
                    "features_accuracy": [
                        0.46437498927116394,
                        0.6668750047683716,
                        0.543749988079071,
                        0.49812498688697815,
                        0.512499988079071,
                        0.6787499785423279,
                        0.5137500166893005,
                        0.35374999046325684,
                        0.7043749690055847,
                        0.43187499046325684,
                        0.3606249988079071
                    ]
                },
                "test": {
                    "score": 0.8562599579548733,
                    "pretrain_loss": 0.9307807683944702,
                    "pretrain_component": 0.692002534866333,
                    "supervised_component": 0.4653903841972351,
                    "features_accuracy": [
                        0.4455000162124634,
                        0.6575000286102295,
                        0.5545000433921814,
                        0.4880000352859497,
                        0.5135000348091125,
                        0.6875000596046448,
                        0.5360000133514404,
                        0.3475000262260437,
                        0.70250004529953,
                        0.445000022649765,
                        0.35600000619888306
                    ]
                }
            },
            "80000": {
                "train": {
                    "score": 0.8996537943870327,
                    "pretrain_loss": 0.9392210841178894,
                    "pretrain_component": 0.6911313533782959,
                    "supervised_component": 0.4696105420589447,
                    "features_accuracy": [
                        0.46875,
                        0.6499999761581421,
                        0.5495312213897705,
                        0.4910937249660492,
                        0.5057812333106995,
                        0.6812499761581421,
                        0.510937511920929,
                        0.4398437440395355,
                        0.7107812166213989,
                        0.4451562464237213,
                        0.36656248569488525
                    ]
                },
                "val": {
                    "score": 0.8672289585961802,
                    "pretrain_loss": 0.9338648915290833,
                    "pretrain_component": 0.69132000207901,
                    "supervised_component": 0.4669324457645416,
                    "features_accuracy": [
                        0.46562498807907104,
                        0.6462500095367432,
                        0.5412499904632568,
                        0.49812498688697815,
                        0.5131250023841858,
                        0.6818749904632568,
                        0.5218749642372131,
                        0.4312499761581421,
                        0.7043749690055847,
                        0.43687498569488525,
                        0.3725000023841858
                    ]
                },
                "test": {
                    "score": 0.8563956869041616,
                    "pretrain_loss": 0.9288183450698853,
                    "pretrain_component": 0.6909303069114685,
                    "supervised_component": 0.4644091725349426,
                    "features_accuracy": [
                        0.4520000219345093,
                        0.6370000243186951,
                        0.5545000433921814,
                        0.4880000352859497,
                        0.5145000219345093,
                        0.6930000185966492,
                        0.5270000100135803,
                        0.445000022649765,
                        0.7015000581741333,
                        0.45000001788139343,
                        0.367000013589859
                    ]
                }
            },
            "90000": {
                "train": {
                    "score": 0.9014576571544144,
                    "pretrain_loss": 0.9333248734474182,
                    "pretrain_component": 0.691363513469696,
                    "supervised_component": 0.4666624367237091,
                    "features_accuracy": [
                        0.47343748807907104,
                        0.6498437523841858,
                        0.5523437261581421,
                        0.4832812249660492,
                        0.5103124976158142,
                        0.6817187070846558,
                        0.5190624594688416,
                        0.4151562452316284,
                        0.7164062261581421,
                        0.4515624940395355,
                        0.36906248331069946
                    ]
                },
                "val": {
                    "score": 0.867325268946654,
                    "pretrain_loss": 0.9387280344963074,
                    "pretrain_component": 0.6916486620903015,
                    "supervised_component": 0.4693640172481537,
                    "features_accuracy": [
                        0.47062498331069946,
                        0.6499999761581421,
                        0.5399999618530273,
                        0.49812498688697815,
                        0.512499988079071,
                        0.6781249642372131,
                        0.5062499642372131,
                        0.40312498807907104,
                        0.703125,
                        0.4293749928474426,
                        0.37812498211860657
                    ]
                },
                "test": {
                    "score": 0.855083126269567,
                    "pretrain_loss": 0.9307662844657898,
                    "pretrain_component": 0.6913431286811829,
                    "supervised_component": 0.4653831422328949,
                    "features_accuracy": [
                        0.453000009059906,
                        0.6410000324249268,
                        0.5560000538825989,
                        0.4880000352859497,
                        0.51500004529953,
                        0.6860000491142273,
                        0.5160000324249268,
                        0.4190000295639038,
                        0.7015000581741333,
                        0.4465000331401825,
                        0.37300002574920654
                    ]
                }
            }
        },
        "train": {
            "score": 0.89817678487157
        },
        "val": {
            "score": 0.8678092284577823
        },
        "test": {
            "score": 0.8552635840771435
        }
    },
    "best_iteration": 60000,
    "time": "0:06:57"
}
