{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised___f17f0e40a43842578b44aea5260693d5.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 4,
        "data": {
            "path": "data/california",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512,
                    512,
                    512,
                    512,
                    512
                ],
                "dropout": 0.0
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [],
            "d_num_embedding": null,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.00024334851648075064,
            "weight_decay": 0.0,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.5282480384965015,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.00024334851648075064,
            "weight_decay": 0.0,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post",
            "supervised_weight": 1
        },
        "bins": null
    },
    "epoch_size": 104,
    "n_parameters": 1322505,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -0.3710355820862644,
                    "pretrain_loss": 1.4844129085540771,
                    "pretrain_component": 0.6931973695755005,
                    "supervised_component": 0.7422064542770386,
                    "features_accuracy": [
                        0.47058823704719543,
                        0.5105609893798828,
                        0.5263078212738037,
                        0.520327091217041,
                        0.5273677110671997,
                        0.5282005071640015,
                        0.46354758739471436,
                        0.4772503674030304
                    ]
                },
                "val": {
                    "score": -0.48212340372741186,
                    "pretrain_loss": 1.4906549453735352,
                    "pretrain_component": 0.6930751800537109,
                    "supervised_component": 0.7453274726867676,
                    "features_accuracy": [
                        0.48138055205345154,
                        0.5134726166725159,
                        0.5416288375854492,
                        0.5234634876251221,
                        0.5131698250770569,
                        0.5225552320480347,
                        0.47017863392829895,
                        0.47108688950538635
                    ]
                },
                "test": {
                    "score": -0.4740371575233572,
                    "pretrain_loss": 1.4977548122406006,
                    "pretrain_component": 0.6931527853012085,
                    "supervised_component": 0.7488774061203003,
                    "features_accuracy": [
                        0.47311046719551086,
                        0.5169573426246643,
                        0.5334302186965942,
                        0.5215600728988647,
                        0.5232558250427246,
                        0.5213178396224976,
                        0.4779554307460785,
                        0.46826550364494324
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -0.3582437313006808,
                    "pretrain_loss": 1.4741853475570679,
                    "pretrain_component": 0.6932186484336853,
                    "supervised_component": 0.7370926737785339,
                    "features_accuracy": [
                        0.4696797728538513,
                        0.5061700344085693,
                        0.5272163152694702,
                        0.522749662399292,
                        0.5164660811424255,
                        0.526232123374939,
                        0.49950793385505676,
                        0.47891589999198914
                    ]
                },
                "val": {
                    "score": -0.46122662247126234,
                    "pretrain_loss": 1.4677382707595825,
                    "pretrain_component": 0.693074643611908,
                    "supervised_component": 0.7338691353797913,
                    "features_accuracy": [
                        0.48168331384658813,
                        0.5134726166725159,
                        0.5416288375854492,
                        0.5349681973457336,
                        0.5165001749992371,
                        0.5264910459518433,
                        0.5007568597793579,
                        0.47108688950538635
                    ]
                },
                "test": {
                    "score": -0.4617390823377586,
                    "pretrain_loss": 1.4707043170928955,
                    "pretrain_component": 0.6931737065315247,
                    "supervised_component": 0.7353521585464478,
                    "features_accuracy": [
                        0.47311046719551086,
                        0.5169573426246643,
                        0.5334302186965942,
                        0.5242248177528381,
                        0.5232558250427246,
                        0.5247092843055725,
                        0.48764535784721375,
                        0.46826550364494324
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -0.3482893007184238,
                    "pretrain_loss": 1.4238696098327637,
                    "pretrain_component": 0.6932582855224609,
                    "supervised_component": 0.7119348049163818,
                    "features_accuracy": [
                        0.47043684124946594,
                        0.5082141160964966,
                        0.5305473804473877,
                        0.5135135054588318,
                        0.5127564668655396,
                        0.525702178478241,
                        0.49625256657600403,
                        0.47808313369750977
                    ]
                },
                "val": {
                    "score": -0.457442968972126,
                    "pretrain_loss": 1.4578773975372314,
                    "pretrain_component": 0.6931817531585693,
                    "supervised_component": 0.7289386987686157,
                    "features_accuracy": [
                        0.48168331384658813,
                        0.5134726166725159,
                        0.5416288375854492,
                        0.5228580236434937,
                        0.5095368027687073,
                        0.5249772667884827,
                        0.5034816861152649,
                        0.47108688950538635
                    ]
                },
                "test": {
                    "score": -0.4547117391884799,
                    "pretrain_loss": 1.4363771677017212,
                    "pretrain_component": 0.6932557821273804,
                    "supervised_component": 0.7181885838508606,
                    "features_accuracy": [
                        0.47311046719551086,
                        0.5169573426246643,
                        0.5334302186965942,
                        0.523982584476471,
                        0.5138081312179565,
                        0.5242248177528381,
                        0.4905523359775543,
                        0.46826550364494324
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -0.3449971829477355,
                    "pretrain_loss": 1.407060980796814,
                    "pretrain_component": 0.6932379007339478,
                    "supervised_component": 0.703530490398407,
                    "features_accuracy": [
                        0.4661216139793396,
                        0.515557587146759,
                        0.5297903418540955,
                        0.511847972869873,
                        0.5156332850456238,
                        0.5237338542938232,
                        0.5037474632263184,
                        0.4685441851615906
                    ]
                },
                "val": {
                    "score": -0.456351092744369,
                    "pretrain_loss": 1.4424407482147217,
                    "pretrain_component": 0.6931530237197876,
                    "supervised_component": 0.7212203741073608,
                    "features_accuracy": [
                        0.48168331384658813,
                        0.5134726166725159,
                        0.5416288375854492,
                        0.5225552320480347,
                        0.5116560459136963,
                        0.526188313961029,
                        0.5025734305381775,
                        0.46775656938552856
                    ]
                },
                "test": {
                    "score": -0.4491511137718212,
                    "pretrain_loss": 1.4365301132202148,
                    "pretrain_component": 0.6932095885276794,
                    "supervised_component": 0.7182650566101074,
                    "features_accuracy": [
                        0.47311046719551086,
                        0.5169573426246643,
                        0.5334302186965942,
                        0.5288274884223938,
                        0.518410861492157,
                        0.5242248177528381,
                        0.48473837971687317,
                        0.46414729952812195
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": -0.341404161165186,
                    "pretrain_loss": 1.430532455444336,
                    "pretrain_component": 0.6932777762413025,
                    "supervised_component": 0.715266227722168,
                    "features_accuracy": [
                        0.4696040749549866,
                        0.5191915035247803,
                        0.529411792755127,
                        0.5214626789093018,
                        0.5106366872787476,
                        0.527292013168335,
                        0.5048073530197144,
                        0.4715724289417267
                    ]
                },
                "val": {
                    "score": -0.45227336529248463,
                    "pretrain_loss": 1.4360764026641846,
                    "pretrain_component": 0.6932130455970764,
                    "supervised_component": 0.7180382013320923,
                    "features_accuracy": [
                        0.48168331384658813,
                        0.5137753486633301,
                        0.5416288375854492,
                        0.5343626737594604,
                        0.5116560459136963,
                        0.526188313961029,
                        0.5174084305763245,
                        0.46775656938552856
                    ]
                },
                "test": {
                    "score": -0.44550046273589694,
                    "pretrain_loss": 1.42369544506073,
                    "pretrain_component": 0.6932576298713684,
                    "supervised_component": 0.711847722530365,
                    "features_accuracy": [
                        0.47311046719551086,
                        0.5167151093482971,
                        0.5334302186965942,
                        0.5251938104629517,
                        0.5191376209259033,
                        0.5242248177528381,
                        0.5021802186965942,
                        0.4660852551460266
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": -0.33308355278183266,
                    "pretrain_loss": 1.3674124479293823,
                    "pretrain_component": 0.6931701898574829,
                    "supervised_component": 0.6837062239646912,
                    "features_accuracy": [
                        0.4742978513240814,
                        0.5281248092651367,
                        0.5303959846496582,
                        0.5275948643684387,
                        0.5061700344085693,
                        0.5239609479904175,
                        0.5219168663024902,
                        0.4739193022251129
                    ]
                },
                "val": {
                    "score": -0.4435883152443273,
                    "pretrain_loss": 1.4212076663970947,
                    "pretrain_component": 0.693247377872467,
                    "supervised_component": 0.7106038331985474,
                    "features_accuracy": [
                        0.48168331384658813,
                        0.5134726166725159,
                        0.5416288375854492,
                        0.5255827903747559,
                        0.5089312791824341,
                        0.5270965695381165,
                        0.5280048251152039,
                        0.46715107560157776
                    ]
                },
                "test": {
                    "score": -0.44529882462213083,
                    "pretrain_loss": 1.422193169593811,
                    "pretrain_component": 0.6932211518287659,
                    "supervised_component": 0.7110965847969055,
                    "features_accuracy": [
                        0.47335270047187805,
                        0.5176841020584106,
                        0.5334302186965942,
                        0.5268895626068115,
                        0.5179263353347778,
                        0.5247092843055725,
                        0.5123546719551086,
                        0.4639050364494324
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": -0.3657952635725363,
                    "pretrain_loss": 1.441249132156372,
                    "pretrain_component": 0.6933587193489075,
                    "supervised_component": 0.720624566078186,
                    "features_accuracy": [
                        0.47134530544281006,
                        0.5188886523246765,
                        0.5216140747070312,
                        0.528351902961731,
                        0.5071542263031006,
                        0.5303959846496582,
                        0.514194905757904,
                        0.47664472460746765
                    ]
                },
                "val": {
                    "score": -0.44498853955194156,
                    "pretrain_loss": 1.440688967704773,
                    "pretrain_component": 0.6933754086494446,
                    "supervised_component": 0.7203444838523865,
                    "features_accuracy": [
                        0.48138055205345154,
                        0.5134726166725159,
                        0.5416288375854492,
                        0.5322434306144714,
                        0.5019679069519043,
                        0.5252800583839417,
                        0.5252800583839417,
                        0.46654555201530457
                    ]
                },
                "test": {
                    "score": -0.4418666193303616,
                    "pretrain_loss": 1.4224032163619995,
                    "pretrain_component": 0.6932793855667114,
                    "supervised_component": 0.7112016081809998,
                    "features_accuracy": [
                        0.4723837077617645,
                        0.5171996355056763,
                        0.533187985420227,
                        0.5249515771865845,
                        0.5167151093482971,
                        0.523740291595459,
                        0.5096899271011353,
                        0.46124032139778137
                    ]
                }
            },
            "80000": {
                "train": {
                    "score": -0.3324121437923951,
                    "pretrain_loss": 1.3863334655761719,
                    "pretrain_component": 0.6933672428131104,
                    "supervised_component": 0.6931667327880859,
                    "features_accuracy": [
                        0.4733893573284149,
                        0.5125293731689453,
                        0.526459276676178,
                        0.5269134640693665,
                        0.5204027891159058,
                        0.5247179865837097,
                        0.5201756358146667,
                        0.4696040749549866
                    ]
                },
                "val": {
                    "score": -0.4459993101207654,
                    "pretrain_loss": 1.4128632545471191,
                    "pretrain_component": 0.6932986378669739,
                    "supervised_component": 0.7064316272735596,
                    "features_accuracy": [
                        0.48168331384658813,
                        0.5104450583457947,
                        0.5416288375854492,
                        0.5252800583839417,
                        0.4995458722114563,
                        0.5219497680664062,
                        0.5289130806922913,
                        0.47078412771224976
                    ]
                },
                "test": {
                    "score": -0.4434893019133629,
                    "pretrain_loss": 1.4235948324203491,
                    "pretrain_component": 0.6933069825172424,
                    "supervised_component": 0.7117974162101746,
                    "features_accuracy": [
                        0.4738371968269348,
                        0.518410861492157,
                        0.5334302186965942,
                        0.5285852551460266,
                        0.5155038833618164,
                        0.5251938104629517,
                        0.5196220874786377,
                        0.4634205400943756
                    ]
                }
            },
            "90000": {
                "train": {
                    "score": -0.36261320707524364,
                    "pretrain_loss": 1.391695261001587,
                    "pretrain_component": 0.6934328079223633,
                    "supervised_component": 0.6958476305007935,
                    "features_accuracy": [
                        0.46740859746932983,
                        0.5051101446151733,
                        0.5313801169395447,
                        0.5291089415550232,
                        0.5219168663024902,
                        0.5250965356826782,
                        0.5085926651954651,
                        0.4700583219528198
                    ]
                },
                "val": {
                    "score": -0.4506791710855854,
                    "pretrain_loss": 1.418853998184204,
                    "pretrain_component": 0.6933550834655762,
                    "supervised_component": 0.709426999092102,
                    "features_accuracy": [
                        0.48138055205345154,
                        0.5110505819320679,
                        0.5416288375854492,
                        0.5225552320480347,
                        0.5016651749610901,
                        0.5252800583839417,
                        0.5225552320480347,
                        0.46866485476493835
                    ]
                },
                "test": {
                    "score": -0.4329268111889263,
                    "pretrain_loss": 1.4087965488433838,
                    "pretrain_component": 0.6933361887931824,
                    "supervised_component": 0.7043982744216919,
                    "features_accuracy": [
                        0.4723837077617645,
                        0.5130813717842102,
                        0.5334302186965942,
                        0.5227712988853455,
                        0.5159883499145508,
                        0.5227712988853455,
                        0.5087209343910217,
                        0.4634205400943756
                    ]
                }
            }
        },
        "train": {
            "score": -0.33308355278183266
        },
        "val": {
            "score": -0.4435883152443273
        },
        "test": {
            "score": -0.44529882462213083
        }
    },
    "best_iteration": 60000,
    "time": "0:08:29"
}
