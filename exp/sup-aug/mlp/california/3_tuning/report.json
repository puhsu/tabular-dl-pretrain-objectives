{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/tune.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 0,
        "program": "bin/pretrain_mask_supervised.py",
        "base_config": {
            "seed": 0,
            "data": {
                "T_cache": true,
                "path": "data/california",
                "T": {
                    "normalization": "quantile"
                }
            },
            "model": {
                "kind": "mlp"
            },
            "training": {
                "batch_size": 128,
                "patience": 16
            },
            "pretrain": {
                "corrupt_strategy": "resample",
                "patience": 2,
                "d_hidden_head": 512,
                "supervised_weight": 1
            }
        },
        "space": {
            "model": {
                "config": {
                    "d_layers": [
                        "$fixed_mlp_d_layers",
                        1,
                        8,
                        512
                    ],
                    "dropout": [
                        "?uniform",
                        0.0,
                        0.0,
                        0.5
                    ]
                }
            },
            "pretrain": {
                "corrupt_probability": [
                    "uniform",
                    0.2,
                    0.8
                ]
            },
            "training": {
                "lr": [
                    "loguniform",
                    5e-05,
                    0.005
                ],
                "weight_decay": [
                    "?loguniform",
                    0.0,
                    1e-06,
                    0.001
                ]
            }
        },
        "n_trials": 100,
        "timeout": null,
        "sampler": {
            "seed": 0
        }
    },
    "best": {
        "program": "bin/pretrain_mask_supervised.py",
        "environment": {
            "CUDA_VISIBLE_DEVICES": "0",
            "gpus": {
                "driver": "450.119.04",
                "devices": [
                    {
                        "name": "A100-SXM-80GB",
                        "memory_total": 85199093760,
                        "memory_free": 85195948032,
                        "memory_used": 3145728,
                        "utilization": 0
                    }
                ]
            },
            "torch.version.cuda": "11.1",
            "torch.backends.cudnn.version()": 8005,
            "torch.cuda.nccl.version()": [
                2,
                10,
                3
            ]
        },
        "config": {
            "seed": 0,
            "data": {
                "path": "data/california",
                "T": {
                    "seed": 0,
                    "normalization": "quantile",
                    "num_nan_policy": null,
                    "cat_nan_policy": null,
                    "cat_min_frequency": null,
                    "cat_encoding": null,
                    "y_policy": "default"
                },
                "T_cache": true
            },
            "model": {
                "kind": "mlp",
                "config": {
                    "d_layers": [
                        512,
                        512,
                        512,
                        512,
                        512
                    ],
                    "dropout": 0.0
                },
                "default": true,
                "checkpoint": null,
                "num_embedding_arch": [],
                "d_num_embedding": null,
                "positional_encoding": null,
                "d_cat_embedding": null
            },
            "training": {
                "batch_size": 128,
                "lr": 0.00024334851648075064,
                "weight_decay": 0.0,
                "optimizer": "AdamW",
                "patience": 16,
                "n_epochs": Infinity,
                "eval_batch_size": 8192
            },
            "pretrain": {
                "corrupt_probability": 0.5282480384965015,
                "corrupt_strategy": "resample",
                "d_hidden_head": 512,
                "lr": 0.00024334851648075064,
                "weight_decay": 0.0,
                "patience": 2,
                "n_iterations": 100000,
                "validate_every": 10000,
                "replace_strategy": "shuffle",
                "n_neighbors": 20,
                "use_target": false,
                "early_stop_type": "finetune",
                "target_injection_type": "post",
                "supervised_weight": 1
            },
            "bins": null
        },
        "epoch_size": 104,
        "n_parameters": 1322505,
        "metrics": {
            "iteration_scores": {
                "10000": {
                    "train": {
                        "score": -0.3478986769166315,
                        "pretrain_loss": 1.5086201429367065,
                        "pretrain_component": 0.6930520534515381,
                        "supervised_component": 0.7543100714683533,
                        "features_accuracy": [
                            0.465894490480423,
                            0.49133169651031494,
                            0.47172385454177856,
                            0.5206298828125,
                            0.5276705622673035,
                            0.5260050296783447,
                            0.5341055393218994,
                            0.5362253189086914
                        ]
                    },
                    "val": {
                        "score": -0.47362694555680274,
                        "pretrain_loss": 1.5156238079071045,
                        "pretrain_component": 0.6930152773857117,
                        "supervised_component": 0.7578119039535522,
                        "features_accuracy": [
                            0.46775656938552856,
                            0.4889494478702545,
                            0.4847108721733093,
                            0.5252800583839417,
                            0.5225552320480347,
                            0.5192249417304993,
                            0.531335175037384,
                            0.553133487701416
                        ]
                    },
                    "test": {
                        "score": -0.48094959633646517,
                        "pretrain_loss": 1.4652425050735474,
                        "pretrain_component": 0.6930208206176758,
                        "supervised_component": 0.7326212525367737,
                        "features_accuracy": [
                            0.4750484526157379,
                            0.48619186878204346,
                            0.47456395626068115,
                            0.5266472697257996,
                            0.5266472697257996,
                            0.5271317958831787,
                            0.5375484228134155,
                            0.5363371968269348
                        ]
                    }
                },
                "20000": {
                    "train": {
                        "score": -0.3630603012235193,
                        "pretrain_loss": 1.4614964723587036,
                        "pretrain_component": 0.6931161880493164,
                        "supervised_component": 0.7307482361793518,
                        "features_accuracy": [
                            0.47914302349090576,
                            0.4804300367832184,
                            0.4659701883792877,
                            0.5010220408439636,
                            0.5260050296783447,
                            0.5334241986274719,
                            0.5381937026977539,
                            0.5342569351196289
                        ]
                    },
                    "val": {
                        "score": -0.4671030369806132,
                        "pretrain_loss": 1.5011605024337769,
                        "pretrain_component": 0.6930450797080994,
                        "supervised_component": 0.7505802512168884,
                        "features_accuracy": [
                            0.46594005823135376,
                            0.5004541277885437,
                            0.4847108721733093,
                            0.5080230236053467,
                            0.5204359889030457,
                            0.5192249417304993,
                            0.5395095348358154,
                            0.5476838946342468
                        ]
                    },
                    "test": {
                        "score": -0.46398545141542247,
                        "pretrain_loss": 1.4294898509979248,
                        "pretrain_component": 0.6930220723152161,
                        "supervised_component": 0.7147449254989624,
                        "features_accuracy": [
                            0.4738371968269348,
                            0.48110464215278625,
                            0.47456395626068115,
                            0.512839138507843,
                            0.5288274884223938,
                            0.5271317958831787,
                            0.5348837375640869,
                            0.536579430103302
                        ]
                    }
                },
                "30000": {
                    "train": {
                        "score": -0.3827697412474784,
                        "pretrain_loss": 1.4315475225448608,
                        "pretrain_component": 0.6930723190307617,
                        "supervised_component": 0.7157737612724304,
                        "features_accuracy": [
                            0.4736922085285187,
                            0.4894390404224396,
                            0.4744492471218109,
                            0.48974186182022095,
                            0.5237338542938232,
                            0.524869441986084,
                            0.5336512923240662,
                            0.5382694005966187
                        ]
                    },
                    "val": {
                        "score": -0.4591691840783048,
                        "pretrain_loss": 1.4659991264343262,
                        "pretrain_component": 0.6930278539657593,
                        "supervised_component": 0.7329995632171631,
                        "features_accuracy": [
                            0.46836209297180176,
                            0.4892521798610687,
                            0.4847108721733093,
                            0.5001513957977295,
                            0.5213442444801331,
                            0.5192249417304993,
                            0.538298487663269,
                            0.5516197085380554
                        ]
                    },
                    "test": {
                        "score": -0.4620341437237618,
                        "pretrain_loss": 1.4306368827819824,
                        "pretrain_component": 0.693008542060852,
                        "supervised_component": 0.7153184413909912,
                        "features_accuracy": [
                            0.47335270047187805,
                            0.481589138507843,
                            0.47456395626068115,
                            0.4975775182247162,
                            0.5295542478561401,
                            0.5271317958831787,
                            0.5242248177528381,
                            0.538759708404541
                        ]
                    }
                },
                "40000": {
                    "train": {
                        "score": -0.33066430070741953,
                        "pretrain_loss": 1.41515052318573,
                        "pretrain_component": 0.692948579788208,
                        "supervised_component": 0.707575261592865,
                        "features_accuracy": [
                            0.47785601019859314,
                            0.4871678650379181,
                            0.4686198830604553,
                            0.4981452226638794,
                            0.531531572341919,
                            0.5317586660385132,
                            0.5537133812904358,
                            0.5384964942932129
                        ]
                    },
                    "val": {
                        "score": -0.45540523872160027,
                        "pretrain_loss": 1.4822698831558228,
                        "pretrain_component": 0.6930046081542969,
                        "supervised_component": 0.7411349415779114,
                        "features_accuracy": [
                            0.46684831380844116,
                            0.4910687208175659,
                            0.48440811038017273,
                            0.5134726166725159,
                            0.5213442444801331,
                            0.5192249417304993,
                            0.5443536043167114,
                            0.5464729070663452
                        ]
                    },
                    "test": {
                        "score": -0.45288761873679373,
                        "pretrain_loss": 1.4092087745666504,
                        "pretrain_component": 0.6929787397384644,
                        "supervised_component": 0.7046043872833252,
                        "features_accuracy": [
                            0.4738371968269348,
                            0.47625967860221863,
                            0.47456395626068115,
                            0.5050871968269348,
                            0.5297964811325073,
                            0.5271317958831787,
                            0.5448158979415894,
                            0.533187985420227
                        ]
                    }
                },
                "50000": {
                    "train": {
                        "score": -0.3196244772955385,
                        "pretrain_loss": 1.3962358236312866,
                        "pretrain_component": 0.693039059638977,
                        "supervised_component": 0.6981179118156433,
                        "features_accuracy": [
                            0.47293514013290405,
                            0.48906049132347107,
                            0.4712696075439453,
                            0.5091226100921631,
                            0.5310773253440857,
                            0.5250208377838135,
                            0.5434173941612244,
                            0.5333485007286072
                        ]
                    },
                    "val": {
                        "score": -0.45423819112070585,
                        "pretrain_loss": 1.4700651168823242,
                        "pretrain_component": 0.6929769515991211,
                        "supervised_component": 0.7350325584411621,
                        "features_accuracy": [
                            0.46896761655807495,
                            0.4965183138847351,
                            0.4847108721733093,
                            0.5119588375091553,
                            0.5213442444801331,
                            0.5192249417304993,
                            0.5498031973838806,
                            0.5452618598937988
                        ]
                    },
                    "test": {
                        "score": -0.44953916829214824,
                        "pretrain_loss": 1.4016679525375366,
                        "pretrain_component": 0.6929545402526855,
                        "supervised_component": 0.7008339762687683,
                        "features_accuracy": [
                            0.4750484526157379,
                            0.48134690523147583,
                            0.47480618953704834,
                            0.512839138507843,
                            0.5300387740135193,
                            0.5271317958831787,
                            0.5545058250427246,
                            0.5305232405662537
                        ]
                    }
                },
                "60000": {
                    "train": {
                        "score": -0.31844236967191886,
                        "pretrain_loss": 1.3939120769500732,
                        "pretrain_component": 0.6931012272834778,
                        "supervised_component": 0.6969560384750366,
                        "features_accuracy": [
                            0.4755091369152069,
                            0.4977667033672333,
                            0.46672725677490234,
                            0.49239155650138855,
                            0.5292603969573975,
                            0.5226739645004272,
                            0.5535619854927063,
                            0.5307744741439819
                        ]
                    },
                    "val": {
                        "score": -0.44725316055535996,
                        "pretrain_loss": 1.4652925729751587,
                        "pretrain_component": 0.6931272745132446,
                        "supervised_component": 0.7326462864875793,
                        "features_accuracy": [
                            0.47138965129852295,
                            0.4895549416542053,
                            0.4834998548030853,
                            0.5019679069519043,
                            0.5210414528846741,
                            0.5192249417304993,
                            0.53617924451828,
                            0.5473811626434326
                        ]
                    },
                    "test": {
                        "score": -0.44284576486101385,
                        "pretrain_loss": 1.4032877683639526,
                        "pretrain_component": 0.6930013298988342,
                        "supervised_component": 0.7016438841819763,
                        "features_accuracy": [
                            0.4781976640224457,
                            0.4767441749572754,
                            0.47480618953704834,
                            0.4934593141078949,
                            0.5305232405662537,
                            0.5271317958831787,
                            0.5564438104629517,
                            0.5356104373931885
                        ]
                    }
                },
                "70000": {
                    "train": {
                        "score": -0.35355618982169623,
                        "pretrain_loss": 1.4378806352615356,
                        "pretrain_component": 0.6930091381072998,
                        "supervised_component": 0.7189403176307678,
                        "features_accuracy": [
                            0.47664472460746765,
                            0.49201303720474243,
                            0.4638504087924957,
                            0.4876978099346161,
                            0.5382694005966187,
                            0.5244151949882507,
                            0.5350140333175659,
                            0.5444772839546204
                        ]
                    },
                    "val": {
                        "score": -0.4497418061518451,
                        "pretrain_loss": 1.4753156900405884,
                        "pretrain_component": 0.6930792331695557,
                        "supervised_component": 0.7376578450202942,
                        "features_accuracy": [
                            0.4880411624908447,
                            0.4886466860771179,
                            0.48289433121681213,
                            0.4965183138847351,
                            0.5213442444801331,
                            0.5192249417304993,
                            0.5422343015670776,
                            0.5452618598937988
                        ]
                    },
                    "test": {
                        "score": -0.43301523794480495,
                        "pretrain_loss": 1.4124548435211182,
                        "pretrain_component": 0.6929111480712891,
                        "supervised_component": 0.7062274217605591,
                        "features_accuracy": [
                            0.4820736348628998,
                            0.4828003942966461,
                            0.46802324056625366,
                            0.48788759112358093,
                            0.5297964811325073,
                            0.5271317958831787,
                            0.5486918687820435,
                            0.5414243936538696
                        ]
                    }
                },
                "80000": {
                    "train": {
                        "score": -0.3517436293601138,
                        "pretrain_loss": 1.3756213188171387,
                        "pretrain_component": 0.6931077241897583,
                        "supervised_component": 0.6878106594085693,
                        "features_accuracy": [
                            0.48315542936325073,
                            0.48126280307769775,
                            0.465894490480423,
                            0.4886062741279602,
                            0.5238852500915527,
                            0.5303202271461487,
                            0.5369066596031189,
                            0.5441744327545166
                        ]
                    },
                    "val": {
                        "score": -0.4478592411554464,
                        "pretrain_loss": 1.4477769136428833,
                        "pretrain_component": 0.6932094097137451,
                        "supervised_component": 0.7238884568214417,
                        "features_accuracy": [
                            0.47926127910614014,
                            0.4922797381877899,
                            0.48198607563972473,
                            0.5004541277885437,
                            0.5216469764709473,
                            0.5192249417304993,
                            0.5298213958740234,
                            0.5395095348358154
                        ]
                    },
                    "test": {
                        "score": -0.43424487402194456,
                        "pretrain_loss": 1.3854765892028809,
                        "pretrain_component": 0.693005383014679,
                        "supervised_component": 0.6927382946014404,
                        "features_accuracy": [
                            0.489825576543808,
                            0.4791666567325592,
                            0.46802324056625366,
                            0.4920058250427246,
                            0.529312014579773,
                            0.5271317958831787,
                            0.5382751822471619,
                            0.534641444683075
                        ]
                    }
                },
                "90000": {
                    "train": {
                        "score": -0.34779956017216057,
                        "pretrain_loss": 1.4323705434799194,
                        "pretrain_component": 0.6931105256080627,
                        "supervised_component": 0.7161852717399597,
                        "features_accuracy": [
                            0.47823455929756165,
                            0.49579834938049316,
                            0.4731622636318207,
                            0.47702324390411377,
                            0.5238852500915527,
                            0.5294874906539917,
                            0.5372852087020874,
                            0.5387235879898071
                        ]
                    },
                    "val": {
                        "score": -0.44616176473567326,
                        "pretrain_loss": 1.4594472646713257,
                        "pretrain_component": 0.6931828856468201,
                        "supervised_component": 0.7297236323356628,
                        "features_accuracy": [
                            0.48168331384658813,
                            0.4974265694618225,
                            0.48198607563972473,
                            0.5022706389427185,
                            0.5216469764709473,
                            0.5192249417304993,
                            0.5416288375854492,
                            0.545867383480072
                        ]
                    },
                    "test": {
                        "score": -0.43062742467776827,
                        "pretrain_loss": 1.3980708122253418,
                        "pretrain_component": 0.692938506603241,
                        "supervised_component": 0.6990354061126709,
                        "features_accuracy": [
                            0.4791666567325592,
                            0.4830426275730133,
                            0.471414715051651,
                            0.48619186878204346,
                            0.5297964811325073,
                            0.5271317958831787,
                            0.5474806427955627,
                            0.5336724519729614
                        ]
                    }
                },
                "100000": {
                    "train": {
                        "score": -0.31831916951203343,
                        "pretrain_loss": 1.4076775312423706,
                        "pretrain_component": 0.6930040717124939,
                        "supervised_component": 0.7038387656211853,
                        "features_accuracy": [
                            0.4722537696361542,
                            0.49027180671691895,
                            0.4668029546737671,
                            0.49330005049705505,
                            0.5309259295463562,
                            0.5342569351196289,
                            0.5212355256080627,
                            0.5540162324905396
                        ]
                    },
                    "val": {
                        "score": -0.43743491444363664,
                        "pretrain_loss": 1.4465645551681519,
                        "pretrain_component": 0.6931676268577576,
                        "supervised_component": 0.7232822775840759,
                        "features_accuracy": [
                            0.48289433121681213,
                            0.4922797381877899,
                            0.48259156942367554,
                            0.5022706389427185,
                            0.5168029069900513,
                            0.5192249417304993,
                            0.5225552320480347,
                            0.5637299418449402
                        ]
                    },
                    "test": {
                        "score": -0.4379489988092573,
                        "pretrain_loss": 1.4040513038635254,
                        "pretrain_component": 0.6929327249526978,
                        "supervised_component": 0.7020256519317627,
                        "features_accuracy": [
                            0.48740309476852417,
                            0.4854651093482971,
                            0.4716569781303406,
                            0.48885658383369446,
                            0.5305232405662537,
                            0.5271317958831787,
                            0.5266472697257996,
                            0.5559592843055725
                        ]
                    }
                }
            },
            "train": {
                "score": -0.31831916951203343
            },
            "val": {
                "score": -0.43743491444363664
            },
            "test": {
                "score": -0.4379489988092573
            }
        },
        "best_iteration": 100000,
        "time": "0:09:32",
        "trial_id": 98,
        "tuning_time": "15:22:50"
    },
    "time": "15:32:36",
    "continuations": [
        28,
        38
    ]
}
