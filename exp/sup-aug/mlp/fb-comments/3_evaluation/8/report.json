{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised___4ef14f031dfb40ae87f285595a8e9a42.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 8,
        "data": {
            "path": "data/fb-comments",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512,
                    512
                ],
                "dropout": 0.18082833482117971
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [],
            "d_num_embedding": null,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 512,
            "lr": 8.194056439959983e-05,
            "weight_decay": 3.400204567783505e-05,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.23819287749543802,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 8.194056439959983e-05,
            "weight_decay": 3.400204567783505e-05,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post",
            "supervised_weight": 1
        },
        "bins": null
    },
    "epoch_size": 308,
    "n_parameters": 619572,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -4.373930739670363,
                    "pretrain_loss": 0.7976957559585571,
                    "pretrain_component": 0.6903442740440369,
                    "supervised_component": 0.39884787797927856,
                    "features_accuracy": [
                        0.725523054599762,
                        0.8230122327804565,
                        0.24230198562145233,
                        0.31840038299560547,
                        0.20399904251098633,
                        0.7623859643936157,
                        0.3238305449485779,
                        0.6577348113059998,
                        0.7886423468589783,
                        0.7525216341018677,
                        0.15892107784748077,
                        0.5899529457092285,
                        0.5916149616241455,
                        0.7521981000900269,
                        0.735526978969574,
                        0.26213857531547546,
                        0.27099430561065674,
                        0.2851596772670746,
                        0.7615676522254944,
                        0.8293622136116028,
                        0.7634516954421997,
                        0.22642382979393005,
                        0.19992007315158844,
                        0.17384767532348633,
                        0.7649234533309937,
                        0.24236541986465454,
                        0.7624367475509644,
                        0.27373477816581726,
                        0.2255103439092636,
                        0.9907636642456055,
                        0.7466347217559814,
                        0.48391252756118774,
                        0.48934268951416016,
                        0.8254228234291077,
                        0.1862495094537735,
                        0.9363478422164917,
                        0.8961291313171387,
                        0.0595414824783802,
                        0.9311079978942871,
                        0.7924929261207581,
                        0.05808244273066521,
                        0.7042020559310913,
                        0.7636420130729675,
                        0.6114261746406555,
                        0.9393357038497925,
                        0.49246376752853394,
                        0.45730724930763245,
                        0.7716667652130127,
                        0.6721158623695374,
                        0.9981286525726318,
                        0.371966153383255
                    ]
                },
                "val": {
                    "score": -5.407336346106505,
                    "pretrain_loss": 0.7691957950592041,
                    "pretrain_component": 0.6903350949287415,
                    "supervised_component": 0.38459789752960205,
                    "features_accuracy": [
                        0.7297434210777283,
                        0.822279691696167,
                        0.24115200340747833,
                        0.31756412982940674,
                        0.20515160262584686,
                        0.7621944546699524,
                        0.33049386739730835,
                        0.6558665037155151,
                        0.7942906022071838,
                        0.7494675517082214,
                        0.16022714972496033,
                        0.5912685990333557,
                        0.5884291529655457,
                        0.7537775039672852,
                        0.7310617566108704,
                        0.2634621262550354,
                        0.27081429958343506,
                        0.28435248136520386,
                        0.7602676749229431,
                        0.8315079212188721,
                        0.7622959017753601,
                        0.23045329749584198,
                        0.20297129452228546,
                        0.17128080129623413,
                        0.7731974124908447,
                        0.24247032403945923,
                        0.7669100165367126,
                        0.2728932201862335,
                        0.22477436065673828,
                        0.990822434425354,
                        0.751901388168335,
                        0.479920893907547,
                        0.490518182516098,
                        0.8260825276374817,
                        0.18375417590141296,
                        0.9367203712463379,
                        0.8942804932594299,
                        0.05800628662109375,
                        0.9291653633117676,
                        0.7915525436401367,
                        0.059730250388383865,
                        0.69962477684021,
                        0.767315685749054,
                        0.6088124513626099,
                        0.9396612644195557,
                        0.4975154399871826,
                        0.46075448393821716,
                        0.766605794429779,
                        0.6734610795974731,
                        0.9979210495948792,
                        0.37719297409057617
                    ]
                },
                "test": {
                    "score": -5.7158539854124735,
                    "pretrain_loss": 0.7850091457366943,
                    "pretrain_component": 0.6903212666511536,
                    "supervised_component": 0.39250457286834717,
                    "features_accuracy": [
                        0.7322008013725281,
                        0.827839732170105,
                        0.24274848401546478,
                        0.31977689266204834,
                        0.20461460947990417,
                        0.7602434158325195,
                        0.32839757204055786,
                        0.6574543714523315,
                        0.794929027557373,
                        0.7500507235527039,
                        0.15720081329345703,
                        0.5878803133964539,
                        0.5956896543502808,
                        0.75162273645401,
                        0.7381845712661743,
                        0.26379311084747314,
                        0.2703346908092499,
                        0.28397566080093384,
                        0.7620689868927002,
                        0.833316445350647,
                        0.7627789378166199,
                        0.226673424243927,
                        0.19888438284397125,
                        0.17175456881523132,
                        0.7663792967796326,
                        0.23869168758392334,
                        0.7653144001960754,
                        0.27150100469589233,
                        0.23113590478897095,
                        0.9913285970687866,
                        0.7425456643104553,
                        0.4926977753639221,
                        0.48838743567466736,
                        0.8311865925788879,
                        0.18752536177635193,
                        0.9362068772315979,
                        0.9012677669525146,
                        0.05704868212342262,
                        0.9297667145729065,
                        0.7934584021568298,
                        0.058924950659275055,
                        0.7042596340179443,
                        0.7576572299003601,
                        0.6070994138717651,
                        0.9403651356697083,
                        0.49721094965934753,
                        0.4540567994117737,
                        0.7754057049751282,
                        0.6710953116416931,
                        0.998275876045227,
                        0.3714503049850464
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -3.967918877809239,
                    "pretrain_loss": 0.7504458427429199,
                    "pretrain_component": 0.6901900768280029,
                    "supervised_component": 0.37522292137145996,
                    "features_accuracy": [
                        0.7327357530593872,
                        0.842195451259613,
                        0.24556896090507507,
                        0.255471408367157,
                        0.20557226240634918,
                        0.762347936630249,
                        0.3038100004196167,
                        0.655945897102356,
                        0.7773569822311401,
                        0.743069589138031,
                        0.2755173444747925,
                        0.580913245677948,
                        0.6002169847488403,
                        0.7469645738601685,
                        0.7236199378967285,
                        0.25177305936813354,
                        0.26827922463417053,
                        0.2785051763057709,
                        0.7607810497283936,
                        0.8293558955192566,
                        0.7608761787414551,
                        0.2275339812040329,
                        0.19952677190303802,
                        0.1729976236820221,
                        0.7693132758140564,
                        0.26661086082458496,
                        0.7665727734565735,
                        0.26529136300086975,
                        0.23444855213165283,
                        0.9908588528633118,
                        0.5777350664138794,
                        0.6512262225151062,
                        0.3242175281047821,
                        0.8021225929260254,
                        0.38405081629753113,
                        0.9391834735870361,
                        0.9029739499092102,
                        0.06681764870882034,
                        0.9371979236602783,
                        0.7397899031639099,
                        0.060657963156700134,
                        0.598529577255249,
                        0.7613773345947266,
                        0.7829203605651855,
                        0.9347619414329529,
                        0.6015618443489075,
                        0.5177685618400574,
                        0.7663317322731018,
                        0.6714180707931519,
                        0.99820476770401,
                        0.37701570987701416
                    ]
                },
                "val": {
                    "score": -5.429391072721372,
                    "pretrain_loss": 0.7276781797409058,
                    "pretrain_component": 0.6901760697364807,
                    "supervised_component": 0.3638390898704529,
                    "features_accuracy": [
                        0.7333941459655762,
                        0.8419530987739563,
                        0.24287596344947815,
                        0.255349338054657,
                        0.20520231127738953,
                        0.7621944546699524,
                        0.3081330358982086,
                        0.6530777812004089,
                        0.7798397541046143,
                        0.7417097687721252,
                        0.2790791988372803,
                        0.5844741463661194,
                        0.5936010479927063,
                        0.7487577199935913,
                        0.7217320799827576,
                        0.2559070885181427,
                        0.2701551616191864,
                        0.2767467796802521,
                        0.7595071196556091,
                        0.8315079212188721,
                        0.7620423436164856,
                        0.23045329749584198,
                        0.2029205858707428,
                        0.1713315099477768,
                        0.7774566411972046,
                        0.2695974111557007,
                        0.7688367962837219,
                        0.26381704211235046,
                        0.23298853635787964,
                        0.9902646541595459,
                        0.5803670883178711,
                        0.6462326049804688,
                        0.3275529742240906,
                        0.804685115814209,
                        0.3814014792442322,
                        0.9384950399398804,
                        0.9032045006752014,
                        0.06804583221673965,
                        0.9375823736190796,
                        0.7411012649536133,
                        0.062265489250421524,
                        0.5970996618270874,
                        0.767366349697113,
                        0.7824764251708984,
                        0.9337795376777649,
                        0.6038433909416199,
                        0.519774854183197,
                        0.7607240676879883,
                        0.6710779666900635,
                        0.9979210495948792,
                        0.37866342067718506
                    ]
                },
                "test": {
                    "score": -5.668345895369887,
                    "pretrain_loss": 0.7488760352134705,
                    "pretrain_component": 0.6901721358299255,
                    "supervised_component": 0.37443801760673523,
                    "features_accuracy": [
                        0.7367647290229797,
                        0.8440162539482117,
                        0.24579107761383057,
                        0.25461459159851074,
                        0.20461460947990417,
                        0.7602434158325195,
                        0.30684584379196167,
                        0.6559838056564331,
                        0.78392493724823,
                        0.7430527210235596,
                        0.2715517282485962,
                        0.5879817605018616,
                        0.6014198660850525,
                        0.7472109794616699,
                        0.7268762588500977,
                        0.2545638978481293,
                        0.2657707929611206,
                        0.2790567874908447,
                        0.7614604234695435,
                        0.833316445350647,
                        0.7629817724227905,
                        0.22687627375125885,
                        0.19888438284397125,
                        0.17160242795944214,
                        0.7707403898239136,
                        0.26120689511299133,
                        0.7674949169158936,
                        0.2652129828929901,
                        0.23904664814472198,
                        0.991125762462616,
                        0.5672920942306519,
                        0.6584685444831848,
                        0.32145029306411743,
                        0.8109026551246643,
                        0.38838741183280945,
                        0.937221109867096,
                        0.9089756608009338,
                        0.06688641011714935,
                        0.9374239444732666,
                        0.7408722043037415,
                        0.06069979816675186,
                        0.6049188375473022,
                        0.7577078938484192,
                        0.7870182394981384,
                        0.9350912570953369,
                        0.6042596101760864,
                        0.5198276042938232,
                        0.7704868316650391,
                        0.6693204641342163,
                        0.998275876045227,
                        0.37687626481056213
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -4.2099463870426925,
                    "pretrain_loss": 0.740570604801178,
                    "pretrain_component": 0.6898788213729858,
                    "supervised_component": 0.370285302400589,
                    "features_accuracy": [
                        0.7361613512039185,
                        0.8518060445785522,
                        0.2522805333137512,
                        0.2577551007270813,
                        0.20711377263069153,
                        0.7638957500457764,
                        0.3208426833152771,
                        0.6760679483413696,
                        0.7815691828727722,
                        0.7479668855667114,
                        0.2028825581073761,
                        0.6345233917236328,
                        0.6497228145599365,
                        0.7520331740379333,
                        0.7296273708343506,
                        0.2629188597202301,
                        0.2613583207130432,
                        0.2687486708164215,
                        0.7628300189971924,
                        0.8299204707145691,
                        0.7619355916976929,
                        0.22898666560649872,
                        0.20143620669841766,
                        0.17539553344249725,
                        0.7689643502235413,
                        0.3022494614124298,
                        0.7669724225997925,
                        0.2578946650028229,
                        0.23194915056228638,
                        0.9903450012207031,
                        0.5804564952850342,
                        0.7822162508964539,
                        0.3182545006275177,
                        0.7518999576568604,
                        0.5284068584442139,
                        0.938238263130188,
                        0.9103388786315918,
                        0.06554891914129257,
                        0.9392976760864258,
                        0.8048567175865173,
                        0.060220252722501755,
                        0.6843147277832031,
                        0.7538791298866272,
                        0.8546479940414429,
                        0.9326367974281311,
                        0.644673228263855,
                        0.5173562169075012,
                        0.7665664553642273,
                        0.6799439191818237,
                        0.9982428550720215,
                        0.4315774142742157
                    ]
                },
                "val": {
                    "score": -5.462806183335066,
                    "pretrain_loss": 0.7153542637825012,
                    "pretrain_component": 0.6898663640022278,
                    "supervised_component": 0.3576771318912506,
                    "features_accuracy": [
                        0.7381097078323364,
                        0.8508771657943726,
                        0.2507859170436859,
                        0.2611297070980072,
                        0.20586146414279938,
                        0.7621944546699524,
                        0.32658958435058594,
                        0.6746273040771484,
                        0.7830848693847656,
                        0.7450055480003357,
                        0.2074333131313324,
                        0.6356860399246216,
                        0.6440523266792297,
                        0.7557549476623535,
                        0.7278673648834229,
                        0.26589593291282654,
                        0.26467904448509216,
                        0.2695466876029968,
                        0.7601155638694763,
                        0.8315079212188721,
                        0.762346625328064,
                        0.23040258884429932,
                        0.20322482287883759,
                        0.17173713445663452,
                        0.7766453623771667,
                        0.3048372268676758,
                        0.7695974111557007,
                        0.25641414523124695,
                        0.2298448383808136,
                        0.9900111556053162,
                        0.5838150382041931,
                        0.7804989218711853,
                        0.3209613561630249,
                        0.7508873343467712,
                        0.5272284746170044,
                        0.9383429288864136,
                        0.9090355634689331,
                        0.06586553156375885,
                        0.9389513731002808,
                        0.804685115814209,
                        0.06104857474565506,
                        0.6802555322647095,
                        0.7557549476623535,
                        0.8588885068893433,
                        0.9321569800376892,
                        0.6457255482673645,
                        0.5201805233955383,
                        0.7624480128288269,
                        0.679900586605072,
                        0.9979210495948792,
                        0.4276949465274811
                    ]
                },
                "test": {
                    "score": -5.745562881618721,
                    "pretrain_loss": 0.7400022149085999,
                    "pretrain_component": 0.6898573040962219,
                    "supervised_component": 0.3700011074542999,
                    "features_accuracy": [
                        0.7400608658790588,
                        0.8545638918876648,
                        0.251926988363266,
                        0.2573022246360779,
                        0.20573022961616516,
                        0.7602434158325195,
                        0.32317444682121277,
                        0.6785497069358826,
                        0.7853448390960693,
                        0.7473123669624329,
                        0.20035496354103088,
                        0.6351926922798157,
                        0.6491886377334595,
                        0.7545132040977478,
                        0.7309330701828003,
                        0.2656186521053314,
                        0.2626267671585083,
                        0.27216023206710815,
                        0.761713981628418,
                        0.833316445350647,
                        0.7631338834762573,
                        0.22662271559238434,
                        0.19893509149551392,
                        0.17231237888336182,
                        0.7697261571884155,
                        0.3037525415420532,
                        0.7679513096809387,
                        0.25882354378700256,
                        0.23691684007644653,
                        0.9904665350914001,
                        0.5763184428215027,
                        0.7847363352775574,
                        0.3146044611930847,
                        0.7614097595214844,
                        0.5359026193618774,
                        0.9364097118377686,
                        0.9162778854370117,
                        0.06460446119308472,
                        0.9383874535560608,
                        0.8047667145729065,
                        0.06004056707024574,
                        0.6884381175041199,
                        0.7474644780158997,
                        0.858924925327301,
                        0.9328093528747559,
                        0.6501521468162537,
                        0.5176470875740051,
                        0.7716531753540039,
                        0.6787018179893494,
                        0.9982251524925232,
                        0.4303245544433594
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -4.281518584312085,
                    "pretrain_loss": 0.7062277793884277,
                    "pretrain_component": 0.689751923084259,
                    "supervised_component": 0.35311388969421387,
                    "features_accuracy": [
                        0.735457181930542,
                        0.8507593274116516,
                        0.2555729150772095,
                        0.30021315813064575,
                        0.2086172103881836,
                        0.7620244026184082,
                        0.3088785707950592,
                        0.6558570861816406,
                        0.796565592288971,
                        0.7477258443832397,
                        0.1689821034669876,
                        0.6237772703170776,
                        0.6436455845832825,
                        0.7502822875976562,
                        0.7267346978187561,
                        0.26171356439590454,
                        0.2512274980545044,
                        0.27682411670684814,
                        0.7614661455154419,
                        0.8314112424850464,
                        0.7615803480148315,
                        0.22873926162719727,
                        0.2012966424226761,
                        0.17341631650924683,
                        0.764879047870636,
                        0.2601149380207062,
                        0.7679747343063354,
                        0.26184678077697754,
                        0.23615498840808868,
                        0.9914361238479614,
                        0.4969804286956787,
                        0.7458861470222473,
                        0.33361878991127014,
                        0.80869460105896,
                        0.5335515737533569,
                        0.9381113648414612,
                        0.915496289730072,
                        0.06204722449183464,
                        0.9356056451797485,
                        0.8115492463111877,
                        0.059630293399095535,
                        0.7376457452774048,
                        0.7370050549507141,
                        0.918363630771637,
                        0.9326114654541016,
                        0.5913105010986328,
                        0.5121671557426453,
                        0.7710767984390259,
                        0.6730674505233765,
                        0.9982301592826843,
                        0.456983745098114
                    ]
                },
                "val": {
                    "score": -5.453608637652775,
                    "pretrain_loss": 0.686724841594696,
                    "pretrain_component": 0.6897406578063965,
                    "supervised_component": 0.343362420797348,
                    "features_accuracy": [
                        0.7347632050514221,
                        0.8474799394607544,
                        0.25540006160736084,
                        0.3043808937072754,
                        0.20576006174087524,
                        0.7621944546699524,
                        0.3144204318523407,
                        0.6567792296409607,
                        0.8007301092147827,
                        0.7470844388008118,
                        0.17533718049526215,
                        0.6309197545051575,
                        0.6390832662582397,
                        0.7528141140937805,
                        0.7200080752372742,
                        0.26584523916244507,
                        0.2525605857372284,
                        0.2765439450740814,
                        0.7600648999214172,
                        0.8312544226646423,
                        0.7621944546699524,
                        0.23050400614738464,
                        0.20352904498577118,
                        0.1711793839931488,
                        0.7726396918296814,
                        0.26092687249183655,
                        0.7712199091911316,
                        0.2646283209323883,
                        0.23329275846481323,
                        0.990822434425354,
                        0.4988337755203247,
                        0.7452591061592102,
                        0.3359699845314026,
                        0.8085893988609314,
                        0.5319440364837646,
                        0.9383936524391174,
                        0.913294792175293,
                        0.06155562028288841,
                        0.9350978136062622,
                        0.8135077357292175,
                        0.06135280057787895,
                        0.7283236980438232,
                        0.7432816028594971,
                        0.9200385212898254,
                        0.9314978122711182,
                        0.5942094922065735,
                        0.5116620659828186,
                        0.7669100165367126,
                        0.6765033602714539,
                        0.9977689385414124,
                        0.45436567068099976
                    ]
                },
                "test": {
                    "score": -5.713709494056883,
                    "pretrain_loss": 0.7162610292434692,
                    "pretrain_component": 0.6897324919700623,
                    "supervised_component": 0.3581305146217346,
                    "features_accuracy": [
                        0.7377281785011292,
                        0.8525354862213135,
                        0.25527384877204895,
                        0.29807302355766296,
                        0.20588235557079315,
                        0.7602434158325195,
                        0.3129817545413971,
                        0.6595841646194458,
                        0.8034482598304749,
                        0.7478702068328857,
                        0.16784989833831787,
                        0.6258620619773865,
                        0.6456896662712097,
                        0.7508113384246826,
                        0.7245942950248718,
                        0.26475659012794495,
                        0.2517748475074768,
                        0.27682554721832275,
                        0.7617647051811218,
                        0.8332657217979431,
                        0.7632859945297241,
                        0.2268255650997162,
                        0.19979716837406158,
                        0.17155171930789948,
                        0.7662779092788696,
                        0.2584685683250427,
                        0.7695740461349487,
                        0.2651115655899048,
                        0.24112576246261597,
                        0.9909736514091492,
                        0.49087220430374146,
                        0.7509127855300903,
                        0.3273833692073822,
                        0.8149087429046631,
                        0.5373225212097168,
                        0.9367647171020508,
                        0.9199796915054321,
                        0.059432048350572586,
                        0.9352941513061523,
                        0.8103955388069153,
                        0.059939149767160416,
                        0.7429513335227966,
                        0.7307302355766296,
                        0.9206389784812927,
                        0.9335699677467346,
                        0.5949289798736572,
                        0.5107505321502686,
                        0.775557816028595,
                        0.6729716062545776,
                        0.9981237649917603,
                        0.45755577087402344
                    ]
                }
            }
        },
        "train": {
            "score": -4.373930739670363
        },
        "val": {
            "score": -5.407336346106505
        },
        "test": {
            "score": -5.7158539854124735
        }
    },
    "best_iteration": 10000,
    "time": "0:09:40"
}
