{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised___4ef14f031dfb40ae87f285595a8e9a42.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 7,
        "data": {
            "path": "data/fb-comments",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512,
                    512
                ],
                "dropout": 0.18082833482117971
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [],
            "d_num_embedding": null,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 512,
            "lr": 8.194056439959983e-05,
            "weight_decay": 3.400204567783505e-05,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.23819287749543802,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 8.194056439959983e-05,
            "weight_decay": 3.400204567783505e-05,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post",
            "supervised_weight": 1
        },
        "bins": null
    },
    "epoch_size": 308,
    "n_parameters": 619572,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -4.1488548282032,
                    "pretrain_loss": 0.7951370477676392,
                    "pretrain_component": 0.6957662105560303,
                    "supervised_component": 0.3975685238838196,
                    "features_accuracy": [
                        0.2438054382801056,
                        0.14745810627937317,
                        0.5755909085273743,
                        0.23894619941711426,
                        0.20985423028469086,
                        0.23818495869636536,
                        0.464285284280777,
                        0.5789276957511902,
                        0.1975792646408081,
                        0.7626650929450989,
                        0.9139420986175537,
                        0.239161878824234,
                        0.7634643912315369,
                        0.6843908429145813,
                        0.7237404584884644,
                        0.24272701144218445,
                        0.26098403334617615,
                        0.6561743021011353,
                        0.23909209668636322,
                        0.5433334708213806,
                        0.26655375957489014,
                        0.23947906494140625,
                        0.24979384243488312,
                        0.795163631439209,
                        0.2563024163246155,
                        0.31919968128204346,
                        0.6969766616821289,
                        0.23666882514953613,
                        0.22484426200389862,
                        0.009179258719086647,
                        0.051688045263290405,
                        0.9964666366577148,
                        0.19670385122299194,
                        0.9268006682395935,
                        0.06274502724409103,
                        0.9309113621711731,
                        0.159504696726799,
                        0.944581925868988,
                        0.5777033567428589,
                        0.05574798211455345,
                        0.9024727940559387,
                        0.07963181287050247,
                        0.7650439739227295,
                        0.5975335836410522,
                        0.059998225420713425,
                        0.9418414831161499,
                        0.24825233221054077,
                        0.22896763682365417,
                        0.6631269454956055,
                        0.00402821647003293,
                        0.77454674243927
                    ]
                },
                "val": {
                    "score": -5.403757408577826,
                    "pretrain_loss": 0.7664008736610413,
                    "pretrain_component": 0.6957653164863586,
                    "supervised_component": 0.38320043683052063,
                    "features_accuracy": [
                        0.24145624041557312,
                        0.1486157476902008,
                        0.577629029750824,
                        0.23805901408195496,
                        0.21103335916996002,
                        0.23760266602039337,
                        0.4614643454551697,
                        0.5807726979255676,
                        0.1963796764612198,
                        0.7640705704689026,
                        0.9128384590148926,
                        0.238566055893898,
                        0.7650339603424072,
                        0.6862894296646118,
                        0.7308589220046997,
                        0.23968157172203064,
                        0.262042373418808,
                        0.6637257933616638,
                        0.23836323618888855,
                        0.5427948236465454,
                        0.26706215739250183,
                        0.24231821298599243,
                        0.24926477670669556,
                        0.7956596612930298,
                        0.25088733434677124,
                        0.3174627125263214,
                        0.6976472735404968,
                        0.2366899847984314,
                        0.2222898155450821,
                        0.010293073020875454,
                        0.05034986138343811,
                        0.9958928823471069,
                        0.1984078586101532,
                        0.9262244701385498,
                        0.06256971508264542,
                        0.9295710325241089,
                        0.15956799685955048,
                        0.9425514340400696,
                        0.5814825892448425,
                        0.056789372116327286,
                        0.9039651155471802,
                        0.07808538526296616,
                        0.761078953742981,
                        0.5943108797073364,
                        0.06044011563062668,
                        0.9413345456123352,
                        0.24201399087905884,
                        0.23177161812782288,
                        0.6663117408752441,
                        0.0047662509605288506,
                        0.7721832990646362
                    ]
                },
                "test": {
                    "score": -5.673834406918917,
                    "pretrain_loss": 0.8049453496932983,
                    "pretrain_component": 0.6957786679267883,
                    "supervised_component": 0.40247267484664917,
                    "features_accuracy": [
                        0.23722109198570251,
                        0.1491379290819168,
                        0.5753042697906494,
                        0.24279919266700745,
                        0.2107505053281784,
                        0.23782961070537567,
                        0.46891480684280396,
                        0.5806795358657837,
                        0.1961967498064041,
                        0.7627789378166199,
                        0.9150101542472839,
                        0.23782961070537567,
                        0.7608519196510315,
                        0.6785497069358826,
                        0.7285497188568115,
                        0.24923935532569885,
                        0.26338741183280945,
                        0.6618661284446716,
                        0.23362068831920624,
                        0.5419371128082275,
                        0.26404666900634766,
                        0.23534482717514038,
                        0.2512170374393463,
                        0.8012170195579529,
                        0.2545131742954254,
                        0.3104969561100006,
                        0.6962981820106506,
                        0.23336714506149292,
                        0.22018255293369293,
                        0.009787018410861492,
                        0.04969574138522148,
                        0.9966024160385132,
                        0.1996450275182724,
                        0.926673412322998,
                        0.0649087205529213,
                        0.9276876449584961,
                        0.15659229457378387,
                        0.9406186938285828,
                        0.5769270062446594,
                        0.05385395511984825,
                        0.9004057049751282,
                        0.07692697644233704,
                        0.7618154287338257,
                        0.5876267552375793,
                        0.0583164319396019,
                        0.9398072957992554,
                        0.24787017703056335,
                        0.22718052566051483,
                        0.6591784954071045,
                        0.004158215131610632,
                        0.775050699710846
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -4.043065762170925,
                    "pretrain_loss": 0.7472564578056335,
                    "pretrain_component": 0.6955705285072327,
                    "supervised_component": 0.3736282289028168,
                    "features_accuracy": [
                        0.25832605361938477,
                        0.15356069803237915,
                        0.6871693730354309,
                        0.23821033537387848,
                        0.2150433361530304,
                        0.2385338544845581,
                        0.3881107568740845,
                        0.6556350588798523,
                        0.19298012554645538,
                        0.7571715116500854,
                        0.7488296031951904,
                        0.24401476979255676,
                        0.7628363966941833,
                        0.5221076011657715,
                        0.7380263805389404,
                        0.2982466220855713,
                        0.2794947922229767,
                        0.679373025894165,
                        0.23659904301166534,
                        0.5782425403594971,
                        0.27059465646743774,
                        0.23718266189098358,
                        0.26111090183258057,
                        0.8057448267936707,
                        0.24719293415546417,
                        0.3061063885688782,
                        0.6723251938819885,
                        0.2352922558784485,
                        0.22199596464633942,
                        0.012554080225527287,
                        0.050641342997550964,
                        0.9963714480400085,
                        0.10579302161931992,
                        0.923172116279602,
                        0.06433093547821045,
                        0.9325289726257324,
                        0.09882769733667374,
                        0.9410865306854248,
                        0.6838008761405945,
                        0.05640771985054016,
                        0.9171202778816223,
                        0.0853220671415329,
                        0.762284517288208,
                        0.8524214029312134,
                        0.05982694774866104,
                        0.9420571327209473,
                        0.3362387418746948,
                        0.23262158036231995,
                        0.5862038731575012,
                        0.0032669787760823965,
                        0.7639592289924622
                    ]
                },
                "val": {
                    "score": -5.406934383620613,
                    "pretrain_loss": 0.7268559336662292,
                    "pretrain_component": 0.6955541372299194,
                    "supervised_component": 0.3634279668331146,
                    "features_accuracy": [
                        0.2565155625343323,
                        0.15404117107391357,
                        0.6938444375991821,
                        0.23937733471393585,
                        0.21782779693603516,
                        0.23942804336547852,
                        0.38185781240463257,
                        0.6577426195144653,
                        0.19318526983261108,
                        0.7588479518890381,
                        0.7457661032676697,
                        0.24170975387096405,
                        0.7650846838951111,
                        0.516986072063446,
                        0.7422167658805847,
                        0.2950512170791626,
                        0.2815130352973938,
                        0.6852753162384033,
                        0.23866747319698334,
                        0.577629029750824,
                        0.27274107933044434,
                        0.2384139448404312,
                        0.26356351375579834,
                        0.8079302310943604,
                        0.2460196614265442,
                        0.30635836720466614,
                        0.6764019727706909,
                        0.2362336367368698,
                        0.22087009251117706,
                        0.01353817991912365,
                        0.05024845153093338,
                        0.9959942698478699,
                        0.10612513870000839,
                        0.9210526347160339,
                        0.06256971508264542,
                        0.9317513108253479,
                        0.10435047000646591,
                        0.9406246542930603,
                        0.6872020959854126,
                        0.056789372116327286,
                        0.9171483516693115,
                        0.0831051617860794,
                        0.761078953742981,
                        0.8483926057815552,
                        0.059730250388383865,
                        0.9413345456123352,
                        0.32800930738449097,
                        0.2328871190547943,
                        0.5933982133865356,
                        0.003600040450692177,
                        0.7619916796684265
                    ]
                },
                "test": {
                    "score": -5.712448464096623,
                    "pretrain_loss": 0.7708235383033752,
                    "pretrain_component": 0.6955659985542297,
                    "supervised_component": 0.3854117691516876,
                    "features_accuracy": [
                        0.25309330224990845,
                        0.1543610543012619,
                        0.6889959573745728,
                        0.24442191421985626,
                        0.21536511182785034,
                        0.239858016371727,
                        0.3866632878780365,
                        0.6576064825057983,
                        0.19366125762462616,
                        0.7568458318710327,
                        0.745537519454956,
                        0.24087221920490265,
                        0.7608519196510315,
                        0.5182048678398132,
                        0.7375760674476624,
                        0.3057302236557007,
                        0.2812880277633667,
                        0.6826571822166443,
                        0.23341785371303558,
                        0.5780426263809204,
                        0.2672920823097229,
                        0.23154158890247345,
                        0.26556795835494995,
                        0.8117647171020508,
                        0.24832656979560852,
                        0.3036511242389679,
                        0.6759635210037231,
                        0.2328600436449051,
                        0.21947261691093445,
                        0.01232251524925232,
                        0.049594320356845856,
                        0.9967545866966248,
                        0.10892494767904282,
                        0.9228194952011108,
                        0.06485801190137863,
                        0.9303245544433594,
                        0.09817444533109665,
                        0.938894510269165,
                        0.6805781126022339,
                        0.05385395511984825,
                        0.9175456166267395,
                        0.08306287974119186,
                        0.7616633176803589,
                        0.8501014113426208,
                        0.05801216885447502,
                        0.9398072957992554,
                        0.3374239504337311,
                        0.22895537316799164,
                        0.5863590240478516,
                        0.002839756663888693,
                        0.7639959454536438
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -4.178057767210406,
                    "pretrain_loss": 0.7345975637435913,
                    "pretrain_component": 0.695639431476593,
                    "supervised_component": 0.36729878187179565,
                    "features_accuracy": [
                        0.24964158236980438,
                        0.15064261853694916,
                        0.6863700747489929,
                        0.23819130659103394,
                        0.21416155993938446,
                        0.2384069859981537,
                        0.46624547243118286,
                        0.6788845658302307,
                        0.19384920597076416,
                        0.7634707689285278,
                        0.5420076251029968,
                        0.2458227127790451,
                        0.7618594765663147,
                        0.5249369144439697,
                        0.7370113730430603,
                        0.3238939940929413,
                        0.26224642992019653,
                        0.6957332491874695,
                        0.2383054941892624,
                        0.61072838306427,
                        0.2638576924800873,
                        0.23186668753623962,
                        0.4235209822654724,
                        0.8110036849975586,
                        0.23690354824066162,
                        0.26890724897384644,
                        0.6970146894454956,
                        0.23943465948104858,
                        0.2218310385942459,
                        0.010650984942913055,
                        0.05130108445882797,
                        0.9961938261985779,
                        0.10605311393737793,
                        0.924834132194519,
                        0.06379172950983047,
                        0.9348888397216797,
                        0.13498014211654663,
                        0.9438650608062744,
                        0.5050686001777649,
                        0.054872557520866394,
                        0.9160798788070679,
                        0.0801837146282196,
                        0.7624684572219849,
                        0.8598117232322693,
                        0.06030906364321709,
                        0.9428437352180481,
                        0.2737157344818115,
                        0.23036323487758636,
                        0.5765171051025391,
                        0.004262931644916534,
                        0.744262158870697
                    ]
                },
                "val": {
                    "score": -5.41622771491195,
                    "pretrain_loss": 0.7049035429954529,
                    "pretrain_component": 0.6956236958503723,
                    "supervised_component": 0.35245177149772644,
                    "features_accuracy": [
                        0.24647600948810577,
                        0.15267214179039001,
                        0.6928303241729736,
                        0.23942804336547852,
                        0.21519115567207336,
                        0.2391745150089264,
                        0.4634925425052643,
                        0.6835513710975647,
                        0.1930331587791443,
                        0.7641719579696655,
                        0.541577935218811,
                        0.24318020045757294,
                        0.7650846838951111,
                        0.5238819718360901,
                        0.7415576577186584,
                        0.31989654898643494,
                        0.26224520802497864,
                        0.7004360556602478,
                        0.23775479197502136,
                        0.6128688454627991,
                        0.2652367949485779,
                        0.23704491555690765,
                        0.43164992332458496,
                        0.8108204007148743,
                        0.2377040833234787,
                        0.2667072117328644,
                        0.7004360556602478,
                        0.23745055496692657,
                        0.22000810503959656,
                        0.012067741714417934,
                        0.05055268108844757,
                        0.9958928823471069,
                        0.10419835150241852,
                        0.9236385226249695,
                        0.06251901388168335,
                        0.9333738684654236,
                        0.13918466866016388,
                        0.9428049921989441,
                        0.50496906042099,
                        0.056789372116327286,
                        0.9180102944374084,
                        0.07879525423049927,
                        0.7611804008483887,
                        0.8569110631942749,
                        0.059324610978364944,
                        0.9413345456123352,
                        0.2665551006793976,
                        0.23177161812782288,
                        0.5778825283050537,
                        0.0047155460342764854,
                        0.7431801557540894
                    ]
                },
                "test": {
                    "score": -5.692015731768031,
                    "pretrain_loss": 0.7548350691795349,
                    "pretrain_component": 0.6956483125686646,
                    "supervised_component": 0.37741753458976746,
                    "features_accuracy": [
                        0.2430020272731781,
                        0.15207910537719727,
                        0.6902129650115967,
                        0.24462474882602692,
                        0.21359026432037354,
                        0.23909735679626465,
                        0.4651622772216797,
                        0.681643009185791,
                        0.19391480088233948,
                        0.7635395526885986,
                        0.5396551489830017,
                        0.24290060997009277,
                        0.7608519196510315,
                        0.5191683769226074,
                        0.738387405872345,
                        0.33027383685112,
                        0.2618154287338257,
                        0.6996957659721375,
                        0.23316429555416107,
                        0.6154665350914001,
                        0.2612576186656952,
                        0.23047667741775513,
                        0.4320486783981323,
                        0.815010130405426,
                        0.23706896603107452,
                        0.2664300203323364,
                        0.7006085515022278,
                        0.23397566378116608,
                        0.21881338953971863,
                        0.01115618646144867,
                        0.049949292093515396,
                        0.9966024160385132,
                        0.1063387393951416,
                        0.9252535700798035,
                        0.0649087205529213,
                        0.9312373399734497,
                        0.13220080733299255,
                        0.9407200813293457,
                        0.5053752660751343,
                        0.05385395511984825,
                        0.9163793325424194,
                        0.0789046660065651,
                        0.761612594127655,
                        0.8588742613792419,
                        0.057555779814720154,
                        0.9398072957992554,
                        0.2763184607028961,
                        0.22733265161514282,
                        0.5728194713592529,
                        0.0042089251801371574,
                        0.7408214807510376
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -4.2227179248718425,
                    "pretrain_loss": 0.7028417587280273,
                    "pretrain_component": 0.6957047581672668,
                    "supervised_component": 0.35142087936401367,
                    "features_accuracy": [
                        0.2504281997680664,
                        0.1497671902179718,
                        0.7007764577865601,
                        0.23950444161891937,
                        0.2170352339744568,
                        0.2421497404575348,
                        0.45862674713134766,
                        0.6609256863594055,
                        0.1965833157300949,
                        0.760749340057373,
                        0.3689846396446228,
                        0.2452264130115509,
                        0.7633565664291382,
                        0.5362666249275208,
                        0.7250663042068481,
                        0.31088316440582275,
                        0.25988659262657166,
                        0.6641989946365356,
                        0.2384387105703354,
                        0.6629810333251953,
                        0.258643239736557,
                        0.2353556901216507,
                        0.4721704125404358,
                        0.8158121705055237,
                        0.23322422802448273,
                        0.2512274980545044,
                        0.7212284207344055,
                        0.23554600775241852,
                        0.223721444606781,
                        0.009528160095214844,
                        0.0549042746424675,
                        0.9966632723808289,
                        0.10602773725986481,
                        0.9196450114250183,
                        0.06426115334033966,
                        0.936309814453125,
                        0.10187264531850815,
                        0.9427676200866699,
                        0.5242517590522766,
                        0.055170707404613495,
                        0.9203174710273743,
                        0.09426026791334152,
                        0.7629125118255615,
                        0.8693462610244751,
                        0.06129232794046402,
                        0.9408200979232788,
                        0.2919473648071289,
                        0.23056623339653015,
                        0.4704132378101349,
                        0.02545071765780449,
                        0.7070313096046448
                    ]
                },
                "val": {
                    "score": -5.431991634923716,
                    "pretrain_loss": 0.6889324188232422,
                    "pretrain_component": 0.6956818699836731,
                    "supervised_component": 0.3444662094116211,
                    "features_accuracy": [
                        0.24693235754966736,
                        0.15246932208538055,
                        0.7090558409690857,
                        0.23881958425045013,
                        0.21676300466060638,
                        0.23831254243850708,
                        0.4507656395435333,
                        0.6614440679550171,
                        0.19546698033809662,
                        0.7634114027023315,
                        0.37313657999038696,
                        0.2423689216375351,
                        0.7650846838951111,
                        0.5319947004318237,
                        0.7318223118782043,
                        0.30691611766815186,
                        0.26412126421928406,
                        0.6674272418022156,
                        0.23851536214351654,
                        0.6683906316757202,
                        0.26133251190185547,
                        0.23790690302848816,
                        0.477132111787796,
                        0.8166007399559021,
                        0.23385050892829895,
                        0.25144508481025696,
                        0.7226954698562622,
                        0.23709562420845032,
                        0.22005881369113922,
                        0.01080012135207653,
                        0.053949903696775436,
                        0.9960957169532776,
                        0.10541526973247528,
                        0.9194300770759583,
                        0.06251901388168335,
                        0.9345908164978027,
                        0.10571949928998947,
                        0.9427035450935364,
                        0.5206875205039978,
                        0.056789372116327286,
                        0.9208498001098633,
                        0.09355034679174423,
                        0.7608761787414551,
                        0.8692322969436646,
                        0.06094716489315033,
                        0.9413345456123352,
                        0.283845454454422,
                        0.23177161812782288,
                        0.4720616340637207,
                        0.02601156011223793,
                        0.7104755640029907
                    ]
                },
                "test": {
                    "score": -5.7212943536342555,
                    "pretrain_loss": 0.7325060963630676,
                    "pretrain_component": 0.6957101225852966,
                    "supervised_component": 0.3662530481815338,
                    "features_accuracy": [
                        0.2432555854320526,
                        0.1516227126121521,
                        0.7076572179794312,
                        0.24371196329593658,
                        0.215415820479393,
                        0.23823529481887817,
                        0.454462468624115,
                        0.6620689630508423,
                        0.19548681378364563,
                        0.7619168162345886,
                        0.36835700273513794,
                        0.2416328638792038,
                        0.7608519196510315,
                        0.5310344696044922,
                        0.7289553880691528,
                        0.3159736394882202,
                        0.2615111470222473,
                        0.6656186580657959,
                        0.23316429555416107,
                        0.6640973687171936,
                        0.2574036419391632,
                        0.23154158890247345,
                        0.4817444384098053,
                        0.8206896781921387,
                        0.23301216959953308,
                        0.25309330224990845,
                        0.7216024398803711,
                        0.2336713969707489,
                        0.2188640981912613,
                        0.00998985767364502,
                        0.05395537614822388,
                        0.9969066977500916,
                        0.10699797421693802,
                        0.9190669655799866,
                        0.06485801190137863,
                        0.9340263605117798,
                        0.10365111380815506,
                        0.9402636885643005,
                        0.5230730175971985,
                        0.053904663771390915,
                        0.9180527329444885,
                        0.09224137663841248,
                        0.761612594127655,
                        0.8680020570755005,
                        0.05912778899073601,
                        0.9398072957992554,
                        0.29011157155036926,
                        0.22758620977401733,
                        0.46947261691093445,
                        0.025557808578014374,
                        0.705070972442627
                    ]
                }
            }
        },
        "train": {
            "score": -4.1488548282032
        },
        "val": {
            "score": -5.403757408577826
        },
        "test": {
            "score": -5.673834406918917
        }
    },
    "best_iteration": 10000,
    "time": "0:10:01"
}
