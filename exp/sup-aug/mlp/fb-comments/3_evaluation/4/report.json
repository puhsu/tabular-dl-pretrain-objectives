{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised___4ef14f031dfb40ae87f285595a8e9a42.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 4,
        "data": {
            "path": "data/fb-comments",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512,
                    512
                ],
                "dropout": 0.18082833482117971
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [],
            "d_num_embedding": null,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 512,
            "lr": 8.194056439959983e-05,
            "weight_decay": 3.400204567783505e-05,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.23819287749543802,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 8.194056439959983e-05,
            "weight_decay": 3.400204567783505e-05,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post",
            "supervised_weight": 1
        },
        "bins": null
    },
    "epoch_size": 308,
    "n_parameters": 619572,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -4.060391897150881,
                    "pretrain_loss": 0.8065792918205261,
                    "pretrain_component": 0.6961041688919067,
                    "supervised_component": 0.40328964591026306,
                    "features_accuracy": [
                        0.762481153011322,
                        0.15767772495746613,
                        0.2637879252433777,
                        0.5553737282752991,
                        0.20628274977207184,
                        0.23895254731178284,
                        0.236776664853096,
                        0.24093809723854065,
                        0.21310217678546906,
                        0.37499842047691345,
                        0.09868813306093216,
                        0.2390350103378296,
                        0.37248000502586365,
                        0.7625762820243835,
                        0.24568314850330353,
                        0.2384069859981537,
                        0.24097616970539093,
                        0.48778849840164185,
                        0.33080223202705383,
                        0.18531064689159393,
                        0.2495337426662445,
                        0.48325279355049133,
                        0.7984623312950134,
                        0.7244763374328613,
                        0.28835687041282654,
                        0.2287963628768921,
                        0.23810884356498718,
                        0.7071835398674011,
                        0.24876616895198822,
                        0.14551059901714325,
                        0.28752586245536804,
                        0.995477020740509,
                        0.7581801414489746,
                        0.06384247541427612,
                        0.06427384167909622,
                        0.7769193053245544,
                        0.8708940744400024,
                        0.05619203671813011,
                        0.9349585771560669,
                        0.9403951168060303,
                        0.09175452589988708,
                        0.8623682260513306,
                        0.31900304555892944,
                        0.8088722229003906,
                        0.9296489357948303,
                        0.1637866497039795,
                        0.28596532344818115,
                        0.2288978546857834,
                        0.24712949991226196,
                        0.047818418592214584,
                        0.5177622437477112
                    ]
                },
                "val": {
                    "score": -5.383598488779573,
                    "pretrain_loss": 0.7758068442344666,
                    "pretrain_component": 0.6961100101470947,
                    "supervised_component": 0.3879034221172333,
                    "features_accuracy": [
                        0.758138120174408,
                        0.15571442246437073,
                        0.2586958706378937,
                        0.5526822805404663,
                        0.2082953006029129,
                        0.24399147927761078,
                        0.2390224039554596,
                        0.2398843914270401,
                        0.21437987685203552,
                        0.37080416083335876,
                        0.09598417580127716,
                        0.2423689216375351,
                        0.3736436367034912,
                        0.76442551612854,
                        0.25043097138404846,
                        0.23724773526191711,
                        0.2448534518480301,
                        0.494067519903183,
                        0.3307473659515381,
                        0.1830950230360031,
                        0.2388702929019928,
                        0.4838758707046509,
                        0.7980934977531433,
                        0.7231010794639587,
                        0.2879525423049927,
                        0.23400263488292694,
                        0.24115200340747833,
                        0.7088530659675598,
                        0.25337186455726624,
                        0.13817057013511658,
                        0.28698915243148804,
                        0.9950308799743652,
                        0.7570226192474365,
                        0.06104857474565506,
                        0.062164079397916794,
                        0.7734002470970154,
                        0.8746576905250549,
                        0.05562315881252289,
                        0.9318526983261108,
                        0.9399147629737854,
                        0.09324611723423004,
                        0.8607646226882935,
                        0.32278671860694885,
                        0.8090963959693909,
                        0.9309907555580139,
                        0.16235674917697906,
                        0.28551870584487915,
                        0.23258289694786072,
                        0.24130411446094513,
                        0.044620219618082047,
                        0.5180001854896545
                    ]
                },
                "test": {
                    "score": -5.68819318573864,
                    "pretrain_loss": 0.796339750289917,
                    "pretrain_component": 0.6961066722869873,
                    "supervised_component": 0.3981698751449585,
                    "features_accuracy": [
                        0.7602941393852234,
                        0.15481744706630707,
                        0.26282960176467896,
                        0.5535497069358826,
                        0.20461460947990417,
                        0.23965516686439514,
                        0.23686613142490387,
                        0.23975659906864166,
                        0.216531440615654,
                        0.3721095323562622,
                        0.09949290007352829,
                        0.23417849838733673,
                        0.37520283460617065,
                        0.7613590359687805,
                        0.24269777536392212,
                        0.2391480803489685,
                        0.23564909398555756,
                        0.49361056089401245,
                        0.32611560821533203,
                        0.18610547482967377,
                        0.23965516686439514,
                        0.49335700273513794,
                        0.7968559861183167,
                        0.7257606387138367,
                        0.28575050830841064,
                        0.22986815869808197,
                        0.23488843441009521,
                        0.7097870111465454,
                        0.25131845474243164,
                        0.13793103396892548,
                        0.2953853905200958,
                        0.9964503049850464,
                        0.757251501083374,
                        0.06607504934072495,
                        0.06546653062105179,
                        0.768306314945221,
                        0.8731744289398193,
                        0.055578093975782394,
                        0.9354462623596191,
                        0.9382352828979492,
                        0.08782961219549179,
                        0.863793134689331,
                        0.3217545747756958,
                        0.8165314197540283,
                        0.93052738904953,
                        0.16348884999752045,
                        0.2833671271800995,
                        0.23255577683448792,
                        0.24046653509140015,
                        0.046450305730104446,
                        0.5150101184844971
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -4.19785667452957,
                    "pretrain_loss": 0.7478405833244324,
                    "pretrain_component": 0.6962965726852417,
                    "supervised_component": 0.3739202916622162,
                    "features_accuracy": [
                        0.7609079480171204,
                        0.16387546062469482,
                        0.2639211416244507,
                        0.48566970229148865,
                        0.20413225889205933,
                        0.23798196017742157,
                        0.2395298182964325,
                        0.23921263217926025,
                        0.21352720260620117,
                        0.28957486152648926,
                        0.07002753019332886,
                        0.25224247574806213,
                        0.3103629946708679,
                        0.76328045129776,
                        0.23557771742343903,
                        0.2382737696170807,
                        0.2567020654678345,
                        0.5621994733810425,
                        0.4604410231113434,
                        0.17228080332279205,
                        0.2529910206794739,
                        0.4918420910835266,
                        0.795030415058136,
                        0.7575965523719788,
                        0.2770397961139679,
                        0.22933557629585266,
                        0.23850849270820618,
                        0.7328499555587769,
                        0.2492038756608963,
                        0.33845266699790955,
                        0.3587777018547058,
                        0.9965046644210815,
                        0.4864119291305542,
                        0.06729976087808609,
                        0.0669318288564682,
                        0.711319625377655,
                        0.9101612567901611,
                        0.055633794516325,
                        0.9301881790161133,
                        0.9355866312980652,
                        0.0796571895480156,
                        0.8896776437759399,
                        0.3515967130661011,
                        0.7574886679649353,
                        0.9295030832290649,
                        0.13433308899402618,
                        0.24972406029701233,
                        0.22944341599941254,
                        0.24607646465301514,
                        0.037884268909692764,
                        0.48108959197998047
                    ]
                },
                "val": {
                    "score": -5.454422552888924,
                    "pretrain_loss": 0.731959879398346,
                    "pretrain_component": 0.6963041424751282,
                    "supervised_component": 0.365979939699173,
                    "features_accuracy": [
                        0.7580366730690002,
                        0.16073420643806458,
                        0.2610282897949219,
                        0.48463642597198486,
                        0.20834600925445557,
                        0.2415069341659546,
                        0.23836323618888855,
                        0.23866747319698334,
                        0.21453198790550232,
                        0.2872426509857178,
                        0.0698712095618248,
                        0.2540310323238373,
                        0.31112462282180786,
                        0.76442551612854,
                        0.23881958425045013,
                        0.23724773526191711,
                        0.26107898354530334,
                        0.5618091225624084,
                        0.4614136517047882,
                        0.17077374458312988,
                        0.2455633282661438,
                        0.49325624108314514,
                        0.794138491153717,
                        0.7576817274093628,
                        0.27943411469459534,
                        0.23075751960277557,
                        0.24160835146903992,
                        0.7340025901794434,
                        0.2495182901620865,
                        0.3291248381137848,
                        0.3572152853012085,
                        0.9954872727394104,
                        0.48610687255859375,
                        0.06475002318620682,
                        0.06540918350219727,
                        0.706774115562439,
                        0.9142581820487976,
                        0.05567386373877525,
                        0.9275428056716919,
                        0.9357569813728333,
                        0.08153331279754639,
                        0.8854071497917175,
                        0.35249972343444824,
                        0.7571240067481995,
                        0.9308386445045471,
                        0.13091978430747986,
                        0.24799714982509613,
                        0.23263360559940338,
                        0.24282526969909668,
                        0.03650745376944542,
                        0.48651251196861267
                    ]
                },
                "test": {
                    "score": -5.709699562415909,
                    "pretrain_loss": 0.7482654452323914,
                    "pretrain_component": 0.6962946057319641,
                    "supervised_component": 0.3741327226161957,
                    "features_accuracy": [
                        0.7601926922798157,
                        0.159584179520607,
                        0.2624746561050415,
                        0.48869168758392334,
                        0.20466531813144684,
                        0.2373732328414917,
                        0.23717038333415985,
                        0.23782961070537567,
                        0.2146044671535492,
                        0.2887931168079376,
                        0.07150101661682129,
                        0.24584178626537323,
                        0.3115618824958801,
                        0.7613590359687805,
                        0.23346856236457825,
                        0.2391480803489685,
                        0.2562880218029022,
                        0.5681541562080383,
                        0.4602434039115906,
                        0.1739858090877533,
                        0.24401623010635376,
                        0.4950811266899109,
                        0.7933570146560669,
                        0.7590770721435547,
                        0.27616631984710693,
                        0.22789046168327332,
                        0.23498985171318054,
                        0.7312373518943787,
                        0.25050708651542664,
                        0.33483773469924927,
                        0.3636409640312195,
                        0.9972109794616699,
                        0.4830121695995331,
                        0.07013184577226639,
                        0.06855984032154083,
                        0.707200825214386,
                        0.9125760793685913,
                        0.05578093230724335,
                        0.9309837818145752,
                        0.9338235259056091,
                        0.07591278105974197,
                        0.889452338218689,
                        0.3509635031223297,
                        0.7606490850448608,
                        0.929411768913269,
                        0.13260649144649506,
                        0.24690669775009155,
                        0.23275862634181976,
                        0.2414807379245758,
                        0.035395536571741104,
                        0.47687625885009766
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -3.9121563704132467,
                    "pretrain_loss": 0.7299984693527222,
                    "pretrain_component": 0.6960396766662598,
                    "supervised_component": 0.3649992346763611,
                    "features_accuracy": [
                        0.7635912895202637,
                        0.17502126097679138,
                        0.2798817455768585,
                        0.5136388540267944,
                        0.20607341825962067,
                        0.23892717063426971,
                        0.2410522848367691,
                        0.23815958201885223,
                        0.20191198587417603,
                        0.2892005741596222,
                        0.08609599620103836,
                        0.2572539746761322,
                        0.30968421697616577,
                        0.7619546055793762,
                        0.23907941579818726,
                        0.23693525791168213,
                        0.3274971842765808,
                        0.5371040105819702,
                        0.44922545552253723,
                        0.17111356556415558,
                        0.2486075758934021,
                        0.5494170188903809,
                        0.7947893142700195,
                        0.7240386605262756,
                        0.29315266013145447,
                        0.22894226014614105,
                        0.24361512064933777,
                        0.6995775103569031,
                        0.2579200565814972,
                        0.40822646021842957,
                        0.4085436463356018,
                        0.9964412450790405,
                        0.44875600934028625,
                        0.08244205266237259,
                        0.06455296277999878,
                        0.7108628749847412,
                        0.9122229814529419,
                        0.056369658559560776,
                        0.9310445785522461,
                        0.9350664615631104,
                        0.0914183184504509,
                        0.87493497133255,
                        0.3289816081523895,
                        0.7263921499252319,
                        0.9327256083488464,
                        0.12989889085292816,
                        0.2899681627750397,
                        0.2292594462633133,
                        0.24733249843120575,
                        0.030614446848630905,
                        0.6046194434165955
                    ]
                },
                "val": {
                    "score": -5.40493005458541,
                    "pretrain_loss": 0.7048365473747253,
                    "pretrain_component": 0.6960507035255432,
                    "supervised_component": 0.35241827368736267,
                    "features_accuracy": [
                        0.7579352855682373,
                        0.17275123298168182,
                        0.2710678279399872,
                        0.5151100158691406,
                        0.2085995227098465,
                        0.24318020045757294,
                        0.23897169530391693,
                        0.23719702661037445,
                        0.202768474817276,
                        0.28683704137802124,
                        0.08635026961565018,
                        0.25687047839164734,
                        0.30924853682518005,
                        0.76442551612854,
                        0.24054354429244995,
                        0.23724773526191711,
                        0.33018961548805237,
                        0.5384849309921265,
                        0.4488895535469055,
                        0.17239630222320557,
                        0.23912382125854492,
                        0.5498934984207153,
                        0.7947976589202881,
                        0.7239123582839966,
                        0.2960653007030487,
                        0.23141668736934662,
                        0.24733799695968628,
                        0.7044417262077332,
                        0.261281818151474,
                        0.4025960862636566,
                        0.41025251150131226,
                        0.9956900477409363,
                        0.44726699590682983,
                        0.07798397541046143,
                        0.0631781741976738,
                        0.713061511516571,
                        0.9172497391700745,
                        0.05562315881252289,
                        0.9279484748840332,
                        0.9344386458396912,
                        0.09040664881467819,
                        0.8722745776176453,
                        0.3259304165840149,
                        0.7251293063163757,
                        0.9341344237327576,
                        0.1286887675523758,
                        0.2878004312515259,
                        0.23263360559940338,
                        0.24358583986759186,
                        0.027989046648144722,
                        0.6074434518814087
                    ]
                },
                "test": {
                    "score": -5.676530312340119,
                    "pretrain_loss": 0.7280921339988708,
                    "pretrain_component": 0.696038544178009,
                    "supervised_component": 0.3640460669994354,
                    "features_accuracy": [
                        0.7603955268859863,
                        0.17003042995929718,
                        0.2724645137786865,
                        0.5146551728248596,
                        0.20461460947990417,
                        0.2379310429096222,
                        0.2379310429096222,
                        0.23701825737953186,
                        0.20628803968429565,
                        0.2914300262928009,
                        0.08696754276752472,
                        0.2484786957502365,
                        0.3116125762462616,
                        0.7613590359687805,
                        0.23427991569042206,
                        0.2391480803489685,
                        0.32499998807907104,
                        0.5420385599136353,
                        0.4534989893436432,
                        0.17505070567131042,
                        0.23904664814472198,
                        0.557251513004303,
                        0.7941683530807495,
                        0.7264198660850525,
                        0.29153144359588623,
                        0.2281947284936905,
                        0.24264706671237946,
                        0.6962474584579468,
                        0.25882354378700256,
                        0.4102941155433655,
                        0.4134381413459778,
                        0.9972109794616699,
                        0.442241370677948,
                        0.08605476468801498,
                        0.06648073345422745,
                        0.7037525177001953,
                        0.9147565960884094,
                        0.05562880262732506,
                        0.9316937327384949,
                        0.9318965673446655,
                        0.0871196761727333,
                        0.8776876330375671,
                        0.3276876211166382,
                        0.7293610572814941,
                        0.9323022365570068,
                        0.12956389784812927,
                        0.28777891397476196,
                        0.23275862634181976,
                        0.24279919266700745,
                        0.028093306347727776,
                        0.602789044380188
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -4.219971713067887,
                    "pretrain_loss": 0.7056752443313599,
                    "pretrain_component": 0.6958718299865723,
                    "supervised_component": 0.35283762216567993,
                    "features_accuracy": [
                        0.7613202333450317,
                        0.17717809975147247,
                        0.2798944413661957,
                        0.5921034216880798,
                        0.20545174181461334,
                        0.23907306790351868,
                        0.23775993287563324,
                        0.23687182366847992,
                        0.2113640159368515,
                        0.3105659782886505,
                        0.13832324743270874,
                        0.28918156027793884,
                        0.32291072607040405,
                        0.7633819580078125,
                        0.23977087438106537,
                        0.23765209317207336,
                        0.35627833008766174,
                        0.5697293877601624,
                        0.5169438719749451,
                        0.1721348911523819,
                        0.2531432807445526,
                        0.5757749080657959,
                        0.7909324169158936,
                        0.6682398915290833,
                        0.27384260296821594,
                        0.22499017417430878,
                        0.28355473279953003,
                        0.7146437168121338,
                        0.2603369653224945,
                        0.35343635082244873,
                        0.46518605947494507,
                        0.9966315627098083,
                        0.5461056232452393,
                        0.07610474526882172,
                        0.06745201349258423,
                        0.6554955244064331,
                        0.915160059928894,
                        0.05634428188204765,
                        0.9337406158447266,
                        0.9386252164840698,
                        0.08879204094409943,
                        0.8763115406036377,
                        0.3339042663574219,
                        0.8037846088409424,
                        0.9329223036766052,
                        0.13436481356620789,
                        0.3436037003993988,
                        0.22919601202011108,
                        0.24094444513320923,
                        0.03762417659163475,
                        0.5270112752914429
                    ]
                },
                "val": {
                    "score": -5.458173370092226,
                    "pretrain_loss": 0.6939389705657959,
                    "pretrain_component": 0.6958748698234558,
                    "supervised_component": 0.34696948528289795,
                    "features_accuracy": [
                        0.7577324509620667,
                        0.1742216795682907,
                        0.27390730381011963,
                        0.5901530981063843,
                        0.20834600925445557,
                        0.24094918370246887,
                        0.23775479197502136,
                        0.2375519722700119,
                        0.2166108787059784,
                        0.302200585603714,
                        0.13751140236854553,
                        0.29190751910209656,
                        0.32263460755348206,
                        0.76442551612854,
                        0.24196328222751617,
                        0.23724773526191711,
                        0.35609978437423706,
                        0.5667275190353394,
                        0.5180001854896545,
                        0.17224419116973877,
                        0.24505627155303955,
                        0.5761078596115112,
                        0.7902849316596985,
                        0.6677314639091492,
                        0.2758340835571289,
                        0.22801946103572845,
                        0.28247642517089844,
                        0.7196531891822815,
                        0.2605212330818176,
                        0.34464049339294434,
                        0.4656221270561218,
                        0.9958928823471069,
                        0.5474089980125427,
                        0.07149375975131989,
                        0.06510495394468307,
                        0.655815839767456,
                        0.9198864102363586,
                        0.05562315881252289,
                        0.9312442541122437,
                        0.938697874546051,
                        0.08807422965765,
                        0.8729844689369202,
                        0.3360713720321655,
                        0.803316056728363,
                        0.9343372583389282,
                        0.13051414489746094,
                        0.3413446843624115,
                        0.23263360559940338,
                        0.23745055496692657,
                        0.034884899854660034,
                        0.5290031433105469
                    ]
                },
                "test": {
                    "score": -5.708705590148311,
                    "pretrain_loss": 0.714996337890625,
                    "pretrain_component": 0.6958593130111694,
                    "supervised_component": 0.3574981689453125,
                    "features_accuracy": [
                        0.7600405812263489,
                        0.1742393523454666,
                        0.27657201886177063,
                        0.593306303024292,
                        0.2045639008283615,
                        0.23666328191757202,
                        0.2368154227733612,
                        0.23727180063724518,
                        0.21805274486541748,
                        0.3109533488750458,
                        0.14041581749916077,
                        0.28301218152046204,
                        0.32525354623794556,
                        0.7613590359687805,
                        0.23630832135677338,
                        0.2391480803489685,
                        0.3552231192588806,
                        0.5712474584579468,
                        0.5158215165138245,
                        0.17474645376205444,
                        0.24442191421985626,
                        0.5805273652076721,
                        0.7891480922698975,
                        0.6691683530807495,
                        0.27383366227149963,
                        0.22413793206214905,
                        0.28286004066467285,
                        0.7153651118278503,
                        0.26156187057495117,
                        0.354716032743454,
                        0.4714502990245819,
                        0.9973630905151367,
                        0.5403650999069214,
                        0.07946247607469559,
                        0.068204864859581,
                        0.6525862216949463,
                        0.9161257743835449,
                        0.055578093975782394,
                        0.9353955388069153,
                        0.9366632699966431,
                        0.08478701859712601,
                        0.8778904676437378,
                        0.33625760674476624,
                        0.808265745639801,
                        0.9330629110336304,
                        0.13245436549186707,
                        0.3455375134944916,
                        0.23265720903873444,
                        0.23727180063724518,
                        0.035598378628492355,
                        0.529462456703186
                    ]
                }
            }
        },
        "train": {
            "score": -4.060391897150881
        },
        "val": {
            "score": -5.383598488779573
        },
        "test": {
            "score": -5.68819318573864
        }
    },
    "best_iteration": 10000,
    "time": "0:10:18"
}
