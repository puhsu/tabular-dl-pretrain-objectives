{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised___4ef14f031dfb40ae87f285595a8e9a42.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 2,
        "data": {
            "path": "data/fb-comments",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512,
                    512
                ],
                "dropout": 0.18082833482117971
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [],
            "d_num_embedding": null,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 512,
            "lr": 8.194056439959983e-05,
            "weight_decay": 3.400204567783505e-05,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.23819287749543802,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 8.194056439959983e-05,
            "weight_decay": 3.400204567783505e-05,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post",
            "supervised_weight": 1
        },
        "bins": null
    },
    "epoch_size": 308,
    "n_parameters": 619572,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -4.166889509187326,
                    "pretrain_loss": 0.79930579662323,
                    "pretrain_component": 0.694687008857727,
                    "supervised_component": 0.399652898311615,
                    "features_accuracy": [
                        0.7614408135414124,
                        0.15500704944133759,
                        0.27145105600357056,
                        0.7626650929450989,
                        0.5412845015525818,
                        0.7610093951225281,
                        0.254069447517395,
                        0.24561971426010132,
                        0.2906215488910675,
                        0.2409571409225464,
                        0.9945889115333557,
                        0.23704944550991058,
                        0.24053211510181427,
                        0.242479607462883,
                        0.6740887761116028,
                        0.2786574363708496,
                        0.23793122172355652,
                        0.23599639534950256,
                        0.7288597822189331,
                        0.2529910206794739,
                        0.3432294428348541,
                        0.2300841212272644,
                        0.2829647660255432,
                        0.17656275629997253,
                        0.7707976698875427,
                        0.2230299860239029,
                        0.2393648773431778,
                        0.7648980617523193,
                        0.7321838736534119,
                        0.9903005957603455,
                        0.8713508248329163,
                        0.9861645102500916,
                        0.756600558757782,
                        0.060454968363046646,
                        0.1238216683268547,
                        0.060296375304460526,
                        0.8500235080718994,
                        0.9193532466888428,
                        0.69530189037323,
                        0.9175072312355042,
                        0.6791954040527344,
                        0.29527145624160767,
                        0.671690821647644,
                        0.8651023507118225,
                        0.9137707948684692,
                        0.057695481926202774,
                        0.5142922401428223,
                        0.39739149808883667,
                        0.3627551794052124,
                        0.6761884689331055,
                        0.2213742882013321
                    ]
                },
                "val": {
                    "score": -5.427007606235121,
                    "pretrain_loss": 0.809413492679596,
                    "pretrain_component": 0.6946919560432434,
                    "supervised_component": 0.404706746339798,
                    "features_accuracy": [
                        0.7590000629425049,
                        0.1519622653722763,
                        0.2735016644001007,
                        0.7627522349357605,
                        0.5419835448265076,
                        0.7628536224365234,
                        0.25377750396728516,
                        0.24617178738117218,
                        0.2897779047489166,
                        0.23511813580989838,
                        0.9936618804931641,
                        0.23709562420845032,
                        0.23826183378696442,
                        0.24130411446094513,
                        0.676300585269928,
                        0.2752256393432617,
                        0.24475204944610596,
                        0.23293782770633698,
                        0.735625147819519,
                        0.2526620030403137,
                        0.3452996611595154,
                        0.22609268128871918,
                        0.28186795115470886,
                        0.17488083243370056,
                        0.7707635760307312,
                        0.22573775053024292,
                        0.24358583986759186,
                        0.7629043459892273,
                        0.7350167036056519,
                        0.9900111556053162,
                        0.8699928522109985,
                        0.986613929271698,
                        0.7523070573806763,
                        0.06211337447166443,
                        0.1286887675523758,
                        0.060693640261888504,
                        0.8548828363418579,
                        0.9206976890563965,
                        0.6976979970932007,
                        0.9181624054908752,
                        0.6769596934318542,
                        0.2921103239059448,
                        0.6709258556365967,
                        0.8671026825904846,
                        0.9168441295623779,
                        0.05841192603111267,
                        0.5122198462486267,
                        0.3995537757873535,
                        0.363198459148407,
                        0.677821695804596,
                        0.22193488478660583
                    ]
                },
                "test": {
                    "score": -5.708253004006286,
                    "pretrain_loss": 0.8066791296005249,
                    "pretrain_component": 0.6946782469749451,
                    "supervised_component": 0.40333956480026245,
                    "features_accuracy": [
                        0.7632859945297241,
                        0.15927991271018982,
                        0.272210955619812,
                        0.759989857673645,
                        0.5414299964904785,
                        0.7641480565071106,
                        0.24893508851528168,
                        0.24345842003822327,
                        0.2907200753688812,
                        0.2364097386598587,
                        0.9944218993186951,
                        0.2384888380765915,
                        0.2408214956521988,
                        0.2482251524925232,
                        0.6793610453605652,
                        0.2703346908092499,
                        0.23580121994018555,
                        0.24077078700065613,
                        0.7334178686141968,
                        0.24893508851528168,
                        0.3492393493652344,
                        0.22718052566051483,
                        0.28367140889167786,
                        0.17499999701976776,
                        0.7712981700897217,
                        0.21866126358509064,
                        0.2328600436449051,
                        0.7649087309837341,
                        0.7326064705848694,
                        0.9895537495613098,
                        0.8753042817115784,
                        0.9864097237586975,
                        0.7586714029312134,
                        0.06044624745845795,
                        0.12489858269691467,
                        0.06171399727463722,
                        0.8475659489631653,
                        0.9208924770355225,
                        0.7019270062446594,
                        0.9175456166267395,
                        0.6791074872016907,
                        0.29107505083084106,
                        0.6731237173080444,
                        0.8679513335227966,
                        0.9152129888534546,
                        0.05806288123130798,
                        0.5165314674377441,
                        0.40005069971084595,
                        0.3555273711681366,
                        0.6700811386108398,
                        0.2207910716533661
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -4.17356626745331,
                    "pretrain_loss": 0.7570534944534302,
                    "pretrain_component": 0.6950061917304993,
                    "supervised_component": 0.3785267472267151,
                    "features_accuracy": [
                        0.7601656913757324,
                        0.2640163004398346,
                        0.2683236300945282,
                        0.7452771663665771,
                        0.4798462390899658,
                        0.7616247534751892,
                        0.2483094185590744,
                        0.28792551159858704,
                        0.2104695588350296,
                        0.24072876572608948,
                        0.9896281361579895,
                        0.23513366281986237,
                        0.24254938960075378,
                        0.23978355526924133,
                        0.5936385989189148,
                        0.28786206245422363,
                        0.24034179747104645,
                        0.2351844161748886,
                        0.7388002872467041,
                        0.21180807054042816,
                        0.24186427891254425,
                        0.228092223405838,
                        0.3823760747909546,
                        0.17838339507579803,
                        0.7687042355537415,
                        0.22348038852214813,
                        0.2390667349100113,
                        0.7652913928031921,
                        0.7682031393051147,
                        0.9891840815544128,
                        0.9094254374504089,
                        0.9809056520462036,
                        0.8653433918952942,
                        0.06301780045032501,
                        0.08077367395162582,
                        0.06112739443778992,
                        0.7126708030700684,
                        0.8767175674438477,
                        0.5455727577209473,
                        0.9311714172363281,
                        0.5895723104476929,
                        0.5301513671875,
                        0.6467222571372986,
                        0.8535061478614807,
                        0.8881868720054626,
                        0.0586470291018486,
                        0.3500361740589142,
                        0.3480061888694763,
                        0.33464646339416504,
                        0.44710034132003784,
                        0.22168512642383575
                    ]
                },
                "val": {
                    "score": -5.445567053761496,
                    "pretrain_loss": 0.7668014168739319,
                    "pretrain_component": 0.6949968934059143,
                    "supervised_component": 0.38340070843696594,
                    "features_accuracy": [
                        0.7590000629425049,
                        0.26427340507507324,
                        0.267670601606369,
                        0.7439914345741272,
                        0.48113781213760376,
                        0.7622451782226562,
                        0.24738869071006775,
                        0.28714126348495483,
                        0.20322482287883759,
                        0.23440827429294586,
                        0.9889463186264038,
                        0.23709562420845032,
                        0.23963086307048798,
                        0.23947875201702118,
                        0.5913193225860596,
                        0.285265177488327,
                        0.2458675503730774,
                        0.23298853635787964,
                        0.7439914345741272,
                        0.21437987685203552,
                        0.24723657965660095,
                        0.22583915293216705,
                        0.3783084750175476,
                        0.17472872138023376,
                        0.769495964050293,
                        0.22568704187870026,
                        0.2464253008365631,
                        0.7628029584884644,
                        0.772284746170044,
                        0.9883378744125366,
                        0.9082242846488953,
                        0.9808842539787292,
                        0.8647702932357788,
                        0.06353310495615005,
                        0.08482912182807922,
                        0.06297535449266434,
                        0.713670015335083,
                        0.8751647472381592,
                        0.5503498315811157,
                        0.9311935901641846,
                        0.588226318359375,
                        0.5248453617095947,
                        0.6511510014533997,
                        0.8575195074081421,
                        0.8914409875869751,
                        0.0585133321583271,
                        0.35468003153800964,
                        0.3483419418334961,
                        0.33328261971473694,
                        0.4499036371707916,
                        0.22193488478660583
                    ]
                },
                "test": {
                    "score": -5.706987725370508,
                    "pretrain_loss": 0.7737923264503479,
                    "pretrain_component": 0.6949889659881592,
                    "supervised_component": 0.38689616322517395,
                    "features_accuracy": [
                        0.7632859945297241,
                        0.2701318562030792,
                        0.2688134014606476,
                        0.7422921061515808,
                        0.47591277956962585,
                        0.7633874416351318,
                        0.2443711906671524,
                        0.2893509268760681,
                        0.20633874833583832,
                        0.23590263724327087,
                        0.9903144240379333,
                        0.2384888380765915,
                        0.24229209125041962,
                        0.24609532952308655,
                        0.5952839851379395,
                        0.284432053565979,
                        0.23717038333415985,
                        0.24077078700065613,
                        0.7429006099700928,
                        0.20775862038135529,
                        0.24771805107593536,
                        0.2269269824028015,
                        0.38438135385513306,
                        0.17530426383018494,
                        0.770588219165802,
                        0.21784989535808563,
                        0.2346348911523819,
                        0.7649087309837341,
                        0.7715517282485962,
                        0.9880324602127075,
                        0.9113083481788635,
                        0.9821500778198242,
                        0.8698782920837402,
                        0.06252535432577133,
                        0.08042596280574799,
                        0.06379310041666031,
                        0.7089249491691589,
                        0.8792596459388733,
                        0.5418863892555237,
                        0.9323022365570068,
                        0.5897058844566345,
                        0.5331643223762512,
                        0.649442195892334,
                        0.8562880158424377,
                        0.8889959454536438,
                        0.05806288123130798,
                        0.3538539707660675,
                        0.3440162241458893,
                        0.32773834466934204,
                        0.4375760555267334,
                        0.2207910716533661
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -4.2463528546350275,
                    "pretrain_loss": 0.7415998578071594,
                    "pretrain_component": 0.6951441764831543,
                    "supervised_component": 0.3707999289035797,
                    "features_accuracy": [
                        0.7625889778137207,
                        0.16296832263469696,
                        0.2664586007595062,
                        0.7394727468490601,
                        0.569037914276123,
                        0.7619228959083557,
                        0.2540757954120636,
                        0.29643234610557556,
                        0.2076910436153412,
                        0.23911114037036896,
                        0.9902878999710083,
                        0.2386670708656311,
                        0.24438904225826263,
                        0.2384387105703354,
                        0.622134268283844,
                        0.28380846977233887,
                        0.24041792750358582,
                        0.23764574527740479,
                        0.7340108752250671,
                        0.26489171385765076,
                        0.24473795294761658,
                        0.22645555436611176,
                        0.4154645502567291,
                        0.1764422357082367,
                        0.7698017358779907,
                        0.223987877368927,
                        0.24149633944034576,
                        0.7652279138565063,
                        0.7747116684913635,
                        0.9870907068252563,
                        0.9347492456436157,
                        0.9696773886680603,
                        0.875277578830719,
                        0.06108298897743225,
                        0.0972164124250412,
                        0.062377091497182846,
                        0.5174514055252075,
                        0.7956520915031433,
                        0.4614686965942383,
                        0.9330047369003296,
                        0.6822593808174133,
                        0.3964589834213257,
                        0.6805973052978516,
                        0.8803842067718506,
                        0.8072038888931274,
                        0.05793653801083565,
                        0.3678554594516754,
                        0.3520851731300354,
                        0.30936703085899353,
                        0.47284919023513794,
                        0.2219388782978058
                    ]
                },
                "val": {
                    "score": -5.449582832985589,
                    "pretrain_loss": 0.7423544526100159,
                    "pretrain_component": 0.6951455473899841,
                    "supervised_component": 0.37117722630500793,
                    "features_accuracy": [
                        0.7588986754417419,
                        0.1606834977865219,
                        0.26777201890945435,
                        0.7392252087593079,
                        0.5678430199623108,
                        0.7632085680961609,
                        0.2523577809333801,
                        0.2924652695655823,
                        0.20322482287883759,
                        0.23339417576789856,
                        0.9904674887657166,
                        0.23709562420845032,
                        0.2390224039554596,
                        0.23937733471393585,
                        0.6207787990570068,
                        0.2818172574043274,
                        0.24510698020458221,
                        0.23293782770633698,
                        0.7375012636184692,
                        0.2642226815223694,
                        0.24444781243801117,
                        0.22609268128871918,
                        0.4106581509113312,
                        0.1743737906217575,
                        0.768634021282196,
                        0.22512929141521454,
                        0.24850420653820038,
                        0.7628536224365234,
                        0.7787242531776428,
                        0.9869181513786316,
                        0.9369739294052124,
                        0.9708446860313416,
                        0.8764323592185974,
                        0.06231619417667389,
                        0.1013081818819046,
                        0.06343170255422592,
                        0.5158199071884155,
                        0.7938849925994873,
                        0.4600953161716461,
                        0.930280864238739,
                        0.6800526976585388,
                        0.3969171345233917,
                        0.6807625889778137,
                        0.8837845921516418,
                        0.8113781213760376,
                        0.05861474201083183,
                        0.37110838294029236,
                        0.3507757782936096,
                        0.30651047825813293,
                        0.47926172614097595,
                        0.22193488478660583
                    ]
                },
                "test": {
                    "score": -5.764084847702663,
                    "pretrain_loss": 0.7580223679542542,
                    "pretrain_component": 0.6951384544372559,
                    "supervised_component": 0.3790111839771271,
                    "features_accuracy": [
                        0.763336718082428,
                        0.16855983436107635,
                        0.2663286030292511,
                        0.7358519434928894,
                        0.5675963759422302,
                        0.7627789378166199,
                        0.24787017703056335,
                        0.29781946539878845,
                        0.20765720307826996,
                        0.23569980263710022,
                        0.9915821552276611,
                        0.2384888380765915,
                        0.2414807379245758,
                        0.2454868108034134,
                        0.6273833513259888,
                        0.2767241299152374,
                        0.23646044731140137,
                        0.2408214956521988,
                        0.7369675636291504,
                        0.2596348822116852,
                        0.24665313959121704,
                        0.22728194296360016,
                        0.4195740520954132,
                        0.1743914783000946,
                        0.7697261571884155,
                        0.21891480684280396,
                        0.23823529481887817,
                        0.7649087309837341,
                        0.7771298289299011,
                        0.9865618944168091,
                        0.9370182752609253,
                        0.9712981581687927,
                        0.8768255710601807,
                        0.06085192784667015,
                        0.09852941334247589,
                        0.06440162658691406,
                        0.5144016146659851,
                        0.7968052625656128,
                        0.45715010166168213,
                        0.9324543476104736,
                        0.6878803372383118,
                        0.4001014232635498,
                        0.6809330582618713,
                        0.8831136226654053,
                        0.807251513004303,
                        0.05821501091122627,
                        0.36972618103027344,
                        0.3486815392971039,
                        0.30182555317878723,
                        0.4680020213127136,
                        0.22089248895645142
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -4.190959156493627,
                    "pretrain_loss": 0.6958458423614502,
                    "pretrain_component": 0.6953424215316772,
                    "supervised_component": 0.3479229211807251,
                    "features_accuracy": [
                        0.761478841304779,
                        0.18400385975837708,
                        0.2612060606479645,
                        0.7326279282569885,
                        0.5531661510467529,
                        0.7620497941970825,
                        0.24557530879974365,
                        0.24749109148979187,
                        0.20765931904315948,
                        0.24007536470890045,
                        0.9938086271286011,
                        0.23834355175495148,
                        0.2459939867258072,
                        0.24086833000183105,
                        0.5667605400085449,
                        0.3020274341106415,
                        0.2397899031639099,
                        0.23680204153060913,
                        0.7409190535545349,
                        0.22240830957889557,
                        0.2402212768793106,
                        0.22966544330120087,
                        0.4549283981323242,
                        0.1750149130821228,
                        0.7679240107536316,
                        0.22457782924175262,
                        0.24331063032150269,
                        0.7662556171417236,
                        0.7738997340202332,
                        0.987128734588623,
                        0.9330935478210449,
                        0.9847689270973206,
                        0.878671407699585,
                        0.0621931254863739,
                        0.08489704132080078,
                        0.06145726516842842,
                        0.4412451386451721,
                        0.72545325756073,
                        0.3703485131263733,
                        0.9389424324035645,
                        0.7169845104217529,
                        0.3623872399330139,
                        0.6070300340652466,
                        0.8788934350013733,
                        0.6866745352745056,
                        0.05865337327122688,
                        0.4364810585975647,
                        0.40968549251556396,
                        0.30452683568000793,
                        0.44994863867759705,
                        0.22052423655986786
                    ]
                },
                "val": {
                    "score": -5.491576572884484,
                    "pretrain_loss": 0.7259895205497742,
                    "pretrain_component": 0.6953362822532654,
                    "supervised_component": 0.3629947602748871,
                    "features_accuracy": [
                        0.7588986754417419,
                        0.18289220333099365,
                        0.26224520802497864,
                        0.7341040372848511,
                        0.5554203391075134,
                        0.7634114027023315,
                        0.2460196614265442,
                        0.24845349788665771,
                        0.2016022652387619,
                        0.23364770412445068,
                        0.9939661026000977,
                        0.23709562420845032,
                        0.24399147927761078,
                        0.23952944576740265,
                        0.5628232359886169,
                        0.3009836673736572,
                        0.2460196614265442,
                        0.23293782770633698,
                        0.7448534369468689,
                        0.22244194149971008,
                        0.24394077062606812,
                        0.22629550099372864,
                        0.4526924192905426,
                        0.17488083243370056,
                        0.767315685749054,
                        0.22761382162570953,
                        0.24708446860313416,
                        0.7629550695419312,
                        0.7766453623771667,
                        0.9869688153266907,
                        0.9345908164978027,
                        0.9839772582054138,
                        0.8766859173774719,
                        0.062468308955430984,
                        0.08847986906766891,
                        0.062366899102926254,
                        0.4378359019756317,
                        0.7264983057975769,
                        0.37227460741996765,
                        0.9381908178329468,
                        0.715850293636322,
                        0.36279281973838806,
                        0.6089645624160767,
                        0.8803873658180237,
                        0.686137318611145,
                        0.059121791273355484,
                        0.44214582443237305,
                        0.4113680124282837,
                        0.30209916830062866,
                        0.4563431441783905,
                        0.22193488478660583
                    ]
                },
                "test": {
                    "score": -5.765299595454505,
                    "pretrain_loss": 0.7394052743911743,
                    "pretrain_component": 0.6953317523002625,
                    "supervised_component": 0.36970263719558716,
                    "features_accuracy": [
                        0.7632352709770203,
                        0.18772819638252258,
                        0.26156187057495117,
                        0.7290567755699158,
                        0.551673412322998,
                        0.7634888291358948,
                        0.24072007834911346,
                        0.24584178626537323,
                        0.20436105132102966,
                        0.23529411852359772,
                        0.9945233464241028,
                        0.2384888380765915,
                        0.24639959633350372,
                        0.24579107761383057,
                        0.56947261095047,
                        0.29482758045196533,
                        0.23772819340229034,
                        0.24077078700065613,
                        0.7441683411598206,
                        0.21764706075191498,
                        0.24497972428798676,
                        0.22712981700897217,
                        0.4607505202293396,
                        0.17525355517864227,
                        0.7695233225822449,
                        0.21992900967597961,
                        0.23646044731140137,
                        0.7649087309837341,
                        0.7748478651046753,
                        0.9863590598106384,
                        0.9361562132835388,
                        0.9867647290229797,
                        0.8790568113327026,
                        0.061054766178131104,
                        0.08448275923728943,
                        0.0639452338218689,
                        0.4334685504436493,
                        0.7270284295082092,
                        0.36475658416748047,
                        0.9397565722465515,
                        0.7236308455467224,
                        0.3649594485759735,
                        0.6073529720306396,
                        0.8829614520072937,
                        0.68215012550354,
                        0.05862069129943848,
                        0.4429513216018677,
                        0.41054767370224,
                        0.29934078454971313,
                        0.4418357014656067,
                        0.2206389456987381
                    ]
                }
            }
        },
        "train": {
            "score": -4.166889509187326
        },
        "val": {
            "score": -5.427007606235121
        },
        "test": {
            "score": -5.708253004006286
        }
    },
    "best_iteration": 10000,
    "time": "0:09:03"
}
