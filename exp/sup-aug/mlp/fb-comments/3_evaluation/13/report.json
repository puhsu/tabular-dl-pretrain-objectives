{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised___4ef14f031dfb40ae87f285595a8e9a42.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 13,
        "data": {
            "path": "data/fb-comments",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512,
                    512
                ],
                "dropout": 0.18082833482117971
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [],
            "d_num_embedding": null,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 512,
            "lr": 8.194056439959983e-05,
            "weight_decay": 3.400204567783505e-05,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.23819287749543802,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 8.194056439959983e-05,
            "weight_decay": 3.400204567783505e-05,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post",
            "supervised_weight": 1
        },
        "bins": null
    },
    "epoch_size": 308,
    "n_parameters": 619572,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -4.324515028061553,
                    "pretrain_loss": 0.7951672673225403,
                    "pretrain_component": 0.6950864791870117,
                    "supervised_component": 0.39758363366127014,
                    "features_accuracy": [
                        0.6817265152931213,
                        0.15165124833583832,
                        0.7613202333450317,
                        0.29431354999542236,
                        0.20929598808288574,
                        0.7625826597213745,
                        0.2353874146938324,
                        0.7199913859367371,
                        0.7500349283218384,
                        0.6442482471466064,
                        0.6640086770057678,
                        0.2369733303785324,
                        0.23678936064243317,
                        0.6078610420227051,
                        0.22948147356510162,
                        0.2421814650297165,
                        0.6874358057975769,
                        0.2784290611743927,
                        0.24775752425193787,
                        0.18387064337730408,
                        0.33950570225715637,
                        0.36456310749053955,
                        0.7327484488487244,
                        0.33752650022506714,
                        0.243799090385437,
                        0.7198708653450012,
                        0.7614725232124329,
                        0.7550146579742432,
                        0.7711973190307617,
                        0.009889747947454453,
                        0.8732666373252869,
                        0.028254609555006027,
                        0.5999568700790405,
                        0.16273361444473267,
                        0.7036311030387878,
                        0.4715677797794342,
                        0.06472424417734146,
                        0.0731930136680603,
                        0.10165061801671982,
                        0.9437509179115295,
                        0.13109149038791656,
                        0.7816389799118042,
                        0.24240349233150482,
                        0.06304317712783813,
                        0.8092718720436096,
                        0.5998109579086304,
                        0.48533985018730164,
                        0.7705693244934082,
                        0.23888276517391205,
                        0.995673656463623,
                        0.7636483907699585
                    ]
                },
                "val": {
                    "score": -5.421464368008155,
                    "pretrain_loss": 0.7436650395393372,
                    "pretrain_component": 0.695085883140564,
                    "supervised_component": 0.3718325197696686,
                    "features_accuracy": [
                        0.6792921423912048,
                        0.14968055486679077,
                        0.7563634514808655,
                        0.2922624349594116,
                        0.20870094001293182,
                        0.7650846838951111,
                        0.2377040833234787,
                        0.7202109098434448,
                        0.7500760555267334,
                        0.6406551003456116,
                        0.6658046841621399,
                        0.23354628682136536,
                        0.24125342071056366,
                        0.606480062007904,
                        0.2330392450094223,
                        0.23892100155353546,
                        0.6827400922775269,
                        0.27542844414711,
                        0.25144508481025696,
                        0.18497109413146973,
                        0.33586856722831726,
                        0.3625899851322174,
                        0.7333434820175171,
                        0.333941787481308,
                        0.24982252717018127,
                        0.7169150710105896,
                        0.7597606778144836,
                        0.7573268413543701,
                        0.7681776285171509,
                        0.010495892725884914,
                        0.8730858564376831,
                        0.026366492733359337,
                        0.600851833820343,
                        0.16124124825000763,
                        0.700943112373352,
                        0.46836018562316895,
                        0.0640401542186737,
                        0.07529661804437637,
                        0.09684615582227707,
                        0.9455430507659912,
                        0.13137611746788025,
                        0.779434084892273,
                        0.2483520805835724,
                        0.060795050114393234,
                        0.8111752867698669,
                        0.5965419411659241,
                        0.48118850588798523,
                        0.7720819115638733,
                        0.24145624041557312,
                        0.9950816035270691,
                        0.7676199078559875
                    ]
                },
                "test": {
                    "score": -5.67420686789805,
                    "pretrain_loss": 0.7682608366012573,
                    "pretrain_component": 0.6950960755348206,
                    "supervised_component": 0.38413041830062866,
                    "features_accuracy": [
                        0.6767241358757019,
                        0.15664300322532654,
                        0.7604462504386902,
                        0.2952839732170105,
                        0.20750507712364197,
                        0.7659229040145874,
                        0.23686613142490387,
                        0.7211967706680298,
                        0.7482251524925232,
                        0.6439148187637329,
                        0.6730223298072815,
                        0.23382353782653809,
                        0.23717038333415985,
                        0.6148580312728882,
                        0.23062880337238312,
                        0.23782961070537567,
                        0.6839756369590759,
                        0.2779918909072876,
                        0.24386410415172577,
                        0.1862068921327591,
                        0.341379314661026,
                        0.35816431045532227,
                        0.73164302110672,
                        0.33666327595710754,
                        0.2471095323562622,
                        0.7180527448654175,
                        0.7591785192489624,
                        0.757251501083374,
                        0.7727687954902649,
                        0.009685598313808441,
                        0.876115620136261,
                        0.026926977559924126,
                        0.5988336801528931,
                        0.16166329383850098,
                        0.7013691663742065,
                        0.46262678503990173,
                        0.06343813240528107,
                        0.07048681378364563,
                        0.09634888172149658,
                        0.9435598254203796,
                        0.13260649144649506,
                        0.7795131802558899,
                        0.24472616612911224,
                        0.06151115521788597,
                        0.8174442052841187,
                        0.5925456285476685,
                        0.4822008013725281,
                        0.7722616791725159,
                        0.23782961070537567,
                        0.9959939122200012,
                        0.7672920823097229
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -4.228845682016164,
                    "pretrain_loss": 0.7404192090034485,
                    "pretrain_component": 0.6950024962425232,
                    "supervised_component": 0.37020960450172424,
                    "features_accuracy": [
                        0.6711389422416687,
                        0.14797194302082062,
                        0.7609205842018127,
                        0.2909514307975769,
                        0.23168271780014038,
                        0.7631282210350037,
                        0.2384069859981537,
                        0.6677831411361694,
                        0.7372143864631653,
                        0.6355637907981873,
                        0.7886042594909668,
                        0.23781703412532806,
                        0.2366117388010025,
                        0.5408594608306885,
                        0.22826984524726868,
                        0.2389652281999588,
                        0.7183991074562073,
                        0.3893541097640991,
                        0.24473795294761658,
                        0.2222306877374649,
                        0.37904566526412964,
                        0.40835967659950256,
                        0.6996092200279236,
                        0.38851672410964966,
                        0.36041438579559326,
                        0.715652346611023,
                        0.7618277668952942,
                        0.753739595413208,
                        0.7699031829833984,
                        0.009483753703534603,
                        0.8760514855384827,
                        0.02664332278072834,
                        0.4471828043460846,
                        0.19283421337604523,
                        0.6788718700408936,
                        0.34123119711875916,
                        0.06379806995391846,
                        0.10214542597532272,
                        0.09832654893398285,
                        0.9434590935707092,
                        0.2167941778898239,
                        0.7976186275482178,
                        0.24350093305110931,
                        0.0626562163233757,
                        0.8485390543937683,
                        0.5036920309066772,
                        0.388675332069397,
                        0.7700490951538086,
                        0.2451629787683487,
                        0.9586774706840515,
                        0.7656022310256958
                    ]
                },
                "val": {
                    "score": -5.430820650508919,
                    "pretrain_loss": 0.7055686116218567,
                    "pretrain_component": 0.6949964165687561,
                    "supervised_component": 0.35278430581092834,
                    "features_accuracy": [
                        0.6697089076042175,
                        0.14679038524627686,
                        0.7568197846412659,
                        0.28962579369544983,
                        0.23106175661087036,
                        0.7650846838951111,
                        0.23765337467193604,
                        0.67148357629776,
                        0.7364364266395569,
                        0.634773313999176,
                        0.7841496467590332,
                        0.23354628682136536,
                        0.24125342071056366,
                        0.538231372833252,
                        0.23359699547290802,
                        0.23400263488292694,
                        0.7194503545761108,
                        0.38991987705230713,
                        0.24931548535823822,
                        0.22117431461811066,
                        0.3802352547645569,
                        0.4119257628917694,
                        0.6985599398612976,
                        0.3828718960285187,
                        0.36264070868492126,
                        0.7170672416687012,
                        0.7585437297821045,
                        0.755247950553894,
                        0.765946626663208,
                        0.010191664099693298,
                        0.8771929740905762,
                        0.025048168376088142,
                        0.45639386773109436,
                        0.19394584000110626,
                        0.6772132515907288,
                        0.33749112486839294,
                        0.06378663331270218,
                        0.1037927195429802,
                        0.09567994624376297,
                        0.9456444382667542,
                        0.21458269655704498,
                        0.7988540530204773,
                        0.2516986131668091,
                        0.0608457550406456,
                        0.8523476123809814,
                        0.49994927644729614,
                        0.3914410173892975,
                        0.7723861336708069,
                        0.24241963028907776,
                        0.9595882296562195,
                        0.7693438529968262
                    ]
                },
                "test": {
                    "score": -5.702167219664196,
                    "pretrain_loss": 0.7299317717552185,
                    "pretrain_component": 0.6950093507766724,
                    "supervised_component": 0.36496588587760925,
                    "features_accuracy": [
                        0.6635902523994446,
                        0.1531440168619156,
                        0.7606490850448608,
                        0.29259634017944336,
                        0.23047667741775513,
                        0.7657707929611206,
                        0.23676471412181854,
                        0.6684077382087708,
                        0.7354462742805481,
                        0.6358519196510315,
                        0.7935091257095337,
                        0.23372210562229156,
                        0.23717038333415985,
                        0.5414807200431824,
                        0.2307809293270111,
                        0.2347870171070099,
                        0.7174442410469055,
                        0.39305272698402405,
                        0.238894522190094,
                        0.2214502990245819,
                        0.38098376989364624,
                        0.40101420879364014,
                        0.7028904557228088,
                        0.39290061593055725,
                        0.3633367121219635,
                        0.7206389307975769,
                        0.7587728500366211,
                        0.7546653151512146,
                        0.7694219350814819,
                        0.009026369079947472,
                        0.8805273771286011,
                        0.026369169354438782,
                        0.4439148008823395,
                        0.19558823108673096,
                        0.6772819757461548,
                        0.3385395407676697,
                        0.06247464567422867,
                        0.10076064616441727,
                        0.0956389456987381,
                        0.9436612725257874,
                        0.2210446298122406,
                        0.7940669655799866,
                        0.24797160923480988,
                        0.06156186759471893,
                        0.8552231192588806,
                        0.501724123954773,
                        0.38549697399139404,
                        0.772210955619812,
                        0.24041582643985748,
                        0.9573022127151489,
                        0.7658215165138245
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -4.159106753155967,
                    "pretrain_loss": 0.7384467720985413,
                    "pretrain_component": 0.6953175663948059,
                    "supervised_component": 0.36922338604927063,
                    "features_accuracy": [
                        0.6226925253868103,
                        0.1476166993379593,
                        0.7615232467651367,
                        0.31314149498939514,
                        0.2109326422214508,
                        0.7630647420883179,
                        0.23736663162708282,
                        0.6224895119667053,
                        0.711915910243988,
                        0.5285971760749817,
                        0.8539248108863831,
                        0.2376076877117157,
                        0.2376394122838974,
                        0.4888732433319092,
                        0.2288217395544052,
                        0.23925068974494934,
                        0.6979852914810181,
                        0.3286200165748596,
                        0.24008171260356903,
                        0.17826920747756958,
                        0.392976313829422,
                        0.42619800567626953,
                        0.6295626759529114,
                        0.3930968642234802,
                        0.4970438778400421,
                        0.7170796394348145,
                        0.7583006620407104,
                        0.7206130623817444,
                        0.7566893696784973,
                        0.009445692412555218,
                        0.8782527446746826,
                        0.02107360027730465,
                        0.21433918178081512,
                        0.3074131906032562,
                        0.804095447063446,
                        0.27291008830070496,
                        0.06942488998174667,
                        0.09891650825738907,
                        0.09819333255290985,
                        0.9442774057388306,
                        0.12921376526355743,
                        0.6290298104286194,
                        0.2499333918094635,
                        0.06264986842870712,
                        0.8506895899772644,
                        0.5741382241249084,
                        0.3187239170074463,
                        0.7701061964035034,
                        0.23968206346035004,
                        0.9875854849815369,
                        0.7599500417709351
                    ]
                },
                "val": {
                    "score": -5.45515945412449,
                    "pretrain_loss": 0.6890149712562561,
                    "pretrain_component": 0.6953097581863403,
                    "supervised_component": 0.34450748562812805,
                    "features_accuracy": [
                        0.6239731907844543,
                        0.1451171189546585,
                        0.7563634514808655,
                        0.3148260712623596,
                        0.21088124811649323,
                        0.7648818492889404,
                        0.2378561943769455,
                        0.624176025390625,
                        0.7156981825828552,
                        0.5259608626365662,
                        0.850572943687439,
                        0.23354628682136536,
                        0.24125342071056366,
                        0.4819490909576416,
                        0.23293782770633698,
                        0.2342054545879364,
                        0.6986106634140015,
                        0.32932764291763306,
                        0.24607037007808685,
                        0.17579352855682373,
                        0.39428049325942993,
                        0.4279991686344147,
                        0.6332522034645081,
                        0.39073115587234497,
                        0.49660277366638184,
                        0.7128080129623413,
                        0.7597606778144836,
                        0.7233546376228333,
                        0.753929615020752,
                        0.010394482873380184,
                        0.8806915879249573,
                        0.018608659505844116,
                        0.2187911868095398,
                        0.3056485056877136,
                        0.8023526668548584,
                        0.27243685722351074,
                        0.06900922954082489,
                        0.09988844394683838,
                        0.09466585516929626,
                        0.9446810483932495,
                        0.12909440696239471,
                        0.628384530544281,
                        0.2549944221973419,
                        0.06114998459815979,
                        0.8519419431686401,
                        0.5667275190353394,
                        0.3145725429058075,
                        0.7723861336708069,
                        0.24049285054206848,
                        0.9882871508598328,
                        0.7628029584884644
                    ]
                },
                "test": {
                    "score": -5.703496104800833,
                    "pretrain_loss": 0.7157542109489441,
                    "pretrain_component": 0.695332407951355,
                    "supervised_component": 0.35787710547447205,
                    "features_accuracy": [
                        0.6209939122200012,
                        0.1516227126121521,
                        0.7603448033332825,
                        0.31440162658691406,
                        0.20998986065387726,
                        0.76556795835495,
                        0.23686613142490387,
                        0.6241886615753174,
                        0.7085700035095215,
                        0.5240365266799927,
                        0.8573529720306396,
                        0.23372210562229156,
                        0.23717038333415985,
                        0.4838235378265381,
                        0.23057809472084045,
                        0.23549695312976837,
                        0.6936612725257874,
                        0.3277890384197235,
                        0.2368154227733612,
                        0.17707911133766174,
                        0.39153143763542175,
                        0.4167342782020569,
                        0.6293103694915771,
                        0.39741379022598267,
                        0.5048681497573853,
                        0.7186612486839294,
                        0.7601419687271118,
                        0.7209939360618591,
                        0.7555781006813049,
                        0.009381338953971863,
                        0.8839249610900879,
                        0.020233266055583954,
                        0.2128296196460724,
                        0.3092292249202728,
                        0.8022312521934509,
                        0.26830628514289856,
                        0.06790060549974442,
                        0.09710953384637833,
                        0.09345842152833939,
                        0.94284987449646,
                        0.13067951798439026,
                        0.6180527210235596,
                        0.25187626481056213,
                        0.06186612695455551,
                        0.85502028465271,
                        0.5694218873977661,
                        0.3126774728298187,
                        0.7721602320671082,
                        0.23869168758392334,
                        0.988286018371582,
                        0.7606490850448608
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -4.1110108355145805,
                    "pretrain_loss": 0.7123407125473022,
                    "pretrain_component": 0.6952922940254211,
                    "supervised_component": 0.3561703562736511,
                    "features_accuracy": [
                        0.6277483701705933,
                        0.14424821734428406,
                        0.7604511976242065,
                        0.2984052002429962,
                        0.20726601779460907,
                        0.7633882761001587,
                        0.23829279839992523,
                        0.6698448657989502,
                        0.685627818107605,
                        0.5261802673339844,
                        0.8527702689170837,
                        0.2384323626756668,
                        0.2346261739730835,
                        0.4664928615093231,
                        0.229557603597641,
                        0.23970744013786316,
                        0.7271660566329956,
                        0.3810502588748932,
                        0.24314568936824799,
                        0.1841307282447815,
                        0.3667707145214081,
                        0.4490985870361328,
                        0.6183471083641052,
                        0.4554422199726105,
                        0.5163919925689697,
                        0.7196678519248962,
                        0.763083815574646,
                        0.6619470119476318,
                        0.7240386605262756,
                        0.010752484202384949,
                        0.8808345794677734,
                        0.022171050310134888,
                        0.16423070430755615,
                        0.2940725088119507,
                        0.7304139733314514,
                        0.3154759705066681,
                        0.06920285522937775,
                        0.15925729274749756,
                        0.10863497853279114,
                        0.9421459436416626,
                        0.12195663899183273,
                        0.5256664156913757,
                        0.2464190125465393,
                        0.06332863867282867,
                        0.8567541241645813,
                        0.6149849891662598,
                        0.3486722707748413,
                        0.7708357572555542,
                        0.24133774638175964,
                        0.975063145160675,
                        0.7558774352073669
                    ]
                },
                "val": {
                    "score": -5.440023818697833,
                    "pretrain_loss": 0.6802653670310974,
                    "pretrain_component": 0.6952881217002869,
                    "supervised_component": 0.3401326835155487,
                    "features_accuracy": [
                        0.6241253018379211,
                        0.14521853625774384,
                        0.7550958395004272,
                        0.30022308230400085,
                        0.20996855199337006,
                        0.7646282911300659,
                        0.23775479197502136,
                        0.6729540228843689,
                        0.6868471503257751,
                        0.5220565795898438,
                        0.8497616648674011,
                        0.23354628682136536,
                        0.24125342071056366,
                        0.4628840684890747,
                        0.23359699547290802,
                        0.23633505403995514,
                        0.7283236980438232,
                        0.38464656472206116,
                        0.2464253008365631,
                        0.18294289708137512,
                        0.36370548605918884,
                        0.4511205554008484,
                        0.6161646842956543,
                        0.45451778173446655,
                        0.515566349029541,
                        0.7147855162620544,
                        0.7596085667610168,
                        0.6645877361297607,
                        0.7215292453765869,
                        0.011307169683277607,
                        0.88221275806427,
                        0.02119460515677929,
                        0.1661089062690735,
                        0.2935807704925537,
                        0.7291856408119202,
                        0.31391337513923645,
                        0.0688571110367775,
                        0.16093702614307404,
                        0.10551667958498001,
                        0.9429571032524109,
                        0.12321265041828156,
                        0.5244904160499573,
                        0.24931548535823822,
                        0.0608457550406456,
                        0.8587363958358765,
                        0.6099786758422852,
                        0.3482912480831146,
                        0.7724368572235107,
                        0.24302808940410614,
                        0.9757123589515686,
                        0.7603691220283508
                    ]
                },
                "test": {
                    "score": -5.761573897482894,
                    "pretrain_loss": 0.7084032893180847,
                    "pretrain_component": 0.6953158378601074,
                    "supervised_component": 0.35420164465904236,
                    "features_accuracy": [
                        0.6209939122200012,
                        0.1514705866575241,
                        0.759482741355896,
                        0.2982758581638336,
                        0.20877282321453094,
                        0.7652130126953125,
                        0.23666328191757202,
                        0.6696247458457947,
                        0.6835192441940308,
                        0.5216024518013,
                        0.8568458557128906,
                        0.23372210562229156,
                        0.23717038333415985,
                        0.4614604413509369,
                        0.2311866134405136,
                        0.23620690405368805,
                        0.7258113622665405,
                        0.38453346490859985,
                        0.23808316886425018,
                        0.1815415769815445,
                        0.36409735679626465,
                        0.44132861495018005,
                        0.6163793206214905,
                        0.45527383685112,
                        0.5202332735061646,
                        0.7237322330474854,
                        0.7598884701728821,
                        0.6627281904220581,
                        0.7243914604187012,
                        0.01034482754766941,
                        0.8844320774078369,
                        0.021399594843387604,
                        0.16140973567962646,
                        0.29634889960289,
                        0.7257099151611328,
                        0.30892494320869446,
                        0.06830628961324692,
                        0.15730223059654236,
                        0.10481744259595871,
                        0.9408215284347534,
                        0.12525354325771332,
                        0.5192697644233704,
                        0.24619676172733307,
                        0.0616125762462616,
                        0.8637424111366272,
                        0.612271785736084,
                        0.3478194773197174,
                        0.7721602320671082,
                        0.24001014232635498,
                        0.9759634733200073,
                        0.7575557827949524
                    ]
                }
            }
        },
        "train": {
            "score": -4.324515028061553
        },
        "val": {
            "score": -5.421464368008155
        },
        "test": {
            "score": -5.67420686789805
        }
    },
    "best_iteration": 10000,
    "time": "0:09:47"
}
