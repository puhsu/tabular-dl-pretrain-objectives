{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised___67e33d82bab74a0c9b33cc2251e2e617.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 2,
        "data": {
            "path": "data/churn_roc",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512,
                    512,
                    512,
                    512,
                    512,
                    512,
                    512
                ],
                "dropout": 0.4228273822296654
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear",
                "relu"
            ],
            "d_num_embedding": 107,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.0014612035535130105,
            "weight_decay": 0.0,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.29134550428418404,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.0014612035535130105,
            "weight_decay": 0.0,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post",
            "supervised_weight": 1.0
        },
        "bins": {
            "count": 74,
            "value": "ratio",
            "tree": {
                "min_samples_leaf": 36,
                "min_impurity_decrease": 0.0003378216573667746
            },
            "subsample": null
        }
    },
    "epoch_size": 50,
    "n_parameters": 2404266,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": 0.8872410455451646,
                    "pretrain_loss": 0.851868748664856,
                    "pretrain_component": 0.6982409954071045,
                    "supervised_component": 0.425934374332428,
                    "features_accuracy": [
                        0.2957812547683716,
                        0.21453124284744263,
                        0.578125,
                        0.27796873450279236,
                        0.49687498807907104,
                        0.24265624582767487,
                        0.6829687356948853,
                        0.23609374463558197,
                        0.14953124523162842,
                        0.6596874594688416,
                        0.8126562237739563
                    ]
                },
                "val": {
                    "score": 0.8735384904315667,
                    "pretrain_loss": 0.836329996585846,
                    "pretrain_component": 0.6978855133056641,
                    "supervised_component": 0.418164998292923,
                    "features_accuracy": [
                        0.29249998927116394,
                        0.2381249964237213,
                        0.5981249809265137,
                        0.27437499165534973,
                        0.5062499642372131,
                        0.2318749874830246,
                        0.71875,
                        0.2606250047683716,
                        0.13499999046325684,
                        0.6949999928474426,
                        0.8193749785423279
                    ]
                },
                "test": {
                    "score": 0.8645054916241357,
                    "pretrain_loss": 0.8848530650138855,
                    "pretrain_component": 0.6980404853820801,
                    "supervised_component": 0.44242653250694275,
                    "features_accuracy": [
                        0.2880000174045563,
                        0.21850000321865082,
                        0.5830000042915344,
                        0.28600001335144043,
                        0.5075000524520874,
                        0.2370000183582306,
                        0.6830000281333923,
                        0.24500000476837158,
                        0.15650001168251038,
                        0.6700000166893005,
                        0.8245000243186951
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": 0.8886766717069082,
                    "pretrain_loss": 0.8346745371818542,
                    "pretrain_component": 0.6981097459793091,
                    "supervised_component": 0.4173372685909271,
                    "features_accuracy": [
                        0.30796873569488525,
                        0.2893750071525574,
                        0.625,
                        0.27250000834465027,
                        0.36140623688697815,
                        0.24421875178813934,
                        0.6942187547683716,
                        0.18984374403953552,
                        0.14656250178813934,
                        0.690625011920929,
                        0.69984370470047
                    ]
                },
                "val": {
                    "score": 0.872446571833075,
                    "pretrain_loss": 0.8267285823822021,
                    "pretrain_component": 0.697876513004303,
                    "supervised_component": 0.4133642911911011,
                    "features_accuracy": [
                        0.296875,
                        0.29249998927116394,
                        0.6274999976158142,
                        0.26624998450279236,
                        0.35749998688697815,
                        0.2212499976158142,
                        0.7324999570846558,
                        0.17874999344348907,
                        0.13312499225139618,
                        0.7268750071525574,
                        0.699999988079071
                    ]
                },
                "test": {
                    "score": 0.8625250828640659,
                    "pretrain_loss": 0.8777451515197754,
                    "pretrain_component": 0.6978265047073364,
                    "supervised_component": 0.4388725757598877,
                    "features_accuracy": [
                        0.29200002551078796,
                        0.3060000240802765,
                        0.6415000557899475,
                        0.2775000035762787,
                        0.3675000071525574,
                        0.23350000381469727,
                        0.7005000114440918,
                        0.1980000138282776,
                        0.15450000762939453,
                        0.6915000081062317,
                        0.7110000252723694
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": 0.8859084263129507,
                    "pretrain_loss": 0.8583184480667114,
                    "pretrain_component": 0.6989756226539612,
                    "supervised_component": 0.4291592240333557,
                    "features_accuracy": [
                        0.29234373569488525,
                        0.17781250178813934,
                        0.6503124833106995,
                        0.2645312547683716,
                        0.6057812571525574,
                        0.2018750011920929,
                        0.7024999856948853,
                        0.12656249105930328,
                        0.13984374701976776,
                        0.6706249713897705,
                        0.8206250071525574
                    ]
                },
                "val": {
                    "score": 0.8690540397376506,
                    "pretrain_loss": 0.8515601754188538,
                    "pretrain_component": 0.698792576789856,
                    "supervised_component": 0.4257800877094269,
                    "features_accuracy": [
                        0.2906250059604645,
                        0.17999999225139618,
                        0.6612499952316284,
                        0.2562499940395355,
                        0.6087499856948853,
                        0.19749999046325684,
                        0.7381249666213989,
                        0.125,
                        0.13312499225139618,
                        0.7131249904632568,
                        0.8199999928474426
                    ]
                },
                "test": {
                    "score": 0.8589830199999691,
                    "pretrain_loss": 0.8904028534889221,
                    "pretrain_component": 0.6988377571105957,
                    "supervised_component": 0.44520142674446106,
                    "features_accuracy": [
                        0.2840000092983246,
                        0.1745000034570694,
                        0.6485000252723694,
                        0.27150002121925354,
                        0.596500039100647,
                        0.20400001108646393,
                        0.7065000534057617,
                        0.13650000095367432,
                        0.15450000762939453,
                        0.690000057220459,
                        0.8260000348091125
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": 0.8871189270304628,
                    "pretrain_loss": 0.8498430252075195,
                    "pretrain_component": 0.6973341107368469,
                    "supervised_component": 0.42492151260375977,
                    "features_accuracy": [
                        0.28578123450279236,
                        0.4467187523841858,
                        0.6976562142372131,
                        0.2631250023841858,
                        0.6775000095367432,
                        0.2228124886751175,
                        0.7110937237739563,
                        0.14296874403953552,
                        0.14109374582767487,
                        0.6539062261581421,
                        0.7906249761581421
                    ]
                },
                "val": {
                    "score": 0.8729582205699646,
                    "pretrain_loss": 0.8421299457550049,
                    "pretrain_component": 0.6971640586853027,
                    "supervised_component": 0.42106497287750244,
                    "features_accuracy": [
                        0.2906250059604645,
                        0.4281249940395355,
                        0.6974999904632568,
                        0.2562499940395355,
                        0.7012499570846558,
                        0.20937499403953552,
                        0.7381249666213989,
                        0.15687499940395355,
                        0.13312499225139618,
                        0.6768749952316284,
                        0.8031249642372131
                    ]
                },
                "test": {
                    "score": 0.8633032107608377,
                    "pretrain_loss": 0.8791674971580505,
                    "pretrain_component": 0.6972240805625916,
                    "supervised_component": 0.43958374857902527,
                    "features_accuracy": [
                        0.2840000092983246,
                        0.4130000174045563,
                        0.6895000338554382,
                        0.27150002121925354,
                        0.7020000219345093,
                        0.21850000321865082,
                        0.7065000534057617,
                        0.15800000727176666,
                        0.15450000762939453,
                        0.6525000333786011,
                        0.7980000376701355
                    ]
                }
            }
        },
        "train": {
            "score": 0.8872410455451646
        },
        "val": {
            "score": 0.8735384904315667
        },
        "test": {
            "score": 0.8645054916241357
        }
    },
    "best_iteration": 10000,
    "time": "0:05:37"
}
