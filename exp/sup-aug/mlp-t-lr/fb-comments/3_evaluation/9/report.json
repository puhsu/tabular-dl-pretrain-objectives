{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised_fast___c5e963dd51d2436e9e3d0cd3c1ba9e21.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0,1",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                },
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 9,
        "data": {
            "path": "data/fb-comments",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512
                ],
                "dropout": 0.3311948744388331
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear",
                "relu"
            ],
            "d_num_embedding": 106,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 512,
            "lr": 0.00010273876920522086,
            "weight_decay": 0.0004961094121876227,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 1024
        },
        "pretrain": {
            "corrupt_probability": 0.7968879116352573,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.00010273876920522086,
            "weight_decay": 0.0004961094121876227,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post",
            "supervised_weight": 1.0
        },
        "bins": {
            "count": 159,
            "value": "ratio",
            "tree": {
                "min_samples_leaf": 67,
                "min_impurity_decrease": 0.00018375444016412894
            },
            "subsample": null
        }
    },
    "n_parameters": 3580216,
    "epoch_size": 308,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -4.290527419952504,
                    "pretrain_loss": 1.67145574092865,
                    "pretrain_component": 0.6941022872924805,
                    "supervised_component": 0.835727870464325,
                    "features_accuracy": [
                        0.20555323362350464,
                        0.49587664008140564,
                        0.3114223778247833,
                        0.784817099571228,
                        0.560372531414032,
                        0.20497596263885498,
                        0.2371446043252945,
                        0.4136819839477539,
                        0.5058044195175171,
                        0.44892096519470215,
                        0.011792842298746109,
                        0.2109643667936325,
                        0.7772998809814453,
                        0.7925690412521362,
                        0.2953983247280121,
                        0.21549372375011444,
                        0.7868598103523254,
                        0.380574494600296,
                        0.7933049201965332,
                        0.5289143323898315,
                        0.7641685605049133,
                        0.6176937222480774,
                        0.35034066438674927,
                        0.5649716854095459,
                        0.42218247056007385,
                        0.7419848442077637,
                        0.21294358372688293,
                        0.7236897349357605,
                        0.3174298107624054,
                        0.09802839905023575,
                        0.8285439014434814,
                        0.9884926676750183,
                        0.8042160272598267,
                        0.44487372040748596,
                        0.28871846199035645,
                        0.702850878238678,
                        0.24843630194664001,
                        0.6794681549072266,
                        0.4709651470184326,
                        0.5004757642745972,
                        0.6987718939781189,
                        0.8014565110206604,
                        0.20738020539283752,
                        0.6314467191696167,
                        0.1978456974029541,
                        0.6336289644241333,
                        0.7941994071006775,
                        0.4425075352191925,
                        0.6077532172203064,
                        0.8458366990089417,
                        0.258510023355484
                    ]
                },
                "val": {
                    "score": -5.311336494088008,
                    "pretrain_loss": 1.5802605152130127,
                    "pretrain_component": 0.6941054463386536,
                    "supervised_component": 0.7901302576065063,
                    "features_accuracy": [
                        0.20870094001293182,
                        0.5032451152801514,
                        0.3091978430747986,
                        0.7811073660850525,
                        0.554304838180542,
                        0.20200790464878082,
                        0.2334955781698227,
                        0.41304126381874084,
                        0.5109015107154846,
                        0.4511205554008484,
                        0.01227056048810482,
                        0.2126559168100357,
                        0.7721326351165771,
                        0.7968765497207642,
                        0.2953554391860962,
                        0.21929824352264404,
                        0.7833383679389954,
                        0.3800324499607086,
                        0.7942906022071838,
                        0.5293073654174805,
                        0.7672142386436462,
                        0.6207787990570068,
                        0.3481391370296478,
                        0.567690908908844,
                        0.4263259172439575,
                        0.7424703240394592,
                        0.2160024344921112,
                        0.7231010794639587,
                        0.3126457631587982,
                        0.09684615582227707,
                        0.8275529742240906,
                        0.9875265955924988,
                        0.803316056728363,
                        0.4458979666233063,
                        0.2902849614620209,
                        0.6990669965744019,
                        0.24561402201652527,
                        0.6760470271110535,
                        0.4756616950035095,
                        0.49700841307640076,
                        0.7016022801399231,
                        0.8020991683006287,
                        0.20565864443778992,
                        0.6284352540969849,
                        0.19526416063308716,
                        0.6354832053184509,
                        0.7897778749465942,
                        0.4421965181827545,
                        0.6086603403091431,
                        0.843474268913269,
                        0.254588782787323
                    ]
                },
                "test": {
                    "score": -5.498111718285503,
                    "pretrain_loss": 1.648290753364563,
                    "pretrain_component": 0.6941498517990112,
                    "supervised_component": 0.8241453766822815,
                    "features_accuracy": [
                        0.20907707512378693,
                        0.49802231788635254,
                        0.3034989833831787,
                        0.7843813300132751,
                        0.5632860064506531,
                        0.205121710896492,
                        0.2307809293270111,
                        0.4059837758541107,
                        0.5040568113327026,
                        0.4447261691093445,
                        0.0117647061124444,
                        0.21110548079013824,
                        0.7799695730209351,
                        0.791683554649353,
                        0.29244422912597656,
                        0.21490871906280518,
                        0.7855983972549438,
                        0.37601420283317566,
                        0.7911257743835449,
                        0.5228701829910278,
                        0.7613590359687805,
                        0.62337726354599,
                        0.35461461544036865,
                        0.5662271976470947,
                        0.41333672404289246,
                        0.7410243153572083,
                        0.21343813836574554,
                        0.7292089462280273,
                        0.31784990429878235,
                        0.09132859855890274,
                        0.8274340629577637,
                        0.9884888529777527,
                        0.8051724433898926,
                        0.43554767966270447,
                        0.2862575948238373,
                        0.7021805047988892,
                        0.2478194683790207,
                        0.6889452338218689,
                        0.46343812346458435,
                        0.5021805167198181,
                        0.6909736394882202,
                        0.7977180480957031,
                        0.21480730175971985,
                        0.6326572299003601,
                        0.1961967498064041,
                        0.6208418011665344,
                        0.7965010404586792,
                        0.4334178566932678,
                        0.5949797034263611,
                        0.8503042459487915,
                        0.2598884403705597
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -4.056042147651623,
                    "pretrain_loss": 1.6578043699264526,
                    "pretrain_component": 0.6944552063941956,
                    "supervised_component": 0.8289021849632263,
                    "features_accuracy": [
                        0.2059275060892105,
                        0.4992958605289459,
                        0.23824839293956757,
                        0.7926832437515259,
                        0.616875410079956,
                        0.20415763556957245,
                        0.3580482006072998,
                        0.32141995429992676,
                        0.40313249826431274,
                        0.409019410610199,
                        0.030474886298179626,
                        0.20799553394317627,
                        0.7256752848625183,
                        0.7911607623100281,
                        0.2638830840587616,
                        0.22353747487068176,
                        0.7817912101745605,
                        0.33450692892074585,
                        0.7896382808685303,
                        0.5168360471725464,
                        0.7335350513458252,
                        0.6820436716079712,
                        0.3772059977054596,
                        0.5667161345481873,
                        0.45988911390304565,
                        0.7428919672966003,
                        0.21497990190982819,
                        0.7541138529777527,
                        0.387939453125,
                        0.06362044811248779,
                        0.8256131410598755,
                        0.9887400269508362,
                        0.804767906665802,
                        0.4035067856311798,
                        0.27638640999794006,
                        0.7001103758811951,
                        0.22949416935443878,
                        0.8032771348953247,
                        0.493567556142807,
                        0.3678237497806549,
                        0.6271203756332397,
                        0.8023954033851624,
                        0.20772910118103027,
                        0.6286365389823914,
                        0.19765539467334747,
                        0.6171798706054688,
                        0.79435795545578,
                        0.3874509930610657,
                        0.5246831178665161,
                        0.9205712080001831,
                        0.2595440149307251
                    ]
                },
                "val": {
                    "score": -5.311464512944745,
                    "pretrain_loss": 1.5633695125579834,
                    "pretrain_component": 0.6944699287414551,
                    "supervised_component": 0.7816847562789917,
                    "features_accuracy": [
                        0.20870094001293182,
                        0.5061352849006653,
                        0.24262244999408722,
                        0.7883074283599854,
                        0.6176351308822632,
                        0.20200790464878082,
                        0.3542743921279907,
                        0.3239022195339203,
                        0.4119257628917694,
                        0.41435959935188293,
                        0.030169352889060974,
                        0.21235167980194092,
                        0.7205151319503784,
                        0.7979413866996765,
                        0.26574382185935974,
                        0.2298448383808136,
                        0.7790284752845764,
                        0.33236992359161377,
                        0.7888144850730896,
                        0.5188114643096924,
                        0.7336983680725098,
                        0.682689368724823,
                        0.37521547079086304,
                        0.5675894618034363,
                        0.46531790494918823,
                        0.7410506010055542,
                        0.2160024344921112,
                        0.748960554599762,
                        0.3845958709716797,
                        0.060490820556879044,
                        0.8262853622436523,
                        0.9870195388793945,
                        0.8030118346214294,
                        0.3985903859138489,
                        0.2758340835571289,
                        0.6985599398612976,
                        0.2273603081703186,
                        0.7979920506477356,
                        0.5010140538215637,
                        0.36613932251930237,
                        0.6266605854034424,
                        0.8022512793540955,
                        0.20565864443778992,
                        0.6246830821037292,
                        0.19556839764118195,
                        0.6161646842956543,
                        0.7897778749465942,
                        0.3872325122356415,
                        0.5202311873435974,
                        0.9169455170631409,
                        0.25392961502075195
                    ]
                },
                "test": {
                    "score": -5.512372295300983,
                    "pretrain_loss": 1.6368976831436157,
                    "pretrain_component": 0.6945361495018005,
                    "supervised_component": 0.8184488415718079,
                    "features_accuracy": [
                        0.20907707512378693,
                        0.5056794881820679,
                        0.23803246021270752,
                        0.7924442291259766,
                        0.6140973567962646,
                        0.205121710896492,
                        0.3615618646144867,
                        0.3174949288368225,
                        0.4038032591342926,
                        0.4032961428165436,
                        0.03270791098475456,
                        0.2111561894416809,
                        0.7285497188568115,
                        0.7918863892555237,
                        0.26338741183280945,
                        0.2245943248271942,
                        0.7823022603988647,
                        0.3262677490711212,
                        0.786663293838501,
                        0.5134888291358948,
                        0.7279411554336548,
                        0.6787018179893494,
                        0.3788539469242096,
                        0.5633874535560608,
                        0.44999998807907104,
                        0.7399594187736511,
                        0.21343813836574554,
                        0.7552738189697266,
                        0.39082151651382446,
                        0.05948276072740555,
                        0.826115608215332,
                        0.9882352948188782,
                        0.8050709962844849,
                        0.3955882489681244,
                        0.27368155121803284,
                        0.6941683888435364,
                        0.22966530919075012,
                        0.8100912570953369,
                        0.48017242550849915,
                        0.3685091435909271,
                        0.6168357133865356,
                        0.797768771648407,
                        0.21480730175971985,
                        0.6307302117347717,
                        0.19655172526836395,
                        0.60664302110672,
                        0.7965010404586792,
                        0.3797667324542999,
                        0.5130831599235535,
                        0.9254564046859741,
                        0.2597362995147705
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -4.629848409302476,
                    "pretrain_loss": 1.645885705947876,
                    "pretrain_component": 0.6949219107627869,
                    "supervised_component": 0.822942852973938,
                    "features_accuracy": [
                        0.20528680086135864,
                        0.4987122416496277,
                        0.23368731141090393,
                        0.7818483114242554,
                        0.6011114120483398,
                        0.20654284954071045,
                        0.3202781081199646,
                        0.27986273169517517,
                        0.48204749822616577,
                        0.3333333432674408,
                        0.057613011449575424,
                        0.20929598808288574,
                        0.7265760898590088,
                        0.7906469702720642,
                        0.3036450743675232,
                        0.20947995781898499,
                        0.7893084287643433,
                        0.33665740489959717,
                        0.7899681925773621,
                        0.5049543976783752,
                        0.71331787109375,
                        0.5266433358192444,
                        0.38238877058029175,
                        0.5684670209884644,
                        0.4270099997520447,
                        0.7415534257888794,
                        0.21578553318977356,
                        0.7269947528839111,
                        0.35054999589920044,
                        0.08281632512807846,
                        0.8052436709403992,
                        0.9884228706359863,
                        0.8027950525283813,
                        0.40972989797592163,
                        0.2991030216217041,
                        0.6542775630950928,
                        0.2365165799856186,
                        0.7837704420089722,
                        0.3838668465614319,
                        0.519411563873291,
                        0.6576206088066101,
                        0.8014565110206604,
                        0.20852839946746826,
                        0.5982440710067749,
                        0.19762367010116577,
                        0.6076707243919373,
                        0.7930194735527039,
                        0.4129461348056793,
                        0.4774356484413147,
                        0.7933366298675537,
                        0.25905555486679077
                    ]
                },
                "val": {
                    "score": -5.399045720586885,
                    "pretrain_loss": 1.5503857135772705,
                    "pretrain_component": 0.6949286460876465,
                    "supervised_component": 0.7751928567886353,
                    "features_accuracy": [
                        0.2087516486644745,
                        0.5066930055618286,
                        0.23395192623138428,
                        0.7782171964645386,
                        0.5966940522193909,
                        0.20200790464878082,
                        0.318071186542511,
                        0.2820707857608795,
                        0.4920393228530884,
                        0.3351079821586609,
                        0.056485142558813095,
                        0.2129601389169693,
                        0.7251799702644348,
                        0.796166718006134,
                        0.3055470883846283,
                        0.21569819748401642,
                        0.7880032062530518,
                        0.33384037017822266,
                        0.7907919883728027,
                        0.5062366724014282,
                        0.7133150696754456,
                        0.5334651470184326,
                        0.3818071186542511,
                        0.570631742477417,
                        0.42597097158432007,
                        0.7408984899520874,
                        0.2160024344921112,
                        0.726447582244873,
                        0.3499644994735718,
                        0.07970793545246124,
                        0.8024033904075623,
                        0.9864618182182312,
                        0.8032146692276001,
                        0.40690597891807556,
                        0.3033667802810669,
                        0.6538890600204468,
                        0.23516884446144104,
                        0.7788256406784058,
                        0.39093396067619324,
                        0.5216002464294434,
                        0.6590609550476074,
                        0.8021498322486877,
                        0.20565864443778992,
                        0.598063051700592,
                        0.19485852122306824,
                        0.6077983975410461,
                        0.7897778749465942,
                        0.4129398465156555,
                        0.47530674934387207,
                        0.789879322052002,
                        0.2538281977176666
                    ]
                },
                "test": {
                    "score": -5.606639734085396,
                    "pretrain_loss": 1.626926302909851,
                    "pretrain_component": 0.6949890851974487,
                    "supervised_component": 0.8134631514549255,
                    "features_accuracy": [
                        0.20907707512378693,
                        0.5029411911964417,
                        0.2321501076221466,
                        0.7817951440811157,
                        0.5981237292289734,
                        0.205121710896492,
                        0.31850913166999817,
                        0.27804258465766907,
                        0.4812373220920563,
                        0.3364604413509369,
                        0.06156186759471893,
                        0.2113083153963089,
                        0.7300710082054138,
                        0.7911257743835449,
                        0.3029918968677521,
                        0.21135902404785156,
                        0.7900101542472839,
                        0.3312373161315918,
                        0.7887930870056152,
                        0.5002535581588745,
                        0.7099898457527161,
                        0.5346348881721497,
                        0.38717037439346313,
                        0.5674949288368225,
                        0.42256593704223633,
                        0.7398073077201843,
                        0.21343813836574554,
                        0.7338235378265381,
                        0.35243406891822815,
                        0.07753549516201019,
                        0.8047160506248474,
                        0.9876775145530701,
                        0.805020272731781,
                        0.4038539528846741,
                        0.2968052625656128,
                        0.6506592035293579,
                        0.23646044731140137,
                        0.7893002033233643,
                        0.3792596459388733,
                        0.5200304388999939,
                        0.6464502811431885,
                        0.7978194952011108,
                        0.21480730175971985,
                        0.6014705896377563,
                        0.19599391520023346,
                        0.5983772873878479,
                        0.7965010404586792,
                        0.4044624865055084,
                        0.4649087190628052,
                        0.7981744408607483,
                        0.25968560576438904
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -4.268139005725819,
                    "pretrain_loss": 1.6456365585327148,
                    "pretrain_component": 0.6942824125289917,
                    "supervised_component": 0.8228182792663574,
                    "features_accuracy": [
                        0.20645403861999512,
                        0.5057854056358337,
                        0.24855047464370728,
                        0.7803004384040833,
                        0.6116862893104553,
                        0.2059338539838791,
                        0.4038112759590149,
                        0.3495921194553375,
                        0.4678567349910736,
                        0.42525914311408997,
                        0.035499054938554764,
                        0.20913739502429962,
                        0.7028635144233704,
                        0.7911227345466614,
                        0.35110190510749817,
                        0.20779253542423248,
                        0.7826666235923767,
                        0.32943832874298096,
                        0.7902409434318542,
                        0.530957043170929,
                        0.7578058838844299,
                        0.6013651490211487,
                        0.3705832362174988,
                        0.5723429918289185,
                        0.41538843512535095,
                        0.745137631893158,
                        0.214313805103302,
                        0.7420292496681213,
                        0.3382623493671417,
                        0.14911378920078278,
                        0.8169921040534973,
                        0.9874839782714844,
                        0.8043555617332458,
                        0.41922634840011597,
                        0.2961151599884033,
                        0.7039292454719543,
                        0.23125769197940826,
                        0.7576155662536621,
                        0.48228219151496887,
                        0.4768012762069702,
                        0.6565866470336914,
                        0.8013486862182617,
                        0.2082809954881668,
                        0.6389766335487366,
                        0.19742701947689056,
                        0.5837996006011963,
                        0.7949225902557373,
                        0.4282216429710388,
                        0.533215343952179,
                        0.8923355937004089,
                        0.2594805955886841
                    ]
                },
                "val": {
                    "score": -5.35849693198087,
                    "pretrain_loss": 1.5508922338485718,
                    "pretrain_component": 0.6942970752716064,
                    "supervised_component": 0.7754461169242859,
                    "features_accuracy": [
                        0.2087516486644745,
                        0.5136902928352356,
                        0.2503295838832855,
                        0.7757326364517212,
                        0.6085082292556763,
                        0.20200790464878082,
                        0.40300172567367554,
                        0.34575599431991577,
                        0.4737856090068817,
                        0.42313152551651,
                        0.03442855551838875,
                        0.2131122499704361,
                        0.7007910013198853,
                        0.7976371049880981,
                        0.3531081974506378,
                        0.21128688752651215,
                        0.7825270891189575,
                        0.32892200350761414,
                        0.790538489818573,
                        0.5331102013587952,
                        0.7571240067481995,
                        0.6069871187210083,
                        0.3677111864089966,
                        0.5738261938095093,
                        0.4211540222167969,
                        0.7418111562728882,
                        0.2160024344921112,
                        0.7440928816795349,
                        0.33414459228515625,
                        0.14592839777469635,
                        0.8180204629898071,
                        0.9854984283447266,
                        0.802656888961792,
                        0.41375112533569336,
                        0.2990061640739441,
                        0.7047459483146667,
                        0.22700536251068115,
                        0.7544873356819153,
                        0.4897069036960602,
                        0.4835716187953949,
                        0.6566271185874939,
                        0.8020484447479248,
                        0.20565864443778992,
                        0.638981819152832,
                        0.19531486928462982,
                        0.5812797546386719,
                        0.7897778749465942,
                        0.42612311244010925,
                        0.5305749773979187,
                        0.8905790448188782,
                        0.25392961502075195
                    ]
                },
                "test": {
                    "score": -5.533434615299273,
                    "pretrain_loss": 1.6290143728256226,
                    "pretrain_component": 0.6943718791007996,
                    "supervised_component": 0.8145071864128113,
                    "features_accuracy": [
                        0.20927992463111877,
                        0.5089249610900879,
                        0.2495943158864975,
                        0.7776876091957092,
                        0.6073529720306396,
                        0.205121710896492,
                        0.41237321496009827,
                        0.34158214926719666,
                        0.4701825678348541,
                        0.41607505083084106,
                        0.03803245350718498,
                        0.21151115000247955,
                        0.7025355100631714,
                        0.7926470637321472,
                        0.3473123610019684,
                        0.20907707512378693,
                        0.7846856117248535,
                        0.32388439774513245,
                        0.7885395288467407,
                        0.5245943069458008,
                        0.7526369094848633,
                        0.6072515249252319,
                        0.3708924949169159,
                        0.572210967540741,
                        0.4116125702857971,
                        0.7404158115386963,
                        0.21343813836574554,
                        0.7469066977500916,
                        0.34036511182785034,
                        0.14137931168079376,
                        0.818356990814209,
                        0.9874239563941956,
                        0.804411768913269,
                        0.41059836745262146,
                        0.2960953414440155,
                        0.7030426263809204,
                        0.23042596876621246,
                        0.7637423872947693,
                        0.47494930028915405,
                        0.4798174500465393,
                        0.6452839970588684,
                        0.7976166605949402,
                        0.21480730175971985,
                        0.6384888291358948,
                        0.19614604115486145,
                        0.5736815333366394,
                        0.7965010404586792,
                        0.41967546939849854,
                        0.5198276042938232,
                        0.8973124027252197,
                        0.25968560576438904
                    ]
                }
            }
        },
        "train": {
            "score": -4.290527419952504
        },
        "val": {
            "score": -5.311336494088008
        },
        "test": {
            "score": -5.498111718285503
        }
    },
    "best_iteration": 10000,
    "time": "0:45:51"
}
