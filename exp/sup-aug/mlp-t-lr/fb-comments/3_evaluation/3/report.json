{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised_fast___c5e963dd51d2436e9e3d0cd3c1ba9e21.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0,1",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                },
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 3,
        "data": {
            "path": "data/fb-comments",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512
                ],
                "dropout": 0.3311948744388331
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear",
                "relu"
            ],
            "d_num_embedding": 106,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 512,
            "lr": 0.00010273876920522086,
            "weight_decay": 0.0004961094121876227,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 1024
        },
        "pretrain": {
            "corrupt_probability": 0.7968879116352573,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.00010273876920522086,
            "weight_decay": 0.0004961094121876227,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post",
            "supervised_weight": 1.0
        },
        "bins": {
            "count": 159,
            "value": "ratio",
            "tree": {
                "min_samples_leaf": 67,
                "min_impurity_decrease": 0.00018375444016412894
            },
            "subsample": null
        }
    },
    "n_parameters": 3580216,
    "epoch_size": 308,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -4.148329152774044,
                    "pretrain_loss": 1.6799883842468262,
                    "pretrain_component": 0.6927593350410461,
                    "supervised_component": 0.8399941921234131,
                    "features_accuracy": [
                        0.7885218262672424,
                        0.48632311820983887,
                        0.7922201752662659,
                        0.20453190803527832,
                        0.31157463788986206,
                        0.7928798794746399,
                        0.2626206874847412,
                        0.30266180634498596,
                        0.6471599340438843,
                        0.24481406807899475,
                        0.07987921684980392,
                        0.7933366298675537,
                        0.5381126403808594,
                        0.6789669990539551,
                        0.28835052251815796,
                        0.23360484838485718,
                        0.7776741981506348,
                        0.3792232871055603,
                        0.20570547878742218,
                        0.4369124174118042,
                        0.26161205768585205,
                        0.35721084475517273,
                        0.6685253977775574,
                        0.5659739375114441,
                        0.24074779450893402,
                        0.25982314348220825,
                        0.7857877016067505,
                        0.7831233739852905,
                        0.427029013633728,
                        0.05944632738828659,
                        0.744668185710907,
                        0.37169337272644043,
                        0.19752217829227448,
                        0.7508278489112854,
                        0.7907738089561462,
                        0.19697028398513794,
                        0.8002512454986572,
                        0.7890673875808716,
                        0.6298354864120483,
                        0.18510764837265015,
                        0.7838592529296875,
                        0.2054009884595871,
                        0.21516385674476624,
                        0.21277230978012085,
                        0.8014945983886719,
                        0.7613075971603394,
                        0.7689136266708374,
                        0.7480683922767639,
                        0.7934191226959229,
                        0.024226393550634384,
                        0.7380263805389404
                    ]
                },
                "val": {
                    "score": -5.3156313636845685,
                    "pretrain_loss": 1.6024537086486816,
                    "pretrain_component": 0.692748486995697,
                    "supervised_component": 0.8012268543243408,
                    "features_accuracy": [
                        0.7838454246520996,
                        0.4826589524745941,
                        0.7936314344406128,
                        0.20723049342632294,
                        0.3068654239177704,
                        0.7927694916725159,
                        0.2669607400894165,
                        0.30605414509773254,
                        0.6502382755279541,
                        0.2490619570016861,
                        0.078896664083004,
                        0.7930229902267456,
                        0.5433018803596497,
                        0.6804076433181763,
                        0.29353004693984985,
                        0.23410403728485107,
                        0.7822228670120239,
                        0.37998172640800476,
                        0.20018252730369568,
                        0.4340837597846985,
                        0.2598620653152466,
                        0.357164591550827,
                        0.6707737445831299,
                        0.5674373507499695,
                        0.238566055893898,
                        0.24961970746517181,
                        0.7852144837379456,
                        0.7815130352973938,
                        0.4273907244205475,
                        0.056687962263822556,
                        0.7472872734069824,
                        0.36512523889541626,
                        0.1970895379781723,
                        0.7491633296012878,
                        0.7933779358863831,
                        0.1991177350282669,
                        0.7968258857727051,
                        0.7883074283599854,
                        0.61778724193573,
                        0.1892302930355072,
                        0.7838961482048035,
                        0.20885305106639862,
                        0.21858836710453033,
                        0.21346718072891235,
                        0.8102118968963623,
                        0.7586451172828674,
                        0.7688367962837219,
                        0.7457154393196106,
                        0.800476610660553,
                        0.023577729240059853,
                        0.7384646534919739
                    ]
                },
                "test": {
                    "score": -5.522568324611385,
                    "pretrain_loss": 1.6829296350479126,
                    "pretrain_component": 0.6927219033241272,
                    "supervised_component": 0.8414648175239563,
                    "features_accuracy": [
                        0.7932048439979553,
                        0.4828600287437439,
                        0.7917342782020569,
                        0.2085699737071991,
                        0.316125750541687,
                        0.7942698001861572,
                        0.2615111470222473,
                        0.29700812697410583,
                        0.6462981700897217,
                        0.24001014232635498,
                        0.0773833692073822,
                        0.7942190766334534,
                        0.5419371128082275,
                        0.671653151512146,
                        0.28351926803588867,
                        0.23620690405368805,
                        0.7798681855201721,
                        0.3777383267879486,
                        0.20420892536640167,
                        0.43859025835990906,
                        0.26445233821868896,
                        0.3613083064556122,
                        0.6714503169059753,
                        0.5673935413360596,
                        0.23823529481887817,
                        0.264148086309433,
                        0.7870689630508423,
                        0.7871196866035461,
                        0.42652130126953125,
                        0.058924950659275055,
                        0.7487829923629761,
                        0.3630324602127075,
                        0.19847869873046875,
                        0.7529411911964417,
                        0.7902637124061584,
                        0.1994929015636444,
                        0.7997971773147583,
                        0.792190670967102,
                        0.6361562013626099,
                        0.1835699826478958,
                        0.7872717976570129,
                        0.20522312819957733,
                        0.21546652913093567,
                        0.2111561894416809,
                        0.8028397560119629,
                        0.758874237537384,
                        0.7652130126953125,
                        0.741632878780365,
                        0.7970080971717834,
                        0.024594319984316826,
                        0.7443711757659912
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -4.888733303782146,
                    "pretrain_loss": 1.653258204460144,
                    "pretrain_component": 0.6925378441810608,
                    "supervised_component": 0.826629102230072,
                    "features_accuracy": [
                        0.7712734341621399,
                        0.48722389340400696,
                        0.7909514307975769,
                        0.2074563354253769,
                        0.311466783285141,
                        0.7939139008522034,
                        0.43255433440208435,
                        0.2880079746246338,
                        0.6429287195205688,
                        0.33963891863822937,
                        0.20214669406414032,
                        0.793165385723114,
                        0.6227940320968628,
                        0.5740557312965393,
                        0.2971428334712982,
                        0.2241845279932022,
                        0.7464697957038879,
                        0.23947906494140625,
                        0.2060924470424652,
                        0.4346160292625427,
                        0.24964793026447296,
                        0.37083700299263,
                        0.6691089868545532,
                        0.5719877481460571,
                        0.23831817507743835,
                        0.2843223214149475,
                        0.7879064679145813,
                        0.7816897034645081,
                        0.34404775500297546,
                        0.08371712267398834,
                        0.672230064868927,
                        0.1743171066045761,
                        0.27811822295188904,
                        0.796895444393158,
                        0.7878747582435608,
                        0.19627247750759125,
                        0.8002068400382996,
                        0.7666679620742798,
                        0.724856972694397,
                        0.18585620820522308,
                        0.7222941517829895,
                        0.21810096502304077,
                        0.27686217427253723,
                        0.20849034190177917,
                        0.8048440217971802,
                        0.7190398573875427,
                        0.7869168519973755,
                        0.7355142831802368,
                        0.7913066744804382,
                        0.09582080692052841,
                        0.7370050549507141
                    ]
                },
                "val": {
                    "score": -5.424452184674968,
                    "pretrain_loss": 1.5685843229293823,
                    "pretrain_component": 0.6925353407859802,
                    "supervised_component": 0.7842921614646912,
                    "features_accuracy": [
                        0.7685832977294922,
                        0.4845857322216034,
                        0.7925159335136414,
                        0.20717979967594147,
                        0.3065612018108368,
                        0.7923638224601746,
                        0.43585842847824097,
                        0.2925666570663452,
                        0.650187611579895,
                        0.33789676427841187,
                        0.19450359046459198,
                        0.7930229902267456,
                        0.6254943609237671,
                        0.5732684135437012,
                        0.29890477657318115,
                        0.22482506930828094,
                        0.7473886609077454,
                        0.24165906012058258,
                        0.2004360556602478,
                        0.4318527281284332,
                        0.24728728830814362,
                        0.366342157125473,
                        0.6703174114227295,
                        0.5710374116897583,
                        0.23836323618888855,
                        0.27345097064971924,
                        0.7852144837379456,
                        0.7790284752845764,
                        0.34098973870277405,
                        0.08371361345052719,
                        0.6733596920967102,
                        0.17021599411964417,
                        0.2742622494697571,
                        0.7964709401130676,
                        0.7913497686386108,
                        0.1991177350282669,
                        0.7963694930076599,
                        0.767366349697113,
                        0.7202109098434448,
                        0.1892302930355072,
                        0.7189940214157104,
                        0.22259405255317688,
                        0.2807524502277374,
                        0.21067842841148376,
                        0.8102118968963623,
                        0.7187911868095398,
                        0.7875468730926514,
                        0.7354730367660522,
                        0.7992089986801147,
                        0.09659263491630554,
                        0.7356758713722229
                    ]
                },
                "test": {
                    "score": -5.617916020606017,
                    "pretrain_loss": 1.6571108102798462,
                    "pretrain_component": 0.6925060153007507,
                    "supervised_component": 0.8285554051399231,
                    "features_accuracy": [
                        0.7793103456497192,
                        0.4835192859172821,
                        0.7907707691192627,
                        0.20867140591144562,
                        0.3155679404735565,
                        0.7934584021568298,
                        0.42885395884513855,
                        0.28133875131607056,
                        0.6463488936424255,
                        0.32814401388168335,
                        0.19837728142738342,
                        0.7942190766334534,
                        0.6229715943336487,
                        0.5718559622764587,
                        0.29001015424728394,
                        0.2241886407136917,
                        0.7490872144699097,
                        0.2402636855840683,
                        0.20476673543453217,
                        0.4377281963825226,
                        0.2520790994167328,
                        0.364705890417099,
                        0.6709432005882263,
                        0.571602463722229,
                        0.2373732328414917,
                        0.28711968660354614,
                        0.7870689630508423,
                        0.7835192680358887,
                        0.3450811505317688,
                        0.08706896752119064,
                        0.6772312521934509,
                        0.17216023802757263,
                        0.28382351994514465,
                        0.7981237173080444,
                        0.7887424230575562,
                        0.1994929015636444,
                        0.7996450066566467,
                        0.7720081210136414,
                        0.7314401865005493,
                        0.1837221086025238,
                        0.7229208946228027,
                        0.21810345351696014,
                        0.2804766893386841,
                        0.20684584975242615,
                        0.8028397560119629,
                        0.7170385718345642,
                        0.7824543714523315,
                        0.7332656979560852,
                        0.7943204641342163,
                        0.09219066798686981,
                        0.7417342662811279
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -4.037848676872025,
                    "pretrain_loss": 1.6529980897903442,
                    "pretrain_component": 0.6926702857017517,
                    "supervised_component": 0.8264990448951721,
                    "features_accuracy": [
                        0.785692572593689,
                        0.4851558804512024,
                        0.7811314463615417,
                        0.20661261677742004,
                        0.31140968203544617,
                        0.7921440601348877,
                        0.4145764410495758,
                        0.2832629382610321,
                        0.6464621424674988,
                        0.28038290143013,
                        0.03811898082494736,
                        0.7951065301895142,
                        0.6174589991569519,
                        0.5762125849723816,
                        0.31065478920936584,
                        0.2134193629026413,
                        0.741274356842041,
                        0.3022177517414093,
                        0.20633985102176666,
                        0.43490150570869446,
                        0.26138368248939514,
                        0.3988759219646454,
                        0.6692485213279724,
                        0.5763394832611084,
                        0.23968841135501862,
                        0.2672261893749237,
                        0.7870564460754395,
                        0.782495379447937,
                        0.33418339490890503,
                        0.08593740314245224,
                        0.6169515252113342,
                        0.09062536060810089,
                        0.3181973993778229,
                        0.7968827486038208,
                        0.7752763032913208,
                        0.19845469295978546,
                        0.8011139631271362,
                        0.7871071696281433,
                        0.7189002633094788,
                        0.18765780329704285,
                        0.7201626896858215,
                        0.2176632583141327,
                        0.300929993391037,
                        0.2150116115808487,
                        0.803232729434967,
                        0.72678542137146,
                        0.7572793364524841,
                        0.7514559030532837,
                        0.7920108437538147,
                        0.05438409745693207,
                        0.6850442290306091
                    ]
                },
                "val": {
                    "score": -5.33845637486541,
                    "pretrain_loss": 1.558887243270874,
                    "pretrain_component": 0.6926552653312683,
                    "supervised_component": 0.779443621635437,
                    "features_accuracy": [
                        0.779991865158081,
                        0.48336881399154663,
                        0.7834904789924622,
                        0.2074333131313324,
                        0.30651047825813293,
                        0.7914004325866699,
                        0.4119764566421509,
                        0.2858736217021942,
                        0.650187611579895,
                        0.2816651463508606,
                        0.039904672652482986,
                        0.7930229902267456,
                        0.6208802461624146,
                        0.5751951932907104,
                        0.31350773572921753,
                        0.2138221263885498,
                        0.7396308779716492,
                        0.30326539278030396,
                        0.20063887536525726,
                        0.432309091091156,
                        0.25813812017440796,
                        0.40112563967704773,
                        0.6707737445831299,
                        0.5786431431770325,
                        0.23851536214351654,
                        0.2564648687839508,
                        0.7848088145256042,
                        0.7798904776573181,
                        0.331153005361557,
                        0.08280093222856522,
                        0.6185985207557678,
                        0.08954466879367828,
                        0.31873035430908203,
                        0.7963188290596008,
                        0.7817665338516235,
                        0.1991177350282669,
                        0.7972314953804016,
                        0.7873440384864807,
                        0.716610848903656,
                        0.18917958438396454,
                        0.7177770733833313,
                        0.2218334823846817,
                        0.30209916830062866,
                        0.21610383689403534,
                        0.8102118968963623,
                        0.7301490306854248,
                        0.7598113417625427,
                        0.7459689378738403,
                        0.7994624972343445,
                        0.053240034729242325,
                        0.6843626499176025
                    ]
                },
                "test": {
                    "score": -5.520518138933588,
                    "pretrain_loss": 1.6442091464996338,
                    "pretrain_component": 0.692629873752594,
                    "supervised_component": 0.8221045732498169,
                    "features_accuracy": [
                        0.7914807200431824,
                        0.4832657277584076,
                        0.782707929611206,
                        0.20887424051761627,
                        0.31485801935195923,
                        0.792799174785614,
                        0.41049695014953613,
                        0.2751014232635498,
                        0.6462981700897217,
                        0.2707403600215912,
                        0.03782961517572403,
                        0.7942190766334534,
                        0.6198275685310364,
                        0.5774847865104675,
                        0.3027890622615814,
                        0.215415820479393,
                        0.7430527210235596,
                        0.2984786927700043,
                        0.20507100224494934,
                        0.4383874237537384,
                        0.2624746561050415,
                        0.3987322449684143,
                        0.6714503169059753,
                        0.5773833990097046,
                        0.23757606744766235,
                        0.2693712115287781,
                        0.7866125702857971,
                        0.7853448390960693,
                        0.33250507712364197,
                        0.08782961219549179,
                        0.6225659251213074,
                        0.09077078849077225,
                        0.3296146094799042,
                        0.7976166605949402,
                        0.7768762707710266,
                        0.1996450275182724,
                        0.8005577921867371,
                        0.7921399474143982,
                        0.728803277015686,
                        0.18367139995098114,
                        0.7208417654037476,
                        0.21820487082004547,
                        0.30218052864074707,
                        0.21277891099452972,
                        0.8028397560119629,
                        0.7269269824028015,
                        0.7512170672416687,
                        0.7442190647125244,
                        0.7951825857162476,
                        0.05015213042497635,
                        0.6926977634429932
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -4.530805003210303,
                    "pretrain_loss": 1.641046166419983,
                    "pretrain_component": 0.6922844648361206,
                    "supervised_component": 0.8205230832099915,
                    "features_accuracy": [
                        0.7820639610290527,
                        0.4873444437980652,
                        0.7856608629226685,
                        0.20431622862815857,
                        0.3106991946697235,
                        0.7931907176971436,
                        0.47738489508628845,
                        0.2882934510707855,
                        0.6449777483940125,
                        0.3288293480873108,
                        0.18505056202411652,
                        0.7941232323646545,
                        0.6373273134231567,
                        0.5997158288955688,
                        0.3291909396648407,
                        0.22369606792926788,
                        0.7442241311073303,
                        0.2990015149116516,
                        0.21147820353507996,
                        0.4439602196216583,
                        0.25219807028770447,
                        0.32232075929641724,
                        0.6678910255432129,
                        0.5688920021057129,
                        0.23765844106674194,
                        0.2675940990447998,
                        0.7865806818008423,
                        0.7841193079948425,
                        0.32582247257232666,
                        0.21778379380702972,
                        0.6057042479515076,
                        0.14304926991462708,
                        0.3371776044368744,
                        0.7974029183387756,
                        0.7893909215927124,
                        0.19705909490585327,
                        0.801437497138977,
                        0.7932668924331665,
                        0.7395995855331421,
                        0.18539945781230927,
                        0.7399865388870239,
                        0.23384590446949005,
                        0.2258148491382599,
                        0.22953222692012787,
                        0.8023763298988342,
                        0.7303188443183899,
                        0.68137127161026,
                        0.7354127764701843,
                        0.793425440788269,
                        0.33252769708633423,
                        0.7268806099891663
                    ]
                },
                "val": {
                    "score": -5.399982647752587,
                    "pretrain_loss": 1.5538157224655151,
                    "pretrain_component": 0.6922690868377686,
                    "supervised_component": 0.7769078612327576,
                    "features_accuracy": [
                        0.7754284143447876,
                        0.48245611786842346,
                        0.7896257638931274,
                        0.20717979967594147,
                        0.30590203404426575,
                        0.792059600353241,
                        0.48215189576148987,
                        0.29033565521240234,
                        0.650187611579895,
                        0.32887130975723267,
                        0.18187810480594635,
                        0.792820155620575,
                        0.643190324306488,
                        0.5990264415740967,
                        0.3317614793777466,
                        0.22223912179470062,
                        0.7457661032676697,
                        0.3013386130332947,
                        0.20631781220436096,
                        0.44128382205963135,
                        0.24926477670669556,
                        0.323699414730072,
                        0.670723021030426,
                        0.5686035752296448,
                        0.23826183378696442,
                        0.25758036971092224,
                        0.7852144837379456,
                        0.7816651463508606,
                        0.32638677954673767,
                        0.21656018495559692,
                        0.6086603403091431,
                        0.13867761194705963,
                        0.33470234274864197,
                        0.794899046421051,
                        0.7932765483856201,
                        0.19932055473327637,
                        0.797687828540802,
                        0.7939863801002502,
                        0.7366899847984314,
                        0.18917958438396454,
                        0.7414562106132507,
                        0.2384139448404312,
                        0.22918567061424255,
                        0.22928708791732788,
                        0.8102118968963623,
                        0.7292870879173279,
                        0.6865429282188416,
                        0.7325322031974792,
                        0.7994117736816406,
                        0.3259304165840149,
                        0.7281208634376526
                    ]
                },
                "test": {
                    "score": -5.587724271175142,
                    "pretrain_loss": 1.6423182487487793,
                    "pretrain_component": 0.6922300457954407,
                    "supervised_component": 0.8211591243743896,
                    "features_accuracy": [
                        0.7872717976570129,
                        0.48316431045532227,
                        0.7884888648986816,
                        0.2085699737071991,
                        0.3147566020488739,
                        0.7937119603157043,
                        0.47854968905448914,
                        0.28052738308906555,
                        0.6463488936424255,
                        0.31582149863243103,
                        0.19244422018527985,
                        0.7941683530807495,
                        0.6384381651878357,
                        0.6011156439781189,
                        0.3258620798587799,
                        0.22413793206214905,
                        0.7459939122200012,
                        0.295030415058136,
                        0.21009127795696259,
                        0.443356990814209,
                        0.2523326575756073,
                        0.32114604115486145,
                        0.6712474822998047,
                        0.5686105489730835,
                        0.23727180063724518,
                        0.26992902159690857,
                        0.7870689630508423,
                        0.7867140173912048,
                        0.3319472670555115,
                        0.22809331119060516,
                        0.605527400970459,
                        0.14016227424144745,
                        0.3461967706680298,
                        0.797160267829895,
                        0.7906693816184998,
                        0.1998985856771469,
                        0.8007606267929077,
                        0.797768771648407,
                        0.7491886615753174,
                        0.18362069129943848,
                        0.7413285970687866,
                        0.23635903000831604,
                        0.22647058963775635,
                        0.22728194296360016,
                        0.8028397560119629,
                        0.7291582226753235,
                        0.6724644899368286,
                        0.7321500778198242,
                        0.7959939241409302,
                        0.3350912928581238,
                        0.7359533309936523
                    ]
                }
            }
        },
        "train": {
            "score": -4.148329152774044
        },
        "val": {
            "score": -5.3156313636845685
        },
        "test": {
            "score": -5.522568324611385
        }
    },
    "best_iteration": 10000,
    "time": "0:45:12"
}
