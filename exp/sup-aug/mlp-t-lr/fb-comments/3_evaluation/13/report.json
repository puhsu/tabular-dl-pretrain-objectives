{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised_fast___c5e963dd51d2436e9e3d0cd3c1ba9e21.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0,1",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                },
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 13,
        "data": {
            "path": "data/fb-comments",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512
                ],
                "dropout": 0.3311948744388331
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear",
                "relu"
            ],
            "d_num_embedding": 106,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 512,
            "lr": 0.00010273876920522086,
            "weight_decay": 0.0004961094121876227,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 1024
        },
        "pretrain": {
            "corrupt_probability": 0.7968879116352573,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.00010273876920522086,
            "weight_decay": 0.0004961094121876227,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post",
            "supervised_weight": 1.0
        },
        "bins": {
            "count": 159,
            "value": "ratio",
            "tree": {
                "min_samples_leaf": 67,
                "min_impurity_decrease": 0.00018375444016412894
            },
            "subsample": null
        }
    },
    "n_parameters": 3580216,
    "epoch_size": 308,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -3.769527525453549,
                    "pretrain_loss": 1.6834927797317505,
                    "pretrain_component": 0.6935963034629822,
                    "supervised_component": 0.8417463898658752,
                    "features_accuracy": [
                        0.23019830882549286,
                        0.5147172808647156,
                        0.6215823888778687,
                        0.7945419549942017,
                        0.31645289063453674,
                        0.20624469220638275,
                        0.30852967500686646,
                        0.5736560821533203,
                        0.362228661775589,
                        0.2735825181007385,
                        0.6638057231903076,
                        0.7773062586784363,
                        0.7633058428764343,
                        0.7935459613800049,
                        0.754741907119751,
                        0.7795392274856567,
                        0.6468744874000549,
                        0.7913066744804382,
                        0.7524011135101318,
                        0.5662784576416016,
                        0.21909692883491516,
                        0.23703676462173462,
                        0.33205828070640564,
                        0.5827528834342957,
                        0.24245423078536987,
                        0.4871033728122711,
                        0.21445971727371216,
                        0.7761263251304626,
                        0.7432155013084412,
                        0.0838630273938179,
                        0.44786155223846436,
                        0.06370925903320312,
                        0.19518771767616272,
                        0.20276202261447906,
                        0.21147185564041138,
                        0.7894289493560791,
                        0.8007460236549377,
                        0.45879802107810974,
                        0.19115950167179108,
                        0.1860528588294983,
                        0.5636394619941711,
                        0.3596150875091553,
                        0.44371283054351807,
                        0.7914589047431946,
                        0.7225351929664612,
                        0.7656402587890625,
                        0.7788477540016174,
                        0.2412870079278946,
                        0.7725865840911865,
                        0.9644502401351929,
                        0.261370986700058
                    ]
                },
                "val": {
                    "score": -5.266428031789176,
                    "pretrain_loss": 1.581141710281372,
                    "pretrain_component": 0.6936185956001282,
                    "supervised_component": 0.790570855140686,
                    "features_accuracy": [
                        0.2323293685913086,
                        0.518355131149292,
                        0.6217929124832153,
                        0.7944934368133545,
                        0.31320351362228394,
                        0.20905587077140808,
                        0.30762597918510437,
                        0.5758036375045776,
                        0.35833078622817993,
                        0.2681269645690918,
                        0.6585538983345032,
                        0.7745157480239868,
                        0.7659973502159119,
                        0.7908427119255066,
                        0.7551465034484863,
                        0.7759354710578918,
                        0.6427339911460876,
                        0.7907919883728027,
                        0.7564141154289246,
                        0.5672852396965027,
                        0.22173206508159637,
                        0.23385050892829895,
                        0.327248752117157,
                        0.5888347625732422,
                        0.2378561943769455,
                        0.48651251196861267,
                        0.21534326672554016,
                        0.7756819725036621,
                        0.7477943301200867,
                        0.07940370589494705,
                        0.44402188062667847,
                        0.06495284289121628,
                        0.19719095528125763,
                        0.20312340557575226,
                        0.2097657322883606,
                        0.787749707698822,
                        0.7977892756462097,
                        0.4487881362438202,
                        0.18730351328849792,
                        0.184413343667984,
                        0.567690908908844,
                        0.35686033964157104,
                        0.43788662552833557,
                        0.791299045085907,
                        0.7212756872177124,
                        0.7676199078559875,
                        0.7690903544425964,
                        0.24363654851913452,
                        0.7741608023643494,
                        0.9646587371826172,
                        0.25859445333480835
                    ]
                },
                "test": {
                    "score": -5.544429475586258,
                    "pretrain_loss": 1.6513550281524658,
                    "pretrain_component": 0.6936400532722473,
                    "supervised_component": 0.8256775140762329,
                    "features_accuracy": [
                        0.2309330701828003,
                        0.5097362995147705,
                        0.6112576127052307,
                        0.7926470637321472,
                        0.32129818201065063,
                        0.2093813419342041,
                        0.30578094720840454,
                        0.563894510269165,
                        0.36394524574279785,
                        0.27089250087738037,
                        0.6626268029212952,
                        0.7758113741874695,
                        0.7645537853240967,
                        0.7864604592323303,
                        0.7544117569923401,
                        0.7749999761581421,
                        0.6492900848388672,
                        0.7958924770355225,
                        0.7481237649917603,
                        0.5653651356697083,
                        0.21784989535808563,
                        0.2360040545463562,
                        0.3280933201313019,
                        0.5830628871917725,
                        0.24087221920490265,
                        0.49183571338653564,
                        0.21151115000247955,
                        0.7730222940444946,
                        0.739503026008606,
                        0.08924949169158936,
                        0.45836713910102844,
                        0.06029411777853966,
                        0.19518256187438965,
                        0.19954361021518707,
                        0.21353955566883087,
                        0.7925456166267395,
                        0.7995436191558838,
                        0.44944217801094055,
                        0.18828600645065308,
                        0.18448275327682495,
                        0.5532454252243042,
                        0.36932048201560974,
                        0.4323529303073883,
                        0.7919371128082275,
                        0.7224645018577576,
                        0.762221097946167,
                        0.7736308574676514,
                        0.23498985171318054,
                        0.7768762707710266,
                        0.967292070388794,
                        0.261916846036911
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -4.527074448961814,
                    "pretrain_loss": 1.6505053043365479,
                    "pretrain_component": 0.6935238838195801,
                    "supervised_component": 0.8252526521682739,
                    "features_accuracy": [
                        0.24306322634220123,
                        0.5134612321853638,
                        0.559972882270813,
                        0.7928164601325989,
                        0.3116951584815979,
                        0.2110024243593216,
                        0.3351539671421051,
                        0.5412464141845703,
                        0.3843235969543457,
                        0.28437307476997375,
                        0.5082404017448425,
                        0.777084231376648,
                        0.6924092173576355,
                        0.7921059727668762,
                        0.7629569172859192,
                        0.7796977758407593,
                        0.6490630507469177,
                        0.7929940819740295,
                        0.7900760173797607,
                        0.5686002373695374,
                        0.2124551236629486,
                        0.23725879192352295,
                        0.3300917446613312,
                        0.5827401876449585,
                        0.24028471112251282,
                        0.6188989877700806,
                        0.2169273942708969,
                        0.7767543792724609,
                        0.7396439909934998,
                        0.26996028423309326,
                        0.4053971767425537,
                        0.03511843830347061,
                        0.19632956385612488,
                        0.20196907222270966,
                        0.21094533801078796,
                        0.8009617328643799,
                        0.8002512454986572,
                        0.2951001822948456,
                        0.19077888131141663,
                        0.1856151521205902,
                        0.5241883397102356,
                        0.42393332719802856,
                        0.5372689366340637,
                        0.792029857635498,
                        0.5109301209449768,
                        0.7525660395622253,
                        0.7779977321624756,
                        0.23570460081100464,
                        0.7873418927192688,
                        0.9277395009994507,
                        0.2588779330253601
                    ]
                },
                "val": {
                    "score": -5.345846479577454,
                    "pretrain_loss": 1.5640430450439453,
                    "pretrain_component": 0.6935295462608337,
                    "supervised_component": 0.7820215225219727,
                    "features_accuracy": [
                        0.24495486915111542,
                        0.5176452398300171,
                        0.5571950078010559,
                        0.7946455478668213,
                        0.30894431471824646,
                        0.21219956874847412,
                        0.33825168013572693,
                        0.5417300462722778,
                        0.38190850615501404,
                        0.27811580896377563,
                        0.5087718963623047,
                        0.7739579677581787,
                        0.6960247159004211,
                        0.7897778749465942,
                        0.7619916796684265,
                        0.7780650854110718,
                        0.6464354395866394,
                        0.7907919883728027,
                        0.7950004935264587,
                        0.5675387978553772,
                        0.2139742374420166,
                        0.23577730357646942,
                        0.3275022804737091,
                        0.5888347625732422,
                        0.23724773526191711,
                        0.6194097995758057,
                        0.21813203394412994,
                        0.780093252658844,
                        0.746070384979248,
                        0.26792412996292114,
                        0.398843914270401,
                        0.03650745376944542,
                        0.19719095528125763,
                        0.20317411422729492,
                        0.21083053946495056,
                        0.7992089986801147,
                        0.7977892756462097,
                        0.2990061640739441,
                        0.1872021108865738,
                        0.18446405231952667,
                        0.5230199694633484,
                        0.4202413558959961,
                        0.5265693068504333,
                        0.7911469340324402,
                        0.5088733434677124,
                        0.7556028366088867,
                        0.7723861336708069,
                        0.23714633285999298,
                        0.7886623740196228,
                        0.9272385835647583,
                        0.25859445333480835
                    ]
                },
                "test": {
                    "score": -5.59078834490988,
                    "pretrain_loss": 1.632599115371704,
                    "pretrain_component": 0.6935420036315918,
                    "supervised_component": 0.816299557685852,
                    "features_accuracy": [
                        0.2431541532278061,
                        0.5110547542572021,
                        0.5495943427085876,
                        0.7927485108375549,
                        0.3164300322532654,
                        0.21191683411598206,
                        0.33311358094215393,
                        0.5320993661880493,
                        0.38468560576438904,
                        0.28118661046028137,
                        0.5102941393852234,
                        0.7752028703689575,
                        0.6998986005783081,
                        0.7857505083084106,
                        0.7615618705749512,
                        0.7753042578697205,
                        0.6518762707710266,
                        0.7958924770355225,
                        0.7891988158226013,
                        0.565618634223938,
                        0.21531440317630768,
                        0.23924949765205383,
                        0.32773834466934204,
                        0.5830628871917725,
                        0.24112576246261597,
                        0.6237322688102722,
                        0.2151622772216797,
                        0.7767241597175598,
                        0.7386916875839233,
                        0.2843306362628937,
                        0.4162778854370117,
                        0.032910749316215515,
                        0.19518256187438965,
                        0.19939148426055908,
                        0.21475659310817719,
                        0.8034482598304749,
                        0.7994421720504761,
                        0.2959939241409302,
                        0.18813388049602509,
                        0.1844320446252823,
                        0.5143508911132812,
                        0.4371703863143921,
                        0.532707929611206,
                        0.7918863892555237,
                        0.5045132040977478,
                        0.7504056692123413,
                        0.776673436164856,
                        0.2291582226753235,
                        0.7901115417480469,
                        0.9309837818145752,
                        0.261916846036911
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -4.128717089025853,
                    "pretrain_loss": 1.6505470275878906,
                    "pretrain_component": 0.6934637427330017,
                    "supervised_component": 0.8252735137939453,
                    "features_accuracy": [
                        0.2471866011619568,
                        0.5123510956764221,
                        0.5525825023651123,
                        0.7908245921134949,
                        0.3116571009159088,
                        0.2241528034210205,
                        0.31707456707954407,
                        0.561971127986908,
                        0.37870311737060547,
                        0.28825536370277405,
                        0.5260406732559204,
                        0.7683870792388916,
                        0.7016074657440186,
                        0.7932478189468384,
                        0.7537713050842285,
                        0.7800213098526001,
                        0.6620675325393677,
                        0.7912686467170715,
                        0.7832819819450378,
                        0.5694629549980164,
                        0.21406006813049316,
                        0.23867976665496826,
                        0.3303137719631195,
                        0.581649124622345,
                        0.23930779099464417,
                        0.6306982040405273,
                        0.22810490429401398,
                        0.762284517288208,
                        0.7410586476325989,
                        0.33941054344177246,
                        0.5263451933860779,
                        0.04996257275342941,
                        0.1961265653371811,
                        0.2030792087316513,
                        0.21190322935581207,
                        0.8015326261520386,
                        0.8005557060241699,
                        0.30256029963493347,
                        0.19465485215187073,
                        0.18924371898174286,
                        0.4898184537887573,
                        0.4816161096096039,
                        0.37374237179756165,
                        0.7906913757324219,
                        0.4891396760940552,
                        0.7911861538887024,
                        0.77674800157547,
                        0.24428120255470276,
                        0.7904629707336426,
                        0.9375340938568115,
                        0.25833871960639954
                    ]
                },
                "val": {
                    "score": -5.324077727774784,
                    "pretrain_loss": 1.5487868785858154,
                    "pretrain_component": 0.693463921546936,
                    "supervised_component": 0.7743934392929077,
                    "features_accuracy": [
                        0.24865631759166718,
                        0.5165297389030457,
                        0.5496399998664856,
                        0.7934286594390869,
                        0.30884289741516113,
                        0.22578845918178558,
                        0.31888246536254883,
                        0.564902126789093,
                        0.37795352935791016,
                        0.28247642517089844,
                        0.5236284136772156,
                        0.7650846838951111,
                        0.7067234516143799,
                        0.7909948229789734,
                        0.753219723701477,
                        0.7818172574043274,
                        0.6586045622825623,
                        0.7907919883728027,
                        0.7885609865188599,
                        0.5674373507499695,
                        0.22000810503959656,
                        0.23476320505142212,
                        0.3270966410636902,
                        0.5888347625732422,
                        0.2375519722700119,
                        0.6312747001647949,
                        0.2279687523841858,
                        0.7656424045562744,
                        0.7470337748527527,
                        0.33313050866127014,
                        0.5215495228767395,
                        0.053645674139261246,
                        0.19719095528125763,
                        0.20322482287883759,
                        0.21083053946495056,
                        0.7974849939346313,
                        0.7977892756462097,
                        0.30397525429725647,
                        0.19034580886363983,
                        0.18684716522693634,
                        0.48757731914520264,
                        0.47155460715293884,
                        0.37039852142333984,
                        0.7910454869270325,
                        0.4835209250450134,
                        0.7937835454940796,
                        0.7701044082641602,
                        0.24870702624320984,
                        0.789929986000061,
                        0.9362640380859375,
                        0.25874656438827515
                    ]
                },
                "test": {
                    "score": -5.531129796330427,
                    "pretrain_loss": 1.6196510791778564,
                    "pretrain_component": 0.6934834122657776,
                    "supervised_component": 0.8098255395889282,
                    "features_accuracy": [
                        0.24771805107593536,
                        0.509989857673645,
                        0.547768771648407,
                        0.7918357253074646,
                        0.31617647409439087,
                        0.22479715943336487,
                        0.3140973746776581,
                        0.5500507354736328,
                        0.37849900126457214,
                        0.2845841944217682,
                        0.5383874177932739,
                        0.7668356895446777,
                        0.7074036598205566,
                        0.7867646813392639,
                        0.7498478889465332,
                        0.7797160148620605,
                        0.663894534111023,
                        0.7958924770355225,
                        0.7806795239448547,
                        0.565517246723175,
                        0.21784989535808563,
                        0.23722109198570251,
                        0.3284989893436432,
                        0.5830628871917725,
                        0.2409229278564453,
                        0.6346855759620667,
                        0.22702839970588684,
                        0.7642495036125183,
                        0.738387405872345,
                        0.35076063871383667,
                        0.5340771079063416,
                        0.04766734316945076,
                        0.19518256187438965,
                        0.19974644482135773,
                        0.215415820479393,
                        0.8030425906181335,
                        0.7994928956031799,
                        0.29822516441345215,
                        0.19178499281406403,
                        0.18610547482967377,
                        0.4805273711681366,
                        0.48990872502326965,
                        0.36982759833335876,
                        0.7918357253074646,
                        0.48275861144065857,
                        0.7851927280426025,
                        0.7753042578697205,
                        0.24031440913677216,
                        0.7924442291259766,
                        0.9396044611930847,
                        0.2620689570903778
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -4.492922589560768,
                    "pretrain_loss": 1.6400890350341797,
                    "pretrain_component": 0.6934313774108887,
                    "supervised_component": 0.8200445175170898,
                    "features_accuracy": [
                        0.2422512322664261,
                        0.5143176317214966,
                        0.5710108280181885,
                        0.7947322726249695,
                        0.3116888105869293,
                        0.226239874958992,
                        0.34654080867767334,
                        0.583977222442627,
                        0.3713381290435791,
                        0.30239537358283997,
                        0.42314672470092773,
                        0.7605209350585938,
                        0.7163247466087341,
                        0.7867963314056396,
                        0.764073371887207,
                        0.7791268825531006,
                        0.6860718727111816,
                        0.7927403450012207,
                        0.7664586305618286,
                        0.56797856092453,
                        0.2682665288448334,
                        0.24796687066555023,
                        0.32916557788848877,
                        0.5829178094863892,
                        0.24029739201068878,
                        0.5952879786491394,
                        0.22689326107501984,
                        0.7718634009361267,
                        0.7297542691230774,
                        0.32390034198760986,
                        0.44113096594810486,
                        0.03131859004497528,
                        0.19644375145435333,
                        0.2025146335363388,
                        0.21250587701797485,
                        0.8019449710845947,
                        0.8000609278678894,
                        0.2647775411605835,
                        0.19716693460941315,
                        0.19591723382472992,
                        0.540288507938385,
                        0.5446466207504272,
                        0.39765793085098267,
                        0.7905454635620117,
                        0.49139168858528137,
                        0.7721425294876099,
                        0.782761812210083,
                        0.25309252738952637,
                        0.7850391864776611,
                        0.9374833703041077,
                        0.2608000636100769
                    ]
                },
                "val": {
                    "score": -5.313869888967974,
                    "pretrain_loss": 1.5447635650634766,
                    "pretrain_component": 0.6934483051300049,
                    "supervised_component": 0.7723817825317383,
                    "features_accuracy": [
                        0.2438393533229828,
                        0.5175438523292542,
                        0.5667275190353394,
                        0.7939356565475464,
                        0.3090457320213318,
                        0.22872933745384216,
                        0.35189127922058105,
                        0.5866037607192993,
                        0.3712098002433777,
                        0.29454416036605835,
                        0.4235878586769104,
                        0.7573268413543701,
                        0.720058798789978,
                        0.7837440371513367,
                        0.7614846229553223,
                        0.7785214185714722,
                        0.6872528195381165,
                        0.7907919883728027,
                        0.7708142995834351,
                        0.5675894618034363,
                        0.2721833288669586,
                        0.24297738075256348,
                        0.32527124881744385,
                        0.5888347625732422,
                        0.23704491555690765,
                        0.5947672724723816,
                        0.22943919897079468,
                        0.7741101384162903,
                        0.732785701751709,
                        0.3251698613166809,
                        0.43661898374557495,
                        0.03280600160360336,
                        0.19719095528125763,
                        0.20317411422729492,
                        0.21128688752651215,
                        0.799716055393219,
                        0.7977892756462097,
                        0.26381704211235046,
                        0.19222187995910645,
                        0.19394584000110626,
                        0.5406652092933655,
                        0.5442652702331543,
                        0.389666348695755,
                        0.7912483215332031,
                        0.4836730360984802,
                        0.7731974124908447,
                        0.7768988609313965,
                        0.2586958706378937,
                        0.7858229279518127,
                        0.9362133145332336,
                        0.25900009274482727
                    ]
                },
                "test": {
                    "score": -5.556370838942289,
                    "pretrain_loss": 1.6178903579711914,
                    "pretrain_component": 0.6934710144996643,
                    "supervised_component": 0.8089451789855957,
                    "features_accuracy": [
                        0.24031440913677216,
                        0.5104462504386902,
                        0.5639452338218689,
                        0.7925963401794434,
                        0.31713995337486267,
                        0.22870182991027832,
                        0.34295132756233215,
                        0.5708925127983093,
                        0.36972618103027344,
                        0.29934078454971313,
                        0.42692697048187256,
                        0.7585699558258057,
                        0.7204868197441101,
                        0.7812880277633667,
                        0.7601926922798157,
                        0.7774340510368347,
                        0.6869675517082214,
                        0.7958924770355225,
                        0.7632352709770203,
                        0.5655679702758789,
                        0.26587221026420593,
                        0.24923935532569885,
                        0.3266734182834625,
                        0.5830628871917725,
                        0.24046653509140015,
                        0.6017748713493347,
                        0.22641988098621368,
                        0.7700811624526978,
                        0.7262677550315857,
                        0.340263694524765,
                        0.45147058367729187,
                        0.02915821596980095,
                        0.19518256187438965,
                        0.1996450275182724,
                        0.2148580104112625,
                        0.8043610453605652,
                        0.7991886734962463,
                        0.2627789080142975,
                        0.19188641011714935,
                        0.19599391520023346,
                        0.5263184905052185,
                        0.5592799186706543,
                        0.386916846036911,
                        0.7917850017547607,
                        0.4881846010684967,
                        0.7662779092788696,
                        0.7808823585510254,
                        0.24797160923480988,
                        0.7866125702857971,
                        0.9404157996177673,
                        0.26227179169654846
                    ]
                }
            }
        },
        "train": {
            "score": -3.769527525453549
        },
        "val": {
            "score": -5.266428031789176
        },
        "test": {
            "score": -5.544429475586258
        }
    },
    "best_iteration": 10000,
    "time": "0:49:46"
}
