{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised_fast___c5e963dd51d2436e9e3d0cd3c1ba9e21.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0,1",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                },
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 8,
        "data": {
            "path": "data/fb-comments",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512
                ],
                "dropout": 0.3311948744388331
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear",
                "relu"
            ],
            "d_num_embedding": 106,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 512,
            "lr": 0.00010273876920522086,
            "weight_decay": 0.0004961094121876227,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 1024
        },
        "pretrain": {
            "corrupt_probability": 0.7968879116352573,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.00010273876920522086,
            "weight_decay": 0.0004961094121876227,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post",
            "supervised_weight": 1.0
        },
        "bins": {
            "count": 159,
            "value": "ratio",
            "tree": {
                "min_samples_leaf": 67,
                "min_impurity_decrease": 0.00018375444016412894
            },
            "subsample": null
        }
    },
    "n_parameters": 3580216,
    "epoch_size": 308,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -4.246374561500454,
                    "pretrain_loss": 1.6769436597824097,
                    "pretrain_component": 0.6951720118522644,
                    "supervised_component": 0.8384718298912048,
                    "features_accuracy": [
                        0.2055659145116806,
                        0.49004048109054565,
                        0.24175643920898438,
                        0.23794390261173248,
                        0.6399662494659424,
                        0.2047349065542221,
                        0.20614320039749146,
                        0.2053312063217163,
                        0.6441974639892578,
                        0.7876591086387634,
                        0.29242950677871704,
                        0.3269643187522888,
                        0.20661261677742004,
                        0.7374745011329651,
                        0.23396643996238708,
                        0.4528413414955139,
                        0.2068600207567215,
                        0.20796382427215576,
                        0.5566233992576599,
                        0.46243926882743835,
                        0.36800137162208557,
                        0.5841104388237,
                        0.369193971157074,
                        0.4974117875099182,
                        0.6603674292564392,
                        0.29259443283081055,
                        0.40339893102645874,
                        0.7313655614852905,
                        0.25942349433898926,
                        0.9691762328147888,
                        0.20843325555324554,
                        0.9770931005477905,
                        0.3630533218383789,
                        0.781029999256134,
                        0.21383804082870483,
                        0.19773150980472565,
                        0.7995026707649231,
                        0.73625648021698,
                        0.7697636485099792,
                        0.772814929485321,
                        0.202844500541687,
                        0.24173741042613983,
                        0.7574823498725891,
                        0.5810971856117249,
                        0.692973792552948,
                        0.7490072250366211,
                        0.21485936641693115,
                        0.7603052854537964,
                        0.6693120002746582,
                        0.05253175273537636,
                        0.3218957483768463
                    ]
                },
                "val": {
                    "score": -5.304193484702864,
                    "pretrain_loss": 1.5879522562026978,
                    "pretrain_component": 0.6951563358306885,
                    "supervised_component": 0.7939761281013489,
                    "features_accuracy": [
                        0.20195719599723816,
                        0.47865328192710876,
                        0.24941688776016235,
                        0.2365378737449646,
                        0.6454720497131348,
                        0.21001926064491272,
                        0.20621640980243683,
                        0.2064192146062851,
                        0.6487171649932861,
                        0.7844538688659668,
                        0.2985498309135437,
                        0.3295811712741852,
                        0.20834600925445557,
                        0.7397322654724121,
                        0.23283642530441284,
                        0.4546191990375519,
                        0.21098265051841736,
                        0.21422776579856873,
                        0.552885115146637,
                        0.46531790494918823,
                        0.369587242603302,
                        0.5820403695106506,
                        0.3660886287689209,
                        0.4937126040458679,
                        0.6604806780815125,
                        0.29586246609687805,
                        0.4032552242279053,
                        0.7295405864715576,
                        0.25976067781448364,
                        0.969779908657074,
                        0.20621640980243683,
                        0.9763208627700806,
                        0.36385759711265564,
                        0.7755805253982544,
                        0.2141263484954834,
                        0.19734306633472443,
                        0.799056887626648,
                        0.7339012026786804,
                        0.7675691843032837,
                        0.767974853515625,
                        0.20783895254135132,
                        0.24348442256450653,
                        0.7578845620155334,
                        0.5839671492576599,
                        0.6979008316993713,
                        0.7491633296012878,
                        0.21508973836898804,
                        0.7640198469161987,
                        0.6658046841621399,
                        0.054203424602746964,
                        0.3251698613166809
                    ]
                },
                "test": {
                    "score": -5.487959342768128,
                    "pretrain_loss": 1.6652292013168335,
                    "pretrain_component": 0.6951332092285156,
                    "supervised_component": 0.8326146006584167,
                    "features_accuracy": [
                        0.20963488519191742,
                        0.49224138259887695,
                        0.2453346848487854,
                        0.23468559980392456,
                        0.6416328549385071,
                        0.20370182394981384,
                        0.20791074633598328,
                        0.20502027869224548,
                        0.6376774907112122,
                        0.7840771079063416,
                        0.28149086236953735,
                        0.3236815333366394,
                        0.20943205058574677,
                        0.7333671450614929,
                        0.238894522190094,
                        0.4636409878730774,
                        0.20872211456298828,
                        0.2099391520023346,
                        0.5476673245429993,
                        0.4648580253124237,
                        0.37449291348457336,
                        0.5741886496543884,
                        0.3663285970687866,
                        0.5003042817115784,
                        0.6592799425125122,
                        0.29178500175476074,
                        0.3947261571884155,
                        0.7307809591293335,
                        0.252231240272522,
                        0.9707911014556885,
                        0.20527383685112,
                        0.9788539409637451,
                        0.36338743567466736,
                        0.7840263843536377,
                        0.2198275923728943,
                        0.1998985856771469,
                        0.8001521229743958,
                        0.7433570027351379,
                        0.7734786868095398,
                        0.776673436164856,
                        0.1996450275182724,
                        0.25126776099205017,
                        0.7473630905151367,
                        0.5860547423362732,
                        0.6949290037155151,
                        0.7403144240379333,
                        0.21298174560070038,
                        0.7601926922798157,
                        0.6746957302093506,
                        0.05588235333561897,
                        0.31977689266204834
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -4.312765541789063,
                    "pretrain_loss": 1.6563620567321777,
                    "pretrain_component": 0.6952476501464844,
                    "supervised_component": 0.8281810283660889,
                    "features_accuracy": [
                        0.20599094033241272,
                        0.48928558826446533,
                        0.21531610190868378,
                        0.2610728442668915,
                        0.6826019287109375,
                        0.2046397477388382,
                        0.2084459364414215,
                        0.20644769072532654,
                        0.64134281873703,
                        0.7928545475006104,
                        0.10023598372936249,
                        0.3524150252342224,
                        0.20855377614498138,
                        0.6344663500785828,
                        0.23329401016235352,
                        0.7072533369064331,
                        0.20932769775390625,
                        0.21032999455928802,
                        0.6183978319168091,
                        0.4412514865398407,
                        0.5496010184288025,
                        0.5084244012832642,
                        0.342151015996933,
                        0.5666844248771667,
                        0.6038645505905151,
                        0.27728721499443054,
                        0.4041792154312134,
                        0.5812811851501465,
                        0.25757116079330444,
                        0.9707114100456238,
                        0.17460256814956665,
                        0.9882388710975647,
                        0.2814105749130249,
                        0.794097900390625,
                        0.21644528210163116,
                        0.19676728546619415,
                        0.7968129515647888,
                        0.7374998331069946,
                        0.7722757458686829,
                        0.7808079719543457,
                        0.19454699754714966,
                        0.23696063458919525,
                        0.7416422367095947,
                        0.6906329989433289,
                        0.4416764974594116,
                        0.44276127219200134,
                        0.2063588798046112,
                        0.7615993618965149,
                        0.7005861401557922,
                        0.1679544299840927,
                        0.41529327630996704
                    ]
                },
                "val": {
                    "score": -5.328592474152927,
                    "pretrain_loss": 1.5777775049209595,
                    "pretrain_component": 0.695247232913971,
                    "supervised_component": 0.7888887524604797,
                    "features_accuracy": [
                        0.20195719599723816,
                        0.48524489998817444,
                        0.21706722676753998,
                        0.2566169798374176,
                        0.6874049305915833,
                        0.20996855199337006,
                        0.20616570115089417,
                        0.20687556266784668,
                        0.6447114944458008,
                        0.7907919883728027,
                        0.105973020195961,
                        0.360409677028656,
                        0.2082953006029129,
                        0.642429769039154,
                        0.23283642530441284,
                        0.7057093381881714,
                        0.21098265051841736,
                        0.21367000043392181,
                        0.6212351322174072,
                        0.4490923583507538,
                        0.5453807711601257,
                        0.5079099535942078,
                        0.33571645617485046,
                        0.5685528516769409,
                        0.6026772260665894,
                        0.2787749767303467,
                        0.4031031131744385,
                        0.5862488150596619,
                        0.2599634826183319,
                        0.9710982441902161,
                        0.1739681512117386,
                        0.9877800941467285,
                        0.2831355631351471,
                        0.787749707698822,
                        0.2152925580739975,
                        0.19785010814666748,
                        0.794899046421051,
                        0.7369434833526611,
                        0.7692931294441223,
                        0.7741101384162903,
                        0.20124733448028564,
                        0.23592941462993622,
                        0.7396815419197083,
                        0.6961768269538879,
                        0.4432106018066406,
                        0.4452895224094391,
                        0.20672345161437988,
                        0.7658959031105042,
                        0.6942500472068787,
                        0.1663624346256256,
                        0.40690597891807556
                    ]
                },
                "test": {
                    "score": -5.54928012006353,
                    "pretrain_loss": 1.6435182094573975,
                    "pretrain_component": 0.6952512860298157,
                    "supervised_component": 0.8217591047286987,
                    "features_accuracy": [
                        0.20963488519191742,
                        0.4949290156364441,
                        0.215567946434021,
                        0.2539553642272949,
                        0.6808823347091675,
                        0.20370182394981384,
                        0.20791074633598328,
                        0.20532454550266266,
                        0.6382352709770203,
                        0.7923935055732727,
                        0.09908722341060638,
                        0.351369172334671,
                        0.20958417654037476,
                        0.6324543356895447,
                        0.238894522190094,
                        0.7117646932601929,
                        0.20872211456298828,
                        0.21039554476737976,
                        0.6101927161216736,
                        0.4460446238517761,
                        0.5591278076171875,
                        0.4953346848487854,
                        0.33732250332832336,
                        0.5675963759422302,
                        0.5970588326454163,
                        0.27530425786972046,
                        0.38975659012794495,
                        0.5746957659721375,
                        0.2523326575756073,
                        0.9713488817214966,
                        0.1728701889514923,
                        0.988894522190094,
                        0.27986815571784973,
                        0.7970080971717834,
                        0.22251521050930023,
                        0.20000000298023224,
                        0.7948783040046692,
                        0.7424442172050476,
                        0.7781947255134583,
                        0.782200813293457,
                        0.19178499281406403,
                        0.2435598373413086,
                        0.7297160029411316,
                        0.6982758641242981,
                        0.4478701949119568,
                        0.42677485942840576,
                        0.2045639008283615,
                        0.7614097595214844,
                        0.7080628871917725,
                        0.181947261095047,
                        0.4180527329444885
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -3.9933818960184695,
                    "pretrain_loss": 1.6466811895370483,
                    "pretrain_component": 0.6954256296157837,
                    "supervised_component": 0.8233405947685242,
                    "features_accuracy": [
                        0.2073231190443039,
                        0.5034509301185608,
                        0.21800582110881805,
                        0.22679176926612854,
                        0.6804704666137695,
                        0.20640328526496887,
                        0.208547443151474,
                        0.20474758744239807,
                        0.6634567975997925,
                        0.7859336137771606,
                        0.12595313787460327,
                        0.35130488872528076,
                        0.20633985102176666,
                        0.6092503070831299,
                        0.23441049456596375,
                        0.7048173546791077,
                        0.2099747508764267,
                        0.20943555235862732,
                        0.5593512058258057,
                        0.4440617263317108,
                        0.47331228852272034,
                        0.4832591116428375,
                        0.3377992808818817,
                        0.5195574760437012,
                        0.6936715841293335,
                        0.2674545645713806,
                        0.414252907037735,
                        0.6966911554336548,
                        0.2593410313129425,
                        0.9695124626159668,
                        0.1868077516555786,
                        0.985999584197998,
                        0.3220099210739136,
                        0.7944150567054749,
                        0.22285236418247223,
                        0.19856253266334534,
                        0.7979801893234253,
                        0.6984546780586243,
                        0.7673530578613281,
                        0.7414582967758179,
                        0.19023331999778748,
                        0.2114020735025406,
                        0.7588779330253601,
                        0.6447049975395203,
                        0.4981032609939575,
                        0.5485733151435852,
                        0.2057942897081375,
                        0.7614598274230957,
                        0.7431584000587463,
                        0.3364163637161255,
                        0.3047361671924591
                    ]
                },
                "val": {
                    "score": -5.307871015822636,
                    "pretrain_loss": 1.5683521032333374,
                    "pretrain_component": 0.6954166293144226,
                    "supervised_component": 0.7841760516166687,
                    "features_accuracy": [
                        0.20195719599723816,
                        0.5006084442138672,
                        0.21970388293266296,
                        0.2260419726371765,
                        0.6837541460990906,
                        0.20996855199337006,
                        0.20621640980243683,
                        0.20646992325782776,
                        0.6669708490371704,
                        0.7851637601852417,
                        0.13244092464447021,
                        0.3576209247112274,
                        0.20834600925445557,
                        0.6182942986488342,
                        0.23283642530441284,
                        0.7058614492416382,
                        0.21098265051841736,
                        0.2126559168100357,
                        0.5597302317619324,
                        0.45132339000701904,
                        0.46891793608665466,
                        0.4844336211681366,
                        0.3336375653743744,
                        0.5184058547019958,
                        0.6953655481338501,
                        0.2663522958755493,
                        0.41826385259628296,
                        0.7008923888206482,
                        0.2598113715648651,
                        0.969678521156311,
                        0.18750633299350739,
                        0.9859040379524231,
                        0.32101204991340637,
                        0.7889665961265564,
                        0.22441942989826202,
                        0.1989656239748001,
                        0.7977385520935059,
                        0.6969881057739258,
                        0.7657437920570374,
                        0.7316702008247375,
                        0.19566980004310608,
                        0.21057701110839844,
                        0.7596085667610168,
                        0.6452692151069641,
                        0.5029408931732178,
                        0.5537977814674377,
                        0.20692627131938934,
                        0.7657945156097412,
                        0.7356758713722229,
                        0.33110231161117554,
                        0.30504006147384644
                    ]
                },
                "test": {
                    "score": -5.531418645552602,
                    "pretrain_loss": 1.6350630521774292,
                    "pretrain_component": 0.6954352855682373,
                    "supervised_component": 0.8175315260887146,
                    "features_accuracy": [
                        0.2095334678888321,
                        0.5035496950149536,
                        0.21942190825939178,
                        0.22444219887256622,
                        0.6786004304885864,
                        0.20370182394981384,
                        0.20821501314640045,
                        0.20502027869224548,
                        0.6565415859222412,
                        0.7853955626487732,
                        0.12165314704179764,
                        0.3476673364639282,
                        0.20943205058574677,
                        0.5984280109405518,
                        0.238894522190094,
                        0.7099898457527161,
                        0.20872211456298828,
                        0.20892494916915894,
                        0.5526369214057922,
                        0.4445740282535553,
                        0.48610547184944153,
                        0.4712981879711151,
                        0.3366125822067261,
                        0.5189148187637329,
                        0.6889452338218689,
                        0.26435092091560364,
                        0.40141987800598145,
                        0.694371223449707,
                        0.252231240272522,
                        0.9702839851379395,
                        0.18519270420074463,
                        0.9875253438949585,
                        0.32378295063972473,
                        0.7975659370422363,
                        0.22971603274345398,
                        0.20167343318462372,
                        0.7983265519142151,
                        0.7036004066467285,
                        0.7723124027252197,
                        0.743914783000946,
                        0.1890973597764969,
                        0.21495942771434784,
                        0.750507116317749,
                        0.654411792755127,
                        0.5002028346061707,
                        0.5379817485809326,
                        0.20461460947990417,
                        0.7619168162345886,
                        0.7440162301063538,
                        0.3597870171070099,
                        0.29781946539878845
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -4.236909123281407,
                    "pretrain_loss": 1.6412312984466553,
                    "pretrain_component": 0.6957233548164368,
                    "supervised_component": 0.8206156492233276,
                    "features_accuracy": [
                        0.20833174884319305,
                        0.511145830154419,
                        0.25667670369148254,
                        0.24669814109802246,
                        0.6826780438423157,
                        0.205629363656044,
                        0.20710107684135437,
                        0.2057689130306244,
                        0.6501795649528503,
                        0.784690260887146,
                        0.16127456724643707,
                        0.311333566904068,
                        0.20584504306316376,
                        0.5369898080825806,
                        0.2315114438533783,
                        0.7014552354812622,
                        0.20723429322242737,
                        0.20971466600894928,
                        0.5087922811508179,
                        0.4550933241844177,
                        0.6076771020889282,
                        0.48186352849006653,
                        0.34547507762908936,
                        0.526757538318634,
                        0.6455867290496826,
                        0.28493764996528625,
                        0.4114680588245392,
                        0.6108806133270264,
                        0.25637221336364746,
                        0.9714028835296631,
                        0.181314155459404,
                        0.9856570363044739,
                        0.28507721424102783,
                        0.7848678827285767,
                        0.21470077335834503,
                        0.19766174256801605,
                        0.7871262431144714,
                        0.7424098253250122,
                        0.7794250249862671,
                        0.7364341020584106,
                        0.1890660971403122,
                        0.22355017066001892,
                        0.7049188613891602,
                        0.701448917388916,
                        0.5054745674133301,
                        0.6548294425010681,
                        0.20664434134960175,
                        0.7605653405189514,
                        0.7088836431503296,
                        0.31132087111473083,
                        0.3350144028663635
                    ]
                },
                "val": {
                    "score": -5.3434639980048475,
                    "pretrain_loss": 1.5581122636795044,
                    "pretrain_component": 0.6957035064697266,
                    "supervised_component": 0.7790561318397522,
                    "features_accuracy": [
                        0.20195719599723816,
                        0.5064395070075989,
                        0.26021701097488403,
                        0.24632389843463898,
                        0.6881654858589172,
                        0.21006996929645538,
                        0.20621640980243683,
                        0.2064192146062851,
                        0.6548524498939514,
                        0.7848595380783081,
                        0.16991177201271057,
                        0.3139640986919403,
                        0.2082953006029129,
                        0.5439610481262207,
                        0.23283642530441284,
                        0.6998782753944397,
                        0.21098265051841736,
                        0.21331506967544556,
                        0.5120677351951599,
                        0.45715442299842834,
                        0.6068856716156006,
                        0.48159414529800415,
                        0.33982354402542114,
                        0.5292059779167175,
                        0.6516580581665039,
                        0.2843017876148224,
                        0.4117736518383026,
                        0.6125138998031616,
                        0.2598620653152466,
                        0.9708446860313416,
                        0.18126964569091797,
                        0.9853969812393188,
                        0.28668490052223206,
                        0.77933269739151,
                        0.21595172584056854,
                        0.19906702637672424,
                        0.7867355942726135,
                        0.7408984899520874,
                        0.7762396931648254,
                        0.7296420335769653,
                        0.196075439453125,
                        0.22370955348014832,
                        0.7076868414878845,
                        0.6981543302536011,
                        0.5116114020347595,
                        0.6578947305679321,
                        0.20799106359481812,
                        0.7637156248092651,
                        0.7017543911933899,
                        0.31345704197883606,
                        0.32861778140068054
                    ]
                },
                "test": {
                    "score": -5.564153134513471,
                    "pretrain_loss": 1.6272259950637817,
                    "pretrain_component": 0.695733904838562,
                    "supervised_component": 0.8136129975318909,
                    "features_accuracy": [
                        0.20963488519191742,
                        0.5106998085975647,
                        0.25801217555999756,
                        0.24426977336406708,
                        0.6814908981323242,
                        0.20370182394981384,
                        0.2080121785402298,
                        0.20502027869224548,
                        0.6473124027252197,
                        0.7847869992256165,
                        0.15537525713443756,
                        0.30882352590560913,
                        0.2093813419342041,
                        0.5283975601196289,
                        0.238894522190094,
                        0.7042089104652405,
                        0.20872211456298828,
                        0.2114604413509369,
                        0.5020284056663513,
                        0.45370182394981384,
                        0.6174949407577515,
                        0.4711967706680298,
                        0.3419371247291565,
                        0.5320993661880493,
                        0.6395537853240967,
                        0.2805781066417694,
                        0.39700812101364136,
                        0.6049695611000061,
                        0.25253549218177795,
                        0.9709939360618591,
                        0.17981743812561035,
                        0.9867647290229797,
                        0.28722110390663147,
                        0.7881338596343994,
                        0.22139959037303925,
                        0.20147058367729187,
                        0.7879817485809326,
                        0.7513184547424316,
                        0.7836713790893555,
                        0.7428498864173889,
                        0.1887931078672409,
                        0.22870182991027832,
                        0.6973123550415039,
                        0.7034989595413208,
                        0.5057302117347717,
                        0.6512677669525146,
                        0.20578093826770782,
                        0.7608519196510315,
                        0.71445232629776,
                        0.33306288719177246,
                        0.330578088760376
                    ]
                }
            }
        },
        "train": {
            "score": -4.246374561500454
        },
        "val": {
            "score": -5.304193484702864
        },
        "test": {
            "score": -5.487959342768128
        }
    },
    "best_iteration": 10000,
    "time": "0:49:24"
}
