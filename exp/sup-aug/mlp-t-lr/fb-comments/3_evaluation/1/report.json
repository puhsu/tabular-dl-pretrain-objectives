{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised_fast___c5e963dd51d2436e9e3d0cd3c1ba9e21.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0,1",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                },
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 1,
        "data": {
            "path": "data/fb-comments",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512
                ],
                "dropout": 0.3311948744388331
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear",
                "relu"
            ],
            "d_num_embedding": 106,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 512,
            "lr": 0.00010273876920522086,
            "weight_decay": 0.0004961094121876227,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 1024
        },
        "pretrain": {
            "corrupt_probability": 0.7968879116352573,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.00010273876920522086,
            "weight_decay": 0.0004961094121876227,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post",
            "supervised_weight": 1.0
        },
        "bins": {
            "count": 159,
            "value": "ratio",
            "tree": {
                "min_samples_leaf": 67,
                "min_impurity_decrease": 0.00018375444016412894
            },
            "subsample": null
        }
    },
    "n_parameters": 3580216,
    "epoch_size": 308,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -3.98757656727579,
                    "pretrain_loss": 1.6701854467391968,
                    "pretrain_component": 0.691563069820404,
                    "supervised_component": 0.8350927233695984,
                    "features_accuracy": [
                        0.7167878746986389,
                        0.5142732262611389,
                        0.2746228873729706,
                        0.5779063701629639,
                        0.6154861450195312,
                        0.7111420035362244,
                        0.7922137975692749,
                        0.764079749584198,
                        0.6416029334068298,
                        0.3801811933517456,
                        0.987268328666687,
                        0.4615638554096222,
                        0.2310420125722885,
                        0.7910973429679871,
                        0.2334652841091156,
                        0.2051028311252594,
                        0.4097045361995697,
                        0.5532612800598145,
                        0.4610309898853302,
                        0.5285020470619202,
                        0.45081135630607605,
                        0.32188305258750916,
                        0.3718583285808563,
                        0.5915452241897583,
                        0.27240893244743347,
                        0.7420799732208252,
                        0.7087821364402771,
                        0.7140600681304932,
                        0.7362374663352966,
                        0.9707367420196533,
                        0.7573237419128418,
                        0.7657290697097778,
                        0.19594261050224304,
                        0.4349903166294098,
                        0.7891815304756165,
                        0.28659969568252563,
                        0.6396681070327759,
                        0.1897956132888794,
                        0.6744059324264526,
                        0.18499347567558289,
                        0.7702775001525879,
                        0.7442939281463623,
                        0.7926452159881592,
                        0.7908816337585449,
                        0.8009807467460632,
                        0.8051421642303467,
                        0.20732945203781128,
                        0.2321077436208725,
                        0.3504294753074646,
                        0.5246450901031494,
                        0.675757110118866
                    ]
                },
                "val": {
                    "score": -5.298337961625103,
                    "pretrain_loss": 1.546675682067871,
                    "pretrain_component": 0.6915550231933594,
                    "supervised_component": 0.7733378410339355,
                    "features_accuracy": [
                        0.7162559628486633,
                        0.5184058547019958,
                        0.27618902921676636,
                        0.578389585018158,
                        0.6262549161911011,
                        0.7097150087356567,
                        0.7853158712387085,
                        0.7608761787414551,
                        0.6448636054992676,
                        0.37724366784095764,
                        0.987273097038269,
                        0.46121081709861755,
                        0.2263462096452713,
                        0.7963188290596008,
                        0.2339012175798416,
                        0.20981644093990326,
                        0.4038130044937134,
                        0.5510089993476868,
                        0.4592333436012268,
                        0.5263157486915588,
                        0.4557346999645233,
                        0.32902342081069946,
                        0.3749619722366333,
                        0.5934996008872986,
                        0.2706114947795868,
                        0.744042158126831,
                        0.7071797847747803,
                        0.7126559019088745,
                        0.7397322654724121,
                        0.972619354724884,
                        0.7554000616073608,
                        0.7671635746955872,
                        0.1941993683576584,
                        0.43748098611831665,
                        0.7882060408592224,
                        0.29180610179901123,
                        0.6362944841384888,
                        0.19262751936912537,
                        0.6744751930236816,
                        0.18552884459495544,
                        0.7699016332626343,
                        0.7451576590538025,
                        0.7916032671928406,
                        0.7936821579933167,
                        0.8055977821350098,
                        0.8091978430747986,
                        0.2020586133003235,
                        0.22948990762233734,
                        0.3546293377876282,
                        0.5204340219497681,
                        0.67148357629776
                    ]
                },
                "test": {
                    "score": -5.541517918704825,
                    "pretrain_loss": 1.6387871503829956,
                    "pretrain_component": 0.6915299892425537,
                    "supervised_component": 0.8193935751914978,
                    "features_accuracy": [
                        0.713945209980011,
                        0.5136409997940063,
                        0.27352941036224365,
                        0.5874239206314087,
                        0.6108519434928894,
                        0.7175963521003723,
                        0.7932048439979553,
                        0.7679513096809387,
                        0.6440669298171997,
                        0.3706389367580414,
                        0.9884381294250488,
                        0.45507100224494934,
                        0.2299695760011673,
                        0.7912778854370117,
                        0.23493914306163788,
                        0.20669370889663696,
                        0.4235801100730896,
                        0.5630324482917786,
                        0.46328601241111755,
                        0.5302231311798096,
                        0.4511663317680359,
                        0.3233772814273834,
                        0.36901623010635376,
                        0.5905172228813171,
                        0.2670385539531708,
                        0.7446754574775696,
                        0.7148073315620422,
                        0.7166328430175781,
                        0.7386916875839233,
                        0.9728701710700989,
                        0.7619675397872925,
                        0.7727687954902649,
                        0.19705882668495178,
                        0.4423935115337372,
                        0.7873225212097168,
                        0.2871703803539276,
                        0.6459938883781433,
                        0.18919877707958221,
                        0.6798174381256104,
                        0.18534483015537262,
                        0.7702332735061646,
                        0.736156165599823,
                        0.7911764979362488,
                        0.7917342782020569,
                        0.8003042340278625,
                        0.7978194952011108,
                        0.20152129232883453,
                        0.23772819340229034,
                        0.3434077203273773,
                        0.5314908623695374,
                        0.6761663556098938
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -4.118156612947767,
                    "pretrain_loss": 1.6600937843322754,
                    "pretrain_component": 0.6916358470916748,
                    "supervised_component": 0.8300468921661377,
                    "features_accuracy": [
                        0.6928976774215698,
                        0.5145079493522644,
                        0.2520204484462738,
                        0.7352288365364075,
                        0.5587802529335022,
                        0.44076302647590637,
                        0.7930511832237244,
                        0.766281008720398,
                        0.6463860273361206,
                        0.3243253529071808,
                        0.980525016784668,
                        0.41038328409194946,
                        0.21962344646453857,
                        0.792626142501831,
                        0.23385225236415863,
                        0.21039344370365143,
                        0.5097121596336365,
                        0.6387926936149597,
                        0.4455842077732086,
                        0.519874632358551,
                        0.5158528089523315,
                        0.3791217803955078,
                        0.36720842123031616,
                        0.5525063872337341,
                        0.3098301291465759,
                        0.7434121370315552,
                        0.6975095272064209,
                        0.7612568140029907,
                        0.7387305498123169,
                        0.9710856676101685,
                        0.7011507749557495,
                        0.8177787065505981,
                        0.19618366658687592,
                        0.518282413482666,
                        0.7883695960044861,
                        0.35946282744407654,
                        0.5997729301452637,
                        0.1892944574356079,
                        0.7291960120201111,
                        0.18595770001411438,
                        0.6941664218902588,
                        0.6635646224021912,
                        0.766014575958252,
                        0.7894543409347534,
                        0.7797802686691284,
                        0.8074512481689453,
                        0.2051028311252594,
                        0.2309151440858841,
                        0.37216916680336,
                        0.5799426436424255,
                        0.7203656435012817
                    ]
                },
                "val": {
                    "score": -5.316939524346179,
                    "pretrain_loss": 1.5296714305877686,
                    "pretrain_component": 0.6916316151618958,
                    "supervised_component": 0.7648357152938843,
                    "features_accuracy": [
                        0.6970388293266296,
                        0.5184058547019958,
                        0.25494369864463806,
                        0.7341547012329102,
                        0.5720008015632629,
                        0.4307372272014618,
                        0.7856200933456421,
                        0.7650339603424072,
                        0.6480579972267151,
                        0.324764221906662,
                        0.979718029499054,
                        0.4092891216278076,
                        0.21823343634605408,
                        0.7971301078796387,
                        0.23308993875980377,
                        0.21306155622005463,
                        0.5073014497756958,
                        0.6351789832115173,
                        0.4428049623966217,
                        0.5151100158691406,
                        0.5170367956161499,
                        0.37734508514404297,
                        0.3652266263961792,
                        0.5541527271270752,
                        0.31320351362228394,
                        0.7438900470733643,
                        0.6980529427528381,
                        0.7600141763687134,
                        0.7409998774528503,
                        0.9725179672241211,
                        0.6980022192001343,
                        0.8114795684814453,
                        0.1941993683576584,
                        0.521194577217102,
                        0.7882060408592224,
                        0.3635026812553406,
                        0.5932968258857727,
                        0.19293174147605896,
                        0.7288814187049866,
                        0.18552884459495544,
                        0.6934387683868408,
                        0.6604299545288086,
                        0.7652367949485779,
                        0.7936821579933167,
                        0.7894736528396606,
                        0.8091978430747986,
                        0.20231212675571442,
                        0.2295406013727188,
                        0.3712098002433777,
                        0.5778318643569946,
                        0.7166615724563599
                    ]
                },
                "test": {
                    "score": -5.570433111268894,
                    "pretrain_loss": 1.6267845630645752,
                    "pretrain_component": 0.6915988326072693,
                    "supervised_component": 0.8133922815322876,
                    "features_accuracy": [
                        0.6923935413360596,
                        0.5136409997940063,
                        0.2508620619773865,
                        0.7330628633499146,
                        0.5574543476104736,
                        0.44163286685943604,
                        0.7931541800498962,
                        0.7673428058624268,
                        0.647210955619812,
                        0.318864107131958,
                        0.9819979667663574,
                        0.4007606506347656,
                        0.22038540244102478,
                        0.7929006218910217,
                        0.2332657277584076,
                        0.21004056930541992,
                        0.522819459438324,
                        0.6442190408706665,
                        0.45136916637420654,
                        0.5167343020439148,
                        0.5207910537719727,
                        0.37712982296943665,
                        0.36353954672813416,
                        0.5496450066566467,
                        0.31374239921569824,
                        0.7446754574775696,
                        0.7053245306015015,
                        0.7613083124160767,
                        0.7380831837654114,
                        0.9728701710700989,
                        0.7079614400863647,
                        0.8251521587371826,
                        0.19705882668495178,
                        0.5193204879760742,
                        0.7873225212097168,
                        0.36343812942504883,
                        0.6069979667663574,
                        0.18980729579925537,
                        0.7312373518943787,
                        0.18534483015537262,
                        0.6942190527915955,
                        0.6560344696044922,
                        0.7661764621734619,
                        0.7917342782020569,
                        0.7825557589530945,
                        0.7978194952011108,
                        0.20147058367729187,
                        0.237778902053833,
                        0.3633367121219635,
                        0.5882859826087952,
                        0.7182555794715881
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -4.876793033747045,
                    "pretrain_loss": 1.6461762189865112,
                    "pretrain_component": 0.691271185874939,
                    "supervised_component": 0.8230881094932556,
                    "features_accuracy": [
                        0.6514102220535278,
                        0.5145776867866516,
                        0.27055659890174866,
                        0.7094926238059998,
                        0.5896167159080505,
                        0.4708763360977173,
                        0.7899301052093506,
                        0.7494829893112183,
                        0.6524378657341003,
                        0.3811454176902771,
                        0.9703053832054138,
                        0.2928481698036194,
                        0.23036323487758636,
                        0.7915858030319214,
                        0.23383955657482147,
                        0.2099684178829193,
                        0.5629924535751343,
                        0.6498813629150391,
                        0.49212753772735596,
                        0.47631916403770447,
                        0.4766807556152344,
                        0.3447074890136719,
                        0.33786270022392273,
                        0.5727553367614746,
                        0.2933049201965332,
                        0.743336021900177,
                        0.7314099669456482,
                        0.7777947187423706,
                        0.7320379614830017,
                        0.9705591201782227,
                        0.7667186856269836,
                        0.827440083026886,
                        0.19703371822834015,
                        0.609529435634613,
                        0.7897080779075623,
                        0.3433436155319214,
                        0.7649678587913513,
                        0.18997958302497864,
                        0.7132353782653809,
                        0.18530431389808655,
                        0.6722680926322937,
                        0.6345868706703186,
                        0.7919917702674866,
                        0.7910148501396179,
                        0.7866377830505371,
                        0.804431676864624,
                        0.20687904953956604,
                        0.23110544681549072,
                        0.4016988277435303,
                        0.5973179340362549,
                        0.7273753881454468
                    ]
                },
                "val": {
                    "score": -5.434296710978983,
                    "pretrain_loss": 1.5179972648620605,
                    "pretrain_component": 0.6912747025489807,
                    "supervised_component": 0.7589986324310303,
                    "features_accuracy": [
                        0.6592637300491333,
                        0.5185072422027588,
                        0.27051007747650146,
                        0.7085487842559814,
                        0.5992799997329712,
                        0.46729540824890137,
                        0.7848088145256042,
                        0.7502281665802002,
                        0.6536862254142761,
                        0.381553590297699,
                        0.9677010178565979,
                        0.2965216338634491,
                        0.23040258884429932,
                        0.7958624958992004,
                        0.23364770412445068,
                        0.2129601389169693,
                        0.5584118962287903,
                        0.6492242217063904,
                        0.4915322959423065,
                        0.4713010787963867,
                        0.47474899888038635,
                        0.3454517722129822,
                        0.33733901381492615,
                        0.58183753490448,
                        0.29018354415893555,
                        0.7436365485191345,
                        0.7274616956710815,
                        0.773704469203949,
                        0.7343575358390808,
                        0.972568690776825,
                        0.763766348361969,
                        0.8225839138031006,
                        0.1941993683576584,
                        0.6156069040298462,
                        0.7882060408592224,
                        0.34129399061203003,
                        0.7626001238822937,
                        0.19328667223453522,
                        0.7110840678215027,
                        0.18552884459495544,
                        0.6705709099769592,
                        0.6370043158531189,
                        0.7897778749465942,
                        0.7935807704925537,
                        0.7953047156333923,
                        0.8091978430747986,
                        0.20200790464878082,
                        0.22964201867580414,
                        0.4059425890445709,
                        0.6054152846336365,
                        0.7261433601379395
                    ]
                },
                "test": {
                    "score": -5.643215579414439,
                    "pretrain_loss": 1.612701654434204,
                    "pretrain_component": 0.6912418603897095,
                    "supervised_component": 0.806350827217102,
                    "features_accuracy": [
                        0.6490365266799927,
                        0.5134888291358948,
                        0.2652129828929901,
                        0.7137423753738403,
                        0.577738344669342,
                        0.4708924889564514,
                        0.7928498983383179,
                        0.7521805167198181,
                        0.6509634852409363,
                        0.37479716539382935,
                        0.970537543296814,
                        0.283620685338974,
                        0.2324543595314026,
                        0.7906693816184998,
                        0.23377281427383423,
                        0.20988844335079193,
                        0.5713489055633545,
                        0.6573022603988647,
                        0.49457404017448425,
                        0.46683570742607117,
                        0.4732758700847626,
                        0.3481237292289734,
                        0.33620691299438477,
                        0.5772819519042969,
                        0.29355984926223755,
                        0.7445740103721619,
                        0.7331135869026184,
                        0.775557816028595,
                        0.7330121994018555,
                        0.9728701710700989,
                        0.7709432244300842,
                        0.8360547423362732,
                        0.19705882668495178,
                        0.6132352948188782,
                        0.7873225212097168,
                        0.34898579120635986,
                        0.7662271857261658,
                        0.18970587849617004,
                        0.7168356776237488,
                        0.18534483015537262,
                        0.6737322807312012,
                        0.6326065063476562,
                        0.7902129888534546,
                        0.7917342782020569,
                        0.7887424230575562,
                        0.7978194952011108,
                        0.2014198750257492,
                        0.23782961070537567,
                        0.39320486783981323,
                        0.6097363233566284,
                        0.7274340987205505
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -4.905438381250821,
                    "pretrain_loss": 1.6406131982803345,
                    "pretrain_component": 0.6910123229026794,
                    "supervised_component": 0.8203065991401672,
                    "features_accuracy": [
                        0.6488410234451294,
                        0.5144698619842529,
                        0.2821083664894104,
                        0.6230794787406921,
                        0.5967596769332886,
                        0.4721006453037262,
                        0.7925944328308105,
                        0.7583006620407104,
                        0.6488727331161499,
                        0.36655503511428833,
                        0.9826628565788269,
                        0.2703409194946289,
                        0.22527563571929932,
                        0.7858003973960876,
                        0.2379058450460434,
                        0.21312755346298218,
                        0.6237074732780457,
                        0.6304317712783813,
                        0.64267498254776,
                        0.44696712493896484,
                        0.5790038108825684,
                        0.3227965533733368,
                        0.3436988592147827,
                        0.573903501033783,
                        0.3146069049835205,
                        0.7410967350006104,
                        0.7220974564552307,
                        0.7362057566642761,
                        0.7365673184394836,
                        0.9700326323509216,
                        0.7449409365653992,
                        0.8140803575515747,
                        0.19533361494541168,
                        0.5081261992454529,
                        0.7888453602790833,
                        0.4748157262802124,
                        0.7544373869895935,
                        0.1897258311510086,
                        0.6943186521530151,
                        0.18600210547447205,
                        0.7752509117126465,
                        0.6202946305274963,
                        0.784683883190155,
                        0.791433572769165,
                        0.8006508946418762,
                        0.8045458793640137,
                        0.206295445561409,
                        0.23288166522979736,
                        0.3595135807991028,
                        0.5918877720832825,
                        0.7171684503555298
                    ]
                },
                "val": {
                    "score": -5.426818065268343,
                    "pretrain_loss": 1.5097477436065674,
                    "pretrain_component": 0.6910200119018555,
                    "supervised_component": 0.7548738718032837,
                    "features_accuracy": [
                        0.6557143926620483,
                        0.5185072422027588,
                        0.2797383666038513,
                        0.6183449625968933,
                        0.6074434518814087,
                        0.46901935338974,
                        0.7856200933456421,
                        0.7589493989944458,
                        0.6521143913269043,
                        0.36979007720947266,
                        0.9821012020111084,
                        0.2778622806072235,
                        0.2241659015417099,
                        0.7908933758735657,
                        0.23780548572540283,
                        0.216154545545578,
                        0.6218942999839783,
                        0.629043698310852,
                        0.6455227732658386,
                        0.4398640990257263,
                        0.5811276435852051,
                        0.32309094071388245,
                        0.34271371364593506,
                        0.5795050859451294,
                        0.31066828966140747,
                        0.7436365485191345,
                        0.7203122973442078,
                        0.7355237603187561,
                        0.7422167658805847,
                        0.9713517427444458,
                        0.7409491539001465,
                        0.8048372268676758,
                        0.1941993683576584,
                        0.5113071799278259,
                        0.7882060408592224,
                        0.47449547052383423,
                        0.7521042227745056,
                        0.19333738088607788,
                        0.6881147623062134,
                        0.18563026189804077,
                        0.7753777503967285,
                        0.6194604635238647,
                        0.7834904789924622,
                        0.7937328815460205,
                        0.8067640066146851,
                        0.8091978430747986,
                        0.20226143300533295,
                        0.2295406013727188,
                        0.36193081736564636,
                        0.595882773399353,
                        0.7142784595489502
                    ]
                },
                "test": {
                    "score": -5.6459237391291985,
                    "pretrain_loss": 1.6130304336547852,
                    "pretrain_component": 0.6909754276275635,
                    "supervised_component": 0.8065152168273926,
                    "features_accuracy": [
                        0.6424949169158936,
                        0.5135902762413025,
                        0.2773326635360718,
                        0.6309330463409424,
                        0.5904158353805542,
                        0.477484792470932,
                        0.793306291103363,
                        0.7626774907112122,
                        0.6493407487869263,
                        0.3571501076221466,
                        0.9837728142738342,
                        0.2639959454536438,
                        0.2245943248271942,
                        0.7862576246261597,
                        0.23717038333415985,
                        0.21318458020687103,
                        0.6362069249153137,
                        0.6396044492721558,
                        0.6481237411499023,
                        0.44188642501831055,
                        0.5798681378364563,
                        0.32195740938186646,
                        0.34188640117645264,
                        0.5751521587371826,
                        0.31800201535224915,
                        0.7443205118179321,
                        0.7263691425323486,
                        0.7369675636291504,
                        0.7386409640312195,
                        0.9715517163276672,
                        0.7478194832801819,
                        0.8218559622764587,
                        0.19705882668495178,
                        0.5073529481887817,
                        0.7873225212097168,
                        0.48924949765205383,
                        0.7539553642272949,
                        0.18970587849617004,
                        0.6997464299201965,
                        0.18534483015537262,
                        0.7737829685211182,
                        0.6130324602127075,
                        0.783823549747467,
                        0.791683554649353,
                        0.8011156320571899,
                        0.7978194952011108,
                        0.20177485048770905,
                        0.23772819340229034,
                        0.350862056016922,
                        0.6053752303123474,
                        0.7158722281455994
                    ]
                }
            }
        },
        "train": {
            "score": -3.98757656727579
        },
        "val": {
            "score": -5.298337961625103
        },
        "test": {
            "score": -5.541517918704825
        }
    },
    "best_iteration": 10000,
    "time": "0:40:01"
}
