{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/tune.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 0,
        "program": "bin/pretrain_mask_supervised.py",
        "base_config": {
            "seed": 0,
            "data": {
                "T_cache": true,
                "path": "data/adult_roc",
                "T": {
                    "normalization": "quantile"
                }
            },
            "model": {
                "kind": "mlp",
                "num_embedding_arch": [
                    "linear",
                    "relu"
                ]
            },
            "training": {
                "batch_size": 256,
                "patience": 16
            },
            "pretrain": {
                "corrupt_strategy": "resample",
                "patience": 2,
                "d_hidden_head": 512,
                "supervised_weight": 1.0
            }
        },
        "space": {
            "model": {
                "d_num_embedding": [
                    "int",
                    1,
                    128
                ],
                "config": {
                    "d_layers": [
                        "$fixed_mlp_d_layers",
                        1,
                        8,
                        512
                    ],
                    "dropout": [
                        "?uniform",
                        0.0,
                        0.0,
                        0.5
                    ]
                }
            },
            "pretrain": {
                "corrupt_probability": [
                    "uniform",
                    0.2,
                    0.8
                ]
            },
            "training": {
                "lr": [
                    "loguniform",
                    5e-05,
                    0.005
                ],
                "weight_decay": [
                    "?loguniform",
                    0.0,
                    1e-06,
                    0.001
                ]
            },
            "bins": {
                "count": [
                    "int",
                    2,
                    256
                ],
                "tree": {
                    "min_samples_leaf": [
                        "int",
                        1,
                        128
                    ],
                    "min_impurity_decrease": [
                        "loguniform",
                        1e-09,
                        0.01
                    ]
                }
            }
        },
        "n_trials": 100,
        "timeout": null,
        "sampler": {
            "seed": 0
        }
    },
    "best": {
        "program": "bin/pretrain_mask_supervised.py",
        "environment": {
            "CUDA_VISIBLE_DEVICES": "0",
            "gpus": {
                "driver": "450.119.04",
                "devices": [
                    {
                        "name": "A100-SXM-80GB",
                        "memory_total": 85199093760,
                        "memory_free": 85195948032,
                        "memory_used": 3145728,
                        "utilization": 0
                    }
                ]
            },
            "torch.version.cuda": "11.1",
            "torch.backends.cudnn.version()": 8005,
            "torch.cuda.nccl.version()": [
                2,
                10,
                3
            ]
        },
        "config": {
            "seed": 0,
            "data": {
                "path": "data/adult_roc",
                "T": {
                    "seed": 0,
                    "normalization": "quantile",
                    "num_nan_policy": null,
                    "cat_nan_policy": null,
                    "cat_min_frequency": null,
                    "cat_encoding": null,
                    "y_policy": "default"
                },
                "T_cache": true
            },
            "model": {
                "kind": "mlp",
                "config": {
                    "d_layers": [
                        512
                    ],
                    "dropout": 0.25187467265167024
                },
                "default": true,
                "checkpoint": null,
                "num_embedding_arch": [
                    "linear",
                    "relu"
                ],
                "d_num_embedding": 107,
                "positional_encoding": null,
                "d_cat_embedding": null
            },
            "training": {
                "batch_size": 256,
                "lr": 0.0002758786488959557,
                "weight_decay": 0.0,
                "optimizer": "AdamW",
                "patience": 16,
                "n_epochs": Infinity,
                "eval_batch_size": 8192
            },
            "pretrain": {
                "corrupt_probability": 0.7079769560143915,
                "corrupt_strategy": "resample",
                "d_hidden_head": 512,
                "lr": 0.0002758786488959557,
                "weight_decay": 0.0,
                "patience": 2,
                "n_iterations": 100000,
                "validate_every": 10000,
                "replace_strategy": "shuffle",
                "n_neighbors": 20,
                "use_target": false,
                "early_stop_type": "finetune",
                "target_injection_type": "post",
                "supervised_weight": 1.0
            },
            "bins": {
                "count": 62,
                "value": "ratio",
                "tree": {
                    "min_samples_leaf": 14,
                    "min_impurity_decrease": 2.4871370546600234e-08
                },
                "subsample": null
            }
        },
        "epoch_size": 102,
        "n_parameters": 692237,
        "metrics": {
            "iteration_scores": {
                "10000": {
                    "train": {
                        "score": 0.949733920764507,
                        "pretrain_loss": 1.0099494457244873,
                        "pretrain_component": 0.6928225755691528,
                        "supervised_component": 0.5049747228622437,
                        "features_accuracy": [
                            0.30731725692749023,
                            0.29176902770996094,
                            0.5023801922798157,
                            0.883676290512085,
                            0.695254921913147,
                            0.47040078043937683,
                            0.3536931872367859,
                            0.4329698979854584,
                            0.4773111045360565,
                            0.6191645860671997,
                            0.478462815284729,
                            0.8151105642318726,
                            0.31860411167144775,
                            0.8491630554199219
                        ]
                    },
                    "val": {
                        "score": 0.9303109717092094,
                        "pretrain_loss": 1.0058385133743286,
                        "pretrain_component": 0.6928115487098694,
                        "supervised_component": 0.5029192566871643,
                        "features_accuracy": [
                            0.3118378520011902,
                            0.28773224353790283,
                            0.5095961689949036,
                            0.8900660276412964,
                            0.6964532732963562,
                            0.4788883924484253,
                            0.3476124703884125,
                            0.4220789074897766,
                            0.48011669516563416,
                            0.6192231178283691,
                            0.47735297679901123,
                            0.8251190185546875,
                            0.3144480288028717,
                            0.8432366251945496
                        ]
                    },
                    "test": {
                        "score": 0.9253411029082901,
                        "pretrain_loss": 0.9974659085273743,
                        "pretrain_component": 0.6926997900009155,
                        "supervised_component": 0.49873295426368713,
                        "features_accuracy": [
                            0.3031140863895416,
                            0.2970333695411682,
                            0.5011977553367615,
                            0.8929427266120911,
                            0.691849410533905,
                            0.4747251570224762,
                            0.3601744472980499,
                            0.43271300196647644,
                            0.47933176159858704,
                            0.6201093792915344,
                            0.4878693222999573,
                            0.8166574835777283,
                            0.3174252212047577,
                            0.8530188798904419
                        ]
                    }
                },
                "20000": {
                    "train": {
                        "score": 0.9457314684993356,
                        "pretrain_loss": 1.0029586553573608,
                        "pretrain_component": 0.6941319704055786,
                        "supervised_component": 0.5014793276786804,
                        "features_accuracy": [
                            0.30601197481155396,
                            0.2906557023525238,
                            0.547796368598938,
                            0.8859413266181946,
                            0.734950840473175,
                            0.4873310625553131,
                            0.35902947187423706,
                            0.4378071129322052,
                            0.47477731108665466,
                            0.6235027313232422,
                            0.488943487405777,
                            0.7620546817779541,
                            0.3209075629711151,
                            0.822097659111023
                        ]
                    },
                    "val": {
                        "score": 0.9306152112007593,
                        "pretrain_loss": 1.0026085376739502,
                        "pretrain_component": 0.6941365003585815,
                        "supervised_component": 0.5013042688369751,
                        "features_accuracy": [
                            0.3118378520011902,
                            0.2875787019729614,
                            0.5533548593521118,
                            0.8900660276412964,
                            0.742514967918396,
                            0.48610472679138184,
                            0.3605097532272339,
                            0.43175187706947327,
                            0.47551050782203674,
                            0.6212190985679626,
                            0.47950252890586853,
                            0.7742975354194641,
                            0.3136803209781647,
                            0.8185167908668518
                        ]
                    },
                    "test": {
                        "score": 0.9257365759045321,
                        "pretrain_loss": 0.9953999519348145,
                        "pretrain_component": 0.6940746903419495,
                        "supervised_component": 0.4976999759674072,
                        "features_accuracy": [
                            0.3031140863895416,
                            0.29574352502822876,
                            0.5430870652198792,
                            0.8929427266120911,
                            0.7372397780418396,
                            0.48952770233154297,
                            0.36779069900512695,
                            0.4406977593898773,
                            0.4781033396720886,
                            0.6239789128303528,
                            0.4924759268760681,
                            0.7640194296836853,
                            0.3177323341369629,
                            0.8223696947097778
                        ]
                    }
                },
                "30000": {
                    "train": {
                        "score": 0.95026219366083,
                        "pretrain_loss": 1.0020129680633545,
                        "pretrain_component": 0.693684458732605,
                        "supervised_component": 0.5010064840316772,
                        "features_accuracy": [
                            0.31184735894203186,
                            0.2939189076423645,
                            0.5566262006759644,
                            0.8881295919418335,
                            0.6352887153625488,
                            0.5003839135169983,
                            0.35553592443466187,
                            0.43473586440086365,
                            0.47485411167144775,
                            0.5955543518066406,
                            0.48556509613990784,
                            0.6443488597869873,
                            0.3170301020145416,
                            0.7984489798545837
                        ]
                    },
                    "val": {
                        "score": 0.9309614303254165,
                        "pretrain_loss": 1.0036323070526123,
                        "pretrain_component": 0.6937915682792664,
                        "supervised_component": 0.5018161535263062,
                        "features_accuracy": [
                            0.3118378520011902,
                            0.2871180772781372,
                            0.5571932792663574,
                            0.8900660276412964,
                            0.6483955383300781,
                            0.4956241250038147,
                            0.3454629182815552,
                            0.4262244701385498,
                            0.48211270570755005,
                            0.6046369075775146,
                            0.47980961203575134,
                            0.645017683506012,
                            0.3142944872379303,
                            0.7868877649307251
                        ]
                    },
                    "test": {
                        "score": 0.9258699161798397,
                        "pretrain_loss": 0.995400607585907,
                        "pretrain_component": 0.6936917304992676,
                        "supervised_component": 0.4977003037929535,
                        "features_accuracy": [
                            0.3031140863895416,
                            0.2962348759174347,
                            0.5446839928627014,
                            0.8929427266120911,
                            0.6307352185249329,
                            0.5010749101638794,
                            0.3566734492778778,
                            0.4328358471393585,
                            0.4777962267398834,
                            0.5989804267883301,
                            0.4903261661529541,
                            0.6427738070487976,
                            0.31932929158210754,
                            0.7979239821434021
                        ]
                    }
                },
                "40000": {
                    "train": {
                        "score": 0.9469420426635292,
                        "pretrain_loss": 1.0016480684280396,
                        "pretrain_component": 0.6937384009361267,
                        "supervised_component": 0.5008240342140198,
                        "features_accuracy": [
                            0.30612713098526,
                            0.294149249792099,
                            0.5383138656616211,
                            0.8866707682609558,
                            0.2958768308162689,
                            0.4796145558357239,
                            0.39415693283081055,
                            0.43154942989349365,
                            0.45953622460365295,
                            0.5953624248504639,
                            0.4877917468547821,
                            0.7875460386276245,
                            0.3170301020145416,
                            0.7220515608787537
                        ]
                    },
                    "val": {
                        "score": 0.9314832416788759,
                        "pretrain_loss": 1.000954270362854,
                        "pretrain_component": 0.693690836429596,
                        "supervised_component": 0.500477135181427,
                        "features_accuracy": [
                            0.3118378520011902,
                            0.2875787019729614,
                            0.544142484664917,
                            0.8900660276412964,
                            0.3021649122238159,
                            0.4836480915546417,
                            0.3984338939189911,
                            0.42699217796325684,
                            0.4644556939601898,
                            0.6027944087982178,
                            0.48042377829551697,
                            0.7990173697471619,
                            0.3179794251918793,
                            0.7156456112861633
                        ]
                    },
                    "test": {
                        "score": 0.9262004545320535,
                        "pretrain_loss": 0.9940581917762756,
                        "pretrain_component": 0.6936748027801514,
                        "supervised_component": 0.4970290958881378,
                        "features_accuracy": [
                            0.3031140863895416,
                            0.2954978346824646,
                            0.5366378426551819,
                            0.8929427266120911,
                            0.2852404713630676,
                            0.4768749177455902,
                            0.40206378698349,
                            0.4328358471393585,
                            0.4642835557460785,
                            0.5954179763793945,
                            0.49069470167160034,
                            0.7924575209617615,
                            0.32553285360336304,
                            0.7181991338729858
                        ]
                    }
                },
                "50000": {
                    "train": {
                        "score": 0.950906751649505,
                        "pretrain_loss": 1.002290964126587,
                        "pretrain_component": 0.6940227746963501,
                        "supervised_component": 0.5011454820632935,
                        "features_accuracy": [
                            0.3058200180530548,
                            0.2890816926956177,
                            0.5523648262023926,
                            0.8869778513908386,
                            0.5244548320770264,
                            0.47423985600471497,
                            0.3730420768260956,
                            0.42897725105285645,
                            0.4582309424877167,
                            0.5705620050430298,
                            0.4831081032752991,
                            0.7861256003379822,
                            0.3372235894203186,
                            0.6450399160385132
                        ]
                    },
                    "val": {
                        "score": 0.9317868363219908,
                        "pretrain_loss": 1.0020027160644531,
                        "pretrain_component": 0.6939388513565063,
                        "supervised_component": 0.5010013580322266,
                        "features_accuracy": [
                            0.3118378520011902,
                            0.28803929686546326,
                            0.5576539039611816,
                            0.889144778251648,
                            0.5260248780250549,
                            0.47796714305877686,
                            0.36649778485298157,
                            0.4245355427265167,
                            0.4644556939601898,
                            0.577767550945282,
                            0.47750651836395264,
                            0.7988638281822205,
                            0.33271917700767517,
                            0.6382619142532349
                        ]
                    },
                    "test": {
                        "score": 0.9261241764507733,
                        "pretrain_loss": 0.9934045672416687,
                        "pretrain_component": 0.693938136100769,
                        "supervised_component": 0.49670228362083435,
                        "features_accuracy": [
                            0.3031140863895416,
                            0.29555925726890564,
                            0.5526687502861023,
                            0.8927584886550903,
                            0.5253363251686096,
                            0.47054851055145264,
                            0.37430134415626526,
                            0.434125691652298,
                            0.4698728919029236,
                            0.5737977027893066,
                            0.48952770233154297,
                            0.7927646040916443,
                            0.3399668335914612,
                            0.6470118761062622
                        ]
                    }
                },
                "60000": {
                    "train": {
                        "score": 0.9477153526350464,
                        "pretrain_loss": 1.0068212747573853,
                        "pretrain_component": 0.6947026252746582,
                        "supervised_component": 0.5034106373786926,
                        "features_accuracy": [
                            0.3058200180530548,
                            0.2937653362751007,
                            0.5210764408111572,
                            0.8882447481155396,
                            0.6618550419807434,
                            0.47819408774375916,
                            0.43964987993240356,
                            0.4731649160385132,
                            0.46387436985969543,
                            0.6137131452560425,
                            0.4820331633090973,
                            0.7238559722900391,
                            0.3235948979854584,
                            0.1694563776254654
                        ]
                    },
                    "val": {
                        "score": 0.9319454690369575,
                        "pretrain_loss": 1.0009509325027466,
                        "pretrain_component": 0.6946893930435181,
                        "supervised_component": 0.5004754662513733,
                        "features_accuracy": [
                            0.3118378520011902,
                            0.28819283843040466,
                            0.519422709941864,
                            0.889144778251648,
                            0.6596038937568665,
                            0.47996315360069275,
                            0.43988946080207825,
                            0.4724397361278534,
                            0.4646092355251312,
                            0.6149240136146545,
                            0.47597113251686096,
                            0.733302652835846,
                            0.3182865083217621,
                            0.17564870417118073
                        ]
                    },
                    "test": {
                        "score": 0.9262183844812578,
                        "pretrain_loss": 0.9936103820800781,
                        "pretrain_component": 0.694689154624939,
                        "supervised_component": 0.49680519104003906,
                        "features_accuracy": [
                            0.3031754791736603,
                            0.29660341143608093,
                            0.5185799598693848,
                            0.892267107963562,
                            0.6559179425239563,
                            0.4818500280380249,
                            0.44333887100219727,
                            0.4735581576824188,
                            0.46919724345207214,
                            0.6142129302024841,
                            0.48854494094848633,
                            0.7341687083244324,
                            0.3265155851840973,
                            0.16356490552425385
                        ]
                    }
                },
                "70000": {
                    "train": {
                        "score": 0.9428482108722329,
                        "pretrain_loss": 1.0037118196487427,
                        "pretrain_component": 0.6938587427139282,
                        "supervised_component": 0.5018559098243713,
                        "features_accuracy": [
                            0.304629921913147,
                            0.29464834928512573,
                            0.49754297733306885,
                            0.8871698379516602,
                            0.6712990999221802,
                            0.4757370948791504,
                            0.37308046221733093,
                            0.4707079231739044,
                            0.47439342737197876,
                            0.592828631401062,
                            0.480267196893692,
                            0.5547066926956177,
                            0.31921836733818054,
                            0.7130681872367859
                        ]
                    },
                    "val": {
                        "score": 0.9317662011720765,
                        "pretrain_loss": 1.0012967586517334,
                        "pretrain_component": 0.6938732862472534,
                        "supervised_component": 0.5006483793258667,
                        "features_accuracy": [
                            0.3118378520011902,
                            0.28788575530052185,
                            0.4957776665687561,
                            0.889912486076355,
                            0.6731153130531311,
                            0.47336098551750183,
                            0.38123753666877747,
                            0.4619990885257721,
                            0.47781360149383545,
                            0.5974205732345581,
                            0.47612467408180237,
                            0.5465990900993347,
                            0.3204360604286194,
                            0.7024412751197815
                        ]
                    },
                    "test": {
                        "score": 0.9273548296173907,
                        "pretrain_loss": 0.9933306574821472,
                        "pretrain_component": 0.6938140392303467,
                        "supervised_component": 0.4966653287410736,
                        "features_accuracy": [
                            0.3031754791736603,
                            0.2963577210903168,
                            0.49419569969177246,
                            0.8929427266120911,
                            0.6731773614883423,
                            0.46968862414360046,
                            0.38320744037628174,
                            0.4615809917449951,
                            0.4754622280597687,
                            0.594005286693573,
                            0.48860636353492737,
                            0.5513789057731628,
                            0.3280511200428009,
                            0.7052392959594727
                        ]
                    }
                },
                "80000": {
                    "train": {
                        "score": 0.9429709007136923,
                        "pretrain_loss": 1.0051010847091675,
                        "pretrain_component": 0.6945979595184326,
                        "supervised_component": 0.5025505423545837,
                        "features_accuracy": [
                            0.300982803106308,
                            0.29123157262802124,
                            0.5592367649078369,
                            0.8788390755653381,
                            0.3210611045360565,
                            0.48115018010139465,
                            0.36912623047828674,
                            0.49358874559402466,
                            0.47880834341049194,
                            0.5459920167922974,
                            0.4937039315700531,
                            0.6183199882507324,
                            0.32612869143486023,
                            0.7198632955551147
                        ]
                    },
                    "val": {
                        "score": 0.931590222034213,
                        "pretrain_loss": 1.0016815662384033,
                        "pretrain_component": 0.6945441365242004,
                        "supervised_component": 0.5008407831192017,
                        "features_accuracy": [
                            0.3119913935661316,
                            0.28819283843040466,
                            0.5553508400917053,
                            0.8799324631690979,
                            0.3373253643512726,
                            0.4747428297996521,
                            0.3652694523334503,
                            0.49055734276771545,
                            0.47397512197494507,
                            0.5495163798332214,
                            0.4811914563179016,
                            0.6170735359191895,
                            0.3276523947715759,
                            0.7181022763252258
                        ]
                    },
                    "test": {
                        "score": 0.9274607888215811,
                        "pretrain_loss": 0.9936143159866333,
                        "pretrain_component": 0.6945468783378601,
                        "supervised_component": 0.49680715799331665,
                        "features_accuracy": [
                            0.3031754791736603,
                            0.2971562147140503,
                            0.5526687502861023,
                            0.8853265047073364,
                            0.32025060057640076,
                            0.4872550964355469,
                            0.3716602325439453,
                            0.4905104339122772,
                            0.4769977629184723,
                            0.550948977470398,
                            0.49309012293815613,
                            0.6214606165885925,
                            0.3339475691318512,
                            0.7142682075500488
                        ]
                    }
                },
                "90000": {
                    "train": {
                        "score": 0.9431372669939981,
                        "pretrain_loss": 1.0025763511657715,
                        "pretrain_component": 0.6935068368911743,
                        "supervised_component": 0.5012881755828857,
                        "features_accuracy": [
                            0.310695618391037,
                            0.2952241897583008,
                            0.5501765608787537,
                            0.8362637758255005,
                            0.6528716087341309,
                            0.5047604441642761,
                            0.4164235293865204,
                            0.45423832535743713,
                            0.46583229303359985,
                            0.5894886255264282,
                            0.5,
                            0.7097665667533875,
                            0.31768274307250977,
                            0.8096974492073059
                        ]
                    },
                    "val": {
                        "score": 0.9318325560760199,
                        "pretrain_loss": 1.002509355545044,
                        "pretrain_component": 0.6935327649116516,
                        "supervised_component": 0.501254677772522,
                        "features_accuracy": [
                            0.31291264295578003,
                            0.2886534631252289,
                            0.548595130443573,
                            0.8354061245918274,
                            0.6520804762840271,
                            0.5019192695617676,
                            0.4240749180316925,
                            0.44664517045021057,
                            0.46721941232681274,
                            0.595885157585144,
                            0.4856441020965576,
                            0.7078151702880859,
                            0.3181329667568207,
                            0.8046982884407043
                        ]
                    },
                    "test": {
                        "score": 0.9275583737462887,
                        "pretrain_loss": 0.9951341152191162,
                        "pretrain_component": 0.6935579180717468,
                        "supervised_component": 0.4975670576095581,
                        "features_accuracy": [
                            0.3036668598651886,
                            0.2970333695411682,
                            0.5465266704559326,
                            0.844481348991394,
                            0.6476874947547913,
                            0.5033474564552307,
                            0.4166206121444702,
                            0.4572815001010895,
                            0.47466373443603516,
                            0.5871261358261108,
                            0.49616119265556335,
                            0.7129783630371094,
                            0.32203182578086853,
                            0.8060930371284485
                        ]
                    }
                }
            },
            "train": {
                "score": 0.9477153526350464
            },
            "val": {
                "score": 0.9319454690369575
            },
            "test": {
                "score": 0.9262183844812578
            }
        },
        "best_iteration": 60000,
        "time": "0:10:42",
        "trial_id": 91,
        "tuning_time": "14:46:29"
    },
    "time": "16:09:03"
}
