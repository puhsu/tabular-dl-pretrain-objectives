{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_supervised___adf82354b6dd4b23bc5e617aa7f80287.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 1,
        "data": {
            "path": "data/california",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512
                ],
                "dropout": 0.45652418144355683
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear",
                "relu"
            ],
            "d_num_embedding": 63,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.00040738834284353726,
            "weight_decay": 0.0007328396748947705,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.5311685101329022,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.00040738834284353726,
            "weight_decay": 0.0007328396748947705,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": false,
            "early_stop_type": "finetune",
            "target_injection_type": "post",
            "supervised_weight": 1.0
        },
        "bins": {
            "count": 168,
            "value": "ratio",
            "tree": {
                "min_samples_leaf": 61,
                "min_impurity_decrease": 0.002879790941509016
            },
            "subsample": null
        }
    },
    "epoch_size": 104,
    "n_parameters": 533393,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -0.34898015837879376,
                    "pretrain_loss": 1.474793791770935,
                    "pretrain_component": 0.6931836009025574,
                    "supervised_component": 0.7373968958854675,
                    "features_accuracy": [
                        0.5270649194717407,
                        0.4995836317539215,
                        0.5209327340126038,
                        0.46937695145606995,
                        0.5030661225318909,
                        0.46687865257263184,
                        0.5339541435241699,
                        0.4898175597190857
                    ]
                },
                "val": {
                    "score": -0.44387050415586315,
                    "pretrain_loss": 1.4170726537704468,
                    "pretrain_component": 0.6931910514831543,
                    "supervised_component": 0.7085363268852234,
                    "features_accuracy": [
                        0.5161973834037781,
                        0.4874356687068939,
                        0.5370875000953674,
                        0.46382075548171997,
                        0.5149863958358765,
                        0.4577656686306,
                        0.5219497680664062,
                        0.4892521798610687
                    ]
                },
                "test": {
                    "score": -0.4364968355561011,
                    "pretrain_loss": 1.4670382738113403,
                    "pretrain_component": 0.6931626796722412,
                    "supervised_component": 0.7335191369056702,
                    "features_accuracy": [
                        0.5220445990562439,
                        0.5104166865348816,
                        0.5305232405662537,
                        0.4663275182247162,
                        0.49830424785614014,
                        0.4738371968269348,
                        0.5339147448539734,
                        0.4765019416809082
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -0.35109908711210097,
                    "pretrain_loss": 1.4525481462478638,
                    "pretrain_component": 0.693176805973053,
                    "supervised_component": 0.7262740731239319,
                    "features_accuracy": [
                        0.5175259709358215,
                        0.498902291059494,
                        0.525399386882782,
                        0.4728594422340393,
                        0.4875463843345642,
                        0.4868650436401367,
                        0.5404648780822754,
                        0.4756605625152588
                    ]
                },
                "val": {
                    "score": -0.4425587500849976,
                    "pretrain_loss": 1.3989194631576538,
                    "pretrain_component": 0.6932094097137451,
                    "supervised_component": 0.6994597315788269,
                    "features_accuracy": [
                        0.5222525000572205,
                        0.48289433121681213,
                        0.5364819765090942,
                        0.46472904086112976,
                        0.5019679069519043,
                        0.4838026165962219,
                        0.5252800583839417,
                        0.48198607563972473
                    ]
                },
                "test": {
                    "score": -0.43558138957047476,
                    "pretrain_loss": 1.4357985258102417,
                    "pretrain_component": 0.6932130455970764,
                    "supervised_component": 0.7178992629051208,
                    "features_accuracy": [
                        0.507267415523529,
                        0.5031492114067078,
                        0.5305232405662537,
                        0.46705424785614014,
                        0.48885658383369446,
                        0.5007267594337463,
                        0.533187985420227,
                        0.46414729952812195
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -0.335837456990217,
                    "pretrain_loss": 1.4288145303726196,
                    "pretrain_component": 0.6931928992271423,
                    "supervised_component": 0.7144072651863098,
                    "features_accuracy": [
                        0.5236581563949585,
                        0.4993565082550049,
                        0.5219168663024902,
                        0.47164812684059143,
                        0.5082898139953613,
                        0.48588085174560547,
                        0.528351902961731,
                        0.49367856979370117
                    ]
                },
                "val": {
                    "score": -0.43674059211492006,
                    "pretrain_loss": 1.396932601928711,
                    "pretrain_component": 0.6932251453399658,
                    "supervised_component": 0.6984663009643555,
                    "features_accuracy": [
                        0.5325461626052856,
                        0.4934907555580139,
                        0.5364819765090942,
                        0.46472904086112976,
                        0.5025734305381775,
                        0.47471994161605835,
                        0.5216469764709473,
                        0.4850136339664459
                    ]
                },
                "test": {
                    "score": -0.4333284918942868,
                    "pretrain_loss": 1.4375756978988647,
                    "pretrain_component": 0.693266749382019,
                    "supervised_component": 0.7187878489494324,
                    "features_accuracy": [
                        0.5201066136360168,
                        0.4987887442111969,
                        0.5300387740135193,
                        0.4665697515010834,
                        0.5096899271011353,
                        0.47868216037750244,
                        0.5285852551460266,
                        0.471414715051651
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -0.3572361207261684,
                    "pretrain_loss": 1.4079194068908691,
                    "pretrain_component": 0.6931711435317993,
                    "supervised_component": 0.7039597034454346,
                    "features_accuracy": [
                        0.5164660811424255,
                        0.4961768686771393,
                        0.5326671600341797,
                        0.4669543504714966,
                        0.49519267678260803,
                        0.4842910170555115,
                        0.5289575457572937,
                        0.4811113774776459
                    ]
                },
                "val": {
                    "score": -0.4390160304269109,
                    "pretrain_loss": 1.3879368305206299,
                    "pretrain_component": 0.6932520270347595,
                    "supervised_component": 0.6939684152603149,
                    "features_accuracy": [
                        0.5195276737213135,
                        0.4880411624908447,
                        0.5379957556724548,
                        0.46412351727485657,
                        0.4895549416542053,
                        0.4868301451206207,
                        0.5189222097396851,
                        0.47411444783210754
                    ]
                },
                "test": {
                    "score": -0.43565497247012663,
                    "pretrain_loss": 1.4300938844680786,
                    "pretrain_component": 0.6932447552680969,
                    "supervised_component": 0.7150469422340393,
                    "features_accuracy": [
                        0.5116279125213623,
                        0.501937985420227,
                        0.5305232405662537,
                        0.4663275182247162,
                        0.4963662624359131,
                        0.4932170510292053,
                        0.5322189927101135,
                        0.4672965109348297
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": -0.3819358794520576,
                    "pretrain_loss": 1.3999289274215698,
                    "pretrain_component": 0.6931958794593811,
                    "supervised_component": 0.6999644637107849,
                    "features_accuracy": [
                        0.5141192078590393,
                        0.4936028718948364,
                        0.5348626375198364,
                        0.46301764249801636,
                        0.5105609893798828,
                        0.4876978099346161,
                        0.5313044190406799,
                        0.4732379615306854
                    ]
                },
                "val": {
                    "score": -0.44571626242633516,
                    "pretrain_loss": 1.3762630224227905,
                    "pretrain_component": 0.6932584643363953,
                    "supervised_component": 0.6881315112113953,
                    "features_accuracy": [
                        0.5122615694999695,
                        0.48561912775039673,
                        0.5370875000953674,
                        0.46472904086112976,
                        0.4913714826107025,
                        0.47895851731300354,
                        0.5267938375473022,
                        0.47683924436569214
                    ]
                },
                "test": {
                    "score": -0.43629308350961776,
                    "pretrain_loss": 1.4227253198623657,
                    "pretrain_component": 0.6932281851768494,
                    "supervised_component": 0.7113626599311829,
                    "features_accuracy": [
                        0.5169573426246643,
                        0.5009689927101135,
                        0.5305232405662537,
                        0.4663275182247162,
                        0.505329430103302,
                        0.47843992710113525,
                        0.5322189927101135,
                        0.4723837077617645
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": -0.3772647187863601,
                    "pretrain_loss": 1.40574049949646,
                    "pretrain_component": 0.6931321620941162,
                    "supervised_component": 0.70287024974823,
                    "features_accuracy": [
                        0.5274434089660645,
                        0.4882277548313141,
                        0.5358467698097229,
                        0.46642443537712097,
                        0.5070785284042358,
                        0.4698311984539032,
                        0.5285032987594604,
                        0.48406392335891724
                    ]
                },
                "val": {
                    "score": -0.44198997409649055,
                    "pretrain_loss": 1.375333547592163,
                    "pretrain_component": 0.6932008862495422,
                    "supervised_component": 0.6876667737960815,
                    "features_accuracy": [
                        0.5255827903747559,
                        0.47381168603897095,
                        0.5376930236816406,
                        0.46412351727485657,
                        0.5180139541625977,
                        0.47169241309165955,
                        0.5252800583839417,
                        0.47926127910614014
                    ]
                },
                "test": {
                    "score": -0.4334699275462244,
                    "pretrain_loss": 1.418810248374939,
                    "pretrain_component": 0.6932175755500793,
                    "supervised_component": 0.7094051241874695,
                    "features_accuracy": [
                        0.5227712988853455,
                        0.4961240291595459,
                        0.5288274884223938,
                        0.46705424785614014,
                        0.5067829489707947,
                        0.4735949635505676,
                        0.5343992114067078,
                        0.4699612259864807
                    ]
                }
            }
        },
        "train": {
            "score": -0.335837456990217
        },
        "val": {
            "score": -0.43674059211492006
        },
        "test": {
            "score": -0.4333284918942868
        }
    },
    "best_iteration": 30000,
    "time": "0:08:38"
}
