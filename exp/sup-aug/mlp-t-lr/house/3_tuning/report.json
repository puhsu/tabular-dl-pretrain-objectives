{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/tune.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 0,
        "program": "bin/pretrain_mask_supervised.py",
        "base_config": {
            "seed": 0,
            "data": {
                "T_cache": true,
                "path": "data/house",
                "T": {
                    "normalization": "quantile"
                }
            },
            "model": {
                "kind": "mlp",
                "num_embedding_arch": [
                    "linear",
                    "relu"
                ]
            },
            "training": {
                "batch_size": 128,
                "patience": 16
            },
            "pretrain": {
                "corrupt_strategy": "resample",
                "patience": 2,
                "d_hidden_head": 512,
                "supervised_weight": 1.0
            }
        },
        "space": {
            "model": {
                "d_num_embedding": [
                    "int",
                    1,
                    128
                ],
                "config": {
                    "d_layers": [
                        "$fixed_mlp_d_layers",
                        1,
                        8,
                        512
                    ],
                    "dropout": [
                        "?uniform",
                        0.0,
                        0.0,
                        0.5
                    ]
                }
            },
            "pretrain": {
                "corrupt_probability": [
                    "uniform",
                    0.2,
                    0.8
                ]
            },
            "training": {
                "lr": [
                    "loguniform",
                    5e-05,
                    0.005
                ],
                "weight_decay": [
                    "?loguniform",
                    0.0,
                    1e-06,
                    0.001
                ]
            },
            "bins": {
                "count": [
                    "int",
                    2,
                    256
                ],
                "tree": {
                    "min_samples_leaf": [
                        "int",
                        1,
                        128
                    ],
                    "min_impurity_decrease": [
                        "loguniform",
                        1e-09,
                        0.01
                    ]
                }
            }
        },
        "n_trials": 100,
        "timeout": null,
        "sampler": {
            "seed": 0
        }
    },
    "best": {
        "program": "bin/pretrain_mask_supervised.py",
        "environment": {
            "CUDA_VISIBLE_DEVICES": "0",
            "gpus": {
                "driver": "450.119.04",
                "devices": [
                    {
                        "name": "A100-SXM-80GB",
                        "memory_total": 85199093760,
                        "memory_free": 85195948032,
                        "memory_used": 3145728,
                        "utilization": 0
                    }
                ]
            },
            "torch.version.cuda": "11.1",
            "torch.backends.cudnn.version()": 8005,
            "torch.cuda.nccl.version()": [
                2,
                10,
                3
            ]
        },
        "config": {
            "seed": 0,
            "data": {
                "path": "data/house",
                "T": {
                    "seed": 0,
                    "normalization": "quantile",
                    "num_nan_policy": null,
                    "cat_nan_policy": null,
                    "cat_min_frequency": null,
                    "cat_encoding": null,
                    "y_policy": "default"
                },
                "T_cache": true
            },
            "model": {
                "kind": "mlp",
                "config": {
                    "d_layers": [
                        512
                    ],
                    "dropout": 0.27397135221342755
                },
                "default": true,
                "checkpoint": null,
                "num_embedding_arch": [
                    "linear",
                    "relu"
                ],
                "d_num_embedding": 25,
                "positional_encoding": null,
                "d_cat_embedding": null
            },
            "training": {
                "batch_size": 128,
                "lr": 0.0001058615946952289,
                "weight_decay": 0.0,
                "optimizer": "AdamW",
                "patience": 16,
                "n_epochs": Infinity,
                "eval_batch_size": 8192
            },
            "pretrain": {
                "corrupt_probability": 0.3400689235659714,
                "corrupt_strategy": "resample",
                "d_hidden_head": 512,
                "lr": 0.0001058615946952289,
                "weight_decay": 0.0,
                "patience": 2,
                "n_iterations": 100000,
                "validate_every": 10000,
                "replace_strategy": "shuffle",
                "n_neighbors": 20,
                "use_target": false,
                "early_stop_type": "finetune",
                "target_injection_type": "post",
                "supervised_weight": 1.0
            },
            "bins": {
                "count": 16,
                "value": "ratio",
                "tree": {
                    "min_samples_leaf": 121,
                    "min_impurity_decrease": 0.009480496308614632
                },
                "subsample": null
            }
        },
        "epoch_size": 114,
        "n_parameters": 478689,
        "metrics": {
            "iteration_scores": {
                "10000": {
                    "train": {
                        "score": -24302.302999257692,
                        "pretrain_loss": 1.247920274734497,
                        "pretrain_component": 0.691929042339325,
                        "supervised_component": 0.6239601373672485,
                        "features_accuracy": [
                            0.6583911180496216,
                            0.6532474160194397,
                            0.33331048488616943,
                            0.34606680274009705,
                            0.6646320819854736,
                            0.5318565368652344,
                            0.7300596833229065,
                            0.6577052474021912,
                            0.69041907787323,
                            0.3607434630393982,
                            0.6468692421913147,
                            0.32768672704696655,
                            0.3189767599105835,
                            0.35319939255714417,
                            0.33673959970474243,
                            0.6664838194847107
                        ]
                    },
                    "val": {
                        "score": -29716.220953656495,
                        "pretrain_loss": 1.353256106376648,
                        "pretrain_component": 0.6918997764587402,
                        "supervised_component": 0.676628053188324,
                        "features_accuracy": [
                            0.6555129289627075,
                            0.6574328541755676,
                            0.3313220143318176,
                            0.34037303924560547,
                            0.6678552031517029,
                            0.5466264486312866,
                            0.7235326766967773,
                            0.6555129289627075,
                            0.6930883526802063,
                            0.36313769221305847,
                            0.6470104455947876,
                            0.3280307352542877,
                            0.3381788432598114,
                            0.3480526804924011,
                            0.33241909742355347,
                            0.6727921366691589
                        ]
                    },
                    "test": {
                        "score": -31557.272087359055,
                        "pretrain_loss": 1.4353281259536743,
                        "pretrain_component": 0.6918544769287109,
                        "supervised_component": 0.7176640629768372,
                        "features_accuracy": [
                            0.6567917466163635,
                            0.6660083532333374,
                            0.32960280776023865,
                            0.33662497997283936,
                            0.6515251398086548,
                            0.5508009791374207,
                            0.7316216826438904,
                            0.6589862108230591,
                            0.6976081132888794,
                            0.37019971013069153,
                            0.655036211013794,
                            0.33706384897232056,
                            0.3238973021507263,
                            0.35242486000061035,
                            0.34386658668518066,
                            0.664691686630249
                        ]
                    }
                },
                "20000": {
                    "train": {
                        "score": -23334.22689078381,
                        "pretrain_loss": 1.207818627357483,
                        "pretrain_component": 0.6923680305480957,
                        "supervised_component": 0.6039093136787415,
                        "features_accuracy": [
                            0.6598313450813293,
                            0.6588025689125061,
                            0.3667101263999939,
                            0.3514162302017212,
                            0.6571565866470337,
                            0.5614155530929565,
                            0.726081907749176,
                            0.6601742506027222,
                            0.6947397589683533,
                            0.3458610773086548,
                            0.5844592452049255,
                            0.3850902020931244,
                            0.33454498648643494,
                            0.34640973806381226,
                            0.33653387427330017,
                            0.6407654285430908
                        ]
                    },
                    "val": {
                        "score": -29470.57094629789,
                        "pretrain_loss": 1.311110496520996,
                        "pretrain_component": 0.6924052238464355,
                        "supervised_component": 0.655555248260498,
                        "features_accuracy": [
                            0.6552386283874512,
                            0.6557871699333191,
                            0.38123974204063416,
                            0.3422929346561432,
                            0.6678552031517029,
                            0.5551289319992065,
                            0.7205156683921814,
                            0.6555129289627075,
                            0.6911684274673462,
                            0.34585848450660706,
                            0.594898521900177,
                            0.3922106623649597,
                            0.3535381257534027,
                            0.34448713064193726,
                            0.3302249312400818,
                            0.6294569969177246
                        ]
                    },
                    "test": {
                        "score": -31489.218545820455,
                        "pretrain_loss": 1.4001437425613403,
                        "pretrain_component": 0.6923550963401794,
                        "supervised_component": 0.7000718712806702,
                        "features_accuracy": [
                            0.6567917466163635,
                            0.6657888889312744,
                            0.3807329535484314,
                            0.3401360511779785,
                            0.6515251398086548,
                            0.5593592524528503,
                            0.7188940048217773,
                            0.6589862108230591,
                            0.6938775777816772,
                            0.3554970324039459,
                            0.5913978815078735,
                            0.3890717625617981,
                            0.3489137589931488,
                            0.34606102108955383,
                            0.3403555154800415,
                            0.6295808553695679
                        ]
                    }
                },
                "30000": {
                    "train": {
                        "score": -23588.701280558096,
                        "pretrain_loss": 1.211837887763977,
                        "pretrain_component": 0.6922887563705444,
                        "supervised_component": 0.6059189438819885,
                        "features_accuracy": [
                            0.6650435924530029,
                            0.6501612067222595,
                            0.35628560185432434,
                            0.3425005376338959,
                            0.6585282683372498,
                            0.5219120979309082,
                            0.7363007068634033,
                            0.6568822860717773,
                            0.6786915063858032,
                            0.34517523646354675,
                            0.5549688339233398,
                            0.3687675893306732,
                            0.32377752661705017,
                            0.33920857310295105,
                            0.3440779149532318,
                            0.6322612166404724
                        ]
                    },
                    "val": {
                        "score": -29515.994857380414,
                        "pretrain_loss": 1.2894387245178223,
                        "pretrain_component": 0.6922908425331116,
                        "supervised_component": 0.6447193622589111,
                        "features_accuracy": [
                            0.6555129289627075,
                            0.6574328541755676,
                            0.36533188819885254,
                            0.33708176016807556,
                            0.6678552031517029,
                            0.5202962160110474,
                            0.7353264093399048,
                            0.6555129289627075,
                            0.6719692945480347,
                            0.34914976358413696,
                            0.5532090067863464,
                            0.3702687919139862,
                            0.33845311403274536,
                            0.3395501971244812,
                            0.33187055587768555,
                            0.6267142295837402
                        ]
                    },
                    "test": {
                        "score": -31378.07817838323,
                        "pretrain_loss": 1.386839509010315,
                        "pretrain_component": 0.692277729511261,
                        "supervised_component": 0.6934197545051575,
                        "features_accuracy": [
                            0.6567917466163635,
                            0.6664472222328186,
                            0.3581303656101227,
                            0.3348694443702698,
                            0.6515251398086548,
                            0.5115207433700562,
                            0.7388632893562317,
                            0.6589862108230591,
                            0.6750054955482483,
                            0.36208033561706543,
                            0.5562870502471924,
                            0.3644942045211792,
                            0.3252139687538147,
                            0.3432082533836365,
                            0.3434276878833771,
                            0.6280447840690613
                        ]
                    }
                },
                "40000": {
                    "train": {
                        "score": -21903.977317439367,
                        "pretrain_loss": 1.1471902132034302,
                        "pretrain_component": 0.6924747228622437,
                        "supervised_component": 0.5735951066017151,
                        "features_accuracy": [
                            0.6598313450813293,
                            0.6586654186248779,
                            0.34510666131973267,
                            0.3486729562282562,
                            0.6651807427406311,
                            0.466977596282959,
                            0.73746657371521,
                            0.6640148758888245,
                            0.6683355569839478,
                            0.35628560185432434,
                            0.6308895349502563,
                            0.3786434531211853,
                            0.31835952401161194,
                            0.33742544054985046,
                            0.33673959970474243,
                            0.6505041122436523
                        ]
                    },
                    "val": {
                        "score": -29446.677066703603,
                        "pretrain_loss": 1.2723761796951294,
                        "pretrain_component": 0.6925035119056702,
                        "supervised_component": 0.6361880898475647,
                        "features_accuracy": [
                            0.6557871699333191,
                            0.6568843126296997,
                            0.3554580509662628,
                            0.34174439311027527,
                            0.6678552031517029,
                            0.4605046808719635,
                            0.736697793006897,
                            0.6555129289627075,
                            0.6653867363929749,
                            0.3507954180240631,
                            0.6407021880149841,
                            0.38069120049476624,
                            0.3368074893951416,
                            0.33982446789741516,
                            0.32857927680015564,
                            0.6464619040489197
                        ]
                    },
                    "test": {
                        "score": -31220.104132341843,
                        "pretrain_loss": 1.3606351613998413,
                        "pretrain_component": 0.6924830675125122,
                        "supervised_component": 0.6803175806999207,
                        "features_accuracy": [
                            0.6567917466163635,
                            0.6660083532333374,
                            0.34540268778800964,
                            0.33618608117103577,
                            0.6515251398086548,
                            0.46499890089035034,
                            0.7351327538490295,
                            0.6589862108230591,
                            0.6655694842338562,
                            0.36164143681526184,
                            0.6300197839736938,
                            0.37612465023994446,
                            0.3192889988422394,
                            0.34364715218544006,
                            0.3403555154800415,
                            0.6440640687942505
                        ]
                    }
                },
                "50000": {
                    "train": {
                        "score": -21323.76230071486,
                        "pretrain_loss": 1.1187223196029663,
                        "pretrain_component": 0.6925375461578369,
                        "supervised_component": 0.5593611598014832,
                        "features_accuracy": [
                            0.6684727072715759,
                            0.6566079258918762,
                            0.3525821566581726,
                            0.3424319624900818,
                            0.6561964750289917,
                            0.5428982973098755,
                            0.7195665836334229,
                            0.6666209697723389,
                            0.6880186796188354,
                            0.3504560887813568,
                            0.5922776460647583,
                            0.37377411127090454,
                            0.3165077865123749,
                            0.34140321612358093,
                            0.3394143283367157,
                            0.6258830428123474
                        ]
                    },
                    "val": {
                        "score": -29372.421212300334,
                        "pretrain_loss": 1.2581058740615845,
                        "pretrain_component": 0.6925280094146729,
                        "supervised_component": 0.6290529370307922,
                        "features_accuracy": [
                            0.6555129289627075,
                            0.6574328541755676,
                            0.36258915066719055,
                            0.34037303924560547,
                            0.6678552031517029,
                            0.538398265838623,
                            0.7153044939041138,
                            0.6555129289627075,
                            0.6848601698875427,
                            0.34777840971946716,
                            0.5855732560157776,
                            0.3815140128135681,
                            0.3321448266506195,
                            0.33982446789741516,
                            0.32857927680015564,
                            0.6324739456176758
                        ]
                    },
                    "test": {
                        "score": -31203.678154733818,
                        "pretrain_loss": 1.357157588005066,
                        "pretrain_component": 0.6925259828567505,
                        "supervised_component": 0.678578794002533,
                        "features_accuracy": [
                            0.6567917466163635,
                            0.6655694842338562,
                            0.3506692945957184,
                            0.3335527777671814,
                            0.6515251398086548,
                            0.5310511589050293,
                            0.7208690047264099,
                            0.6589862108230591,
                            0.68619704246521,
                            0.3631775379180908,
                            0.5878867506980896,
                            0.37634408473968506,
                            0.3164362609386444,
                            0.34408602118492126,
                            0.3403555154800415,
                            0.6216809153556824
                        ]
                    }
                },
                "60000": {
                    "train": {
                        "score": -21816.07810127175,
                        "pretrain_loss": 1.1539734601974487,
                        "pretrain_component": 0.6924681663513184,
                        "supervised_component": 0.5769867300987244,
                        "features_accuracy": [
                            0.6671696305274963,
                            0.6578424572944641,
                            0.3637610673904419,
                            0.34723272919654846,
                            0.651189923286438,
                            0.5824703574180603,
                            0.7272478342056274,
                            0.6524243950843811,
                            0.6867842078208923,
                            0.35539403557777405,
                            0.5907688140869141,
                            0.35834306478500366,
                            0.31451889872550964,
                            0.34394076466560364,
                            0.33488789200782776,
                            0.6127837896347046
                        ]
                    },
                    "val": {
                        "score": -29446.09716400616,
                        "pretrain_loss": 1.2555551528930664,
                        "pretrain_component": 0.6924075484275818,
                        "supervised_component": 0.6277775764465332,
                        "features_accuracy": [
                            0.6555129289627075,
                            0.6574328541755676,
                            0.3647833466529846,
                            0.34585848450660706,
                            0.6678552031517029,
                            0.5861217975616455,
                            0.725726842880249,
                            0.6555129289627075,
                            0.6903456449508667,
                            0.34777840971946716,
                            0.5899616479873657,
                            0.3573779761791229,
                            0.33461329340934753,
                            0.3409215807914734,
                            0.32857927680015564,
                            0.6146461963653564
                        ]
                    },
                    "test": {
                        "score": -31086.118156422628,
                        "pretrain_loss": 1.3475946187973022,
                        "pretrain_component": 0.6923864483833313,
                        "supervised_component": 0.6737973093986511,
                        "features_accuracy": [
                            0.6570112109184265,
                            0.6673250198364258,
                            0.3568136990070343,
                            0.3412332832813263,
                            0.6515251398086548,
                            0.589642345905304,
                            0.7241606712341309,
                            0.6589862108230591,
                            0.6894887089729309,
                            0.3581303656101227,
                            0.5839368104934692,
                            0.35198596119880676,
                            0.3192889988422394,
                            0.34386658668518066,
                            0.3399166166782379,
                            0.6137810349464417
                        ]
                    }
                },
                "70000": {
                    "train": {
                        "score": -23100.868009181606,
                        "pretrain_loss": 1.1657880544662476,
                        "pretrain_component": 0.6925992965698242,
                        "supervised_component": 0.5828940272331238,
                        "features_accuracy": [
                            0.6608600616455078,
                            0.6542075872421265,
                            0.3317331075668335,
                            0.35162198543548584,
                            0.6622316837310791,
                            0.5605239868164062,
                            0.7245045304298401,
                            0.6660037636756897,
                            0.6627803444862366,
                            0.34894728660583496,
                            0.586105227470398,
                            0.36232084035873413,
                            0.3189767599105835,
                            0.3378369212150574,
                            0.33667102456092834,
                            0.6162815093994141
                        ]
                    },
                    "val": {
                        "score": -29664.800924537227,
                        "pretrain_loss": 1.2481149435043335,
                        "pretrain_component": 0.6926077008247375,
                        "supervised_component": 0.6240574717521667,
                        "features_accuracy": [
                            0.6552386283874512,
                            0.6560614705085754,
                            0.3422929346561432,
                            0.3447614014148712,
                            0.6678552031517029,
                            0.5633571147918701,
                            0.7224355936050415,
                            0.6555129289627075,
                            0.6711465120315552,
                            0.34530994296073914,
                            0.5894131064414978,
                            0.3614920675754547,
                            0.33379048109054565,
                            0.33982446789741516,
                            0.3288535475730896,
                            0.608337938785553
                        ]
                    },
                    "test": {
                        "score": -31077.142996826653,
                        "pretrain_loss": 1.3450671434402466,
                        "pretrain_component": 0.6926093101501465,
                        "supervised_component": 0.6725335717201233,
                        "features_accuracy": [
                            0.6572306752204895,
                            0.6655694842338562,
                            0.33706384897232056,
                            0.3396971821784973,
                            0.6515251398086548,
                            0.5536537170410156,
                            0.7202106714248657,
                            0.6589862108230591,
                            0.6684222221374512,
                            0.3585692346096039,
                            0.5815229415893555,
                            0.35988590121269226,
                            0.3173140287399292,
                            0.34474435448646545,
                            0.3403555154800415,
                            0.605222761631012
                        ]
                    }
                },
                "80000": {
                    "train": {
                        "score": -22626.590599533316,
                        "pretrain_loss": 1.1054550409317017,
                        "pretrain_component": 0.6927652359008789,
                        "supervised_component": 0.5527275204658508,
                        "features_accuracy": [
                            0.6602427959442139,
                            0.6555106043815613,
                            0.34387218952178955,
                            0.34222620725631714,
                            0.6626431941986084,
                            0.5108017325401306,
                            0.7212811708450317,
                            0.6651121377944946,
                            0.6925451159477234,
                            0.36314383149147034,
                            0.5866538882255554,
                            0.35457104444503784,
                            0.3130100965499878,
                            0.3407173752784729,
                            0.33193883299827576,
                            0.6548247933387756
                        ]
                    },
                    "val": {
                        "score": -29660.510647737974,
                        "pretrain_loss": 1.2507165670394897,
                        "pretrain_component": 0.6927847862243652,
                        "supervised_component": 0.6253582835197449,
                        "features_accuracy": [
                            0.6557871699333191,
                            0.656335711479187,
                            0.35271531343460083,
                            0.33516183495521545,
                            0.6678552031517029,
                            0.5082282423973083,
                            0.7188700437545776,
                            0.6555129289627075,
                            0.6818431615829468,
                            0.3647833466529846,
                            0.5916072726249695,
                            0.3554580509662628,
                            0.3329676389694214,
                            0.33982446789741516,
                            0.3288535475730896,
                            0.6368623375892639
                        ]
                    },
                    "test": {
                        "score": -31053.01412528977,
                        "pretrain_loss": 1.3407303094863892,
                        "pretrain_component": 0.692762017250061,
                        "supervised_component": 0.6703651547431946,
                        "features_accuracy": [
                            0.6572306752204895,
                            0.6671055555343628,
                            0.3504498600959778,
                            0.335308313369751,
                            0.6513056755065918,
                            0.5036208033561707,
                            0.7136273980140686,
                            0.6589862108230591,
                            0.6826859712600708,
                            0.3745885491371155,
                            0.5922756195068359,
                            0.3574720323085785,
                            0.3175334632396698,
                            0.34430545568466187,
                            0.3399166166782379,
                            0.6412113308906555
                        ]
                    }
                }
            },
            "train": {
                "score": -21323.76230071486
            },
            "val": {
                "score": -29372.421212300334
            },
            "test": {
                "score": -31203.678154733818
            }
        },
        "best_iteration": 50000,
        "time": "0:12:05",
        "trial_id": 95,
        "tuning_time": "7:53:32"
    },
    "time": "8:31:39",
    "continuations": [
        8
    ]
}
