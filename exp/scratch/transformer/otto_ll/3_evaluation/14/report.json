{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/finetune___ee6246c4eb98417f87d248ae9eaf9767.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 14,
        "data": {
            "path": "data/otto_ll",
            "T": {
                "seed": 0,
                "normalization": null,
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "transformer",
            "config": {
                "n_blocks": 2,
                "attention_dropout": 0.3385512620717073,
                "ffn_dropout": 0.034340018443920345,
                "last_layer_query_idx": [
                    -1
                ],
                "ffn_d_hidden": 1348
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear"
            ],
            "d_num_embedding": 512,
            "d_cat_embedding": null,
            "positional_encoding": null
        },
        "training": {
            "batch_size": 256,
            "lr": 5.139597243892013e-05,
            "weight_decay": 6.928623172166453e-06,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "bins": null
    },
    "prediction_type": "logits",
    "epoch_size": 155,
    "n_parameters": 6353177,
    "best_epoch": 14,
    "metrics": {
        "train": {
            "0": {
                "precision": 0.7517842981760507,
                "recall": 0.7676113360323886,
                "f1-score": 0.7596153846153846,
                "support": 1235
            },
            "1": {
                "precision": 0.8021672686857461,
                "recall": 0.8394068617949215,
                "f1-score": 0.8203646696661142,
                "support": 10318
            },
            "2": {
                "precision": 0.6445259702645298,
                "recall": 0.6516985552518547,
                "f1-score": 0.6480924182118241,
                "support": 5122
            },
            "3": {
                "precision": 0.789865871833085,
                "recall": 0.6155632984901278,
                "f1-score": 0.6919060052219321,
                "support": 1722
            },
            "4": {
                "precision": 0.9818181818181818,
                "recall": 0.9857387335995437,
                "f1-score": 0.9837745516652433,
                "support": 1753
            },
            "5": {
                "precision": 0.963495575221239,
                "recall": 0.9628565111651559,
                "f1-score": 0.963175937188986,
                "support": 9046
            },
            "6": {
                "precision": 0.8451219512195122,
                "recall": 0.7627958172812328,
                "f1-score": 0.8018513161700898,
                "support": 1817
            },
            "7": {
                "precision": 0.9373172514619883,
                "recall": 0.9468340409820935,
                "f1-score": 0.9420516117182478,
                "support": 5417
            },
            "8": {
                "precision": 0.9102893890675241,
                "recall": 0.8927783033743298,
                "f1-score": 0.9014488138831396,
                "support": 3171
            },
            "accuracy": 0.8532865331683543,
            "macro avg": {
                "precision": 0.8473761953053174,
                "recall": 0.8250314953301832,
                "f1-score": 0.8346978564823291,
                "support": 39601
            },
            "weighted avg": {
                "precision": 0.8535919944694733,
                "recall": 0.8532865331683543,
                "f1-score": 0.8527470795321096,
                "support": 39601
            },
            "logloss": 0.373623450499871,
            "score": -0.373623450499871
        },
        "val": {
            "0": {
                "precision": 0.5814696485623003,
                "recall": 0.5909090909090909,
                "f1-score": 0.5861513687600644,
                "support": 308
            },
            "1": {
                "precision": 0.7675874769797422,
                "recall": 0.8077519379844961,
                "f1-score": 0.7871576959395656,
                "support": 2580
            },
            "2": {
                "precision": 0.5899390243902439,
                "recall": 0.6042154566744731,
                "f1-score": 0.5969919012726571,
                "support": 1281
            },
            "3": {
                "precision": 0.7142857142857143,
                "recall": 0.5336426914153132,
                "f1-score": 0.6108897742363878,
                "support": 431
            },
            "4": {
                "precision": 0.9748283752860412,
                "recall": 0.9726027397260274,
                "f1-score": 0.9737142857142856,
                "support": 438
            },
            "5": {
                "precision": 0.9432782492184011,
                "recall": 0.9336870026525199,
                "f1-score": 0.938458120417685,
                "support": 2262
            },
            "6": {
                "precision": 0.7641277641277642,
                "recall": 0.6850220264317181,
                "f1-score": 0.7224157955865274,
                "support": 454
            },
            "7": {
                "precision": 0.9063860667634253,
                "recall": 0.9224519940915805,
                "f1-score": 0.9143484626647145,
                "support": 1354
            },
            "8": {
                "precision": 0.8624678663239075,
                "recall": 0.8461538461538461,
                "f1-score": 0.8542329726288987,
                "support": 793
            },
            "accuracy": 0.811938188061812,
            "macro avg": {
                "precision": 0.7893744651041712,
                "recall": 0.7662707540043405,
                "f1-score": 0.7760400419134208,
                "support": 9901
            },
            "weighted avg": {
                "precision": 0.8122215292273325,
                "recall": 0.811938188061812,
                "f1-score": 0.8112445265927704,
                "support": 9901
            },
            "logloss": 0.486785295993097,
            "score": -0.486785295993097
        },
        "test": {
            "0": {
                "precision": 0.6057441253263708,
                "recall": 0.6010362694300518,
                "f1-score": 0.6033810143042914,
                "support": 386
            },
            "1": {
                "precision": 0.7661410294555192,
                "recall": 0.798697270471464,
                "f1-score": 0.7820804859529233,
                "support": 3224
            },
            "2": {
                "precision": 0.5741538461538461,
                "recall": 0.5827607745159276,
                "f1-score": 0.578425294482331,
                "support": 1601
            },
            "3": {
                "precision": 0.6905311778290993,
                "recall": 0.5557620817843866,
                "f1-score": 0.615859938208033,
                "support": 538
            },
            "4": {
                "precision": 0.9852125693160814,
                "recall": 0.9726277372262774,
                "f1-score": 0.9788797061524335,
                "support": 548
            },
            "5": {
                "precision": 0.9507670353193007,
                "recall": 0.942695436858861,
                "f1-score": 0.9467140319715808,
                "support": 2827
            },
            "6": {
                "precision": 0.7371541501976284,
                "recall": 0.6566901408450704,
                "f1-score": 0.6945996275605213,
                "support": 568
            },
            "7": {
                "precision": 0.9054755043227666,
                "recall": 0.9279385705847608,
                "f1-score": 0.9165694282380398,
                "support": 1693
            },
            "8": {
                "precision": 0.8685540950455005,
                "recall": 0.8668012108980827,
                "f1-score": 0.8676767676767677,
                "support": 991
            },
            "accuracy": 0.8112475759534583,
            "macro avg": {
                "precision": 0.7870815036629015,
                "recall": 0.7672232769572092,
                "f1-score": 0.7760206993941023,
                "support": 12376
            },
            "weighted avg": {
                "precision": 0.8108199405186329,
                "recall": 0.8112475759534583,
                "f1-score": 0.8104931363962559,
                "support": 12376
            },
            "logloss": 0.4812203181071331,
            "score": -0.4812203181071331
        }
    },
    "time": "0:02:13"
}
