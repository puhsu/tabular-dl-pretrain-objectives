{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask___ea2d408d6531460e9fb04c36ba2fd3cd.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 10,
        "data": {
            "path": "data/fb-comments",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512,
                    512
                ],
                "dropout": 0.2055377573979086
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [],
            "d_num_embedding": null,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 512,
            "lr": 6.937721619955348e-05,
            "weight_decay": 0.0004125068850257459,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.549309947737485,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 6.937721619955348e-05,
            "weight_decay": 0.0004125068850257459,
            "patience": 2,
            "n_iterations": 100000,
            "finetune_every": 10000,
            "replace_strategy": "target_shuffle",
            "n_neighbors": 20,
            "use_target": true,
            "target_injection_type": "post"
        },
        "bins": null
    },
    "epoch_size": 308,
    "n_parameters": 619571,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -4.090600097393845,
                    "pretrain_loss": 0.26212984323501587,
                    "features_accuracy": [
                        0.8567667603492737,
                        0.7932795286178589,
                        0.884742259979248,
                        0.8980258703231812,
                        0.8690734505653381,
                        0.8993263244628906,
                        0.8861188292503357,
                        0.9023966789245605,
                        0.8668975830078125,
                        0.9021365642547607,
                        0.9950265884399414,
                        0.8469658493995667,
                        0.8890432715415955,
                        0.9058729410171509,
                        0.8855035305023193,
                        0.898216187953949,
                        0.8844504952430725,
                        0.8812659382820129,
                        0.854667067527771,
                        0.8846661448478699,
                        0.9071733951568604,
                        0.8377739191055298,
                        0.6699780821800232,
                        0.8547368049621582,
                        0.8332698941230774,
                        0.8235006928443909,
                        0.7852612137794495,
                        0.7964830994606018,
                        0.8243253827095032,
                        0.9886068105697632,
                        0.8847295641899109,
                        0.9955658316612244,
                        0.9146208763122559,
                        0.9115886092185974,
                        0.9069830775260925,
                        0.9152044653892517,
                        0.9133838415145874,
                        0.9192136526107788,
                        0.9179258942604065,
                        0.920691728591919,
                        0.8730699419975281,
                        0.9125782251358032,
                        0.8863028287887573,
                        0.9074652194976807,
                        0.9142656326293945,
                        0.9144432544708252,
                        0.9053337574005127,
                        0.8852180242538452,
                        0.8971948623657227,
                        0.9974498748779297,
                        0.9404585361480713
                    ]
                },
                "val": {
                    "score": -5.371231996493936,
                    "pretrain_loss": 0.8510404229164124,
                    "features_accuracy": [
                        0.28293275833129883,
                        0.4942196309566498,
                        0.327907919883728,
                        0.33500659465789795,
                        0.4276442527770996,
                        0.32324308156967163,
                        0.3637562096118927,
                        0.339570015668869,
                        0.4777405858039856,
                        0.3301389217376709,
                        0.9938139915466309,
                        0.29758644104003906,
                        0.3359699845314026,
                        0.3350572884082794,
                        0.3803366720676422,
                        0.331457257270813,
                        0.3598519265651703,
                        0.32582902908325195,
                        0.4569009244441986,
                        0.6900922656059265,
                        0.3148260712623596,
                        0.5942602157592773,
                        0.5067437291145325,
                        0.7079910635948181,
                        0.5949193835258484,
                        0.695416271686554,
                        0.6402494311332703,
                        0.70246422290802,
                        0.4222695231437683,
                        0.9879322052001953,
                        0.8950410485267639,
                        0.9935097694396973,
                        0.9080214500427246,
                        0.9066524505615234,
                        0.9016326665878296,
                        0.9049285054206848,
                        0.9053341150283813,
                        0.6009025573730469,
                        0.9057397842407227,
                        0.6029307246208191,
                        0.8763309717178345,
                        0.9086806178092957,
                        0.3923029899597168,
                        0.9023932218551636,
                        0.9110130667686462,
                        0.9103031754493713,
                        0.3207078278064728,
                        0.38900718092918396,
                        0.33997565507888794,
                        0.9959942698478699,
                        0.4463036060333252
                    ]
                },
                "test": {
                    "score": -5.663205433132017,
                    "pretrain_loss": 0.5567641854286194,
                    "features_accuracy": [
                        0.6705882549285889,
                        0.7765213251113892,
                        0.4957403540611267,
                        0.5885902643203735,
                        0.6186105608940125,
                        0.560496985912323,
                        0.5215010046958923,
                        0.5841785073280334,
                        0.6415821313858032,
                        0.5859533548355103,
                        0.9948782920837402,
                        0.5270283818244934,
                        0.44680526852607727,
                        0.6053752303123474,
                        0.6133367419242859,
                        0.5528904795646667,
                        0.5153144001960754,
                        0.4574543535709381,
                        0.5713489055633545,
                        0.5068965554237366,
                        0.5472109317779541,
                        0.5557302236557007,
                        0.5379310250282288,
                        0.5748478770256042,
                        0.547160267829895,
                        0.4875253438949585,
                        0.41871196031570435,
                        0.5969573855400085,
                        0.6452839970588684,
                        0.9885902404785156,
                        0.9139452576637268,
                        0.9955882430076599,
                        0.5753042697906494,
                        0.90892493724823,
                        0.9042596220970154,
                        0.9102941155433655,
                        0.9129310250282288,
                        0.9172413945198059,
                        0.9180020093917847,
                        0.5786511301994324,
                        0.9003549814224243,
                        0.9095335006713867,
                        0.4485801160335541,
                        0.9064908623695374,
                        0.9123732447624207,
                        0.9115618467330933,
                        0.5883874297142029,
                        0.6364604234695435,
                        0.5263691544532776,
                        0.9968559741973877,
                        0.5152130126953125
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -5.1998914298960415,
                    "pretrain_loss": 0.2012627124786377,
                    "features_accuracy": [
                        0.9239333271980286,
                        0.8011837601661682,
                        0.9246628284454346,
                        0.9232926368713379,
                        0.9129334688186646,
                        0.9229564070701599,
                        0.9181733131408691,
                        0.9226201772689819,
                        0.9031515717506409,
                        0.9257159233093262,
                        0.9951217770576477,
                        0.9104974865913391,
                        0.9183001518249512,
                        0.9245613813400269,
                        0.9141704440116882,
                        0.925366997718811,
                        0.9209898710250854,
                        0.9182748198509216,
                        0.9031451940536499,
                        0.9054986834526062,
                        0.9334551692008972,
                        0.88834547996521,
                        0.8422842621803284,
                        0.9057207107543945,
                        0.887209951877594,
                        0.8907940983772278,
                        0.8727400898933411,
                        0.8747003078460693,
                        0.8743957877159119,
                        0.9888415336608887,
                        0.8882502913475037,
                        0.9953755140304565,
                        0.9150712490081787,
                        0.9118740558624268,
                        0.9072558879852295,
                        0.9139738082885742,
                        0.9137834906578064,
                        0.9195308685302734,
                        0.917291522026062,
                        0.920488715171814,
                        0.8776310682296753,
                        0.9130285978317261,
                        0.9216432571411133,
                        0.9073129892349243,
                        0.9147287011146545,
                        0.9160545468330383,
                        0.9248848557472229,
                        0.9214720129966736,
                        0.9257412552833557,
                        0.9974244832992554,
                        0.9427613019943237
                    ]
                },
                "val": {
                    "score": -5.574852826101934,
                    "pretrain_loss": 0.815200686454773,
                    "features_accuracy": [
                        0.32435858249664307,
                        0.4953351318836212,
                        0.3358178734779358,
                        0.3056991994380951,
                        0.4215089678764343,
                        0.3007301390171051,
                        0.32091066241264343,
                        0.32902342081069946,
                        0.4602474272251129,
                        0.2815130352973938,
                        0.9938139915466309,
                        0.3544265329837799,
                        0.3285163640975952,
                        0.32729944586753845,
                        0.3461616337299347,
                        0.33282628655433655,
                        0.33399248123168945,
                        0.29134973883628845,
                        0.4140046536922455,
                        0.6619511246681213,
                        0.2758847773075104,
                        0.5802657008171082,
                        0.5164790153503418,
                        0.6800526976585388,
                        0.5547104477882385,
                        0.5434539914131165,
                        0.5910658240318298,
                        0.7219855785369873,
                        0.439002126455307,
                        0.9879322052001953,
                        0.89711993932724,
                        0.9935097694396973,
                        0.9079200625419617,
                        0.9067538380622864,
                        0.9022411108016968,
                        0.9053341150283813,
                        0.9059425592422485,
                        0.6021194458007812,
                        0.9094918966293335,
                        0.603032112121582,
                        0.8895649313926697,
                        0.9086299538612366,
                        0.3372375965118408,
                        0.9025453329086304,
                        0.911266565322876,
                        0.9108609557151794,
                        0.3007301390171051,
                        0.3441334366798401,
                        0.31011053919792175,
                        0.9959942698478699,
                        0.4229794144630432
                    ]
                },
                "test": {
                    "score": -5.853187576943599,
                    "pretrain_loss": 0.5302082300186157,
                    "features_accuracy": [
                        0.6512677669525146,
                        0.7757606506347656,
                        0.592190682888031,
                        0.6425963640213013,
                        0.6434584259986877,
                        0.5860040783882141,
                        0.5426470637321472,
                        0.6176977753639221,
                        0.6754056811332703,
                        0.624492883682251,
                        0.9947769045829773,
                        0.5201825499534607,
                        0.5882353186607361,
                        0.637829601764679,
                        0.6551216840744019,
                        0.6001014113426208,
                        0.5675963759422302,
                        0.5121703743934631,
                        0.5972616672515869,
                        0.5702332854270935,
                        0.5973123908042908,
                        0.6615618467330933,
                        0.6269776821136475,
                        0.628346860408783,
                        0.66054767370224,
                        0.6255578398704529,
                        0.5240872502326965,
                        0.6170892715454102,
                        0.6123225092887878,
                        0.9885902404785156,
                        0.9172413945198059,
                        0.9955882430076599,
                        0.5753042697906494,
                        0.90892493724823,
                        0.9042596220970154,
                        0.9102941155433655,
                        0.9129310250282288,
                        0.9172413945198059,
                        0.9180020093917847,
                        0.5786004066467285,
                        0.9101420044898987,
                        0.9095335006713867,
                        0.4839756488800049,
                        0.9065415859222412,
                        0.9123732447624207,
                        0.9115618467330933,
                        0.6445740461349487,
                        0.658316433429718,
                        0.5862069129943848,
                        0.9968559741973877,
                        0.550507128238678
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -4.426069562304969,
                    "pretrain_loss": 0.16938133537769318,
                    "features_accuracy": [
                        0.9469671249389648,
                        0.8079841136932373,
                        0.9411944150924683,
                        0.9382319450378418,
                        0.9248278141021729,
                        0.9403380155563354,
                        0.9374579787254333,
                        0.9412895441055298,
                        0.9143734574317932,
                        0.9407122731208801,
                        0.994944155216217,
                        0.9418604969978333,
                        0.9354661107063293,
                        0.938974142074585,
                        0.9357832670211792,
                        0.9430594444274902,
                        0.9332648515701294,
                        0.9382319450378418,
                        0.9396085143089294,
                        0.9230008125305176,
                        0.9455334544181824,
                        0.9166191220283508,
                        0.8616958260536194,
                        0.9306702613830566,
                        0.9166762232780457,
                        0.9208122491836548,
                        0.9033418297767639,
                        0.9052068591117859,
                        0.9097108840942383,
                        0.9888796210289001,
                        0.8911113142967224,
                        0.9948743581771851,
                        0.9157056212425232,
                        0.9119945764541626,
                        0.9077824354171753,
                        0.9135868549346924,
                        0.9126226305961609,
                        0.9192009568214417,
                        0.917760968208313,
                        0.9204823970794678,
                        0.8816909790039062,
                        0.9132760167121887,
                        0.9390565752983093,
                        0.9083850383758545,
                        0.915026843547821,
                        0.9158769249916077,
                        0.9402682185173035,
                        0.9411500096321106,
                        0.9434590935707092,
                        0.9973229765892029,
                        0.9482104778289795
                    ]
                },
                "val": {
                    "score": -5.407418859601252,
                    "pretrain_loss": 0.8707306385040283,
                    "features_accuracy": [
                        0.31436973810195923,
                        0.4954872727394104,
                        0.2787749767303467,
                        0.2946455776691437,
                        0.41902443766593933,
                        0.2697495222091675,
                        0.2775580585002899,
                        0.3004259169101715,
                        0.461565762758255,
                        0.2626001238822937,
                        0.9938139915466309,
                        0.37896764278411865,
                        0.2744143605232239,
                        0.3005780279636383,
                        0.3384545147418976,
                        0.28247642517089844,
                        0.2864820957183838,
                        0.26031842827796936,
                        0.38697898387908936,
                        0.6352803707122803,
                        0.26163673400878906,
                        0.5890883207321167,
                        0.4991379976272583,
                        0.5690091848373413,
                        0.5059831738471985,
                        0.5276848077774048,
                        0.5562316179275513,
                        0.6865429282188416,
                        0.45177972316741943,
                        0.9879322052001953,
                        0.9031031131744385,
                        0.9935097694396973,
                        0.9060440063476562,
                        0.9067031741142273,
                        0.9022411108016968,
                        0.9053341150283813,
                        0.9058918952941895,
                        0.6021194458007812,
                        0.9094412326812744,
                        0.603032112121582,
                        0.8940776586532593,
                        0.9086299538612366,
                        0.28521448373794556,
                        0.9025960564613342,
                        0.911266565322876,
                        0.9108609557151794,
                        0.27213263511657715,
                        0.32628536224365234,
                        0.28060033917427063,
                        0.9959942698478699,
                        0.41826385259628296
                    ]
                },
                "test": {
                    "score": -5.679500610379246,
                    "pretrain_loss": 0.5052278637886047,
                    "features_accuracy": [
                        0.587221086025238,
                        0.7748985886573792,
                        0.7016734480857849,
                        0.6513691544532776,
                        0.6679006218910217,
                        0.5923935174942017,
                        0.618864119052887,
                        0.6180527210235596,
                        0.6969066858291626,
                        0.6196754574775696,
                        0.9947261810302734,
                        0.6231744289398193,
                        0.6934584379196167,
                        0.6737322807312012,
                        0.6708418130874634,
                        0.6338235139846802,
                        0.6230223178863525,
                        0.6279919147491455,
                        0.5611562132835388,
                        0.6929005980491638,
                        0.6300709843635559,
                        0.6562373042106628,
                        0.7626267671585083,
                        0.6868154406547546,
                        0.7000507116317749,
                        0.7157200574874878,
                        0.6417343020439148,
                        0.6046653389930725,
                        0.4876267910003662,
                        0.9885902404785156,
                        0.9224138259887695,
                        0.9955882430076599,
                        0.5760648846626282,
                        0.90892493724823,
                        0.9042089581489563,
                        0.9102941155433655,
                        0.9129310250282288,
                        0.9172413945198059,
                        0.9179513454437256,
                        0.5791582465171814,
                        0.9156186580657959,
                        0.9094827771186829,
                        0.568965494632721,
                        0.9065415859222412,
                        0.9123732447624207,
                        0.9116125702857971,
                        0.6092292070388794,
                        0.6632353067398071,
                        0.6123732328414917,
                        0.9968559741973877,
                        0.5220081210136414
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -4.424419510553954,
                    "pretrain_loss": 0.1516927182674408,
                    "features_accuracy": [
                        0.9534249305725098,
                        0.8162562251091003,
                        0.9476332068443298,
                        0.9502150416374207,
                        0.9314759373664856,
                        0.9528920650482178,
                        0.9483627080917358,
                        0.9517185091972351,
                        0.9203618764877319,
                        0.9484007954597473,
                        0.9950329661369324,
                        0.9536596536636353,
                        0.9468973278999329,
                        0.9502785205841064,
                        0.9455080628395081,
                        0.9523274898529053,
                        0.9457554817199707,
                        0.949510931968689,
                        0.9493396282196045,
                        0.9318057894706726,
                        0.9525812268257141,
                        0.925899863243103,
                        0.8676207661628723,
                        0.937572181224823,
                        0.9252274632453918,
                        0.9278600811958313,
                        0.9280250072479248,
                        0.9247897267341614,
                        0.9312666058540344,
                        0.9886956214904785,
                        0.8924815058708191,
                        0.9950392842292786,
                        0.9154455065727234,
                        0.9115886092185974,
                        0.9083153009414673,
                        0.9143861532211304,
                        0.913231611251831,
                        0.919289767742157,
                        0.9174438118934631,
                        0.9197021126747131,
                        0.8828328251838684,
                        0.9130476117134094,
                        0.948641836643219,
                        0.9085626602172852,
                        0.9138088822364807,
                        0.9158007502555847,
                        0.9484325051307678,
                        0.9474365711212158,
                        0.9539324641227722,
                        0.9972468614578247,
                        0.9481026530265808
                    ]
                },
                "val": {
                    "score": -5.422826074575433,
                    "pretrain_loss": 0.9408683776855469,
                    "features_accuracy": [
                        0.32030218839645386,
                        0.49574077129364014,
                        0.2690396308898926,
                        0.28627926111221313,
                        0.4227258861064911,
                        0.26716357469558716,
                        0.26893824338912964,
                        0.2855693995952606,
                        0.4646587371826172,
                        0.2605719566345215,
                        0.9938139915466309,
                        0.3232937753200531,
                        0.2630564868450165,
                        0.2854680120944977,
                        0.330392450094223,
                        0.26721426844596863,
                        0.2755805552005768,
                        0.2505323886871338,
                        0.3837338984012604,
                        0.6189534068107605,
                        0.25803670287132263,
                        0.5273805856704712,
                        0.49817460775375366,
                        0.5296623110771179,
                        0.5064395070075989,
                        0.5334144234657288,
                        0.49224215745925903,
                        0.6680864095687866,
                        0.45522764325141907,
                        0.9879322052001953,
                        0.9059932827949524,
                        0.9935097694396973,
                        0.9062467813491821,
                        0.9067031741142273,
                        0.9022918343544006,
                        0.9053341150283813,
                        0.9059425592422485,
                        0.6019166111946106,
                        0.9094412326812744,
                        0.6038941144943237,
                        0.8945339918136597,
                        0.9085792303085327,
                        0.26817765831947327,
                        0.9024946689605713,
                        0.9113172888755798,
                        0.9108609557151794,
                        0.27461716532707214,
                        0.3159922957420349,
                        0.26559171080589294,
                        0.9959942698478699,
                        0.3950410485267639
                    ]
                },
                "test": {
                    "score": -5.624221473771799,
                    "pretrain_loss": 0.489845335483551,
                    "features_accuracy": [
                        0.5902636647224426,
                        0.7747464776039124,
                        0.7272312641143799,
                        0.6552738547325134,
                        0.6796146035194397,
                        0.6376267671585083,
                        0.6509127616882324,
                        0.6246957182884216,
                        0.7006592154502869,
                        0.6193205118179321,
                        0.9946754574775696,
                        0.6931541562080383,
                        0.6752535700798035,
                        0.6646044850349426,
                        0.6788032650947571,
                        0.6469573974609375,
                        0.7104462385177612,
                        0.6706896424293518,
                        0.5438134074211121,
                        0.7215009927749634,
                        0.6563894748687744,
                        0.6508113741874695,
                        0.7826572060585022,
                        0.7018762826919556,
                        0.6735293865203857,
                        0.7562373280525208,
                        0.6631338596343994,
                        0.5966024398803711,
                        0.46850913763046265,
                        0.9885902404785156,
                        0.922261655330658,
                        0.995537519454956,
                        0.5766734480857849,
                        0.90892493724823,
                        0.9042089581489563,
                        0.9102941155433655,
                        0.9129310250282288,
                        0.9172413945198059,
                        0.9180020093917847,
                        0.579361081123352,
                        0.9159229397773743,
                        0.909432053565979,
                        0.6451825499534607,
                        0.9065415859222412,
                        0.9123732447624207,
                        0.911663293838501,
                        0.6310344934463501,
                        0.6871196627616882,
                        0.6622210741043091,
                        0.9969066977500916,
                        0.5458418130874634
                    ]
                }
            }
        },
        "train": {
            "score": -4.090600097393845
        },
        "val": {
            "score": -5.371231996493936
        },
        "test": {
            "score": -5.663205433132017
        }
    },
    "best_iteration": 10000,
    "time": "0:11:48"
}
