{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask___ea2d408d6531460e9fb04c36ba2fd3cd.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 11,
        "data": {
            "path": "data/fb-comments",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512,
                    512
                ],
                "dropout": 0.2055377573979086
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [],
            "d_num_embedding": null,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 512,
            "lr": 6.937721619955348e-05,
            "weight_decay": 0.0004125068850257459,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.549309947737485,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 6.937721619955348e-05,
            "weight_decay": 0.0004125068850257459,
            "patience": 2,
            "n_iterations": 100000,
            "finetune_every": 10000,
            "replace_strategy": "target_shuffle",
            "n_neighbors": 20,
            "use_target": true,
            "target_injection_type": "post"
        },
        "bins": null
    },
    "epoch_size": 308,
    "n_parameters": 619571,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -4.461976826832278,
                    "pretrain_loss": 0.2606699764728546,
                    "features_accuracy": [
                        0.8473591804504395,
                        0.7958043217658997,
                        0.8871845602989197,
                        0.9044519662857056,
                        0.8748335242271423,
                        0.8993326425552368,
                        0.8906101584434509,
                        0.9024600982666016,
                        0.8671576976776123,
                        0.8985016345977783,
                        0.9951090812683105,
                        0.8406348824501038,
                        0.8920057415962219,
                        0.9108273386955261,
                        0.8936678171157837,
                        0.8973407745361328,
                        0.8985904455184937,
                        0.8849769830703735,
                        0.8476953506469727,
                        0.8886436223983765,
                        0.8992692232131958,
                        0.8398545980453491,
                        0.7309151291847229,
                        0.8589046001434326,
                        0.8126720786094666,
                        0.8298062682151794,
                        0.7835484147071838,
                        0.7855656743049622,
                        0.8221875429153442,
                        0.9885433912277222,
                        0.8831436634063721,
                        0.9949694871902466,
                        0.91542649269104,
                        0.9114173054695129,
                        0.9075096249580383,
                        0.9136756658554077,
                        0.9139230847358704,
                        0.918293833732605,
                        0.9178751707077026,
                        0.9196006059646606,
                        0.8742562532424927,
                        0.9133521318435669,
                        0.8879077434539795,
                        0.9078331589698792,
                        0.9149888157844543,
                        0.915895938873291,
                        0.9110049605369568,
                        0.8880980610847473,
                        0.8989964723587036,
                        0.9974879622459412,
                        0.9401540160179138
                    ]
                },
                "val": {
                    "score": -5.4079801155927845,
                    "pretrain_loss": 0.8825207948684692,
                    "features_accuracy": [
                        0.27618902921676636,
                        0.49979716539382935,
                        0.3173106014728546,
                        0.31680357456207275,
                        0.42470335960388184,
                        0.308893620967865,
                        0.34753066301345825,
                        0.330392450094223,
                        0.47677719593048096,
                        0.34824052453041077,
                        0.9933069348335266,
                        0.30529356002807617,
                        0.3295811712741852,
                        0.3032146692276001,
                        0.3752661943435669,
                        0.31305140256881714,
                        0.2828313410282135,
                        0.3410911560058594,
                        0.44037115573883057,
                        0.672142744064331,
                        0.32177263498306274,
                        0.5654598474502563,
                        0.4916844069957733,
                        0.7330899238586426,
                        0.5596795082092285,
                        0.687658429145813,
                        0.6337085366249084,
                        0.6959739923477173,
                        0.42450055480003357,
                        0.9870702624320984,
                        0.8965622186660767,
                        0.9941182136535645,
                        0.909136950969696,
                        0.904877781867981,
                        0.9023425579071045,
                        0.9070073962211609,
                        0.904117226600647,
                        0.5845755934715271,
                        0.9073622822761536,
                        0.5925869345664978,
                        0.8799310326576233,
                        0.9054355025291443,
                        0.3863198459148407,
                        0.9004157781600952,
                        0.9106581211090088,
                        0.9075144529342651,
                        0.30443158745765686,
                        0.3837338984012604,
                        0.3216712176799774,
                        0.9959436058998108,
                        0.4500557482242584
                    ]
                },
                "test": {
                    "score": -5.6299988279509545,
                    "pretrain_loss": 0.5469114184379578,
                    "features_accuracy": [
                        0.6660750508308411,
                        0.7734786868095398,
                        0.5082657337188721,
                        0.6003549695014954,
                        0.6675456166267395,
                        0.5806288123130798,
                        0.5304259657859802,
                        0.6112576127052307,
                        0.6599898338317871,
                        0.5818458199501038,
                        0.9947261810302734,
                        0.5318965315818787,
                        0.4705375134944916,
                        0.6606997847557068,
                        0.6520283818244934,
                        0.5868661403656006,
                        0.5898579955101013,
                        0.48661258816719055,
                        0.5886409878730774,
                        0.5537525415420532,
                        0.5634381175041199,
                        0.6004056930541992,
                        0.5670385360717773,
                        0.6273833513259888,
                        0.5545132160186768,
                        0.5036511421203613,
                        0.3629310429096222,
                        0.5988336801528931,
                        0.6613590121269226,
                        0.9886916875839233,
                        0.9081135988235474,
                        0.995537519454956,
                        0.5819472670555115,
                        0.9080121517181396,
                        0.904411792755127,
                        0.9150101542472839,
                        0.91217041015625,
                        0.9175963401794434,
                        0.9173935055732727,
                        0.5657200813293457,
                        0.9012677669525146,
                        0.9096856117248535,
                        0.4723123610019684,
                        0.9049695730209351,
                        0.9115111827850342,
                        0.9097869992256165,
                        0.6404158473014832,
                        0.632251501083374,
                        0.5742900371551514,
                        0.997768759727478,
                        0.5193712115287781
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -4.176708425644939,
                    "pretrain_loss": 0.20038393139839172,
                    "features_accuracy": [
                        0.9210659861564636,
                        0.803562581539154,
                        0.9244852066040039,
                        0.9259252548217773,
                        0.9125211238861084,
                        0.9278663992881775,
                        0.9258871674537659,
                        0.9292619824409485,
                        0.8987363576889038,
                        0.9250815510749817,
                        0.995274007320404,
                        0.9119311571121216,
                        0.9197655320167542,
                        0.9320595264434814,
                        0.9196767210960388,
                        0.927834689617157,
                        0.9225060343742371,
                        0.9200827479362488,
                        0.9086768627166748,
                        0.9108020067214966,
                        0.9311841130256653,
                        0.8935282230377197,
                        0.8471497893333435,
                        0.8893795013427734,
                        0.8953996300697327,
                        0.8998972773551941,
                        0.8731143474578857,
                        0.8645440936088562,
                        0.8747764229774475,
                        0.9886766076087952,
                        0.887679398059845,
                        0.9951725006103516,
                        0.9151537418365479,
                        0.9113094806671143,
                        0.9075096249580383,
                        0.9140626192092896,
                        0.9137263894081116,
                        0.91895991563797,
                        0.9168030619621277,
                        0.9200763702392578,
                        0.8775168657302856,
                        0.9127811789512634,
                        0.915959358215332,
                        0.9068054556846619,
                        0.9143100380897522,
                        0.9152869582176208,
                        0.9329920411109924,
                        0.9240538477897644,
                        0.9235844612121582,
                        0.9975323677062988,
                        0.9430086612701416
                    ]
                },
                "val": {
                    "score": -5.409240012077335,
                    "pretrain_loss": 0.8900645971298218,
                    "features_accuracy": [
                        0.30955278873443604,
                        0.5012676119804382,
                        0.28901731967926025,
                        0.2952033281326294,
                        0.4242977201938629,
                        0.2798904776573181,
                        0.2912483513355255,
                        0.3096034824848175,
                        0.46369534730911255,
                        0.3122401237487793,
                        0.9932562112808228,
                        0.35397017002105713,
                        0.31011053919792175,
                        0.2960653007030487,
                        0.35828009247779846,
                        0.2858736217021942,
                        0.2666565179824829,
                        0.30909642577171326,
                        0.4008721113204956,
                        0.655258059501648,
                        0.2823750078678131,
                        0.6041983366012573,
                        0.4736841917037964,
                        0.6733596920967102,
                        0.6505424976348877,
                        0.6421255469322205,
                        0.5732176899909973,
                        0.7320758104324341,
                        0.4395598769187927,
                        0.9870702624320984,
                        0.8991481065750122,
                        0.9940674901008606,
                        0.9085285067558289,
                        0.905536949634552,
                        0.9024946689605713,
                        0.9071595072746277,
                        0.9040157794952393,
                        0.5937531590461731,
                        0.9122806787490845,
                        0.5971503853797913,
                        0.8924551010131836,
                        0.9055876731872559,
                        0.3501166105270386,
                        0.9007200002670288,
                        0.9107595086097717,
                        0.9093397855758667,
                        0.29540613293647766,
                        0.3460095226764679,
                        0.31173306703567505,
                        0.9959942698478699,
                        0.43372881412506104
                    ]
                },
                "test": {
                    "score": -5.64212394881537,
                    "pretrain_loss": 0.5174592733383179,
                    "features_accuracy": [
                        0.6282961368560791,
                        0.7735801339149475,
                        0.6210446357727051,
                        0.6370182633399963,
                        0.670537531375885,
                        0.5994929075241089,
                        0.5684584379196167,
                        0.6442697644233704,
                        0.6840770840644836,
                        0.6176470518112183,
                        0.9947261810302734,
                        0.5389959216117859,
                        0.5576065182685852,
                        0.6556795239448547,
                        0.661054790019989,
                        0.5719574093818665,
                        0.5532454252243042,
                        0.65892493724823,
                        0.603296160697937,
                        0.6201825737953186,
                        0.6226673722267151,
                        0.6646551489830017,
                        0.7730222940444946,
                        0.6399087309837341,
                        0.5613590478897095,
                        0.6570993661880493,
                        0.6413286328315735,
                        0.6094827651977539,
                        0.6162778735160828,
                        0.9886916875839233,
                        0.9183570146560669,
                        0.995537519454956,
                        0.5818965435028076,
                        0.9080628752708435,
                        0.904462456703186,
                        0.9150101542472839,
                        0.91217041015625,
                        0.9175963401794434,
                        0.9173935055732727,
                        0.5657200813293457,
                        0.9122717976570129,
                        0.9096856117248535,
                        0.5321500897407532,
                        0.9049695730209351,
                        0.9115111827850342,
                        0.9097869992256165,
                        0.6049695611000061,
                        0.6497971415519714,
                        0.6192697882652283,
                        0.997768759727478,
                        0.5242393612861633
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -4.208915943768217,
                    "pretrain_loss": 0.17030878365039825,
                    "features_accuracy": [
                        0.9452987313270569,
                        0.8139979243278503,
                        0.9398495554924011,
                        0.9410104155540466,
                        0.9235780835151672,
                        0.9401603937149048,
                        0.9385300874710083,
                        0.9384222030639648,
                        0.9115886092185974,
                        0.9425836801528931,
                        0.9948172569274902,
                        0.9405917525291443,
                        0.9352567195892334,
                        0.9412007331848145,
                        0.9316027760505676,
                        0.9425519704818726,
                        0.9357325434684753,
                        0.9381367564201355,
                        0.9415750503540039,
                        0.9252527952194214,
                        0.9439665675163269,
                        0.9113411903381348,
                        0.8616387248039246,
                        0.9131237864494324,
                        0.9177292585372925,
                        0.9205394983291626,
                        0.9173169136047363,
                        0.9019208550453186,
                        0.9115949273109436,
                        0.9888161420822144,
                        0.8899123668670654,
                        0.9951090812683105,
                        0.9139420986175537,
                        0.9114871025085449,
                        0.9068054556846619,
                        0.9144495725631714,
                        0.9131745100021362,
                        0.9191882610321045,
                        0.9171456098556519,
                        0.920025646686554,
                        0.8802700042724609,
                        0.9128509759902954,
                        0.9331823587417603,
                        0.9083850383758545,
                        0.914367139339447,
                        0.9156548976898193,
                        0.9426026940345764,
                        0.9427613019943237,
                        0.9407059550285339,
                        0.9972278475761414,
                        0.9469227194786072
                    ]
                },
                "val": {
                    "score": -5.425427075099359,
                    "pretrain_loss": 0.9392390251159668,
                    "features_accuracy": [
                        0.31203731894493103,
                        0.5013689994812012,
                        0.2660480737686157,
                        0.2878004312515259,
                        0.4243484437465668,
                        0.259557843208313,
                        0.257073312997818,
                        0.302961140871048,
                        0.4641517102718353,
                        0.27603691816329956,
                        0.9932562112808228,
                        0.3822634518146515,
                        0.2734002470970154,
                        0.294442743062973,
                        0.3455531895160675,
                        0.2646283209323883,
                        0.25945642590522766,
                        0.28627926111221313,
                        0.38302403688430786,
                        0.6212351322174072,
                        0.26239731907844543,
                        0.6070377826690674,
                        0.47474899888038635,
                        0.608001172542572,
                        0.6911570429801941,
                        0.5603386759757996,
                        0.4655207395553589,
                        0.7163066267967224,
                        0.45406144857406616,
                        0.9870702624320984,
                        0.9015312790870667,
                        0.9940674901008606,
                        0.9066524505615234,
                        0.9055876731872559,
                        0.9024946689605713,
                        0.9071595072746277,
                        0.9040157794952393,
                        0.5937531590461731,
                        0.9125849008560181,
                        0.5996348857879639,
                        0.8930635452270508,
                        0.9054862260818481,
                        0.3190345764160156,
                        0.900669276714325,
                        0.9107595086097717,
                        0.9093397855758667,
                        0.28739479184150696,
                        0.31097251176834106,
                        0.2793327271938324,
                        0.9959942698478699,
                        0.4218638837337494
                    ]
                },
                "test": {
                    "score": -5.642503711543118,
                    "pretrain_loss": 0.49710723757743835,
                    "features_accuracy": [
                        0.6157200932502747,
                        0.773326575756073,
                        0.6757099628448486,
                        0.6607505083084106,
                        0.6825557947158813,
                        0.6230730414390564,
                        0.5881845951080322,
                        0.657809317111969,
                        0.6939148306846619,
                        0.6588742136955261,
                        0.9947261810302734,
                        0.6245943307876587,
                        0.6615618467330933,
                        0.6533975601196289,
                        0.6604969501495361,
                        0.6132352948188782,
                        0.570486843585968,
                        0.7351927161216736,
                        0.5745435953140259,
                        0.6996957659721375,
                        0.6645537614822388,
                        0.6617646813392639,
                        0.7910750508308411,
                        0.6656693816184998,
                        0.59269779920578,
                        0.7291582226753235,
                        0.6876267790794373,
                        0.5837221145629883,
                        0.5472109317779541,
                        0.9886916875839233,
                        0.9240872263908386,
                        0.995537519454956,
                        0.5824036598205566,
                        0.9080628752708435,
                        0.904462456703186,
                        0.9150101542472839,
                        0.91217041015625,
                        0.9175963401794434,
                        0.9173935055732727,
                        0.5657200813293457,
                        0.9162778854370117,
                        0.9096348881721497,
                        0.602281928062439,
                        0.9049695730209351,
                        0.9115111827850342,
                        0.9097869992256165,
                        0.6192190647125244,
                        0.6565415859222412,
                        0.6300709843635559,
                        0.997768759727478,
                        0.5383874177932739
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -4.440199464867331,
                    "pretrain_loss": 0.15289188921451569,
                    "features_accuracy": [
                        0.9520357251167297,
                        0.8168779015541077,
                        0.9478362202644348,
                        0.9538499712944031,
                        0.9305941462516785,
                        0.9484198093414307,
                        0.947049617767334,
                        0.9513822793960571,
                        0.9201271533966064,
                        0.9495680332183838,
                        0.9951725006103516,
                        0.9527335166931152,
                        0.9450767040252686,
                        0.9531077742576599,
                        0.9439855813980103,
                        0.9503926634788513,
                        0.944981575012207,
                        0.9510461091995239,
                        0.9492064118385315,
                        0.9317423701286316,
                        0.9512046575546265,
                        0.9261282086372375,
                        0.8684390783309937,
                        0.9339372515678406,
                        0.9199114441871643,
                        0.927301824092865,
                        0.936043381690979,
                        0.9296680092811584,
                        0.934178352355957,
                        0.989266574382782,
                        0.8904515504837036,
                        0.9950392842292786,
                        0.9150585532188416,
                        0.9102437496185303,
                        0.9087910652160645,
                        0.9138278961181641,
                        0.9138215780258179,
                        0.9188013076782227,
                        0.91629558801651,
                        0.9197211265563965,
                        0.8808472752571106,
                        0.913301408290863,
                        0.947379469871521,
                        0.9080805778503418,
                        0.9145891666412354,
                        0.9148175120353699,
                        0.9510841369628906,
                        0.9501643180847168,
                        0.9508938193321228,
                        0.9973737597465515,
                        0.9474872946739197
                    ]
                },
                "val": {
                    "score": -5.44694603373481,
                    "pretrain_loss": 1.024181604385376,
                    "features_accuracy": [
                        0.31771624088287354,
                        0.5016225576400757,
                        0.2560592293739319,
                        0.2819186747074127,
                        0.42875975370407104,
                        0.2572254240512848,
                        0.252864807844162,
                        0.2902849614620209,
                        0.46759963035583496,
                        0.2755805552005768,
                        0.9932055473327637,
                        0.327907919883728,
                        0.2666565179824829,
                        0.29616671800613403,
                        0.33236992359161377,
                        0.2622959017753601,
                        0.25697189569473267,
                        0.27182841300964355,
                        0.39164385199546814,
                        0.6047053933143616,
                        0.25656625628471375,
                        0.5472061634063721,
                        0.4988337755203247,
                        0.552885115146637,
                        0.7008416652679443,
                        0.5422877669334412,
                        0.43119359016418457,
                        0.641871988773346,
                        0.46572354435920715,
                        0.9870702624320984,
                        0.8990974426269531,
                        0.9940168261528015,
                        0.9061453938484192,
                        0.9055876731872559,
                        0.9024946689605713,
                        0.9071595072746277,
                        0.9040157794952393,
                        0.593803882598877,
                        0.9124327898025513,
                        0.5982151627540588,
                        0.8916945457458496,
                        0.9052833914756775,
                        0.2910962402820587,
                        0.9006185531616211,
                        0.9107595086097717,
                        0.9093397855758667,
                        0.2883581817150116,
                        0.3136598765850067,
                        0.2758340835571289,
                        0.9959942698478699,
                        0.4243484437465668
                    ]
                },
                "test": {
                    "score": -5.664552891815141,
                    "pretrain_loss": 0.4858912229537964,
                    "features_accuracy": [
                        0.637221097946167,
                        0.7709939479827881,
                        0.7490364909172058,
                        0.6276876330375671,
                        0.6744421720504761,
                        0.651673436164856,
                        0.622261643409729,
                        0.6407200694084167,
                        0.7156693935394287,
                        0.6758620738983154,
                        0.9947261810302734,
                        0.6808316707611084,
                        0.7253549695014954,
                        0.6588742136955261,
                        0.6693204641342163,
                        0.6429513096809387,
                        0.5651623010635376,
                        0.7856490612030029,
                        0.5532961487770081,
                        0.7312880158424377,
                        0.6660750508308411,
                        0.6702839732170105,
                        0.8029412031173706,
                        0.7052738666534424,
                        0.6213995814323425,
                        0.7712981700897217,
                        0.7213488817214966,
                        0.5578600168228149,
                        0.5460953116416931,
                        0.9886916875839233,
                        0.9242900609970093,
                        0.995537519454956,
                        0.5830121636390686,
                        0.9080628752708435,
                        0.904462456703186,
                        0.9150101542472839,
                        0.91217041015625,
                        0.9175963401794434,
                        0.9173935055732727,
                        0.5657200813293457,
                        0.9161764979362488,
                        0.9093813300132751,
                        0.7170892357826233,
                        0.9049695730209351,
                        0.9115111827850342,
                        0.9098377227783203,
                        0.6242900490760803,
                        0.6871196627616882,
                        0.6298174262046814,
                        0.997768759727478,
                        0.525557816028595
                    ]
                }
            }
        },
        "train": {
            "score": -4.461976826832278
        },
        "val": {
            "score": -5.4079801155927845
        },
        "test": {
            "score": -5.6299988279509545
        }
    },
    "best_iteration": 10000,
    "time": "0:13:24"
}
