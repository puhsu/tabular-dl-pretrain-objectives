{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/tune.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 0,
        "program": "bin/pretrain_mask.py",
        "base_config": {
            "seed": 0,
            "data": {
                "T_cache": true,
                "path": "data/adult_roc",
                "T": {
                    "normalization": "quantile"
                }
            },
            "model": {
                "kind": "mlp"
            },
            "training": {
                "batch_size": 256,
                "patience": 16
            },
            "pretrain": {
                "corrupt_strategy": "resample",
                "patience": 2,
                "d_hidden_head": 512,
                "replace_strategy": "target_shuffle",
                "use_target": true
            }
        },
        "space": {
            "model": {
                "config": {
                    "d_layers": [
                        "$fixed_mlp_d_layers",
                        1,
                        8,
                        512
                    ],
                    "dropout": [
                        "?uniform",
                        0.0,
                        0.0,
                        0.5
                    ]
                }
            },
            "pretrain": {
                "corrupt_probability": [
                    "uniform",
                    0.2,
                    0.8
                ]
            },
            "training": {
                "lr": [
                    "loguniform",
                    5e-05,
                    0.005
                ],
                "weight_decay": [
                    "?loguniform",
                    0.0,
                    1e-06,
                    0.001
                ]
            }
        },
        "n_trials": 100,
        "timeout": null,
        "sampler": {
            "seed": 0
        }
    },
    "best": {
        "program": "bin/pretrain_mask.py",
        "environment": {
            "CUDA_VISIBLE_DEVICES": "0",
            "gpus": {
                "driver": "450.119.04",
                "devices": [
                    {
                        "name": "A100-SXM-80GB",
                        "memory_total": 85199093760,
                        "memory_free": 85195948032,
                        "memory_used": 3145728,
                        "utilization": 0
                    }
                ]
            },
            "torch.version.cuda": "11.1",
            "torch.backends.cudnn.version()": 8005,
            "torch.cuda.nccl.version()": [
                2,
                10,
                3
            ]
        },
        "config": {
            "seed": 0,
            "data": {
                "path": "data/adult_roc",
                "T": {
                    "seed": 0,
                    "normalization": "quantile",
                    "num_nan_policy": null,
                    "cat_nan_policy": null,
                    "cat_min_frequency": null,
                    "cat_encoding": null,
                    "y_policy": "default"
                },
                "T_cache": true
            },
            "model": {
                "kind": "mlp",
                "config": {
                    "d_layers": [
                        512,
                        512,
                        512,
                        512,
                        512,
                        512,
                        512
                    ],
                    "dropout": 0.0
                },
                "default": true,
                "checkpoint": null,
                "num_embedding_arch": [],
                "d_num_embedding": null,
                "positional_encoding": null,
                "d_cat_embedding": null
            },
            "training": {
                "batch_size": 256,
                "lr": 0.00048019984326925727,
                "weight_decay": 6.540798078756423e-06,
                "optimizer": "AdamW",
                "patience": 16,
                "n_epochs": Infinity,
                "eval_batch_size": 8192
            },
            "pretrain": {
                "corrupt_probability": 0.7500458150241592,
                "corrupt_strategy": "resample",
                "d_hidden_head": 512,
                "lr": 0.00048019984326925727,
                "weight_decay": 6.540798078756423e-06,
                "patience": 2,
                "n_iterations": 100000,
                "finetune_every": 10000,
                "replace_strategy": "target_shuffle",
                "n_neighbors": 20,
                "use_target": true,
                "target_injection_type": "post"
            },
            "bins": null
        },
        "epoch_size": 102,
        "n_parameters": 1902094,
        "metrics": {
            "iteration_scores": {
                "10000": {
                    "train": {
                        "score": 0.9316674697794796,
                        "pretrain_loss": 0.4636381268501282,
                        "features_accuracy": [
                            0.7720746397972107,
                            0.7511516809463501,
                            0.7124155163764954,
                            0.9312806725502014,
                            0.956810474395752,
                            0.6768273711204529,
                            0.7652027010917664,
                            0.7052364945411682,
                            0.7206695079803467,
                            0.7160626649856567,
                            0.7278102040290833,
                            0.8605650663375854,
                            0.7256219387054443,
                            0.9049447178840637
                        ]
                    },
                    "val": {
                        "score": 0.9142983533150367,
                        "pretrain_loss": 0.46609237790107727,
                        "features_accuracy": [
                            0.7781360149383545,
                            0.7460463643074036,
                            0.6961461901664734,
                            0.9345923662185669,
                            0.9531705975532532,
                            0.695992648601532,
                            0.7637033462524414,
                            0.7053585052490234,
                            0.717027485370636,
                            0.7065868377685547,
                            0.7234761118888855,
                            0.8645785450935364,
                            0.717795193195343,
                            0.9018885493278503
                        ]
                    },
                    "test": {
                        "score": 0.9106722194098862,
                        "pretrain_loss": 0.4638115167617798,
                        "features_accuracy": [
                            0.7764265537261963,
                            0.7501996755599976,
                            0.7109514474868774,
                            0.9332351088523865,
                            0.9568822979927063,
                            0.6724402904510498,
                            0.7610098123550415,
                            0.712916910648346,
                            0.7142682075500488,
                            0.7103986740112305,
                            0.7284564971923828,
                            0.8625391721725464,
                            0.7208402752876282,
                            0.9081752300262451
                        ]
                    }
                },
                "20000": {
                    "train": {
                        "score": 0.9332641144809604,
                        "pretrain_loss": 0.45728805661201477,
                        "features_accuracy": [
                            0.7800982594490051,
                            0.7523801922798157,
                            0.7230113744735718,
                            0.9319717288017273,
                            0.956810474395752,
                            0.6847358345985413,
                            0.7645500302314758,
                            0.7221283912658691,
                            0.7200552821159363,
                            0.7238175272941589,
                            0.729038655757904,
                            0.8644041419029236,
                            0.7319179773330688,
                            0.9060580134391785
                        ]
                    },
                    "val": {
                        "score": 0.915532335279916,
                        "pretrain_loss": 0.46142104268074036,
                        "features_accuracy": [
                            0.781360387802124,
                            0.7460463643074036,
                            0.7058191299438477,
                            0.937202513217926,
                            0.9522493481636047,
                            0.6962997317314148,
                            0.7647781372070312,
                            0.7147244215011597,
                            0.7173345685005188,
                            0.7142637968063354,
                            0.7237831950187683,
                            0.8667280673980713,
                            0.7202517986297607,
                            0.903577446937561
                        ]
                    },
                    "test": {
                        "score": 0.9117533064812742,
                        "pretrain_loss": 0.45881277322769165,
                        "features_accuracy": [
                            0.7779006361961365,
                            0.7501996755599976,
                            0.7217001914978027,
                            0.9349548816680908,
                            0.9574965238571167,
                            0.6813463568687439,
                            0.7620539665222168,
                            0.7207788825035095,
                            0.7174621224403381,
                            0.7242184281349182,
                            0.7295621037483215,
                            0.8645046949386597,
                            0.7247098088264465,
                            0.9106320738792419
                        ]
                    }
                },
                "30000": {
                    "train": {
                        "score": 0.9328849162515571,
                        "pretrain_loss": 0.4558362364768982,
                        "features_accuracy": [
                            0.7763743996620178,
                            0.7514588236808777,
                            0.7236639857292175,
                            0.9345439076423645,
                            0.9591907262802124,
                            0.6900721788406372,
                            0.7673525810241699,
                            0.7217060923576355,
                            0.7208998799324036,
                            0.7259290218353271,
                            0.729038655757904,
                            0.8627533912658691,
                            0.7292306423187256,
                            0.9089373350143433
                        ]
                    },
                    "val": {
                        "score": 0.9166337364065948,
                        "pretrain_loss": 0.45937052369117737,
                        "features_accuracy": [
                            0.780592679977417,
                            0.7460463643074036,
                            0.7076616287231445,
                            0.9395056366920471,
                            0.9540918469429016,
                            0.6969138979911804,
                            0.7653923034667969,
                            0.7165668606758118,
                            0.7165668606758118,
                            0.7165668606758118,
                            0.7254721522331238,
                            0.8665745258331299,
                            0.7250115275382996,
                            0.903577446937561
                        ]
                    },
                    "test": {
                        "score": 0.9129335466945017,
                        "pretrain_loss": 0.4564926326274872,
                        "features_accuracy": [
                            0.7775321006774902,
                            0.7501996755599976,
                            0.7245869636535645,
                            0.935876190662384,
                            0.9584178328514099,
                            0.6884098052978516,
                            0.762422502040863,
                            0.7220072746276855,
                            0.7128555178642273,
                            0.7245869636535645,
                            0.7286407947540283,
                            0.8643203973770142,
                            0.7240341901779175,
                            0.9105092287063599
                        ]
                    }
                },
                "40000": {
                    "train": {
                        "score": 0.9332784435452,
                        "pretrain_loss": 0.454149454832077,
                        "features_accuracy": [
                            0.7824400663375854,
                            0.7526489496231079,
                            0.7217444777488708,
                            0.9330850839614868,
                            0.9597665667533875,
                            0.6886901259422302,
                            0.7641277313232422,
                            0.7189035415649414,
                            0.7210150361061096,
                            0.7245469689369202,
                            0.7329161167144775,
                            0.8625614047050476,
                            0.7344517707824707,
                            0.9074400663375854
                        ]
                    },
                    "val": {
                        "score": 0.9160254508780257,
                        "pretrain_loss": 0.45851564407348633,
                        "features_accuracy": [
                            0.7789037227630615,
                            0.7460463643074036,
                            0.705204963684082,
                            0.9387379288673401,
                            0.954552412033081,
                            0.6990634202957153,
                            0.7653923034667969,
                            0.7085828185081482,
                            0.7219407558441162,
                            0.7187164425849915,
                            0.7237831950187683,
                            0.8682634830474854,
                            0.7250115275382996,
                            0.9048057794570923
                        ]
                    },
                    "test": {
                        "score": 0.9128860297154145,
                        "pretrain_loss": 0.4559677541255951,
                        "features_accuracy": [
                            0.7777163982391357,
                            0.7501996755599976,
                            0.7191205024719238,
                            0.9361218810081482,
                            0.9577422142028809,
                            0.6884098052978516,
                            0.7627910375595093,
                            0.720041811466217,
                            0.719366192817688,
                            0.7252011895179749,
                            0.7328174114227295,
                            0.8643203973770142,
                            0.72477126121521,
                            0.9105706214904785
                        ]
                    }
                },
                "50000": {
                    "train": {
                        "score": 0.9333545911349646,
                        "pretrain_loss": 0.45496007800102234,
                        "features_accuracy": [
                            0.7784090638160706,
                            0.7458153963088989,
                            0.7218212485313416,
                            0.9329314827919006,
                            0.9591907262802124,
                            0.6956772208213806,
                            0.767467737197876,
                            0.7227042317390442,
                            0.7258138656616211,
                            0.7261210083961487,
                            0.7311117649078369,
                            0.8620239496231079,
                            0.7358338236808777,
                            0.9085150361061096
                        ]
                    },
                    "val": {
                        "score": 0.9180767782340439,
                        "pretrain_loss": 0.45794859528541565,
                        "features_accuracy": [
                            0.7787501811981201,
                            0.7460463643074036,
                            0.7136496305465698,
                            0.9391985535621643,
                            0.9554736614227295,
                            0.699677586555481,
                            0.7658529281616211,
                            0.7194840908050537,
                            0.7204053401947021,
                            0.7211730480194092,
                            0.7240902781486511,
                            0.8642714619636536,
                            0.7227084040641785,
                            0.9041916131973267
                        ]
                    },
                    "test": {
                        "score": 0.9138478486465554,
                        "pretrain_loss": 0.45563873648643494,
                        "features_accuracy": [
                            0.7774707078933716,
                            0.7501996755599976,
                            0.7256925702095032,
                            0.9353848695755005,
                            0.9584178328514099,
                            0.6890854835510254,
                            0.7648793458938599,
                            0.7272281050682068,
                            0.7174006700515747,
                            0.7250783443450928,
                            0.7286407947540283,
                            0.8641975522041321,
                            0.726552426815033,
                            0.9110620021820068
                        ]
                    }
                },
                "60000": {
                    "train": {
                        "score": 0.9335468021297301,
                        "pretrain_loss": 0.4528284966945648,
                        "features_accuracy": [
                            0.7775644659996033,
                            0.7484643459320068,
                            0.7202855944633484,
                            0.9335457682609558,
                            0.9599584937095642,
                            0.6944870948791504,
                            0.7645884156227112,
                            0.7270423769950867,
                            0.7192490696907043,
                            0.727541446685791,
                            0.7308046817779541,
                            0.8668611645698547,
                            0.736332893371582,
                            0.908553421497345
                        ]
                    },
                    "val": {
                        "score": 0.9190818390045603,
                        "pretrain_loss": 0.45752573013305664,
                        "features_accuracy": [
                            0.7799785137176514,
                            0.7460463643074036,
                            0.7072010040283203,
                            0.9387379288673401,
                            0.9553201198577881,
                            0.7030554413795471,
                            0.767234742641449,
                            0.7171810269355774,
                            0.71856290102005,
                            0.7147244215011597,
                            0.7262398600578308,
                            0.8682634830474854,
                            0.7227084040641785,
                            0.9015814661979675
                        ]
                    },
                    "test": {
                        "score": 0.9147638233635499,
                        "pretrain_loss": 0.4553465247154236,
                        "features_accuracy": [
                            0.7781463265419006,
                            0.7501996755599976,
                            0.7246484160423279,
                            0.9362447261810303,
                            0.9594005942344666,
                            0.684171736240387,
                            0.7640808820724487,
                            0.7223758101463318,
                            0.7183834314346313,
                            0.7237884998321533,
                            0.7305448651313782,
                            0.8640133142471313,
                            0.7274123430252075,
                            0.911307692527771
                        ]
                    }
                },
                "70000": {
                    "train": {
                        "score": 0.934034707774757,
                        "pretrain_loss": 0.4514152705669403,
                        "features_accuracy": [
                            0.7755681872367859,
                            0.7476197481155396,
                            0.7272726893424988,
                            0.9356188178062439,
                            0.9600353240966797,
                            0.6964066028594971,
                            0.7713835835456848,
                            0.725238025188446,
                            0.7234336733818054,
                            0.7310733795166016,
                            0.736217737197876,
                            0.8637515306472778,
                            0.738521158695221,
                            0.9084766507148743
                        ]
                    },
                    "val": {
                        "score": 0.9192501444460495,
                        "pretrain_loss": 0.45690613985061646,
                        "features_accuracy": [
                            0.7793643474578857,
                            0.7460463643074036,
                            0.709657609462738,
                            0.9402732849121094,
                            0.9553201198577881,
                            0.6986027956008911,
                            0.7664670944213867,
                            0.7208659648895264,
                            0.7220942974090576,
                            0.7190234661102295,
                            0.7265468835830688,
                            0.8661139011383057,
                            0.725165069103241,
                            0.9029632806777954
                        ]
                    },
                    "test": {
                        "score": 0.9154043773331151,
                        "pretrain_loss": 0.4542713761329651,
                        "features_accuracy": [
                            0.7772864699363708,
                            0.7501996755599976,
                            0.7249554991722107,
                            0.9369204044342041,
                            0.959769070148468,
                            0.6874271035194397,
                            0.7633438110351562,
                            0.7278423309326172,
                            0.7191818952560425,
                            0.7270438075065613,
                            0.7321417927742004,
                            0.8648117780685425,
                            0.726552426815033,
                            0.9106320738792419
                        ]
                    }
                },
                "80000": {
                    "train": {
                        "score": 0.9329974004135073,
                        "pretrain_loss": 0.45152363181114197,
                        "features_accuracy": [
                            0.7754145860671997,
                            0.7520346641540527,
                            0.7277718186378479,
                            0.9350813627243042,
                            0.9606495499610901,
                            0.6937576532363892,
                            0.7695792317390442,
                            0.726620078086853,
                            0.7332616448402405,
                            0.7259674072265625,
                            0.7378685474395752,
                            0.8640970587730408,
                            0.7333000302314758,
                            0.9082462787628174
                        ]
                    },
                    "val": {
                        "score": 0.9191330399702853,
                        "pretrain_loss": 0.45556965470314026,
                        "features_accuracy": [
                            0.7801320552825928,
                            0.7460463643074036,
                            0.7121142148971558,
                            0.9396591782569885,
                            0.9559342861175537,
                            0.700752317905426,
                            0.7652387619018555,
                            0.7205588817596436,
                            0.7236296534538269,
                            0.7210195064544678,
                            0.7297712564468384,
                            0.8678028583526611,
                            0.7262398600578308,
                            0.9040380716323853
                        ]
                    },
                    "test": {
                        "score": 0.9155932324948809,
                        "pretrain_loss": 0.4541760981082916,
                        "features_accuracy": [
                            0.7776549458503723,
                            0.7501996755599976,
                            0.7242798805236816,
                            0.9364290237426758,
                            0.959769070148468,
                            0.6893925666809082,
                            0.7652478814125061,
                            0.7252625823020935,
                            0.7209016680717468,
                            0.7278423309326172,
                            0.7328788638114929,
                            0.8645046949386597,
                            0.7276580333709717,
                            0.9111848473548889
                        ]
                    }
                },
                "90000": {
                    "train": {
                        "score": 0.939567205830458,
                        "pretrain_loss": 0.45051249861717224,
                        "features_accuracy": [
                            0.7814035415649414,
                            0.7502686977386475,
                            0.7280405163764954,
                            0.936117947101593,
                            0.9599969387054443,
                            0.6974048018455505,
                            0.7676212787628174,
                            0.7243934273719788,
                            0.7276566028594971,
                            0.7337223291397095,
                            0.7350276112556458,
                            0.8605266809463501,
                            0.7345669269561768,
                            0.9087069630622864
                        ]
                    },
                    "val": {
                        "score": 0.9196980561688781,
                        "pretrain_loss": 0.45541173219680786,
                        "features_accuracy": [
                            0.7796714305877686,
                            0.7460463643074036,
                            0.7139567136764526,
                            0.9402732849121094,
                            0.9562413692474365,
                            0.6979886293411255,
                            0.7684630751609802,
                            0.7200982570648193,
                            0.7194840908050537,
                            0.721480131149292,
                            0.7299247980117798,
                            0.8674957752227783,
                            0.7242438197135925,
                            0.9038845300674438
                        ]
                    },
                    "test": {
                        "score": 0.9142496886043516,
                        "pretrain_loss": 0.45366641879081726,
                        "features_accuracy": [
                            0.7785763144493103,
                            0.7501996755599976,
                            0.7271052598953247,
                            0.9377188682556152,
                            0.9597076773643494,
                            0.6888397932052612,
                            0.7665377259254456,
                            0.7261224985122681,
                            0.7201032042503357,
                            0.7273509502410889,
                            0.733554482460022,
                            0.8639518618583679,
                            0.7261839509010315,
                            0.9116148352622986
                        ]
                    }
                },
                "100000": {
                    "train": {
                        "score": 0.9335105300484106,
                        "pretrain_loss": 0.45134738087654114,
                        "features_accuracy": [
                            0.7787162065505981,
                            0.7473894357681274,
                            0.7244318127632141,
                            0.9360027313232422,
                            0.9601120948791504,
                            0.6898418068885803,
                            0.7684274911880493,
                            0.7287699580192566,
                            0.7275030612945557,
                            0.7273879051208496,
                            0.7351428270339966,
                            0.8642506003379822,
                            0.736793577671051,
                            0.9091676473617554
                        ]
                    },
                    "val": {
                        "score": 0.920485287138111,
                        "pretrain_loss": 0.456073522567749,
                        "features_accuracy": [
                            0.77982497215271,
                            0.7460463643074036,
                            0.708889901638031,
                            0.9404268264770508,
                            0.9551665782928467,
                            0.6993705034255981,
                            0.7689236998558044,
                            0.7234761118888855,
                            0.7236296534538269,
                            0.7191770076751709,
                            0.7260863184928894,
                            0.8653462529182434,
                            0.7243973612785339,
                            0.9040380716323853
                        ]
                    },
                    "test": {
                        "score": 0.9157852345456908,
                        "pretrain_loss": 0.4541856348514557,
                        "features_accuracy": [
                            0.7780234813690186,
                            0.7501996755599976,
                            0.7240341901779175,
                            0.9378417134284973,
                            0.959093451499939,
                            0.6869357228279114,
                            0.7647565007209778,
                            0.7243412733078003,
                            0.7196118235588074,
                            0.7263067960739136,
                            0.7306677103042603,
                            0.8637061715126038,
                            0.7258154153823853,
                            0.9106934666633606
                        ]
                    }
                }
            },
            "train": {
                "score": 0.9335105300484106
            },
            "val": {
                "score": 0.920485287138111
            },
            "test": {
                "score": 0.9157852345456908
            }
        },
        "best_iteration": 100000,
        "time": "0:11:08",
        "trial_id": 73,
        "tuning_time": "11:18:53"
    },
    "time": "15:24:49"
}
