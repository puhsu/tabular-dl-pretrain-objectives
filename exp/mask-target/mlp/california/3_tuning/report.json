{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/tune.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 0,
        "program": "bin/pretrain_mask.py",
        "base_config": {
            "seed": 0,
            "data": {
                "T_cache": true,
                "path": "data/california",
                "T": {
                    "normalization": "quantile"
                }
            },
            "model": {
                "kind": "mlp"
            },
            "training": {
                "batch_size": 128,
                "patience": 16
            },
            "pretrain": {
                "corrupt_strategy": "resample",
                "patience": 2,
                "d_hidden_head": 512,
                "replace_strategy": "target_shuffle",
                "use_target": true
            }
        },
        "space": {
            "model": {
                "config": {
                    "d_layers": [
                        "$fixed_mlp_d_layers",
                        1,
                        8,
                        512
                    ],
                    "dropout": [
                        "?uniform",
                        0.0,
                        0.0,
                        0.5
                    ]
                }
            },
            "pretrain": {
                "corrupt_probability": [
                    "uniform",
                    0.2,
                    0.8
                ]
            },
            "training": {
                "lr": [
                    "loguniform",
                    5e-05,
                    0.005
                ],
                "weight_decay": [
                    "?loguniform",
                    0.0,
                    1e-06,
                    0.001
                ]
            }
        },
        "n_trials": 100,
        "timeout": null,
        "sampler": {
            "seed": 0
        }
    },
    "best": {
        "program": "bin/pretrain_mask.py",
        "environment": {
            "CUDA_VISIBLE_DEVICES": "0",
            "gpus": {
                "driver": "450.119.04",
                "devices": [
                    {
                        "name": "A100-SXM-80GB",
                        "memory_total": 85199093760,
                        "memory_free": 85195948032,
                        "memory_used": 3145728,
                        "utilization": 0
                    }
                ]
            },
            "torch.version.cuda": "11.1",
            "torch.backends.cudnn.version()": 8005,
            "torch.cuda.nccl.version()": [
                2,
                10,
                3
            ]
        },
        "config": {
            "seed": 0,
            "data": {
                "path": "data/california",
                "T": {
                    "seed": 0,
                    "normalization": "quantile",
                    "num_nan_policy": null,
                    "cat_nan_policy": null,
                    "cat_min_frequency": null,
                    "cat_encoding": null,
                    "y_policy": "default"
                },
                "T_cache": true
            },
            "model": {
                "kind": "mlp",
                "config": {
                    "d_layers": [
                        512,
                        512,
                        512,
                        512,
                        512,
                        512
                    ],
                    "dropout": 0.0
                },
                "default": true,
                "checkpoint": null,
                "num_embedding_arch": [],
                "d_num_embedding": null,
                "positional_encoding": null,
                "d_cat_embedding": null
            },
            "training": {
                "batch_size": 128,
                "lr": 0.0003122637313525577,
                "weight_decay": 0.0,
                "optimizer": "AdamW",
                "patience": 16,
                "n_epochs": Infinity,
                "eval_batch_size": 8192
            },
            "pretrain": {
                "corrupt_probability": 0.5593935490255608,
                "corrupt_strategy": "resample",
                "d_hidden_head": 512,
                "lr": 0.0003122637313525577,
                "weight_decay": 0.0,
                "patience": 2,
                "n_iterations": 100000,
                "finetune_every": 10000,
                "replace_strategy": "target_shuffle",
                "n_neighbors": 20,
                "use_target": true,
                "target_injection_type": "post"
            },
            "bins": null
        },
        "epoch_size": 104,
        "n_parameters": 1585160,
        "metrics": {
            "iteration_scores": {
                "10000": {
                    "train": {
                        "score": -0.3948588522141973,
                        "pretrain_loss": 0.6228781342506409,
                        "features_accuracy": [
                            0.7100462317466736,
                            0.5456885695457458,
                            0.6297221779823303,
                            0.5690060257911682,
                            0.5550004243850708,
                            0.6129911541938782,
                            0.6997501850128174,
                            0.7144371271133423
                        ]
                    },
                    "val": {
                        "score": -0.4722441634422506,
                        "pretrain_loss": 0.6298708319664001,
                        "features_accuracy": [
                            0.6984559297561646,
                            0.5516197085380554,
                            0.6021798253059387,
                            0.5540418028831482,
                            0.5794731974601746,
                            0.6082349419593811,
                            0.7048137784004211,
                            0.7078413367271423
                        ]
                    },
                    "test": {
                        "score": -0.4668705544311292,
                        "pretrain_loss": 0.6328907012939453,
                        "features_accuracy": [
                            0.6969476938247681,
                            0.5419089198112488,
                            0.6247577667236328,
                            0.5588662624359131,
                            0.5603197813034058,
                            0.5968992114067078,
                            0.693071722984314,
                            0.7107558250427246
                        ]
                    }
                },
                "20000": {
                    "train": {
                        "score": -0.3410934575260597,
                        "pretrain_loss": 0.6097599864006042,
                        "features_accuracy": [
                            0.7073208093643188,
                            0.5751382112503052,
                            0.643954873085022,
                            0.5727912783622742,
                            0.5548489689826965,
                            0.6223030090332031,
                            0.7200393676757812,
                            0.7378302812576294
                        ]
                    },
                    "val": {
                        "score": -0.45591024217201465,
                        "pretrain_loss": 0.6210189461708069,
                        "features_accuracy": [
                            0.7051165699958801,
                            0.5685740113258362,
                            0.6254919767379761,
                            0.5467756390571594,
                            0.5812897086143494,
                            0.6148955225944519,
                            0.7117771506309509,
                            0.7229791283607483
                        ]
                    },
                    "test": {
                        "score": -0.45488833496340103,
                        "pretrain_loss": 0.6228036880493164,
                        "features_accuracy": [
                            0.7022771239280701,
                            0.5530523061752319,
                            0.6257267594337463,
                            0.5595930218696594,
                            0.5615310072898865,
                            0.5981104373931885,
                            0.7124515771865845,
                            0.7228682041168213
                        ]
                    }
                },
                "30000": {
                    "train": {
                        "score": -0.3286541254238001,
                        "pretrain_loss": 0.6002476811408997,
                        "features_accuracy": [
                            0.7231433391571045,
                            0.5925505757331848,
                            0.6469831466674805,
                            0.5771822333335876,
                            0.5728669762611389,
                            0.6295707821846008,
                            0.7241275310516357,
                            0.7490347623825073
                        ]
                    },
                    "val": {
                        "score": -0.4463009098728626,
                        "pretrain_loss": 0.6200940012931824,
                        "features_accuracy": [
                            0.7036027908325195,
                            0.585225522518158,
                            0.6194368600845337,
                            0.551014244556427,
                            0.578262209892273,
                            0.6251892447471619,
                            0.7196487784385681,
                            0.7326672673225403
                        ]
                    },
                    "test": {
                        "score": -0.44781605852476786,
                        "pretrain_loss": 0.6184875965118408,
                        "features_accuracy": [
                            0.7066376209259033,
                            0.5622577667236328,
                            0.6216084957122803,
                            0.5545058250427246,
                            0.5637112259864807,
                            0.5995639562606812,
                            0.7158430218696594,
                            0.7398256063461304
                        ]
                    }
                },
                "40000": {
                    "train": {
                        "score": -0.32345967573174794,
                        "pretrain_loss": 0.5915600657463074,
                        "features_accuracy": [
                            0.7221591472625732,
                            0.5961087346076965,
                            0.6590961217880249,
                            0.5886138677597046,
                            0.5658263564109802,
                            0.6366114020347595,
                            0.7392687201499939,
                            0.7542585134506226
                        ]
                    },
                    "val": {
                        "score": -0.44333204793235886,
                        "pretrain_loss": 0.617996871471405,
                        "features_accuracy": [
                            0.7023917436599731,
                            0.5843172669410706,
                            0.6194368600845337,
                            0.5513169765472412,
                            0.5640326738357544,
                            0.6115652322769165,
                            0.7254011631011963,
                            0.7244929075241089
                        ]
                    },
                    "test": {
                        "score": -0.4441379622447783,
                        "pretrain_loss": 0.6159775257110596,
                        "features_accuracy": [
                            0.7042151093482971,
                            0.5743701457977295,
                            0.6344476938247681,
                            0.5588662624359131,
                            0.5690407156944275,
                            0.5961724519729614,
                            0.7248061895370483,
                            0.7393410801887512
                        ]
                    }
                },
                "50000": {
                    "train": {
                        "score": -0.32844314713261014,
                        "pretrain_loss": 0.5870373249053955,
                        "features_accuracy": [
                            0.7239760756492615,
                            0.6056476831436157,
                            0.6583390235900879,
                            0.5846771597862244,
                            0.5797562599182129,
                            0.6357786655426025,
                            0.753652811050415,
                            0.757892370223999
                        ]
                    },
                    "val": {
                        "score": -0.4464963639613468,
                        "pretrain_loss": 0.6193026304244995,
                        "features_accuracy": [
                            0.7102633714675903,
                            0.5691795349121094,
                            0.6212534308433533,
                            0.5525280237197876,
                            0.5673630237579346,
                            0.6133817434310913,
                            0.7305479645729065,
                            0.7220708131790161
                        ]
                    },
                    "test": {
                        "score": -0.43521817699977405,
                        "pretrain_loss": 0.6167067289352417,
                        "features_accuracy": [
                            0.6925871968269348,
                            0.5838178396224976,
                            0.6279069781303406,
                            0.5615310072898865,
                            0.5673449635505676,
                            0.5981104373931885,
                            0.7202034592628479,
                            0.742732584476471
                        ]
                    }
                },
                "60000": {
                    "train": {
                        "score": -0.3187218637418956,
                        "pretrain_loss": 0.5840061902999878,
                        "features_accuracy": [
                            0.7307896614074707,
                            0.6102657318115234,
                            0.6677265763282776,
                            0.5937618613243103,
                            0.5776364803314209,
                            0.6335831880569458,
                            0.7502460479736328,
                            0.7697781920433044
                        ]
                    },
                    "val": {
                        "score": -0.43992061083971595,
                        "pretrain_loss": 0.6188140511512756,
                        "features_accuracy": [
                            0.7045110464096069,
                            0.5785649418830872,
                            0.6342718601226807,
                            0.5452618598937988,
                            0.570390522480011,
                            0.6194368600845337,
                            0.7296397089958191,
                            0.7363003492355347
                        ]
                    },
                    "test": {
                        "score": -0.43465498790045604,
                        "pretrain_loss": 0.6137499213218689,
                        "features_accuracy": [
                            0.7066376209259033,
                            0.5794573426246643,
                            0.6484980583190918,
                            0.5661337375640869,
                            0.5564438104629517,
                            0.6002907156944275,
                            0.7257751822471619,
                            0.7463662624359131
                        ]
                    }
                },
                "70000": {
                    "train": {
                        "score": -0.3154960334943894,
                        "pretrain_loss": 0.5975072383880615,
                        "features_accuracy": [
                            0.716102659702301,
                            0.5847528576850891,
                            0.6525853872299194,
                            0.5855098962783813,
                            0.5805132985115051,
                            0.6277538537979126,
                            0.7463093400001526,
                            0.7450980544090271
                        ]
                    },
                    "val": {
                        "score": -0.43817229674503727,
                        "pretrain_loss": 0.6206532716751099,
                        "features_accuracy": [
                            0.7029972672462463,
                            0.5800787210464478,
                            0.6303360462188721,
                            0.5437480807304382,
                            0.5712988376617432,
                            0.6182258725166321,
                            0.7244929075241089,
                            0.7332727909088135
                        ]
                    },
                    "test": {
                        "score": -0.43749992772902885,
                        "pretrain_loss": 0.6139621138572693,
                        "features_accuracy": [
                            0.7054263353347778,
                            0.5767926573753357,
                            0.648740291595459,
                            0.5692829489707947,
                            0.5591084957122803,
                            0.6048933863639832,
                            0.7284399271011353,
                            0.7376453280448914
                        ]
                    }
                },
                "80000": {
                    "train": {
                        "score": -0.2860831977463999,
                        "pretrain_loss": 0.5930922031402588,
                        "features_accuracy": [
                            0.7197365760803223,
                            0.5948217511177063,
                            0.6522825360298157,
                            0.5765008926391602,
                            0.5834658145904541,
                            0.6220758557319641,
                            0.7500946521759033,
                            0.754712700843811
                        ]
                    },
                    "val": {
                        "score": -0.43824336074138737,
                        "pretrain_loss": 0.619230329990387,
                        "features_accuracy": [
                            0.7045110464096069,
                            0.58280348777771,
                            0.6282167434692383,
                            0.5452618598937988,
                            0.5773538947105408,
                            0.6257947087287903,
                            0.7353920936584473,
                            0.7214653491973877
                        ]
                    },
                    "test": {
                        "score": -0.4334646951566643,
                        "pretrain_loss": 0.6139440536499023,
                        "features_accuracy": [
                            0.7039728760719299,
                            0.5952034592628479,
                            0.6429263353347778,
                            0.5467538833618164,
                            0.5724321603775024,
                            0.6039243936538696,
                            0.7250484228134155,
                            0.7473352551460266
                        ]
                    }
                },
                "90000": {
                    "train": {
                        "score": -0.27955881364612406,
                        "pretrain_loss": 0.5887997150421143,
                        "features_accuracy": [
                            0.7175410985946655,
                            0.6048149466514587,
                            0.6547051668167114,
                            0.5875539779663086,
                            0.5873268246650696,
                            0.6322962045669556,
                            0.7454009056091309,
                            0.7659928798675537
                        ]
                    },
                    "val": {
                        "score": -0.4294143766847434,
                        "pretrain_loss": 0.6221730709075928,
                        "features_accuracy": [
                            0.7054193019866943,
                            0.6000605225563049,
                            0.6248864531517029,
                            0.5525280237197876,
                            0.5640326738357544,
                            0.6191341280937195,
                            0.7260066866874695,
                            0.7326672673225403
                        ]
                    },
                    "test": {
                        "score": -0.4293786647962893,
                        "pretrain_loss": 0.6111459732055664,
                        "features_accuracy": [
                            0.711482584476471,
                            0.5874515771865845,
                            0.6482558250427246,
                            0.5610464811325073,
                            0.5627422332763672,
                            0.612160861492157,
                            0.7250484228134155,
                            0.7451550364494324
                        ]
                    }
                },
                "100000": {
                    "train": {
                        "score": -0.3076650192667502,
                        "pretrain_loss": 0.5834907293319702,
                        "features_accuracy": [
                            0.7233704328536987,
                            0.6080702543258667,
                            0.6627299785614014,
                            0.5920963287353516,
                            0.5942161083221436,
                            0.6258611679077148,
                            0.7505488991737366,
                            0.7683398127555847
                        ]
                    },
                    "val": {
                        "score": -0.4287920786435574,
                        "pretrain_loss": 0.6196835041046143,
                        "features_accuracy": [
                            0.7102633714675903,
                            0.5840145349502563,
                            0.6194368600845337,
                            0.5498031973838806,
                            0.5649409890174866,
                            0.6215561628341675,
                            0.7305479645729065,
                            0.7390251159667969
                        ]
                    },
                    "test": {
                        "score": -0.42298782020204756,
                        "pretrain_loss": 0.6092691421508789,
                        "features_accuracy": [
                            0.7054263353347778,
                            0.5840600728988647,
                            0.6555232405662537,
                            0.5663759708404541,
                            0.5629844665527344,
                            0.6138566136360168,
                            0.7349806427955627,
                            0.7451550364494324
                        ]
                    }
                }
            },
            "train": {
                "score": -0.3076650192667502
            },
            "val": {
                "score": -0.4287920786435574
            },
            "test": {
                "score": -0.42298782020204756
            }
        },
        "best_iteration": 100000,
        "time": "0:09:35",
        "trial_id": 31,
        "tuning_time": "5:10:59"
    },
    "time": "16:12:54"
}
