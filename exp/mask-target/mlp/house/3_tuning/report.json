{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/tune.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 0,
        "program": "bin/pretrain_mask.py",
        "base_config": {
            "seed": 0,
            "data": {
                "T_cache": true,
                "path": "data/house",
                "T": {
                    "normalization": "quantile"
                }
            },
            "model": {
                "kind": "mlp"
            },
            "training": {
                "batch_size": 128,
                "patience": 16
            },
            "pretrain": {
                "corrupt_strategy": "resample",
                "patience": 2,
                "d_hidden_head": 512,
                "replace_strategy": "target_shuffle",
                "use_target": true
            }
        },
        "space": {
            "model": {
                "config": {
                    "d_layers": [
                        "$fixed_mlp_d_layers",
                        1,
                        8,
                        512
                    ],
                    "dropout": [
                        "?uniform",
                        0.0,
                        0.0,
                        0.5
                    ]
                }
            },
            "pretrain": {
                "corrupt_probability": [
                    "uniform",
                    0.2,
                    0.8
                ]
            },
            "training": {
                "lr": [
                    "loguniform",
                    5e-05,
                    0.005
                ],
                "weight_decay": [
                    "?loguniform",
                    0.0,
                    1e-06,
                    0.001
                ]
            }
        },
        "n_trials": 100,
        "timeout": null,
        "sampler": {
            "seed": 0
        }
    },
    "best": {
        "program": "bin/pretrain_mask.py",
        "environment": {
            "CUDA_VISIBLE_DEVICES": "0",
            "gpus": {
                "driver": "450.119.04",
                "devices": [
                    {
                        "name": "A100-SXM-80GB",
                        "memory_total": 85199093760,
                        "memory_free": 85195948032,
                        "memory_used": 3145728,
                        "utilization": 0
                    }
                ]
            },
            "torch.version.cuda": "11.1",
            "torch.backends.cudnn.version()": 8005,
            "torch.cuda.nccl.version()": [
                2,
                10,
                3
            ]
        },
        "config": {
            "seed": 0,
            "data": {
                "path": "data/house",
                "T": {
                    "seed": 0,
                    "normalization": "quantile",
                    "num_nan_policy": null,
                    "cat_nan_policy": null,
                    "cat_min_frequency": null,
                    "cat_encoding": null,
                    "y_policy": "default"
                },
                "T_cache": true
            },
            "model": {
                "kind": "mlp",
                "config": {
                    "d_layers": [
                        512,
                        512,
                        512,
                        512,
                        512,
                        512
                    ],
                    "dropout": 0.10958970965011997
                },
                "default": true,
                "checkpoint": null,
                "num_embedding_arch": [],
                "d_num_embedding": null,
                "positional_encoding": null,
                "d_cat_embedding": null
            },
            "training": {
                "batch_size": 128,
                "lr": 0.00015422679223377558,
                "weight_decay": 0.0,
                "optimizer": "AdamW",
                "patience": 16,
                "n_epochs": Infinity,
                "eval_batch_size": 8192
            },
            "pretrain": {
                "corrupt_probability": 0.2768732487206981,
                "corrupt_strategy": "resample",
                "d_hidden_head": 512,
                "lr": 0.00015422679223377558,
                "weight_decay": 0.0,
                "patience": 2,
                "n_iterations": 100000,
                "finetune_every": 10000,
                "replace_strategy": "target_shuffle",
                "n_neighbors": 20,
                "use_target": true,
                "target_injection_type": "post"
            },
            "bins": null
        },
        "epoch_size": 114,
        "n_parameters": 1593360,
        "metrics": {
            "iteration_scores": {
                "10000": {
                    "train": {
                        "score": -17335.988328566502,
                        "pretrain_loss": 0.4514251947402954,
                        "features_accuracy": [
                            0.8155133724212646,
                            0.7278650403022766,
                            0.8297784924507141,
                            0.8076949715614319,
                            0.8218229413032532,
                            0.8447980880737305,
                            0.8453467488288879,
                            0.8464440703392029,
                            0.7441191077232361,
                            0.7869145274162292,
                            0.7679172158241272,
                            0.8368425369262695,
                            0.7600988149642944,
                            0.7982991933822632,
                            0.7194980382919312,
                            0.7745010852813721
                        ]
                    },
                    "val": {
                        "score": -28072.90986130933,
                        "pretrain_loss": 0.48668667674064636,
                        "features_accuracy": [
                            0.8014262318611145,
                            0.7221612930297852,
                            0.7805814743041992,
                            0.7915524244308472,
                            0.798134982585907,
                            0.8129457235336304,
                            0.8217224478721619,
                            0.8274822235107422,
                            0.7273724675178528,
                            0.7764673829078674,
                            0.7825013995170593,
                            0.7978606820106506,
                            0.7635765671730042,
                            0.7874383330345154,
                            0.7043335437774658,
                            0.770159125328064
                        ]
                    },
                    "test": {
                        "score": -30983.597066728773,
                        "pretrain_loss": 0.4970410168170929,
                        "features_accuracy": [
                            0.7845073938369751,
                            0.7316216826438904,
                            0.7952600717544556,
                            0.7816545963287354,
                            0.7875795364379883,
                            0.8237875699996948,
                            0.8242264986038208,
                            0.8268597722053528,
                            0.7452271580696106,
                            0.7634408473968506,
                            0.7632214426994324,
                            0.7994294762611389,
                            0.7559798359870911,
                            0.7820935249328613,
                            0.7283300757408142,
                            0.7544437050819397
                        ]
                    }
                },
                "20000": {
                    "train": {
                        "score": -18849.01291822011,
                        "pretrain_loss": 0.4370235502719879,
                        "features_accuracy": [
                            0.8260750770568848,
                            0.7643508911132812,
                            0.8295041918754578,
                            0.809546709060669,
                            0.8209313750267029,
                            0.8512448072433472,
                            0.8539881110191345,
                            0.8480900526046753,
                            0.7406899929046631,
                            0.7944585680961609,
                            0.7847884893417358,
                            0.8379397988319397,
                            0.7736781239509583,
                            0.8083807826042175,
                            0.7505658268928528,
                            0.7775872945785522
                        ]
                    },
                    "val": {
                        "score": -28309.344565919993,
                        "pretrain_loss": 0.4745349884033203,
                        "features_accuracy": [
                            0.8102030158042908,
                            0.7419089674949646,
                            0.7910038828849792,
                            0.7907295823097229,
                            0.8069117069244385,
                            0.8176083564758301,
                            0.8225452899932861,
                            0.828579306602478,
                            0.7273724675178528,
                            0.7808557748794556,
                            0.787164032459259,
                            0.8069117069244385,
                            0.7676906585693359,
                            0.7953922748565674,
                            0.7353264093399048,
                            0.7789358496665955
                        ]
                    },
                    "test": {
                        "score": -31102.494333780418,
                        "pretrain_loss": 0.480985552072525,
                        "features_accuracy": [
                            0.7880184650421143,
                            0.759052038192749,
                            0.8009655475616455,
                            0.7831907272338867,
                            0.796357274055481,
                            0.8262014389038086,
                            0.8325653076171875,
                            0.8279569745063782,
                            0.7452271580696106,
                            0.774632453918457,
                            0.7717797160148621,
                            0.8077682852745056,
                            0.7698047161102295,
                            0.7858240008354187,
                            0.7551020383834839,
                            0.7608075737953186
                        ]
                    }
                },
                "30000": {
                    "train": {
                        "score": -11170.479697394121,
                        "pretrain_loss": 0.42931532859802246,
                        "features_accuracy": [
                            0.8269666433334351,
                            0.7622934579849243,
                            0.8371854424476624,
                            0.8076949715614319,
                            0.8287497758865356,
                            0.8518620729446411,
                            0.8589260578155518,
                            0.850627601146698,
                            0.7366436123847961,
                            0.795212984085083,
                            0.7847884893417358,
                            0.847061276435852,
                            0.7731294631958008,
                            0.809066653251648,
                            0.7657225728034973,
                            0.776695728302002
                        ]
                    },
                    "val": {
                        "score": -28128.252985905452,
                        "pretrain_loss": 0.46959471702575684,
                        "features_accuracy": [
                            0.8165112733840942,
                            0.7501371502876282,
                            0.7931980490684509,
                            0.7942951321601868,
                            0.8088316321372986,
                            0.8252879977226257,
                            0.834064781665802,
                            0.828579306602478,
                            0.7273724675178528,
                            0.7882611155509949,
                            0.7918267250061035,
                            0.8091059327125549,
                            0.7698848247528076,
                            0.7962150573730469,
                            0.7432803511619568,
                            0.7808557748794556
                        ]
                    },
                    "test": {
                        "score": -30824.53470283709,
                        "pretrain_loss": 0.47455033659935,
                        "features_accuracy": [
                            0.8009655475616455,
                            0.7656353116035461,
                            0.7987711429595947,
                            0.7908712029457092,
                            0.8011850118637085,
                            0.8268597722053528,
                            0.8367347121238708,
                            0.8299319744110107,
                            0.7452271580696106,
                            0.7755101919174194,
                            0.7741935849189758,
                            0.8040377497673035,
                            0.7733157873153687,
                            0.7915295362472534,
                            0.7594909071922302,
                            0.7625631093978882
                        ]
                    }
                },
                "40000": {
                    "train": {
                        "score": -13353.529230252292,
                        "pretrain_loss": 0.418865829706192,
                        "features_accuracy": [
                            0.8354708552360535,
                            0.7643508911132812,
                            0.8432206511497498,
                            0.8188053369522095,
                            0.8337563276290894,
                            0.8670873641967773,
                            0.864824116230011,
                            0.8587889075279236,
                            0.7380152344703674,
                            0.7980934381484985,
                            0.7862287163734436,
                            0.8479528427124023,
                            0.7867773771286011,
                            0.8151704668998718,
                            0.7640765905380249,
                            0.7784788608551025
                        ]
                    },
                    "val": {
                        "score": -27950.357535080508,
                        "pretrain_loss": 0.4651051163673401,
                        "features_accuracy": [
                            0.8195282816886902,
                            0.7487658262252808,
                            0.7953922748565674,
                            0.7997806072235107,
                            0.8091059327125549,
                            0.8233681321144104,
                            0.8379045724868774,
                            0.829127848148346,
                            0.7273724675178528,
                            0.7868897914886475,
                            0.7959408164024353,
                            0.8132200241088867,
                            0.7761931419372559,
                            0.7967635989189148,
                            0.7471201419830322,
                            0.7778387665748596
                        ]
                    },
                    "test": {
                        "score": -30452.908316881378,
                        "pretrain_loss": 0.47037631273269653,
                        "features_accuracy": [
                            0.8014044761657715,
                            0.7671713829040527,
                            0.8038183450698853,
                            0.7928462028503418,
                            0.8018433451652527,
                            0.8325653076171875,
                            0.8382707834243774,
                            0.8310291767120361,
                            0.7452271580696106,
                            0.7730963230133057,
                            0.7737546563148499,
                            0.8141320943832397,
                            0.777485191822052,
                            0.7917490005493164,
                            0.7625631093978882,
                            0.7636603116989136
                        ]
                    }
                },
                "50000": {
                    "train": {
                        "score": -13460.55831991142,
                        "pretrain_loss": 0.4128115475177765,
                        "features_accuracy": [
                            0.8416432738304138,
                            0.7727179527282715,
                            0.8463754653930664,
                            0.8209999799728394,
                            0.8346478939056396,
                            0.8601605296134949,
                            0.8692134022712708,
                            0.8605720400810242,
                            0.7372608780860901,
                            0.811398446559906,
                            0.793361246585846,
                            0.8620808124542236,
                            0.7898635864257812,
                            0.821205735206604,
                            0.7700432538986206,
                            0.788834810256958
                        ]
                    },
                    "val": {
                        "score": -27846.919881873248,
                        "pretrain_loss": 0.4642643332481384,
                        "features_accuracy": [
                            0.8198025822639465,
                            0.7482172846794128,
                            0.795666515827179,
                            0.7989578247070312,
                            0.8123971819877625,
                            0.8244652152061462,
                            0.8409215807914734,
                            0.8302249312400818,
                            0.7273724675178528,
                            0.7915524244308472,
                            0.7984092235565186,
                            0.815139889717102,
                            0.7734503746032715,
                            0.795117974281311,
                            0.7539770007133484,
                            0.7822271585464478
                        ]
                    },
                    "test": {
                        "score": -30853.76471558323,
                        "pretrain_loss": 0.46946480870246887,
                        "features_accuracy": [
                            0.8055738806724548,
                            0.7700241804122925,
                            0.8055738806724548,
                            0.7937239408493042,
                            0.8020627498626709,
                            0.8299319744110107,
                            0.8409041166305542,
                            0.8297125697135925,
                            0.7452271580696106,
                            0.7783629894256592,
                            0.7790213227272034,
                            0.8174237608909607,
                            0.7717797160148621,
                            0.7888962030410767,
                            0.7645381093025208,
                            0.7687075138092041
                        ]
                    }
                },
                "60000": {
                    "train": {
                        "score": -14880.624091592419,
                        "pretrain_loss": 0.41262924671173096,
                        "features_accuracy": [
                            0.8385570645332336,
                            0.7735409736633301,
                            0.8469241261482239,
                            0.8213428854942322,
                            0.8373225927352905,
                            0.8642754554748535,
                            0.8686647415161133,
                            0.864824116230011,
                            0.7397984266281128,
                            0.8074206709861755,
                            0.7906179428100586,
                            0.8546053767204285,
                            0.7916467189788818,
                            0.8176394104957581,
                            0.7707290649414062,
                            0.7832796573638916
                        ]
                    },
                    "val": {
                        "score": -27665.31273007628,
                        "pretrain_loss": 0.46321961283683777,
                        "features_accuracy": [
                            0.8219967484474182,
                            0.7490400671958923,
                            0.7915524244308472,
                            0.7989578247070312,
                            0.8159627318382263,
                            0.8137685656547546,
                            0.8433900475502014,
                            0.8280307650566101,
                            0.7273724675178528,
                            0.7942951321601868,
                            0.7967635989189148,
                            0.8225452899932861,
                            0.7709819078445435,
                            0.798134982585907,
                            0.7545255422592163,
                            0.7885354161262512
                        ]
                    },
                    "test": {
                        "score": -30503.18157367661,
                        "pretrain_loss": 0.46771612763404846,
                        "features_accuracy": [
                            0.8055738806724548,
                            0.7757296562194824,
                            0.8108404874801636,
                            0.7956989407539368,
                            0.8031600117683411,
                            0.824665367603302,
                            0.8415624499320984,
                            0.82773756980896,
                            0.7452271580696106,
                            0.7829712629318237,
                            0.7770463228225708,
                            0.8204959630966187,
                            0.7834101319313049,
                            0.7919684052467346,
                            0.761685311794281,
                            0.7717797160148621
                        ]
                    }
                },
                "70000": {
                    "train": {
                        "score": -12632.91971291298,
                        "pretrain_loss": 0.41109660267829895,
                        "features_accuracy": [
                            0.8477470874786377,
                            0.7683286666870117,
                            0.8430835008621216,
                            0.8159934282302856,
                            0.8347164392471313,
                            0.8623551726341248,
                            0.8751800656318665,
                            0.8604348301887512,
                            0.740415632724762,
                            0.8111240863800049,
                            0.7919896245002747,
                            0.8535080552101135,
                            0.79178386926651,
                            0.8247033953666687,
                            0.7731980085372925,
                            0.7898635864257812
                        ]
                    },
                    "val": {
                        "score": -27129.46825265222,
                        "pretrain_loss": 0.45928269624710083,
                        "features_accuracy": [
                            0.8250137567520142,
                            0.7479429841041565,
                            0.795666515827179,
                            0.7942951321601868,
                            0.8156884908676147,
                            0.8217224478721619,
                            0.8409215807914734,
                            0.8299506902694702,
                            0.7273724675178528,
                            0.7973121404647827,
                            0.7962150573730469,
                            0.8241909146308899,
                            0.7764673829078674,
                            0.8014262318611145,
                            0.7509599924087524,
                            0.7838727831840515
                        ]
                    },
                    "test": {
                        "score": -30591.53570580515,
                        "pretrain_loss": 0.4622463285923004,
                        "features_accuracy": [
                            0.8055738806724548,
                            0.7733157873153687,
                            0.8154487609863281,
                            0.7941628694534302,
                            0.8084266185760498,
                            0.8299319744110107,
                            0.8450735211372375,
                            0.8323458433151245,
                            0.7452271580696106,
                            0.7893351316452026,
                            0.7772657871246338,
                            0.8266403675079346,
                            0.78055739402771,
                            0.79306560754776,
                            0.7601492404937744,
                            0.7684880495071411
                        ]
                    }
                },
                "80000": {
                    "train": {
                        "score": -12794.0231478526,
                        "pretrain_loss": 0.3962564766407013,
                        "features_accuracy": [
                            0.8496674299240112,
                            0.7795076370239258,
                            0.8511762022972107,
                            0.824634850025177,
                            0.8471984267234802,
                            0.8728482723236084,
                            0.8782662749290466,
                            0.8664700984954834,
                            0.7408271431922913,
                            0.8229888677597046,
                            0.8035114407539368,
                            0.862766683101654,
                            0.8070777654647827,
                            0.8295727968215942,
                            0.7842398285865784,
                            0.7936356067657471
                        ]
                    },
                    "val": {
                        "score": -27874.76202021176,
                        "pretrain_loss": 0.45819854736328125,
                        "features_accuracy": [
                            0.8241909146308899,
                            0.7495886087417603,
                            0.8033461570739746,
                            0.7997806072235107,
                            0.8184311985969543,
                            0.8198025822639465,
                            0.8455842137336731,
                            0.8302249312400818,
                            0.7273724675178528,
                            0.8038946986198425,
                            0.795117974281311,
                            0.82611083984375,
                            0.7720790505409241,
                            0.8022490739822388,
                            0.7523313760757446,
                            0.7904553413391113
                        ]
                    },
                    "test": {
                        "score": -30789.20310571829,
                        "pretrain_loss": 0.458403617143631,
                        "features_accuracy": [
                            0.8093043565750122,
                            0.7759491205215454,
                            0.8128154873847961,
                            0.7972350120544434,
                            0.8097432851791382,
                            0.8332236409187317,
                            0.8496817946434021,
                            0.82773756980896,
                            0.7452271580696106,
                            0.7924072742462158,
                            0.7796796560287476,
                            0.8266403675079346,
                            0.7801185250282288,
                            0.79306560754776,
                            0.7669519782066345,
                            0.7711213827133179
                        ]
                    }
                },
                "90000": {
                    "train": {
                        "score": -14257.69234458327,
                        "pretrain_loss": 0.3973090350627899,
                        "features_accuracy": [
                            0.8512448072433472,
                            0.7815650701522827,
                            0.8482272028923035,
                            0.8273781538009644,
                            0.8440436720848083,
                            0.8728482723236084,
                            0.8792264461517334,
                            0.8717509508132935,
                            0.7386325001716614,
                            0.8194226026535034,
                            0.7988478541374207,
                            0.8648927211761475,
                            0.7998765707015991,
                            0.8268294930458069,
                            0.7850627899169922,
                            0.7940471172332764
                        ]
                    },
                    "val": {
                        "score": -27836.634345642236,
                        "pretrain_loss": 0.4567495882511139,
                        "features_accuracy": [
                            0.8239166736602783,
                            0.7487658262252808,
                            0.8008776903152466,
                            0.7997806072235107,
                            0.8208996653556824,
                            0.8225452899932861,
                            0.8439385890960693,
                            0.8332419395446777,
                            0.7273724675178528,
                            0.8055403828620911,
                            0.7953922748565674,
                            0.834064781665802,
                            0.7737246751785278,
                            0.7995063662528992,
                            0.7531541585922241,
                            0.7888097167015076
                        ]
                    },
                    "test": {
                        "score": -30300.824246749446,
                        "pretrain_loss": 0.45943623781204224,
                        "features_accuracy": [
                            0.808865487575531,
                            0.774412989616394,
                            0.8114988207817078,
                            0.7967961430549622,
                            0.8139126896858215,
                            0.8314681053161621,
                            0.8461707234382629,
                            0.8338819742202759,
                            0.7452271580696106,
                            0.793504536151886,
                            0.7768268585205078,
                            0.8292736411094666,
                            0.7853851318359375,
                            0.7952600717544556,
                            0.764757513999939,
                            0.7702435851097107
                        ]
                    }
                },
                "100000": {
                    "train": {
                        "score": -14672.003736305687,
                        "pretrain_loss": 0.39638662338256836,
                        "features_accuracy": [
                            0.8491187691688538,
                            0.7753241062164307,
                            0.8536452054977417,
                            0.8209313750267029,
                            0.8451409935951233,
                            0.868253231048584,
                            0.8815582394599915,
                            0.8696934580802917,
                            0.7397984266281128,
                            0.8262808322906494,
                            0.809546709060669,
                            0.8657156825065613,
                            0.8002880811691284,
                            0.8325904011726379,
                            0.7880803942680359,
                            0.8033056855201721
                        ]
                    },
                    "val": {
                        "score": -27814.78186437862,
                        "pretrain_loss": 0.4553096294403076,
                        "features_accuracy": [
                            0.8233681321144104,
                            0.7517828345298767,
                            0.8047175407409668,
                            0.8019748330116272,
                            0.8217224478721619,
                            0.8233681321144104,
                            0.8505211472511292,
                            0.8324191570281982,
                            0.7273724675178528,
                            0.7997806072235107,
                            0.7931980490684509,
                            0.8390016555786133,
                            0.7709819078445435,
                            0.8019748330116272,
                            0.7528799176216125,
                            0.7890839576721191
                        ]
                    },
                    "test": {
                        "score": -30441.949405850075,
                        "pretrain_loss": 0.4566521644592285,
                        "features_accuracy": [
                            0.8108404874801636,
                            0.7779240608215332,
                            0.8161070942878723,
                            0.8009655475616455,
                            0.8174237608909607,
                            0.8323458433151245,
                            0.8452929854393005,
                            0.8332236409187317,
                            0.7452271580696106,
                            0.7976739406585693,
                            0.780776858329773,
                            0.8327847123146057,
                            0.7840684652328491,
                            0.7941628694534302,
                            0.7651964426040649,
                            0.7680491805076599
                        ]
                    }
                }
            },
            "train": {
                "score": -12632.91971291298
            },
            "val": {
                "score": -27129.46825265222
            },
            "test": {
                "score": -30591.53570580515
            }
        },
        "best_iteration": 70000,
        "time": "0:11:50",
        "trial_id": 51,
        "tuning_time": "7:37:12"
    },
    "time": "14:27:09",
    "continuations": [
        10,
        25,
        27
    ]
}
