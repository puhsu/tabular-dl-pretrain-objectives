{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/tune.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 0,
        "program": "bin/pretrain_mask.py",
        "base_config": {
            "seed": 0,
            "data": {
                "T_cache": true,
                "path": "data/churn_roc",
                "T": {
                    "normalization": "quantile"
                }
            },
            "model": {
                "kind": "mlp"
            },
            "training": {
                "batch_size": 128,
                "patience": 16
            },
            "pretrain": {
                "corrupt_strategy": "resample",
                "patience": 2,
                "d_hidden_head": 512,
                "replace_strategy": "target_shuffle",
                "use_target": true
            }
        },
        "space": {
            "model": {
                "config": {
                    "d_layers": [
                        "$fixed_mlp_d_layers",
                        1,
                        8,
                        512
                    ],
                    "dropout": [
                        "?uniform",
                        0.0,
                        0.0,
                        0.5
                    ]
                }
            },
            "pretrain": {
                "corrupt_probability": [
                    "uniform",
                    0.2,
                    0.8
                ]
            },
            "training": {
                "lr": [
                    "loguniform",
                    5e-05,
                    0.005
                ],
                "weight_decay": [
                    "?loguniform",
                    0.0,
                    1e-06,
                    0.001
                ]
            }
        },
        "n_trials": 100,
        "timeout": null,
        "sampler": {
            "seed": 0
        }
    },
    "best": {
        "program": "bin/pretrain_mask.py",
        "environment": {
            "CUDA_VISIBLE_DEVICES": "0",
            "gpus": {
                "driver": "450.119.04",
                "devices": [
                    {
                        "name": "A100-SXM-80GB",
                        "memory_total": 85199093760,
                        "memory_free": 85195948032,
                        "memory_used": 3145728,
                        "utilization": 0
                    }
                ]
            },
            "torch.version.cuda": "11.1",
            "torch.backends.cudnn.version()": 8005,
            "torch.cuda.nccl.version()": [
                2,
                10,
                3
            ]
        },
        "config": {
            "seed": 0,
            "data": {
                "path": "data/churn_roc",
                "T": {
                    "seed": 0,
                    "normalization": "quantile",
                    "num_nan_policy": null,
                    "cat_nan_policy": null,
                    "cat_min_frequency": null,
                    "cat_encoding": null,
                    "y_policy": "default"
                },
                "T_cache": true
            },
            "model": {
                "kind": "mlp",
                "config": {
                    "d_layers": [
                        512,
                        512,
                        512,
                        512,
                        512
                    ],
                    "dropout": 0.0
                },
                "default": true,
                "checkpoint": null,
                "num_embedding_arch": [],
                "d_num_embedding": null,
                "positional_encoding": null,
                "d_cat_embedding": null
            },
            "training": {
                "batch_size": 128,
                "lr": 0.0004477058349064607,
                "weight_decay": 0.0,
                "optimizer": "AdamW",
                "patience": 16,
                "n_epochs": Infinity,
                "eval_batch_size": 8192
            },
            "pretrain": {
                "corrupt_probability": 0.468064498066369,
                "corrupt_strategy": "resample",
                "d_hidden_head": 512,
                "lr": 0.0004477058349064607,
                "weight_decay": 0.0,
                "patience": 2,
                "n_iterations": 100000,
                "finetune_every": 10000,
                "replace_strategy": "target_shuffle",
                "n_neighbors": 20,
                "use_target": true,
                "target_injection_type": "post"
            },
            "bins": null
        },
        "epoch_size": 50,
        "n_parameters": 1326603,
        "metrics": {
            "iteration_scores": {
                "10000": {
                    "train": {
                        "score": 0.8925277313615394,
                        "pretrain_loss": 0.5590450167655945,
                        "features_accuracy": [
                            0.5332812666893005,
                            0.7606250047683716,
                            0.7021874785423279,
                            0.5645312666893005,
                            0.6260937452316284,
                            0.7895312309265137,
                            0.7564062476158142,
                            0.8128125071525574,
                            0.760937511920929,
                            0.7353124618530273,
                            0.715624988079071
                        ]
                    },
                    "val": {
                        "score": 0.8650860532981479,
                        "pretrain_loss": 0.5626345276832581,
                        "features_accuracy": [
                            0.5193749666213989,
                            0.7487499713897705,
                            0.7006250023841858,
                            0.5849999785423279,
                            0.6081249713897705,
                            0.7924999594688416,
                            0.7450000047683716,
                            0.7999999523162842,
                            0.746874988079071,
                            0.7387499809265137,
                            0.73499995470047
                        ]
                    },
                    "test": {
                        "score": 0.8572948911931964,
                        "pretrain_loss": 0.5585389733314514,
                        "features_accuracy": [
                            0.5385000109672546,
                            0.7620000243186951,
                            0.6805000305175781,
                            0.5790000557899475,
                            0.6300000548362732,
                            0.7715000510215759,
                            0.7465000152587891,
                            0.8200000524520874,
                            0.7605000138282776,
                            0.7415000200271606,
                            0.7285000085830688
                        ]
                    }
                },
                "20000": {
                    "train": {
                        "score": 0.8903864813976556,
                        "pretrain_loss": 0.556252121925354,
                        "features_accuracy": [
                            0.5293750166893005,
                            0.7562499642372131,
                            0.7135937213897705,
                            0.565625011920929,
                            0.6271874904632568,
                            0.7964062094688416,
                            0.7503125071525574,
                            0.8021875023841858,
                            0.7554687261581421,
                            0.7451562285423279,
                            0.7274999618530273
                        ]
                    },
                    "val": {
                        "score": 0.8661996417254962,
                        "pretrain_loss": 0.5613538026809692,
                        "features_accuracy": [
                            0.5193749666213989,
                            0.7487499713897705,
                            0.6974999904632568,
                            0.5849999785423279,
                            0.6106249690055847,
                            0.7906249761581421,
                            0.7462499737739563,
                            0.7999999523162842,
                            0.7456249594688416,
                            0.7400000095367432,
                            0.73499995470047
                        ]
                    },
                    "test": {
                        "score": 0.8573735522888066,
                        "pretrain_loss": 0.5579962730407715,
                        "features_accuracy": [
                            0.5390000343322754,
                            0.7620000243186951,
                            0.690000057220459,
                            0.5790000557899475,
                            0.6425000429153442,
                            0.7785000205039978,
                            0.7460000514984131,
                            0.8200000524520874,
                            0.7615000605583191,
                            0.7420000433921814,
                            0.7285000085830688
                        ]
                    }
                },
                "30000": {
                    "train": {
                        "score": 0.9028803416128132,
                        "pretrain_loss": 0.5509729981422424,
                        "features_accuracy": [
                            0.5303124785423279,
                            0.770312488079071,
                            0.7178124785423279,
                            0.574999988079071,
                            0.6201562285423279,
                            0.7951562404632568,
                            0.7537499666213989,
                            0.8107812404632568,
                            0.764843761920929,
                            0.7462499737739563,
                            0.7298437356948853
                        ]
                    },
                    "val": {
                        "score": 0.8703253363638991,
                        "pretrain_loss": 0.5590420961380005,
                        "features_accuracy": [
                            0.5193749666213989,
                            0.7487499713897705,
                            0.6931250095367432,
                            0.5849999785423279,
                            0.6156249642372131,
                            0.7874999642372131,
                            0.7450000047683716,
                            0.7999999523162842,
                            0.7481249570846558,
                            0.7456249594688416,
                            0.734375
                        ]
                    },
                    "test": {
                        "score": 0.8563093139364324,
                        "pretrain_loss": 0.5563952922821045,
                        "features_accuracy": [
                            0.5390000343322754,
                            0.7620000243186951,
                            0.6920000314712524,
                            0.5790000557899475,
                            0.6345000267028809,
                            0.7750000357627869,
                            0.7470000386238098,
                            0.8200000524520874,
                            0.7625000476837158,
                            0.7440000176429749,
                            0.7270000576972961
                        ]
                    }
                },
                "40000": {
                    "train": {
                        "score": 0.9085817638759137,
                        "pretrain_loss": 0.5537742972373962,
                        "features_accuracy": [
                            0.534375011920929,
                            0.765625,
                            0.7109375,
                            0.5770312547683716,
                            0.6223437190055847,
                            0.793749988079071,
                            0.75,
                            0.8029687404632568,
                            0.7649999856948853,
                            0.7520312070846558,
                            0.715624988079071
                        ]
                    },
                    "val": {
                        "score": 0.8715653321262435,
                        "pretrain_loss": 0.5591852068901062,
                        "features_accuracy": [
                            0.5193749666213989,
                            0.7487499713897705,
                            0.6956250071525574,
                            0.5849999785423279,
                            0.6168749928474426,
                            0.7874999642372131,
                            0.7462499737739563,
                            0.7999999523162842,
                            0.7475000023841858,
                            0.7456249594688416,
                            0.7337499856948853
                        ]
                    },
                    "test": {
                        "score": 0.8559915848051443,
                        "pretrain_loss": 0.5569236278533936,
                        "features_accuracy": [
                            0.5390000343322754,
                            0.7620000243186951,
                            0.6800000071525574,
                            0.5790000557899475,
                            0.6340000033378601,
                            0.7800000309944153,
                            0.7455000281333923,
                            0.8200000524520874,
                            0.7620000243186951,
                            0.7415000200271606,
                            0.7245000600814819
                        ]
                    }
                },
                "50000": {
                    "train": {
                        "score": 0.9056086332598164,
                        "pretrain_loss": 0.5532201528549194,
                        "features_accuracy": [
                            0.5379687547683716,
                            0.77015620470047,
                            0.703125,
                            0.5704687237739563,
                            0.6212499737739563,
                            0.7903124690055847,
                            0.7509374618530273,
                            0.8123437166213989,
                            0.7651562094688416,
                            0.7475000023841858,
                            0.7149999737739563
                        ]
                    },
                    "val": {
                        "score": 0.874565399543489,
                        "pretrain_loss": 0.5580241084098816,
                        "features_accuracy": [
                            0.5193749666213989,
                            0.7487499713897705,
                            0.6968749761581421,
                            0.5849999785423279,
                            0.6162499785423279,
                            0.796875,
                            0.746874988079071,
                            0.7999999523162842,
                            0.7462499737739563,
                            0.7475000023841858,
                            0.7331249713897705
                        ]
                    },
                    "test": {
                        "score": 0.8585550110973839,
                        "pretrain_loss": 0.5571480393409729,
                        "features_accuracy": [
                            0.5390000343322754,
                            0.7620000243186951,
                            0.6820000410079956,
                            0.5790000557899475,
                            0.6300000548362732,
                            0.7730000615119934,
                            0.7465000152587891,
                            0.8200000524520874,
                            0.7630000114440918,
                            0.7445000410079956,
                            0.7260000109672546
                        ]
                    }
                },
                "60000": {
                    "train": {
                        "score": 0.9084037402124607,
                        "pretrain_loss": 0.5566296577453613,
                        "features_accuracy": [
                            0.5404687523841858,
                            0.7642187476158142,
                            0.7032812237739563,
                            0.5846874713897705,
                            0.6182812452316284,
                            0.7873437404632568,
                            0.7498437166213989,
                            0.8040624856948853,
                            0.7628124952316284,
                            0.7517187595367432,
                            0.7199999690055847
                        ]
                    },
                    "val": {
                        "score": 0.8740742167560747,
                        "pretrain_loss": 0.5586342811584473,
                        "features_accuracy": [
                            0.5193749666213989,
                            0.7487499713897705,
                            0.7018749713897705,
                            0.5849999785423279,
                            0.6237499713897705,
                            0.7893750071525574,
                            0.7475000023841858,
                            0.7999999523162842,
                            0.746874988079071,
                            0.7443749904632568,
                            0.7324999570846558
                        ]
                    },
                    "test": {
                        "score": 0.8583884346596211,
                        "pretrain_loss": 0.5572594404220581,
                        "features_accuracy": [
                            0.5390000343322754,
                            0.7620000243186951,
                            0.6860000491142273,
                            0.5790000557899475,
                            0.6470000147819519,
                            0.7770000100135803,
                            0.7470000386238098,
                            0.8200000524520874,
                            0.7620000243186951,
                            0.7430000305175781,
                            0.7255000472068787
                        ]
                    }
                },
                "70000": {
                    "train": {
                        "score": 0.9079596592058249,
                        "pretrain_loss": 0.5516226887702942,
                        "features_accuracy": [
                            0.5287500023841858,
                            0.7660937309265137,
                            0.7106249928474426,
                            0.5846874713897705,
                            0.6299999952316284,
                            0.7839062213897705,
                            0.7556250095367432,
                            0.8078124523162842,
                            0.7706249952316284,
                            0.7470312118530273,
                            0.7260937094688416
                        ]
                    },
                    "val": {
                        "score": 0.8714112355654864,
                        "pretrain_loss": 0.5587459206581116,
                        "features_accuracy": [
                            0.5193749666213989,
                            0.7487499713897705,
                            0.6931250095367432,
                            0.5849999785423279,
                            0.625,
                            0.7893750071525574,
                            0.7487499713897705,
                            0.7999999523162842,
                            0.7481249570846558,
                            0.7443749904632568,
                            0.7331249713897705
                        ]
                    },
                    "test": {
                        "score": 0.8542749220715322,
                        "pretrain_loss": 0.555847704410553,
                        "features_accuracy": [
                            0.5390000343322754,
                            0.7620000243186951,
                            0.6865000128746033,
                            0.5790000557899475,
                            0.6395000219345093,
                            0.7795000076293945,
                            0.7480000257492065,
                            0.8200000524520874,
                            0.7625000476837158,
                            0.7430000305175781,
                            0.7285000085830688
                        ]
                    }
                },
                "80000": {
                    "train": {
                        "score": 0.9135525818397203,
                        "pretrain_loss": 0.5578842759132385,
                        "features_accuracy": [
                            0.53125,
                            0.7495312094688416,
                            0.7109375,
                            0.5746874809265137,
                            0.63671875,
                            0.7879687547683716,
                            0.7440624833106995,
                            0.805468738079071,
                            0.7532812356948853,
                            0.7434374690055847,
                            0.7157812118530273
                        ]
                    },
                    "val": {
                        "score": 0.8753599599348943,
                        "pretrain_loss": 0.559978723526001,
                        "features_accuracy": [
                            0.5199999809265137,
                            0.7487499713897705,
                            0.7006250023841858,
                            0.5849999785423279,
                            0.6212499737739563,
                            0.7893750071525574,
                            0.7425000071525574,
                            0.7999999523162842,
                            0.7487499713897705,
                            0.7412499785423279,
                            0.7287499904632568
                        ]
                    },
                    "test": {
                        "score": 0.853630209562413,
                        "pretrain_loss": 0.5579085350036621,
                        "features_accuracy": [
                            0.5370000004768372,
                            0.7615000605583191,
                            0.6840000152587891,
                            0.5790000557899475,
                            0.6355000138282776,
                            0.7760000228881836,
                            0.7425000071525574,
                            0.8200000524520874,
                            0.7620000243186951,
                            0.7380000352859497,
                            0.7235000133514404
                        ]
                    }
                },
                "90000": {
                    "train": {
                        "score": 0.908556632893837,
                        "pretrain_loss": 0.5544770956039429,
                        "features_accuracy": [
                            0.5303124785423279,
                            0.7603124976158142,
                            0.7114062309265137,
                            0.5685937404632568,
                            0.6314062476158142,
                            0.7907812595367432,
                            0.739062488079071,
                            0.80140620470047,
                            0.77015620470047,
                            0.753125011920929,
                            0.7229687571525574
                        ]
                    },
                    "val": {
                        "score": 0.877902553187391,
                        "pretrain_loss": 0.5576367974281311,
                        "features_accuracy": [
                            0.5193749666213989,
                            0.7487499713897705,
                            0.6962499618530273,
                            0.5849999785423279,
                            0.6243749856948853,
                            0.784375011920929,
                            0.7481249570846558,
                            0.7999999523162842,
                            0.746874988079071,
                            0.7475000023841858,
                            0.7299999594688416
                        ]
                    },
                    "test": {
                        "score": 0.8577175017852984,
                        "pretrain_loss": 0.5574053525924683,
                        "features_accuracy": [
                            0.5385000109672546,
                            0.7610000371932983,
                            0.6845000386238098,
                            0.5790000557899475,
                            0.6295000314712524,
                            0.7795000076293945,
                            0.7460000514984131,
                            0.8205000162124634,
                            0.7620000243186951,
                            0.7460000514984131,
                            0.7255000472068787
                        ]
                    }
                },
                "100000": {
                    "train": {
                        "score": 0.9092246354653235,
                        "pretrain_loss": 0.5528215765953064,
                        "features_accuracy": [
                            0.5379687547683716,
                            0.7612499594688416,
                            0.7067187428474426,
                            0.5765624642372131,
                            0.6192187070846558,
                            0.7887499928474426,
                            0.75,
                            0.8026562333106995,
                            0.7651562094688416,
                            0.75,
                            0.7328124642372131
                        ]
                    },
                    "val": {
                        "score": 0.874796544384625,
                        "pretrain_loss": 0.5564327836036682,
                        "features_accuracy": [
                            0.5199999809265137,
                            0.7487499713897705,
                            0.703125,
                            0.5849999785423279,
                            0.628125011920929,
                            0.7918750047683716,
                            0.75062495470047,
                            0.7999999523162842,
                            0.7456249594688416,
                            0.7475000023841858,
                            0.7331249713897705
                        ]
                    },
                    "test": {
                        "score": 0.857336535302637,
                        "pretrain_loss": 0.5562209486961365,
                        "features_accuracy": [
                            0.5355000495910645,
                            0.7610000371932983,
                            0.6775000095367432,
                            0.5790000557899475,
                            0.6365000009536743,
                            0.7755000591278076,
                            0.7470000386238098,
                            0.8200000524520874,
                            0.7620000243186951,
                            0.7470000386238098,
                            0.7255000472068787
                        ]
                    }
                }
            },
            "train": {
                "score": 0.908556632893837
            },
            "val": {
                "score": 0.877902553187391
            },
            "test": {
                "score": 0.8577175017852984
            }
        },
        "best_iteration": 90000,
        "time": "0:09:17",
        "trial_id": 85,
        "tuning_time": "10:21:52"
    },
    "time": "11:38:51"
}
