{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask___00725c5b1bf1408397954f54f0c4caee.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 6,
        "data": {
            "path": "data/house",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "transformer",
            "config": {
                "n_blocks": 1,
                "attention_dropout": 0.08122098845853928,
                "ffn_dropout": 0.21115911564097165,
                "ffn_d_hidden": 820
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear"
            ],
            "d_num_embedding": 512,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 8.637030095351076e-05,
            "weight_decay": 0.0,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.4259756608873429,
            "corrupt_strategy": "target_resample",
            "d_hidden_head": 512,
            "lr": 8.637030095351076e-05,
            "weight_decay": 0.0,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": true,
            "early_stop_type": "finetune",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "epoch_size": 114,
    "n_parameters": 2593897,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -19547.401394078985,
                    "pretrain_loss": 0.5588818192481995,
                    "features_accuracy": [
                        0.72669917345047,
                        0.657568097114563,
                        0.7646937966346741,
                        0.7063987851142883,
                        0.7302654385566711,
                        0.7415815591812134,
                        0.7904807925224304,
                        0.7307455539703369,
                        0.6173102259635925,
                        0.6788286566734314,
                        0.6655236482620239,
                        0.7807421088218689,
                        0.6893903613090515,
                        0.6548247933387756,
                        0.6616144776344299,
                        0.6856182813644409
                    ]
                },
                "val": {
                    "score": -29237.071962234393,
                    "pretrain_loss": 0.5661212205886841,
                    "features_accuracy": [
                        0.7221612930297852,
                        0.6522216200828552,
                        0.756719708442688,
                        0.7076248526573181,
                        0.7194185853004456,
                        0.7356007099151611,
                        0.795666515827179,
                        0.7196928262710571,
                        0.6204059720039368,
                        0.6804717779159546,
                        0.661821186542511,
                        0.7737246751785278,
                        0.6914427280426025,
                        0.6464619040489197,
                        0.6428963541984558,
                        0.6862314939498901
                    ]
                },
                "test": {
                    "score": -31666.265524796658,
                    "pretrain_loss": 0.5661764144897461,
                    "features_accuracy": [
                        0.7164801359176636,
                        0.6592056155204773,
                        0.7564187049865723,
                        0.7077024579048157,
                        0.7188940048217773,
                        0.7375466227531433,
                        0.7886767983436584,
                        0.7191134691238403,
                        0.6181698441505432,
                        0.6736888289451599,
                        0.6576695442199707,
                        0.7814351916313171,
                        0.6682027578353882,
                        0.6423085331916809,
                        0.6466974020004272,
                        0.6769804954528809
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -18909.170392614702,
                    "pretrain_loss": 0.550178587436676,
                    "features_accuracy": [
                        0.7366436123847961,
                        0.6611343622207642,
                        0.7705919146537781,
                        0.7087305784225464,
                        0.7304025888442993,
                        0.7473424673080444,
                        0.8013167977333069,
                        0.7339003086090088,
                        0.6268431544303894,
                        0.6850010752677917,
                        0.669227123260498,
                        0.789932131767273,
                        0.7054386138916016,
                        0.6494753956794739,
                        0.6747137308120728,
                        0.6870585083961487
                    ]
                },
                "val": {
                    "score": -28533.522800319974,
                    "pretrain_loss": 0.5570834875106812,
                    "features_accuracy": [
                        0.7290181517601013,
                        0.6538673043251038,
                        0.7712562084197998,
                        0.7142074108123779,
                        0.7320351600646973,
                        0.7364234924316406,
                        0.8082830905914307,
                        0.7249040603637695,
                        0.6206802129745483,
                        0.6974767446517944,
                        0.6689522862434387,
                        0.7808557748794556,
                        0.695282518863678,
                        0.6481075286865234,
                        0.6541415452957153,
                        0.6936368942260742
                    ]
                },
                "test": {
                    "score": -31261.654251083884,
                    "pretrain_loss": 0.5562116503715515,
                    "features_accuracy": [
                        0.7259162068367004,
                        0.6589862108230591,
                        0.7689269185066223,
                        0.7134079337120056,
                        0.727232813835144,
                        0.7450076937675476,
                        0.7910906672477722,
                        0.7256967425346375,
                        0.617950439453125,
                        0.6905859112739563,
                        0.6690805554389954,
                        0.7851656675338745,
                        0.6822471022605896,
                        0.6458196043968201,
                        0.6543778777122498,
                        0.6789554357528687
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -19054.040621306398,
                    "pretrain_loss": 0.5395700931549072,
                    "features_accuracy": [
                        0.7337631583213806,
                        0.6641520261764526,
                        0.7765585780143738,
                        0.7080447673797607,
                        0.7299225330352783,
                        0.7492627501487732,
                        0.8028256297111511,
                        0.7376037836074829,
                        0.7163432240486145,
                        0.6954255700111389,
                        0.6719018220901489,
                        0.7951443791389465,
                        0.705987274646759,
                        0.6640148758888245,
                        0.6747822761535645,
                        0.6922022104263306
                    ]
                },
                "val": {
                    "score": -28412.592697699405,
                    "pretrain_loss": 0.545778214931488,
                    "features_accuracy": [
                        0.736149251461029,
                        0.661821186542511,
                        0.770159125328064,
                        0.7120131850242615,
                        0.7356007099151611,
                        0.7364234924316406,
                        0.806088924407959,
                        0.7251783013343811,
                        0.7018650770187378,
                        0.700767993927002,
                        0.6714207530021667,
                        0.7868897914886475,
                        0.6963796019554138,
                        0.6494789123535156,
                        0.6571585536003113,
                        0.695282518863678
                    ]
                },
                "test": {
                    "score": -31143.623180597253,
                    "pretrain_loss": 0.5444576740264893,
                    "features_accuracy": [
                        0.7327188849449158,
                        0.6723721623420715,
                        0.7671713829040527,
                        0.7180162668228149,
                        0.730305016040802,
                        0.7509326338768005,
                        0.7967961430549622,
                        0.7265745401382446,
                        0.7215273380279541,
                        0.6934386491775513,
                        0.6697388887405396,
                        0.7888962030410767,
                        0.6886109113693237,
                        0.651964008808136,
                        0.6624972820281982,
                        0.6831248998641968
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -18263.36786327615,
                    "pretrain_loss": 0.5299755334854126,
                    "features_accuracy": [
                        0.7436389923095703,
                        0.6758109927177429,
                        0.7773815393447876,
                        0.7157259583473206,
                        0.7390440106391907,
                        0.7606474757194519,
                        0.8039915561676025,
                        0.7513202428817749,
                        0.729648232460022,
                        0.7029010653495789,
                        0.6732048988342285,
                        0.7976133823394775,
                        0.7068788409233093,
                        0.6694328784942627,
                        0.6799259781837463,
                        0.7066730856895447
                    ]
                },
                "val": {
                    "score": -28317.793744733703,
                    "pretrain_loss": 0.5421465635299683,
                    "features_accuracy": [
                        0.7432803511619568,
                        0.6662095785140991,
                        0.7739989161491394,
                        0.7177729606628418,
                        0.7369720339775085,
                        0.7419089674949646,
                        0.8154141902923584,
                        0.7314866185188293,
                        0.7073505520820618,
                        0.7046078443527222,
                        0.6725178360939026,
                        0.7830499410629272,
                        0.6972024440765381,
                        0.6494789123535156,
                        0.6549643874168396,
                        0.6985738277435303
                    ]
                },
                "test": {
                    "score": -30249.67427125778,
                    "pretrain_loss": 0.5408332943916321,
                    "features_accuracy": [
                        0.7395216226577759,
                        0.6605222821235657,
                        0.7700241804122925,
                        0.7098968625068665,
                        0.7324994802474976,
                        0.7485187649726868,
                        0.8009655475616455,
                        0.7278911471366882,
                        0.7318411469459534,
                        0.6954136490821838,
                        0.6708360910415649,
                        0.7959184050559998,
                        0.6910247802734375,
                        0.6506473422050476,
                        0.6600834131240845,
                        0.6894887089729309
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": -16965.918134929743,
                    "pretrain_loss": 0.531559407711029,
                    "features_accuracy": [
                        0.7463822960853577,
                        0.6684041023254395,
                        0.7764899730682373,
                        0.7184692621231079,
                        0.7355462908744812,
                        0.7571497559547424,
                        0.805020272731781,
                        0.746313750743866,
                        0.7292367219924927,
                        0.7033811211585999,
                        0.6754680871963501,
                        0.7943900227546692,
                        0.7083190679550171,
                        0.6681298017501831,
                        0.6808175444602966,
                        0.7022152543067932
                    ]
                },
                "val": {
                    "score": -28386.11346204016,
                    "pretrain_loss": 0.5403294563293457,
                    "features_accuracy": [
                        0.7432803511619568,
                        0.666758120059967,
                        0.7731761336326599,
                        0.7218870520591736,
                        0.7323094010353088,
                        0.7468459010124207,
                        0.8134942650794983,
                        0.7306637763977051,
                        0.7084476351737976,
                        0.7103675603866577,
                        0.6769062280654907,
                        0.7808557748794556,
                        0.7018650770187378,
                        0.6527701616287231,
                        0.6612726449966431,
                        0.6982995271682739
                    ]
                },
                "test": {
                    "score": -31227.049189145502,
                    "pretrain_loss": 0.5391093492507935,
                    "features_accuracy": [
                        0.7375466227531433,
                        0.6629361510276794,
                        0.7772657871246338,
                        0.7059469223022461,
                        0.72767174243927,
                        0.7511520981788635,
                        0.7967961430549622,
                        0.7373272180557251,
                        0.7311828136444092,
                        0.7013385891914368,
                        0.6747860312461853,
                        0.7906517386436462,
                        0.6943164467811584,
                        0.6565723419189453,
                        0.6598639488220215,
                        0.6879526376724243
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": -18968.414993972176,
                    "pretrain_loss": 0.5320195555686951,
                    "features_accuracy": [
                        0.7450106739997864,
                        0.6727247834205627,
                        0.7775187492370605,
                        0.7170976400375366,
                        0.7331458926200867,
                        0.7580413222312927,
                        0.8068034052848816,
                        0.7510459423065186,
                        0.7299225330352783,
                        0.6964543461799622,
                        0.6777313351631165,
                        0.7959674000740051,
                        0.7081133127212524,
                        0.6643577814102173,
                        0.6814347505569458,
                        0.6970030069351196
                    ]
                },
                "val": {
                    "score": -28628.14026271642,
                    "pretrain_loss": 0.5389586091041565,
                    "features_accuracy": [
                        0.7410861849784851,
                        0.6703236699104309,
                        0.7783873081207275,
                        0.7243555188179016,
                        0.7402633428573608,
                        0.7449259757995605,
                        0.8184311985969543,
                        0.7328579425811768,
                        0.7065277099609375,
                        0.711190402507782,
                        0.6711465120315552,
                        0.7890839576721191,
                        0.6972024440765381,
                        0.6511245369911194,
                        0.6604498624801636,
                        0.7035107016563416
                    ]
                },
                "test": {
                    "score": -30970.60095662282,
                    "pretrain_loss": 0.5385955572128296,
                    "features_accuracy": [
                        0.7401799559593201,
                        0.6592056155204773,
                        0.7785823941230774,
                        0.712091326713562,
                        0.7294272780418396,
                        0.7511520981788635,
                        0.8020627498626709,
                        0.7346938848495483,
                        0.7300856113433838,
                        0.6938775777816772,
                        0.6741276979446411,
                        0.7913100719451904,
                        0.6910247802734375,
                        0.6504279375076294,
                        0.6629361510276794,
                        0.6890498399734497
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": -23944.655195002844,
                    "pretrain_loss": 0.5328059792518616,
                    "features_accuracy": [
                        0.7369179725646973,
                        0.674233615398407,
                        0.7782045602798462,
                        0.7223098874092102,
                        0.7334202527999878,
                        0.7489198446273804,
                        0.8036486506462097,
                        0.7465195059776306,
                        0.7286194562911987,
                        0.7063301801681519,
                        0.6728619933128357,
                        0.8004252314567566,
                        0.710513710975647,
                        0.6618887782096863,
                        0.6798573732376099,
                        0.6950826644897461
                    ]
                },
                "val": {
                    "score": -28296.023985037275,
                    "pretrain_loss": 0.5376327633857727,
                    "features_accuracy": [
                        0.7479429841041565,
                        0.6659352779388428,
                        0.7797586917877197,
                        0.7251783013343811,
                        0.736149251461029,
                        0.7482172846794128,
                        0.8156884908676147,
                        0.7323094010353088,
                        0.7172243595123291,
                        0.7142074108123779,
                        0.6791003942489624,
                        0.7767416834831238,
                        0.7013165354728699,
                        0.6494789123535156,
                        0.6686780452728271,
                        0.6950082778930664
                    ]
                },
                "test": {
                    "score": -31829.580927820385,
                    "pretrain_loss": 0.5381811857223511,
                    "features_accuracy": [
                        0.7408382892608643,
                        0.6640333533287048,
                        0.7717797160148621,
                        0.7105551958084106,
                        0.7357910871505737,
                        0.7520298361778259,
                        0.7998683452606201,
                        0.7292078137397766,
                        0.7344744205474854,
                        0.6982663869857788,
                        0.6761026978492737,
                        0.7924072742462158,
                        0.6976081132888794,
                        0.6471362709999084,
                        0.664911150932312,
                        0.6870748400688171
                    ]
                }
            },
            "80000": {
                "train": {
                    "score": -16895.831805871272,
                    "pretrain_loss": 0.5247188210487366,
                    "features_accuracy": [
                        0.7458336353302002,
                        0.6796516180038452,
                        0.7879432439804077,
                        0.7264248132705688,
                        0.742884635925293,
                        0.7524175643920898,
                        0.8116042017936707,
                        0.7535834908485413,
                        0.7349290251731873,
                        0.7114052772521973,
                        0.6781428456306458,
                        0.8016597628593445,
                        0.7236815690994263,
                        0.6636719107627869,
                        0.6833550930023193,
                        0.7006378769874573
                    ]
                },
                "val": {
                    "score": -28290.41622838435,
                    "pretrain_loss": 0.5370320677757263,
                    "features_accuracy": [
                        0.7526056170463562,
                        0.667306661605835,
                        0.7803072333335876,
                        0.7218870520591736,
                        0.7465716004371643,
                        0.7457488179206848,
                        0.8189797401428223,
                        0.7410861849784851,
                        0.7142074108123779,
                        0.7177729606628418,
                        0.6736149787902832,
                        0.7849698662757874,
                        0.6985738277435303,
                        0.656335711479187,
                        0.6648381948471069,
                        0.6999451518058777
                    ]
                },
                "test": {
                    "score": -30516.489455193023,
                    "pretrain_loss": 0.535533607006073,
                    "features_accuracy": [
                        0.7467632293701172,
                        0.6666666865348816,
                        0.7763879895210266,
                        0.7162607312202454,
                        0.72767174243927,
                        0.7513715028762817,
                        0.8022822141647339,
                        0.7379855513572693,
                        0.7342550158500671,
                        0.702216386795044,
                        0.6739082932472229,
                        0.793504536151886,
                        0.6980469822883606,
                        0.6543778777122498,
                        0.6631556153297424,
                        0.6881720423698425
                    ]
                }
            },
            "90000": {
                "train": {
                    "score": -17552.428970044355,
                    "pretrain_loss": 0.52559894323349,
                    "features_accuracy": [
                        0.746313750743866,
                        0.6746451258659363,
                        0.786983072757721,
                        0.719703733921051,
                        0.7412386536598206,
                        0.7628421187400818,
                        0.8126329183578491,
                        0.7421302199363708,
                        0.7387011051177979,
                        0.7019408941268921,
                        0.6814347505569458,
                        0.7987792491912842,
                        0.7179892063140869,
                        0.6659351587295532,
                        0.6851382255554199,
                        0.7060558795928955
                    ]
                },
                "val": {
                    "score": -28118.82155803984,
                    "pretrain_loss": 0.5347939729690552,
                    "features_accuracy": [
                        0.7471201419830322,
                        0.6703236699104309,
                        0.7745474576950073,
                        0.7246297597885132,
                        0.7413604259490967,
                        0.7462973594665527,
                        0.8200768232345581,
                        0.7372463345527649,
                        0.7133845686912537,
                        0.7144816517829895,
                        0.6782776117324829,
                        0.7803072333335876,
                        0.7095447182655334,
                        0.6555129289627075,
                        0.6640154123306274,
                        0.7013165354728699
                    ]
                },
                "test": {
                    "score": -30411.864553360643,
                    "pretrain_loss": 0.5347422361373901,
                    "features_accuracy": [
                        0.7443493604660034,
                        0.6690805554389954,
                        0.7801185250282288,
                        0.714944064617157,
                        0.7327188849449158,
                        0.758613109588623,
                        0.8011850118637085,
                        0.7278911471366882,
                        0.7349133491516113,
                        0.701996922492981,
                        0.6734694242477417,
                        0.79306560754776,
                        0.6945359110832214,
                        0.6506473422050476,
                        0.6657888889312744,
                        0.6890498399734497
                    ]
                }
            },
            "100000": {
                "train": {
                    "score": -19056.754481901135,
                    "pretrain_loss": 0.5264086723327637,
                    "features_accuracy": [
                        0.7458336353302002,
                        0.6782799959182739,
                        0.7858172059059143,
                        0.7227899432182312,
                        0.739318311214447,
                        0.7583156824111938,
                        0.8111926913261414,
                        0.7495371103286743,
                        0.7419244647026062,
                        0.7024210095405579,
                        0.6783485412597656,
                        0.8043344616889954,
                        0.7150401473045349,
                        0.6674439907073975,
                        0.684040904045105,
                        0.7050271034240723
                    ]
                },
                "val": {
                    "score": -28374.23652026045,
                    "pretrain_loss": 0.5346606969833374,
                    "features_accuracy": [
                        0.7473944425582886,
                        0.6700494289398193,
                        0.7731761336326599,
                        0.7227098345756531,
                        0.7353264093399048,
                        0.7482172846794128,
                        0.8187054395675659,
                        0.7430060505867004,
                        0.7098190188407898,
                        0.7158530354499817,
                        0.6760833859443665,
                        0.787164032459259,
                        0.7073505520820618,
                        0.6579813957214355,
                        0.6670324206352234,
                        0.70323646068573
                    ]
                },
                "test": {
                    "score": -30998.93223047186,
                    "pretrain_loss": 0.5340844392776489,
                    "features_accuracy": [
                        0.746324360370636,
                        0.6651305556297302,
                        0.777704656124115,
                        0.7184551358222961,
                        0.7311828136444092,
                        0.7581742405891418,
                        0.7978933453559875,
                        0.7342550158500671,
                        0.73337721824646,
                        0.7028747200965881,
                        0.6745666265487671,
                        0.8003072142601013,
                        0.6932192444801331,
                        0.6537195444107056,
                        0.6708360910415649,
                        0.6914637088775635
                    ]
                }
            }
        },
        "train": {
            "score": -17552.428970044355
        },
        "val": {
            "score": -28118.82155803984
        },
        "test": {
            "score": -30411.864553360643
        }
    },
    "best_iteration": 90000,
    "time": "0:15:28"
}
