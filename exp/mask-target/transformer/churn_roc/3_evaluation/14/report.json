{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask___3d3e373ebc0b4ea4b5d6abf1e085ffee.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 14,
        "data": {
            "path": "data/churn_roc",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "transformer",
            "config": {
                "n_blocks": 2,
                "attention_dropout": 0.055295116564219364,
                "ffn_dropout": 0.1378589163932148,
                "ffn_d_hidden": 765
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear"
            ],
            "d_num_embedding": 512,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 5.8954391837547874e-05,
            "weight_decay": 0.0004122102077784336,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.39428126514625794,
            "corrupt_strategy": "target_resample",
            "d_hidden_head": 512,
            "lr": 5.8954391837547874e-05,
            "weight_decay": 0.0004122102077784336,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": true,
            "early_stop_type": "finetune",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "epoch_size": 50,
    "n_parameters": 4734965,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": 0.892554066222997,
                    "pretrain_loss": 0.5333196520805359,
                    "features_accuracy": [
                        0.5967187285423279,
                        0.801562488079071,
                        0.6368749737739563,
                        0.6435937285423279,
                        0.6604687571525574,
                        0.8081249594688416,
                        0.7576562166213989,
                        0.8396874666213989,
                        0.8089062571525574,
                        0.7448437213897705,
                        0.7595312595367432
                    ]
                },
                "val": {
                    "score": 0.8769924203754176,
                    "pretrain_loss": 0.533582866191864,
                    "features_accuracy": [
                        0.6175000071525574,
                        0.8068749904632568,
                        0.6356250047683716,
                        0.6543749570846558,
                        0.671875,
                        0.79749995470047,
                        0.7587499618530273,
                        0.8312499523162842,
                        0.78125,
                        0.7706249952316284,
                        0.76624995470047
                    ]
                },
                "test": {
                    "score": 0.8617230481637262,
                    "pretrain_loss": 0.5331085920333862,
                    "features_accuracy": [
                        0.6000000238418579,
                        0.8110000491142273,
                        0.6270000338554382,
                        0.6490000486373901,
                        0.6770000457763672,
                        0.7985000610351562,
                        0.7620000243186951,
                        0.8385000228881836,
                        0.7845000624656677,
                        0.7745000123977661,
                        0.7585000395774841
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": 0.8985147740077625,
                    "pretrain_loss": 0.5317153334617615,
                    "features_accuracy": [
                        0.6082812547683716,
                        0.8079687356948853,
                        0.6348437070846558,
                        0.6395312547683716,
                        0.6809374690055847,
                        0.7993749976158142,
                        0.7559374570846558,
                        0.8362500071525574,
                        0.7954687476158142,
                        0.7604687213897705,
                        0.768750011920929
                    ]
                },
                "val": {
                    "score": 0.8723743390702197,
                    "pretrain_loss": 0.5327723622322083,
                    "features_accuracy": [
                        0.6175000071525574,
                        0.8068749904632568,
                        0.6399999856948853,
                        0.6543749570846558,
                        0.6800000071525574,
                        0.7956249713897705,
                        0.7556250095367432,
                        0.8312499523162842,
                        0.78187495470047,
                        0.7749999761581421,
                        0.7674999833106995
                    ]
                },
                "test": {
                    "score": 0.8598475208644699,
                    "pretrain_loss": 0.5320876836776733,
                    "features_accuracy": [
                        0.6000000238418579,
                        0.8110000491142273,
                        0.6260000467300415,
                        0.6490000486373901,
                        0.6755000352859497,
                        0.7975000143051147,
                        0.7610000371932983,
                        0.8385000228881836,
                        0.7825000286102295,
                        0.7770000100135803,
                        0.7565000653266907
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": 0.9092554848744595,
                    "pretrain_loss": 0.5279361605644226,
                    "features_accuracy": [
                        0.6121875047683716,
                        0.8075000047683716,
                        0.6460937261581421,
                        0.6434375047683716,
                        0.6759374737739563,
                        0.7982812523841858,
                        0.7645312547683716,
                        0.8343749642372131,
                        0.80140620470047,
                        0.7628124952316284,
                        0.7601562142372131
                    ]
                },
                "val": {
                    "score": 0.8701616087680943,
                    "pretrain_loss": 0.5314373970031738,
                    "features_accuracy": [
                        0.6168749928474426,
                        0.8068749904632568,
                        0.6443749666213989,
                        0.6543749570846558,
                        0.6668750047683716,
                        0.79749995470047,
                        0.7581250071525574,
                        0.8312499523162842,
                        0.7806249856948853,
                        0.7749999761581421,
                        0.768750011920929
                    ]
                },
                "test": {
                    "score": 0.8534497517548364,
                    "pretrain_loss": 0.5304035544395447,
                    "features_accuracy": [
                        0.5995000004768372,
                        0.8110000491142273,
                        0.6300000548362732,
                        0.6485000252723694,
                        0.6735000610351562,
                        0.7990000247955322,
                        0.7625000476837158,
                        0.8385000228881836,
                        0.7815000414848328,
                        0.7795000076293945,
                        0.7575000524520874
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": 0.9052911100730995,
                    "pretrain_loss": 0.5291837453842163,
                    "features_accuracy": [
                        0.6087499856948853,
                        0.8004687428474426,
                        0.6512500047683716,
                        0.6348437070846558,
                        0.672656238079071,
                        0.7989062070846558,
                        0.7565624713897705,
                        0.8384374976158142,
                        0.80531245470047,
                        0.7642187476158142,
                        0.7682812213897705
                    ]
                },
                "val": {
                    "score": 0.8666631352871493,
                    "pretrain_loss": 0.5334152579307556,
                    "features_accuracy": [
                        0.6181249618530273,
                        0.8068749904632568,
                        0.6324999928474426,
                        0.653124988079071,
                        0.671875,
                        0.7981249690055847,
                        0.7562499642372131,
                        0.8312499523162842,
                        0.78187495470047,
                        0.7756249904632568,
                        0.7674999833106995
                    ]
                },
                "test": {
                    "score": 0.8474514576209491,
                    "pretrain_loss": 0.532751739025116,
                    "features_accuracy": [
                        0.5995000004768372,
                        0.8115000128746033,
                        0.6265000104904175,
                        0.6470000147819519,
                        0.6810000538825989,
                        0.8005000352859497,
                        0.7625000476837158,
                        0.8385000228881836,
                        0.7835000157356262,
                        0.7785000205039978,
                        0.7545000314712524
                    ]
                }
            }
        },
        "train": {
            "score": 0.892554066222997
        },
        "val": {
            "score": 0.8769924203754176
        },
        "test": {
            "score": 0.8617230481637262
        }
    },
    "best_iteration": 10000,
    "time": "0:08:22"
}
