{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask___f26f547a1e344fb0b52d2d0829c93526.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 2,
        "data": {
            "path": "data/gesture",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "transformer",
            "config": {
                "n_blocks": 4,
                "attention_dropout": 0.027943681663355716,
                "ffn_dropout": 0.1411191293670853,
                "ffn_d_hidden": 1160
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear"
            ],
            "d_num_embedding": 512,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 8.002617452567277e-05,
            "weight_decay": 1.5453452550966242e-06,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.3481719212546662,
            "corrupt_strategy": "target_resample",
            "d_hidden_head": 512,
            "lr": 8.002617452567277e-05,
            "weight_decay": 1.5453452550966242e-06,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": true,
            "early_stop_type": "finetune",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "epoch_size": 50,
    "n_parameters": 11647041,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": 0.9623298512187402,
                    "pretrain_loss": 0.5795692801475525,
                    "features_accuracy": [
                        0.7310857772827148,
                        0.7951883673667908,
                        0.6929408311843872,
                        0.75577712059021,
                        0.7918645143508911,
                        0.6612852215766907,
                        0.6619183421134949,
                        0.7828426957130432,
                        0.649730920791626,
                        0.7636910676956177,
                        0.8002532720565796,
                        0.6540044546127319,
                        0.6562203168869019,
                        0.6441912055015564,
                        0.6427667140960693,
                        0.6467236280441284,
                        0.649730920791626,
                        0.6498892307281494,
                        0.6495726704597473,
                        0.6451408863067627,
                        0.6452991366386414,
                        0.6522634029388428,
                        0.644032895565033,
                        0.6528964638710022,
                        0.8100664615631104,
                        0.8304843306541443,
                        0.7993035912513733,
                        0.8205128312110901,
                        0.6508388519287109,
                        0.6481481790542603,
                        0.6470401883125305,
                        0.6620765924453735
                    ]
                },
                "val": {
                    "score": 0.6886075949367089,
                    "pretrain_loss": 0.581463634967804,
                    "features_accuracy": [
                        0.7044304013252258,
                        0.7569620013237,
                        0.7107595205307007,
                        0.7601265907287598,
                        0.7981012463569641,
                        0.646835446357727,
                        0.6594936847686768,
                        0.7670885920524597,
                        0.6373417973518372,
                        0.7582278251647949,
                        0.800000011920929,
                        0.646202564239502,
                        0.6632911562919617,
                        0.6943038105964661,
                        0.6386076211929321,
                        0.6544303894042969,
                        0.6272152066230774,
                        0.6398734450340271,
                        0.6582278609275818,
                        0.6398734450340271,
                        0.646835446357727,
                        0.6379746794700623,
                        0.6373417973518372,
                        0.6601265668869019,
                        0.8101266026496887,
                        0.8284810185432434,
                        0.7905063629150391,
                        0.8436709046363831,
                        0.6405063271522522,
                        0.6487341523170471,
                        0.6316455602645874,
                        0.6683544516563416
                    ]
                },
                "test": {
                    "score": 0.6516455696202532,
                    "pretrain_loss": 0.5787575244903564,
                    "features_accuracy": [
                        0.7331645488739014,
                        0.7944303750991821,
                        0.7113924026489258,
                        0.7655696272850037,
                        0.7827848196029663,
                        0.6410126686096191,
                        0.6349366903305054,
                        0.7802531719207764,
                        0.648101270198822,
                        0.7853164672851562,
                        0.7939240336418152,
                        0.6627848148345947,
                        0.6420252919197083,
                        0.6415190100669861,
                        0.6582278609275818,
                        0.6637974977493286,
                        0.6612658500671387,
                        0.6572151780128479,
                        0.652151882648468,
                        0.6607595086097717,
                        0.6673417687416077,
                        0.6582278609275818,
                        0.646582305431366,
                        0.6582278609275818,
                        0.8237974643707275,
                        0.8293671011924744,
                        0.7873417735099792,
                        0.8334177136421204,
                        0.6612658500671387,
                        0.6405063271522522,
                        0.646582305431366,
                        0.6643037796020508
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": 0.9897119341563786,
                    "pretrain_loss": 0.5280603766441345,
                    "features_accuracy": [
                        0.7818930149078369,
                        0.8048433065414429,
                        0.7687559127807617,
                        0.7861664891242981,
                        0.8103830218315125,
                        0.777619481086731,
                        0.7799936532974243,
                        0.8114909529685974,
                        0.7780943512916565,
                        0.7918645143508911,
                        0.8151313662528992,
                        0.7760367393493652,
                        0.6465653777122498,
                        0.6549540758132935,
                        0.649730920791626,
                        0.6514719724655151,
                        0.6589110493659973,
                        0.651155412197113,
                        0.6500474810600281,
                        0.6598607301712036,
                        0.6506806015968323,
                        0.6552706360816956,
                        0.6517885327339172,
                        0.6514719724655151,
                        0.8521684408187866,
                        0.8548591136932373,
                        0.8515353202819824,
                        0.8417220711708069,
                        0.6560620665550232,
                        0.7323520183563232,
                        0.7345678806304932,
                        0.6483064293861389
                    ]
                },
                "val": {
                    "score": 0.7183544303797469,
                    "pretrain_loss": 0.5328367352485657,
                    "features_accuracy": [
                        0.7664557099342346,
                        0.7898734211921692,
                        0.7658227682113647,
                        0.8025316596031189,
                        0.8221518993377686,
                        0.7645569443702698,
                        0.7753164768218994,
                        0.801898717880249,
                        0.7594936490058899,
                        0.7898734211921692,
                        0.8227848410606384,
                        0.7620252966880798,
                        0.6632911562919617,
                        0.6943038105964661,
                        0.6386076211929321,
                        0.6544303894042969,
                        0.6272152066230774,
                        0.6398734450340271,
                        0.6582278609275818,
                        0.6398734450340271,
                        0.646835446357727,
                        0.6379746794700623,
                        0.6373417973518372,
                        0.6601265668869019,
                        0.8310126662254333,
                        0.8651898503303528,
                        0.8588607907295227,
                        0.853164553642273,
                        0.6405063271522522,
                        0.7234176993370056,
                        0.7088607549667358,
                        0.6683544516563416
                    ]
                },
                "test": {
                    "score": 0.6972151898734177,
                    "pretrain_loss": 0.5273720622062683,
                    "features_accuracy": [
                        0.7873417735099792,
                        0.8182278275489807,
                        0.7635443210601807,
                        0.8101266026496887,
                        0.8091139197349548,
                        0.7716455459594727,
                        0.7726582288742065,
                        0.8075949549674988,
                        0.7731645703315735,
                        0.803544282913208,
                        0.8111392259597778,
                        0.7711392641067505,
                        0.6420252919197083,
                        0.6415190100669861,
                        0.6582278609275818,
                        0.6637974977493286,
                        0.6612658500671387,
                        0.6572151780128479,
                        0.652151882648468,
                        0.6607595086097717,
                        0.6673417687416077,
                        0.6582278609275818,
                        0.646582305431366,
                        0.6577215194702148,
                        0.8637974858283997,
                        0.8592405319213867,
                        0.8435443043708801,
                        0.84860759973526,
                        0.6612658500671387,
                        0.7291139364242554,
                        0.7270886301994324,
                        0.6643037796020508
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": 0.99113643558088,
                    "pretrain_loss": 0.5157642960548401,
                    "features_accuracy": [
                        0.7943969368934631,
                        0.8094333410263062,
                        0.781101644039154,
                        0.7996201515197754,
                        0.8311174511909485,
                        0.7728711366653442,
                        0.8067426681518555,
                        0.8230452537536621,
                        0.7790440320968628,
                        0.802627444267273,
                        0.8342829942703247,
                        0.7676479816436768,
                        0.6570116877555847,
                        0.6489395499229431,
                        0.6422918438911438,
                        0.6479898691177368,
                        0.6484646797180176,
                        0.6467236280441284,
                        0.6524216532707214,
                        0.6540044546127319,
                        0.6557455062866211,
                        0.6535295844078064,
                        0.6470401883125305,
                        0.6513137221336365,
                        0.8534346222877502,
                        0.8684710264205933,
                        0.8591326475143433,
                        0.8640392422676086,
                        0.708452045917511,
                        0.7564102411270142,
                        0.7415321469306946,
                        0.7207977175712585
                    ]
                },
                "val": {
                    "score": 0.7170886075949368,
                    "pretrain_loss": 0.5224817991256714,
                    "features_accuracy": [
                        0.7854430675506592,
                        0.7911392450332642,
                        0.7778481245040894,
                        0.8132911324501038,
                        0.8386076092720032,
                        0.7620252966880798,
                        0.7841772437095642,
                        0.797468364238739,
                        0.7677215337753296,
                        0.804430365562439,
                        0.8316455483436584,
                        0.7537974715232849,
                        0.6632911562919617,
                        0.6943038105964661,
                        0.6386076211929321,
                        0.6544303894042969,
                        0.6272152066230774,
                        0.6398734450340271,
                        0.6582278609275818,
                        0.6398734450340271,
                        0.646835446357727,
                        0.6379746794700623,
                        0.6373417973518372,
                        0.6601265668869019,
                        0.8405063152313232,
                        0.8683544397354126,
                        0.8626582622528076,
                        0.8626582622528076,
                        0.7094936966896057,
                        0.7398734092712402,
                        0.7310126423835754,
                        0.7329114079475403
                    ]
                },
                "test": {
                    "score": 0.6972151898734177,
                    "pretrain_loss": 0.5199759006500244,
                    "features_accuracy": [
                        0.7843037843704224,
                        0.8217721581459045,
                        0.7777215242385864,
                        0.8065822720527649,
                        0.8111392259597778,
                        0.7686076164245605,
                        0.7873417735099792,
                        0.8177215456962585,
                        0.7782278656959534,
                        0.8136708736419678,
                        0.8192405104637146,
                        0.7564557194709778,
                        0.6420252919197083,
                        0.6415190100669861,
                        0.6582278609275818,
                        0.6637974977493286,
                        0.6612658500671387,
                        0.6572151780128479,
                        0.652151882648468,
                        0.6607595086097717,
                        0.6668354272842407,
                        0.6582278609275818,
                        0.646582305431366,
                        0.6582278609275818,
                        0.8602531552314758,
                        0.8648101091384888,
                        0.8430379629135132,
                        0.8643038272857666,
                        0.6967088580131531,
                        0.7478480935096741,
                        0.7356961965560913,
                        0.7281012535095215
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": 0.9784742006964229,
                    "pretrain_loss": 0.5063976645469666,
                    "features_accuracy": [
                        0.7923393249511719,
                        0.8303260803222656,
                        0.7913897037506104,
                        0.8118075132369995,
                        0.837765097618103,
                        0.7891737818717957,
                        0.8013612031936646,
                        0.8171889781951904,
                        0.7872744798660278,
                        0.810857892036438,
                        0.8311174511909485,
                        0.7910731434822083,
                        0.6478316187858582,
                        0.6581196784973145,
                        0.6566951870918274,
                        0.6517885327339172,
                        0.647515058517456,
                        0.6449825763702393,
                        0.6578031182289124,
                        0.6585944890975952,
                        0.6495726704597473,
                        0.6467236280441284,
                        0.6519468426704407,
                        0.6514719724655151,
                        0.8588160872459412,
                        0.8681544661521912,
                        0.8672048449516296,
                        0.8583412766456604,
                        0.7435897588729858,
                        0.7611585855484009,
                        0.7559354305267334,
                        0.7450142502784729
                    ]
                },
                "val": {
                    "score": 0.710126582278481,
                    "pretrain_loss": 0.5174323320388794,
                    "features_accuracy": [
                        0.7816455960273743,
                        0.7911392450332642,
                        0.7765823006629944,
                        0.7936708927154541,
                        0.8360759615898132,
                        0.7632911205291748,
                        0.7854430675506592,
                        0.8126582503318787,
                        0.7651898860931396,
                        0.7955695986747742,
                        0.8265823125839233,
                        0.7689873576164246,
                        0.6632911562919617,
                        0.6943038105964661,
                        0.6386076211929321,
                        0.6544303894042969,
                        0.6272152066230774,
                        0.6398734450340271,
                        0.6582278609275818,
                        0.6398734450340271,
                        0.646835446357727,
                        0.6379746794700623,
                        0.6373417973518372,
                        0.6601265668869019,
                        0.8341771960258484,
                        0.8620253205299377,
                        0.8563291430473328,
                        0.8689873218536377,
                        0.7392405271530151,
                        0.751265823841095,
                        0.7316455841064453,
                        0.7544304132461548
                    ]
                },
                "test": {
                    "score": 0.6835443037974683,
                    "pretrain_loss": 0.513546347618103,
                    "features_accuracy": [
                        0.795949399471283,
                        0.8172152042388916,
                        0.7721518874168396,
                        0.8065822720527649,
                        0.8131645917892456,
                        0.7726582288742065,
                        0.7832911610603333,
                        0.8106329441070557,
                        0.7837975025177002,
                        0.8167088627815247,
                        0.8197468519210815,
                        0.7736709117889404,
                        0.6425316333770752,
                        0.6415190100669861,
                        0.6577215194702148,
                        0.6643037796020508,
                        0.6612658500671387,
                        0.656708836555481,
                        0.6516456007957458,
                        0.6607595086097717,
                        0.6673417687416077,
                        0.6582278609275818,
                        0.646075963973999,
                        0.6577215194702148,
                        0.8577215075492859,
                        0.8587341904640198,
                        0.849113941192627,
                        0.8658227920532227,
                        0.7493671178817749,
                        0.7458227872848511,
                        0.7554430365562439,
                        0.7554430365562439
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": 0.9848053181386515,
                    "pretrain_loss": 0.5064651966094971,
                    "features_accuracy": [
                        0.8083254098892212,
                        0.8279519081115723,
                        0.7918645143508911,
                        0.8118075132369995,
                        0.836340606212616,
                        0.7955049276351929,
                        0.7988287210464478,
                        0.8244697451591492,
                        0.7964545488357544,
                        0.7996201515197754,
                        0.8322253823280334,
                        0.7773029208183289,
                        0.6559037566184998,
                        0.6452991366386414,
                        0.6451408863067627,
                        0.6479898691177368,
                        0.654321014881134,
                        0.6525799632072449,
                        0.6487812399864197,
                        0.6487812399864197,
                        0.6492561101913452,
                        0.6525799632072449,
                        0.6468819379806519,
                        0.6495726704597473,
                        0.8646723628044128,
                        0.8615068197250366,
                        0.865305483341217,
                        0.8662551641464233,
                        0.7666983008384705,
                        0.7432731986045837,
                        0.7592592835426331,
                        0.7364672422409058
                    ]
                },
                "val": {
                    "score": 0.7018987341772152,
                    "pretrain_loss": 0.5182011127471924,
                    "features_accuracy": [
                        0.7854430675506592,
                        0.797468364238739,
                        0.7791139483451843,
                        0.8056961894035339,
                        0.8398734331130981,
                        0.7734177112579346,
                        0.7797468304634094,
                        0.8132911324501038,
                        0.7702531814575195,
                        0.800632894039154,
                        0.8316455483436584,
                        0.7544304132461548,
                        0.6632911562919617,
                        0.6943038105964661,
                        0.6386076211929321,
                        0.6544303894042969,
                        0.6272152066230774,
                        0.6398734450340271,
                        0.6582278609275818,
                        0.6398734450340271,
                        0.646835446357727,
                        0.6379746794700623,
                        0.6373417973518372,
                        0.6601265668869019,
                        0.8481012582778931,
                        0.8582278490066528,
                        0.8607594966888428,
                        0.8632911443710327,
                        0.7531645894050598,
                        0.7367088794708252,
                        0.7373417615890503,
                        0.7367088794708252
                    ]
                },
                "test": {
                    "score": 0.6769620253164557,
                    "pretrain_loss": 0.5141739249229431,
                    "features_accuracy": [
                        0.7908861041069031,
                        0.8334177136421204,
                        0.7817721366882324,
                        0.804050624370575,
                        0.8141772150993347,
                        0.7721518874168396,
                        0.7837975025177002,
                        0.8156961798667908,
                        0.7802531719207764,
                        0.8192405104637146,
                        0.8207594752311707,
                        0.7681012749671936,
                        0.6420252919197083,
                        0.6415190100669861,
                        0.6582278609275818,
                        0.6637974977493286,
                        0.6612658500671387,
                        0.6572151780128479,
                        0.652151882648468,
                        0.6607595086097717,
                        0.6673417687416077,
                        0.6582278609275818,
                        0.646582305431366,
                        0.6577215194702148,
                        0.8683544397354126,
                        0.855189859867096,
                        0.850632905960083,
                        0.8653164505958557,
                        0.752911388874054,
                        0.7265822887420654,
                        0.7437974810600281,
                        0.7422784566879272
                    ]
                }
            }
        },
        "train": {
            "score": 0.9897119341563786
        },
        "val": {
            "score": 0.7183544303797469
        },
        "test": {
            "score": 0.6972151898734177
        }
    },
    "best_iteration": 20000,
    "time": "0:20:58"
}
