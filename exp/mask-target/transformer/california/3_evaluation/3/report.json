{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask___23ebee2d278a465cab387c02e8244632.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 3,
        "data": {
            "path": "data/california",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "transformer",
            "config": {
                "n_blocks": 4,
                "attention_dropout": 0.006835950215068107,
                "ffn_dropout": 0.14201787610318556,
                "ffn_d_hidden": 695
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear"
            ],
            "d_num_embedding": 512,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.00031363259431556616,
            "weight_decay": 4.8674309203267864e-05,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.33783618095960377,
            "corrupt_strategy": "target_resample",
            "d_hidden_head": 512,
            "lr": 0.00031363259431556616,
            "weight_decay": 4.8674309203267864e-05,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": true,
            "early_stop_type": "finetune",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "epoch_size": 104,
    "n_parameters": 8759737,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -0.38758845786479185,
                    "pretrain_loss": 0.5571639537811279,
                    "features_accuracy": [
                        0.757362425327301,
                        0.6961163282394409,
                        0.7257930636405945,
                        0.677189826965332,
                        0.678552508354187,
                        0.7000530362129211,
                        0.762434720993042,
                        0.7691725492477417
                    ]
                },
                "val": {
                    "score": -0.45802062335547955,
                    "pretrain_loss": 0.5615549087524414,
                    "features_accuracy": [
                        0.7590069770812988,
                        0.7090523838996887,
                        0.7202543020248413,
                        0.6712079644203186,
                        0.6660611629486084,
                        0.6948229074478149,
                        0.761731743812561,
                        0.7671813368797302
                    ]
                },
                "test": {
                    "score": -0.44842755517990235,
                    "pretrain_loss": 0.5579801797866821,
                    "features_accuracy": [
                        0.7623546719551086,
                        0.7054263353347778,
                        0.7308623790740967,
                        0.6739341020584106,
                        0.669089138507843,
                        0.6906492114067078,
                        0.7558139562606812,
                        0.7759205102920532
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -0.3843820047199522,
                    "pretrain_loss": 0.5493271350860596,
                    "features_accuracy": [
                        0.7726550102233887,
                        0.7080021500587463,
                        0.7330608367919922,
                        0.6681051254272461,
                        0.6672723293304443,
                        0.6995987892150879,
                        0.7734878063201904,
                        0.7828753590583801
                    ]
                },
                "val": {
                    "score": -0.45201767029437334,
                    "pretrain_loss": 0.5553759932518005,
                    "features_accuracy": [
                        0.7702088952064514,
                        0.7039055228233337,
                        0.7232818603515625,
                        0.6754465699195862,
                        0.6636391282081604,
                        0.6936118602752686,
                        0.766575813293457,
                        0.7653648257255554
                    ]
                },
                "test": {
                    "score": -0.45231272770313474,
                    "pretrain_loss": 0.5522096753120422,
                    "features_accuracy": [
                        0.7696220874786377,
                        0.7034883499145508,
                        0.7328003644943237,
                        0.6739341020584106,
                        0.6707848906517029,
                        0.6986433863639832,
                        0.7655038833618164,
                        0.7766472697257996
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -0.3640858905930833,
                    "pretrain_loss": 0.5381218791007996,
                    "features_accuracy": [
                        0.7768945693969727,
                        0.7089863419532776,
                        0.7341964244842529,
                        0.6802180409431458,
                        0.6735559105873108,
                        0.7031569480895996,
                        0.7821182608604431,
                        0.7998334765434265
                    ]
                },
                "val": {
                    "score": -0.44589453026747233,
                    "pretrain_loss": 0.5506623983383179,
                    "features_accuracy": [
                        0.7656675577163696,
                        0.7178322672843933,
                        0.7223736047744751,
                        0.6793823838233948,
                        0.6739327907562256,
                        0.6984559297561646,
                        0.7614290118217468,
                        0.7732364535331726
                    ]
                },
                "test": {
                    "score": -0.4554722699549119,
                    "pretrain_loss": 0.5463455319404602,
                    "features_accuracy": [
                        0.7771317958831787,
                        0.7090600728988647,
                        0.731589138507843,
                        0.6787790656089783,
                        0.6700581312179565,
                        0.698401153087616,
                        0.7730135917663574,
                        0.7817344665527344
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -0.39592329827384254,
                    "pretrain_loss": 0.5345858335494995,
                    "features_accuracy": [
                        0.7812098264694214,
                        0.7071693539619446,
                        0.7375274896621704,
                        0.6816564798355103,
                        0.6749943494796753,
                        0.7051253318786621,
                        0.7874177098274231,
                        0.799454927444458
                    ]
                },
                "val": {
                    "score": -0.4575351680658326,
                    "pretrain_loss": 0.5487672686576843,
                    "features_accuracy": [
                        0.7726309299468994,
                        0.7111716866493225,
                        0.7208598256111145,
                        0.6751437783241272,
                        0.6684831976890564,
                        0.6924008727073669,
                        0.7747502326965332,
                        0.7708144187927246
                    ]
                },
                "test": {
                    "score": -0.4482065452105889,
                    "pretrain_loss": 0.5428164601325989,
                    "features_accuracy": [
                        0.7747092843055725,
                        0.7143895030021667,
                        0.7415212988853455,
                        0.6780523061752319,
                        0.6673933863639832,
                        0.7000969052314758,
                        0.7764050364494324,
                        0.7834302186965942
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": -0.3927903975256741,
                    "pretrain_loss": 0.5327925086021423,
                    "features_accuracy": [
                        0.7843894362449646,
                        0.7042168378829956,
                        0.7457793951034546,
                        0.6816564798355103,
                        0.6804451942443848,
                        0.7087591886520386,
                        0.7865092158317566,
                        0.8033916354179382
                    ]
                },
                "val": {
                    "score": -0.44760716790647936,
                    "pretrain_loss": 0.5483198761940002,
                    "features_accuracy": [
                        0.7756584882736206,
                        0.7096579074859619,
                        0.7260066866874695,
                        0.677263081073761,
                        0.67756587266922,
                        0.6963366866111755,
                        0.7723281979560852,
                        0.7696033716201782
                    ]
                },
                "test": {
                    "score": -0.43874615911513887,
                    "pretrain_loss": 0.5412033796310425,
                    "features_accuracy": [
                        0.7747092843055725,
                        0.7136628031730652,
                        0.7369186282157898,
                        0.6821705102920532,
                        0.6741763353347778,
                        0.7030038833618164,
                        0.7761628031730652,
                        0.7943313717842102
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": -0.3576150300108852,
                    "pretrain_loss": 0.5288285613059998,
                    "features_accuracy": [
                        0.7738663554191589,
                        0.7091377377510071,
                        0.7428268790245056,
                        0.6908168792724609,
                        0.6824135184288025,
                        0.7177681922912598,
                        0.7912787199020386,
                        0.8046029210090637
                    ]
                },
                "val": {
                    "score": -0.4361255722261776,
                    "pretrain_loss": 0.5467158555984497,
                    "features_accuracy": [
                        0.779291570186615,
                        0.7148047089576721,
                        0.7263094186782837,
                        0.6739327907562256,
                        0.6769603490829468,
                        0.7026945352554321,
                        0.776566743850708,
                        0.7811080813407898
                    ]
                },
                "test": {
                    "score": -0.44202378164297307,
                    "pretrain_loss": 0.5414092540740967,
                    "features_accuracy": [
                        0.7730135917663574,
                        0.7097868323326111,
                        0.7398256063461304,
                        0.6797480583190918,
                        0.6724806427955627,
                        0.7017926573753357,
                        0.7797964811325073,
                        0.7911821603775024
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": -0.35850377148777135,
                    "pretrain_loss": 0.5371909141540527,
                    "features_accuracy": [
                        0.7728064656257629,
                        0.7059580683708191,
                        0.7397229671478271,
                        0.6807479858398438,
                        0.6793853044509888,
                        0.7052010297775269,
                        0.7834810018539429,
                        0.7937012910842896
                    ]
                },
                "val": {
                    "score": -0.44160467147626686,
                    "pretrain_loss": 0.5415652394294739,
                    "features_accuracy": [
                        0.776566743850708,
                        0.7135937213897705,
                        0.7335755228996277,
                        0.6811988949775696,
                        0.6751437783241272,
                        0.7002725005149841,
                        0.7850438952445984,
                        0.7835301160812378
                    ]
                },
                "test": {
                    "score": -0.4371081187804054,
                    "pretrain_loss": 0.5359907746315002,
                    "features_accuracy": [
                        0.7776162624359131,
                        0.7180232405662537,
                        0.7446705102920532,
                        0.6807170510292053,
                        0.6681201457977295,
                        0.7073643207550049,
                        0.786821722984314,
                        0.7974806427955627
                    ]
                }
            },
            "80000": {
                "train": {
                    "score": -0.3589125067486255,
                    "pretrain_loss": 0.5301450490951538,
                    "features_accuracy": [
                        0.7826482057571411,
                        0.7101976275444031,
                        0.7428268790245056,
                        0.6865016222000122,
                        0.68309485912323,
                        0.7123174071311951,
                        0.7909001708030701,
                        0.805814266204834
                    ]
                },
                "val": {
                    "score": -0.43708630687771866,
                    "pretrain_loss": 0.5405371189117432,
                    "features_accuracy": [
                        0.778988778591156,
                        0.7148047089576721,
                        0.7305479645729065,
                        0.6793823838233948,
                        0.6718134880065918,
                        0.7008779644966125,
                        0.7847411632537842,
                        0.7901907563209534
                    ]
                },
                "test": {
                    "score": -0.43213210691797993,
                    "pretrain_loss": 0.5347598791122437,
                    "features_accuracy": [
                        0.7790697813034058,
                        0.7185077667236328,
                        0.7407945990562439,
                        0.6824128031730652,
                        0.6712693572044373,
                        0.7068798542022705,
                        0.7902131676673889,
                        0.794089138507843
                    ]
                }
            },
            "90000": {
                "train": {
                    "score": -0.36780606763182955,
                    "pretrain_loss": 0.5211719870567322,
                    "features_accuracy": [
                        0.7843894362449646,
                        0.7252631187438965,
                        0.7513059377670288,
                        0.68839430809021,
                        0.676659882068634,
                        0.7089863419532776,
                        0.8002877235412598,
                        0.8099780678749084
                    ]
                },
                "val": {
                    "score": -0.4426580849183333,
                    "pretrain_loss": 0.5357009172439575,
                    "features_accuracy": [
                        0.7808053493499756,
                        0.7172267436981201,
                        0.7329699993133545,
                        0.677263081073761,
                        0.6793823838233948,
                        0.7032999992370605,
                        0.7980623841285706,
                        0.7910990118980408
                    ]
                },
                "test": {
                    "score": -0.43796808678975707,
                    "pretrain_loss": 0.5276716947555542,
                    "features_accuracy": [
                        0.7795542478561401,
                        0.7177810072898865,
                        0.7490310072898865,
                        0.6778100728988647,
                        0.6751453280448914,
                        0.7068798542022705,
                        0.7974806427955627,
                        0.8059592843055725
                    ]
                }
            }
        },
        "train": {
            "score": -0.3576150300108852
        },
        "val": {
            "score": -0.4361255722261776
        },
        "test": {
            "score": -0.44202378164297307
        }
    },
    "best_iteration": 60000,
    "time": "0:36:00"
}
