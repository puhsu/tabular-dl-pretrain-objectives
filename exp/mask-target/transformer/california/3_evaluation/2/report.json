{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask___23ebee2d278a465cab387c02e8244632.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 2,
        "data": {
            "path": "data/california",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "transformer",
            "config": {
                "n_blocks": 4,
                "attention_dropout": 0.006835950215068107,
                "ffn_dropout": 0.14201787610318556,
                "ffn_d_hidden": 695
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear"
            ],
            "d_num_embedding": 512,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.00031363259431556616,
            "weight_decay": 4.8674309203267864e-05,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.33783618095960377,
            "corrupt_strategy": "target_resample",
            "d_hidden_head": 512,
            "lr": 0.00031363259431556616,
            "weight_decay": 4.8674309203267864e-05,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": true,
            "early_stop_type": "finetune",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "epoch_size": 104,
    "n_parameters": 8759737,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -0.4115042889760798,
                    "pretrain_loss": 0.5559001564979553,
                    "features_accuracy": [
                        0.766144335269928,
                        0.7016428709030151,
                        0.725414514541626,
                        0.6749943494796753,
                        0.6795367002487183,
                        0.6935423016548157,
                        0.7560754418373108,
                        0.7781058549880981
                    ]
                },
                "val": {
                    "score": -0.4656507784441959,
                    "pretrain_loss": 0.5632543563842773,
                    "features_accuracy": [
                        0.7405388951301575,
                        0.6830154657363892,
                        0.7302452325820923,
                        0.6754465699195862,
                        0.6808961629867554,
                        0.6902815699577332,
                        0.7490160465240479,
                        0.77414470911026
                    ]
                },
                "test": {
                    "score": -0.45611337195137874,
                    "pretrain_loss": 0.5625189542770386,
                    "features_accuracy": [
                        0.7613856792449951,
                        0.7022771239280701,
                        0.7255329489707947,
                        0.694767415523529,
                        0.6654554009437561,
                        0.6821705102920532,
                        0.7524224519729614,
                        0.7676841020584106
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -0.389973358946651,
                    "pretrain_loss": 0.54411381483078,
                    "features_accuracy": [
                        0.7779544591903687,
                        0.7042168378829956,
                        0.7282913327217102,
                        0.678022563457489,
                        0.6780982613563538,
                        0.6979332566261292,
                        0.7777273058891296,
                        0.7876448035240173
                    ]
                },
                "val": {
                    "score": -0.4525784785636133,
                    "pretrain_loss": 0.5585419535636902,
                    "features_accuracy": [
                        0.754465639591217,
                        0.6899787783622742,
                        0.7363003492355347,
                        0.6787768602371216,
                        0.6757493019104004,
                        0.6893733143806458,
                        0.7662730813026428,
                        0.7823191285133362
                    ]
                },
                "test": {
                    "score": -0.44885330730221445,
                    "pretrain_loss": 0.5552167892456055,
                    "features_accuracy": [
                        0.7669573426246643,
                        0.7042151093482971,
                        0.7298933863639832,
                        0.6996123790740967,
                        0.667151153087616,
                        0.6833817958831787,
                        0.7676841020584106,
                        0.7744670510292053
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -0.4165483655457039,
                    "pretrain_loss": 0.5415132641792297,
                    "features_accuracy": [
                        0.7734878063201904,
                        0.7039140462875366,
                        0.7341964244842529,
                        0.6814293265342712,
                        0.6739344596862793,
                        0.7044439911842346,
                        0.7802256345748901,
                        0.7888560891151428
                    ]
                },
                "val": {
                    "score": -0.45845222082983006,
                    "pretrain_loss": 0.5547786355018616,
                    "features_accuracy": [
                        0.7553738951683044,
                        0.6917953491210938,
                        0.7320617437362671,
                        0.682107150554657,
                        0.6754465699195862,
                        0.7045110464096069,
                        0.7602179646492004,
                        0.7886769771575928
                    ]
                },
                "test": {
                    "score": -0.45423525267694387,
                    "pretrain_loss": 0.5525427460670471,
                    "features_accuracy": [
                        0.7730135917663574,
                        0.7107558250427246,
                        0.7281976938247681,
                        0.6996123790740967,
                        0.6652131676673889,
                        0.6882267594337463,
                        0.7623546719551086,
                        0.7814922332763672
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -0.39734904334819376,
                    "pretrain_loss": 0.537473738193512,
                    "features_accuracy": [
                        0.7735635042190552,
                        0.7056552767753601,
                        0.7432054281234741,
                        0.6800666451454163,
                        0.6746158003807068,
                        0.7041411399841309,
                        0.7860549688339233,
                        0.7947611808776855
                    ]
                },
                "val": {
                    "score": -0.4511597692329703,
                    "pretrain_loss": 0.5523290038108826,
                    "features_accuracy": [
                        0.747199535369873,
                        0.6911898255348206,
                        0.7369058132171631,
                        0.6787768602371216,
                        0.6769603490829468,
                        0.6911898255348206,
                        0.771722674369812,
                        0.7877687215805054
                    ]
                },
                "test": {
                    "score": -0.44036204017334496,
                    "pretrain_loss": 0.5476131439208984,
                    "features_accuracy": [
                        0.7664728760719299,
                        0.7090600728988647,
                        0.7248061895370483,
                        0.6957364082336426,
                        0.6630329489707947,
                        0.6913759708404541,
                        0.7693798542022705,
                        0.7834302186965942
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": -0.4154596465410247,
                    "pretrain_loss": 0.5330694913864136,
                    "features_accuracy": [
                        0.7836323976516724,
                        0.7132258415222168,
                        0.7398743629455566,
                        0.685441792011261,
                        0.6788553595542908,
                        0.7126958966255188,
                        0.7883261442184448,
                        0.7955182194709778
                    ]
                },
                "val": {
                    "score": -0.4518178745273492,
                    "pretrain_loss": 0.5515040755271912,
                    "features_accuracy": [
                        0.7505298256874084,
                        0.6933091282844543,
                        0.7414471507072449,
                        0.6787768602371216,
                        0.6727217435836792,
                        0.6981531977653503,
                        0.7708144187927246,
                        0.7783833146095276
                    ]
                },
                "test": {
                    "score": -0.4472266149766207,
                    "pretrain_loss": 0.5493276715278625,
                    "features_accuracy": [
                        0.7710756063461304,
                        0.7153584957122803,
                        0.7281976938247681,
                        0.7010658979415894,
                        0.6673933863639832,
                        0.693071722984314,
                        0.7662306427955627,
                        0.7810077667236328
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": -0.409238945538279,
                    "pretrain_loss": 0.523970365524292,
                    "features_accuracy": [
                        0.7859035730361938,
                        0.7117117643356323,
                        0.7445681095123291,
                        0.6796880960464478,
                        0.6898326873779297,
                        0.7114089131355286,
                        0.7964267134666443,
                        0.8049814701080322
                    ]
                },
                "val": {
                    "score": -0.4549937345767401,
                    "pretrain_loss": 0.5458008646965027,
                    "features_accuracy": [
                        0.7605207562446594,
                        0.6990614533424377,
                        0.7390251159667969,
                        0.6790796518325806,
                        0.6751437783241272,
                        0.6963366866111755,
                        0.7874659299850464,
                        0.798970639705658
                    ]
                },
                "test": {
                    "score": -0.4494255672210901,
                    "pretrain_loss": 0.5423529148101807,
                    "features_accuracy": [
                        0.7722868323326111,
                        0.7182654738426208,
                        0.7340116500854492,
                        0.7030038833618164,
                        0.6688469052314758,
                        0.6891957521438599,
                        0.7785852551460266,
                        0.7914243936538696
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": -0.3536985972816694,
                    "pretrain_loss": 0.5366039276123047,
                    "features_accuracy": [
                        0.7750019431114197,
                        0.7114846110343933,
                        0.7336664795875549,
                        0.6847603917121887,
                        0.6788553595542908,
                        0.7036111950874329,
                        0.7868120670318604,
                        0.7987735867500305
                    ]
                },
                "val": {
                    "score": -0.4458440444144172,
                    "pretrain_loss": 0.5445942282676697,
                    "features_accuracy": [
                        0.7541629076004028,
                        0.6975476741790771,
                        0.7432637214660645,
                        0.6811988949775696,
                        0.6778686046600342,
                        0.6966394186019897,
                        0.7801998257637024,
                        0.796245813369751
                    ]
                },
                "test": {
                    "score": -0.4415715136599701,
                    "pretrain_loss": 0.5416651368141174,
                    "features_accuracy": [
                        0.7727712988853455,
                        0.7148740291595459,
                        0.7354651093482971,
                        0.700339138507843,
                        0.6632751822471619,
                        0.6925871968269348,
                        0.7783430218696594,
                        0.7873061895370483
                    ]
                }
            },
            "80000": {
                "train": {
                    "score": -0.3564757285026155,
                    "pretrain_loss": 0.5272859334945679,
                    "features_accuracy": [
                        0.7746990919113159,
                        0.7164055109024048,
                        0.7412370443344116,
                        0.6871830224990845,
                        0.680672287940979,
                        0.7151942253112793,
                        0.7952911257743835,
                        0.8088424801826477
                    ]
                },
                "val": {
                    "score": -0.43609929281562915,
                    "pretrain_loss": 0.5429177284240723,
                    "features_accuracy": [
                        0.7577959299087524,
                        0.7023917436599731,
                        0.7359975576400757,
                        0.6802906394004822,
                        0.6842264533042908,
                        0.7005752325057983,
                        0.776566743850708,
                        0.7971541285514832
                    ]
                },
                "test": {
                    "score": -0.4384678591688897,
                    "pretrain_loss": 0.5392152667045593,
                    "features_accuracy": [
                        0.773982584476471,
                        0.7117248177528381,
                        0.7342538833618164,
                        0.700339138507843,
                        0.6717538833618164,
                        0.693071722984314,
                        0.7853682041168213,
                        0.794089138507843
                    ]
                }
            },
            "90000": {
                "train": {
                    "score": -0.31914975725622824,
                    "pretrain_loss": 0.5188238620758057,
                    "features_accuracy": [
                        0.7803013324737549,
                        0.7190552353858948,
                        0.7538042664527893,
                        0.6897569894790649,
                        0.6861231327056885,
                        0.7145885825157166,
                        0.8069498538970947,
                        0.8179271817207336
                    ]
                },
                "val": {
                    "score": -0.4393530793509483,
                    "pretrain_loss": 0.5377639532089233,
                    "features_accuracy": [
                        0.7614290118217468,
                        0.696942150592804,
                        0.7393279075622559,
                        0.6866484880447388,
                        0.6827126741409302,
                        0.7084468603134155,
                        0.7910990118980408,
                        0.8035119771957397
                    ]
                },
                "test": {
                    "score": -0.4476710626034303,
                    "pretrain_loss": 0.5365492105484009,
                    "features_accuracy": [
                        0.7766472697257996,
                        0.7102712988853455,
                        0.7361918687820435,
                        0.6996123790740967,
                        0.6688469052314758,
                        0.7025193572044373,
                        0.7919089198112488,
                        0.8008720874786377
                    ]
                }
            },
            "100000": {
                "train": {
                    "score": -0.3582310969308928,
                    "pretrain_loss": 0.5146973729133606,
                    "features_accuracy": [
                        0.7833295464515686,
                        0.7205693125724792,
                        0.7553183436393738,
                        0.6922553181648254,
                        0.6856688857078552,
                        0.7231433391571045,
                        0.8079339861869812,
                        0.8215610980987549
                    ]
                },
                "val": {
                    "score": -0.43706892545598947,
                    "pretrain_loss": 0.5357369780540466,
                    "features_accuracy": [
                        0.7571904063224792,
                        0.7029972672462463,
                        0.7459884881973267,
                        0.6818044185638428,
                        0.6881622672080994,
                        0.7081441283226013,
                        0.7980623841285706,
                        0.80865877866745
                    ]
                },
                "test": {
                    "score": -0.42531786794462473,
                    "pretrain_loss": 0.5329065322875977,
                    "features_accuracy": [
                        0.7810077667236328,
                        0.7139050364494324,
                        0.739098846912384,
                        0.7088178396224976,
                        0.6688469052314758,
                        0.6976743936538696,
                        0.7950581312179565,
                        0.7972383499145508
                    ]
                }
            }
        },
        "train": {
            "score": -0.3564757285026155
        },
        "val": {
            "score": -0.43609929281562915
        },
        "test": {
            "score": -0.4384678591688897
        }
    },
    "best_iteration": 80000,
    "time": "0:37:16"
}
