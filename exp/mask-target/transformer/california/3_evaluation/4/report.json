{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask___23ebee2d278a465cab387c02e8244632.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 4,
        "data": {
            "path": "data/california",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "transformer",
            "config": {
                "n_blocks": 4,
                "attention_dropout": 0.006835950215068107,
                "ffn_dropout": 0.14201787610318556,
                "ffn_d_hidden": 695
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear"
            ],
            "d_num_embedding": 512,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.00031363259431556616,
            "weight_decay": 4.8674309203267864e-05,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.33783618095960377,
            "corrupt_strategy": "target_resample",
            "d_hidden_head": 512,
            "lr": 0.00031363259431556616,
            "weight_decay": 4.8674309203267864e-05,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": true,
            "early_stop_type": "finetune",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "epoch_size": 104,
    "n_parameters": 8759737,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -0.38748719127700504,
                    "pretrain_loss": 0.5553430914878845,
                    "features_accuracy": [
                        0.7625104188919067,
                        0.6952078342437744,
                        0.7214778065681458,
                        0.6735559105873108,
                        0.6746158003807068,
                        0.6955863833427429,
                        0.7653115391731262,
                        0.7783330082893372
                    ]
                },
                "val": {
                    "score": -0.4546479289478772,
                    "pretrain_loss": 0.5603287220001221,
                    "features_accuracy": [
                        0.769300639629364,
                        0.6933091282844543,
                        0.7241901159286499,
                        0.6663638949394226,
                        0.6751437783241272,
                        0.687254011631012,
                        0.7475022673606873,
                        0.7732364535331726
                    ]
                },
                "test": {
                    "score": -0.4545003651949138,
                    "pretrain_loss": 0.5616793632507324,
                    "features_accuracy": [
                        0.7437015771865845,
                        0.6870154738426208,
                        0.7197189927101135,
                        0.6681201457977295,
                        0.6763566136360168,
                        0.7037306427955627,
                        0.7543604373931885,
                        0.779312014579773
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -0.40408982146305583,
                    "pretrain_loss": 0.5434703826904297,
                    "features_accuracy": [
                        0.7681126594543457,
                        0.7056552767753601,
                        0.7344992160797119,
                        0.6800666451454163,
                        0.6725717782974243,
                        0.6976304054260254,
                        0.7718979716300964,
                        0.7915815114974976
                    ]
                },
                "val": {
                    "score": -0.45917974051598,
                    "pretrain_loss": 0.5515701174736023,
                    "features_accuracy": [
                        0.7826218605041504,
                        0.7014834880828857,
                        0.7272176742553711,
                        0.6730245351791382,
                        0.6787768602371216,
                        0.6887677907943726,
                        0.7562821507453918,
                        0.781410813331604
                    ]
                },
                "test": {
                    "score": -0.45210717999327943,
                    "pretrain_loss": 0.5541738271713257,
                    "features_accuracy": [
                        0.7536337375640869,
                        0.6889534592628479,
                        0.724079430103302,
                        0.6695736646652222,
                        0.676598846912384,
                        0.700339138507843,
                        0.757267415523529,
                        0.7839147448539734
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -0.38659254957960243,
                    "pretrain_loss": 0.5392590761184692,
                    "features_accuracy": [
                        0.7790143489837646,
                        0.7085320949554443,
                        0.7327579855918884,
                        0.683624804019928,
                        0.6742373108863831,
                        0.7075479030609131,
                        0.7775002121925354,
                        0.7969566583633423
                    ]
                },
                "val": {
                    "score": -0.44905388571766125,
                    "pretrain_loss": 0.549151599407196,
                    "features_accuracy": [
                        0.786557674407959,
                        0.7020890116691589,
                        0.7359975576400757,
                        0.6660611629486084,
                        0.6769603490829468,
                        0.6939145922660828,
                        0.7580987215042114,
                        0.7832273840904236
                    ]
                },
                "test": {
                    "score": -0.4449523183903407,
                    "pretrain_loss": 0.549689769744873,
                    "features_accuracy": [
                        0.760901153087616,
                        0.6969476938247681,
                        0.724321722984314,
                        0.6734496355056763,
                        0.6770833134651184,
                        0.7095445990562439,
                        0.7655038833618164,
                        0.7860949635505676
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -0.3731749698074882,
                    "pretrain_loss": 0.5330734848976135,
                    "features_accuracy": [
                        0.7769702672958374,
                        0.7167840600013733,
                        0.7416912913322449,
                        0.689984142780304,
                        0.6716632843017578,
                        0.7026270031929016,
                        0.7862821221351624,
                        0.8021803498268127
                    ]
                },
                "val": {
                    "score": -0.4477602309040253,
                    "pretrain_loss": 0.5461822152137756,
                    "features_accuracy": [
                        0.7871631979942322,
                        0.7081441283226013,
                        0.7350893020629883,
                        0.6715107560157776,
                        0.677263081073761,
                        0.6890705227851868,
                        0.7671813368797302,
                        0.786557674407959
                    ]
                },
                "test": {
                    "score": -0.4457160372671787,
                    "pretrain_loss": 0.5492720007896423,
                    "features_accuracy": [
                        0.7618701457977295,
                        0.6967054009437561,
                        0.729651153087616,
                        0.6756298542022705,
                        0.6787790656089783,
                        0.7105135917663574,
                        0.7635658979415894,
                        0.7933623790740967
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": -0.3593137526862425,
                    "pretrain_loss": 0.531547486782074,
                    "features_accuracy": [
                        0.7813612222671509,
                        0.7135286927223206,
                        0.7366189956665039,
                        0.6814293265342712,
                        0.6847603917121887,
                        0.7129230499267578,
                        0.7928685545921326,
                        0.801044762134552
                    ]
                },
                "val": {
                    "score": -0.44527703079326203,
                    "pretrain_loss": 0.5461794137954712,
                    "features_accuracy": [
                        0.7832273840904236,
                        0.7108688950538635,
                        0.7378141283988953,
                        0.6730245351791382,
                        0.6793823838233948,
                        0.7014834880828857,
                        0.7659703493118286,
                        0.7859521508216858
                    ]
                },
                "test": {
                    "score": -0.4462133616744717,
                    "pretrain_loss": 0.5479096174240112,
                    "features_accuracy": [
                        0.755329430103302,
                        0.6964631676673889,
                        0.7344961166381836,
                        0.6773256063461304,
                        0.6797480583190918,
                        0.711240291595459,
                        0.7688953280448914,
                        0.7972383499145508
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": -0.32076967728243044,
                    "pretrain_loss": 0.5197600722312927,
                    "features_accuracy": [
                        0.7902188301086426,
                        0.7279127836227417,
                        0.7503218054771423,
                        0.6905897855758667,
                        0.67771977186203,
                        0.7083806991577148,
                        0.8011961579322815,
                        0.8148989677429199
                    ]
                },
                "val": {
                    "score": -0.438701942204643,
                    "pretrain_loss": 0.5382912158966064,
                    "features_accuracy": [
                        0.7862549424171448,
                        0.7087495923042297,
                        0.7459884881973267,
                        0.6730245351791382,
                        0.6869512796401978,
                        0.7005752325057983,
                        0.7738419771194458,
                        0.7998788952827454
                    ]
                },
                "test": {
                    "score": -0.4424094678313146,
                    "pretrain_loss": 0.5417848229408264,
                    "features_accuracy": [
                        0.7604166865348816,
                        0.7020348906517029,
                        0.7361918687820435,
                        0.6775678396224976,
                        0.6775678396224976,
                        0.7160852551460266,
                        0.7768895030021667,
                        0.804990291595459
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": -0.3382015630051873,
                    "pretrain_loss": 0.5265247821807861,
                    "features_accuracy": [
                        0.7880990505218506,
                        0.7159512639045715,
                        0.758422315120697,
                        0.6837005019187927,
                        0.6816564798355103,
                        0.7113332152366638,
                        0.7915058135986328,
                        0.806344211101532
                    ]
                },
                "val": {
                    "score": -0.44352023464006196,
                    "pretrain_loss": 0.534320056438446,
                    "features_accuracy": [
                        0.7901907563209534,
                        0.7054193019866943,
                        0.7453829646110535,
                        0.6760520935058594,
                        0.6827126741409302,
                        0.6951256394386292,
                        0.7847411632537842,
                        0.8007871508598328
                    ]
                },
                "test": {
                    "score": -0.43899646221925337,
                    "pretrain_loss": 0.5383700728416443,
                    "features_accuracy": [
                        0.7701066136360168,
                        0.7017926573753357,
                        0.7366763353347778,
                        0.6775678396224976,
                        0.6712693572044373,
                        0.7192344665527344,
                        0.7836724519729614,
                        0.8071705102920532
                    ]
                }
            },
            "80000": {
                "train": {
                    "score": -0.3312413451607271,
                    "pretrain_loss": 0.5233110189437866,
                    "features_accuracy": [
                        0.7774245142936707,
                        0.7159512639045715,
                        0.7504732012748718,
                        0.6821864247322083,
                        0.6829434633255005,
                        0.716102659702301,
                        0.80422443151474,
                        0.8170187473297119
                    ]
                },
                "val": {
                    "score": -0.44040880210108513,
                    "pretrain_loss": 0.5304605960845947,
                    "features_accuracy": [
                        0.7901907563209534,
                        0.7126854062080383,
                        0.7502270340919495,
                        0.6784741282463074,
                        0.6917953491210938,
                        0.7029972672462463,
                        0.7895852327346802,
                        0.8104753494262695
                    ]
                },
                "test": {
                    "score": -0.4318354384098817,
                    "pretrain_loss": 0.5345611572265625,
                    "features_accuracy": [
                        0.7606589198112488,
                        0.7051841020584106,
                        0.7332848906517029,
                        0.6790212988853455,
                        0.6797480583190918,
                        0.713178277015686,
                        0.7851259708404541,
                        0.8035368323326111
                    ]
                }
            },
            "90000": {
                "train": {
                    "score": -0.291926339776935,
                    "pretrain_loss": 0.5186315178871155,
                    "features_accuracy": [
                        0.7832538485527039,
                        0.7215535044670105,
                        0.7445681095123291,
                        0.6888485550880432,
                        0.6842304468154907,
                        0.719812273979187,
                        0.804527223110199,
                        0.8195170164108276
                    ]
                },
                "val": {
                    "score": -0.4339218047858404,
                    "pretrain_loss": 0.5291761159896851,
                    "features_accuracy": [
                        0.7874659299850464,
                        0.7078413367271423,
                        0.7517408132553101,
                        0.6787768602371216,
                        0.6899787783622742,
                        0.7051165699958801,
                        0.7847411632537842,
                        0.806236743927002
                    ]
                },
                "test": {
                    "score": -0.4356129299120359,
                    "pretrain_loss": 0.5360070466995239,
                    "features_accuracy": [
                        0.7625969052314758,
                        0.7066376209259033,
                        0.7337693572044373,
                        0.6797480583190918,
                        0.6795058250427246,
                        0.7143895030021667,
                        0.7839147448539734,
                        0.8108042478561401
                    ]
                }
            },
            "100000": {
                "train": {
                    "score": -0.27413380447415264,
                    "pretrain_loss": 0.5047267079353333,
                    "features_accuracy": [
                        0.794609785079956,
                        0.7332122325897217,
                        0.7643274068832397,
                        0.6925581097602844,
                        0.6914982199668884,
                        0.729124128818512,
                        0.8172458410263062,
                        0.8284503221511841
                    ]
                },
                "val": {
                    "score": -0.435811081875152,
                    "pretrain_loss": 0.5267444252967834,
                    "features_accuracy": [
                        0.7895852327346802,
                        0.7166212797164917,
                        0.752043604850769,
                        0.6784741282463074,
                        0.6836209297180176,
                        0.7036027908325195,
                        0.7944293022155762,
                        0.8092643022537231
                    ]
                },
                "test": {
                    "score": -0.44291616965299324,
                    "pretrain_loss": 0.5313371419906616,
                    "features_accuracy": [
                        0.7664728760719299,
                        0.7090600728988647,
                        0.7374030947685242,
                        0.6768410801887512,
                        0.6797480583190918,
                        0.7105135917663574,
                        0.7906976938247681,
                        0.8076550364494324
                    ]
                }
            }
        },
        "train": {
            "score": -0.291926339776935
        },
        "val": {
            "score": -0.4339218047858404
        },
        "test": {
            "score": -0.4356129299120359
        }
    },
    "best_iteration": 90000,
    "time": "0:37:11"
}
