{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask___23ebee2d278a465cab387c02e8244632.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 9,
        "data": {
            "path": "data/california",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "transformer",
            "config": {
                "n_blocks": 4,
                "attention_dropout": 0.006835950215068107,
                "ffn_dropout": 0.14201787610318556,
                "ffn_d_hidden": 695
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear"
            ],
            "d_num_embedding": 512,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.00031363259431556616,
            "weight_decay": 4.8674309203267864e-05,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.33783618095960377,
            "corrupt_strategy": "target_resample",
            "d_hidden_head": 512,
            "lr": 0.00031363259431556616,
            "weight_decay": 4.8674309203267864e-05,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": true,
            "early_stop_type": "finetune",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "epoch_size": 104,
    "n_parameters": 8759737,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -0.42235769292247277,
                    "pretrain_loss": 0.5540845394134521,
                    "features_accuracy": [
                        0.765387237071991,
                        0.7037625908851624,
                        0.7326065897941589,
                        0.678779661655426,
                        0.6743130087852478,
                        0.6977061033248901,
                        0.7519115805625916,
                        0.7784844040870667
                    ]
                },
                "val": {
                    "score": -0.46141238289014824,
                    "pretrain_loss": 0.563909649848938,
                    "features_accuracy": [
                        0.7747502326965332,
                        0.6911898255348206,
                        0.7163184881210327,
                        0.6751437783241272,
                        0.6587950587272644,
                        0.6984559297561646,
                        0.7468967437744141,
                        0.7659703493118286
                    ]
                },
                "test": {
                    "score": -0.4578491812197359,
                    "pretrain_loss": 0.560792088508606,
                    "features_accuracy": [
                        0.7604166865348816,
                        0.6763566136360168,
                        0.7352228760719299,
                        0.6891957521438599,
                        0.6574612259864807,
                        0.6959787011146545,
                        0.7509689927101135,
                        0.770348846912384
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -0.38896713479839967,
                    "pretrain_loss": 0.5411161184310913,
                    "features_accuracy": [
                        0.7709137797355652,
                        0.715799868106842,
                        0.7317737936973572,
                        0.6786282062530518,
                        0.6804451942443848,
                        0.7116360068321228,
                        0.7781058549880981,
                        0.793322741985321
                    ]
                },
                "val": {
                    "score": -0.4521331060800244,
                    "pretrain_loss": 0.555217981338501,
                    "features_accuracy": [
                        0.7832273840904236,
                        0.6899787783622742,
                        0.7184377908706665,
                        0.6784741282463074,
                        0.662428081035614,
                        0.7008779644966125,
                        0.759612500667572,
                        0.776566743850708
                    ]
                },
                "test": {
                    "score": -0.44901881945953537,
                    "pretrain_loss": 0.5546011328697205,
                    "features_accuracy": [
                        0.757509708404541,
                        0.6814438104629517,
                        0.7337693572044373,
                        0.6952519416809082,
                        0.6577034592628479,
                        0.6988856792449951,
                        0.7671996355056763,
                        0.7841569781303406
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -0.38874244715356765,
                    "pretrain_loss": 0.5424721837043762,
                    "features_accuracy": [
                        0.7721250653266907,
                        0.7042168378829956,
                        0.7399500608444214,
                        0.6796880960464478,
                        0.6797637939453125,
                        0.7042168378829956,
                        0.7744719982147217,
                        0.7905216217041016
                    ]
                },
                "val": {
                    "score": -0.4510309344304228,
                    "pretrain_loss": 0.5560494661331177,
                    "features_accuracy": [
                        0.7835301160812378,
                        0.6942173838615417,
                        0.7247956395149231,
                        0.6739327907562256,
                        0.6566757559776306,
                        0.687254011631012,
                        0.7611262202262878,
                        0.7777777910232544
                    ]
                },
                "test": {
                    "score": -0.4447934607660917,
                    "pretrain_loss": 0.5513659119606018,
                    "features_accuracy": [
                        0.7754360437393188,
                        0.6814438104629517,
                        0.7378876209259033,
                        0.694767415523529,
                        0.6591569781303406,
                        0.6974321603775024,
                        0.7647771239280701,
                        0.786579430103302
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -0.3863105796793516,
                    "pretrain_loss": 0.5320010185241699,
                    "features_accuracy": [
                        0.7775002121925354,
                        0.7204179167747498,
                        0.7478991746902466,
                        0.680672287940979,
                        0.6790067553520203,
                        0.7099704742431641,
                        0.7837837934494019,
                        0.801271915435791
                    ]
                },
                "val": {
                    "score": -0.44808577530580246,
                    "pretrain_loss": 0.5529105067253113,
                    "features_accuracy": [
                        0.7811080813407898,
                        0.6984559297561646,
                        0.7214653491973877,
                        0.6766575574874878,
                        0.6669694185256958,
                        0.6899787783622742,
                        0.769300639629364,
                        0.7783833146095276
                    ]
                },
                "test": {
                    "score": -0.45061198363220384,
                    "pretrain_loss": 0.5484438538551331,
                    "features_accuracy": [
                        0.7688953280448914,
                        0.690891444683075,
                        0.7420058250427246,
                        0.693071722984314,
                        0.6586724519729614,
                        0.7051841020584106,
                        0.7691376209259033,
                        0.786821722984314
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": -0.3890400800401883,
                    "pretrain_loss": 0.5257317423820496,
                    "features_accuracy": [
                        0.7836323976516724,
                        0.71368008852005,
                        0.7472935318946838,
                        0.6947535872459412,
                        0.6837005019187927,
                        0.7188280820846558,
                        0.7946854829788208,
                        0.8027102947235107
                    ]
                },
                "val": {
                    "score": -0.4487464207266656,
                    "pretrain_loss": 0.5488685369491577,
                    "features_accuracy": [
                        0.781410813331604,
                        0.6936118602752686,
                        0.7284287214279175,
                        0.6781713366508484,
                        0.6639418601989746,
                        0.6978504657745361,
                        0.7744474411010742,
                        0.7805025577545166
                    ]
                },
                "test": {
                    "score": -0.43845337074630064,
                    "pretrain_loss": 0.5452823042869568,
                    "features_accuracy": [
                        0.7659883499145508,
                        0.6836240291595459,
                        0.7466084957122803,
                        0.6981589198112488,
                        0.6610949635505676,
                        0.6976743936538696,
                        0.7764050364494324,
                        0.7880329489707947
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": -0.40360511749840966,
                    "pretrain_loss": 0.5253616571426392,
                    "features_accuracy": [
                        0.7812098264694214,
                        0.7196608781814575,
                        0.7485805153846741,
                        0.6792338490486145,
                        0.6818835735321045,
                        0.7048224806785583,
                        0.8011961579322815,
                        0.8106594085693359
                    ]
                },
                "val": {
                    "score": -0.4501078137965165,
                    "pretrain_loss": 0.5484453439712524,
                    "features_accuracy": [
                        0.7798970341682434,
                        0.6954283714294434,
                        0.7284287214279175,
                        0.6754465699195862,
                        0.6681804656982422,
                        0.6975476741790771,
                        0.7756584882736206,
                        0.7795943021774292
                    ]
                },
                "test": {
                    "score": -0.4408730755580128,
                    "pretrain_loss": 0.5437572598457336,
                    "features_accuracy": [
                        0.7693798542022705,
                        0.6923449635505676,
                        0.7492732405662537,
                        0.6935561895370483,
                        0.6603682041168213,
                        0.7085756063461304,
                        0.7742248177528381,
                        0.7953003644943237
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": -0.3517437006883865,
                    "pretrain_loss": 0.5365830063819885,
                    "features_accuracy": [
                        0.7803013324737549,
                        0.7029298543930054,
                        0.7356348037719727,
                        0.6867287755012512,
                        0.6787039637565613,
                        0.7080778479576111,
                        0.7838594913482666,
                        0.7943069338798523
                    ]
                },
                "val": {
                    "score": -0.4409293654996831,
                    "pretrain_loss": 0.5436506271362305,
                    "features_accuracy": [
                        0.7883741855621338,
                        0.6933091282844543,
                        0.7332727909088135,
                        0.6808961629867554,
                        0.6645473837852478,
                        0.6960338950157166,
                        0.7771722674369812,
                        0.7901907563209534
                    ]
                },
                "test": {
                    "score": -0.43259535725578974,
                    "pretrain_loss": 0.5412424206733704,
                    "features_accuracy": [
                        0.773740291595459,
                        0.6882267594337463,
                        0.7504844665527344,
                        0.6942829489707947,
                        0.6569767594337463,
                        0.7085756063461304,
                        0.7836724519729614,
                        0.7933623790740967
                    ]
                }
            },
            "80000": {
                "train": {
                    "score": -0.2983889939492364,
                    "pretrain_loss": 0.532768726348877,
                    "features_accuracy": [
                        0.7768945693969727,
                        0.7098947763442993,
                        0.7360890507698059,
                        0.6868801712989807,
                        0.6744644045829773,
                        0.7123931050300598,
                        0.7945340275764465,
                        0.7993792295455933
                    ]
                },
                "val": {
                    "score": -0.4412720714888254,
                    "pretrain_loss": 0.5427083373069763,
                    "features_accuracy": [
                        0.7829245924949646,
                        0.699364185333252,
                        0.7299425005912781,
                        0.682409942150116,
                        0.6727217435836792,
                        0.6924008727073669,
                        0.7847411632537842,
                        0.7880714535713196
                    ]
                },
                "test": {
                    "score": -0.44586124130771454,
                    "pretrain_loss": 0.5421971082687378,
                    "features_accuracy": [
                        0.770348846912384,
                        0.6875,
                        0.7449128031730652,
                        0.6974321603775024,
                        0.6574612259864807,
                        0.7080910801887512,
                        0.7795542478561401,
                        0.7933623790740967
                    ]
                }
            },
            "90000": {
                "train": {
                    "score": -0.36663119517976206,
                    "pretrain_loss": 0.517764151096344,
                    "features_accuracy": [
                        0.7848436832427979,
                        0.726247251033783,
                        0.7569838762283325,
                        0.6855931878089905,
                        0.685214638710022,
                        0.7234461307525635,
                        0.8055114150047302,
                        0.8173215389251709
                    ]
                },
                "val": {
                    "score": -0.439269241176837,
                    "pretrain_loss": 0.5365086197853088,
                    "features_accuracy": [
                        0.7859521508216858,
                        0.7032999992370605,
                        0.7359975576400757,
                        0.6818044185638428,
                        0.6766575574874878,
                        0.7069330811500549,
                        0.7862549424171448,
                        0.7944293022155762
                    ]
                },
                "test": {
                    "score": -0.42433212087958516,
                    "pretrain_loss": 0.5361599922180176,
                    "features_accuracy": [
                        0.7720445990562439,
                        0.6916182041168213,
                        0.7524224519729614,
                        0.6959787011146545,
                        0.659641444683075,
                        0.7097868323326111,
                        0.788517415523529,
                        0.7969961166381836
                    ]
                }
            },
            "100000": {
                "train": {
                    "score": -0.3177780341000045,
                    "pretrain_loss": 0.517620861530304,
                    "features_accuracy": [
                        0.7847679853439331,
                        0.7276099920272827,
                        0.7513816356658936,
                        0.6890756487846375,
                        0.6880914568901062,
                        0.72170490026474,
                        0.8037701845169067,
                        0.8155046105384827
                    ]
                },
                "val": {
                    "score": -0.43777031513210435,
                    "pretrain_loss": 0.5369587540626526,
                    "features_accuracy": [
                        0.7871631979942322,
                        0.7020890116691589,
                        0.7363003492355347,
                        0.6827126741409302,
                        0.6709052324295044,
                        0.7023917436599731,
                        0.7880714535713196,
                        0.7926127910614014
                    ]
                },
                "test": {
                    "score": -0.4363568179916669,
                    "pretrain_loss": 0.5324927568435669,
                    "features_accuracy": [
                        0.7781007885932922,
                        0.7015503644943237,
                        0.7546027302742004,
                        0.6998546719551086,
                        0.6673933863639832,
                        0.7080910801887512,
                        0.786821722984314,
                        0.8006298542022705
                    ]
                }
            }
        },
        "train": {
            "score": -0.3177780341000045
        },
        "val": {
            "score": -0.43777031513210435
        },
        "test": {
            "score": -0.4363568179916669
        }
    },
    "best_iteration": 100000,
    "time": "0:37:36"
}
