{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask___23ebee2d278a465cab387c02e8244632.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 0,
        "data": {
            "path": "data/california",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "transformer",
            "config": {
                "n_blocks": 4,
                "attention_dropout": 0.006835950215068107,
                "ffn_dropout": 0.14201787610318556,
                "ffn_d_hidden": 695
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear"
            ],
            "d_num_embedding": 512,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.00031363259431556616,
            "weight_decay": 4.8674309203267864e-05,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.33783618095960377,
            "corrupt_strategy": "target_resample",
            "d_hidden_head": 512,
            "lr": 0.00031363259431556616,
            "weight_decay": 4.8674309203267864e-05,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": true,
            "early_stop_type": "finetune",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "epoch_size": 104,
    "n_parameters": 8759737,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -0.37926680207344055,
                    "pretrain_loss": 0.5568608045578003,
                    "features_accuracy": [
                        0.7700810432434082,
                        0.7008100748062134,
                        0.7226890921592712,
                        0.6762056350708008,
                        0.6672723293304443,
                        0.6848361492156982,
                        0.764554500579834,
                        0.7726550102233887
                    ]
                },
                "val": {
                    "score": -0.45536482130369815,
                    "pretrain_loss": 0.5623823404312134,
                    "features_accuracy": [
                        0.7662730813026428,
                        0.6957311630249023,
                        0.7220708131790161,
                        0.6715107560157776,
                        0.6642446517944336,
                        0.6936118602752686,
                        0.7632455229759216,
                        0.764456570148468
                    ]
                },
                "test": {
                    "score": -0.4559769570653635,
                    "pretrain_loss": 0.5627533793449402,
                    "features_accuracy": [
                        0.7570251822471619,
                        0.6933139562606812,
                        0.7216569781303406,
                        0.6749030947685242,
                        0.6557654738426208,
                        0.6996123790740967,
                        0.7512112259864807,
                        0.7802810072898865
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -0.402208473996673,
                    "pretrain_loss": 0.5440371632575989,
                    "features_accuracy": [
                        0.7768188714981079,
                        0.7032326459884644,
                        0.7389658689498901,
                        0.683322012424469,
                        0.6752214431762695,
                        0.7006586790084839,
                        0.7692482471466064,
                        0.7863578200340271
                    ]
                },
                "val": {
                    "score": -0.4526499413760876,
                    "pretrain_loss": 0.5542175769805908,
                    "features_accuracy": [
                        0.776869535446167,
                        0.6954283714294434,
                        0.7284287214279175,
                        0.67756587266922,
                        0.6639418601989746,
                        0.6999697089195251,
                        0.7580987215042114,
                        0.7777777910232544
                    ]
                },
                "test": {
                    "score": -0.4508095756801443,
                    "pretrain_loss": 0.554378867149353,
                    "features_accuracy": [
                        0.7667151093482971,
                        0.6959787011146545,
                        0.7277131676673889,
                        0.6741763353347778,
                        0.6552810072898865,
                        0.6942829489707947,
                        0.7642926573753357,
                        0.788759708404541
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -0.39999428332908393,
                    "pretrain_loss": 0.5382184982299805,
                    "features_accuracy": [
                        0.7750776410102844,
                        0.7082292437553406,
                        0.7424483299255371,
                        0.6892270445823669,
                        0.684684693813324,
                        0.7015671133995056,
                        0.7853736281394958,
                        0.7894617319107056
                    ]
                },
                "val": {
                    "score": -0.4493939020573012,
                    "pretrain_loss": 0.550648033618927,
                    "features_accuracy": [
                        0.7735391855239868,
                        0.6978504657745361,
                        0.7408416271209717,
                        0.6709052324295044,
                        0.6693914532661438,
                        0.6902815699577332,
                        0.7680895924568176,
                        0.7835301160812378
                    ]
                },
                "test": {
                    "score": -0.4530179857442697,
                    "pretrain_loss": 0.5495936274528503,
                    "features_accuracy": [
                        0.7655038833618164,
                        0.6971899271011353,
                        0.7349806427955627,
                        0.6778100728988647,
                        0.6598837375640869,
                        0.6974321603775024,
                        0.7708333134651184,
                        0.7979651093482971
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -0.3813003937609698,
                    "pretrain_loss": 0.5361815690994263,
                    "features_accuracy": [
                        0.7785601019859314,
                        0.7119388580322266,
                        0.7385873794555664,
                        0.6866530776023865,
                        0.6709062457084656,
                        0.7076236009597778,
                        0.7846165895462036,
                        0.800514817237854
                    ]
                },
                "val": {
                    "score": -0.4449865774599402,
                    "pretrain_loss": 0.5502703785896301,
                    "features_accuracy": [
                        0.7762640118598938,
                        0.7014834880828857,
                        0.7250983715057373,
                        0.6721162796020508,
                        0.6642446517944336,
                        0.6954283714294434,
                        0.7674841284751892,
                        0.7874659299850464
                    ]
                },
                "test": {
                    "score": -0.43899106709272184,
                    "pretrain_loss": 0.5510039329528809,
                    "features_accuracy": [
                        0.7604166865348816,
                        0.6991279125213623,
                        0.7301356792449951,
                        0.679990291595459,
                        0.6630329489707947,
                        0.6979166865348816,
                        0.7679263353347778,
                        0.7914243936538696
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": -0.36426691429579355,
                    "pretrain_loss": 0.530443549156189,
                    "features_accuracy": [
                        0.7791657447814941,
                        0.717692494392395,
                        0.7357105016708374,
                        0.687864363193512,
                        0.6812779307365417,
                        0.7092891335487366,
                        0.7955939173698425,
                        0.800212025642395
                    ]
                },
                "val": {
                    "score": -0.4445155377965489,
                    "pretrain_loss": 0.5444625020027161,
                    "features_accuracy": [
                        0.7714199423789978,
                        0.7005752325057983,
                        0.7423554062843323,
                        0.672419011592865,
                        0.6684831976890564,
                        0.7087495923042297,
                        0.7738419771194458,
                        0.7805025577545166
                    ]
                },
                "test": {
                    "score": -0.4414743212325094,
                    "pretrain_loss": 0.5454274415969849,
                    "features_accuracy": [
                        0.7642926573753357,
                        0.7030038833618164,
                        0.737160861492157,
                        0.6722383499145508,
                        0.6606104373931885,
                        0.7027616500854492,
                        0.7681686282157898,
                        0.8001453280448914
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": -0.34853505749514463,
                    "pretrain_loss": 0.524255096912384,
                    "features_accuracy": [
                        0.7799985408782959,
                        0.720342218875885,
                        0.7519115805625916,
                        0.6874101161956787,
                        0.685214638710022,
                        0.7140586376190186,
                        0.795972466468811,
                        0.8070255517959595
                    ]
                },
                "val": {
                    "score": -0.4418421804632038,
                    "pretrain_loss": 0.5424768924713135,
                    "features_accuracy": [
                        0.7771722674369812,
                        0.7032999992370605,
                        0.7390251159667969,
                        0.6742355227470398,
                        0.6669694185256958,
                        0.7051165699958801,
                        0.7880714535713196,
                        0.7935210466384888
                    ]
                },
                "test": {
                    "score": -0.4361712697768369,
                    "pretrain_loss": 0.5436230897903442,
                    "features_accuracy": [
                        0.7696220874786377,
                        0.7032461166381836,
                        0.7381298542022705,
                        0.6768410801887512,
                        0.6640019416809082,
                        0.694767415523529,
                        0.7764050364494324,
                        0.7974806427955627
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": -0.3288665399453667,
                    "pretrain_loss": 0.5344703197479248,
                    "features_accuracy": [
                        0.7768188714981079,
                        0.7059580683708191,
                        0.7376788854598999,
                        0.6885457038879395,
                        0.6773412227630615,
                        0.7074722051620483,
                        0.7898402810096741,
                        0.7976379990577698
                    ]
                },
                "val": {
                    "score": -0.43879265869416506,
                    "pretrain_loss": 0.5427045822143555,
                    "features_accuracy": [
                        0.7777777910232544,
                        0.7005752325057983,
                        0.7420526742935181,
                        0.6730245351791382,
                        0.6630336046218872,
                        0.7060248255729675,
                        0.781410813331604,
                        0.7923099994659424
                    ]
                },
                "test": {
                    "score": -0.4348111562800582,
                    "pretrain_loss": 0.5430877208709717,
                    "features_accuracy": [
                        0.7705910801887512,
                        0.7037306427955627,
                        0.7342538833618164,
                        0.6703003644943237,
                        0.663759708404541,
                        0.7008236646652222,
                        0.7834302186965942,
                        0.8040212988853455
                    ]
                }
            },
            "80000": {
                "train": {
                    "score": -0.3533314933923478,
                    "pretrain_loss": 0.5322782397270203,
                    "features_accuracy": [
                        0.7663714289665222,
                        0.715042769908905,
                        0.7405557036399841,
                        0.6848361492156982,
                        0.6725717782974243,
                        0.7160269618034363,
                        0.794912576675415,
                        0.7940041422843933
                    ]
                },
                "val": {
                    "score": -0.43730472118265257,
                    "pretrain_loss": 0.5408976674079895,
                    "features_accuracy": [
                        0.7699061632156372,
                        0.6999697089195251,
                        0.7414471507072449,
                        0.6739327907562256,
                        0.6657583713531494,
                        0.7063275575637817,
                        0.7795943021774292,
                        0.796245813369751
                    ]
                },
                "test": {
                    "score": -0.43565690748197927,
                    "pretrain_loss": 0.5394935011863708,
                    "features_accuracy": [
                        0.7613856792449951,
                        0.7010658979415894,
                        0.742732584476471,
                        0.6782945990562439,
                        0.661821722984314,
                        0.7080910801887512,
                        0.7848837375640869,
                        0.8059592843055725
                    ]
                }
            },
            "90000": {
                "train": {
                    "score": -0.3433941611996389,
                    "pretrain_loss": 0.5181078910827637,
                    "features_accuracy": [
                        0.7827239036560059,
                        0.7226133942604065,
                        0.7466121912002563,
                        0.687864363193512,
                        0.681732177734375,
                        0.720872163772583,
                        0.8069498538970947,
                        0.8171701431274414
                    ]
                },
                "val": {
                    "score": -0.4267727494064912,
                    "pretrain_loss": 0.5335131883621216,
                    "features_accuracy": [
                        0.7780805230140686,
                        0.7032999992370605,
                        0.7432637214660645,
                        0.6757493019104004,
                        0.66727215051651,
                        0.7099606394767761,
                        0.7877687215805054,
                        0.8035119771957397
                    ]
                },
                "test": {
                    "score": -0.431117666091597,
                    "pretrain_loss": 0.5328872799873352,
                    "features_accuracy": [
                        0.7727712988853455,
                        0.7160852551460266,
                        0.7361918687820435,
                        0.676598846912384,
                        0.663517415523529,
                        0.7126938104629517,
                        0.7894864082336426,
                        0.8122577667236328
                    ]
                }
            },
            "100000": {
                "train": {
                    "score": -0.3127141492304673,
                    "pretrain_loss": 0.5126367807388306,
                    "features_accuracy": [
                        0.7853736281394958,
                        0.722991943359375,
                        0.7518358826637268,
                        0.6818078756332397,
                        0.6889999508857727,
                        0.724051833152771,
                        0.8133848309516907,
                        0.8203498125076294
                    ]
                },
                "val": {
                    "score": -0.43875375308695547,
                    "pretrain_loss": 0.5319142937660217,
                    "features_accuracy": [
                        0.783832848072052,
                        0.7017862796783447,
                        0.749621570110321,
                        0.6760520935058594,
                        0.6639418601989746,
                        0.7057220935821533,
                        0.7950348258018494,
                        0.8007871508598328
                    ]
                },
                "test": {
                    "score": -0.42717521284112386,
                    "pretrain_loss": 0.5305453538894653,
                    "features_accuracy": [
                        0.7797964811325073,
                        0.7122092843055725,
                        0.7441860437393188,
                        0.6785368323326111,
                        0.6673933863639832,
                        0.7105135917663574,
                        0.7863371968269348,
                        0.8132267594337463
                    ]
                }
            }
        },
        "train": {
            "score": -0.3433941611996389
        },
        "val": {
            "score": -0.4267727494064912
        },
        "test": {
            "score": -0.431117666091597
        }
    },
    "best_iteration": 90000,
    "time": "0:38:07"
}
