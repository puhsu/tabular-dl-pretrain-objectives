{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask___23ebee2d278a465cab387c02e8244632.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 12,
        "data": {
            "path": "data/california",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "transformer",
            "config": {
                "n_blocks": 4,
                "attention_dropout": 0.006835950215068107,
                "ffn_dropout": 0.14201787610318556,
                "ffn_d_hidden": 695
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear"
            ],
            "d_num_embedding": 512,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.00031363259431556616,
            "weight_decay": 4.8674309203267864e-05,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.33783618095960377,
            "corrupt_strategy": "target_resample",
            "d_hidden_head": 512,
            "lr": 0.00031363259431556616,
            "weight_decay": 4.8674309203267864e-05,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": true,
            "early_stop_type": "finetune",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "epoch_size": 104,
    "n_parameters": 8759737,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -0.39153695671312494,
                    "pretrain_loss": 0.5541118383407593,
                    "features_accuracy": [
                        0.758952260017395,
                        0.7038382887840271,
                        0.7313953042030334,
                        0.6768112778663635,
                        0.6760542392730713,
                        0.7018699645996094,
                        0.7625861167907715,
                        0.7752290368080139
                    ]
                },
                "val": {
                    "score": -0.45697752189610347,
                    "pretrain_loss": 0.5563514232635498,
                    "features_accuracy": [
                        0.7635483145713806,
                        0.6939145922660828,
                        0.7344837784767151,
                        0.682107150554657,
                        0.6830154657363892,
                        0.6890705227851868,
                        0.7605207562446594,
                        0.7696033716201782
                    ]
                },
                "test": {
                    "score": -0.4695989411331674,
                    "pretrain_loss": 0.5593840479850769,
                    "features_accuracy": [
                        0.7601743936538696,
                        0.7008236646652222,
                        0.7306201457977295,
                        0.6678779125213623,
                        0.6659399271011353,
                        0.7037306427955627,
                        0.7524224519729614,
                        0.7839147448539734
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -0.3793924833328016,
                    "pretrain_loss": 0.5434489250183105,
                    "features_accuracy": [
                        0.7725036144256592,
                        0.7019456624984741,
                        0.7380574345588684,
                        0.6840790510177612,
                        0.6824892163276672,
                        0.6965705156326294,
                        0.7707623839378357,
                        0.7899916768074036
                    ]
                },
                "val": {
                    "score": -0.44823280886028316,
                    "pretrain_loss": 0.5500338673591614,
                    "features_accuracy": [
                        0.7738419771194458,
                        0.6996669769287109,
                        0.7350893020629883,
                        0.6751437783241272,
                        0.6781713366508484,
                        0.692098081111908,
                        0.7674841284751892,
                        0.7829245924949646
                    ]
                },
                "test": {
                    "score": -0.45024689848518284,
                    "pretrain_loss": 0.5541289448738098,
                    "features_accuracy": [
                        0.760901153087616,
                        0.7076066136360168,
                        0.7294089198112488,
                        0.674660861492157,
                        0.6644864082336426,
                        0.7027616500854492,
                        0.7589631676673889,
                        0.7880329489707947
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -0.3647040975495804,
                    "pretrain_loss": 0.5366697907447815,
                    "features_accuracy": [
                        0.7741691470146179,
                        0.7133772373199463,
                        0.7360890507698059,
                        0.6786282062530518,
                        0.6717389822006226,
                        0.7054281234741211,
                        0.7914301156997681,
                        0.7939283847808838
                    ]
                },
                "val": {
                    "score": -0.44741800855603386,
                    "pretrain_loss": 0.5457339286804199,
                    "features_accuracy": [
                        0.7732364535331726,
                        0.7029972672462463,
                        0.7423554062843323,
                        0.6754465699195862,
                        0.6781713366508484,
                        0.6954283714294434,
                        0.769300639629364,
                        0.7910990118980408
                    ]
                },
                "test": {
                    "score": -0.44624759139926856,
                    "pretrain_loss": 0.5471609830856323,
                    "features_accuracy": [
                        0.7642926573753357,
                        0.7090600728988647,
                        0.7306201457977295,
                        0.6749030947685242,
                        0.6707848906517029,
                        0.7134205102920532,
                        0.7698643207550049,
                        0.7943313717842102
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -0.3770696414003671,
                    "pretrain_loss": 0.5349860191345215,
                    "features_accuracy": [
                        0.7797713875770569,
                        0.7106518745422363,
                        0.7376788854598999,
                        0.6837762594223022,
                        0.676129937171936,
                        0.7070179581642151,
                        0.7890075445175171,
                        0.800741970539093
                    ]
                },
                "val": {
                    "score": -0.4441873541862314,
                    "pretrain_loss": 0.5446799993515015,
                    "features_accuracy": [
                        0.7777777910232544,
                        0.7048137784004211,
                        0.7450802326202393,
                        0.6696942448616028,
                        0.6757493019104004,
                        0.7011807560920715,
                        0.7762640118598938,
                        0.7929155230522156
                    ]
                },
                "test": {
                    "score": -0.4476263821128685,
                    "pretrain_loss": 0.5478302836418152,
                    "features_accuracy": [
                        0.7664728760719299,
                        0.7080910801887512,
                        0.7284399271011353,
                        0.6741763353347778,
                        0.6695736646652222,
                        0.7044573426246643,
                        0.7674418687820435,
                        0.7902131676673889
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": -0.38458400672554466,
                    "pretrain_loss": 0.5320263504981995,
                    "features_accuracy": [
                        0.7795442938804626,
                        0.7121659517288208,
                        0.7456279993057251,
                        0.6786282062530518,
                        0.672950267791748,
                        0.7058066725730896,
                        0.7936255931854248,
                        0.8033159375190735
                    ]
                },
                "val": {
                    "score": -0.4529437671161153,
                    "pretrain_loss": 0.5432319045066833,
                    "features_accuracy": [
                        0.7723281979560852,
                        0.7005752325057983,
                        0.7456857562065125,
                        0.6760520935058594,
                        0.6802906394004822,
                        0.696942150592804,
                        0.7732364535331726,
                        0.7907962203025818
                    ]
                },
                "test": {
                    "score": -0.4447335980985709,
                    "pretrain_loss": 0.5474326610565186,
                    "features_accuracy": [
                        0.7693798542022705,
                        0.7013081312179565,
                        0.7347383499145508,
                        0.6741763353347778,
                        0.6678779125213623,
                        0.7088178396224976,
                        0.7679263353347778,
                        0.7982073426246643
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": -0.37465083081373196,
                    "pretrain_loss": 0.5211704969406128,
                    "features_accuracy": [
                        0.7823454141616821,
                        0.718752384185791,
                        0.7455523014068604,
                        0.6921796202659607,
                        0.6802937388420105,
                        0.7162541151046753,
                        0.800741970539093,
                        0.8112650513648987
                    ]
                },
                "val": {
                    "score": -0.4454324265544821,
                    "pretrain_loss": 0.5382112264633179,
                    "features_accuracy": [
                        0.776869535446167,
                        0.7075386047363281,
                        0.7468967437744141,
                        0.6760520935058594,
                        0.6802906394004822,
                        0.6951256394386292,
                        0.781410813331604,
                        0.7983651161193848
                    ]
                },
                "test": {
                    "score": -0.4369494869806131,
                    "pretrain_loss": 0.5412474870681763,
                    "features_accuracy": [
                        0.7705910801887512,
                        0.7105135917663574,
                        0.7395833134651184,
                        0.6753876209259033,
                        0.6683623790740967,
                        0.711240291595459,
                        0.7754360437393188,
                        0.8045058250427246
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": -0.37523557292123655,
                    "pretrain_loss": 0.5333837866783142,
                    "features_accuracy": [
                        0.7750776410102844,
                        0.7136043906211853,
                        0.7401014566421509,
                        0.683624804019928,
                        0.682564914226532,
                        0.7068665623664856,
                        0.7901431322097778,
                        0.8057385683059692
                    ]
                },
                "val": {
                    "score": -0.44068350792280153,
                    "pretrain_loss": 0.5345391631126404,
                    "features_accuracy": [
                        0.7762640118598938,
                        0.7099606394767761,
                        0.7465940117835999,
                        0.6830154657363892,
                        0.6887677907943726,
                        0.6948229074478149,
                        0.793823778629303,
                        0.7977595925331116
                    ]
                },
                "test": {
                    "score": -0.4364288904515212,
                    "pretrain_loss": 0.5381588935852051,
                    "features_accuracy": [
                        0.768410861492157,
                        0.7090600728988647,
                        0.7359496355056763,
                        0.6712693572044373,
                        0.6710271239280701,
                        0.713178277015686,
                        0.7807654738426208,
                        0.8120154738426208
                    ]
                }
            },
            "80000": {
                "train": {
                    "score": -0.3195016230210095,
                    "pretrain_loss": 0.524000346660614,
                    "features_accuracy": [
                        0.7793928384780884,
                        0.7154970169067383,
                        0.7436596751213074,
                        0.6813536286354065,
                        0.6787039637565613,
                        0.7149670720100403,
                        0.801044762134552,
                        0.8170944452285767
                    ]
                },
                "val": {
                    "score": -0.43644779197910505,
                    "pretrain_loss": 0.5316937565803528,
                    "features_accuracy": [
                        0.7808053493499756,
                        0.7075386047363281,
                        0.7550711631774902,
                        0.6793823838233948,
                        0.6833181977272034,
                        0.7039055228233337,
                        0.784135639667511,
                        0.8077505230903625
                    ]
                },
                "test": {
                    "score": -0.4261040370542781,
                    "pretrain_loss": 0.5362247228622437,
                    "features_accuracy": [
                        0.773982584476471,
                        0.7129360437393188,
                        0.7378876209259033,
                        0.6768410801887512,
                        0.669089138507843,
                        0.7197189927101135,
                        0.7785852551460266,
                        0.8035368323326111
                    ]
                }
            },
            "90000": {
                "train": {
                    "score": -0.3391327932453903,
                    "pretrain_loss": 0.5191002488136292,
                    "features_accuracy": [
                        0.7831781506538391,
                        0.7239760756492615,
                        0.7425240874290466,
                        0.6935423016548157,
                        0.6809751391410828,
                        0.7209478616714478,
                        0.8038458824157715,
                        0.8218638896942139
                    ]
                },
                "val": {
                    "score": -0.4359158451134875,
                    "pretrain_loss": 0.531478762626648,
                    "features_accuracy": [
                        0.7805025577545166,
                        0.7166212797164917,
                        0.7481077909469604,
                        0.6811988949775696,
                        0.6854375004768372,
                        0.7066303491592407,
                        0.7920072674751282,
                        0.8050257563591003
                    ]
                },
                "test": {
                    "score": -0.43436519481820085,
                    "pretrain_loss": 0.5350164175033569,
                    "features_accuracy": [
                        0.7674418687820435,
                        0.7163274884223938,
                        0.7441860437393188,
                        0.6739341020584106,
                        0.6707848906517029,
                        0.7214147448539734,
                        0.784641444683075,
                        0.8088662624359131
                    ]
                }
            },
            "100000": {
                "train": {
                    "score": -0.3250155097525209,
                    "pretrain_loss": 0.5125632286071777,
                    "features_accuracy": [
                        0.7920357584953308,
                        0.7242032289505005,
                        0.7553183436393738,
                        0.6922553181648254,
                        0.6787039637565613,
                        0.7263987064361572,
                        0.8089181780815125,
                        0.8186085820198059
                    ]
                },
                "val": {
                    "score": -0.4399775928782309,
                    "pretrain_loss": 0.5260217189788818,
                    "features_accuracy": [
                        0.7868604063987732,
                        0.7196487784385681,
                        0.7547683715820312,
                        0.6818044185638428,
                        0.6875567436218262,
                        0.7075386047363281,
                        0.791704535484314,
                        0.8059340119361877
                    ]
                },
                "test": {
                    "score": -0.4295672171215607,
                    "pretrain_loss": 0.529851496219635,
                    "features_accuracy": [
                        0.7744670510292053,
                        0.7141472697257996,
                        0.7437015771865845,
                        0.6744186282157898,
                        0.6727228760719299,
                        0.7216569781303406,
                        0.7948158979415894,
                        0.8129844665527344
                    ]
                }
            }
        },
        "train": {
            "score": -0.3391327932453903
        },
        "val": {
            "score": -0.4359158451134875
        },
        "test": {
            "score": -0.43436519481820085
        }
    },
    "best_iteration": 90000,
    "time": "0:37:28"
}
