{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask___23ebee2d278a465cab387c02e8244632.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 5,
        "data": {
            "path": "data/california",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "transformer",
            "config": {
                "n_blocks": 4,
                "attention_dropout": 0.006835950215068107,
                "ffn_dropout": 0.14201787610318556,
                "ffn_d_hidden": 695
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear"
            ],
            "d_num_embedding": 512,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.00031363259431556616,
            "weight_decay": 4.8674309203267864e-05,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.33783618095960377,
            "corrupt_strategy": "target_resample",
            "d_hidden_head": 512,
            "lr": 0.00031363259431556616,
            "weight_decay": 4.8674309203267864e-05,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": true,
            "early_stop_type": "finetune",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "epoch_size": 104,
    "n_parameters": 8759737,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -0.3643605048317171,
                    "pretrain_loss": 0.5525374412536621,
                    "features_accuracy": [
                        0.762131929397583,
                        0.7030055522918701,
                        0.7306382060050964,
                        0.678249716758728,
                        0.6793853044509888,
                        0.7025513052940369,
                        0.767507016658783,
                        0.7777273058891296
                    ]
                },
                "val": {
                    "score": -0.4503645931190817,
                    "pretrain_loss": 0.5565865635871887,
                    "features_accuracy": [
                        0.7805025577545166,
                        0.7054193019866943,
                        0.7350893020629883,
                        0.6742355227470398,
                        0.6854375004768372,
                        0.6887677907943726,
                        0.7535573840141296,
                        0.7705116271972656
                    ]
                },
                "test": {
                    "score": -0.4561692992830915,
                    "pretrain_loss": 0.5595862865447998,
                    "features_accuracy": [
                        0.7599321603775024,
                        0.698401153087616,
                        0.7298933863639832,
                        0.6654554009437561,
                        0.6736918687820435,
                        0.7061530947685242,
                        0.7606589198112488,
                        0.7742248177528381
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -0.3994462515295469,
                    "pretrain_loss": 0.5463301539421082,
                    "features_accuracy": [
                        0.7704595327377319,
                        0.7025513052940369,
                        0.7297297716140747,
                        0.6797637939453125,
                        0.6762056350708008,
                        0.7054281234741211,
                        0.7742448449134827,
                        0.7894617319107056
                    ]
                },
                "val": {
                    "score": -0.45221442621412494,
                    "pretrain_loss": 0.5478160977363586,
                    "features_accuracy": [
                        0.7823191285133362,
                        0.7069330811500549,
                        0.7356948256492615,
                        0.6702997088432312,
                        0.6854375004768372,
                        0.6860429644584656,
                        0.7696033716201782,
                        0.7823191285133362
                    ]
                },
                "test": {
                    "score": -0.45482410819817787,
                    "pretrain_loss": 0.5529958605766296,
                    "features_accuracy": [
                        0.7701066136360168,
                        0.6901647448539734,
                        0.7354651093482971,
                        0.6722383499145508,
                        0.6741763353347778,
                        0.7083333134651184,
                        0.7676841020584106,
                        0.7839147448539734
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -0.3938796073318429,
                    "pretrain_loss": 0.540838360786438,
                    "features_accuracy": [
                        0.7684155106544495,
                        0.7124688029289246,
                        0.7331365346908569,
                        0.6802180409431458,
                        0.6727988719940186,
                        0.7055038213729858,
                        0.7782572507858276,
                        0.7987735867500305
                    ]
                },
                "val": {
                    "score": -0.45476510248257673,
                    "pretrain_loss": 0.5490388870239258,
                    "features_accuracy": [
                        0.7780805230140686,
                        0.7099606394767761,
                        0.7375113368034363,
                        0.667574942111969,
                        0.6793823838233948,
                        0.6860429644584656,
                        0.7659703493118286,
                        0.7835301160812378
                    ]
                },
                "test": {
                    "score": -0.44493012414210115,
                    "pretrain_loss": 0.5518665313720703,
                    "features_accuracy": [
                        0.7618701457977295,
                        0.7044573426246643,
                        0.7323158979415894,
                        0.6681201457977295,
                        0.6729651093482971,
                        0.711240291595459,
                        0.7657461166381836,
                        0.7797964811325073
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -0.37825049629324825,
                    "pretrain_loss": 0.5388627052307129,
                    "features_accuracy": [
                        0.7738663554191589,
                        0.7046710848808289,
                        0.7341207265853882,
                        0.68036949634552,
                        0.6772655248641968,
                        0.7094405293464661,
                        0.7821939587593079,
                        0.800741970539093
                    ]
                },
                "val": {
                    "score": -0.4460776538825563,
                    "pretrain_loss": 0.5469262599945068,
                    "features_accuracy": [
                        0.7832273840904236,
                        0.7135937213897705,
                        0.7353920936584473,
                        0.669996976852417,
                        0.6790796518325806,
                        0.6854375004768372,
                        0.7605207562446594,
                        0.7901907563209534
                    ]
                },
                "test": {
                    "score": -0.44177128647291375,
                    "pretrain_loss": 0.5455726385116577,
                    "features_accuracy": [
                        0.7686530947685242,
                        0.707848846912384,
                        0.7412790656089783,
                        0.6703003644943237,
                        0.6736918687820435,
                        0.7109980583190918,
                        0.7655038833618164,
                        0.7817344665527344
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": -0.33701009602128223,
                    "pretrain_loss": 0.5327717065811157,
                    "features_accuracy": [
                        0.7731092572212219,
                        0.7127715945243835,
                        0.7407827973365784,
                        0.688924252986908,
                        0.6723446249961853,
                        0.7107275724411011,
                        0.7927170991897583,
                        0.80422443151474
                    ]
                },
                "val": {
                    "score": -0.443847735766686,
                    "pretrain_loss": 0.5422316789627075,
                    "features_accuracy": [
                        0.783832848072052,
                        0.7078413367271423,
                        0.7405388951301575,
                        0.6718134880065918,
                        0.6811988949775696,
                        0.6936118602752686,
                        0.7726309299468994,
                        0.7947320342063904
                    ]
                },
                "test": {
                    "score": -0.4496467591860499,
                    "pretrain_loss": 0.5452935099601746,
                    "features_accuracy": [
                        0.7698643207550049,
                        0.7032461166381836,
                        0.7374030947685242,
                        0.6761143207550049,
                        0.6768410801887512,
                        0.7061530947685242,
                        0.78125,
                        0.7955426573753357
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": -0.36766440223973584,
                    "pretrain_loss": 0.5214173197746277,
                    "features_accuracy": [
                        0.7817397713661194,
                        0.715572714805603,
                        0.7530471682548523,
                        0.6895298957824707,
                        0.6752971410751343,
                        0.7164055109024048,
                        0.805587112903595,
                        0.8143690228462219
                    ]
                },
                "val": {
                    "score": -0.4481504975108316,
                    "pretrain_loss": 0.5388298034667969,
                    "features_accuracy": [
                        0.7907962203025818,
                        0.7093551158905029,
                        0.7462912201881409,
                        0.6712079644203186,
                        0.6854375004768372,
                        0.6927036046981812,
                        0.771722674369812,
                        0.8029064536094666
                    ]
                },
                "test": {
                    "score": -0.44094065448938563,
                    "pretrain_loss": 0.5417509078979492,
                    "features_accuracy": [
                        0.7785852551460266,
                        0.705910861492157,
                        0.7376453280448914,
                        0.6724806427955627,
                        0.6770833134651184,
                        0.7109980583190918,
                        0.7795542478561401,
                        0.7892441749572754
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": -0.31732256416963867,
                    "pretrain_loss": 0.5342309474945068,
                    "features_accuracy": [
                        0.7715194225311279,
                        0.7139071822166443,
                        0.7419183850288391,
                        0.6727988719940186,
                        0.678249716758728,
                        0.7045953869819641,
                        0.7901431322097778,
                        0.8055114150047302
                    ]
                },
                "val": {
                    "score": -0.4417843485403829,
                    "pretrain_loss": 0.5360909104347229,
                    "features_accuracy": [
                        0.798667848110199,
                        0.7163184881210327,
                        0.7420526742935181,
                        0.6733272671699524,
                        0.6830154657363892,
                        0.6936118602752686,
                        0.7808053493499756,
                        0.8050257563591003
                    ]
                },
                "test": {
                    "score": -0.4362983279830766,
                    "pretrain_loss": 0.5400627255439758,
                    "features_accuracy": [
                        0.7720445990562439,
                        0.7102712988853455,
                        0.7468507885932922,
                        0.6741763353347778,
                        0.6770833134651184,
                        0.7126938104629517,
                        0.779312014579773,
                        0.7906976938247681
                    ]
                }
            },
            "80000": {
                "train": {
                    "score": -0.3357164254616981,
                    "pretrain_loss": 0.5268760919570923,
                    "features_accuracy": [
                        0.7770459651947021,
                        0.7133015394210815,
                        0.7467635869979858,
                        0.6842304468154907,
                        0.6827163696289062,
                        0.7116360068321228,
                        0.8017261028289795,
                        0.8055114150047302
                    ]
                },
                "val": {
                    "score": -0.4459585803278339,
                    "pretrain_loss": 0.5342405438423157,
                    "features_accuracy": [
                        0.7880714535713196,
                        0.7135937213897705,
                        0.7484105229377747,
                        0.6739327907562256,
                        0.6854375004768372,
                        0.6981531977653503,
                        0.778988778591156,
                        0.8053284883499146
                    ]
                },
                "test": {
                    "score": -0.433786601050624,
                    "pretrain_loss": 0.5363003015518188,
                    "features_accuracy": [
                        0.7781007885932922,
                        0.7017926573753357,
                        0.7458817958831787,
                        0.6768410801887512,
                        0.6763566136360168,
                        0.7085756063461304,
                        0.7827034592628479,
                        0.8006298542022705
                    ]
                }
            },
            "90000": {
                "train": {
                    "score": -0.32076069797891876,
                    "pretrain_loss": 0.5205117464065552,
                    "features_accuracy": [
                        0.7788628935813904,
                        0.7244303226470947,
                        0.7435839176177979,
                        0.6858202815055847,
                        0.685441792011261,
                        0.7135286927223206,
                        0.8089181780815125,
                        0.8210311532020569
                    ]
                },
                "val": {
                    "score": -0.4392521060657825,
                    "pretrain_loss": 0.5331866145133972,
                    "features_accuracy": [
                        0.7932182550430298,
                        0.7190433144569397,
                        0.7420526742935181,
                        0.6784741282463074,
                        0.6854375004768372,
                        0.7014834880828857,
                        0.7847411632537842,
                        0.803814709186554
                    ]
                },
                "test": {
                    "score": -0.43665599952851375,
                    "pretrain_loss": 0.5366561412811279,
                    "features_accuracy": [
                        0.7797964811325073,
                        0.7063953280448914,
                        0.7466084957122803,
                        0.6744186282157898,
                        0.680232584476471,
                        0.7083333134651184,
                        0.7848837375640869,
                        0.8008720874786377
                    ]
                }
            },
            "100000": {
                "train": {
                    "score": -0.324546139699686,
                    "pretrain_loss": 0.5140734314918518,
                    "features_accuracy": [
                        0.7831781506538391,
                        0.7320009469985962,
                        0.7463850378990173,
                        0.6919524669647217,
                        0.6884700059890747,
                        0.717162549495697,
                        0.8092210292816162,
                        0.8255735039710999
                    ]
                },
                "val": {
                    "score": -0.4380398024992199,
                    "pretrain_loss": 0.5305204391479492,
                    "features_accuracy": [
                        0.791704535484314,
                        0.7172267436981201,
                        0.7481077909469604,
                        0.6727217435836792,
                        0.6842264533042908,
                        0.6954283714294434,
                        0.7862549424171448,
                        0.806236743927002
                    ]
                },
                "test": {
                    "score": -0.43059540262424084,
                    "pretrain_loss": 0.5306791663169861,
                    "features_accuracy": [
                        0.7764050364494324,
                        0.7151162624359131,
                        0.7468507885932922,
                        0.6787790656089783,
                        0.6841084957122803,
                        0.7146317958831787,
                        0.7897287011146545,
                        0.8035368323326111
                    ]
                }
            }
        },
        "train": {
            "score": -0.324546139699686
        },
        "val": {
            "score": -0.4380398024992199
        },
        "test": {
            "score": -0.43059540262424084
        }
    },
    "best_iteration": 100000,
    "time": "0:38:08"
}
