{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask___23ebee2d278a465cab387c02e8244632.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 6,
        "data": {
            "path": "data/california",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "transformer",
            "config": {
                "n_blocks": 4,
                "attention_dropout": 0.006835950215068107,
                "ffn_dropout": 0.14201787610318556,
                "ffn_d_hidden": 695
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear"
            ],
            "d_num_embedding": 512,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.00031363259431556616,
            "weight_decay": 4.8674309203267864e-05,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.33783618095960377,
            "corrupt_strategy": "target_resample",
            "d_hidden_head": 512,
            "lr": 0.00031363259431556616,
            "weight_decay": 4.8674309203267864e-05,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": true,
            "early_stop_type": "finetune",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "epoch_size": 104,
    "n_parameters": 8759737,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -0.36986605702635883,
                    "pretrain_loss": 0.5550092458724976,
                    "features_accuracy": [
                        0.7650087475776672,
                        0.7036111950874329,
                        0.724884569644928,
                        0.679839551448822,
                        0.6778711676597595,
                        0.6914225220680237,
                        0.762661874294281,
                        0.7739420533180237
                    ]
                },
                "val": {
                    "score": -0.45298160905851775,
                    "pretrain_loss": 0.5587465763092041,
                    "features_accuracy": [
                        0.7738419771194458,
                        0.6902815699577332,
                        0.7220708131790161,
                        0.6787768602371216,
                        0.6790796518325806,
                        0.6933091282844543,
                        0.7456857562065125,
                        0.7683923840522766
                    ]
                },
                "test": {
                    "score": -0.44217160536261335,
                    "pretrain_loss": 0.5626875162124634,
                    "features_accuracy": [
                        0.7565407156944275,
                        0.7017926573753357,
                        0.7337693572044373,
                        0.6739341020584106,
                        0.6642441749572754,
                        0.6865310072898865,
                        0.7449128031730652,
                        0.7720445990562439
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -0.3652940611474936,
                    "pretrain_loss": 0.5478841662406921,
                    "features_accuracy": [
                        0.7692482471466064,
                        0.7073965072631836,
                        0.7366946935653687,
                        0.682792067527771,
                        0.6850632429122925,
                        0.7041411399841309,
                        0.7670527696609497,
                        0.7817397713661194
                    ]
                },
                "val": {
                    "score": -0.4548701776459638,
                    "pretrain_loss": 0.5565834045410156,
                    "features_accuracy": [
                        0.7774749994277954,
                        0.6863457560539246,
                        0.7326672673225403,
                        0.679987907409668,
                        0.6730245351791382,
                        0.6930063366889954,
                        0.7514380812644958,
                        0.7683923840522766
                    ]
                },
                "test": {
                    "score": -0.45000626531105775,
                    "pretrain_loss": 0.5564928650856018,
                    "features_accuracy": [
                        0.7642926573753357,
                        0.7068798542022705,
                        0.7352228760719299,
                        0.6785368323326111,
                        0.6623061895370483,
                        0.6918604373931885,
                        0.7524224519729614,
                        0.7776162624359131
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -0.43822439925536866,
                    "pretrain_loss": 0.5406283736228943,
                    "features_accuracy": [
                        0.768794059753418,
                        0.7079264521598816,
                        0.7388144731521606,
                        0.6824135184288025,
                        0.676129937171936,
                        0.7104247212409973,
                        0.7772731184959412,
                        0.7974866032600403
                    ]
                },
                "val": {
                    "score": -0.4681163948563483,
                    "pretrain_loss": 0.5550796985626221,
                    "features_accuracy": [
                        0.7726309299468994,
                        0.6857402324676514,
                        0.7359975576400757,
                        0.6778686046600342,
                        0.6787768602371216,
                        0.6933091282844543,
                        0.7611262202262878,
                        0.7811080813407898
                    ]
                },
                "test": {
                    "score": -0.4638867028899845,
                    "pretrain_loss": 0.557890772819519,
                    "features_accuracy": [
                        0.7601743936538696,
                        0.6962209343910217,
                        0.7330426573753357,
                        0.6736918687820435,
                        0.661821722984314,
                        0.6896802186965942,
                        0.7507267594337463,
                        0.7834302186965942
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -0.3937377777337119,
                    "pretrain_loss": 0.5393921732902527,
                    "features_accuracy": [
                        0.7726550102233887,
                        0.7028541564941406,
                        0.7322280406951904,
                        0.6818835735321045,
                        0.6762813329696655,
                        0.7083049416542053,
                        0.7781058549880981,
                        0.7979408502578735
                    ]
                },
                "val": {
                    "score": -0.4509856076882223,
                    "pretrain_loss": 0.5499944090843201,
                    "features_accuracy": [
                        0.776566743850708,
                        0.6890705227851868,
                        0.7272176742553711,
                        0.682107150554657,
                        0.6790796518325806,
                        0.6902815699577332,
                        0.7656675577163696,
                        0.7932182550430298
                    ]
                },
                "test": {
                    "score": -0.442549656693568,
                    "pretrain_loss": 0.5530710220336914,
                    "features_accuracy": [
                        0.7640503644943237,
                        0.7068798542022705,
                        0.7374030947685242,
                        0.6780523061752319,
                        0.6608527302742004,
                        0.693071722984314,
                        0.7650193572044373,
                        0.7805232405662537
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": -0.38058875596019426,
                    "pretrain_loss": 0.5301492214202881,
                    "features_accuracy": [
                        0.7759860754013062,
                        0.712620198726654,
                        0.7423726320266724,
                        0.6839276552200317,
                        0.6799909472465515,
                        0.7105004191398621,
                        0.7941555380821228,
                        0.8043001294136047
                    ]
                },
                "val": {
                    "score": -0.443227248876173,
                    "pretrain_loss": 0.5442113280296326,
                    "features_accuracy": [
                        0.779291570186615,
                        0.6927036046981812,
                        0.7393279075622559,
                        0.6842264533042908,
                        0.6805933713912964,
                        0.694520115852356,
                        0.7762640118598938,
                        0.791401743888855
                    ]
                },
                "test": {
                    "score": -0.4362176067142072,
                    "pretrain_loss": 0.5467509627342224,
                    "features_accuracy": [
                        0.7696220874786377,
                        0.7124515771865845,
                        0.7434592843055725,
                        0.6804748177528381,
                        0.6652131676673889,
                        0.6964631676673889,
                        0.7715600728988647,
                        0.7880329489707947
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": -0.35219253987664423,
                    "pretrain_loss": 0.5221127271652222,
                    "features_accuracy": [
                        0.7937012910842896,
                        0.7144371271133423,
                        0.7470664381980896,
                        0.6853660345077515,
                        0.683851957321167,
                        0.7145128846168518,
                        0.8057385683059692,
                        0.8112650513648987
                    ]
                },
                "val": {
                    "score": -0.43828389160167497,
                    "pretrain_loss": 0.5438695549964905,
                    "features_accuracy": [
                        0.7829245924949646,
                        0.6930063366889954,
                        0.7426581978797913,
                        0.6833181977272034,
                        0.6760520935058594,
                        0.692098081111908,
                        0.7762640118598938,
                        0.7977595925331116
                    ]
                },
                "test": {
                    "score": -0.44629063346314424,
                    "pretrain_loss": 0.5439969897270203,
                    "features_accuracy": [
                        0.773740291595459,
                        0.7063953280448914,
                        0.7451550364494324,
                        0.6787790656089783,
                        0.6589147448539734,
                        0.7066376209259033,
                        0.7805232405662537,
                        0.7933623790740967
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": -0.3323102954463879,
                    "pretrain_loss": 0.5306501984596252,
                    "features_accuracy": [
                        0.7775759100914001,
                        0.7160269618034363,
                        0.7390415668487549,
                        0.6890756487846375,
                        0.6837005019187927,
                        0.7145885825157166,
                        0.7937769889831543,
                        0.8017261028289795
                    ]
                },
                "val": {
                    "score": -0.43400776273722025,
                    "pretrain_loss": 0.5385554432868958,
                    "features_accuracy": [
                        0.7880714535713196,
                        0.6905843019485474,
                        0.7369058132171631,
                        0.6811988949775696,
                        0.6805933713912964,
                        0.7078413367271423,
                        0.791401743888855,
                        0.8041174411773682
                    ]
                },
                "test": {
                    "score": -0.4320502123850525,
                    "pretrain_loss": 0.5410431623458862,
                    "features_accuracy": [
                        0.7749515771865845,
                        0.7143895030021667,
                        0.7386143207550049,
                        0.6845930218696594,
                        0.6700581312179565,
                        0.6996123790740967,
                        0.7742248177528381,
                        0.7972383499145508
                    ]
                }
            },
            "80000": {
                "train": {
                    "score": -0.31484020756309433,
                    "pretrain_loss": 0.524770200252533,
                    "features_accuracy": [
                        0.7827239036560059,
                        0.7226890921592712,
                        0.7448709607124329,
                        0.680142343044281,
                        0.6752214431762695,
                        0.7153456211090088,
                        0.7990764379501343,
                        0.8107351064682007
                    ]
                },
                "val": {
                    "score": -0.4348472297789304,
                    "pretrain_loss": 0.5372685194015503,
                    "features_accuracy": [
                        0.7850438952445984,
                        0.6927036046981812,
                        0.744777500629425,
                        0.679987907409668,
                        0.6854375004768372,
                        0.7042083144187927,
                        0.7832273840904236,
                        0.801392674446106
                    ]
                },
                "test": {
                    "score": -0.43667530490330686,
                    "pretrain_loss": 0.5373817682266235,
                    "features_accuracy": [
                        0.7785852551460266,
                        0.7214147448539734,
                        0.7449128031730652,
                        0.6816860437393188,
                        0.6695736646652222,
                        0.7015503644943237,
                        0.7795542478561401,
                        0.8008720874786377
                    ]
                }
            },
            "90000": {
                "train": {
                    "score": -0.3222636871349702,
                    "pretrain_loss": 0.5177718997001648,
                    "features_accuracy": [
                        0.7867363691329956,
                        0.7164055109024048,
                        0.7534257173538208,
                        0.6908168792724609,
                        0.6846089959144592,
                        0.7064880132675171,
                        0.8058899641036987,
                        0.8184571266174316
                    ]
                },
                "val": {
                    "score": -0.43487907721385216,
                    "pretrain_loss": 0.5351983904838562,
                    "features_accuracy": [
                        0.7850438952445984,
                        0.7014834880828857,
                        0.7453829646110535,
                        0.6811988949775696,
                        0.6830154657363892,
                        0.7081441283226013,
                        0.7808053493499756,
                        0.8007871508598328
                    ]
                },
                "test": {
                    "score": -0.42453286694786596,
                    "pretrain_loss": 0.5349608659744263,
                    "features_accuracy": [
                        0.7805232405662537,
                        0.7148740291595459,
                        0.7461240291595459,
                        0.6797480583190918,
                        0.6656976938247681,
                        0.7076066136360168,
                        0.7882751822471619,
                        0.7955426573753357
                    ]
                }
            },
            "100000": {
                "train": {
                    "score": -0.29314714600471375,
                    "pretrain_loss": 0.5083072185516357,
                    "features_accuracy": [
                        0.7851465344429016,
                        0.7265501022338867,
                        0.754182755947113,
                        0.6932395100593567,
                        0.6855174899101257,
                        0.7246574759483337,
                        0.8145204186439514,
                        0.8280717730522156
                    ]
                },
                "val": {
                    "score": -0.4377957148466498,
                    "pretrain_loss": 0.532276451587677,
                    "features_accuracy": [
                        0.7883741855621338,
                        0.6999697089195251,
                        0.7441719770431519,
                        0.6857402324676514,
                        0.6811988949775696,
                        0.7048137784004211,
                        0.7862549424171448,
                        0.8095670342445374
                    ]
                },
                "test": {
                    "score": -0.4330738469355752,
                    "pretrain_loss": 0.5299038887023926,
                    "features_accuracy": [
                        0.7766472697257996,
                        0.7197189927101135,
                        0.7468507885932922,
                        0.6821705102920532,
                        0.6666666865348816,
                        0.7071220874786377,
                        0.7843992114067078,
                        0.8086240291595459
                    ]
                }
            }
        },
        "train": {
            "score": -0.3323102954463879
        },
        "val": {
            "score": -0.43400776273722025
        },
        "test": {
            "score": -0.4320502123850525
        }
    },
    "best_iteration": 70000,
    "time": "0:38:32"
}
