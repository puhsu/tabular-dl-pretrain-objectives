{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask___23ebee2d278a465cab387c02e8244632.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 11,
        "data": {
            "path": "data/california",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "transformer",
            "config": {
                "n_blocks": 4,
                "attention_dropout": 0.006835950215068107,
                "ffn_dropout": 0.14201787610318556,
                "ffn_d_hidden": 695
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear"
            ],
            "d_num_embedding": 512,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.00031363259431556616,
            "weight_decay": 4.8674309203267864e-05,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.33783618095960377,
            "corrupt_strategy": "target_resample",
            "d_hidden_head": 512,
            "lr": 0.00031363259431556616,
            "weight_decay": 4.8674309203267864e-05,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": true,
            "early_stop_type": "finetune",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "epoch_size": 104,
    "n_parameters": 8759737,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -0.40494879482321255,
                    "pretrain_loss": 0.5568963885307312,
                    "features_accuracy": [
                        0.7586494088172913,
                        0.6973276138305664,
                        0.7191309332847595,
                        0.6752971410751343,
                        0.6770384311676025,
                        0.6972519159317017,
                        0.7614505290985107,
                        0.7713680267333984
                    ]
                },
                "val": {
                    "score": -0.4590349453482891,
                    "pretrain_loss": 0.5602338910102844,
                    "features_accuracy": [
                        0.7677868604660034,
                        0.6954283714294434,
                        0.7369058132171631,
                        0.677263081073761,
                        0.667574942111969,
                        0.6884650588035583,
                        0.7550711631774902,
                        0.766575813293457
                    ]
                },
                "test": {
                    "score": -0.45443736445943955,
                    "pretrain_loss": 0.5606642365455627,
                    "features_accuracy": [
                        0.7531492114067078,
                        0.7049418687820435,
                        0.7344961166381836,
                        0.6518895030021667,
                        0.6719961166381836,
                        0.6833817958831787,
                        0.7645348906517029,
                        0.7718023061752319
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -0.43107664769038284,
                    "pretrain_loss": 0.5424596667289734,
                    "features_accuracy": [
                        0.7660686373710632,
                        0.7071693539619446,
                        0.7421455383300781,
                        0.677492618560791,
                        0.6749943494796753,
                        0.7076992988586426,
                        0.7756075859069824,
                        0.7953668236732483
                    ]
                },
                "val": {
                    "score": -0.4617947412547703,
                    "pretrain_loss": 0.5538278818130493,
                    "features_accuracy": [
                        0.7662730813026428,
                        0.6981531977653503,
                        0.7356948256492615,
                        0.6760520935058594,
                        0.667574942111969,
                        0.694520115852356,
                        0.7650620341300964,
                        0.7795943021774292
                    ]
                },
                "test": {
                    "score": -0.45590702834112257,
                    "pretrain_loss": 0.5557084083557129,
                    "features_accuracy": [
                        0.7526647448539734,
                        0.7076066136360168,
                        0.7277131676673889,
                        0.6547964811325073,
                        0.6744186282157898,
                        0.6848352551460266,
                        0.7751938104629517,
                        0.7851259708404541
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -0.3833503586825429,
                    "pretrain_loss": 0.5403769016265869,
                    "features_accuracy": [
                        0.7785601019859314,
                        0.7020213603973389,
                        0.7385116219520569,
                        0.6802180409431458,
                        0.6735559105873108,
                        0.7021727561950684,
                        0.7817397713661194,
                        0.7900674343109131
                    ]
                },
                "val": {
                    "score": -0.44628294286605613,
                    "pretrain_loss": 0.5516675710678101,
                    "features_accuracy": [
                        0.7753557562828064,
                        0.7002725005149841,
                        0.7347865700721741,
                        0.6690887212753296,
                        0.6727217435836792,
                        0.7014834880828857,
                        0.761731743812561,
                        0.783832848072052
                    ]
                },
                "test": {
                    "score": -0.43750274918780185,
                    "pretrain_loss": 0.5531901121139526,
                    "features_accuracy": [
                        0.7577519416809082,
                        0.7051841020584106,
                        0.7325581312179565,
                        0.6480135917663574,
                        0.6749030947685242,
                        0.6843507885932922,
                        0.773982584476471,
                        0.7928779125213623
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -0.40582408926776425,
                    "pretrain_loss": 0.530615508556366,
                    "features_accuracy": [
                        0.7757589817047119,
                        0.7129230499267578,
                        0.7478991746902466,
                        0.6780982613563538,
                        0.679309606552124,
                        0.7164812088012695,
                        0.7890832424163818,
                        0.7977893948554993
                    ]
                },
                "val": {
                    "score": -0.44986715084254375,
                    "pretrain_loss": 0.5464028120040894,
                    "features_accuracy": [
                        0.7759612202644348,
                        0.6996669769287109,
                        0.7359975576400757,
                        0.6721162796020508,
                        0.6706025004386902,
                        0.6990614533424377,
                        0.7720254063606262,
                        0.7874659299850464
                    ]
                },
                "test": {
                    "score": -0.4424503655632655,
                    "pretrain_loss": 0.5464878082275391,
                    "features_accuracy": [
                        0.7560561895370483,
                        0.7134205102920532,
                        0.7366763353347778,
                        0.6584302186965942,
                        0.6756298542022705,
                        0.6887112259864807,
                        0.7863371968269348,
                        0.7962693572044373
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": -0.3374600340355537,
                    "pretrain_loss": 0.5294169783592224,
                    "features_accuracy": [
                        0.7736392021179199,
                        0.7167083024978638,
                        0.7468392848968506,
                        0.6882429122924805,
                        0.678552508354187,
                        0.7073965072631836,
                        0.7930199503898621,
                        0.806647002696991
                    ]
                },
                "val": {
                    "score": -0.4430400929681223,
                    "pretrain_loss": 0.5432974100112915,
                    "features_accuracy": [
                        0.7808053493499756,
                        0.7054193019866943,
                        0.7320617437362671,
                        0.6718134880065918,
                        0.6760520935058594,
                        0.6948229074478149,
                        0.776869535446167,
                        0.7877687215805054
                    ]
                },
                "test": {
                    "score": -0.44241432222463417,
                    "pretrain_loss": 0.5471162796020508,
                    "features_accuracy": [
                        0.7681686282157898,
                        0.7107558250427246,
                        0.7332848906517029,
                        0.6574612259864807,
                        0.6703003644943237,
                        0.6841084957122803,
                        0.7860949635505676,
                        0.7999030947685242
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": -0.3657762229703601,
                    "pretrain_loss": 0.5167869925498962,
                    "features_accuracy": [
                        0.7846165895462036,
                        0.7234461307525635,
                        0.75493985414505,
                        0.6858959794044495,
                        0.6781740188598633,
                        0.7192066311836243,
                        0.8059656620025635,
                        0.8212582468986511
                    ]
                },
                "val": {
                    "score": -0.44126815973141664,
                    "pretrain_loss": 0.5419362783432007,
                    "features_accuracy": [
                        0.7820163369178772,
                        0.7011807560920715,
                        0.7450802326202393,
                        0.677263081073761,
                        0.6739327907562256,
                        0.7017862796783447,
                        0.7747502326965332,
                        0.7953375577926636
                    ]
                },
                "test": {
                    "score": -0.4339341317901956,
                    "pretrain_loss": 0.5409082174301147,
                    "features_accuracy": [
                        0.7621123790740967,
                        0.7124515771865845,
                        0.7415212988853455,
                        0.661821722984314,
                        0.6787790656089783,
                        0.6913759708404541,
                        0.7882751822471619,
                        0.8035368323326111
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": -0.31716866538140615,
                    "pretrain_loss": 0.5308688879013062,
                    "features_accuracy": [
                        0.7744719982147217,
                        0.7124688029289246,
                        0.7475206255912781,
                        0.6788553595542908,
                        0.684381902217865,
                        0.7175410985946655,
                        0.7918086647987366,
                        0.8038458824157715
                    ]
                },
                "val": {
                    "score": -0.4392083285334086,
                    "pretrain_loss": 0.5390834212303162,
                    "features_accuracy": [
                        0.7808053493499756,
                        0.7090523838996887,
                        0.7481077909469604,
                        0.677263081073761,
                        0.6727217435836792,
                        0.6999697089195251,
                        0.781410813331604,
                        0.7974568605422974
                    ]
                },
                "test": {
                    "score": -0.43885742510484976,
                    "pretrain_loss": 0.5382846593856812,
                    "features_accuracy": [
                        0.7616279125213623,
                        0.7228682041168213,
                        0.748062014579773,
                        0.6577034592628479,
                        0.6763566136360168,
                        0.6962209343910217,
                        0.7965116500854492,
                        0.8020833134651184
                    ]
                }
            },
            "80000": {
                "train": {
                    "score": -0.31764746774493996,
                    "pretrain_loss": 0.5215686559677124,
                    "features_accuracy": [
                        0.7846922874450684,
                        0.716859757900238,
                        0.7475206255912781,
                        0.685971736907959,
                        0.6804451942443848,
                        0.7197365760803223,
                        0.802634596824646,
                        0.8137633800506592
                    ]
                },
                "val": {
                    "score": -0.43536436972968867,
                    "pretrain_loss": 0.5358451008796692,
                    "features_accuracy": [
                        0.7835301160812378,
                        0.7081441283226013,
                        0.7502270340919495,
                        0.6751437783241272,
                        0.6733272671699524,
                        0.6966394186019897,
                        0.7811080813407898,
                        0.8019981980323792
                    ]
                },
                "test": {
                    "score": -0.4356304615760428,
                    "pretrain_loss": 0.5348123908042908,
                    "features_accuracy": [
                        0.7662306427955627,
                        0.7209302186965942,
                        0.7437015771865845,
                        0.6574612259864807,
                        0.6812015771865845,
                        0.6976743936538696,
                        0.7953003644943237,
                        0.804990291595459
                    ]
                }
            },
            "90000": {
                "train": {
                    "score": -0.28195960136881476,
                    "pretrain_loss": 0.5114844441413879,
                    "features_accuracy": [
                        0.7820425629615784,
                        0.7344992160797119,
                        0.756302535533905,
                        0.6920281648635864,
                        0.6843062043190002,
                        0.7251874208450317,
                        0.8092210292816162,
                        0.8231509327888489
                    ]
                },
                "val": {
                    "score": -0.43368854330792583,
                    "pretrain_loss": 0.5326958298683167,
                    "features_accuracy": [
                        0.7835301160812378,
                        0.7132909297943115,
                        0.7487133145332336,
                        0.6787768602371216,
                        0.6763548254966736,
                        0.7039055228233337,
                        0.7877687215805054,
                        0.8059340119361877
                    ]
                },
                "test": {
                    "score": -0.4294614893970215,
                    "pretrain_loss": 0.5341193675994873,
                    "features_accuracy": [
                        0.7696220874786377,
                        0.7194767594337463,
                        0.7453972697257996,
                        0.661821722984314,
                        0.6753876209259033,
                        0.695009708404541,
                        0.7984496355056763,
                        0.8078972697257996
                    ]
                }
            },
            "100000": {
                "train": {
                    "score": -0.30695658463488595,
                    "pretrain_loss": 0.5090273022651672,
                    "features_accuracy": [
                        0.7885532975196838,
                        0.7229162454605103,
                        0.7545613050460815,
                        0.6958891749382019,
                        0.685971736907959,
                        0.7290483713150024,
                        0.8175486922264099,
                        0.8279960751533508
                    ]
                },
                "val": {
                    "score": -0.43688459852317685,
                    "pretrain_loss": 0.5293657779693604,
                    "features_accuracy": [
                        0.7904934883117676,
                        0.7102633714675903,
                        0.747199535369873,
                        0.6766575574874878,
                        0.6721162796020508,
                        0.7060248255729675,
                        0.781410813331604,
                        0.8098698258399963
                    ]
                },
                "test": {
                    "score": -0.42096384459246283,
                    "pretrain_loss": 0.5302203893661499,
                    "features_accuracy": [
                        0.7730135917663574,
                        0.7194767594337463,
                        0.75,
                        0.6652131676673889,
                        0.6821705102920532,
                        0.7034883499145508,
                        0.799660861492157,
                        0.8127422332763672
                    ]
                }
            }
        },
        "train": {
            "score": -0.28195960136881476
        },
        "val": {
            "score": -0.43368854330792583
        },
        "test": {
            "score": -0.4294614893970215
        }
    },
    "best_iteration": 90000,
    "time": "0:35:41"
}
