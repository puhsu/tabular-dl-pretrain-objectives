{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask___23ebee2d278a465cab387c02e8244632.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 7,
        "data": {
            "path": "data/california",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "transformer",
            "config": {
                "n_blocks": 4,
                "attention_dropout": 0.006835950215068107,
                "ffn_dropout": 0.14201787610318556,
                "ffn_d_hidden": 695
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear"
            ],
            "d_num_embedding": 512,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.00031363259431556616,
            "weight_decay": 4.8674309203267864e-05,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.33783618095960377,
            "corrupt_strategy": "target_resample",
            "d_hidden_head": 512,
            "lr": 0.00031363259431556616,
            "weight_decay": 4.8674309203267864e-05,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": true,
            "early_stop_type": "finetune",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "epoch_size": 104,
    "n_parameters": 8759737,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -0.39579240695490286,
                    "pretrain_loss": 0.5553367733955383,
                    "features_accuracy": [
                        0.7627375721931458,
                        0.6951321363449097,
                        0.7318494915962219,
                        0.6778711676597595,
                        0.6655310988426208,
                        0.6977061033248901,
                        0.7623590230941772,
                        0.7755318880081177
                    ]
                },
                "val": {
                    "score": -0.4579381427822931,
                    "pretrain_loss": 0.5599538087844849,
                    "features_accuracy": [
                        0.7605207562446594,
                        0.7017862796783447,
                        0.7160157561302185,
                        0.6693914532661438,
                        0.6733272671699524,
                        0.6933091282844543,
                        0.7535573840141296,
                        0.771722674369812
                    ]
                },
                "test": {
                    "score": -0.455149737657855,
                    "pretrain_loss": 0.5599632263183594,
                    "features_accuracy": [
                        0.757267415523529,
                        0.6916182041168213,
                        0.7403100728988647,
                        0.6676356792449951,
                        0.6698158979415894,
                        0.6979166865348816,
                        0.7512112259864807,
                        0.7701066136360168
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -0.34665961311108645,
                    "pretrain_loss": 0.5425111055374146,
                    "features_accuracy": [
                        0.7725793123245239,
                        0.7086834907531738,
                        0.7390415668487549,
                        0.6799909472465515,
                        0.6763570308685303,
                        0.7021727561950684,
                        0.7671285271644592,
                        0.7915058135986328
                    ]
                },
                "val": {
                    "score": -0.4475534893116465,
                    "pretrain_loss": 0.5541555285453796,
                    "features_accuracy": [
                        0.7705116271972656,
                        0.7029972672462463,
                        0.7196487784385681,
                        0.667574942111969,
                        0.6760520935058594,
                        0.7005752325057983,
                        0.766575813293457,
                        0.778988778591156
                    ]
                },
                "test": {
                    "score": -0.4501974134259484,
                    "pretrain_loss": 0.5534802675247192,
                    "features_accuracy": [
                        0.7664728760719299,
                        0.6979166865348816,
                        0.731589138507843,
                        0.669089138507843,
                        0.6734496355056763,
                        0.693071722984314,
                        0.7647771239280701,
                        0.7827034592628479
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -0.38738442155932457,
                    "pretrain_loss": 0.5402979254722595,
                    "features_accuracy": [
                        0.7753804326057434,
                        0.7100462317466736,
                        0.7416912913322449,
                        0.6762056350708008,
                        0.6768112778663635,
                        0.7082292437553406,
                        0.7844651937484741,
                        0.7924900054931641
                    ]
                },
                "val": {
                    "score": -0.44754642585934434,
                    "pretrain_loss": 0.551592230796814,
                    "features_accuracy": [
                        0.7696033716201782,
                        0.7057220935821533,
                        0.7157129645347595,
                        0.6702997088432312,
                        0.679685115814209,
                        0.6987587213516235,
                        0.7635483145713806,
                        0.7874659299850464
                    ]
                },
                "test": {
                    "score": -0.43559495980011703,
                    "pretrain_loss": 0.5510454773902893,
                    "features_accuracy": [
                        0.7650193572044373,
                        0.7034883499145508,
                        0.7369186282157898,
                        0.6710271239280701,
                        0.6719961166381836,
                        0.6933139562606812,
                        0.7635658979415894,
                        0.7873061895370483
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -0.4071581145442279,
                    "pretrain_loss": 0.5350525379180908,
                    "features_accuracy": [
                        0.7828753590583801,
                        0.7119388580322266,
                        0.7441138625144958,
                        0.676129937171936,
                        0.6846089959144592,
                        0.7053524255752563,
                        0.7843894362449646,
                        0.7987735867500305
                    ]
                },
                "val": {
                    "score": -0.4566902908691778,
                    "pretrain_loss": 0.5478611588478088,
                    "features_accuracy": [
                        0.7750529646873474,
                        0.7120799422264099,
                        0.7281259298324585,
                        0.6645473837852478,
                        0.672419011592865,
                        0.6987587213516235,
                        0.766575813293457,
                        0.7923099994659424
                    ]
                },
                "test": {
                    "score": -0.44247728840702905,
                    "pretrain_loss": 0.5480021834373474,
                    "features_accuracy": [
                        0.7655038833618164,
                        0.7020348906517029,
                        0.7429748177528381,
                        0.6732073426246643,
                        0.6712693572044373,
                        0.6967054009437561,
                        0.7679263353347778,
                        0.7926356792449951
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": -0.38358184154490027,
                    "pretrain_loss": 0.5250281691551208,
                    "features_accuracy": [
                        0.7812855243682861,
                        0.7161784172058105,
                        0.7499432563781738,
                        0.6972519159317017,
                        0.6784768104553223,
                        0.7175410985946655,
                        0.7913544178009033,
                        0.8128548860549927
                    ]
                },
                "val": {
                    "score": -0.4451296972648765,
                    "pretrain_loss": 0.5420345664024353,
                    "features_accuracy": [
                        0.7723281979560852,
                        0.7160157561302185,
                        0.7329699993133545,
                        0.6696942448616028,
                        0.6760520935058594,
                        0.7026945352554321,
                        0.7723281979560852,
                        0.7980623841285706
                    ]
                },
                "test": {
                    "score": -0.4353344942420511,
                    "pretrain_loss": 0.5422913432121277,
                    "features_accuracy": [
                        0.7691376209259033,
                        0.705910861492157,
                        0.7463662624359131,
                        0.680232584476471,
                        0.6761143207550049,
                        0.6904069781303406,
                        0.7773740291595459,
                        0.8001453280448914
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": -0.3688377385631579,
                    "pretrain_loss": 0.5242041945457458,
                    "features_accuracy": [
                        0.7817397713661194,
                        0.7164812088012695,
                        0.7444167137145996,
                        0.6871830224990845,
                        0.6820350289344788,
                        0.721932053565979,
                        0.8059656620025635,
                        0.8020289540290833
                    ]
                },
                "val": {
                    "score": -0.44283352728934755,
                    "pretrain_loss": 0.5436673760414124,
                    "features_accuracy": [
                        0.7747502326965332,
                        0.7141991853713989,
                        0.7323645353317261,
                        0.6681804656982422,
                        0.6712079644203186,
                        0.699364185333252,
                        0.7756584882736206,
                        0.7929155230522156
                    ]
                },
                "test": {
                    "score": -0.4339712032035054,
                    "pretrain_loss": 0.5433309078216553,
                    "features_accuracy": [
                        0.7759205102920532,
                        0.7037306427955627,
                        0.7403100728988647,
                        0.6732073426246643,
                        0.6736918687820435,
                        0.6971899271011353,
                        0.7839147448539734,
                        0.7906976938247681
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": -0.3504747071986221,
                    "pretrain_loss": 0.5274684429168701,
                    "features_accuracy": [
                        0.7750776410102844,
                        0.7139071822166443,
                        0.7443410158157349,
                        0.6893027424812317,
                        0.6855174899101257,
                        0.7105761170387268,
                        0.795669674873352,
                        0.806647002696991
                    ]
                },
                "val": {
                    "score": -0.4400779208130689,
                    "pretrain_loss": 0.5371836423873901,
                    "features_accuracy": [
                        0.7801998257637024,
                        0.7154102325439453,
                        0.7320617437362671,
                        0.6681804656982422,
                        0.6754465699195862,
                        0.7045110464096069,
                        0.7801998257637024,
                        0.8083560466766357
                    ]
                },
                "test": {
                    "score": -0.4322256418664184,
                    "pretrain_loss": 0.5378214716911316,
                    "features_accuracy": [
                        0.7734980583190918,
                        0.7090600728988647,
                        0.7439438104629517,
                        0.6775678396224976,
                        0.6812015771865845,
                        0.7056686282157898,
                        0.7843992114067078,
                        0.8011143207550049
                    ]
                }
            },
            "80000": {
                "train": {
                    "score": -0.31157932924468024,
                    "pretrain_loss": 0.5222457647323608,
                    "features_accuracy": [
                        0.7781058549880981,
                        0.7151185274124146,
                        0.7457036972045898,
                        0.6900598406791687,
                        0.6783254146575928,
                        0.7167083024978638,
                        0.806344211101532,
                        0.8158074021339417
                    ]
                },
                "val": {
                    "score": -0.4369711679137148,
                    "pretrain_loss": 0.5368583798408508,
                    "features_accuracy": [
                        0.7798970341682434,
                        0.7145019769668579,
                        0.7329699993133545,
                        0.6678776741027832,
                        0.6790796518325806,
                        0.7135937213897705,
                        0.7859521508216858,
                        0.8016954064369202
                    ]
                },
                "test": {
                    "score": -0.43895140173270875,
                    "pretrain_loss": 0.5361856818199158,
                    "features_accuracy": [
                        0.7720445990562439,
                        0.7083333134651184,
                        0.7470930218696594,
                        0.6812015771865845,
                        0.6775678396224976,
                        0.6981589198112488,
                        0.786821722984314,
                        0.8040212988853455
                    ]
                }
            },
            "90000": {
                "train": {
                    "score": -0.311953584228234,
                    "pretrain_loss": 0.5141030550003052,
                    "features_accuracy": [
                        0.7826482057571411,
                        0.720872163772583,
                        0.754182755947113,
                        0.6914225220680237,
                        0.6829434633255005,
                        0.7305625081062317,
                        0.8090695738792419,
                        0.8204255104064941
                    ]
                },
                "val": {
                    "score": -0.4355490635343524,
                    "pretrain_loss": 0.5344973802566528,
                    "features_accuracy": [
                        0.7747502326965332,
                        0.7187405228614807,
                        0.7302452325820923,
                        0.665152907371521,
                        0.6784741282463074,
                        0.7017862796783447,
                        0.7904934883117676,
                        0.8089615702629089
                    ]
                },
                "test": {
                    "score": -0.4249916491474336,
                    "pretrain_loss": 0.5324936509132385,
                    "features_accuracy": [
                        0.7645348906517029,
                        0.7139050364494324,
                        0.7451550364494324,
                        0.6724806427955627,
                        0.6804748177528381,
                        0.7076066136360168,
                        0.7904554009437561,
                        0.8081395030021667
                    ]
                }
            },
            "100000": {
                "train": {
                    "score": -0.35567656663648245,
                    "pretrain_loss": 0.5115452408790588,
                    "features_accuracy": [
                        0.7819668650627136,
                        0.7346506714820862,
                        0.7507002949714661,
                        0.6868801712989807,
                        0.683322012424469,
                        0.7254902124404907,
                        0.8180786371231079,
                        0.8233023285865784
                    ]
                },
                "val": {
                    "score": -0.434038030128354,
                    "pretrain_loss": 0.5308018326759338,
                    "features_accuracy": [
                        0.783832848072052,
                        0.7148047089576721,
                        0.7399333715438843,
                        0.6718134880065918,
                        0.6742355227470398,
                        0.7166212797164917,
                        0.7901907563209534,
                        0.8113836050033569
                    ]
                },
                "test": {
                    "score": -0.42260145956448536,
                    "pretrain_loss": 0.5299437642097473,
                    "features_accuracy": [
                        0.7749515771865845,
                        0.7122092843055725,
                        0.75,
                        0.6792635917663574,
                        0.680232584476471,
                        0.7107558250427246,
                        0.7974806427955627,
                        0.810562014579773
                    ]
                }
            }
        },
        "train": {
            "score": -0.35567656663648245
        },
        "val": {
            "score": -0.434038030128354
        },
        "test": {
            "score": -0.42260145956448536
        }
    },
    "best_iteration": 100000,
    "time": "0:37:15"
}
