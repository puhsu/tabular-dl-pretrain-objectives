{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask___23ebee2d278a465cab387c02e8244632.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 14,
        "data": {
            "path": "data/california",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "transformer",
            "config": {
                "n_blocks": 4,
                "attention_dropout": 0.006835950215068107,
                "ffn_dropout": 0.14201787610318556,
                "ffn_d_hidden": 695
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear"
            ],
            "d_num_embedding": 512,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.00031363259431556616,
            "weight_decay": 4.8674309203267864e-05,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.33783618095960377,
            "corrupt_strategy": "target_resample",
            "d_hidden_head": 512,
            "lr": 0.00031363259431556616,
            "weight_decay": 4.8674309203267864e-05,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": true,
            "early_stop_type": "finetune",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "epoch_size": 104,
    "n_parameters": 8759737,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -0.42429077762506473,
                    "pretrain_loss": 0.5550137758255005,
                    "features_accuracy": [
                        0.7667499780654907,
                        0.6957377791404724,
                        0.728594183921814,
                        0.6735559105873108,
                        0.6734045147895813,
                        0.6968733668327332,
                        0.763494610786438,
                        0.7853736281394958
                    ]
                },
                "val": {
                    "score": -0.4605840310872253,
                    "pretrain_loss": 0.5581219792366028,
                    "features_accuracy": [
                        0.7671813368797302,
                        0.6984559297561646,
                        0.7320617437362671,
                        0.6654556393623352,
                        0.6739327907562256,
                        0.699364185333252,
                        0.7623372673988342,
                        0.7705116271972656
                    ]
                },
                "test": {
                    "score": -0.4597053977162137,
                    "pretrain_loss": 0.5618987083435059,
                    "features_accuracy": [
                        0.7676841020584106,
                        0.7061530947685242,
                        0.7192344665527344,
                        0.6744186282157898,
                        0.6688469052314758,
                        0.6828972697257996,
                        0.7664728760719299,
                        0.7691376209259033
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -0.38063180075690256,
                    "pretrain_loss": 0.5462339520454407,
                    "features_accuracy": [
                        0.7690211534500122,
                        0.7026270031929016,
                        0.7348777651786804,
                        0.6773412227630615,
                        0.678779661655426,
                        0.7022485136985779,
                        0.7705352902412415,
                        0.7822697162628174
                    ]
                },
                "val": {
                    "score": -0.4476892653180663,
                    "pretrain_loss": 0.5530633926391602,
                    "features_accuracy": [
                        0.7723281979560852,
                        0.6987587213516235,
                        0.7384195923805237,
                        0.6721162796020508,
                        0.6781713366508484,
                        0.6975476741790771,
                        0.76203453540802,
                        0.7714199423789978
                    ]
                },
                "test": {
                    "score": -0.44924975046997,
                    "pretrain_loss": 0.5523125529289246,
                    "features_accuracy": [
                        0.7730135917663574,
                        0.7051841020584106,
                        0.7289243936538696,
                        0.6751453280448914,
                        0.6736918687820435,
                        0.6790212988853455,
                        0.7669573426246643,
                        0.775678277015686
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -0.3934139048684669,
                    "pretrain_loss": 0.538892388343811,
                    "features_accuracy": [
                        0.7796199917793274,
                        0.7094405293464661,
                        0.7304111123085022,
                        0.6749186515808105,
                        0.6759028434753418,
                        0.7047467827796936,
                        0.7840109467506409,
                        0.7924143075942993
                    ]
                },
                "val": {
                    "score": -0.45144293854942946,
                    "pretrain_loss": 0.5481120347976685,
                    "features_accuracy": [
                        0.7820163369178772,
                        0.7045110464096069,
                        0.7411444187164307,
                        0.6706025004386902,
                        0.6745383143424988,
                        0.7078413367271423,
                        0.7747502326965332,
                        0.7774749994277954
                    ]
                },
                "test": {
                    "score": -0.44487655114621544,
                    "pretrain_loss": 0.549026608467102,
                    "features_accuracy": [
                        0.784641444683075,
                        0.7143895030021667,
                        0.7272287011146545,
                        0.6787790656089783,
                        0.669089138507843,
                        0.6831395030021667,
                        0.7764050364494324,
                        0.7839147448539734
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -0.34219940900254064,
                    "pretrain_loss": 0.5303850769996643,
                    "features_accuracy": [
                        0.7812098264694214,
                        0.7114089131355286,
                        0.7459308505058289,
                        0.6851389408111572,
                        0.681202232837677,
                        0.7105004191398621,
                        0.7857521772384644,
                        0.7985464930534363
                    ]
                },
                "val": {
                    "score": -0.442253826804876,
                    "pretrain_loss": 0.5423722267150879,
                    "features_accuracy": [
                        0.7868604063987732,
                        0.7069330811500549,
                        0.7417499423027039,
                        0.6730245351791382,
                        0.6769603490829468,
                        0.7005752325057983,
                        0.776869535446167,
                        0.794126570224762
                    ]
                },
                "test": {
                    "score": -0.44044270822984083,
                    "pretrain_loss": 0.5451186299324036,
                    "features_accuracy": [
                        0.7829457521438599,
                        0.7177810072898865,
                        0.7354651093482971,
                        0.6775678396224976,
                        0.676598846912384,
                        0.6860464811325073,
                        0.7754360437393188,
                        0.7906976938247681
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": -0.35429649144478814,
                    "pretrain_loss": 0.5257799029350281,
                    "features_accuracy": [
                        0.7857521772384644,
                        0.7129230499267578,
                        0.7507759928703308,
                        0.6842304468154907,
                        0.6807479858398438,
                        0.719282329082489,
                        0.7976379990577698,
                        0.8062684535980225
                    ]
                },
                "val": {
                    "score": -0.4412138009085615,
                    "pretrain_loss": 0.5419564247131348,
                    "features_accuracy": [
                        0.7826218605041504,
                        0.7057220935821533,
                        0.7468967437744141,
                        0.674841046333313,
                        0.6769603490829468,
                        0.7066303491592407,
                        0.7811080813407898,
                        0.7923099994659424
                    ]
                },
                "test": {
                    "score": -0.45372093101987815,
                    "pretrain_loss": 0.541892945766449,
                    "features_accuracy": [
                        0.7817344665527344,
                        0.707848846912384,
                        0.7381298542022705,
                        0.6790212988853455,
                        0.6727228760719299,
                        0.6814438104629517,
                        0.7860949635505676,
                        0.8025678396224976
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": -0.34199633207836355,
                    "pretrain_loss": 0.5195023417472839,
                    "features_accuracy": [
                        0.7831781506538391,
                        0.7218563556671143,
                        0.7494133114814758,
                        0.686274528503418,
                        0.6970247626304626,
                        0.7196608781814575,
                        0.802634596824646,
                        0.8130062818527222
                    ]
                },
                "val": {
                    "score": -0.4362975229144924,
                    "pretrain_loss": 0.5379105806350708,
                    "features_accuracy": [
                        0.7877687215805054,
                        0.7084468603134155,
                        0.7478049993515015,
                        0.6766575574874878,
                        0.6818044185638428,
                        0.7151075005531311,
                        0.7780805230140686,
                        0.7944293022155762
                    ]
                },
                "test": {
                    "score": -0.4373632831163953,
                    "pretrain_loss": 0.5407927632331848,
                    "features_accuracy": [
                        0.7839147448539734,
                        0.7160852551460266,
                        0.7388566136360168,
                        0.6795058250427246,
                        0.6741763353347778,
                        0.6911337375640869,
                        0.7824612259864807,
                        0.7957848906517029
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": -0.3638229855681776,
                    "pretrain_loss": 0.5302559733390808,
                    "features_accuracy": [
                        0.7737905979156494,
                        0.7133015394210815,
                        0.7481263279914856,
                        0.684911847114563,
                        0.6791581511497498,
                        0.7125445008277893,
                        0.7958210706710815,
                        0.8025588989257812
                    ]
                },
                "val": {
                    "score": -0.43607664799030266,
                    "pretrain_loss": 0.5342848300933838,
                    "features_accuracy": [
                        0.7883741855621338,
                        0.7014834880828857,
                        0.7511353492736816,
                        0.6742355227470398,
                        0.6769603490829468,
                        0.7132909297943115,
                        0.7950348258018494,
                        0.8065395355224609
                    ]
                },
                "test": {
                    "score": -0.4255142103097771,
                    "pretrain_loss": 0.5361382365226746,
                    "features_accuracy": [
                        0.7856104373931885,
                        0.7153584957122803,
                        0.7388566136360168,
                        0.6816860437393188,
                        0.6785368323326111,
                        0.690891444683075,
                        0.7972383499145508,
                        0.7999030947685242
                    ]
                }
            },
            "80000": {
                "train": {
                    "score": -0.3072889703172758,
                    "pretrain_loss": 0.5245324969291687,
                    "features_accuracy": [
                        0.7733364105224609,
                        0.7207964658737183,
                        0.7470664381980896,
                        0.683322012424469,
                        0.6754485964775085,
                        0.7170111536979675,
                        0.801044762134552,
                        0.8099023699760437
                    ]
                },
                "val": {
                    "score": -0.43555897127010396,
                    "pretrain_loss": 0.5310049653053284,
                    "features_accuracy": [
                        0.7844383716583252,
                        0.7135937213897705,
                        0.7499243021011353,
                        0.6811988949775696,
                        0.682409942150116,
                        0.7063275575637817,
                        0.7992733716964722,
                        0.8044202327728271
                    ]
                },
                "test": {
                    "score": -0.4457064453814808,
                    "pretrain_loss": 0.5353952646255493,
                    "features_accuracy": [
                        0.7807654738426208,
                        0.7126938104629517,
                        0.7441860437393188,
                        0.6845930218696594,
                        0.6739341020584106,
                        0.6911337375640869,
                        0.7906976938247681,
                        0.8037790656089783
                    ]
                }
            },
            "90000": {
                "train": {
                    "score": -0.3301555749059115,
                    "pretrain_loss": 0.5179197192192078,
                    "features_accuracy": [
                        0.7823454141616821,
                        0.7242032289505005,
                        0.7501703500747681,
                        0.6916496753692627,
                        0.6900598406791687,
                        0.7116360068321228,
                        0.8109622597694397,
                        0.8159588575363159
                    ]
                },
                "val": {
                    "score": -0.4389599981034134,
                    "pretrain_loss": 0.5306692719459534,
                    "features_accuracy": [
                        0.7835301160812378,
                        0.7120799422264099,
                        0.7538601160049438,
                        0.6836209297180176,
                        0.6781713366508484,
                        0.7032999992370605,
                        0.796245813369751,
                        0.8083560466766357
                    ]
                },
                "test": {
                    "score": -0.43442036440203396,
                    "pretrain_loss": 0.5307580232620239,
                    "features_accuracy": [
                        0.786579430103302,
                        0.7163274884223938,
                        0.7429748177528381,
                        0.6860464811325073,
                        0.6717538833618164,
                        0.6891957521438599,
                        0.7928779125213623,
                        0.8064438104629517
                    ]
                }
            },
            "100000": {
                "train": {
                    "score": -0.27909558313000554,
                    "pretrain_loss": 0.511620283126831,
                    "features_accuracy": [
                        0.7889317870140076,
                        0.7287455797195435,
                        0.7507002949714661,
                        0.6865016222000122,
                        0.681732177734375,
                        0.728896975517273,
                        0.8104323148727417,
                        0.8233023285865784
                    ]
                },
                "val": {
                    "score": -0.43498840232827657,
                    "pretrain_loss": 0.5262832641601562,
                    "features_accuracy": [
                        0.7901907563209534,
                        0.7160157561302185,
                        0.7465940117835999,
                        0.6787768602371216,
                        0.6736300587654114,
                        0.7166212797164917,
                        0.7971541285514832,
                        0.8156221508979797
                    ]
                },
                "test": {
                    "score": -0.4359357818141712,
                    "pretrain_loss": 0.5295968651771545,
                    "features_accuracy": [
                        0.7839147448539734,
                        0.7204457521438599,
                        0.7461240291595459,
                        0.6821705102920532,
                        0.6768410801887512,
                        0.6981589198112488,
                        0.8020833134651184,
                        0.8025678396224976
                    ]
                }
            }
        },
        "train": {
            "score": -0.27909558313000554
        },
        "val": {
            "score": -0.43498840232827657
        },
        "test": {
            "score": -0.4359357818141712
        }
    },
    "best_iteration": 100000,
    "time": "0:38:08"
}
