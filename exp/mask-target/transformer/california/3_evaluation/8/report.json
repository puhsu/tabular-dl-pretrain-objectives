{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask___23ebee2d278a465cab387c02e8244632.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 8,
        "data": {
            "path": "data/california",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "transformer",
            "config": {
                "n_blocks": 4,
                "attention_dropout": 0.006835950215068107,
                "ffn_dropout": 0.14201787610318556,
                "ffn_d_hidden": 695
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear"
            ],
            "d_num_embedding": 512,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.00031363259431556616,
            "weight_decay": 4.8674309203267864e-05,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.33783618095960377,
            "corrupt_strategy": "target_resample",
            "d_hidden_head": 512,
            "lr": 0.00031363259431556616,
            "weight_decay": 4.8674309203267864e-05,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": true,
            "early_stop_type": "finetune",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "epoch_size": 104,
    "n_parameters": 8759737,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -0.36960205022081816,
                    "pretrain_loss": 0.5531315803527832,
                    "features_accuracy": [
                        0.7673556208610535,
                        0.6987659931182861,
                        0.7331365346908569,
                        0.6774169206619263,
                        0.6730259656906128,
                        0.6955863833427429,
                        0.7644788026809692,
                        0.7792414426803589
                    ]
                },
                "val": {
                    "score": -0.45403607909054344,
                    "pretrain_loss": 0.5653946995735168,
                    "features_accuracy": [
                        0.754465639591217,
                        0.6857402324676514,
                        0.7229791283607483,
                        0.6787768602371216,
                        0.66727215051651,
                        0.6763548254966736,
                        0.752043604850769,
                        0.7671813368797302
                    ]
                },
                "test": {
                    "score": -0.45088065111656583,
                    "pretrain_loss": 0.5639804601669312,
                    "features_accuracy": [
                        0.7562984228134155,
                        0.6991279125213623,
                        0.7105135917663574,
                        0.6664243936538696,
                        0.6780523061752319,
                        0.6867732405662537,
                        0.7562984228134155,
                        0.773740291595459
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -0.3628843311678671,
                    "pretrain_loss": 0.5404167175292969,
                    "features_accuracy": [
                        0.7722008228302002,
                        0.7045196890830994,
                        0.7314710021018982,
                        0.683322012424469,
                        0.6797637939453125,
                        0.7113332152366638,
                        0.7769702672958374,
                        0.7948368787765503
                    ]
                },
                "val": {
                    "score": -0.45116886703634945,
                    "pretrain_loss": 0.5565963387489319,
                    "features_accuracy": [
                        0.7686951160430908,
                        0.6975476741790771,
                        0.7281259298324585,
                        0.674841046333313,
                        0.6687859296798706,
                        0.6787768602371216,
                        0.7553738951683044,
                        0.7771722674369812
                    ]
                },
                "test": {
                    "score": -0.45094710864456244,
                    "pretrain_loss": 0.5554059743881226,
                    "features_accuracy": [
                        0.7655038833618164,
                        0.7061530947685242,
                        0.7151162624359131,
                        0.6729651093482971,
                        0.6744186282157898,
                        0.6877422332763672,
                        0.7691376209259033,
                        0.779312014579773
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -0.42584382303984164,
                    "pretrain_loss": 0.5414281487464905,
                    "features_accuracy": [
                        0.7746233940124512,
                        0.7027027010917664,
                        0.7398743629455566,
                        0.6758270859718323,
                        0.679309606552124,
                        0.7035354971885681,
                        0.7739420533180237,
                        0.796502411365509
                    ]
                },
                "val": {
                    "score": -0.46238386675935944,
                    "pretrain_loss": 0.5550925731658936,
                    "features_accuracy": [
                        0.771722674369812,
                        0.6984559297561646,
                        0.7347865700721741,
                        0.6793823838233948,
                        0.6715107560157776,
                        0.6890705227851868,
                        0.7559794187545776,
                        0.7786860466003418
                    ]
                },
                "test": {
                    "score": -0.45344969707302585,
                    "pretrain_loss": 0.5555025935173035,
                    "features_accuracy": [
                        0.7640503644943237,
                        0.7034883499145508,
                        0.7228682041168213,
                        0.6712693572044373,
                        0.6770833134651184,
                        0.680232584476471,
                        0.7679263353347778,
                        0.7851259708404541
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -0.364187202203114,
                    "pretrain_loss": 0.5360016822814941,
                    "features_accuracy": [
                        0.7705352902412415,
                        0.7134529948234558,
                        0.7435839176177979,
                        0.6820350289344788,
                        0.678022563457489,
                        0.7031569480895996,
                        0.7801499366760254,
                        0.798622190952301
                    ]
                },
                "val": {
                    "score": -0.45091492715319864,
                    "pretrain_loss": 0.5512455701828003,
                    "features_accuracy": [
                        0.771722674369812,
                        0.7057220935821533,
                        0.7329699993133545,
                        0.6827126741409302,
                        0.669996976852417,
                        0.6878595352172852,
                        0.7671813368797302,
                        0.781410813331604
                    ]
                },
                "test": {
                    "score": -0.46318919715200907,
                    "pretrain_loss": 0.5494470596313477,
                    "features_accuracy": [
                        0.7625969052314758,
                        0.7134205102920532,
                        0.724321722984314,
                        0.6741763353347778,
                        0.6719961166381836,
                        0.6899224519729614,
                        0.7727712988853455,
                        0.7853682041168213
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": -0.39362210757469795,
                    "pretrain_loss": 0.5312606692314148,
                    "features_accuracy": [
                        0.7775002121925354,
                        0.715572714805603,
                        0.7401771545410156,
                        0.6880157589912415,
                        0.677492618560791,
                        0.7117117643356323,
                        0.7907487750053406,
                        0.8044515252113342
                    ]
                },
                "val": {
                    "score": -0.4435244659426135,
                    "pretrain_loss": 0.5504232048988342,
                    "features_accuracy": [
                        0.7711171507835388,
                        0.6999697089195251,
                        0.7347865700721741,
                        0.6808961629867554,
                        0.6706025004386902,
                        0.6878595352172852,
                        0.7683923840522766,
                        0.776869535446167
                    ]
                },
                "test": {
                    "score": -0.43670543337215256,
                    "pretrain_loss": 0.5496246218681335,
                    "features_accuracy": [
                        0.7650193572044373,
                        0.7085756063461304,
                        0.7274709343910217,
                        0.6753876209259033,
                        0.6770833134651184,
                        0.6836240291595459,
                        0.7764050364494324,
                        0.7909399271011353
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": -0.32695263442334155,
                    "pretrain_loss": 0.5262558460235596,
                    "features_accuracy": [
                        0.7799985408782959,
                        0.7133015394210815,
                        0.7526686787605286,
                        0.6871830224990845,
                        0.6784011125564575,
                        0.715572714805603,
                        0.794912576675415,
                        0.804754376411438
                    ]
                },
                "val": {
                    "score": -0.443948341971882,
                    "pretrain_loss": 0.549781322479248,
                    "features_accuracy": [
                        0.7711171507835388,
                        0.6942173838615417,
                        0.7335755228996277,
                        0.6893733143806458,
                        0.6702997088432312,
                        0.6957311630249023,
                        0.769300639629364,
                        0.7820163369178772
                    ]
                },
                "test": {
                    "score": -0.4480947787466587,
                    "pretrain_loss": 0.5483688116073608,
                    "features_accuracy": [
                        0.7674418687820435,
                        0.7054263353347778,
                        0.7284399271011353,
                        0.6715116500854492,
                        0.6756298542022705,
                        0.6879844665527344,
                        0.7766472697257996,
                        0.7860949635505676
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": -0.3334371781218017,
                    "pretrain_loss": 0.5366945862770081,
                    "features_accuracy": [
                        0.7776516079902649,
                        0.7093648314476013,
                        0.7409342527389526,
                        0.6799152493476868,
                        0.6802180409431458,
                        0.7067151665687561,
                        0.7942312359809875,
                        0.7897645831108093
                    ]
                },
                "val": {
                    "score": -0.4403916201764132,
                    "pretrain_loss": 0.5493629574775696,
                    "features_accuracy": [
                        0.7632455229759216,
                        0.7029972672462463,
                        0.7341810464859009,
                        0.6869512796401978,
                        0.6721162796020508,
                        0.6914925575256348,
                        0.77414470911026,
                        0.791704535484314
                    ]
                },
                "test": {
                    "score": -0.44383154621146187,
                    "pretrain_loss": 0.5449457764625549,
                    "features_accuracy": [
                        0.762839138507843,
                        0.7172964811325073,
                        0.7269864082336426,
                        0.6693313717842102,
                        0.6775678396224976,
                        0.6870154738426208,
                        0.7836724519729614,
                        0.7943313717842102
                    ]
                }
            },
            "80000": {
                "train": {
                    "score": -0.36493192546563086,
                    "pretrain_loss": 0.5279437303543091,
                    "features_accuracy": [
                        0.7775002121925354,
                        0.7148156762123108,
                        0.7412370443344116,
                        0.682792067527771,
                        0.6812779307365417,
                        0.7138314843177795,
                        0.7971837520599365,
                        0.8074040412902832
                    ]
                },
                "val": {
                    "score": -0.438286776706452,
                    "pretrain_loss": 0.5448339581489563,
                    "features_accuracy": [
                        0.7683923840522766,
                        0.7002725005149841,
                        0.7326672673225403,
                        0.6827126741409302,
                        0.6687859296798706,
                        0.6957311630249023,
                        0.771722674369812,
                        0.791401743888855
                    ]
                },
                "test": {
                    "score": -0.4275535440436725,
                    "pretrain_loss": 0.5410798788070679,
                    "features_accuracy": [
                        0.7681686282157898,
                        0.7156007885932922,
                        0.731589138507843,
                        0.674660861492157,
                        0.6768410801887512,
                        0.6937984228134155,
                        0.7805232405662537,
                        0.8047480583190918
                    ]
                }
            },
            "90000": {
                "train": {
                    "score": -0.2948806811867158,
                    "pretrain_loss": 0.5195250511169434,
                    "features_accuracy": [
                        0.7849950790405273,
                        0.719812273979187,
                        0.754712700843811,
                        0.6874101161956787,
                        0.6810508370399475,
                        0.722764790058136,
                        0.803694486618042,
                        0.8130820393562317
                    ]
                },
                "val": {
                    "score": -0.4374984137680396,
                    "pretrain_loss": 0.5387676358222961,
                    "features_accuracy": [
                        0.7771722674369812,
                        0.7011807560920715,
                        0.7429609298706055,
                        0.6884650588035583,
                        0.6727217435836792,
                        0.6939145922660828,
                        0.7820163369178772,
                        0.7959430813789368
                    ]
                },
                "test": {
                    "score": -0.4484861639773385,
                    "pretrain_loss": 0.5392584204673767,
                    "features_accuracy": [
                        0.7734980583190918,
                        0.7160852551460266,
                        0.7301356792449951,
                        0.6700581312179565,
                        0.6778100728988647,
                        0.6976743936538696,
                        0.7890019416809082,
                        0.8057170510292053
                    ]
                }
            },
            "100000": {
                "train": {
                    "score": -0.35026879248281767,
                    "pretrain_loss": 0.5165383219718933,
                    "features_accuracy": [
                        0.7890832424163818,
                        0.7260201573371887,
                        0.7560754418373108,
                        0.6843062043190002,
                        0.6993716359138489,
                        0.7234461307525635,
                        0.8074040412902832,
                        0.8145961165428162
                    ]
                },
                "val": {
                    "score": -0.44119794688585945,
                    "pretrain_loss": 0.5408232808113098,
                    "features_accuracy": [
                        0.7801998257637024,
                        0.7029972672462463,
                        0.7326672673225403,
                        0.682409942150116,
                        0.6687859296798706,
                        0.6984559297561646,
                        0.783832848072052,
                        0.7944293022155762
                    ]
                },
                "test": {
                    "score": -0.4334727289323739,
                    "pretrain_loss": 0.5367241501808167,
                    "features_accuracy": [
                        0.7734980583190918,
                        0.7160852551460266,
                        0.7357073426246643,
                        0.6758720874786377,
                        0.6809592843055725,
                        0.7005813717842102,
                        0.7802810072898865,
                        0.8008720874786377
                    ]
                }
            }
        },
        "train": {
            "score": -0.2948806811867158
        },
        "val": {
            "score": -0.4374984137680396
        },
        "test": {
            "score": -0.4484861639773385
        }
    },
    "best_iteration": 90000,
    "time": "0:39:55"
}
