{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask___23ebee2d278a465cab387c02e8244632.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 10,
        "data": {
            "path": "data/california",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "transformer",
            "config": {
                "n_blocks": 4,
                "attention_dropout": 0.006835950215068107,
                "ffn_dropout": 0.14201787610318556,
                "ffn_d_hidden": 695
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear"
            ],
            "d_num_embedding": 512,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.00031363259431556616,
            "weight_decay": 4.8674309203267864e-05,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.33783618095960377,
            "corrupt_strategy": "target_resample",
            "d_hidden_head": 512,
            "lr": 0.00031363259431556616,
            "weight_decay": 4.8674309203267864e-05,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": true,
            "early_stop_type": "finetune",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "epoch_size": 104,
    "n_parameters": 8759737,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -0.41290751493501804,
                    "pretrain_loss": 0.5554251670837402,
                    "features_accuracy": [
                        0.762131929397583,
                        0.7045953869819641,
                        0.7266258001327515,
                        0.674010157585144,
                        0.6733288168907166,
                        0.6946778893470764,
                        0.7634189128875732,
                        0.7788628935813904
                    ]
                },
                "val": {
                    "score": -0.46244947413232584,
                    "pretrain_loss": 0.5540034770965576,
                    "features_accuracy": [
                        0.7774749994277954,
                        0.6960338950157166,
                        0.7235845923423767,
                        0.6842264533042908,
                        0.6763548254966736,
                        0.6830154657363892,
                        0.7686951160430908,
                        0.7726309299468994
                    ]
                },
                "test": {
                    "score": -0.4561617532337244,
                    "pretrain_loss": 0.5572016835212708,
                    "features_accuracy": [
                        0.7652616500854492,
                        0.6954941749572754,
                        0.7313469052314758,
                        0.6872577667236328,
                        0.6780523061752319,
                        0.7073643207550049,
                        0.7565407156944275,
                        0.7722868323326111
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -0.39177265777250403,
                    "pretrain_loss": 0.5441572070121765,
                    "features_accuracy": [
                        0.76826411485672,
                        0.7076236009597778,
                        0.7298811674118042,
                        0.6792338490486145,
                        0.683851957321167,
                        0.6997501850128174,
                        0.7791657447814941,
                        0.7889317870140076
                    ]
                },
                "val": {
                    "score": -0.45058859817771835,
                    "pretrain_loss": 0.5481261610984802,
                    "features_accuracy": [
                        0.7847411632537842,
                        0.6875567436218262,
                        0.7311534881591797,
                        0.6911898255348206,
                        0.6760520935058594,
                        0.6884650588035583,
                        0.7650620341300964,
                        0.7835301160812378
                    ]
                },
                "test": {
                    "score": -0.44222196582445833,
                    "pretrain_loss": 0.5523108839988708,
                    "features_accuracy": [
                        0.7635658979415894,
                        0.6964631676673889,
                        0.7357073426246643,
                        0.6862887740135193,
                        0.6792635917663574,
                        0.7027616500854492,
                        0.7630813717842102,
                        0.7797964811325073
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -0.3970311622333202,
                    "pretrain_loss": 0.5371902585029602,
                    "features_accuracy": [
                        0.7617533802986145,
                        0.7110303640365601,
                        0.7454009056091309,
                        0.6808993816375732,
                        0.6804451942443848,
                        0.7038382887840271,
                        0.7871905565261841,
                        0.7964267134666443
                    ]
                },
                "val": {
                    "score": -0.4522309370316589,
                    "pretrain_loss": 0.5462180972099304,
                    "features_accuracy": [
                        0.7780805230140686,
                        0.6933091282844543,
                        0.7287314534187317,
                        0.6914925575256348,
                        0.6739327907562256,
                        0.6930063366889954,
                        0.7738419771194458,
                        0.7798970341682434
                    ]
                },
                "test": {
                    "score": -0.4445312509228375,
                    "pretrain_loss": 0.5500534772872925,
                    "features_accuracy": [
                        0.7567829489707947,
                        0.6974321603775024,
                        0.7393410801887512,
                        0.6826550364494324,
                        0.6756298542022705,
                        0.7105135917663574,
                        0.760901153087616,
                        0.7814922332763672
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -0.37593900468391606,
                    "pretrain_loss": 0.5320969223976135,
                    "features_accuracy": [
                        0.7814369201660156,
                        0.7178438901901245,
                        0.7462336421012878,
                        0.6797637939453125,
                        0.684911847114563,
                        0.7120145559310913,
                        0.7845408916473389,
                        0.7985464930534363
                    ]
                },
                "val": {
                    "score": -0.44302348880211717,
                    "pretrain_loss": 0.5420764088630676,
                    "features_accuracy": [
                        0.7853466272354126,
                        0.6924008727073669,
                        0.7347865700721741,
                        0.6899787783622742,
                        0.6790796518325806,
                        0.6878595352172852,
                        0.7753557562828064,
                        0.7856494188308716
                    ]
                },
                "test": {
                    "score": -0.43415383139246505,
                    "pretrain_loss": 0.5436835289001465,
                    "features_accuracy": [
                        0.7698643207550049,
                        0.6957364082336426,
                        0.7420058250427246,
                        0.6889534592628479,
                        0.6828972697257996,
                        0.7076066136360168,
                        0.7650193572044373,
                        0.7950581312179565
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": -0.37904952303580514,
                    "pretrain_loss": 0.5237371921539307,
                    "features_accuracy": [
                        0.7832538485527039,
                        0.7188280820846558,
                        0.7438867688179016,
                        0.6890756487846375,
                        0.685441792011261,
                        0.7151942253112793,
                        0.7986978888511658,
                        0.8093724250793457
                    ]
                },
                "val": {
                    "score": -0.44694268292688166,
                    "pretrain_loss": 0.5388153791427612,
                    "features_accuracy": [
                        0.7868604063987732,
                        0.6957311630249023,
                        0.7384195923805237,
                        0.6875567436218262,
                        0.6836209297180176,
                        0.6930063366889954,
                        0.7877687215805054,
                        0.7862549424171448
                    ]
                },
                "test": {
                    "score": -0.4331340003873271,
                    "pretrain_loss": 0.5390586256980896,
                    "features_accuracy": [
                        0.7747092843055725,
                        0.6967054009437561,
                        0.742490291595459,
                        0.6916182041168213,
                        0.6865310072898865,
                        0.7107558250427246,
                        0.7730135917663574,
                        0.7926356792449951
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": -0.36642070667504767,
                    "pretrain_loss": 0.5196636915206909,
                    "features_accuracy": [
                        0.7813612222671509,
                        0.7234461307525635,
                        0.754712700843811,
                        0.682564914226532,
                        0.6783254146575928,
                        0.7192066311836243,
                        0.8005905151367188,
                        0.8133091330528259
                    ]
                },
                "val": {
                    "score": -0.446962442120821,
                    "pretrain_loss": 0.5346137285232544,
                    "features_accuracy": [
                        0.7880714535713196,
                        0.6954283714294434,
                        0.7384195923805237,
                        0.6930063366889954,
                        0.6839237213134766,
                        0.6924008727073669,
                        0.7883741855621338,
                        0.8065395355224609
                    ]
                },
                "test": {
                    "score": -0.4348418524094013,
                    "pretrain_loss": 0.5390971302986145,
                    "features_accuracy": [
                        0.7771317958831787,
                        0.7015503644943237,
                        0.7466084957122803,
                        0.6875,
                        0.6838662624359131,
                        0.7124515771865845,
                        0.7843992114067078,
                        0.7977228760719299
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": -0.3391934519622598,
                    "pretrain_loss": 0.5253342390060425,
                    "features_accuracy": [
                        0.7812098264694214,
                        0.7209478616714478,
                        0.7466878890991211,
                        0.6895298957824707,
                        0.6821864247322083,
                        0.714739978313446,
                        0.7980165481567383,
                        0.8076311945915222
                    ]
                },
                "val": {
                    "score": -0.4436858362502224,
                    "pretrain_loss": 0.5332067012786865,
                    "features_accuracy": [
                        0.7877687215805054,
                        0.6963366866111755,
                        0.7366030812263489,
                        0.6936118602752686,
                        0.6784741282463074,
                        0.6930063366889954,
                        0.796245813369751,
                        0.7977595925331116
                    ]
                },
                "test": {
                    "score": -0.4319994095349368,
                    "pretrain_loss": 0.5354886651039124,
                    "features_accuracy": [
                        0.7778584957122803,
                        0.7071220874786377,
                        0.7466084957122803,
                        0.6843507885932922,
                        0.6860464811325073,
                        0.7109980583190918,
                        0.7843992114067078,
                        0.8013566136360168
                    ]
                }
            }
        },
        "train": {
            "score": -0.37593900468391606
        },
        "val": {
            "score": -0.44302348880211717
        },
        "test": {
            "score": -0.43415383139246505
        }
    },
    "best_iteration": 40000,
    "time": "0:26:10"
}
