{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask___23ebee2d278a465cab387c02e8244632.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 13,
        "data": {
            "path": "data/california",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "transformer",
            "config": {
                "n_blocks": 4,
                "attention_dropout": 0.006835950215068107,
                "ffn_dropout": 0.14201787610318556,
                "ffn_d_hidden": 695
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear"
            ],
            "d_num_embedding": 512,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.00031363259431556616,
            "weight_decay": 4.8674309203267864e-05,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.33783618095960377,
            "corrupt_strategy": "target_resample",
            "d_hidden_head": 512,
            "lr": 0.00031363259431556616,
            "weight_decay": 4.8674309203267864e-05,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": true,
            "early_stop_type": "finetune",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "epoch_size": 104,
    "n_parameters": 8759737,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -0.3957636648997219,
                    "pretrain_loss": 0.555742621421814,
                    "features_accuracy": [
                        0.7606934905052185,
                        0.7014914155006409,
                        0.7383602261543274,
                        0.6753728985786438,
                        0.6760542392730713,
                        0.690514087677002,
                        0.7588008642196655,
                        0.7771974205970764
                    ]
                },
                "val": {
                    "score": -0.45384444702489407,
                    "pretrain_loss": 0.5642883777618408,
                    "features_accuracy": [
                        0.7571904063224792,
                        0.6875567436218262,
                        0.7275204062461853,
                        0.6606115698814392,
                        0.6639418601989746,
                        0.6924008727073669,
                        0.7523463368415833,
                        0.7732364535331726
                    ]
                },
                "test": {
                    "score": -0.4561637112585268,
                    "pretrain_loss": 0.5559239387512207,
                    "features_accuracy": [
                        0.755329430103302,
                        0.6962209343910217,
                        0.7347383499145508,
                        0.6705426573753357,
                        0.681928277015686,
                        0.6867732405662537,
                        0.7577519416809082,
                        0.788517415523529
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -0.4009627371902132,
                    "pretrain_loss": 0.5456247329711914,
                    "features_accuracy": [
                        0.7711409330368042,
                        0.7027784585952759,
                        0.7324551939964294,
                        0.6793853044509888,
                        0.6754485964775085,
                        0.6984632015228271,
                        0.7744719982147217,
                        0.7894617319107056
                    ]
                },
                "val": {
                    "score": -0.4586892108291239,
                    "pretrain_loss": 0.5585999488830566,
                    "features_accuracy": [
                        0.7629427909851074,
                        0.692098081111908,
                        0.7247956395149231,
                        0.6603087782859802,
                        0.6615198254585266,
                        0.6960338950157166,
                        0.7683923840522766,
                        0.77414470911026
                    ]
                },
                "test": {
                    "score": -0.4464006484626917,
                    "pretrain_loss": 0.5507898926734924,
                    "features_accuracy": [
                        0.7659883499145508,
                        0.6969476938247681,
                        0.739098846912384,
                        0.6642441749572754,
                        0.6870154738426208,
                        0.6862887740135193,
                        0.7764050364494324,
                        0.7967538833618164
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -0.42204369132319886,
                    "pretrain_loss": 0.5377301573753357,
                    "features_accuracy": [
                        0.7772731184959412,
                        0.7049738764762878,
                        0.7380574345588684,
                        0.6871830224990845,
                        0.6772655248641968,
                        0.7040654420852661,
                        0.7750776410102844,
                        0.799152135848999
                    ]
                },
                "val": {
                    "score": -0.45875024945759074,
                    "pretrain_loss": 0.5537452101707458,
                    "features_accuracy": [
                        0.7602179646492004,
                        0.6936118602752686,
                        0.7338783144950867,
                        0.6615198254585266,
                        0.6642446517944336,
                        0.7026945352554321,
                        0.7723281979560852,
                        0.7904934883117676
                    ]
                },
                "test": {
                    "score": -0.45000024393026783,
                    "pretrain_loss": 0.5442156195640564,
                    "features_accuracy": [
                        0.7713178396224976,
                        0.6988856792449951,
                        0.7359496355056763,
                        0.6630329489707947,
                        0.6862887740135193,
                        0.6901647448539734,
                        0.779312014579773,
                        0.8023256063461304
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -0.3829917226569857,
                    "pretrain_loss": 0.533845841884613,
                    "features_accuracy": [
                        0.7778030633926392,
                        0.7144371271133423,
                        0.7336664795875549,
                        0.6874101161956787,
                        0.678552508354187,
                        0.7061852216720581,
                        0.7892346382141113,
                        0.7968809604644775
                    ]
                },
                "val": {
                    "score": -0.4533374522724402,
                    "pretrain_loss": 0.551331639289856,
                    "features_accuracy": [
                        0.7623372673988342,
                        0.6930063366889954,
                        0.7381168603897095,
                        0.6639418601989746,
                        0.6636391282081604,
                        0.7011807560920715,
                        0.7747502326965332,
                        0.783832848072052
                    ]
                },
                "test": {
                    "score": -0.44784772320655747,
                    "pretrain_loss": 0.5438762903213501,
                    "features_accuracy": [
                        0.7642926573753357,
                        0.7044573426246643,
                        0.7417635917663574,
                        0.6686046719551086,
                        0.692829430103302,
                        0.6971899271011353,
                        0.7805232405662537,
                        0.8020833134651184
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": -0.33128910535783096,
                    "pretrain_loss": 0.526732861995697,
                    "features_accuracy": [
                        0.7823454141616821,
                        0.7048224806785583,
                        0.7413884997367859,
                        0.6839276552200317,
                        0.6842304468154907,
                        0.7185252904891968,
                        0.795972466468811,
                        0.8109622597694397
                    ]
                },
                "val": {
                    "score": -0.4410524135496429,
                    "pretrain_loss": 0.5471243858337402,
                    "features_accuracy": [
                        0.7683923840522766,
                        0.68967604637146,
                        0.7317590117454529,
                        0.6630336046218872,
                        0.6681804656982422,
                        0.7123826742172241,
                        0.786557674407959,
                        0.7923099994659424
                    ]
                },
                "test": {
                    "score": -0.446238708115886,
                    "pretrain_loss": 0.5383844375610352,
                    "features_accuracy": [
                        0.7785852551460266,
                        0.7066376209259033,
                        0.7381298542022705,
                        0.6673933863639832,
                        0.6901647448539734,
                        0.6954941749572754,
                        0.7882751822471619,
                        0.8076550364494324
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": -0.3668483337194274,
                    "pretrain_loss": 0.5236655473709106,
                    "features_accuracy": [
                        0.7794685959815979,
                        0.7145128846168518,
                        0.7429782748222351,
                        0.6815050840377808,
                        0.6809751391410828,
                        0.7213264107704163,
                        0.7971837520599365,
                        0.8097509741783142
                    ]
                },
                "val": {
                    "score": -0.44960100272003883,
                    "pretrain_loss": 0.5439556837081909,
                    "features_accuracy": [
                        0.769300639629364,
                        0.7023917436599731,
                        0.7402361631393433,
                        0.6660611629486084,
                        0.669996976852417,
                        0.7148047089576721,
                        0.7871631979942322,
                        0.7947320342063904
                    ]
                },
                "test": {
                    "score": -0.435116520941282,
                    "pretrain_loss": 0.5367631316184998,
                    "features_accuracy": [
                        0.7751938104629517,
                        0.7034883499145508,
                        0.742732584476471,
                        0.6703003644943237,
                        0.6911337375640869,
                        0.6969476938247681,
                        0.786579430103302,
                        0.8168604373931885
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": -0.32274094771112527,
                    "pretrain_loss": 0.5325727462768555,
                    "features_accuracy": [
                        0.7768945693969727,
                        0.7170111536979675,
                        0.7450223565101624,
                        0.6790067553520203,
                        0.6780982613563538,
                        0.7076236009597778,
                        0.7963510155677795,
                        0.8079339861869812
                    ]
                },
                "val": {
                    "score": -0.444016040505189,
                    "pretrain_loss": 0.5392922759056091,
                    "features_accuracy": [
                        0.7705116271972656,
                        0.7029972672462463,
                        0.7405388951301575,
                        0.6618225574493408,
                        0.6693914532661438,
                        0.7145019769668579,
                        0.7907962203025818,
                        0.79654860496521
                    ]
                },
                "test": {
                    "score": -0.4314800275258737,
                    "pretrain_loss": 0.5331374406814575,
                    "features_accuracy": [
                        0.7727712988853455,
                        0.7109980583190918,
                        0.7458817958831787,
                        0.6734496355056763,
                        0.6906492114067078,
                        0.7013081312179565,
                        0.7962693572044373,
                        0.8076550364494324
                    ]
                }
            },
            "80000": {
                "train": {
                    "score": -0.32393780757788415,
                    "pretrain_loss": 0.5222285389900208,
                    "features_accuracy": [
                        0.7849950790405273,
                        0.7230676412582397,
                        0.7494890093803406,
                        0.6871073246002197,
                        0.6786282062530518,
                        0.715799868106842,
                        0.7979408502578735,
                        0.8145961165428162
                    ]
                },
                "val": {
                    "score": -0.44364611559807293,
                    "pretrain_loss": 0.5370820760726929,
                    "features_accuracy": [
                        0.7744474411010742,
                        0.7020890116691589,
                        0.7459884881973267,
                        0.665152907371521,
                        0.6718134880065918,
                        0.7096579074859619,
                        0.7944293022155762,
                        0.8010899424552917
                    ]
                },
                "test": {
                    "score": -0.4300505928932268,
                    "pretrain_loss": 0.5290363430976868,
                    "features_accuracy": [
                        0.7783430218696594,
                        0.7102712988853455,
                        0.7497577667236328,
                        0.6732073426246643,
                        0.6870154738426208,
                        0.705910861492157,
                        0.7957848906517029,
                        0.8141957521438599
                    ]
                }
            }
        },
        "train": {
            "score": -0.33128910535783096
        },
        "val": {
            "score": -0.4410524135496429
        },
        "test": {
            "score": -0.446238708115886
        }
    },
    "best_iteration": 50000,
    "time": "0:29:56"
}
