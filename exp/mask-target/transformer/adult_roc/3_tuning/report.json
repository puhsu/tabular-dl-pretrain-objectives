{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/tune.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 0,
        "program": "bin/pretrain_mask.py",
        "base_config": {
            "seed": 0,
            "data": {
                "T_cache": true,
                "path": "data/adult_roc",
                "T": {
                    "normalization": "quantile"
                }
            },
            "model": {
                "kind": "transformer",
                "num_embedding_arch": [
                    "linear"
                ],
                "d_num_embedding": 512
            },
            "training": {
                "batch_size": 256,
                "patience": 16
            },
            "pretrain": {
                "corrupt_strategy": "target_resample",
                "use_target": true,
                "patience": 2,
                "d_hidden_head": 512
            }
        },
        "space": {
            "model": {
                "config": {
                    "n_blocks": [
                        "int",
                        1,
                        4
                    ],
                    "attention_dropout": [
                        "uniform",
                        0.0,
                        0.5
                    ],
                    "ffn_d_hidden_factor": [
                        "uniform",
                        0.6666666666666666,
                        2.6666666666666665
                    ],
                    "ffn_dropout": [
                        "uniform",
                        0.0,
                        0.5
                    ]
                }
            },
            "pretrain": {
                "corrupt_probability": [
                    "uniform",
                    0.2,
                    0.8
                ]
            },
            "training": {
                "lr": [
                    "loguniform",
                    5e-05,
                    0.005
                ],
                "weight_decay": [
                    "?loguniform",
                    0.0,
                    1e-06,
                    0.001
                ]
            }
        },
        "n_trials": 100,
        "timeout": null,
        "sampler": {
            "seed": 0
        }
    },
    "best": {
        "program": "bin/pretrain_mask.py",
        "environment": {
            "CUDA_VISIBLE_DEVICES": "0",
            "gpus": {
                "driver": "450.119.04",
                "devices": [
                    {
                        "name": "A100-SXM-80GB",
                        "memory_total": 85199093760,
                        "memory_free": 85195948032,
                        "memory_used": 3145728,
                        "utilization": 0
                    }
                ]
            },
            "torch.version.cuda": "11.1",
            "torch.backends.cudnn.version()": 8005,
            "torch.cuda.nccl.version()": [
                2,
                10,
                3
            ]
        },
        "config": {
            "seed": 0,
            "data": {
                "path": "data/adult_roc",
                "T": {
                    "seed": 0,
                    "normalization": "quantile",
                    "num_nan_policy": null,
                    "cat_nan_policy": null,
                    "cat_min_frequency": null,
                    "cat_encoding": null,
                    "y_policy": "default"
                },
                "T_cache": true
            },
            "model": {
                "kind": "transformer",
                "config": {
                    "n_blocks": 4,
                    "attention_dropout": 0.19661167000503335,
                    "ffn_dropout": 0.3036376970184162,
                    "ffn_d_hidden": 1260
                },
                "default": true,
                "checkpoint": null,
                "num_embedding_arch": [
                    "linear"
                ],
                "d_num_embedding": 512,
                "positional_encoding": null,
                "d_cat_embedding": null
            },
            "training": {
                "batch_size": 256,
                "lr": 0.0002112111165689482,
                "weight_decay": 0.0008661658148375812,
                "optimizer": "AdamW",
                "patience": 16,
                "n_epochs": Infinity,
                "eval_batch_size": 8192
            },
            "pretrain": {
                "corrupt_probability": 0.573348044811588,
                "corrupt_strategy": "target_resample",
                "d_hidden_head": 512,
                "lr": 0.0002112111165689482,
                "weight_decay": 0.0008661658148375812,
                "patience": 2,
                "n_iterations": 100000,
                "validate_every": 10000,
                "replace_strategy": "shuffle",
                "n_neighbors": 20,
                "use_target": true,
                "early_stop_type": "finetune",
                "target_injection_type": "post"
            },
            "bins": null
        },
        "epoch_size": 102,
        "n_parameters": 12289889,
        "metrics": {
            "iteration_scores": {
                "10000": {
                    "train": {
                        "score": 0.9280701330103953,
                        "pretrain_loss": 0.4690723717212677,
                        "features_accuracy": [
                            0.6038083434104919,
                            0.5800445079803467,
                            0.7267352342605591,
                            0.9312806725502014,
                            0.959613025188446,
                            0.6542152762413025,
                            0.773840606212616,
                            0.7257754802703857,
                            0.743511974811554,
                            0.6385902762413025,
                            0.7212454080581665,
                            0.8740018010139465,
                            0.7852042317390442,
                            0.9143120050430298
                        ]
                    },
                    "val": {
                        "score": 0.9174056199830791,
                        "pretrain_loss": 0.469681978225708,
                        "features_accuracy": [
                            0.6061722636222839,
                            0.5802241563796997,
                            0.7245509028434753,
                            0.9362812638282776,
                            0.9548594951629639,
                            0.6589897274971008,
                            0.7804391384124756,
                            0.7262398600578308,
                            0.7451251149177551,
                            0.6391831636428833,
                            0.7147244215011597,
                            0.882542610168457,
                            0.785352349281311,
                            0.9089513421058655
                        ]
                    },
                    "test": {
                        "score": 0.9133485283118603,
                        "pretrain_loss": 0.47104036808013916,
                        "features_accuracy": [
                            0.6048768758773804,
                            0.5720779299736023,
                            0.7252011895179749,
                            0.9336650371551514,
                            0.9576193690299988,
                            0.6495301723480225,
                            0.771758496761322,
                            0.7285793423652649,
                            0.7447946071624756,
                            0.6394570469856262,
                            0.7178306579589844,
                            0.8749462962150574,
                            0.7786991596221924,
                            0.9148701429367065
                        ]
                    }
                },
                "20000": {
                    "train": {
                        "score": 0.9340346150691372,
                        "pretrain_loss": 0.4682522118091583,
                        "features_accuracy": [
                            0.6094133853912354,
                            0.5725583434104919,
                            0.7298064827919006,
                            0.9340064525604248,
                            0.9598433375358582,
                            0.651259183883667,
                            0.7797911167144775,
                            0.7268888354301453,
                            0.7482724189758301,
                            0.6347512006759644,
                            0.7239711284637451,
                            0.8731188178062439,
                            0.7848587036132812,
                            0.9112407565116882
                        ]
                    },
                    "val": {
                        "score": 0.9201052134706258,
                        "pretrain_loss": 0.4686020016670227,
                        "features_accuracy": [
                            0.6027944087982178,
                            0.5802241563796997,
                            0.722247838973999,
                            0.9347459077835083,
                            0.9551665782928467,
                            0.658682644367218,
                            0.7801320552825928,
                            0.7257792353630066,
                            0.7478888630867004,
                            0.6453247666358948,
                            0.7174881100654602,
                            0.8822355270385742,
                            0.7862735986709595,
                            0.9081836342811584
                        ]
                    },
                    "test": {
                        "score": 0.9147107967149406,
                        "pretrain_loss": 0.47032201290130615,
                        "features_accuracy": [
                            0.6080093383789062,
                            0.572139322757721,
                            0.7280879616737366,
                            0.9339107275009155,
                            0.9581721425056458,
                            0.6501443982124329,
                            0.7714514136314392,
                            0.7301763296127319,
                            0.7454087734222412,
                            0.6434494256973267,
                            0.7221301198005676,
                            0.8749462962150574,
                            0.778760552406311,
                            0.9139488339424133
                        ]
                    }
                },
                "30000": {
                    "train": {
                        "score": 0.9303524889342742,
                        "pretrain_loss": 0.467862606048584,
                        "features_accuracy": [
                            0.6049984693527222,
                            0.576742947101593,
                            0.7275030612945557,
                            0.9333537817001343,
                            0.9594210386276245,
                            0.6540617346763611,
                            0.7740325331687927,
                            0.7265433073043823,
                            0.7490402460098267,
                            0.6452318429946899,
                            0.7249308824539185,
                            0.8721974492073059,
                            0.7858568429946899,
                            0.9125076532363892
                        ]
                    },
                    "val": {
                        "score": 0.920770954994738,
                        "pretrain_loss": 0.4678381681442261,
                        "features_accuracy": [
                            0.6064793467521667,
                            0.5802241563796997,
                            0.720712423324585,
                            0.9352065324783325,
                            0.9551665782928467,
                            0.6626746654510498,
                            0.7812068462371826,
                            0.7277752161026001,
                            0.7491171360015869,
                            0.6381083726882935,
                            0.717795193195343,
                            0.8802395462989807,
                            0.7830492854118347,
                            0.911715030670166
                        ]
                    },
                    "test": {
                        "score": 0.9156413140321351,
                        "pretrain_loss": 0.4696383774280548,
                        "features_accuracy": [
                            0.6085007190704346,
                            0.572139322757721,
                            0.7276580333709717,
                            0.9343406558036804,
                            0.9589092135429382,
                            0.6514342427253723,
                            0.7702844142913818,
                            0.7299920320510864,
                            0.7463300824165344,
                            0.6403783559799194,
                            0.7175849676132202,
                            0.8742706775665283,
                            0.7767336368560791,
                            0.9132731556892395
                        ]
                    }
                },
                "40000": {
                    "train": {
                        "score": 0.9307528200142565,
                        "pretrain_loss": 0.46651691198349,
                        "features_accuracy": [
                            0.6086071729660034,
                            0.578700840473175,
                            0.7311117649078369,
                            0.9330850839614868,
                            0.9608414769172668,
                            0.6520270109176636,
                            0.7750691175460815,
                            0.7337607145309448,
                            0.7520731091499329,
                            0.6461532711982727,
                            0.7270039916038513,
                            0.8741937875747681,
                            0.7860104441642761,
                            0.9116630554199219
                        ]
                    },
                    "val": {
                        "score": 0.921447787911929,
                        "pretrain_loss": 0.46787458658218384,
                        "features_accuracy": [
                            0.604790449142456,
                            0.5802241563796997,
                            0.720712423324585,
                            0.9362812638282776,
                            0.9562413692474365,
                            0.6649777293205261,
                            0.7787501811981201,
                            0.7283893823623657,
                            0.746199905872345,
                            0.6421003937721252,
                            0.7184093594551086,
                            0.8811607360839844,
                            0.7848917841911316,
                            0.9111008644104004
                        ]
                    },
                    "test": {
                        "score": 0.9171655897196885,
                        "pretrain_loss": 0.46884557604789734,
                        "features_accuracy": [
                            0.6099748611450195,
                            0.5720779299736023,
                            0.7277194857597351,
                            0.9342792630195618,
                            0.9594619870185852,
                            0.6506971716880798,
                            0.7718199491500854,
                            0.7305448651313782,
                            0.7470057606697083,
                            0.6444321870803833,
                            0.7188133597373962,
                            0.8753762245178223,
                            0.7800503969192505,
                            0.9122904539108276
                        ]
                    }
                },
                "50000": {
                    "train": {
                        "score": 0.9322226393975103,
                        "pretrain_loss": 0.46524035930633545,
                        "features_accuracy": [
                            0.6084152460098267,
                            0.5732493996620178,
                            0.7272726893424988,
                            0.9336609244346619,
                            0.9606879353523254,
                            0.657171368598938,
                            0.7756065726280212,
                            0.7300752401351929,
                            0.7533015608787537,
                            0.6490325331687927,
                            0.7271575331687927,
                            0.8748080134391785,
                            0.7864711284637451,
                            0.913198709487915
                        ]
                    },
                    "val": {
                        "score": 0.9213598305854193,
                        "pretrain_loss": 0.46686244010925293,
                        "features_accuracy": [
                            0.5989559292793274,
                            0.5802241563796997,
                            0.7234761118888855,
                            0.9356671571731567,
                            0.9556272029876709,
                            0.6588361859321594,
                            0.7816674113273621,
                            0.7276216745376587,
                            0.7472746968269348,
                            0.6436358094215393,
                            0.7167204022407532,
                            0.8814678192138672,
                            0.7836634516716003,
                            0.9098725914955139
                        ]
                    },
                    "test": {
                        "score": 0.9171961281346308,
                        "pretrain_loss": 0.4683583974838257,
                        "features_accuracy": [
                            0.6110804080963135,
                            0.5720779299736023,
                            0.7295006513595581,
                            0.9344635009765625,
                            0.959216296672821,
                            0.6505743265151978,
                            0.7721270322799683,
                            0.7307291030883789,
                            0.7473742961883545,
                            0.6408083438873291,
                            0.7212702035903931,
                            0.8761132955551147,
                            0.7762422561645508,
                            0.9131503105163574
                        ]
                    }
                },
                "60000": {
                    "train": {
                        "score": 0.9395956866090562,
                        "pretrain_loss": 0.4638683497905731,
                        "features_accuracy": [
                            0.6101812124252319,
                            0.5743626952171326,
                            0.7343366146087646,
                            0.9344671368598938,
                            0.9626075029373169,
                            0.6561732292175293,
                            0.7749155163764954,
                            0.7351428270339966,
                            0.7541845440864563,
                            0.6456925272941589,
                            0.7237791419029236,
                            0.8725429773330688,
                            0.7842828631401062,
                            0.9120469689369202
                        ]
                    },
                    "val": {
                        "score": 0.9209266214069045,
                        "pretrain_loss": 0.46607333421707153,
                        "features_accuracy": [
                            0.604022741317749,
                            0.5799170732498169,
                            0.7247044444084167,
                            0.9358206987380981,
                            0.9562413692474365,
                            0.6672808527946472,
                            0.7824351191520691,
                            0.7271610498428345,
                            0.7481959462165833,
                            0.6431751847267151,
                            0.7216336727142334,
                            0.8834638595581055,
                            0.7848917841911316,
                            0.9089513421058655
                        ]
                    },
                    "test": {
                        "score": 0.9155927515749605,
                        "pretrain_loss": 0.4677393138408661,
                        "features_accuracy": [
                            0.6131073236465454,
                            0.5720779299736023,
                            0.7285179495811462,
                            0.9343406558036804,
                            0.959216296672821,
                            0.6515570878982544,
                            0.7728641033172607,
                            0.7310976386070251,
                            0.7476813793182373,
                            0.6408697366714478,
                            0.7205331921577454,
                            0.8762361407279968,
                            0.7781463265419006,
                            0.9133960008621216
                        ]
                    }
                },
                "70000": {
                    "train": {
                        "score": 0.9330253934799333,
                        "pretrain_loss": 0.46352967619895935,
                        "features_accuracy": [
                            0.6147496700286865,
                            0.5770500302314758,
                            0.730305552482605,
                            0.9322788715362549,
                            0.9603040218353271,
                            0.665847659111023,
                            0.7767966389656067,
                            0.7311501502990723,
                            0.7510749101638794,
                            0.6441953182220459,
                            0.7309198379516602,
                            0.8753070831298828,
                            0.7902718186378479,
                            0.9142352342605591
                        ]
                    },
                    "val": {
                        "score": 0.9215309733600214,
                        "pretrain_loss": 0.46684542298316956,
                        "features_accuracy": [
                            0.6031014919281006,
                            0.5800706148147583,
                            0.7245509028434753,
                            0.9352065324783325,
                            0.9554736614227295,
                            0.6635959148406982,
                            0.781360387802124,
                            0.7280822992324829,
                            0.7480424046516418,
                            0.6421003937721252,
                            0.7179487347602844,
                            0.8830032348632812,
                            0.7836634516716003,
                            0.9114079475402832
                        ]
                    },
                    "test": {
                        "score": 0.9167202787830051,
                        "pretrain_loss": 0.46891313791275024,
                        "features_accuracy": [
                            0.6129844784736633,
                            0.5720164775848389,
                            0.7271052598953247,
                            0.9347706437110901,
                            0.9583563804626465,
                            0.6510657072067261,
                            0.7743382453918457,
                            0.727596640586853,
                            0.7481727600097656,
                            0.6428966522216797,
                            0.7202875018119812,
                            0.8770960569381714,
                            0.7765493988990784,
                            0.9135802984237671
                        ]
                    }
                },
                "80000": {
                    "train": {
                        "score": 0.9429219521465684,
                        "pretrain_loss": 0.4629833400249481,
                        "features_accuracy": [
                            0.6090678572654724,
                            0.5778562426567078,
                            0.7380220890045166,
                            0.9337760806083679,
                            0.9615325331687927,
                            0.6587454080581665,
                            0.7780635356903076,
                            0.7303439378738403,
                            0.7556050419807434,
                            0.6463451981544495,
                            0.7324170470237732,
                            0.8750767707824707,
                            0.7828623652458191,
                            0.9158092737197876
                        ]
                    },
                    "val": {
                        "score": 0.9215454179649615,
                        "pretrain_loss": 0.46548622846603394,
                        "features_accuracy": [
                            0.6049439907073975,
                            0.5817595720291138,
                            0.7257792353630066,
                            0.936434805393219,
                            0.9562413692474365,
                            0.6596038937568665,
                            0.7835099101066589,
                            0.7297712564468384,
                            0.750652551651001,
                            0.6437893509864807,
                            0.7190234661102295,
                            0.8826961517333984,
                            0.7851988673210144,
                            0.9114079475402832
                        ]
                    },
                    "test": {
                        "score": 0.9170973931840266,
                        "pretrain_loss": 0.46763738989830017,
                        "features_accuracy": [
                            0.6125545501708984,
                            0.5722007751464844,
                            0.7279037237167358,
                            0.9341564178466797,
                            0.9592777490615845,
                            0.6511270999908447,
                            0.7747067213058472,
                            0.7318961024284363,
                            0.747742772102356,
                            0.6429581046104431,
                            0.7233585715293884,
                            0.8766046762466431,
                            0.778084933757782,
                            0.9130275249481201
                        ]
                    }
                },
                "90000": {
                    "train": {
                        "score": 0.9351155343783674,
                        "pretrain_loss": 0.462821900844574,
                        "features_accuracy": [
                            0.6147880554199219,
                            0.5717905163764954,
                            0.7321867346763611,
                            0.9348126649856567,
                            0.9612253904342651,
                            0.6606265306472778,
                            0.7762975692749023,
                            0.7321867346763611,
                            0.7527257204055786,
                            0.6463835835456848,
                            0.7321099638938904,
                            0.8766123652458191,
                            0.7863175272941589,
                            0.9144272208213806
                        ]
                    },
                    "val": {
                        "score": 0.9236552330740182,
                        "pretrain_loss": 0.4658306837081909,
                        "features_accuracy": [
                            0.6086289286613464,
                            0.5831413865089417,
                            0.7243973612785339,
                            0.9370489716529846,
                            0.9557807445526123,
                            0.6629817485809326,
                            0.7812068462371826,
                            0.7274681329727173,
                            0.750652551651001,
                            0.6444035172462463,
                            0.7202517986297607,
                            0.8822355270385742,
                            0.7830492854118347,
                            0.9098725914955139
                        ]
                    },
                    "test": {
                        "score": 0.9180237808627747,
                        "pretrain_loss": 0.46788716316223145,
                        "features_accuracy": [
                            0.6123088598251343,
                            0.5727535486221313,
                            0.726552426815033,
                            0.9342792630195618,
                            0.9594619870185852,
                            0.6523555517196655,
                            0.7734783291816711,
                            0.7298077940940857,
                            0.7468214631080627,
                            0.6387814283370972,
                            0.7236656546592712,
                            0.8754376769065857,
                            0.7783306241035461,
                            0.9124746918678284
                        ]
                    }
                },
                "100000": {
                    "train": {
                        "score": 0.9352082480592784,
                        "pretrain_loss": 0.4629020690917969,
                        "features_accuracy": [
                            0.6098740696907043,
                            0.5808123350143433,
                            0.7372926473617554,
                            0.9323172569274902,
                            0.9619548320770264,
                            0.6592060923576355,
                            0.7798295021057129,
                            0.7308814525604248,
                            0.750575840473175,
                            0.6508368849754333,
                            0.7259674072265625,
                            0.8758829832077026,
                            0.7830543518066406,
                            0.915386974811554
                        ]
                    },
                    "val": {
                        "score": 0.9231268442665236,
                        "pretrain_loss": 0.46527552604675293,
                        "features_accuracy": [
                            0.6081683039665222,
                            0.5826808214187622,
                            0.7267004251480103,
                            0.9356671571731567,
                            0.9580838084220886,
                            0.6611392498016357,
                            0.7808997631072998,
                            0.7285429239273071,
                            0.7492706775665283,
                            0.6463994979858398,
                            0.7208659648895264,
                            0.8820819854736328,
                            0.7867342233657837,
                            0.9101796746253967
                        ]
                    },
                    "test": {
                        "score": 0.9182995570727532,
                        "pretrain_loss": 0.4676070511341095,
                        "features_accuracy": [
                            0.611940324306488,
                            0.5739819407463074,
                            0.7282108068466187,
                            0.9349548816680908,
                            0.9598305225372314,
                            0.649345874786377,
                            0.7719427943229675,
                            0.733001708984375,
                            0.7498311400413513,
                            0.6424052715301514,
                            0.7215773463249207,
                            0.8755605220794678,
                            0.7794976234436035,
                            0.9131503105163574
                        ]
                    }
                }
            },
            "train": {
                "score": 0.9351155343783674
            },
            "val": {
                "score": 0.9236552330740182
            },
            "test": {
                "score": 0.9180237808627747
            }
        },
        "best_iteration": 90000,
        "time": "0:35:29",
        "trial_id": 65,
        "tuning_time": "1 day, 4:47:45"
    },
    "time": "1 day, 23:28:07",
    "continuations": [
        1,
        5
    ]
}
