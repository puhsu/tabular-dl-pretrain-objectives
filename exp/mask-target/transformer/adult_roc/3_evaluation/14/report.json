{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask___80d1755969cd4206af31fc63fa65dcf6.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 14,
        "data": {
            "path": "data/adult_roc",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "transformer",
            "config": {
                "n_blocks": 4,
                "attention_dropout": 0.19661167000503335,
                "ffn_dropout": 0.3036376970184162,
                "ffn_d_hidden": 1260
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear"
            ],
            "d_num_embedding": 512,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 256,
            "lr": 0.0002112111165689482,
            "weight_decay": 0.0008661658148375812,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.573348044811588,
            "corrupt_strategy": "target_resample",
            "d_hidden_head": 512,
            "lr": 0.0002112111165689482,
            "weight_decay": 0.0008661658148375812,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "shuffle",
            "n_neighbors": 20,
            "use_target": true,
            "early_stop_type": "finetune",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "epoch_size": 102,
    "n_parameters": 12289889,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": 0.9286499179857568,
                    "pretrain_loss": 0.46958670020103455,
                    "features_accuracy": [
                        0.6117168068885803,
                        0.5739403963088989,
                        0.7257754802703857,
                        0.9340448379516602,
                        0.9606111645698547,
                        0.6574785113334656,
                        0.7714987397193909,
                        0.7238175272941589,
                        0.7414004802703857,
                        0.641200840473175,
                        0.7218980193138123,
                        0.8723126649856567,
                        0.7831311225891113,
                        0.9146575331687927
                    ]
                },
                "val": {
                    "score": 0.9187734724830277,
                    "pretrain_loss": 0.4703931212425232,
                    "features_accuracy": [
                        0.6083218455314636,
                        0.5707047581672668,
                        0.7288500070571899,
                        0.9370489716529846,
                        0.9550130367279053,
                        0.6628282070159912,
                        0.7735298871994019,
                        0.7245509028434753,
                        0.7434362173080444,
                        0.6384154558181763,
                        0.7217872142791748,
                        0.8787041306495667,
                        0.7762935757637024,
                        0.9057270288467407
                    ]
                },
                "test": {
                    "score": 0.9150121453189449,
                    "pretrain_loss": 0.47133156657218933,
                    "features_accuracy": [
                        0.6080707907676697,
                        0.574964702129364,
                        0.7277194857597351,
                        0.9353848695755005,
                        0.9595848321914673,
                        0.6449235677719116,
                        0.7685031890869141,
                        0.7280879616737366,
                        0.7447946071624756,
                        0.6331921219825745,
                        0.720594584941864,
                        0.8765432238578796,
                        0.778637707233429,
                        0.9133346080780029
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": 0.9309301537724235,
                    "pretrain_loss": 0.46772998571395874,
                    "features_accuracy": [
                        0.6078009605407715,
                        0.5734029412269592,
                        0.7295761704444885,
                        0.9314342737197876,
                        0.9599969387054443,
                        0.6547527313232422,
                        0.7724201083183289,
                        0.7259290218353271,
                        0.7485411167144775,
                        0.6376689076423645,
                        0.7243166565895081,
                        0.8733875751495361,
                        0.7881603240966797,
                        0.9138513207435608
                    ]
                },
                "val": {
                    "score": 0.9201031499556344,
                    "pretrain_loss": 0.4687759280204773,
                    "features_accuracy": [
                        0.6176877021789551,
                        0.5707047581672668,
                        0.7316136956214905,
                        0.9379702210426331,
                        0.9556272029876709,
                        0.6657454371452332,
                        0.7701520323753357,
                        0.7202517986297607,
                        0.7486565113067627,
                        0.645017683506012,
                        0.7199447154998779,
                        0.8788576722145081,
                        0.7782895565032959,
                        0.9052664041519165
                    ]
                },
                "test": {
                    "score": 0.9153949575755448,
                    "pretrain_loss": 0.46939995884895325,
                    "features_accuracy": [
                        0.6083778738975525,
                        0.574964702129364,
                        0.7293164134025574,
                        0.9359990358352661,
                        0.9609361290931702,
                        0.6455991864204407,
                        0.7700387239456177,
                        0.7263067960739136,
                        0.7434433102607727,
                        0.6413611173629761,
                        0.7197961211204529,
                        0.8761132955551147,
                        0.7779006361961365,
                        0.9146244525909424
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": 0.933122315189836,
                    "pretrain_loss": 0.46638035774230957,
                    "features_accuracy": [
                        0.6137515306472778,
                        0.5770116448402405,
                        0.7303823828697205,
                        0.9335073828697205,
                        0.9593826532363892,
                        0.6570945978164673,
                        0.7736870050430298,
                        0.728923499584198,
                        0.751842737197876,
                        0.6450015306472778,
                        0.7221283912658691,
                        0.8734643459320068,
                        0.7878531813621521,
                        0.9113559126853943
                    ]
                },
                "val": {
                    "score": 0.9218782887270176,
                    "pretrain_loss": 0.4689139127731323,
                    "features_accuracy": [
                        0.6149240136146545,
                        0.5705512166023254,
                        0.7294641733169556,
                        0.9358206987380981,
                        0.9547059535980225,
                        0.6608321666717529,
                        0.7701520323753357,
                        0.7230154871940613,
                        0.7492706775665283,
                        0.6417933106422424,
                        0.7204053401947021,
                        0.8791647553443909,
                        0.7773683667182922,
                        0.9057270288467407
                    ]
                },
                "test": {
                    "score": 0.9166315804220428,
                    "pretrain_loss": 0.4692398011684418,
                    "features_accuracy": [
                        0.6065352559089661,
                        0.5750261545181274,
                        0.7324488759040833,
                        0.9345863461494446,
                        0.9598305225372314,
                        0.646643340587616,
                        0.7686260342597961,
                        0.7285179495811462,
                        0.7461458444595337,
                        0.6407468914985657,
                        0.7222529649734497,
                        0.8783859014511108,
                        0.7769793272018433,
                        0.9133960008621216
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": 0.9327075300945618,
                    "pretrain_loss": 0.4657224416732788,
                    "features_accuracy": [
                        0.6113712787628174,
                        0.5763206481933594,
                        0.7294609546661377,
                        0.9333153963088989,
                        0.9605727791786194,
                        0.6577088236808777,
                        0.7713835835456848,
                        0.7318795919418335,
                        0.7551443576812744,
                        0.641085684299469,
                        0.7299984693527222,
                        0.8762285113334656,
                        0.7867782115936279,
                        0.9133522510528564
                    ]
                },
                "val": {
                    "score": 0.9196024896308372,
                    "pretrain_loss": 0.4687325060367584,
                    "features_accuracy": [
                        0.6144633889198303,
                        0.5707047581672668,
                        0.7319207787513733,
                        0.9390450119972229,
                        0.9570090770721436,
                        0.6606786251068115,
                        0.7742975354194641,
                        0.7216336727142334,
                        0.7488100528717041,
                        0.6411792039871216,
                        0.7216336727142334,
                        0.8771687150001526,
                        0.7785966396331787,
                        0.9074159264564514
                    ]
                },
                "test": {
                    "score": 0.9165325736471358,
                    "pretrain_loss": 0.46869009733200073,
                    "features_accuracy": [
                        0.6099134087562561,
                        0.574964702129364,
                        0.7319575548171997,
                        0.935200572013855,
                        0.9601990580558777,
                        0.6459677219390869,
                        0.7701001763343811,
                        0.7284564971923828,
                        0.7482956051826477,
                        0.6424052715301514,
                        0.720594584941864,
                        0.8779559135437012,
                        0.7769793272018433,
                        0.9141945242881775
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": 0.9390811220523894,
                    "pretrain_loss": 0.4636061191558838,
                    "features_accuracy": [
                        0.6114096641540527,
                        0.5769348740577698,
                        0.7309198379516602,
                        0.9337376952171326,
                        0.9606111645698547,
                        0.6598587036132812,
                        0.7754145860671997,
                        0.7313805222511292,
                        0.7530328631401062,
                        0.6456925272941589,
                        0.7302287817001343,
                        0.8758829832077026,
                        0.7878147959709167,
                        0.9155789017677307
                    ]
                },
                "val": {
                    "score": 0.920610129795093,
                    "pretrain_loss": 0.46756160259246826,
                    "features_accuracy": [
                        0.6132350564002991,
                        0.5708582997322083,
                        0.7320743203163147,
                        0.9391985535621643,
                        0.9563949108123779,
                        0.6628282070159912,
                        0.7758329510688782,
                        0.7257792353630066,
                        0.7488100528717041,
                        0.6456317901611328,
                        0.7236296534538269,
                        0.8788576722145081,
                        0.7787501811981201,
                        0.9069553017616272
                    ]
                },
                "test": {
                    "score": 0.9163230598383565,
                    "pretrain_loss": 0.4680679142475128,
                    "features_accuracy": [
                        0.6099134087562561,
                        0.574964702129364,
                        0.7329402565956116,
                        0.9353848695755005,
                        0.9607518315315247,
                        0.646643340587616,
                        0.7688103318214417,
                        0.7310976386070251,
                        0.7488483786582947,
                        0.6408083438873291,
                        0.7214545011520386,
                        0.8784472942352295,
                        0.778637707233429,
                        0.914563000202179
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": 0.9349215700381887,
                    "pretrain_loss": 0.4646155536174774,
                    "features_accuracy": [
                        0.6151335835456848,
                        0.5704468488693237,
                        0.7293074131011963,
                        0.9323556423187256,
                        0.9615325331687927,
                        0.6578239798545837,
                        0.7786778211593628,
                        0.7326858043670654,
                        0.7529944777488708,
                        0.6458461284637451,
                        0.7258138656616211,
                        0.8758062124252319,
                        0.789465606212616,
                        0.9165002703666687
                    ]
                },
                "val": {
                    "score": 0.9203605734508161,
                    "pretrain_loss": 0.46716463565826416,
                    "features_accuracy": [
                        0.612160325050354,
                        0.5707047581672668,
                        0.7294641733169556,
                        0.9395056366920471,
                        0.9560878276824951,
                        0.6626746654510498,
                        0.7726086378097534,
                        0.7240902781486511,
                        0.7488100528717041,
                        0.6427145600318909,
                        0.7231690287590027,
                        0.8800860047340393,
                        0.7796714305877686,
                        0.90726238489151
                    ]
                },
                "test": {
                    "score": 0.9174385535936114,
                    "pretrain_loss": 0.46741923689842224,
                    "features_accuracy": [
                        0.6110804080963135,
                        0.574964702129364,
                        0.7318961024284363,
                        0.9359376430511475,
                        0.9614274501800537,
                        0.6478103399276733,
                        0.7706529498100281,
                        0.7314661741256714,
                        0.7484184503555298,
                        0.640009880065918,
                        0.7231742739677429,
                        0.8781402111053467,
                        0.778637707233429,
                        0.9153615236282349
                    ]
                }
            }
        },
        "train": {
            "score": 0.933122315189836
        },
        "val": {
            "score": 0.9218782887270176
        },
        "test": {
            "score": 0.9166315804220428
        }
    },
    "best_iteration": 30000,
    "time": "0:21:20"
}
