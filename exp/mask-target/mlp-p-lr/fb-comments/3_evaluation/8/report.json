{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_fast___88f334f0dee44fc782727ac73dc94e4f.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0,1",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                },
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 8,
        "data": {
            "path": "data/fb-comments",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512
                ],
                "dropout": 0.3165243883109578
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "positional",
                "linear",
                "relu"
            ],
            "d_num_embedding": 11,
            "positional_encoding": {
                "n": 35,
                "sigma": 0.3078928096197865,
                "trainable": true,
                "initialization": "normal"
            },
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 512,
            "lr": 0.00015569191898648328,
            "weight_decay": 0.0007948790593667655,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 1024
        },
        "pretrain": {
            "corrupt_probability": 0.7425803516231099,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.00015569191898648328,
            "weight_decay": 0.0007948790593667655,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "target_shuffle",
            "n_neighbors": 20,
            "use_target": true,
            "early_stop_type": "pretrain",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "n_parameters": 653715,
    "epoch_size": 308,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "pretrain_loss": 0.16340301930904388,
                    "features_accuracy": [
                        0.9668861627578735,
                        0.7744262218475342,
                        0.9648625254631042,
                        0.9687575697898865,
                        0.9248087406158447,
                        0.9660171270370483,
                        0.966327965259552,
                        0.9668988585472107,
                        0.905619204044342,
                        0.966061532497406,
                        0.9958829879760742,
                        0.9665119051933289,
                        0.9663088917732239,
                        0.9665436148643494,
                        0.9534757137298584,
                        0.9660488367080688,
                        0.9662454724311829,
                        0.9640759229660034,
                        0.9661122560501099,
                        0.9210786819458008,
                        0.9666768312454224,
                        0.9418985247612,
                        0.8840571641921997,
                        0.9360306859016418,
                        0.9388282299041748,
                        0.9375214576721191,
                        0.9523782730102539,
                        0.9620015621185303,
                        0.9614052772521973,
                        0.9855619072914124,
                        0.8783605694770813,
                        0.995940089225769,
                        0.8888339400291443,
                        0.8834608793258667,
                        0.8796166181564331,
                        0.8883517980575562,
                        0.8864677548408508,
                        0.8942006826400757,
                        0.8920121192932129,
                        0.8951331973075867,
                        0.8658508658409119,
                        0.885877788066864,
                        0.9650972485542297,
                        0.8810439109802246,
                        0.8889861702919006,
                        0.889804482460022,
                        0.9667085409164429,
                        0.955581784248352,
                        0.9660805463790894,
                        0.9971200227737427,
                        0.9628579616546631
                    ]
                },
                "val": {
                    "pretrain_loss": 0.5850880146026611,
                    "features_accuracy": [
                        0.737653374671936,
                        0.8630463480949402,
                        0.728577196598053,
                        0.7303518652915955,
                        0.42992594838142395,
                        0.7406449317932129,
                        0.7382110953330994,
                        0.4476219415664673,
                        0.4717574119567871,
                        0.7524084448814392,
                        0.9924449324607849,
                        0.7357265949249268,
                        0.7378054857254028,
                        0.7409491539001465,
                        0.505628228187561,
                        0.737653374671936,
                        0.7401378750801086,
                        0.7355237603187561,
                        0.7284250855445862,
                        0.5628739595413208,
                        0.6378155946731567,
                        0.7224419116973877,
                        0.45188114047050476,
                        0.400567889213562,
                        0.715089738368988,
                        0.6595679521560669,
                        0.7336477041244507,
                        0.7399351000785828,
                        0.5278876423835754,
                        0.9855998158454895,
                        0.88221275806427,
                        0.992242157459259,
                        0.8570631742477417,
                        0.8555927276611328,
                        0.8509785532951355,
                        0.856201171875,
                        0.8515870571136475,
                        0.8313558101654053,
                        0.8609673976898193,
                        0.8470743298530579,
                        0.8636547923088074,
                        0.8525504469871521,
                        0.45842206478118896,
                        0.8461616039276123,
                        0.858381450176239,
                        0.8591927289962769,
                        0.7392252087593079,
                        0.5800628662109375,
                        0.7372984290122986,
                        0.9955886602401733,
                        0.7186897397041321
                    ]
                },
                "test": {
                    "pretrain_loss": 0.4484312832355499,
                    "features_accuracy": [
                        0.742748498916626,
                        0.6392495036125183,
                        0.7330121994018555,
                        0.7714502811431885,
                        0.7935091257095337,
                        0.7580628991127014,
                        0.7454867959022522,
                        0.7776876091957092,
                        0.8158215284347534,
                        0.748884379863739,
                        0.9935598373413086,
                        0.7411764860153198,
                        0.7411764860153198,
                        0.7752535343170166,
                        0.7949796915054321,
                        0.7584685683250427,
                        0.7493407726287842,
                        0.744979739189148,
                        0.735040545463562,
                        0.8103448152542114,
                        0.772210955619812,
                        0.7778397798538208,
                        0.8696247339248657,
                        0.6549695730209351,
                        0.7566937208175659,
                        0.8370182514190674,
                        0.7332150340080261,
                        0.7419371008872986,
                        0.7295131683349609,
                        0.9845842123031616,
                        0.8868661522865295,
                        0.9934584498405457,
                        0.8516227006912231,
                        0.8515213131904602,
                        0.8478701710700989,
                        0.8714503049850464,
                        0.8666836023330688,
                        0.8701318502426147,
                        0.8630831837654114,
                        0.687778890132904,
                        0.8849391341209412,
                        0.8589756488800049,
                        0.7695233225822449,
                        0.8465009927749634,
                        0.8548681735992432,
                        0.8518255352973938,
                        0.7457910776138306,
                        0.7934077382087708,
                        0.7601926922798157,
                        0.9968559741973877,
                        0.7193711996078491
                    ]
                }
            },
            "20000": {
                "train": {
                    "pretrain_loss": 0.15350086987018585,
                    "features_accuracy": [
                        0.9679772853851318,
                        0.8020654916763306,
                        0.9700389504432678,
                        0.9717961549758911,
                        0.9368997812271118,
                        0.9714409112930298,
                        0.9709461331367493,
                        0.970584511756897,
                        0.9224679470062256,
                        0.9708446264266968,
                        0.9960289001464844,
                        0.9690430164337158,
                        0.9707050323486328,
                        0.9717263579368591,
                        0.9593562483787537,
                        0.969988226890564,
                        0.9702926874160767,
                        0.9686687588691711,
                        0.9692396521568298,
                        0.9330111145973206,
                        0.970850944519043,
                        0.9472842812538147,
                        0.887273371219635,
                        0.9407630562782288,
                        0.9443091154098511,
                        0.9417716860771179,
                        0.9576752185821533,
                        0.9650465250015259,
                        0.9665055871009827,
                        0.9857014417648315,
                        0.8797752261161804,
                        0.9960479140281677,
                        0.8888402581214905,
                        0.8848437666893005,
                        0.8813167214393616,
                        0.8880282640457153,
                        0.8870386481285095,
                        0.8943465352058411,
                        0.8921009302139282,
                        0.89602130651474,
                        0.8672274351119995,
                        0.8875905871391296,
                        0.9711998701095581,
                        0.8822999596595764,
                        0.8885738253593445,
                        0.8905911445617676,
                        0.9717390537261963,
                        0.9608407020568848,
                        0.9704639911651611,
                        0.9976592063903809,
                        0.9626993536949158
                    ]
                },
                "val": {
                    "pretrain_loss": 0.6667541265487671,
                    "features_accuracy": [
                        0.7241151928901672,
                        0.8642125129699707,
                        0.5209917426109314,
                        0.4381401240825653,
                        0.2770003080368042,
                        0.38581278920173645,
                        0.6673257946968079,
                        0.7117938995361328,
                        0.4734813868999481,
                        0.619308352470398,
                        0.9926984906196594,
                        0.6944528818130493,
                        0.73060542345047,
                        0.38642123341560364,
                        0.6465875506401062,
                        0.6600750088691711,
                        0.7273095846176147,
                        0.6638271808624268,
                        0.7275124192237854,
                        0.5632288455963135,
                        0.271879106760025,
                        0.7253828048706055,
                        0.47388702630996704,
                        0.6758441925048828,
                        0.7181320190429688,
                        0.7297434210777283,
                        0.730656087398529,
                        0.7402899861335754,
                        0.3902748227119446,
                        0.9844335913658142,
                        0.8882465958595276,
                        0.9924956560134888,
                        0.8585336208343506,
                        0.8592941761016846,
                        0.8444376587867737,
                        0.8573166728019714,
                        0.8520433902740479,
                        0.8073217272758484,
                        0.8651759028434753,
                        0.6732582449913025,
                        0.8668491840362549,
                        0.8548321723937988,
                        0.6876077055931091,
                        0.8465165495872498,
                        0.8584828972816467,
                        0.861068844795227,
                        0.6905485987663269,
                        0.4452895224094391,
                        0.73841392993927,
                        0.9962478280067444,
                        0.7159010171890259
                    ]
                },
                "test": {
                    "pretrain_loss": 0.43380311131477356,
                    "features_accuracy": [
                        0.7433062791824341,
                        0.6415314674377441,
                        0.7778904438018799,
                        0.8176470398902893,
                        0.8050709962844849,
                        0.7912271618843079,
                        0.7626774907112122,
                        0.7934584021568298,
                        0.812728226184845,
                        0.7895537614822388,
                        0.9934077262878418,
                        0.7440162301063538,
                        0.7740365266799927,
                        0.8026876449584961,
                        0.8005577921867371,
                        0.7731744647026062,
                        0.7645537853240967,
                        0.7680020332336426,
                        0.7350912690162659,
                        0.7883874177932739,
                        0.7810344696044922,
                        0.7878296375274658,
                        0.8581643104553223,
                        0.676622748374939,
                        0.778296172618866,
                        0.8351420164108276,
                        0.7335192561149597,
                        0.7419371008872986,
                        0.7367140054702759,
                        0.9824036359786987,
                        0.8950811624526978,
                        0.9936612844467163,
                        0.8502535820007324,
                        0.8515213131904602,
                        0.842292070388794,
                        0.857758641242981,
                        0.8533975481987,
                        0.8839249610900879,
                        0.8645537495613098,
                        0.8136409521102905,
                        0.8875253796577454,
                        0.8735294342041016,
                        0.8011156320571899,
                        0.8497464656829834,
                        0.8610547780990601,
                        0.8609533309936523,
                        0.7989351153373718,
                        0.806135892868042,
                        0.7825557589530945,
                        0.9969066977500916,
                        0.7193711996078491
                    ]
                }
            },
            "30000": {
                "train": {
                    "pretrain_loss": 0.1500001847743988,
                    "features_accuracy": [
                        0.9691699147224426,
                        0.8203986287117004,
                        0.9706987142562866,
                        0.9721704125404358,
                        0.9429389238357544,
                        0.9726842641830444,
                        0.9718215465545654,
                        0.9728428721427917,
                        0.9278092980384827,
                        0.9723988175392151,
                        0.9961875081062317,
                        0.970451295375824,
                        0.9718786478042603,
                        0.9730395078659058,
                        0.962775468826294,
                        0.9725193381309509,
                        0.9722782969474792,
                        0.9711364507675171,
                        0.9693792462348938,
                        0.9362907409667969,
                        0.9722529053688049,
                        0.9488575458526611,
                        0.88701331615448,
                        0.9419937133789062,
                        0.9457617998123169,
                        0.9423235654830933,
                        0.957852840423584,
                        0.9639680981636047,
                        0.9669432640075684,
                        0.9859424829483032,
                        0.8798766732215881,
                        0.996206521987915,
                        0.8895063400268555,
                        0.8843235969543457,
                        0.8802446126937866,
                        0.8873177766799927,
                        0.8881234526634216,
                        0.8946447372436523,
                        0.8921897411346436,
                        0.8961418271064758,
                        0.8678364753723145,
                        0.8873368501663208,
                        0.9726779460906982,
                        0.8830548524856567,
                        0.8894302248954773,
                        0.8902295231819153,
                        0.9720308780670166,
                        0.9635494351387024,
                        0.9733186364173889,
                        0.9979890584945679,
                        0.9624139070510864
                    ]
                },
                "val": {
                    "pretrain_loss": 0.7370699644088745,
                    "features_accuracy": [
                        0.624835193157196,
                        0.864719569683075,
                        0.32922622561454773,
                        0.6333028674125671,
                        0.2945948541164398,
                        0.4596896767616272,
                        0.3362742066383362,
                        0.5652063488960266,
                        0.4754081666469574,
                        0.4998478591442108,
                        0.9925970435142517,
                        0.24683094024658203,
                        0.4605516493320465,
                        0.29525402188301086,
                        0.641871988773346,
                        0.4467092454433441,
                        0.6915627121925354,
                        0.3142683207988739,
                        0.6344690918922424,
                        0.565662682056427,
                        0.2508366107940674,
                        0.7305546998977661,
                        0.4953351318836212,
                        0.726396918296814,
                        0.6666666269302368,
                        0.739833652973175,
                        0.736892819404602,
                        0.7404420971870422,
                        0.38718181848526,
                        0.9833688139915466,
                        0.8901733756065369,
                        0.9927998781204224,
                        0.8594970107078552,
                        0.8540715575218201,
                        0.8460094928741455,
                        0.8586350083351135,
                        0.8550349473953247,
                        0.7824257016181946,
                        0.8651252388954163,
                        0.8100597858428955,
                        0.8664435148239136,
                        0.8528546690940857,
                        0.3388601541519165,
                        0.8461109399795532,
                        0.8592434525489807,
                        0.8596997857093811,
                        0.6628130674362183,
                        0.5807220339775085,
                        0.5661190152168274,
                        0.9962478280067444,
                        0.7182334065437317
                    ]
                },
                "test": {
                    "pretrain_loss": 0.4292004406452179,
                    "features_accuracy": [
                        0.747768759727478,
                        0.6451318264007568,
                        0.783316433429718,
                        0.7969574332237244,
                        0.7918357253074646,
                        0.7963488698005676,
                        0.7858519554138184,
                        0.8057302236557007,
                        0.8131845593452454,
                        0.7935091257095337,
                        0.9935598373413086,
                        0.7602941393852234,
                        0.7865618467330933,
                        0.7991379499435425,
                        0.7874746322631836,
                        0.7879817485809326,
                        0.7813387513160706,
                        0.7970588207244873,
                        0.7528904676437378,
                        0.7816430330276489,
                        0.78554767370224,
                        0.7972109317779541,
                        0.8720081448554993,
                        0.7057809233665466,
                        0.786156177520752,
                        0.8496450185775757,
                        0.7657200694084167,
                        0.7419371008872986,
                        0.7469574213027954,
                        0.9829107522964478,
                        0.8981744647026062,
                        0.9936612844467163,
                        0.8503042459487915,
                        0.8518255352973938,
                        0.8444726467132568,
                        0.8570994138717651,
                        0.8546146154403687,
                        0.8821501135826111,
                        0.865517258644104,
                        0.8608012199401855,
                        0.8819472789764404,
                        0.8609026670455933,
                        0.8026369214057922,
                        0.8461460471153259,
                        0.8578600287437439,
                        0.852281928062439,
                        0.7814908623695374,
                        0.7981744408607483,
                        0.7972109317779541,
                        0.9969574213027954,
                        0.7196247577667236
                    ]
                }
            },
            "40000": {
                "train": {
                    "pretrain_loss": 0.14643731713294983,
                    "features_accuracy": [
                        0.9704893827438354,
                        0.8367906212806702,
                        0.9719230532646179,
                        0.9746444821357727,
                        0.9497392773628235,
                        0.9736167788505554,
                        0.9733757376670837,
                        0.9735406637191772,
                        0.9364239573478699,
                        0.9742828607559204,
                        0.9964412450790405,
                        0.9715805053710938,
                        0.9732044339179993,
                        0.9732552170753479,
                        0.9651797413825989,
                        0.9739657044410706,
                        0.9733123183250427,
                        0.9715424180030823,
                        0.9701721668243408,
                        0.9418478012084961,
                        0.9738515019416809,
                        0.9502277374267578,
                        0.8881678581237793,
                        0.9432941675186157,
                        0.9458189010620117,
                        0.9431609511375427,
                        0.9578274488449097,
                        0.9650782346725464,
                        0.968592643737793,
                        0.9858409762382507,
                        0.8806759715080261,
                        0.9964158535003662,
                        0.8889925479888916,
                        0.8871845602989197,
                        0.8830675482749939,
                        0.888148844242096,
                        0.8897791504859924,
                        0.8975374102592468,
                        0.8935599327087402,
                        0.896814227104187,
                        0.8683693408966064,
                        0.8889607787132263,
                        0.9732235074043274,
                        0.8842537999153137,
                        0.8918852210044861,
                        0.890337347984314,
                        0.9735977649688721,
                        0.9664294123649597,
                        0.9741433262825012,
                        0.9979573488235474,
                        0.9628833532333374
                    ]
                },
                "val": {
                    "pretrain_loss": 0.7664313912391663,
                    "features_accuracy": [
                        0.48291248083114624,
                        0.8601561188697815,
                        0.4624277353286743,
                        0.5582090616226196,
                        0.29804277420043945,
                        0.4536050856113434,
                        0.365682989358902,
                        0.6301591992378235,
                        0.47621944546699524,
                        0.4634418189525604,
                        0.9925970435142517,
                        0.22360815107822418,
                        0.6534833908081055,
                        0.6533820033073425,
                        0.5729641914367676,
                        0.5282425284385681,
                        0.6326944231987,
                        0.638221263885498,
                        0.6644863486289978,
                        0.570631742477417,
                        0.23790690302848816,
                        0.7159010171890259,
                        0.5070986747741699,
                        0.7348645925521851,
                        0.7092586755752563,
                        0.7414562106132507,
                        0.7340025901794434,
                        0.7403914332389832,
                        0.36309704184532166,
                        0.9822533130645752,
                        0.8829225897789001,
                        0.9925970435142517,
                        0.8600040078163147,
                        0.8543757796287537,
                        0.8448939919471741,
                        0.8605617880821228,
                        0.8536152243614197,
                        0.8011864423751831,
                        0.864618182182312,
                        0.6161139607429504,
                        0.8656322360038757,
                        0.856961727142334,
                        0.6461818814277649,
                        0.846364438533783,
                        0.8587363958358765,
                        0.8592941761016846,
                        0.6841598153114319,
                        0.6146942377090454,
                        0.6742216348648071,
                        0.9962478280067444,
                        0.717979907989502
                    ]
                },
                "test": {
                    "pretrain_loss": 0.42919498682022095,
                    "features_accuracy": [
                        0.747768759727478,
                        0.6436105370521545,
                        0.7868154048919678,
                        0.8011663556098938,
                        0.7938640713691711,
                        0.7925963401794434,
                        0.7752535343170166,
                        0.793914794921875,
                        0.811105489730835,
                        0.797768771648407,
                        0.9937119483947754,
                        0.7596349120140076,
                        0.7854462265968323,
                        0.7988336682319641,
                        0.7892494797706604,
                        0.7856490612030029,
                        0.7824036478996277,
                        0.7823529243469238,
                        0.7662271857261658,
                        0.7850912809371948,
                        0.7956389784812927,
                        0.7808823585510254,
                        0.8669371008872986,
                        0.714959442615509,
                        0.7881338596343994,
                        0.8712474703788757,
                        0.7491379380226135,
                        0.7419371008872986,
                        0.763843834400177,
                        0.9830628633499146,
                        0.9009127616882324,
                        0.9935598373413086,
                        0.8508113622665405,
                        0.8515213131904602,
                        0.8441176414489746,
                        0.8581643104553223,
                        0.854411780834198,
                        0.8824543356895447,
                        0.8636916875839233,
                        0.7874239683151245,
                        0.8843306303024292,
                        0.8731744289398193,
                        0.7913793325424194,
                        0.853904664516449,
                        0.8552231192588806,
                        0.8641988039016724,
                        0.8029412031173706,
                        0.7941176295280457,
                        0.7868154048919678,
                        0.9970081448554993,
                        0.719421923160553
                    ]
                }
            }
        },
        "train": {
            "score": -3.5357264020324655
        },
        "val": {
            "score": -5.277093962148371
        },
        "test": {
            "score": -5.50237175188479
        }
    },
    "best_iteration": 10000,
    "time": "0:04:30"
}
