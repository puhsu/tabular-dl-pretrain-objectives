{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_fast___88f334f0dee44fc782727ac73dc94e4f.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0,1",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                },
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 2,
        "data": {
            "path": "data/fb-comments",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512
                ],
                "dropout": 0.3165243883109578
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "positional",
                "linear",
                "relu"
            ],
            "d_num_embedding": 11,
            "positional_encoding": {
                "n": 35,
                "sigma": 0.3078928096197865,
                "trainable": true,
                "initialization": "normal"
            },
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 512,
            "lr": 0.00015569191898648328,
            "weight_decay": 0.0007948790593667655,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 1024
        },
        "pretrain": {
            "corrupt_probability": 0.7425803516231099,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.00015569191898648328,
            "weight_decay": 0.0007948790593667655,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "target_shuffle",
            "n_neighbors": 20,
            "use_target": true,
            "early_stop_type": "pretrain",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "n_parameters": 653715,
    "epoch_size": 308,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "pretrain_loss": 0.16330046951770782,
                    "features_accuracy": [
                        0.9660424590110779,
                        0.7784925103187561,
                        0.9640696048736572,
                        0.968656063079834,
                        0.9249546527862549,
                        0.967723548412323,
                        0.9661820530891418,
                        0.966854453086853,
                        0.9027455449104309,
                        0.9666007161140442,
                        0.9962953329086304,
                        0.965858519077301,
                        0.9665372967720032,
                        0.9682881236076355,
                        0.9516741037368774,
                        0.967717170715332,
                        0.9663342833518982,
                        0.9640188217163086,
                        0.966327965259552,
                        0.9215164184570312,
                        0.9656111001968384,
                        0.9424504637718201,
                        0.8850848078727722,
                        0.9368045926094055,
                        0.9349141716957092,
                        0.936043381690979,
                        0.9534503221511841,
                        0.9612783789634705,
                        0.9622679948806763,
                        0.9856507182121277,
                        0.8783478736877441,
                        0.9962953329086304,
                        0.8892906904220581,
                        0.8834291696548462,
                        0.8783859610557556,
                        0.8880600333213806,
                        0.8855796456336975,
                        0.8938644528388977,
                        0.8907687664031982,
                        0.895418643951416,
                        0.8655527234077454,
                        0.8877174258232117,
                        0.9655032753944397,
                        0.8799084424972534,
                        0.888339102268219,
                        0.8895444273948669,
                        0.9691064357757568,
                        0.9544018507003784,
                        0.9671335816383362,
                        0.997075617313385,
                        0.9623187780380249
                    ]
                },
                "val": {
                    "pretrain_loss": 0.5857195854187012,
                    "features_accuracy": [
                        0.7435858249664307,
                        0.8649224042892456,
                        0.7229996919631958,
                        0.7341040372848511,
                        0.3511306941509247,
                        0.719298243522644,
                        0.7318223118782043,
                        0.48321670293807983,
                        0.47216305136680603,
                        0.4825575351715088,
                        0.9929519891738892,
                        0.7328364253044128,
                        0.7342561483383179,
                        0.7470337748527527,
                        0.6118547916412354,
                        0.7305039763450623,
                        0.6073420643806458,
                        0.7322279214859009,
                        0.7332420349121094,
                        0.37577325105667114,
                        0.7286279201507568,
                        0.722847580909729,
                        0.4675489068031311,
                        0.4291146695613861,
                        0.7033769488334656,
                        0.720058798789978,
                        0.7300476431846619,
                        0.741202712059021,
                        0.6076462864875793,
                        0.9843828678131104,
                        0.8997566103935242,
                        0.9924956560134888,
                        0.8573673963546753,
                        0.8775985836982727,
                        0.8659365177154541,
                        0.8665449619293213,
                        0.8559983372688293,
                        0.8549842834472656,
                        0.863857626914978,
                        0.8119359016418457,
                        0.8737450242042542,
                        0.8527025580406189,
                        0.7395801544189453,
                        0.851992666721344,
                        0.8593448996543884,
                        0.8750633597373962,
                        0.7389717102050781,
                        0.6983064413070679,
                        0.7381097078323364,
                        0.9956393837928772,
                        0.7151404619216919
                    ]
                },
                "test": {
                    "pretrain_loss": 0.4473608434200287,
                    "features_accuracy": [
                        0.7420892715454102,
                        0.6379817724227905,
                        0.737170398235321,
                        0.8007606267929077,
                        0.7925963401794434,
                        0.7812373042106628,
                        0.7422921061515808,
                        0.748884379863739,
                        0.8169878125190735,
                        0.7510648965835571,
                        0.9934077262878418,
                        0.7402129769325256,
                        0.7582657337188721,
                        0.7715010046958923,
                        0.7814908623695374,
                        0.75,
                        0.7483265995979309,
                        0.7498986124992371,
                        0.7413285970687866,
                        0.8023833632469177,
                        0.7482251524925232,
                        0.7363590002059937,
                        0.8660243153572083,
                        0.6436105370521545,
                        0.7888438105583191,
                        0.8348884582519531,
                        0.7283468842506409,
                        0.7370689511299133,
                        0.7325050830841064,
                        0.9851927161216736,
                        0.876014232635498,
                        0.9940669536590576,
                        0.8529918789863586,
                        0.8537018299102783,
                        0.843813419342041,
                        0.8659736514091492,
                        0.8764705657958984,
                        0.8640466332435608,
                        0.8648580312728882,
                        0.8614604473114014,
                        0.8876774907112122,
                        0.8536003828048706,
                        0.7419878244400024,
                        0.8724644780158997,
                        0.8582656979560852,
                        0.8800709843635559,
                        0.7879310250282288,
                        0.7590263485908508,
                        0.7648580074310303,
                        0.9967545866966248,
                        0.7192697525024414
                    ]
                }
            },
            "20000": {
                "train": {
                    "pretrain_loss": 0.15340588986873627,
                    "features_accuracy": [
                        0.968453049659729,
                        0.8042160272598267,
                        0.968985915184021,
                        0.9708002209663391,
                        0.9357007741928101,
                        0.9701341390609741,
                        0.9711617827415466,
                        0.9712569713592529,
                        0.9196386933326721,
                        0.9704322814941406,
                        0.996206521987915,
                        0.9686179757118225,
                        0.9719293713569641,
                        0.9729633927345276,
                        0.959311842918396,
                        0.9702419638633728,
                        0.9706099033355713,
                        0.9687384963035583,
                        0.9684023261070251,
                        0.9337660074234009,
                        0.9709524512290955,
                        0.9479884505271912,
                        0.8861886262893677,
                        0.9398812651634216,
                        0.9433575868606567,
                        0.9415940642356873,
                        0.9574912190437317,
                        0.9643994569778442,
                        0.9658331274986267,
                        0.9857458472251892,
                        0.879737138748169,
                        0.9961938261985779,
                        0.8893795013427734,
                        0.8841269612312317,
                        0.8808472752571106,
                        0.8883771896362305,
                        0.8867595791816711,
                        0.8939278721809387,
                        0.8922467827796936,
                        0.8964653611183167,
                        0.8671703934669495,
                        0.8864360451698303,
                        0.9705020785331726,
                        0.8829851150512695,
                        0.8893224000930786,
                        0.889404833316803,
                        0.9712378978729248,
                        0.9623124003410339,
                        0.9710158705711365,
                        0.997735321521759,
                        0.9627564549446106
                    ]
                },
                "val": {
                    "pretrain_loss": 0.6656532287597656,
                    "features_accuracy": [
                        0.6045025587081909,
                        0.8665956854820251,
                        0.47662508487701416,
                        0.6985599398612976,
                        0.34038129448890686,
                        0.5432511568069458,
                        0.38718181848526,
                        0.7444984912872314,
                        0.46891793608665466,
                        0.6055166721343994,
                        0.9926477670669556,
                        0.7269039154052734,
                        0.4240441918373108,
                        0.751039445400238,
                        0.6903964877128601,
                        0.6991177201271057,
                        0.6433424353599548,
                        0.7303011417388916,
                        0.7257377505302429,
                        0.5589189529418945,
                        0.5728628039360046,
                        0.7281208634376526,
                        0.46759963035583496,
                        0.4689686596393585,
                        0.7215292453765869,
                        0.7140249013900757,
                        0.7110333442687988,
                        0.7413040995597839,
                        0.5204847455024719,
                        0.9848392605781555,
                        0.8986411094665527,
                        0.9926477670669556,
                        0.859649121761322,
                        0.8554912805557251,
                        0.8470743298530579,
                        0.8570631742477417,
                        0.851891279220581,
                        0.8581279516220093,
                        0.8606125116348267,
                        0.8154345154762268,
                        0.8819084763526917,
                        0.8524489998817444,
                        0.7420646548271179,
                        0.8450968265533447,
                        0.8580772280693054,
                        0.8652773499488831,
                        0.7352702617645264,
                        0.6485143303871155,
                        0.6955176591873169,
                        0.9959942698478699,
                        0.7168136835098267
                    ]
                },
                "test": {
                    "pretrain_loss": 0.43050962686538696,
                    "features_accuracy": [
                        0.7443711757659912,
                        0.6412779092788696,
                        0.7689655423164368,
                        0.8173428177833557,
                        0.7913286089897156,
                        0.8032454252243042,
                        0.7963488698005676,
                        0.7978701591491699,
                        0.8128803372383118,
                        0.7952839732170105,
                        0.9934584498405457,
                        0.7489351034164429,
                        0.782809317111969,
                        0.7959939241409302,
                        0.8112068772315979,
                        0.7690162062644958,
                        0.7782454490661621,
                        0.7715010046958923,
                        0.7415821552276611,
                        0.7996450066566467,
                        0.7991379499435425,
                        0.7823529243469238,
                        0.8779411911964417,
                        0.6641480922698975,
                        0.8111562132835388,
                        0.8465517163276672,
                        0.745537519454956,
                        0.7370689511299133,
                        0.751724123954773,
                        0.9841784834861755,
                        0.8965517282485962,
                        0.993864119052887,
                        0.8430527448654175,
                        0.8514198660850525,
                        0.8432048559188843,
                        0.8651115894317627,
                        0.8553245663642883,
                        0.8671906590461731,
                        0.8629817366600037,
                        0.8465009927749634,
                        0.8894016146659851,
                        0.8542596101760864,
                        0.7657200694084167,
                        0.8602434396743774,
                        0.8614097237586975,
                        0.8563387393951416,
                        0.7656186819076538,
                        0.7958418130874634,
                        0.7884888648986816,
                        0.9968559741973877,
                        0.718914806842804
                    ]
                }
            },
            "30000": {
                "train": {
                    "pretrain_loss": 0.14939235150814056,
                    "features_accuracy": [
                        0.970115065574646,
                        0.8187747001647949,
                        0.9708192348480225,
                        0.9720816016197205,
                        0.9444360136985779,
                        0.9722592234611511,
                        0.9725574254989624,
                        0.9738832116127014,
                        0.9311841130256653,
                        0.9725130200386047,
                        0.9962953329086304,
                        0.970654308795929,
                        0.9734328389167786,
                        0.9744477868080139,
                        0.9625217318534851,
                        0.9730395078659058,
                        0.9726081490516663,
                        0.9702229499816895,
                        0.9694299697875977,
                        0.9373818635940552,
                        0.9722465872764587,
                        0.9496948719024658,
                        0.8864360451698303,
                        0.9420191049575806,
                        0.9444550275802612,
                        0.9414291381835938,
                        0.957446813583374,
                        0.965921938419342,
                        0.9677298665046692,
                        0.9859805703163147,
                        0.8807013630867004,
                        0.9963016510009766,
                        0.8898869752883911,
                        0.8845773339271545,
                        0.8809677958488464,
                        0.8898298740386963,
                        0.8877618312835693,
                        0.8941879868507385,
                        0.8924180865287781,
                        0.896211564540863,
                        0.8672211170196533,
                        0.8869752287864685,
                        0.9727413654327393,
                        0.8826361894607544,
                        0.8900645971298218,
                        0.8916124701499939,
                        0.9730966091156006,
                        0.9646151661872864,
                        0.9728238582611084,
                        0.9976909160614014,
                        0.9615004062652588
                    ]
                },
                "val": {
                    "pretrain_loss": 0.7225297093391418,
                    "features_accuracy": [
                        0.6229084134101868,
                        0.8724774122238159,
                        0.6312239766120911,
                        0.6496298313140869,
                        0.40878206491470337,
                        0.552935779094696,
                        0.42642733454704285,
                        0.7408984899520874,
                        0.47637155652046204,
                        0.6061758399009705,
                        0.9926477670669556,
                        0.7125037908554077,
                        0.20428961515426636,
                        0.7209714651107788,
                        0.6829428672790527,
                        0.48788154125213623,
                        0.5352398157119751,
                        0.7163573503494263,
                        0.5973024964332581,
                        0.5601865649223328,
                        0.4972619414329529,
                        0.6371564865112305,
                        0.5026873350143433,
                        0.6350775361061096,
                        0.7183348536491394,
                        0.6836527585983276,
                        0.7312138676643372,
                        0.7413040995597839,
                        0.43661898374557495,
                        0.9823039770126343,
                        0.8851029276847839,
                        0.9926477670669556,
                        0.8590406179428101,
                        0.8559983372688293,
                        0.8447418808937073,
                        0.8565561175346375,
                        0.8529053330421448,
                        0.8316093683242798,
                        0.8613730669021606,
                        0.7380083203315735,
                        0.8662407398223877,
                        0.8522968888282776,
                        0.7188925743103027,
                        0.8457052707672119,
                        0.8585842847824097,
                        0.8610181212425232,
                        0.5225129127502441,
                        0.5591217875480652,
                        0.7071290612220764,
                        0.9958928823471069,
                        0.7156981825828552
                    ]
                },
                "test": {
                    "pretrain_loss": 0.43066227436065674,
                    "features_accuracy": [
                        0.7499492764472961,
                        0.6406693458557129,
                        0.7796652913093567,
                        0.806744396686554,
                        0.7927485108375549,
                        0.7917342782020569,
                        0.7846348881721497,
                        0.7952839732170105,
                        0.8206389546394348,
                        0.8116632699966431,
                        0.9937119483947754,
                        0.750507116317749,
                        0.7831643223762512,
                        0.8051217198371887,
                        0.7936105728149414,
                        0.8021298050880432,
                        0.791683554649353,
                        0.7852433919906616,
                        0.7435598373413086,
                        0.7943204641342163,
                        0.8026876449584961,
                        0.7998479008674622,
                        0.8594827651977539,
                        0.6919371485710144,
                        0.8018255829811096,
                        0.860040545463562,
                        0.7301217317581177,
                        0.7370689511299133,
                        0.7713488936424255,
                        0.9834178686141968,
                        0.8938133716583252,
                        0.993914783000946,
                        0.8463996052742004,
                        0.8524340987205505,
                        0.8630831837654114,
                        0.8580628633499146,
                        0.8537525534629822,
                        0.877231240272522,
                        0.8633367419242859,
                        0.8362576365470886,
                        0.8891480565071106,
                        0.8582150340080261,
                        0.7777383327484131,
                        0.8685598373413086,
                        0.8559330701828003,
                        0.8528904914855957,
                        0.8057302236557007,
                        0.8101927042007446,
                        0.78554767370224,
                        0.9968559741973877,
                        0.7219067215919495
                    ]
                }
            },
            "40000": {
                "train": {
                    "pretrain_loss": 0.14616984128952026,
                    "features_accuracy": [
                        0.9710349440574646,
                        0.8422461748123169,
                        0.9715043306350708,
                        0.97393399477005,
                        0.9492127895355225,
                        0.9741940498352051,
                        0.9725320339202881,
                        0.9733186364173889,
                        0.9366142749786377,
                        0.9732044339179993,
                        0.9965300559997559,
                        0.9716312289237976,
                        0.9732361435890198,
                        0.9736167788505554,
                        0.9655603766441345,
                        0.9730522036552429,
                        0.9730775952339172,
                        0.9721069931983948,
                        0.9701785445213318,
                        0.9430213570594788,
                        0.9733503460884094,
                        0.9484007954597473,
                        0.8876159191131592,
                        0.9431355595588684,
                        0.9459838271141052,
                        0.9428120255470276,
                        0.957979679107666,
                        0.9659600257873535,
                        0.9677108526229858,
                        0.9858283400535583,
                        0.8815196752548218,
                        0.9964285492897034,
                        0.8891257643699646,
                        0.8852434158325195,
                        0.8838922381401062,
                        0.89060378074646,
                        0.8896776437759399,
                        0.8955772519111633,
                        0.8934648036956787,
                        0.8964018821716309,
                        0.8682488203048706,
                        0.8882693648338318,
                        0.9727857708930969,
                        0.8839746713638306,
                        0.8911113142967224,
                        0.8909083008766174,
                        0.9741179347038269,
                        0.9671462774276733,
                        0.9733186364173889,
                        0.9979890584945679,
                        0.9624329209327698
                    ]
                },
                "val": {
                    "pretrain_loss": 0.7548895478248596,
                    "features_accuracy": [
                        0.6805090308189392,
                        0.8529053330421448,
                        0.6600750088691711,
                        0.6090152859687805,
                        0.41146939992904663,
                        0.5949193835258484,
                        0.5439610481262207,
                        0.7115404009819031,
                        0.4758138060569763,
                        0.6994726657867432,
                        0.9927998781204224,
                        0.7241151928901672,
                        0.2519521415233612,
                        0.7198559641838074,
                        0.6398438215255737,
                        0.3541730046272278,
                        0.4225737750530243,
                        0.6323394775390625,
                        0.5873643755912781,
                        0.5620119571685791,
                        0.4915322959423065,
                        0.6539904475212097,
                        0.5084676742553711,
                        0.7325322031974792,
                        0.7077375054359436,
                        0.6938951015472412,
                        0.7318730354309082,
                        0.7411519885063171,
                        0.45903050899505615,
                        0.9823547005653381,
                        0.8804380893707275,
                        0.9924956560134888,
                        0.8571138381958008,
                        0.8579758405685425,
                        0.8466179370880127,
                        0.8570124506950378,
                        0.852753221988678,
                        0.7799411416053772,
                        0.86117023229599,
                        0.6458269953727722,
                        0.8636040687561035,
                        0.8521955013275146,
                        0.6826386451721191,
                        0.8456545472145081,
                        0.8581279516220093,
                        0.8621336221694946,
                        0.40097352862358093,
                        0.6035391688346863,
                        0.6908021569252014,
                        0.9959436058998108,
                        0.7160531282424927
                    ]
                },
                "test": {
                    "pretrain_loss": 0.4327300786972046,
                    "features_accuracy": [
                        0.7610547542572021,
                        0.6431034803390503,
                        0.787778913974762,
                        0.8041582107543945,
                        0.7772819399833679,
                        0.793914794921875,
                        0.7861054539680481,
                        0.8092799186706543,
                        0.8029918670654297,
                        0.8022819757461548,
                        0.9935091137886047,
                        0.7605476975440979,
                        0.7884888648986816,
                        0.7923427820205688,
                        0.796146035194397,
                        0.7975152134895325,
                        0.7907707691192627,
                        0.7829614877700806,
                        0.7620182633399963,
                        0.7978194952011108,
                        0.7931034564971924,
                        0.7959432005882263,
                        0.8717038631439209,
                        0.7056795358657837,
                        0.7965517044067383,
                        0.8558823466300964,
                        0.7307809591293335,
                        0.7370689511299133,
                        0.7620182633399963,
                        0.9839756488800049,
                        0.8817951083183289,
                        0.9941176772117615,
                        0.8476166129112244,
                        0.853296160697937,
                        0.8452839851379395,
                        0.8573022484779358,
                        0.8547667264938354,
                        0.8723123669624329,
                        0.8634381294250488,
                        0.8239350914955139,
                        0.8866633176803589,
                        0.8702839612960815,
                        0.7786003947257996,
                        0.8468052744865417,
                        0.8569472432136536,
                        0.8524340987205505,
                        0.796653151512146,
                        0.7780933380126953,
                        0.7843813300132751,
                        0.9969066977500916,
                        0.7196247577667236
                    ]
                }
            }
        },
        "train": {
            "score": -3.4225345022297926
        },
        "val": {
            "score": -5.325906057943898
        },
        "test": {
            "score": -5.528742106839334
        }
    },
    "best_iteration": 10000,
    "time": "0:04:38"
}
