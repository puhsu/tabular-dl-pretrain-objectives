{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_fast___88f334f0dee44fc782727ac73dc94e4f.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0,1",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                },
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 5,
        "data": {
            "path": "data/fb-comments",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512
                ],
                "dropout": 0.3165243883109578
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "positional",
                "linear",
                "relu"
            ],
            "d_num_embedding": 11,
            "positional_encoding": {
                "n": 35,
                "sigma": 0.3078928096197865,
                "trainable": true,
                "initialization": "normal"
            },
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 512,
            "lr": 0.00015569191898648328,
            "weight_decay": 0.0007948790593667655,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 1024
        },
        "pretrain": {
            "corrupt_probability": 0.7425803516231099,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.00015569191898648328,
            "weight_decay": 0.0007948790593667655,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "target_shuffle",
            "n_neighbors": 20,
            "use_target": true,
            "early_stop_type": "pretrain",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "n_parameters": 653715,
    "epoch_size": 308,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "pretrain_loss": 0.16328760981559753,
                    "features_accuracy": [
                        0.9651353359222412,
                        0.774350106716156,
                        0.9625598192214966,
                        0.9669559597969055,
                        0.9265532493591309,
                        0.9654461741447449,
                        0.9670954942703247,
                        0.9680280089378357,
                        0.9032784104347229,
                        0.9670954942703247,
                        0.9960606098175049,
                        0.9653953909873962,
                        0.9671018719673157,
                        0.967393696308136,
                        0.9509255290031433,
                        0.9675078392028809,
                        0.9651607275009155,
                        0.9645580649375916,
                        0.965858519077301,
                        0.9236351847648621,
                        0.9670320749282837,
                        0.9423996806144714,
                        0.8864613771438599,
                        0.9374326467514038,
                        0.9408264756202698,
                        0.93564373254776,
                        0.9533171057701111,
                        0.960580587387085,
                        0.9616273045539856,
                        0.9854984283447266,
                        0.8800606727600098,
                        0.9961938261985779,
                        0.889404833316803,
                        0.8842220902442932,
                        0.879400908946991,
                        0.8879204392433167,
                        0.8863091468811035,
                        0.8942958116531372,
                        0.8911430239677429,
                        0.8953678607940674,
                        0.8650833368301392,
                        0.8867722153663635,
                        0.9647229909896851,
                        0.8807077407836914,
                        0.888205885887146,
                        0.8893985152244568,
                        0.9660488367080688,
                        0.9542813301086426,
                        0.9653827548027039,
                        0.9971263408660889,
                        0.9624519944190979
                    ]
                },
                "val": {
                    "pretrain_loss": 0.5872437357902527,
                    "features_accuracy": [
                        0.741861879825592,
                        0.8632491230964661,
                        0.7396815419197083,
                        0.7518507242202759,
                        0.41537368297576904,
                        0.7261940836906433,
                        0.6776188611984253,
                        0.720058798789978,
                        0.47535744309425354,
                        0.46192067861557007,
                        0.9925463795661926,
                        0.7374505400657654,
                        0.7438900470733643,
                        0.715191125869751,
                        0.36051109433174133,
                        0.7210729122161865,
                        0.6715850234031677,
                        0.7267011404037476,
                        0.7429266571998596,
                        0.512726902961731,
                        0.7215292453765869,
                        0.7200080752372742,
                        0.46547001600265503,
                        0.36324915289878845,
                        0.7117938995361328,
                        0.7411012649536133,
                        0.6374099850654602,
                        0.7409998774528503,
                        0.4315992295742035,
                        0.9853969812393188,
                        0.8963086605072021,
                        0.992343544960022,
                        0.8576716184616089,
                        0.8690801858901978,
                        0.8460094928741455,
                        0.8598518967628479,
                        0.8532602787017822,
                        0.8045836687088013,
                        0.8602575659751892,
                        0.6971402168273926,
                        0.8828212022781372,
                        0.8520433902740479,
                        0.6711286902427673,
                        0.8467701077461243,
                        0.8645674586296082,
                        0.8654801249504089,
                        0.7473379969596863,
                        0.4535543918609619,
                        0.7145826816558838,
                        0.9954872727394104,
                        0.722847580909729
                    ]
                },
                "test": {
                    "pretrain_loss": 0.4501660168170929,
                    "features_accuracy": [
                        0.7404158115386963,
                        0.6390466690063477,
                        0.7425963282585144,
                        0.7472109794616699,
                        0.7917850017547607,
                        0.7489858269691467,
                        0.7593813538551331,
                        0.7641987800598145,
                        0.816632866859436,
                        0.7816430330276489,
                        0.9934077262878418,
                        0.737271785736084,
                        0.7412778735160828,
                        0.7818965315818787,
                        0.7844827771186829,
                        0.7519269585609436,
                        0.7429513335227966,
                        0.742241382598877,
                        0.7364097237586975,
                        0.7984787225723267,
                        0.7647566199302673,
                        0.7718052864074707,
                        0.8597363233566284,
                        0.6559838056564331,
                        0.7613083124160767,
                        0.8197768926620483,
                        0.7321500778198242,
                        0.7402637004852295,
                        0.7395537495613098,
                        0.9828093647956848,
                        0.894472599029541,
                        0.9934077262878418,
                        0.8524340987205505,
                        0.8533468842506409,
                        0.8432048559188843,
                        0.8815922737121582,
                        0.8792089223861694,
                        0.8740872144699097,
                        0.8651115894317627,
                        0.8119675517082214,
                        0.8937627077102661,
                        0.8530933260917664,
                        0.7381845712661743,
                        0.8443204760551453,
                        0.862778902053833,
                        0.860547661781311,
                        0.7538032531738281,
                        0.7838742136955261,
                        0.7520791292190552,
                        0.996653139591217,
                        0.7199797034263611
                    ]
                }
            },
            "20000": {
                "train": {
                    "pretrain_loss": 0.1542627513408661,
                    "features_accuracy": [
                        0.9682691097259521,
                        0.7940471172332764,
                        0.9691952466964722,
                        0.9708192348480225,
                        0.9359291791915894,
                        0.9714472889900208,
                        0.9705781936645508,
                        0.9719230532646179,
                        0.9207932353019714,
                        0.970381498336792,
                        0.9960986971855164,
                        0.9690366983413696,
                        0.9689542055130005,
                        0.9716946482658386,
                        0.9577576518058777,
                        0.970781147480011,
                        0.9702609777450562,
                        0.9691508412361145,
                        0.9687004685401917,
                        0.9334360957145691,
                        0.9704385995864868,
                        0.9465293884277344,
                        0.8862584233283997,
                        0.9402238130569458,
                        0.9426978230476379,
                        0.939570426940918,
                        0.957319974899292,
                        0.9640442132949829,
                        0.9642916321754456,
                        0.985999584197998,
                        0.8809551000595093,
                        0.9960796236991882,
                        0.8894873261451721,
                        0.8839049339294434,
                        0.8816972970962524,
                        0.888542115688324,
                        0.8880219459533691,
                        0.8948413729667664,
                        0.8917139172554016,
                        0.8960086107254028,
                        0.8661553859710693,
                        0.8875842094421387,
                        0.9707558155059814,
                        0.8817353844642639,
                        0.8891320824623108,
                        0.8913967609405518,
                        0.9708573222160339,
                        0.9605996012687683,
                        0.9706923365592957,
                        0.9978178143501282,
                        0.9626676440238953
                    ]
                },
                "val": {
                    "pretrain_loss": 0.6557122468948364,
                    "features_accuracy": [
                        0.7441942691802979,
                        0.8640604019165039,
                        0.5462934374809265,
                        0.7262448072433472,
                        0.39762699604034424,
                        0.6384747624397278,
                        0.6010039448738098,
                        0.5206875205039978,
                        0.4755095839500427,
                        0.3621843457221985,
                        0.9929519891738892,
                        0.730656087398529,
                        0.744752049446106,
                        0.5216509103775024,
                        0.5587161183357239,
                        0.6966331601142883,
                        0.5753980278968811,
                        0.722188413143158,
                        0.61778724193573,
                        0.5638880133628845,
                        0.514045238494873,
                        0.7325322031974792,
                        0.4509684443473816,
                        0.43950915336608887,
                        0.7187911868095398,
                        0.7743129134178162,
                        0.7296926975250244,
                        0.7412533760070801,
                        0.5972010493278503,
                        0.9832167029380798,
                        0.8900212645530701,
                        0.9925970435142517,
                        0.858381450176239,
                        0.853412389755249,
                        0.8447418808937073,
                        0.8561504483222961,
                        0.8513842225074768,
                        0.7750735282897949,
                        0.8608660101890564,
                        0.5947165489196777,
                        0.8790183067321777,
                        0.8517391681671143,
                        0.614339292049408,
                        0.845603883266449,
                        0.8621843457221985,
                        0.8588378429412842,
                        0.7117432355880737,
                        0.5800628662109375,
                        0.6571341753005981,
                        0.9963999390602112,
                        0.7231010794639587
                    ]
                },
                "test": {
                    "pretrain_loss": 0.4346253275871277,
                    "features_accuracy": [
                        0.7451825737953186,
                        0.6405172348022461,
                        0.7901622653007507,
                        0.7951825857162476,
                        0.8042089343070984,
                        0.78717041015625,
                        0.7836713790893555,
                        0.8099391460418701,
                        0.809482753276825,
                        0.805020272731781,
                        0.9934584498405457,
                        0.7381845712661743,
                        0.7413285970687866,
                        0.80552738904953,
                        0.8034482598304749,
                        0.783823549747467,
                        0.7772819399833679,
                        0.772210955619812,
                        0.7370182871818542,
                        0.8143509030342102,
                        0.7846348881721497,
                        0.7930527329444885,
                        0.8763184547424316,
                        0.6322008371353149,
                        0.7890466451644897,
                        0.8490365147590637,
                        0.7310344576835632,
                        0.7402637004852295,
                        0.7570486664772034,
                        0.9827079176902771,
                        0.9002028703689575,
                        0.9936105608940125,
                        0.8184077143669128,
                        0.8511156439781189,
                        0.8430020213127136,
                        0.8563894629478455,
                        0.8579107522964478,
                        0.8698275685310364,
                        0.862778902053833,
                        0.8457403779029846,
                        0.8853955268859863,
                        0.8532454371452332,
                        0.7753042578697205,
                        0.8454360961914062,
                        0.8581135869026184,
                        0.8559330701828003,
                        0.8019776940345764,
                        0.8002535700798035,
                        0.7975659370422363,
                        0.9969574213027954,
                        0.7209432125091553
                    ]
                }
            },
            "30000": {
                "train": {
                    "pretrain_loss": 0.15007460117340088,
                    "features_accuracy": [
                        0.9695568680763245,
                        0.8099506497383118,
                        0.9707558155059814,
                        0.9716122150421143,
                        0.9426915049552917,
                        0.9729887843132019,
                        0.9725130200386047,
                        0.9731220006942749,
                        0.92976313829422,
                        0.9727730751037598,
                        0.996276319026947,
                        0.9702292680740356,
                        0.9712569713592529,
                        0.9737372994422913,
                        0.9624583125114441,
                        0.9728111624717712,
                        0.9719737768173218,
                        0.9704195857048035,
                        0.96938556432724,
                        0.9376800060272217,
                        0.9723798036575317,
                        0.9490668773651123,
                        0.8864677548408508,
                        0.9420127272605896,
                        0.9433004856109619,
                        0.9414100646972656,
                        0.9579352736473083,
                        0.965522289276123,
                        0.9670637845993042,
                        0.9855936169624329,
                        0.8813674449920654,
                        0.9962890148162842,
                        0.8902105093002319,
                        0.8849198818206787,
                        0.8806569576263428,
                        0.8885040879249573,
                        0.890070915222168,
                        0.8949809074401855,
                        0.8931729793548584,
                        0.8969411253929138,
                        0.8668277859687805,
                        0.8877999186515808,
                        0.9713965058326721,
                        0.8806506395339966,
                        0.8888593316078186,
                        0.8920438289642334,
                        0.9727730751037598,
                        0.9636953473091125,
                        0.9728174805641174,
                        0.9978939294815063,
                        0.9624646306037903
                    ]
                },
                "val": {
                    "pretrain_loss": 0.7041072845458984,
                    "features_accuracy": [
                        0.703224778175354,
                        0.8648716807365417,
                        0.4595375657081604,
                        0.7170165181159973,
                        0.4141567647457123,
                        0.5940573811531067,
                        0.5499442219734192,
                        0.44620218873023987,
                        0.4765743613243103,
                        0.3262346386909485,
                        0.9928506016731262,
                        0.7246222496032715,
                        0.7232024669647217,
                        0.6811681985855103,
                        0.47216305136680603,
                        0.6133251786231995,
                        0.6033870577812195,
                        0.6342155933380127,
                        0.7237095236778259,
                        0.564141571521759,
                        0.40082141757011414,
                        0.7286279201507568,
                        0.47084471583366394,
                        0.5780853629112244,
                        0.7182334065437317,
                        0.7567183375358582,
                        0.7316702008247375,
                        0.7413548231124878,
                        0.5305242538452148,
                        0.9828110337257385,
                        0.8938748240470886,
                        0.992343544960022,
                        0.8574687838554382,
                        0.8535645008087158,
                        0.8426122665405273,
                        0.8579251170158386,
                        0.8515870571136475,
                        0.7602676749229431,
                        0.86117023229599,
                        0.5904066562652588,
                        0.8693844079971313,
                        0.8523983359336853,
                        0.5029408931732178,
                        0.845603883266449,
                        0.860409677028656,
                        0.8592941761016846,
                        0.677720308303833,
                        0.5566879510879517,
                        0.5735219120979309,
                        0.9958928823471069,
                        0.7231010794639587
                    ]
                },
                "test": {
                    "pretrain_loss": 0.43300268054008484,
                    "features_accuracy": [
                        0.7509127855300903,
                        0.6421399712562561,
                        0.7994421720504761,
                        0.7743407487869263,
                        0.7864097356796265,
                        0.788894534111023,
                        0.7969067096710205,
                        0.8038539886474609,
                        0.8074036836624146,
                        0.8104462623596191,
                        0.9936105608940125,
                        0.755020260810852,
                        0.6369675397872925,
                        0.8012170195579529,
                        0.8025354743003845,
                        0.7898580431938171,
                        0.7946754693984985,
                        0.7792596220970154,
                        0.7445740103721619,
                        0.7873732447624207,
                        0.8002028465270996,
                        0.791632890701294,
                        0.875608503818512,
                        0.6740365028381348,
                        0.7947261929512024,
                        0.8226673603057861,
                        0.7324036359786987,
                        0.7402637004852295,
                        0.7677484750747681,
                        0.982758641242981,
                        0.8998985886573792,
                        0.9935598373413086,
                        0.8436105251312256,
                        0.8517748713493347,
                        0.8448275923728943,
                        0.8576571941375732,
                        0.860547661781311,
                        0.8746450543403625,
                        0.8623732328414917,
                        0.8285496830940247,
                        0.8739858269691467,
                        0.8534482717514038,
                        0.7972109317779541,
                        0.8460953235626221,
                        0.8562880158424377,
                        0.8543103337287903,
                        0.8047667145729065,
                        0.7972109317779541,
                        0.7978194952011108,
                        0.9969574213027954,
                        0.7198275923728943
                    ]
                }
            },
            "40000": {
                "train": {
                    "pretrain_loss": 0.14728431403636932,
                    "features_accuracy": [
                        0.9709270596504211,
                        0.8317664861679077,
                        0.9717454314231873,
                        0.9733757376670837,
                        0.9477854371070862,
                        0.9737499952316284,
                        0.9731981158256531,
                        0.9733630418777466,
                        0.9383397698402405,
                        0.9734581708908081,
                        0.9961113929748535,
                        0.969658374786377,
                        0.9725827574729919,
                        0.9739593267440796,
                        0.9655857086181641,
                        0.9740418195724487,
                        0.9726588726043701,
                        0.9720879793167114,
                        0.9704576730728149,
                        0.9422791600227356,
                        0.972449541091919,
                        0.9499422907829285,
                        0.8870894312858582,
                        0.9429198503494263,
                        0.9439729452133179,
                        0.9426788091659546,
                        0.9570662379264832,
                        0.9662835597991943,
                        0.968383252620697,
                        0.9858853816986084,
                        0.8810122013092041,
                        0.9961113929748535,
                        0.8891764879226685,
                        0.8864994645118713,
                        0.8837653398513794,
                        0.8882693648338318,
                        0.889741063117981,
                        0.8955137729644775,
                        0.8933823108673096,
                        0.8970489501953125,
                        0.8682995438575745,
                        0.8870006203651428,
                        0.9730204939842224,
                        0.8832959532737732,
                        0.8898679614067078,
                        0.8920565247535706,
                        0.9732932448387146,
                        0.965522289276123,
                        0.9730648994445801,
                        0.9980144500732422,
                        0.9626993536949158
                    ]
                },
                "val": {
                    "pretrain_loss": 0.743732213973999,
                    "features_accuracy": [
                        0.4009228050708771,
                        0.8659871816635132,
                        0.5500456094741821,
                        0.6854274272918701,
                        0.41304126381874084,
                        0.5870600938796997,
                        0.6545482277870178,
                        0.5013689994812012,
                        0.47708141803741455,
                        0.23618294298648834,
                        0.9928506016731262,
                        0.7132643461227417,
                        0.6921711564064026,
                        0.6730047464370728,
                        0.42252305150032043,
                        0.5551161170005798,
                        0.5531893372535706,
                        0.6450663805007935,
                        0.6351282596588135,
                        0.5645979046821594,
                        0.27694958448410034,
                        0.7289321422576904,
                        0.5011662244796753,
                        0.48524489998817444,
                        0.7146840691566467,
                        0.7468816637992859,
                        0.7361322045326233,
                        0.7413548231124878,
                        0.3635026812553406,
                        0.9827603697776794,
                        0.884494423866272,
                        0.9924956560134888,
                        0.8603082895278931,
                        0.8535645008087158,
                        0.8447926044464111,
                        0.856860339641571,
                        0.8524997234344482,
                        0.7276138067245483,
                        0.8634519577026367,
                        0.618547797203064,
                        0.8678125739097595,
                        0.8523983359336853,
                        0.44518810510635376,
                        0.8456545472145081,
                        0.857570230960846,
                        0.858989953994751,
                        0.6295507550239563,
                        0.6254943609237671,
                        0.6921711564064026,
                        0.9959942698478699,
                        0.7232024669647217
                    ]
                },
                "test": {
                    "pretrain_loss": 0.43074050545692444,
                    "features_accuracy": [
                        0.7578600645065308,
                        0.6440669298171997,
                        0.7990872263908386,
                        0.8005577921867371,
                        0.7817444205284119,
                        0.7895030379295349,
                        0.7879310250282288,
                        0.8021298050880432,
                        0.7938134074211121,
                        0.8049695491790771,
                        0.9935598373413086,
                        0.7567951083183289,
                        0.7895537614822388,
                        0.8042596578598022,
                        0.8031440377235413,
                        0.7998985648155212,
                        0.8063387274742126,
                        0.7906693816184998,
                        0.7615618705749512,
                        0.7880831956863403,
                        0.7887424230575562,
                        0.782707929611206,
                        0.8694218993186951,
                        0.6879817247390747,
                        0.7951825857162476,
                        0.8761663436889648,
                        0.7356491088867188,
                        0.7402637004852295,
                        0.7871196866035461,
                        0.982758641242981,
                        0.8976166248321533,
                        0.9936105608940125,
                        0.7779918909072876,
                        0.852281928062439,
                        0.8431541919708252,
                        0.8579614758491516,
                        0.8554259538650513,
                        0.8860040903091431,
                        0.8660243153572083,
                        0.8501521348953247,
                        0.8774847984313965,
                        0.8540567755699158,
                        0.7951318621635437,
                        0.8463996052742004,
                        0.8603448271751404,
                        0.8535497188568115,
                        0.8059330582618713,
                        0.7922413945198059,
                        0.7883874177932739,
                        0.9969574213027954,
                        0.7199797034263611
                    ]
                }
            }
        },
        "train": {
            "score": -3.3601139096203756
        },
        "val": {
            "score": -5.302836583011577
        },
        "test": {
            "score": -5.533824492336458
        }
    },
    "best_iteration": 10000,
    "time": "0:04:47"
}
