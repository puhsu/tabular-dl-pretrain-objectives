{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_fast___88f334f0dee44fc782727ac73dc94e4f.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0,1",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                },
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 13,
        "data": {
            "path": "data/fb-comments",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512
                ],
                "dropout": 0.3165243883109578
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "positional",
                "linear",
                "relu"
            ],
            "d_num_embedding": 11,
            "positional_encoding": {
                "n": 35,
                "sigma": 0.3078928096197865,
                "trainable": true,
                "initialization": "normal"
            },
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 512,
            "lr": 0.00015569191898648328,
            "weight_decay": 0.0007948790593667655,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 1024
        },
        "pretrain": {
            "corrupt_probability": 0.7425803516231099,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.00015569191898648328,
            "weight_decay": 0.0007948790593667655,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "target_shuffle",
            "n_neighbors": 20,
            "use_target": true,
            "early_stop_type": "pretrain",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "n_parameters": 653715,
    "epoch_size": 308,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "pretrain_loss": 0.16403716802597046,
                    "features_accuracy": [
                        0.9658268094062805,
                        0.7730686664581299,
                        0.9648371934890747,
                        0.9668925404548645,
                        0.9243900775909424,
                        0.9658394455909729,
                        0.965991735458374,
                        0.966784656047821,
                        0.9051815271377563,
                        0.966061532497406,
                        0.9962128400802612,
                        0.9651733636856079,
                        0.9660995602607727,
                        0.9667656421661377,
                        0.9533932209014893,
                        0.967387318611145,
                        0.964989423751831,
                        0.9631116986274719,
                        0.9658775329589844,
                        0.9224172234535217,
                        0.9666705131530762,
                        0.9404078125953674,
                        0.8842664957046509,
                        0.9368743896484375,
                        0.9388980269432068,
                        0.9386252164840698,
                        0.9552773237228394,
                        0.9613164663314819,
                        0.9599969983100891,
                        0.9855492115020752,
                        0.87759929895401,
                        0.9962002038955688,
                        0.8897854685783386,
                        0.8837590217590332,
                        0.8796356320381165,
                        0.888472318649292,
                        0.8858904838562012,
                        0.8931919932365417,
                        0.8912001252174377,
                        0.8958690166473389,
                        0.8651911616325378,
                        0.88701331615448,
                        0.9654968976974487,
                        0.8794897198677063,
                        0.8880029320716858,
                        0.8902232050895691,
                        0.9686877727508545,
                        0.9554866552352905,
                        0.9669052362442017,
                        0.9973737597465515,
                        0.9616590142250061
                    ]
                },
                "val": {
                    "pretrain_loss": 0.5987781882286072,
                    "features_accuracy": [
                        0.739174485206604,
                        0.8619815111160278,
                        0.6030828356742859,
                        0.7421153783798218,
                        0.3968157172203064,
                        0.5434032678604126,
                        0.72847580909729,
                        0.6496298313140869,
                        0.4756616950035095,
                        0.39281004667282104,
                        0.9925970435142517,
                        0.7355237603187561,
                        0.7370955944061279,
                        0.7438900470733643,
                        0.6564750075340271,
                        0.543707549571991,
                        0.731416642665863,
                        0.7384646534919739,
                        0.7431294918060303,
                        0.42439913749694824,
                        0.7052022814750671,
                        0.7283236980438232,
                        0.49543654918670654,
                        0.3099077045917511,
                        0.7215799689292908,
                        0.7092079520225525,
                        0.7341547012329102,
                        0.7379575967788696,
                        0.5665754079818726,
                        0.9843322038650513,
                        0.895700216293335,
                        0.9922928214073181,
                        0.8572659492492676,
                        0.8599026203155518,
                        0.8482912182807922,
                        0.8563025593757629,
                        0.8517898321151733,
                        0.8391643762588501,
                        0.8599026203155518,
                        0.8610181212425232,
                        0.8641618490219116,
                        0.8529053330421448,
                        0.6994219422340393,
                        0.8499644994735718,
                        0.864719569683075,
                        0.8595476746559143,
                        0.41801032423973083,
                        0.4501064717769623,
                        0.31751343607902527,
                        0.9962478280067444,
                        0.7160531282424927
                    ]
                },
                "test": {
                    "pretrain_loss": 0.44785967469215393,
                    "features_accuracy": [
                        0.7363083362579346,
                        0.6391480565071106,
                        0.7751521468162537,
                        0.7454867959022522,
                        0.7925963401794434,
                        0.7811359167098999,
                        0.7419371008872986,
                        0.7836207151412964,
                        0.8173428177833557,
                        0.7613590359687805,
                        0.9935598373413086,
                        0.7419878244400024,
                        0.745030403137207,
                        0.7456389665603638,
                        0.8021298050880432,
                        0.7615618705749512,
                        0.733924925327301,
                        0.7435091137886047,
                        0.7372211217880249,
                        0.8349898457527161,
                        0.7556794881820679,
                        0.7831135988235474,
                        0.8634381294250488,
                        0.606135904788971,
                        0.7404665350914001,
                        0.850050687789917,
                        0.7326064705848694,
                        0.735040545463562,
                        0.7463489174842834,
                        0.9827079176902771,
                        0.9002535343170166,
                        0.9936612844467163,
                        0.8497464656829834,
                        0.8517241477966309,
                        0.8435091376304626,
                        0.8625760674476624,
                        0.8529918789863586,
                        0.8656186461448669,
                        0.8632352948188782,
                        0.8643001914024353,
                        0.8794117569923401,
                        0.853803277015686,
                        0.7510648965835571,
                        0.8647565841674805,
                        0.8554766774177551,
                        0.852180540561676,
                        0.797768771648407,
                        0.7919371128082275,
                        0.7675963640213013,
                        0.9968559741973877,
                        0.7187119722366333
                    ]
                }
            },
            "20000": {
                "train": {
                    "pretrain_loss": 0.15449443459510803,
                    "features_accuracy": [
                        0.9678821563720703,
                        0.7909768223762512,
                        0.9693601727485657,
                        0.970654308795929,
                        0.9357261657714844,
                        0.9706606268882751,
                        0.9709334373474121,
                        0.9714599251747131,
                        0.9205331206321716,
                        0.9702800512313843,
                        0.996269941329956,
                        0.9690113067626953,
                        0.9707494378089905,
                        0.9703561663627625,
                        0.9583984017372131,
                        0.9714028835296631,
                        0.971517026424408,
                        0.969252347946167,
                        0.9684467315673828,
                        0.9310001730918884,
                        0.9711744785308838,
                        0.9466181993484497,
                        0.8864233493804932,
                        0.9404522180557251,
                        0.9424187541007996,
                        0.9420381188392639,
                        0.9565967917442322,
                        0.9648118019104004,
                        0.9667973518371582,
                        0.9856570363044739,
                        0.8804920315742493,
                        0.996269941329956,
                        0.8889290690422058,
                        0.8843109011650085,
                        0.8803144097328186,
                        0.8873812556266785,
                        0.8870957493782043,
                        0.894815981388092,
                        0.8924815058708191,
                        0.895488440990448,
                        0.8670244812965393,
                        0.8849706649780273,
                        0.9728364944458008,
                        0.8807077407836914,
                        0.8879902362823486,
                        0.8906735777854919,
                        0.9723480343818665,
                        0.9608977437019348,
                        0.9708002209663391,
                        0.9977543950080872,
                        0.9619698524475098
                    ]
                },
                "val": {
                    "pretrain_loss": 0.6746682524681091,
                    "features_accuracy": [
                        0.747591495513916,
                        0.8631477355957031,
                        0.25362539291381836,
                        0.6536862254142761,
                        0.37648311257362366,
                        0.23308993875980377,
                        0.44954872131347656,
                        0.5943108797073364,
                        0.37927186489105225,
                        0.5266706943511963,
                        0.9923942685127258,
                        0.737754762172699,
                        0.7382110953330994,
                        0.7577831745147705,
                        0.703883945941925,
                        0.507149338722229,
                        0.6464354395866394,
                        0.5576006174087524,
                        0.685478150844574,
                        0.5660683512687683,
                        0.2705608010292053,
                        0.7197545766830444,
                        0.4684616029262543,
                        0.34387990832328796,
                        0.7302504777908325,
                        0.590913712978363,
                        0.7337998151779175,
                        0.7381097078323364,
                        0.36720412969589233,
                        0.9836223125457764,
                        0.8995537757873535,
                        0.9925463795661926,
                        0.8571645617485046,
                        0.8566068410873413,
                        0.8436263799667358,
                        0.8560997843742371,
                        0.8528039455413818,
                        0.8472771048545837,
                        0.8598518967628479,
                        0.8463137149810791,
                        0.865378737449646,
                        0.8522462248802185,
                        0.5716965794563293,
                        0.8439813256263733,
                        0.8600040078163147,
                        0.8596997857093811,
                        0.498276025056839,
                        0.6390832662582397,
                        0.49046748876571655,
                        0.9963999390602112,
                        0.7169657945632935
                    ]
                },
                "test": {
                    "pretrain_loss": 0.43458491563796997,
                    "features_accuracy": [
                        0.7364097237586975,
                        0.6407707929611206,
                        0.7991379499435425,
                        0.8144523501396179,
                        0.7976166605949402,
                        0.7978701591491699,
                        0.7848377227783203,
                        0.7959939241409302,
                        0.8108519315719604,
                        0.78554767370224,
                        0.9935598373413086,
                        0.7514199018478394,
                        0.7853955626487732,
                        0.7881845831871033,
                        0.7742393612861633,
                        0.7938640713691711,
                        0.7559837698936462,
                        0.774949312210083,
                        0.7391988039016724,
                        0.8137931227684021,
                        0.793306291103363,
                        0.78392493724823,
                        0.8674442172050476,
                        0.6451825499534607,
                        0.7989857792854309,
                        0.8491379618644714,
                        0.7486815452575684,
                        0.735040545463562,
                        0.7765213251113892,
                        0.9825050830841064,
                        0.9002535343170166,
                        0.9935091137886047,
                        0.8064908981323242,
                        0.8509634733200073,
                        0.8439655303955078,
                        0.8771805167198181,
                        0.878853976726532,
                        0.864908754825592,
                        0.863286018371582,
                        0.8297160267829895,
                        0.8855476975440979,
                        0.8818965554237366,
                        0.7791582345962524,
                        0.8452839851379395,
                        0.8558823466300964,
                        0.8528904914855957,
                        0.8091278076171875,
                        0.7984787225723267,
                        0.7570993900299072,
                        0.9969574213027954,
                        0.7145537734031677
                    ]
                }
            },
            "30000": {
                "train": {
                    "pretrain_loss": 0.1498493105173111,
                    "features_accuracy": [
                        0.9704322814941406,
                        0.8138710260391235,
                        0.9714218974113464,
                        0.9738959074020386,
                        0.9438016414642334,
                        0.9724622368812561,
                        0.9728745818138123,
                        0.9744477868080139,
                        0.9266928434371948,
                        0.9721767902374268,
                        0.9962255358695984,
                        0.9708446264266968,
                        0.9724178314208984,
                        0.9733059406280518,
                        0.9626296162605286,
                        0.9730839133262634,
                        0.9724812507629395,
                        0.9710476398468018,
                        0.9697281122207642,
                        0.9374960660934448,
                        0.9723924398422241,
                        0.949047863483429,
                        0.8861632347106934,
                        0.941632091999054,
                        0.9435479044914246,
                        0.9406932592391968,
                        0.9582144021987915,
                        0.9649831056594849,
                        0.9676474332809448,
                        0.9853017926216125,
                        0.8810312151908875,
                        0.9962192177772522,
                        0.8903564214706421,
                        0.8866580724716187,
                        0.8802509903907776,
                        0.8880536556243896,
                        0.8891130685806274,
                        0.8941181898117065,
                        0.8920501470565796,
                        0.8965033888816833,
                        0.867861807346344,
                        0.8862330317497253,
                        0.9733503460884094,
                        0.8835306167602539,
                        0.8889544606208801,
                        0.8906101584434509,
                        0.9730902910232544,
                        0.9631941914558411,
                        0.9730522036552429,
                        0.9975069761276245,
                        0.9627057313919067
                    ]
                },
                "val": {
                    "pretrain_loss": 0.7409765124320984,
                    "features_accuracy": [
                        0.7212250232696533,
                        0.8606631755828857,
                        0.33820098638534546,
                        0.6358888149261475,
                        0.4099482595920563,
                        0.3209613561630249,
                        0.23344488441944122,
                        0.5334144234657288,
                        0.33678126335144043,
                        0.5724064111709595,
                        0.9925970435142517,
                        0.5484737753868103,
                        0.720819354057312,
                        0.7242165803909302,
                        0.6425818800926208,
                        0.6278267502784729,
                        0.4885407090187073,
                        0.5663725733757019,
                        0.5561301708221436,
                        0.568350076675415,
                        0.2307068258523941,
                        0.7249264717102051,
                        0.47971805930137634,
                        0.5459385514259338,
                        0.7177770733833313,
                        0.6976472735404968,
                        0.7363857626914978,
                        0.7382618188858032,
                        0.40011152625083923,
                        0.9836730360984802,
                        0.8987424969673157,
                        0.9925463795661926,
                        0.857570230960846,
                        0.8548828363418579,
                        0.8432207703590393,
                        0.8573673963546753,
                        0.8522462248802185,
                        0.8246120810508728,
                        0.8658857941627502,
                        0.8537166118621826,
                        0.873795747756958,
                        0.851891279220581,
                        0.3090457320213318,
                        0.8438292145729065,
                        0.8600040078163147,
                        0.859750509262085,
                        0.7186897397041321,
                        0.5241354703903198,
                        0.6113983988761902,
                        0.9959942698478699,
                        0.7170672416687012
                    ]
                },
                "test": {
                    "pretrain_loss": 0.4291161000728607,
                    "features_accuracy": [
                        0.7446754574775696,
                        0.6441683769226074,
                        0.7968052625656128,
                        0.8131845593452454,
                        0.800507128238678,
                        0.7874746322631836,
                        0.7902129888534546,
                        0.7926977872848511,
                        0.8049188852310181,
                        0.7975152134895325,
                        0.9937119483947754,
                        0.7474644780158997,
                        0.7880831956863403,
                        0.8106998205184937,
                        0.7869675755500793,
                        0.7891988158226013,
                        0.7574543356895447,
                        0.7782454490661621,
                        0.7592799067497253,
                        0.8024340867996216,
                        0.7907201051712036,
                        0.8026876449584961,
                        0.8668357133865356,
                        0.6724138259887695,
                        0.7876268029212952,
                        0.8291582465171814,
                        0.7860040664672852,
                        0.735040545463562,
                        0.7603448033332825,
                        0.9840770959854126,
                        0.9003042578697205,
                        0.9936612844467163,
                        0.8220081329345703,
                        0.8511156439781189,
                        0.8474645018577576,
                        0.8628803491592407,
                        0.8560851812362671,
                        0.8656693696975708,
                        0.8629310131072998,
                        0.8522312641143799,
                        0.8836206793785095,
                        0.8736308217048645,
                        0.7833671569824219,
                        0.8488844037055969,
                        0.8563894629478455,
                        0.8541074991226196,
                        0.7973631024360657,
                        0.8080121874809265,
                        0.7816430330276489,
                        0.9968559741973877,
                        0.7136917114257812
                    ]
                }
            },
            "40000": {
                "train": {
                    "pretrain_loss": 0.14675338566303253,
                    "features_accuracy": [
                        0.9706797003746033,
                        0.8366320729255676,
                        0.9722148180007935,
                        0.9738578200340271,
                        0.9504624605178833,
                        0.9731917381286621,
                        0.9727286696434021,
                        0.9741940498352051,
                        0.9360814094543457,
                        0.9724432229995728,
                        0.9961621165275574,
                        0.9705908894538879,
                        0.9737499952316284,
                        0.9735152721405029,
                        0.9646849036216736,
                        0.9737880825996399,
                        0.9733440279960632,
                        0.9713457822799683,
                        0.9706416130065918,
                        0.9434337019920349,
                        0.9737372994422913,
                        0.9499613046646118,
                        0.8874256610870361,
                        0.9427486062049866,
                        0.9465864896774292,
                        0.9432306885719299,
                        0.9582968950271606,
                        0.9652241468429565,
                        0.968319833278656,
                        0.9858853816986084,
                        0.8809424042701721,
                        0.9961557984352112,
                        0.89060378074646,
                        0.885877788066864,
                        0.882750391960144,
                        0.8885231018066406,
                        0.888275682926178,
                        0.8949809074401855,
                        0.8929826617240906,
                        0.896148145198822,
                        0.8689085245132446,
                        0.8879204392433167,
                        0.9735469818115234,
                        0.8835052847862244,
                        0.8903881311416626,
                        0.8911874294281006,
                        0.9738959074020386,
                        0.96538907289505,
                        0.9737499952316284,
                        0.9978432059288025,
                        0.9624900221824646
                    ]
                },
                "val": {
                    "pretrain_loss": 0.7714259028434753,
                    "features_accuracy": [
                        0.7207686901092529,
                        0.8622857332229614,
                        0.5053240060806274,
                        0.6528749465942383,
                        0.41359901428222656,
                        0.4180610477924347,
                        0.23968157172203064,
                        0.6540411710739136,
                        0.3212655782699585,
                        0.6120575666427612,
                        0.9927492141723633,
                        0.35599836707115173,
                        0.5742825269699097,
                        0.7222898006439209,
                        0.6379170417785645,
                        0.5498427748680115,
                        0.29718080163002014,
                        0.7161545157432556,
                        0.3984382748603821,
                        0.5734712481498718,
                        0.3442348539829254,
                        0.7008923888206482,
                        0.4718081057071686,
                        0.6533820033073425,
                        0.706013560295105,
                        0.6914612650871277,
                        0.7019571661949158,
                        0.7382618188858032,
                        0.36598721146583557,
                        0.9835716485977173,
                        0.8988438844680786,
                        0.9927998781204224,
                        0.8570631742477417,
                        0.8542236685752869,
                        0.8439306020736694,
                        0.8565053939819336,
                        0.8540715575218201,
                        0.8398742079734802,
                        0.8620829582214355,
                        0.8223810791969299,
                        0.8672547936439514,
                        0.8521447777748108,
                        0.26265084743499756,
                        0.8451982140541077,
                        0.8596997857093811,
                        0.859649121761322,
                        0.7039853930473328,
                        0.5225129127502441,
                        0.5576006174087524,
                        0.9960957169532776,
                        0.717270016670227
                    ]
                },
                "test": {
                    "pretrain_loss": 0.4272342920303345,
                    "features_accuracy": [
                        0.7473630905151367,
                        0.6417343020439148,
                        0.7970588207244873,
                        0.8062880635261536,
                        0.807251513004303,
                        0.7820993661880493,
                        0.7906186580657959,
                        0.7981237173080444,
                        0.8052231073379517,
                        0.8044624924659729,
                        0.9936612844467163,
                        0.7664300203323364,
                        0.8028904795646667,
                        0.813843846321106,
                        0.7934584021568298,
                        0.8020790815353394,
                        0.7742900848388672,
                        0.7761155962944031,
                        0.7651115655899048,
                        0.8147565722465515,
                        0.7979716062545776,
                        0.8047160506248474,
                        0.8701825737953186,
                        0.6799188852310181,
                        0.7871196866035461,
                        0.8491886258125305,
                        0.7896551489830017,
                        0.735040545463562,
                        0.7813387513160706,
                        0.9828600287437439,
                        0.8993407487869263,
                        0.9938133955001831,
                        0.849442183971405,
                        0.8517748713493347,
                        0.8437119722366333,
                        0.8564908504486084,
                        0.8706896305084229,
                        0.8719574213027954,
                        0.8626267910003662,
                        0.8613590598106384,
                        0.8729715943336487,
                        0.8765212893486023,
                        0.7944726347923279,
                        0.8477180600166321,
                        0.8557809591293335,
                        0.852789044380188,
                        0.7896551489830017,
                        0.8080121874809265,
                        0.7929513454437256,
                        0.9969574213027954,
                        0.7138945460319519
                    ]
                }
            }
        },
        "train": {
            "score": -3.526993989169637
        },
        "val": {
            "score": -5.263450002450967
        },
        "test": {
            "score": -5.548234294370656
        }
    },
    "best_iteration": 10000,
    "time": "0:04:33"
}
