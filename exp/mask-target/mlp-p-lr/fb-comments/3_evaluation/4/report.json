{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_fast___88f334f0dee44fc782727ac73dc94e4f.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0,1",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                },
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 4,
        "data": {
            "path": "data/fb-comments",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512
                ],
                "dropout": 0.3165243883109578
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "positional",
                "linear",
                "relu"
            ],
            "d_num_embedding": 11,
            "positional_encoding": {
                "n": 35,
                "sigma": 0.3078928096197865,
                "trainable": true,
                "initialization": "normal"
            },
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 512,
            "lr": 0.00015569191898648328,
            "weight_decay": 0.0007948790593667655,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 1024
        },
        "pretrain": {
            "corrupt_probability": 0.7425803516231099,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.00015569191898648328,
            "weight_decay": 0.0007948790593667655,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "target_shuffle",
            "n_neighbors": 20,
            "use_target": true,
            "early_stop_type": "pretrain",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "n_parameters": 653715,
    "epoch_size": 308,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "pretrain_loss": 0.16335608065128326,
                    "features_accuracy": [
                        0.965458869934082,
                        0.771888792514801,
                        0.9648181200027466,
                        0.9688336849212646,
                        0.9255827069282532,
                        0.9661312699317932,
                        0.9660678505897522,
                        0.966124951839447,
                        0.9039444923400879,
                        0.967120885848999,
                        0.9962192177772522,
                        0.9655413031578064,
                        0.9663596749305725,
                        0.9665626287460327,
                        0.9535455107688904,
                        0.9657062292098999,
                        0.9660488367080688,
                        0.9639871120452881,
                        0.9649133086204529,
                        0.9218969941139221,
                        0.966588020324707,
                        0.9411056041717529,
                        0.8850975036621094,
                        0.9366840720176697,
                        0.9410611987113953,
                        0.9362273216247559,
                        0.9539387822151184,
                        0.9611198306083679,
                        0.960910439491272,
                        0.9854477047920227,
                        0.8775041699409485,
                        0.9961177110671997,
                        0.8883581757545471,
                        0.8837780356407166,
                        0.8798322677612305,
                        0.8877238035202026,
                        0.8882693648338318,
                        0.8946256637573242,
                        0.8919423222541809,
                        0.8955264687538147,
                        0.8654258847236633,
                        0.8876349925994873,
                        0.9656428098678589,
                        0.8810248970985413,
                        0.8869245052337646,
                        0.8896776437759399,
                        0.9664674997329712,
                        0.9548776745796204,
                        0.9661503434181213,
                        0.9974879622459412,
                        0.9626613259315491
                    ]
                },
                "val": {
                    "pretrain_loss": 0.5823876261711121,
                    "features_accuracy": [
                        0.7378054857254028,
                        0.8494067192077637,
                        0.6457762718200684,
                        0.7436365485191345,
                        0.4328668415546417,
                        0.6792921423912048,
                        0.7358787059783936,
                        0.7135179042816162,
                        0.475712388753891,
                        0.6355845928192139,
                        0.9927998781204224,
                        0.7353716492652893,
                        0.7423182129859924,
                        0.7341040372848511,
                        0.6835006475448608,
                        0.7292870879173279,
                        0.7170672416687012,
                        0.7384646534919739,
                        0.7421153783798218,
                        0.3432714641094208,
                        0.6501368880271912,
                        0.7619916796684265,
                        0.4570530354976654,
                        0.3609674274921417,
                        0.7201095223426819,
                        0.7240137457847595,
                        0.7268025279045105,
                        0.7334955930709839,
                        0.5814318656921387,
                        0.9838758707046509,
                        0.8939255475997925,
                        0.9928506016731262,
                        0.8557955622673035,
                        0.8567082285881042,
                        0.8487475514411926,
                        0.8692830204963684,
                        0.8521955013275146,
                        0.8573673963546753,
                        0.8630463480949402,
                        0.8617280125617981,
                        0.8802352547645569,
                        0.8521955013275146,
                        0.7389717102050781,
                        0.8552377820014954,
                        0.8789676427841187,
                        0.8587363958358765,
                        0.7224419116973877,
                        0.6451678276062012,
                        0.7060642838478088,
                        0.9956900477409363,
                        0.7148869037628174
                    ]
                },
                "test": {
                    "pretrain_loss": 0.4492659568786621,
                    "features_accuracy": [
                        0.738894522190094,
                        0.637221097946167,
                        0.7630324363708496,
                        0.7658722400665283,
                        0.7632352709770203,
                        0.7599391341209412,
                        0.7353955507278442,
                        0.7658722400665283,
                        0.811612606048584,
                        0.7787018418312073,
                        0.9932555556297302,
                        0.7432555556297302,
                        0.7399594187736511,
                        0.7606490850448608,
                        0.7824543714523315,
                        0.7445740103721619,
                        0.7403144240379333,
                        0.7647058963775635,
                        0.7394523620605469,
                        0.8216531276702881,
                        0.7465517520904541,
                        0.7904158234596252,
                        0.8661764860153198,
                        0.6275355219841003,
                        0.7831643223762512,
                        0.8362576365470886,
                        0.7308316230773926,
                        0.738793134689331,
                        0.73164302110672,
                        0.9836207032203674,
                        0.9001014232635498,
                        0.9933570027351379,
                        0.8382353186607361,
                        0.8548174500465393,
                        0.843914806842804,
                        0.8592799305915833,
                        0.8557302355766296,
                        0.8639959692955017,
                        0.8631339073181152,
                        0.851064920425415,
                        0.8831136226654053,
                        0.8540061116218567,
                        0.7368153929710388,
                        0.8441176414489746,
                        0.8645537495613098,
                        0.851166307926178,
                        0.7971095442771912,
                        0.762728214263916,
                        0.756135880947113,
                        0.9968559741973877,
                        0.7160243391990662
                    ]
                }
            },
            "20000": {
                "train": {
                    "pretrain_loss": 0.15438707172870636,
                    "features_accuracy": [
                        0.9690240025520325,
                        0.7959819436073303,
                        0.9687067866325378,
                        0.9713140726089478,
                        0.9329984188079834,
                        0.9708953499794006,
                        0.9695631861686707,
                        0.9703688621520996,
                        0.9200827479362488,
                        0.9703497886657715,
                        0.9961557984352112,
                        0.9692650437355042,
                        0.970584511756897,
                        0.9701975584030151,
                        0.9590010046958923,
                        0.9706352949142456,
                        0.9698867201805115,
                        0.9700199365615845,
                        0.9676791429519653,
                        0.9323640465736389,
                        0.9696456789970398,
                        0.9472525715827942,
                        0.8862584233283997,
                        0.9394308924674988,
                        0.9416764974594116,
                        0.9388726353645325,
                        0.9571613669395447,
                        0.9646214842796326,
                        0.9654524922370911,
                        0.9857712388038635,
                        0.8810058832168579,
                        0.9961494207382202,
                        0.8890559673309326,
                        0.8847676515579224,
                        0.8808155655860901,
                        0.8887705206871033,
                        0.888212263584137,
                        0.8941435813903809,
                        0.8924561738967896,
                        0.8961164355278015,
                        0.8668721914291382,
                        0.888009250164032,
                        0.9714282155036926,
                        0.8816719651222229,
                        0.8889037370681763,
                        0.8896395564079285,
                        0.9713140726089478,
                        0.960847020149231,
                        0.9720054864883423,
                        0.9978368282318115,
                        0.9618366360664368
                    ]
                },
                "val": {
                    "pretrain_loss": 0.6637544631958008,
                    "features_accuracy": [
                        0.48975762724876404,
                        0.8463137149810791,
                        0.400567889213562,
                        0.5700232982635498,
                        0.34930533170700073,
                        0.3813507556915283,
                        0.6640806794166565,
                        0.6631172895431519,
                        0.4768786132335663,
                        0.2562113404273987,
                        0.9925463795661926,
                        0.6744751930236816,
                        0.3590913712978363,
                        0.7284250855445862,
                        0.6773146390914917,
                        0.2755805552005768,
                        0.6385762095451355,
                        0.3637562096118927,
                        0.7413548231124878,
                        0.5639387369155884,
                        0.6522157788276672,
                        0.7543352246284485,
                        0.4746983051300049,
                        0.44721630215644836,
                        0.7203122973442078,
                        0.7302504777908325,
                        0.6759456396102905,
                        0.733546257019043,
                        0.34808841347694397,
                        0.9842307567596436,
                        0.8937227129936218,
                        0.9929013252258301,
                        0.8571138381958008,
                        0.8542236685752869,
                        0.8461616039276123,
                        0.8603082895278931,
                        0.8520433902740479,
                        0.8537166118621826,
                        0.8608152866363525,
                        0.8274515271186829,
                        0.8751140832901001,
                        0.8534631133079529,
                        0.7233546376228333,
                        0.8449954390525818,
                        0.861829400062561,
                        0.8574687838554382,
                        0.6928810477256775,
                        0.6154547929763794,
                        0.5257580280303955,
                        0.9959436058998108,
                        0.7154446840286255
                    ]
                },
                "test": {
                    "pretrain_loss": 0.4361076354980469,
                    "features_accuracy": [
                        0.7440162301063538,
                        0.6391987800598145,
                        0.7895537614822388,
                        0.7929513454437256,
                        0.7775354981422424,
                        0.7997464537620544,
                        0.7679005861282349,
                        0.8081642985343933,
                        0.8136916756629944,
                        0.7990872263908386,
                        0.9933062791824341,
                        0.7713996171951294,
                        0.7936105728149414,
                        0.798884391784668,
                        0.7998479008674622,
                        0.7925456166267395,
                        0.776673436164856,
                        0.7906693816184998,
                        0.739503026008606,
                        0.8201318383216858,
                        0.8077079057693481,
                        0.798275887966156,
                        0.8666836023330688,
                        0.6502028703689575,
                        0.7902129888534546,
                        0.8470588326454163,
                        0.7340263724327087,
                        0.738793134689331,
                        0.7673428058624268,
                        0.9825558066368103,
                        0.8994929194450378,
                        0.9935598373413086,
                        0.8434584140777588,
                        0.8527383208274841,
                        0.8424949049949646,
                        0.8602434396743774,
                        0.8591784834861755,
                        0.8652129769325256,
                        0.8627281785011292,
                        0.7663286328315735,
                        0.8875253796577454,
                        0.8540567755699158,
                        0.7696247696876526,
                        0.8457403779029846,
                        0.8555781245231628,
                        0.849949300289154,
                        0.797261655330658,
                        0.813843846321106,
                        0.7975152134895325,
                        0.9970588088035583,
                        0.7161257863044739
                    ]
                }
            },
            "30000": {
                "train": {
                    "pretrain_loss": 0.14979785680770874,
                    "features_accuracy": [
                        0.96938556432724,
                        0.8097921013832092,
                        0.9716249108314514,
                        0.9723036289215088,
                        0.9426153898239136,
                        0.9725574254989624,
                        0.9721069931983948,
                        0.9729443788528442,
                        0.9302579760551453,
                        0.9724622368812561,
                        0.9962572455406189,
                        0.970191240310669,
                        0.9728111624717712,
                        0.9726271629333496,
                        0.961513102054596,
                        0.9720562696456909,
                        0.9722465872764587,
                        0.9708319306373596,
                        0.969119131565094,
                        0.938041627407074,
                        0.9728935956954956,
                        0.94957435131073,
                        0.8874256610870361,
                        0.9428881406784058,
                        0.944182276725769,
                        0.9413720369338989,
                        0.9582207798957825,
                        0.9642979502677917,
                        0.9668417572975159,
                        0.9858853816986084,
                        0.8813420534133911,
                        0.9962192177772522,
                        0.8902612328529358,
                        0.8847930431365967,
                        0.8809868097305298,
                        0.8894239068031311,
                        0.8875651955604553,
                        0.8942387104034424,
                        0.8920121192932129,
                        0.897017240524292,
                        0.8676144480705261,
                        0.8881170749664307,
                        0.972316324710846,
                        0.883416473865509,
                        0.8902168273925781,
                        0.8920247554779053,
                        0.9726462364196777,
                        0.9631370902061462,
                        0.9727159738540649,
                        0.997938334941864,
                        0.9618493318557739
                    ]
                },
                "val": {
                    "pretrain_loss": 0.7162739634513855,
                    "features_accuracy": [
                        0.5619612336158752,
                        0.8529053330421448,
                        0.2605719566345215,
                        0.528952419757843,
                        0.2957610785961151,
                        0.5264171957969666,
                        0.6527228355407715,
                        0.6659567952156067,
                        0.47895750403404236,
                        0.3569110631942749,
                        0.9927998781204224,
                        0.4633404314517975,
                        0.3586350083351135,
                        0.6387789845466614,
                        0.584626317024231,
                        0.27228474617004395,
                        0.6451171040534973,
                        0.439762681722641,
                        0.7393773198127747,
                        0.563482403755188,
                        0.6745765805244446,
                        0.7333434820175171,
                        0.49807319045066833,
                        0.6591116189956665,
                        0.7260419726371765,
                        0.7342561483383179,
                        0.6873034834861755,
                        0.7336983680725098,
                        0.34753066301345825,
                        0.9830138683319092,
                        0.8982861638069153,
                        0.9926477670669556,
                        0.8574180603027344,
                        0.8549842834472656,
                        0.8465672731399536,
                        0.8626406788825989,
                        0.852753221988678,
                        0.8368826508522034,
                        0.8620322346687317,
                        0.8058006167411804,
                        0.8684717416763306,
                        0.8530575037002563,
                        0.7100699543952942,
                        0.8464658260345459,
                        0.8634519577026367,
                        0.8588378429412842,
                        0.6696582436561584,
                        0.6817259788513184,
                        0.4871716797351837,
                        0.9959436058998108,
                        0.715951681137085
                    ]
                },
                "test": {
                    "pretrain_loss": 0.4284234046936035,
                    "features_accuracy": [
                        0.7413793206214905,
                        0.6440669298171997,
                        0.7900101542472839,
                        0.8017748594284058,
                        0.774442195892334,
                        0.8052231073379517,
                        0.7758113741874695,
                        0.7968559861183167,
                        0.7852433919906616,
                        0.8018762469291687,
                        0.9933062791824341,
                        0.7697768807411194,
                        0.7888438105583191,
                        0.8113590478897095,
                        0.7962982058525085,
                        0.7902129888534546,
                        0.7723630666732788,
                        0.7899087071418762,
                        0.741632878780365,
                        0.7864604592323303,
                        0.8038032650947571,
                        0.8009127974510193,
                        0.8765212893486023,
                        0.7062373161315918,
                        0.7959432005882263,
                        0.8573529720306396,
                        0.7415821552276611,
                        0.738793134689331,
                        0.7737829685211182,
                        0.9824036359786987,
                        0.9006085395812988,
                        0.9935598373413086,
                        0.8551723957061768,
                        0.8546146154403687,
                        0.844929039478302,
                        0.860547661781311,
                        0.8604462742805481,
                        0.8715517520904541,
                        0.8673934936523438,
                        0.7884381413459778,
                        0.8806288242340088,
                        0.8559330701828003,
                        0.7836713790893555,
                        0.8514705896377563,
                        0.8686612844467163,
                        0.8520790934562683,
                        0.8036004304885864,
                        0.7879310250282288,
                        0.8007606267929077,
                        0.9970588088035583,
                        0.7164807319641113
                    ]
                }
            },
            "40000": {
                "train": {
                    "pretrain_loss": 0.14645156264305115,
                    "features_accuracy": [
                        0.9703561663627625,
                        0.8318806290626526,
                        0.9723988175392151,
                        0.9733503460884094,
                        0.9474936723709106,
                        0.9729887843132019,
                        0.9724749326705933,
                        0.9738134145736694,
                        0.9356627464294434,
                        0.9741179347038269,
                        0.996206521987915,
                        0.9720752835273743,
                        0.9731220006942749,
                        0.9726588726043701,
                        0.965192437171936,
                        0.9739466309547424,
                        0.9733123183250427,
                        0.9733059406280518,
                        0.9706289172172546,
                        0.9422474503517151,
                        0.9734518527984619,
                        0.9503165483474731,
                        0.8889290690422058,
                        0.9435479044914246,
                        0.9447531700134277,
                        0.9433892965316772,
                        0.9573643803596497,
                        0.9667720198631287,
                        0.9690684080123901,
                        0.9858853816986084,
                        0.8807647824287415,
                        0.9962319135665894,
                        0.8901661038398743,
                        0.8867341876029968,
                        0.8820652365684509,
                        0.8895571231842041,
                        0.888015627861023,
                        0.8959578275680542,
                        0.8931919932365417,
                        0.8976706266403198,
                        0.8686738014221191,
                        0.8880029320716858,
                        0.9731346964836121,
                        0.885344922542572,
                        0.8907940983772278,
                        0.8917773962020874,
                        0.9735406637191772,
                        0.9666070342063904,
                        0.9742701649665833,
                        0.9979700446128845,
                        0.9631624817848206
                    ]
                },
                "val": {
                    "pretrain_loss": 0.7461210489273071,
                    "features_accuracy": [
                        0.3883480131626129,
                        0.8190345764160156,
                        0.2690396308898926,
                        0.5671838521957397,
                        0.2990061640739441,
                        0.5797586441040039,
                        0.6912584900856018,
                        0.5680457949638367,
                        0.48539701104164124,
                        0.30285975337028503,
                        0.9924956560134888,
                        0.26746779680252075,
                        0.4630361795425415,
                        0.6976979970932007,
                        0.6547003388404846,
                        0.44838249683380127,
                        0.5455836057662964,
                        0.3678125739097595,
                        0.717270016670227,
                        0.5743331909179688,
                        0.6511510014533997,
                        0.727056086063385,
                        0.5164283514022827,
                        0.7582395076751709,
                        0.7275630831718445,
                        0.6595679521560669,
                        0.7176249623298645,
                        0.7335969805717468,
                        0.38175639510154724,
                        0.9834194779396057,
                        0.8983875513076782,
                        0.9927492141723633,
                        0.8573166728019714,
                        0.857620894908905,
                        0.8444376587867737,
                        0.8616265654563904,
                        0.8528039455413818,
                        0.8545278906822205,
                        0.8637561798095703,
                        0.8389615416526794,
                        0.8707027435302734,
                        0.8545786142349243,
                        0.714329183101654,
                        0.8467193841934204,
                        0.8617280125617981,
                        0.8587363958358765,
                        0.6596186757087708,
                        0.6166717410087585,
                        0.5490314960479736,
                        0.9961463809013367,
                        0.7144812941551208
                    ]
                },
                "test": {
                    "pretrain_loss": 0.42663946747779846,
                    "features_accuracy": [
                        0.7605476975440979,
                        0.6540567874908447,
                        0.7841277718544006,
                        0.8005577921867371,
                        0.7741886377334595,
                        0.8069472908973694,
                        0.7731237411499023,
                        0.7997464537620544,
                        0.7811866402626038,
                        0.8044624924659729,
                        0.9933062791824341,
                        0.7853955626487732,
                        0.7851420044898987,
                        0.7984279990196228,
                        0.7870182394981384,
                        0.7928498983383179,
                        0.7861054539680481,
                        0.7897565960884094,
                        0.7646551728248596,
                        0.8034482598304749,
                        0.8087221384048462,
                        0.8053245544433594,
                        0.8730730414390564,
                        0.7024340629577637,
                        0.796653151512146,
                        0.8709939122200012,
                        0.7497971653938293,
                        0.738793134689331,
                        0.7614604234695435,
                        0.9824036359786987,
                        0.9004057049751282,
                        0.9934584498405457,
                        0.8511156439781189,
                        0.8528904914855957,
                        0.8424949049949646,
                        0.8572515249252319,
                        0.8713995814323425,
                        0.8733265995979309,
                        0.863793134689331,
                        0.8496957421302795,
                        0.8918864130973816,
                        0.85943204164505,
                        0.784432053565979,
                        0.8632352948188782,
                        0.8582656979560852,
                        0.8524340987205505,
                        0.7972109317779541,
                        0.7910750508308411,
                        0.797261655330658,
                        0.9970588088035583,
                        0.7163286209106445
                    ]
                }
            }
        },
        "train": {
            "score": -3.6563979402908995
        },
        "val": {
            "score": -5.264477038165052
        },
        "test": {
            "score": -5.5200837618445115
        }
    },
    "best_iteration": 10000,
    "time": "0:04:22"
}
