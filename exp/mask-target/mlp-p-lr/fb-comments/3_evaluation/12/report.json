{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_fast___88f334f0dee44fc782727ac73dc94e4f.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0,1",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                },
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 12,
        "data": {
            "path": "data/fb-comments",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512
                ],
                "dropout": 0.3165243883109578
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "positional",
                "linear",
                "relu"
            ],
            "d_num_embedding": 11,
            "positional_encoding": {
                "n": 35,
                "sigma": 0.3078928096197865,
                "trainable": true,
                "initialization": "normal"
            },
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 512,
            "lr": 0.00015569191898648328,
            "weight_decay": 0.0007948790593667655,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 1024
        },
        "pretrain": {
            "corrupt_probability": 0.7425803516231099,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.00015569191898648328,
            "weight_decay": 0.0007948790593667655,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "target_shuffle",
            "n_neighbors": 20,
            "use_target": true,
            "early_stop_type": "pretrain",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "n_parameters": 653715,
    "epoch_size": 308,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "pretrain_loss": 0.16341479122638702,
                    "features_accuracy": [
                        0.9650909304618835,
                        0.7774077653884888,
                        0.9640886187553406,
                        0.9682374000549316,
                        0.9273081421852112,
                        0.9660805463790894,
                        0.9657950401306152,
                        0.9666958451271057,
                        0.9057397246360779,
                        0.966518223285675,
                        0.9961875081062317,
                        0.9655984044075012,
                        0.9654271602630615,
                        0.9655857086181641,
                        0.9524353742599487,
                        0.9656428098678589,
                        0.9667656421661377,
                        0.9646849036216736,
                        0.9639300107955933,
                        0.9230960011482239,
                        0.967323899269104,
                        0.9429516196250916,
                        0.8834925889968872,
                        0.9355993270874023,
                        0.936170220375061,
                        0.9369378089904785,
                        0.9536723494529724,
                        0.959717869758606,
                        0.9607391953468323,
                        0.985536515712738,
                        0.8778594136238098,
                        0.9961811304092407,
                        0.8886817097663879,
                        0.8845710158348083,
                        0.8793755769729614,
                        0.888015627861023,
                        0.886080801486969,
                        0.894416332244873,
                        0.8910605311393738,
                        0.8946764469146729,
                        0.8639732003211975,
                        0.8867214918136597,
                        0.9656111001968384,
                        0.8801811933517456,
                        0.888205885887146,
                        0.8908131718635559,
                        0.967526912689209,
                        0.9555246829986572,
                        0.9660297632217407,
                        0.9975957870483398,
                        0.9616653323173523
                    ]
                },
                "val": {
                    "pretrain_loss": 0.5809134840965271,
                    "features_accuracy": [
                        0.744752049446106,
                        0.863198459148407,
                        0.6689990758895874,
                        0.764526903629303,
                        0.3799310326576233,
                        0.700943112373352,
                        0.7442957162857056,
                        0.7537267804145813,
                        0.47591522336006165,
                        0.7486562728881836,
                        0.9922928214073181,
                        0.7323293685913086,
                        0.7378562092781067,
                        0.7523577809333801,
                        0.6684412956237793,
                        0.7358787059783936,
                        0.5453300476074219,
                        0.736892819404602,
                        0.7336983680725098,
                        0.4701348543167114,
                        0.6896865963935852,
                        0.7458168268203735,
                        0.5146536827087402,
                        0.32785719633102417,
                        0.7390730977058411,
                        0.7075347304344177,
                        0.7237602472305298,
                        0.7429266571998596,
                        0.5475611090660095,
                        0.984585702419281,
                        0.895598828792572,
                        0.9926984906196594,
                        0.8557955622673035,
                        0.8539194464683533,
                        0.8449447154998779,
                        0.8568096160888672,
                        0.850471556186676,
                        0.8582293391227722,
                        0.8594462871551514,
                        0.8501672744750977,
                        0.8727816343307495,
                        0.8532602787017822,
                        0.7336477041244507,
                        0.8582293391227722,
                        0.8657336831092834,
                        0.8583307862281799,
                        0.7357265949249268,
                        0.6585031747817993,
                        0.6165196299552917,
                        0.9959436058998108,
                        0.7197545766830444
                    ]
                },
                "test": {
                    "pretrain_loss": 0.45003876090049744,
                    "features_accuracy": [
                        0.742241382598877,
                        0.6381338834762573,
                        0.7377281785011292,
                        0.7876268029212952,
                        0.7833671569824219,
                        0.7596855759620667,
                        0.7498478889465332,
                        0.7686612606048584,
                        0.8156186938285828,
                        0.7502028346061707,
                        0.9936105608940125,
                        0.7370182871818542,
                        0.7356491088867188,
                        0.7455882430076599,
                        0.7495943307876587,
                        0.759989857673645,
                        0.7612575888633728,
                        0.751724123954773,
                        0.7449290156364441,
                        0.8156186938285828,
                        0.7725152373313904,
                        0.7712474465370178,
                        0.8514705896377563,
                        0.6315922737121582,
                        0.7825050950050354,
                        0.8510141968727112,
                        0.7327079176902771,
                        0.738793134689331,
                        0.7296653389930725,
                        0.9832656979560852,
                        0.8979209065437317,
                        0.9935598373413086,
                        0.8031440377235413,
                        0.8535497188568115,
                        0.8517241477966309,
                        0.8567951321601868,
                        0.8629310131072998,
                        0.8644523620605469,
                        0.8670892715454102,
                        0.698326587677002,
                        0.8922920823097229,
                        0.8617140054702759,
                        0.7389959692955017,
                        0.8487829566001892,
                        0.863894522190094,
                        0.8602941036224365,
                        0.7760142087936401,
                        0.7706389427185059,
                        0.7454867959022522,
                        0.9967038631439209,
                        0.7153143882751465
                    ]
                }
            },
            "20000": {
                "train": {
                    "pretrain_loss": 0.15441454946994781,
                    "features_accuracy": [
                        0.9685038328170776,
                        0.7925437092781067,
                        0.9691952466964722,
                        0.971053957939148,
                        0.9356627464294434,
                        0.9695441722869873,
                        0.96979159116745,
                        0.9694363474845886,
                        0.9222459197044373,
                        0.9709270596504211,
                        0.9963778257369995,
                        0.9676220417022705,
                        0.9703688621520996,
                        0.9699311256408691,
                        0.9592738151550293,
                        0.9695948958396912,
                        0.970654308795929,
                        0.9692143201828003,
                        0.9686052799224854,
                        0.9325416684150696,
                        0.9705781936645508,
                        0.9466626048088074,
                        0.8865121603012085,
                        0.9396021366119385,
                        0.9440363645553589,
                        0.9416130781173706,
                        0.9568886160850525,
                        0.9638665914535522,
                        0.9666641354560852,
                        0.985866367816925,
                        0.8801431059837341,
                        0.9963841438293457,
                        0.8890939950942993,
                        0.8838541507720947,
                        0.8808091878890991,
                        0.8879521489143372,
                        0.886214017868042,
                        0.8942577242851257,
                        0.8930968642234802,
                        0.8957802057266235,
                        0.8679760098457336,
                        0.8866326808929443,
                        0.9702229499816895,
                        0.8818686008453369,
                        0.8883010745048523,
                        0.8896839618682861,
                        0.9707938432693481,
                        0.9624266028404236,
                        0.9710349440574646,
                        0.9980144500732422,
                        0.9623441100120544
                    ]
                },
                "val": {
                    "pretrain_loss": 0.6569482684135437,
                    "features_accuracy": [
                        0.7634114027023315,
                        0.8647702932357788,
                        0.47196024656295776,
                        0.7163573503494263,
                        0.4119257628917694,
                        0.6596186757087708,
                        0.6847682595252991,
                        0.7541831135749817,
                        0.4278470575809479,
                        0.6204745769500732,
                        0.9927998781204224,
                        0.7354223728179932,
                        0.7480478286743164,
                        0.6082547307014465,
                        0.6404522657394409,
                        0.6615961790084839,
                        0.38013383746147156,
                        0.7013994455337524,
                        0.7071797847747803,
                        0.5648514032363892,
                        0.2921103239059448,
                        0.7344082593917847,
                        0.47748705744743347,
                        0.32684311270713806,
                        0.7305039763450623,
                        0.7272081971168518,
                        0.6915627121925354,
                        0.7430280447006226,
                        0.3631477355957031,
                        0.9836730360984802,
                        0.8966128826141357,
                        0.9926477670669556,
                        0.8585842847824097,
                        0.8571645617485046,
                        0.8436771035194397,
                        0.8585336208343506,
                        0.8495081663131714,
                        0.8550349473953247,
                        0.8601561188697815,
                        0.7536760568618774,
                        0.8662407398223877,
                        0.8524489998817444,
                        0.728577196598053,
                        0.8461109399795532,
                        0.8655815720558167,
                        0.8630463480949402,
                        0.6275225281715393,
                        0.5277355313301086,
                        0.4026467800140381,
                        0.995791494846344,
                        0.7202109098434448
                    ]
                },
                "test": {
                    "pretrain_loss": 0.4356292486190796,
                    "features_accuracy": [
                        0.7538032531738281,
                        0.6390466690063477,
                        0.7872210741043091,
                        0.7943711876869202,
                        0.7852941155433655,
                        0.7701318264007568,
                        0.7669371366500854,
                        0.7667849659919739,
                        0.8191176652908325,
                        0.7908214926719666,
                        0.9937626719474792,
                        0.739908754825592,
                        0.7620182633399963,
                        0.8062373399734497,
                        0.7852433919906616,
                        0.7981744408607483,
                        0.7847363352775574,
                        0.7709939479827881,
                        0.7462981939315796,
                        0.7995943427085876,
                        0.7915821671485901,
                        0.7908214926719666,
                        0.8664300441741943,
                        0.6593813300132751,
                        0.7938134074211121,
                        0.8586207032203674,
                        0.7364097237586975,
                        0.7387424111366272,
                        0.7878803014755249,
                        0.9825050830841064,
                        0.8963488936424255,
                        0.9937626719474792,
                        0.8303752541542053,
                        0.8583671450614929,
                        0.8450811505317688,
                        0.8598884344100952,
                        0.8686105608940125,
                        0.8669371008872986,
                        0.8625253438949585,
                        0.7889959216117859,
                        0.8899087309837341,
                        0.8543610572814941,
                        0.7597362995147705,
                        0.8614604473114014,
                        0.8669878244400024,
                        0.882251501083374,
                        0.8021298050880432,
                        0.7898073196411133,
                        0.7998479008674622,
                        0.9969066977500916,
                        0.7154665589332581
                    ]
                }
            },
            "30000": {
                "train": {
                    "pretrain_loss": 0.14928065240383148,
                    "features_accuracy": [
                        0.969988226890564,
                        0.8129702210426331,
                        0.9711744785308838,
                        0.9724115133285522,
                        0.944315493106842,
                        0.9729887843132019,
                        0.9722211956977844,
                        0.9736992716789246,
                        0.9311841130256653,
                        0.9724115133285522,
                        0.996403157711029,
                        0.9705083966255188,
                        0.9719483852386475,
                        0.9731664061546326,
                        0.9620523452758789,
                        0.9732298254966736,
                        0.9724749326705933,
                        0.9713013768196106,
                        0.9699692130088806,
                        0.9390121698379517,
                        0.9730458855628967,
                        0.9485594034194946,
                        0.8862837553024292,
                        0.941498875617981,
                        0.9448419809341431,
                        0.9414037466049194,
                        0.9584554433822632,
                        0.9640188217163086,
                        0.9675522446632385,
                        0.9857141375541687,
                        0.8805745244026184,
                        0.99640953540802,
                        0.8895761370658875,
                        0.8866707682609558,
                        0.8822872638702393,
                        0.8905784487724304,
                        0.8874636888504028,
                        0.8952093124389648,
                        0.8944417238235474,
                        0.8964462876319885,
                        0.8682170510292053,
                        0.8867595791816711,
                        0.9728111624717712,
                        0.8832261562347412,
                        0.8907940983772278,
                        0.8903247117996216,
                        0.9732171297073364,
                        0.9645960927009583,
                        0.9729316830635071,
                        0.9979129433631897,
                        0.9617224335670471
                    ]
                },
                "val": {
                    "pretrain_loss": 0.7035520076751709,
                    "features_accuracy": [
                        0.6796977519989014,
                        0.8606631755828857,
                        0.6237196922302246,
                        0.7424703240394592,
                        0.4157286286354065,
                        0.7044417262077332,
                        0.5871108174324036,
                        0.4793631434440613,
                        0.41314268112182617,
                        0.6105871200561523,
                        0.993002712726593,
                        0.7328364253044128,
                        0.6286887526512146,
                        0.6760470271110535,
                        0.6827400922775269,
                        0.7219348549842834,
                        0.45826995372772217,
                        0.5914714336395264,
                        0.6746273040771484,
                        0.5662711262702942,
                        0.278572142124176,
                        0.7284250855445862,
                        0.47241657972335815,
                        0.6775174736976624,
                        0.7247743606567383,
                        0.727816641330719,
                        0.7269039154052734,
                        0.7428252696990967,
                        0.37719297409057617,
                        0.9823039770126343,
                        0.8975256085395813,
                        0.9928506016731262,
                        0.8586350083351135,
                        0.8556941151618958,
                        0.8422066569328308,
                        0.8560490608215332,
                        0.8529560565948486,
                        0.8570124506950378,
                        0.8637054562568665,
                        0.8431193232536316,
                        0.8670520186424255,
                        0.8539701700210571,
                        0.6290944218635559,
                        0.8458067178726196,
                        0.8605617880821228,
                        0.8581786751747131,
                        0.7268532514572144,
                        0.5658655166625977,
                        0.49716052412986755,
                        0.9958928823471069,
                        0.7201095223426819
                    ]
                },
                "test": {
                    "pretrain_loss": 0.43014052510261536,
                    "features_accuracy": [
                        0.7658722400665283,
                        0.6430527567863464,
                        0.786156177520752,
                        0.7842292189598083,
                        0.7860040664672852,
                        0.7790060639381409,
                        0.7907201051712036,
                        0.800000011920929,
                        0.789401650428772,
                        0.7887930870056152,
                        0.9936612844467163,
                        0.7498986124992371,
                        0.781085193157196,
                        0.7892494797706604,
                        0.7740872502326965,
                        0.7897058725357056,
                        0.7876268029212952,
                        0.7804766893386841,
                        0.749492883682251,
                        0.7891480922698975,
                        0.7848377227783203,
                        0.7696754336357117,
                        0.8766734600067139,
                        0.6840770840644836,
                        0.7847363352775574,
                        0.8411257863044739,
                        0.7432048916816711,
                        0.7387424111366272,
                        0.7633874416351318,
                        0.982758641242981,
                        0.8972616791725159,
                        0.9937119483947754,
                        0.8336713910102844,
                        0.8529411554336548,
                        0.8496450185775757,
                        0.8585699796676636,
                        0.8581643104553223,
                        0.8687119483947754,
                        0.8653144240379333,
                        0.8152129650115967,
                        0.8864604234695435,
                        0.8709939122200012,
                        0.7725659012794495,
                        0.8567951321601868,
                        0.8661764860153198,
                        0.8538539409637451,
                        0.7753042578697205,
                        0.7907201051712036,
                        0.7999492883682251,
                        0.9969574213027954,
                        0.7153651118278503
                    ]
                }
            },
            "40000": {
                "train": {
                    "pretrain_loss": 0.14616812765598297,
                    "features_accuracy": [
                        0.9707431197166443,
                        0.8366383910179138,
                        0.9723100066184998,
                        0.9734328389167786,
                        0.9498153924942017,
                        0.9739149212837219,
                        0.9731917381286621,
                        0.9741116166114807,
                        0.9394499063491821,
                        0.9733884334564209,
                        0.9963778257369995,
                        0.970584511756897,
                        0.9729824066162109,
                        0.9738261103630066,
                        0.9655539989471436,
                        0.9740037322044373,
                        0.9732869267463684,
                        0.9718976616859436,
                        0.9719674587249756,
                        0.9432814717292786,
                        0.9747079014778137,
                        0.9499295949935913,
                        0.8879331350326538,
                        0.9428881406784058,
                        0.9459711909294128,
                        0.9431038498878479,
                        0.9582270979881287,
                        0.9658775329589844,
                        0.9688082933425903,
                        0.9860376715660095,
                        0.8807394504547119,
                        0.9963587522506714,
                        0.8903120160102844,
                        0.886873722076416,
                        0.884545624256134,
                        0.8890813589096069,
                        0.8897727727890015,
                        0.8949682116508484,
                        0.8941181898117065,
                        0.8969982266426086,
                        0.8686991930007935,
                        0.888212263584137,
                        0.9734074473381042,
                        0.8828265070915222,
                        0.8923736810684204,
                        0.8895507454872131,
                        0.973800778388977,
                        0.9677298665046692,
                        0.9737119674682617,
                        0.9981476664543152,
                        0.9626676440238953
                    ]
                },
                "val": {
                    "pretrain_loss": 0.7468168139457703,
                    "features_accuracy": [
                        0.5589696764945984,
                        0.8634519577026367,
                        0.7068248391151428,
                        0.7256870269775391,
                        0.41927796602249146,
                        0.6416184902191162,
                        0.6427847146987915,
                        0.5857924818992615,
                        0.4771828353404999,
                        0.5930432677268982,
                        0.9926984906196594,
                        0.6977486610412598,
                        0.41334548592567444,
                        0.7004360556602478,
                        0.6498833894729614,
                        0.713010847568512,
                        0.5412737131118774,
                        0.6500861644744873,
                        0.6253422498703003,
                        0.5673866868019104,
                        0.282121479511261,
                        0.731365978717804,
                        0.5260115265846252,
                        0.7492647767066956,
                        0.7068755626678467,
                        0.5757529735565186,
                        0.69465571641922,
                        0.7430280447006226,
                        0.4505121111869812,
                        0.9823039770126343,
                        0.897880494594574,
                        0.9926984906196594,
                        0.8628435134887695,
                        0.8570631742477417,
                        0.8436771035194397,
                        0.859750509262085,
                        0.8524489998817444,
                        0.7999695539474487,
                        0.8649224042892456,
                        0.8161950707435608,
                        0.8686745762825012,
                        0.8526011109352112,
                        0.710881233215332,
                        0.8451475501060486,
                        0.8587871193885803,
                        0.859649121761322,
                        0.6765033602714539,
                        0.5176452398300171,
                        0.4742419421672821,
                        0.995791494846344,
                        0.7205658555030823
                    ]
                },
                "test": {
                    "pretrain_loss": 0.4280730187892914,
                    "features_accuracy": [
                        0.763336718082428,
                        0.6434584259986877,
                        0.7870689630508423,
                        0.7898580431938171,
                        0.781693696975708,
                        0.794421911239624,
                        0.7956389784812927,
                        0.8088235259056091,
                        0.8012677431106567,
                        0.7994928956031799,
                        0.9936105608940125,
                        0.7518762946128845,
                        0.78392493724823,
                        0.8018762469291687,
                        0.786156177520752,
                        0.8008113503456116,
                        0.7859026193618774,
                        0.7778397798538208,
                        0.758874237537384,
                        0.791632890701294,
                        0.7976166605949402,
                        0.7737322449684143,
                        0.8628296256065369,
                        0.6942697763442993,
                        0.7862576246261597,
                        0.8680020570755005,
                        0.7371196746826172,
                        0.7387424111366272,
                        0.7715517282485962,
                        0.9825050830841064,
                        0.8967545628547668,
                        0.9937119483947754,
                        0.8440669178962708,
                        0.8537018299102783,
                        0.8474137783050537,
                        0.8618153929710388,
                        0.852687656879425,
                        0.8926470875740051,
                        0.8631845712661743,
                        0.7787525653839111,
                        0.8911257386207581,
                        0.853803277015686,
                        0.7756592035293579,
                        0.8467038869857788,
                        0.8568965792655945,
                        0.8542089462280273,
                        0.7949796915054321,
                        0.807251513004303,
                        0.793914794921875,
                        0.9969574213027954,
                        0.7156186699867249
                    ]
                }
            }
        },
        "train": {
            "score": -3.52441257409665
        },
        "val": {
            "score": -5.2733871149161216
        },
        "test": {
            "score": -5.603470611858729
        }
    },
    "best_iteration": 10000,
    "time": "0:04:35"
}
