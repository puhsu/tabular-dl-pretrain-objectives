{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_fast___88f334f0dee44fc782727ac73dc94e4f.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0,1",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                },
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 6,
        "data": {
            "path": "data/fb-comments",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512
                ],
                "dropout": 0.3165243883109578
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "positional",
                "linear",
                "relu"
            ],
            "d_num_embedding": 11,
            "positional_encoding": {
                "n": 35,
                "sigma": 0.3078928096197865,
                "trainable": true,
                "initialization": "normal"
            },
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 512,
            "lr": 0.00015569191898648328,
            "weight_decay": 0.0007948790593667655,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 1024
        },
        "pretrain": {
            "corrupt_probability": 0.7425803516231099,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.00015569191898648328,
            "weight_decay": 0.0007948790593667655,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "target_shuffle",
            "n_neighbors": 20,
            "use_target": true,
            "early_stop_type": "pretrain",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "n_parameters": 653715,
    "epoch_size": 308,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "pretrain_loss": 0.16393618285655975,
                    "features_accuracy": [
                        0.9667783379554749,
                        0.7746926546096802,
                        0.9638856053352356,
                        0.9657697081565857,
                        0.925563633441925,
                        0.9657379984855652,
                        0.9668671488761902,
                        0.9669749736785889,
                        0.9018003344535828,
                        0.9669686555862427,
                        0.9960986971855164,
                        0.9642091393470764,
                        0.9653383493423462,
                        0.9668861627578735,
                        0.9510207176208496,
                        0.9664294123649597,
                        0.9662644863128662,
                        0.9638348817825317,
                        0.9653002619743347,
                        0.9227216839790344,
                        0.9664484858512878,
                        0.9419810175895691,
                        0.8846407532691956,
                        0.9374326467514038,
                        0.9382889866828918,
                        0.9362463355064392,
                        0.9535137414932251,
                        0.9616780281066895,
                        0.9605932831764221,
                        0.9858346581459045,
                        0.8791598677635193,
                        0.9960606098175049,
                        0.888079047203064,
                        0.884545624256134,
                        0.8789885640144348,
                        0.8874002695083618,
                        0.8869816064834595,
                        0.8936043381690979,
                        0.8916568756103516,
                        0.8960403203964233,
                        0.8632563352584839,
                        0.887609601020813,
                        0.965122640132904,
                        0.8799084424972534,
                        0.8875588774681091,
                        0.8894683122634888,
                        0.968116819858551,
                        0.9540212750434875,
                        0.9660488367080688,
                        0.9971327185630798,
                        0.9623568058013916
                    ]
                },
                "val": {
                    "pretrain_loss": 0.5844903588294983,
                    "features_accuracy": [
                        0.7390730977058411,
                        0.8628941774368286,
                        0.7333941459655762,
                        0.7475407719612122,
                        0.3894128203392029,
                        0.6224520802497864,
                        0.5272791385650635,
                        0.7206672430038452,
                        0.4728222191333771,
                        0.710982620716095,
                        0.9925463795661926,
                        0.7318730354309082,
                        0.7387688755989075,
                        0.6379677057266235,
                        0.5289016962051392,
                        0.5275834202766418,
                        0.7258898615837097,
                        0.74054354429245,
                        0.7382110953330994,
                        0.5568400621414185,
                        0.7216813564300537,
                        0.7235574126243591,
                        0.4708954393863678,
                        0.48539701104164124,
                        0.7212250232696533,
                        0.6935908794403076,
                        0.6720413565635681,
                        0.7424703240394592,
                        0.5467498302459717,
                        0.9837237596511841,
                        0.883733868598938,
                        0.9924449324607849,
                        0.8586350083351135,
                        0.8543251156806946,
                        0.8444883823394775,
                        0.8556941151618958,
                        0.8522462248802185,
                        0.8541222810745239,
                        0.8599533438682556,
                        0.8601561188697815,
                        0.875316858291626,
                        0.8527025580406189,
                        0.7347632050514221,
                        0.8596997857093811,
                        0.8629956245422363,
                        0.8584828972816467,
                        0.365682989358902,
                        0.6747286915779114,
                        0.41466382145881653,
                        0.9956393837928772,
                        0.7209208011627197
                    ]
                },
                "test": {
                    "pretrain_loss": 0.4486570954322815,
                    "features_accuracy": [
                        0.741125762462616,
                        0.6397058963775635,
                        0.7516734600067139,
                        0.7724645137786865,
                        0.7882353067398071,
                        0.7532454133033752,
                        0.7566937208175659,
                        0.7690669298171997,
                        0.8191176652908325,
                        0.7687627077102661,
                        0.9933570027351379,
                        0.7411764860153198,
                        0.7402129769325256,
                        0.7628803253173828,
                        0.8024340867996216,
                        0.7618154287338257,
                        0.7531947493553162,
                        0.7415314316749573,
                        0.7340263724327087,
                        0.7986308336257935,
                        0.7357504963874817,
                        0.7922921180725098,
                        0.8546653389930725,
                        0.6643002033233643,
                        0.7829614877700806,
                        0.8209432363510132,
                        0.7315922975540161,
                        0.7332656979560852,
                        0.7312373518943787,
                        0.983924925327301,
                        0.8947768807411194,
                        0.9933570027351379,
                        0.8376267552375793,
                        0.8519777059555054,
                        0.8479208946228027,
                        0.8575050830841064,
                        0.8565922975540161,
                        0.8659736514091492,
                        0.8642494678497314,
                        0.8112576007843018,
                        0.8915821313858032,
                        0.854411780834198,
                        0.7377281785011292,
                        0.8707910776138306,
                        0.876014232635498,
                        0.8520790934562683,
                        0.7929513454437256,
                        0.7808823585510254,
                        0.7676470875740051,
                        0.9966024160385132,
                        0.7158722281455994
                    ]
                }
            },
            "20000": {
                "train": {
                    "pretrain_loss": 0.15400934219360352,
                    "features_accuracy": [
                        0.9693094491958618,
                        0.7978850603103638,
                        0.9703688621520996,
                        0.9721513986587524,
                        0.9362463355064392,
                        0.9704449772834778,
                        0.9712696671485901,
                        0.9707241058349609,
                        0.9197909235954285,
                        0.9706860184669495,
                        0.9959781765937805,
                        0.969322144985199,
                        0.9698677062988281,
                        0.9706352949142456,
                        0.9595655798912048,
                        0.9702990651130676,
                        0.9708255529403687,
                        0.9684276580810547,
                        0.9683579206466675,
                        0.9331950545310974,
                        0.9719547629356384,
                        0.9481914639472961,
                        0.887273371219635,
                        0.9394499063491821,
                        0.9422728419303894,
                        0.9417906999588013,
                        0.9575039148330688,
                        0.9651480317115784,
                        0.9646849036216736,
                        0.9855682253837585,
                        0.8800479769706726,
                        0.996073305606842,
                        0.8894175291061401,
                        0.8831246495246887,
                        0.8803905248641968,
                        0.8884342908859253,
                        0.8867849111557007,
                        0.8944290280342102,
                        0.8899503946304321,
                        0.89561527967453,
                        0.866396427154541,
                        0.8867658972740173,
                        0.9704766869544983,
                        0.8812088370323181,
                        0.8873241543769836,
                        0.8895698189735413,
                        0.9712125658988953,
                        0.9621347784996033,
                        0.9707938432693481,
                        0.9977924227714539,
                        0.9621537923812866
                    ]
                },
                "val": {
                    "pretrain_loss": 0.6523188948631287,
                    "features_accuracy": [
                        0.7372984290122986,
                        0.8551363945007324,
                        0.6844133138656616,
                        0.6930331587791443,
                        0.4158807396888733,
                        0.5967954397201538,
                        0.29089340567588806,
                        0.7438393235206604,
                        0.47211235761642456,
                        0.747591495513916,
                        0.9926984906196594,
                        0.6937429904937744,
                        0.6962782740592957,
                        0.6646891832351685,
                        0.6077983975410461,
                        0.5308791995048523,
                        0.578288197517395,
                        0.6729540228843689,
                        0.6281816959381104,
                        0.5218030214309692,
                        0.6297028660774231,
                        0.7291856408119202,
                        0.42105263471603394,
                        0.4094412326812744,
                        0.7227461338043213,
                        0.7187911868095398,
                        0.7056079506874084,
                        0.742622435092926,
                        0.560693621635437,
                        0.9827603697776794,
                        0.8888550400733948,
                        0.9924956560134888,
                        0.8607646226882935,
                        0.8691309094429016,
                        0.8529560565948486,
                        0.8566575050354004,
                        0.8560997843742371,
                        0.8479362726211548,
                        0.884494423866272,
                        0.8560997843742371,
                        0.8786634206771851,
                        0.8530067801475525,
                        0.7170672416687012,
                        0.8464151620864868,
                        0.8609673976898193,
                        0.861068844795227,
                        0.7358787059783936,
                        0.7018557786941528,
                        0.7084473967552185,
                        0.9961971044540405,
                        0.7212250232696533
                    ]
                },
                "test": {
                    "pretrain_loss": 0.43393832445144653,
                    "features_accuracy": [
                        0.7417342662811279,
                        0.6470081210136414,
                        0.7876774668693542,
                        0.8047160506248474,
                        0.7966024279594421,
                        0.78717041015625,
                        0.7738843560218811,
                        0.7788032293319702,
                        0.8173935413360596,
                        0.7914299964904785,
                        0.9936105608940125,
                        0.7416836023330688,
                        0.7481237649917603,
                        0.7773833870887756,
                        0.7990872263908386,
                        0.8065922856330872,
                        0.7885902523994446,
                        0.7802738547325134,
                        0.736156165599823,
                        0.7995436191558838,
                        0.7932048439979553,
                        0.804411768913269,
                        0.8714503049850464,
                        0.6564401388168335,
                        0.7878296375274658,
                        0.8430527448654175,
                        0.7330628633499146,
                        0.7332656979560852,
                        0.7373225092887878,
                        0.9830121994018555,
                        0.9011663198471069,
                        0.9934584498405457,
                        0.8537018299102783,
                        0.8702839612960815,
                        0.8620182871818542,
                        0.8573022484779358,
                        0.8725152015686035,
                        0.877738356590271,
                        0.8854462504386902,
                        0.6656693816184998,
                        0.8916328549385071,
                        0.8780933022499084,
                        0.7656693458557129,
                        0.875608503818512,
                        0.8806288242340088,
                        0.8522312641143799,
                        0.7895537614822388,
                        0.801673412322998,
                        0.7849898338317871,
                        0.9968052506446838,
                        0.7145537734031677
                    ]
                }
            },
            "30000": {
                "train": {
                    "pretrain_loss": 0.14974205195903778,
                    "features_accuracy": [
                        0.9698042273521423,
                        0.8166241645812988,
                        0.9721006751060486,
                        0.9730585217475891,
                        0.9442393779754639,
                        0.9724368453025818,
                        0.9723988175392151,
                        0.9732615351676941,
                        0.9308542609214783,
                        0.9716185331344604,
                        0.9960035085678101,
                        0.9701785445213318,
                        0.9724686145782471,
                        0.9726842641830444,
                        0.9646975994110107,
                        0.9727984666824341,
                        0.972316324710846,
                        0.972316324710846,
                        0.9695441722869873,
                        0.9387394189834595,
                        0.9724749326705933,
                        0.9509255290031433,
                        0.887006938457489,
                        0.9414037466049194,
                        0.9448419809341431,
                        0.9418668150901794,
                        0.9569710493087769,
                        0.9653573632240295,
                        0.967450737953186,
                        0.9856189489364624,
                        0.8806506395339966,
                        0.9960542917251587,
                        0.8897347450256348,
                        0.8847295641899109,
                        0.8805935382843018,
                        0.8883898854255676,
                        0.8869816064834595,
                        0.8948032855987549,
                        0.8919867277145386,
                        0.8961101174354553,
                        0.8664091229438782,
                        0.8867785930633545,
                        0.9720435738563538,
                        0.8842918872833252,
                        0.8891828060150146,
                        0.8914601802825928,
                        0.9732679128646851,
                        0.9646404981613159,
                        0.9727476835250854,
                        0.9975957870483398,
                        0.9629023671150208
                    ]
                },
                "val": {
                    "pretrain_loss": 0.7035951018333435,
                    "features_accuracy": [
                        0.6154041290283203,
                        0.8628941774368286,
                        0.6126660704612732,
                        0.5615049004554749,
                        0.41329479217529297,
                        0.6495791077613831,
                        0.25352397561073303,
                        0.7366392612457275,
                        0.47373491525650024,
                        0.674272358417511,
                        0.9925463795661926,
                        0.6270154714584351,
                        0.3765338063240051,
                        0.6216914653778076,
                        0.6345705389976501,
                        0.643950879573822,
                        0.5090254545211792,
                        0.5790994763374329,
                        0.6395902633666992,
                        0.5660176277160645,
                        0.593803882598877,
                        0.7276645302772522,
                        0.46734610199928284,
                        0.6370043158531189,
                        0.7267518043518066,
                        0.6853767037391663,
                        0.7298448085784912,
                        0.742723822593689,
                        0.47652366757392883,
                        0.9821012020111084,
                        0.8826690912246704,
                        0.9923942685127258,
                        0.8586350083351135,
                        0.8556433916091919,
                        0.8446404933929443,
                        0.8605617880821228,
                        0.8536152243614197,
                        0.8552885055541992,
                        0.8818578124046326,
                        0.8611195087432861,
                        0.8800324201583862,
                        0.8524489998817444,
                        0.7035290598869324,
                        0.844843327999115,
                        0.8601054549217224,
                        0.859649121761322,
                        0.7052022814750671,
                        0.7021092772483826,
                        0.6986613869667053,
                        0.9961463809013367,
                        0.7216306328773499
                    ]
                },
                "test": {
                    "pretrain_loss": 0.42998138070106506,
                    "features_accuracy": [
                        0.7463995814323425,
                        0.6473630666732788,
                        0.7790567874908447,
                        0.8048681616783142,
                        0.7855983972549438,
                        0.7886409759521484,
                        0.7851927280426025,
                        0.772718071937561,
                        0.8018255829811096,
                        0.8088235259056091,
                        0.9934077262878418,
                        0.7495436072349548,
                        0.7785496711730957,
                        0.7901622653007507,
                        0.7982251644134521,
                        0.8055781126022339,
                        0.7847363352775574,
                        0.7957403659820557,
                        0.7378803491592407,
                        0.7915314435958862,
                        0.7797160148620605,
                        0.7982251644134521,
                        0.869979739189148,
                        0.6944218873977661,
                        0.7908722162246704,
                        0.8424442410469055,
                        0.7351927161216736,
                        0.7333671450614929,
                        0.7456896305084229,
                        0.9829107522964478,
                        0.8921399712562561,
                        0.9933062791824341,
                        0.8449797034263611,
                        0.8531440496444702,
                        0.8498985767364502,
                        0.8569472432136536,
                        0.8715517520904541,
                        0.8745436072349548,
                        0.8641480803489685,
                        0.7759634852409363,
                        0.8915314674377441,
                        0.8712981939315796,
                        0.7736815214157104,
                        0.8565415740013123,
                        0.8567444086074829,
                        0.852180540561676,
                        0.7872717976570129,
                        0.785040557384491,
                        0.8005577921867371,
                        0.9968052506446838,
                        0.7141481041908264
                    ]
                }
            },
            "40000": {
                "train": {
                    "pretrain_loss": 0.146606907248497,
                    "features_accuracy": [
                        0.9707748293876648,
                        0.8402669429779053,
                        0.9728428721427917,
                        0.9741369485855103,
                        0.9493967294692993,
                        0.9740291237831116,
                        0.9740037322044373,
                        0.9730014801025391,
                        0.9380606412887573,
                        0.9736611843109131,
                        0.9962890148162842,
                        0.9718469381332397,
                        0.9733440279960632,
                        0.9734264612197876,
                        0.966327965259552,
                        0.9737499952316284,
                        0.9730648994445801,
                        0.9715678095817566,
                        0.9705718159675598,
                        0.9437509179115295,
                        0.9738134145736694,
                        0.950570285320282,
                        0.8880029320716858,
                        0.9424060583114624,
                        0.9446136355400085,
                        0.9431609511375427,
                        0.9576117396354675,
                        0.9661693572998047,
                        0.9692206382751465,
                        0.9857268333435059,
                        0.8808726668357849,
                        0.9962826371192932,
                        0.8899948000907898,
                        0.8861379027366638,
                        0.8817226886749268,
                        0.8899186849594116,
                        0.887412965297699,
                        0.8945051431655884,
                        0.8928114175796509,
                        0.8959134221076965,
                        0.8675002455711365,
                        0.8879648447036743,
                        0.9724749326705933,
                        0.8829470276832581,
                        0.8898171782493591,
                        0.890204131603241,
                        0.9735469818115234,
                        0.9666895270347595,
                        0.9740291237831116,
                        0.9979700446128845,
                        0.9619571566581726
                    ]
                },
                "val": {
                    "pretrain_loss": 0.7538995742797852,
                    "features_accuracy": [
                        0.5607443451881409,
                        0.8632491230964661,
                        0.5252002477645874,
                        0.5859445929527283,
                        0.41562721133232117,
                        0.5249467492103577,
                        0.4486360251903534,
                        0.6936923265457153,
                        0.47662508487701416,
                        0.6610383987426758,
                        0.9925970435142517,
                        0.3819592297077179,
                        0.3327755630016327,
                        0.5627725124359131,
                        0.6686948537826538,
                        0.7131122350692749,
                        0.5866037607192993,
                        0.6164689064025879,
                        0.5453300476074219,
                        0.49847882986068726,
                        0.49700841307640076,
                        0.7197545766830444,
                        0.4842815101146698,
                        0.5602372884750366,
                        0.7251799702644348,
                        0.6685934066772461,
                        0.7381604313850403,
                        0.7426731586456299,
                        0.37693944573402405,
                        0.9818983674049377,
                        0.8850014805793762,
                        0.9923942685127258,
                        0.8580772280693054,
                        0.8546800017356873,
                        0.8467193841934204,
                        0.8581786751747131,
                        0.8538687229156494,
                        0.8140147924423218,
                        0.8807423114776611,
                        0.8221275210380554,
                        0.8835310339927673,
                        0.8529053330421448,
                        0.7226447463035583,
                        0.8468714952468872,
                        0.8606631755828857,
                        0.8601054549217224,
                        0.7034276127815247,
                        0.6753371953964233,
                        0.6810160875320435,
                        0.9961463809013367,
                        0.7218334674835205
                    ]
                },
                "test": {
                    "pretrain_loss": 0.42692041397094727,
                    "features_accuracy": [
                        0.7621703743934631,
                        0.6454361081123352,
                        0.7940162420272827,
                        0.8008113503456116,
                        0.7891988158226013,
                        0.7953854203224182,
                        0.7852941155433655,
                        0.7929006218910217,
                        0.8128296136856079,
                        0.8081642985343933,
                        0.9934077262878418,
                        0.7595841884613037,
                        0.7877281904220581,
                        0.7964503169059753,
                        0.7967545390129089,
                        0.8073529601097107,
                        0.7840771079063416,
                        0.7949796915054321,
                        0.7429513335227966,
                        0.7857505083084106,
                        0.790567934513092,
                        0.7980223298072815,
                        0.8726673722267151,
                        0.7018762826919556,
                        0.7845841646194458,
                        0.8409736156463623,
                        0.7395537495613098,
                        0.7332656979560852,
                        0.792190670967102,
                        0.9828093647956848,
                        0.8829107284545898,
                        0.9934077262878418,
                        0.8474137783050537,
                        0.852180540561676,
                        0.8504564166069031,
                        0.8564908504486084,
                        0.8608012199401855,
                        0.8796145915985107,
                        0.8692190647125244,
                        0.711105465888977,
                        0.8934584259986877,
                        0.8609533309936523,
                        0.7739858031272888,
                        0.8698275685310364,
                        0.8645537495613098,
                        0.8516227006912231,
                        0.7923427820205688,
                        0.7900101542472839,
                        0.8012170195579529,
                        0.9970081448554993,
                        0.7141481041908264
                    ]
                }
            }
        },
        "train": {
            "score": -3.556264629651342
        },
        "val": {
            "score": -5.219502982013902
        },
        "test": {
            "score": -5.542846757794439
        }
    },
    "best_iteration": 10000,
    "time": "0:04:27"
}
