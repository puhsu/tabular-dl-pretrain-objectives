{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_fast___88f334f0dee44fc782727ac73dc94e4f.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0,1",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                },
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 11,
        "data": {
            "path": "data/fb-comments",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512
                ],
                "dropout": 0.3165243883109578
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "positional",
                "linear",
                "relu"
            ],
            "d_num_embedding": 11,
            "positional_encoding": {
                "n": 35,
                "sigma": 0.3078928096197865,
                "trainable": true,
                "initialization": "normal"
            },
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 512,
            "lr": 0.00015569191898648328,
            "weight_decay": 0.0007948790593667655,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 1024
        },
        "pretrain": {
            "corrupt_probability": 0.7425803516231099,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.00015569191898648328,
            "weight_decay": 0.0007948790593667655,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "target_shuffle",
            "n_neighbors": 20,
            "use_target": true,
            "early_stop_type": "pretrain",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "n_parameters": 653715,
    "epoch_size": 308,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "pretrain_loss": 0.1634950190782547,
                    "features_accuracy": [
                        0.9668037295341492,
                        0.7741661667823792,
                        0.9637079834938049,
                        0.9678694605827332,
                        0.9231340289115906,
                        0.9668100476264954,
                        0.9644946455955505,
                        0.9678377509117126,
                        0.9038746953010559,
                        0.9669369459152222,
                        0.9961938261985779,
                        0.9655159711837769,
                        0.966791033744812,
                        0.9676030278205872,
                        0.9526764154434204,
                        0.9657316207885742,
                        0.9662264585494995,
                        0.9639046788215637,
                        0.9658775329589844,
                        0.9227533936500549,
                        0.9672287106513977,
                        0.9417209029197693,
                        0.8852244019508362,
                        0.9374008774757385,
                        0.9346541166305542,
                        0.9382128715515137,
                        0.9546873569488525,
                        0.9612783789634705,
                        0.9614496827125549,
                        0.9857839345932007,
                        0.8778975009918213,
                        0.9961494207382202,
                        0.8890305757522583,
                        0.8841078877449036,
                        0.8788427114486694,
                        0.88880854845047,
                        0.8865819573402405,
                        0.894549548625946,
                        0.8912762403488159,
                        0.8953678607940674,
                        0.8656732439994812,
                        0.8876540064811707,
                        0.9649577140808105,
                        0.8805047273635864,
                        0.8880853652954102,
                        0.8895190358161926,
                        0.9675713181495667,
                        0.9552646279335022,
                        0.9663596749305725,
                        0.99733567237854,
                        0.9627881646156311
                    ]
                },
                "val": {
                    "pretrain_loss": 0.5830514430999756,
                    "features_accuracy": [
                        0.7388195991516113,
                        0.8636040687561035,
                        0.6276746392250061,
                        0.7344589829444885,
                        0.36046040058135986,
                        0.659365177154541,
                        0.7355237603187561,
                        0.7198559641838074,
                        0.47708141803741455,
                        0.7380083203315735,
                        0.9924449324607849,
                        0.7345096468925476,
                        0.7197545766830444,
                        0.7483013868331909,
                        0.6275225281715393,
                        0.6611905097961426,
                        0.7256363034248352,
                        0.7393265962600708,
                        0.7375519275665283,
                        0.3611702620983124,
                        0.5288003087043762,
                        0.7428759336471558,
                        0.4327654242515564,
                        0.3239022195339203,
                        0.7123516798019409,
                        0.7081431746482849,
                        0.7331913113594055,
                        0.7373998165130615,
                        0.47779127955436707,
                        0.9842814803123474,
                        0.880945086479187,
                        0.9930534362792969,
                        0.856961727142334,
                        0.8565053939819336,
                        0.8571138381958008,
                        0.8557955622673035,
                        0.8508264422416687,
                        0.8523983359336853,
                        0.8629956245422363,
                        0.8614237904548645,
                        0.8775479197502136,
                        0.8522968888282776,
                        0.7368420958518982,
                        0.8479362726211548,
                        0.8581279516220093,
                        0.858989953994751,
                        0.7393265962600708,
                        0.4908224046230316,
                        0.734205424785614,
                        0.9962985515594482,
                        0.7227461338043213
                    ]
                },
                "test": {
                    "pretrain_loss": 0.4471997916698456,
                    "features_accuracy": [
                        0.7397058606147766,
                        0.639452338218689,
                        0.7463489174842834,
                        0.7600405812263489,
                        0.7757099270820618,
                        0.751115620136261,
                        0.7371196746826172,
                        0.7953346967697144,
                        0.8167849779129028,
                        0.7539553642272949,
                        0.9934077262878418,
                        0.7350912690162659,
                        0.7526369094848633,
                        0.7543610334396362,
                        0.7867140173912048,
                        0.7548174262046814,
                        0.7393001914024353,
                        0.7386409640312195,
                        0.7414300441741943,
                        0.8160750269889832,
                        0.8029918670654297,
                        0.7686612606048584,
                        0.8732251524925232,
                        0.6401115655899048,
                        0.7594320774078369,
                        0.8728702068328857,
                        0.7357504963874817,
                        0.7427991628646851,
                        0.7270790934562683,
                        0.982758641242981,
                        0.8993914723396301,
                        0.9934584498405457,
                        0.8488336801528931,
                        0.8515720367431641,
                        0.8454868197441101,
                        0.8595334887504578,
                        0.861663281917572,
                        0.8647058606147766,
                        0.8623732328414917,
                        0.8666836023330688,
                        0.8775355219841003,
                        0.8533975481987,
                        0.7387424111366272,
                        0.8476673364639282,
                        0.8557809591293335,
                        0.852281928062439,
                        0.7817444205284119,
                        0.7895030379295349,
                        0.7508620619773865,
                        0.9968559741973877,
                        0.7137423753738403
                    ]
                }
            },
            "20000": {
                "train": {
                    "pretrain_loss": 0.15469831228256226,
                    "features_accuracy": [
                        0.9678694605827332,
                        0.7929813861846924,
                        0.9699565172195435,
                        0.971117377281189,
                        0.9356563687324524,
                        0.9697788953781128,
                        0.9685608744621277,
                        0.9708065390586853,
                        0.9205331206321716,
                        0.9704068899154663,
                        0.9962255358695984,
                        0.9697725176811218,
                        0.9713901877403259,
                        0.9714536070823669,
                        0.9584428071975708,
                        0.9691001176834106,
                        0.970387876033783,
                        0.967920184135437,
                        0.968656063079834,
                        0.9336264133453369,
                        0.9696139693260193,
                        0.9445565342903137,
                        0.8846978545188904,
                        0.9391961693763733,
                        0.942164957523346,
                        0.9412641525268555,
                        0.9572438597679138,
                        0.9639617800712585,
                        0.9654715657234192,
                        0.9856824278831482,
                        0.8803017139434814,
                        0.9962192177772522,
                        0.889671266078949,
                        0.8844251036643982,
                        0.8828899264335632,
                        0.8881868720054626,
                        0.8870957493782043,
                        0.8941118717193604,
                        0.8918598294258118,
                        0.8960530161857605,
                        0.8671132922172546,
                        0.8871021270751953,
                        0.9703751802444458,
                        0.8822745680809021,
                        0.8889798521995544,
                        0.8899440765380859,
                        0.971117377281189,
                        0.9612339735031128,
                        0.970318078994751,
                        0.9978114366531372,
                        0.9622616767883301
                    ]
                },
                "val": {
                    "pretrain_loss": 0.6685904860496521,
                    "features_accuracy": [
                        0.7383125424385071,
                        0.8655815720558167,
                        0.41304126381874084,
                        0.6889260411262512,
                        0.3593955934047699,
                        0.2378561943769455,
                        0.7377040386199951,
                        0.728577196598053,
                        0.4371260404586792,
                        0.45639386773109436,
                        0.9924449324607849,
                        0.7182841300964355,
                        0.5186086297035217,
                        0.5972517728805542,
                        0.690447211265564,
                        0.41096237301826477,
                        0.5198255777359009,
                        0.38307473063468933,
                        0.7377040386199951,
                        0.5154142379760742,
                        0.3778521418571472,
                        0.725027859210968,
                        0.488033652305603,
                        0.366342157125473,
                        0.6605313420295715,
                        0.6844133138656616,
                        0.7108305096626282,
                        0.7375519275665283,
                        0.42860764265060425,
                        0.9841800928115845,
                        0.8770915269851685,
                        0.9926477670669556,
                        0.856860339641571,
                        0.8606631755828857,
                        0.8445390462875366,
                        0.8565561175346375,
                        0.8511813879013062,
                        0.8391136527061462,
                        0.8627420663833618,
                        0.8543757796287537,
                        0.8664942383766174,
                        0.8522462248802185,
                        0.7376026511192322,
                        0.8481898307800293,
                        0.8610181212425232,
                        0.8590406179428101,
                        0.6548017263412476,
                        0.5566372275352478,
                        0.7018557786941528,
                        0.9963492155075073,
                        0.7214785218238831
                    ]
                },
                "test": {
                    "pretrain_loss": 0.43424367904663086,
                    "features_accuracy": [
                        0.7407200932502747,
                        0.6401622891426086,
                        0.7882353067398071,
                        0.7909736633300781,
                        0.7950811386108398,
                        0.7744929194450378,
                        0.7394523620605469,
                        0.8070994019508362,
                        0.8171906471252441,
                        0.806034505367279,
                        0.9934584498405457,
                        0.7421399354934692,
                        0.7839756608009338,
                        0.7996450066566467,
                        0.7970588207244873,
                        0.7852433919906616,
                        0.7691683769226074,
                        0.7614097595214844,
                        0.7414300441741943,
                        0.8092799186706543,
                        0.8088235259056091,
                        0.789452314376831,
                        0.8617647290229797,
                        0.6414300203323364,
                        0.8006592392921448,
                        0.872261643409729,
                        0.7356997728347778,
                        0.7428498864173889,
                        0.7322515249252319,
                        0.9834178686141968,
                        0.8982758522033691,
                        0.9936612844467163,
                        0.8546146154403687,
                        0.8520790934562683,
                        0.8420385718345642,
                        0.8565415740013123,
                        0.8601927161216736,
                        0.874391496181488,
                        0.864908754825592,
                        0.8612576127052307,
                        0.8860040903091431,
                        0.8531947135925293,
                        0.7728701829910278,
                        0.8445233106613159,
                        0.8554766774177551,
                        0.8527383208274841,
                        0.812728226184845,
                        0.7818458676338196,
                        0.7840771079063416,
                        0.9969574213027954,
                        0.7135395407676697
                    ]
                }
            },
            "30000": {
                "train": {
                    "pretrain_loss": 0.14947259426116943,
                    "features_accuracy": [
                        0.9692143201828003,
                        0.8139281272888184,
                        0.9710856676101685,
                        0.9721767902374268,
                        0.9451274871826172,
                        0.9730522036552429,
                        0.9725510478019714,
                        0.9728808999061584,
                        0.9292556643486023,
                        0.9727032780647278,
                        0.9963714480400085,
                        0.9709651470184326,
                        0.9720308780670166,
                        0.9727159738540649,
                        0.9613988995552063,
                        0.9727730751037598,
                        0.9726588726043701,
                        0.9707748293876648,
                        0.9694680571556091,
                        0.9397861361503601,
                        0.9734899401664734,
                        0.9493333101272583,
                        0.8875969052314758,
                        0.9416003823280334,
                        0.9438714385032654,
                        0.941632091999054,
                        0.9574277997016907,
                        0.9654144644737244,
                        0.9677045345306396,
                        0.9861074090003967,
                        0.8809360861778259,
                        0.9963714480400085,
                        0.8895571231842041,
                        0.8865248560905457,
                        0.8823697566986084,
                        0.8893731236457825,
                        0.8885675072669983,
                        0.8947461843490601,
                        0.8936107158660889,
                        0.8959705233573914,
                        0.8681917190551758,
                        0.8871211409568787,
                        0.9723353981971741,
                        0.8832197785377502,
                        0.8903437256813049,
                        0.8910669088363647,
                        0.9736421704292297,
                        0.965788722038269,
                        0.9729570746421814,
                        0.9980398416519165,
                        0.9626549482345581
                    ]
                },
                "val": {
                    "pretrain_loss": 0.7293343544006348,
                    "features_accuracy": [
                        0.6703680753707886,
                        0.8658857941627502,
                        0.5736233592033386,
                        0.7278673648834229,
                        0.32542338967323303,
                        0.28957509994506836,
                        0.3305952548980713,
                        0.745411217212677,
                        0.3599533438682556,
                        0.528191864490509,
                        0.9924449324607849,
                        0.36760976910591125,
                        0.48306459188461304,
                        0.6877091526985168,
                        0.6852245926856995,
                        0.4138018488883972,
                        0.33358684182167053,
                        0.5435553789138794,
                        0.7379068732261658,
                        0.5601865649223328,
                        0.4186694920063019,
                        0.7524591684341431,
                        0.4953351318836212,
                        0.4412331283092499,
                        0.6845654249191284,
                        0.6645877361297607,
                        0.7390223741531372,
                        0.7379068732261658,
                        0.39453402161598206,
                        0.9822025895118713,
                        0.8797789216041565,
                        0.9925463795661926,
                        0.8573166728019714,
                        0.8552885055541992,
                        0.8447418808937073,
                        0.857570230960846,
                        0.8521955013275146,
                        0.8419024348258972,
                        0.862589955329895,
                        0.7788763642311096,
                        0.8672041296958923,
                        0.85123211145401,
                        0.6973430514335632,
                        0.8465165495872498,
                        0.860409677028656,
                        0.8600547313690186,
                        0.5246425271034241,
                        0.4163370728492737,
                        0.6038941144943237,
                        0.9960449934005737,
                        0.7232531905174255
                    ]
                },
                "test": {
                    "pretrain_loss": 0.42840075492858887,
                    "features_accuracy": [
                        0.7463489174842834,
                        0.6411257386207581,
                        0.7792089581489563,
                        0.7791582345962524,
                        0.7823022603988647,
                        0.7805274128913879,
                        0.78392493724823,
                        0.7954360842704773,
                        0.8131845593452454,
                        0.7993407845497131,
                        0.9935091137886047,
                        0.7556288242340088,
                        0.7878296375274658,
                        0.7776369452476501,
                        0.7901622653007507,
                        0.8032961487770081,
                        0.781693696975708,
                        0.778346836566925,
                        0.7423428297042847,
                        0.801622748374939,
                        0.8019269704818726,
                        0.8020284175872803,
                        0.8663793206214905,
                        0.6793610453605652,
                        0.7937119603157043,
                        0.852281928062439,
                        0.7367647290229797,
                        0.7428498864173889,
                        0.7538032531738281,
                        0.9823022484779358,
                        0.8969066739082336,
                        0.9935091137886047,
                        0.8557809591293335,
                        0.8515720367431641,
                        0.8423935174942017,
                        0.85943204164505,
                        0.8537525534629822,
                        0.8680020570755005,
                        0.8640973567962646,
                        0.8311865925788879,
                        0.8914300203323364,
                        0.8559330701828003,
                        0.7907201051712036,
                        0.8442697525024414,
                        0.8613590598106384,
                        0.8528904914855957,
                        0.8092291951179504,
                        0.7948275804519653,
                        0.7915314435958862,
                        0.9970081448554993,
                        0.7104969620704651
                    ]
                }
            },
            "40000": {
                "train": {
                    "pretrain_loss": 0.1462032049894333,
                    "features_accuracy": [
                        0.9709714651107788,
                        0.8352174162864685,
                        0.9722909927368164,
                        0.9742257595062256,
                        0.9498915672302246,
                        0.9734581708908081,
                        0.9736865758895874,
                        0.9739212989807129,
                        0.9374452829360962,
                        0.9742067456245422,
                        0.9960860013961792,
                        0.9712823033332825,
                        0.9729506969451904,
                        0.9741686582565308,
                        0.9647229909896851,
                        0.9742892384529114,
                        0.9728935956954956,
                        0.9729316830635071,
                        0.9701531529426575,
                        0.9438397288322449,
                        0.9737055897712708,
                        0.9513125419616699,
                        0.8873685598373413,
                        0.9427930116653442,
                        0.9454953670501709,
                        0.9431418776512146,
                        0.9577957391738892,
                        0.9666261076927185,
                        0.9684086441993713,
                        0.9858980774879456,
                        0.8816021680831909,
                        0.9962509274482727,
                        0.8889798521995544,
                        0.8867658972740173,
                        0.8844504952430725,
                        0.8905023336410522,
                        0.8889227509498596,
                        0.8950253129005432,
                        0.8950570225715637,
                        0.8965097665786743,
                        0.8683376312255859,
                        0.8881995677947998,
                        0.9729443788528442,
                        0.8832007646560669,
                        0.8929953575134277,
                        0.8912318348884583,
                        0.9740989208221436,
                        0.9649704098701477,
                        0.9726271629333496,
                        0.9976909160614014,
                        0.9620649814605713
                    ]
                },
                "val": {
                    "pretrain_loss": 0.7543835639953613,
                    "features_accuracy": [
                        0.37420138716697693,
                        0.8642125129699707,
                        0.33297839760780334,
                        0.6660074591636658,
                        0.40487778186798096,
                        0.6252408027648926,
                        0.495791494846344,
                        0.7419125437736511,
                        0.434793621301651,
                        0.6210830211639404,
                        0.992343544960022,
                        0.466534823179245,
                        0.43342459201812744,
                        0.6281816959381104,
                        0.6664638519287109,
                        0.5793023109436035,
                        0.4656221270561218,
                        0.43788662552833557,
                        0.7305546998977661,
                        0.5633809566497803,
                        0.5101916790008545,
                        0.7524591684341431,
                        0.48828718066215515,
                        0.36122095584869385,
                        0.5016225576400757,
                        0.6010546684265137,
                        0.7422674894332886,
                        0.7380083203315735,
                        0.3857113718986511,
                        0.9825068116188049,
                        0.8790690302848816,
                        0.9924956560134888,
                        0.856961727142334,
                        0.8659365177154541,
                        0.8456545472145081,
                        0.8567082285881042,
                        0.8528546690940857,
                        0.7658452391624451,
                        0.8671026825904846,
                        0.696734607219696,
                        0.8677111864089966,
                        0.8526011109352112,
                        0.7168644070625305,
                        0.8475813865661621,
                        0.8590406179428101,
                        0.8593955636024475,
                        0.6667173504829407,
                        0.6284352540969849,
                        0.6933881044387817,
                        0.9958928823471069,
                        0.7231010794639587
                    ]
                },
                "test": {
                    "pretrain_loss": 0.4299492835998535,
                    "features_accuracy": [
                        0.7618661522865295,
                        0.6408215165138245,
                        0.7922413945198059,
                        0.7980730533599854,
                        0.7872717976570129,
                        0.7859533429145813,
                        0.7868154048919678,
                        0.7909229397773743,
                        0.80715012550354,
                        0.8033468723297119,
                        0.9936612844467163,
                        0.7499492764472961,
                        0.7928498983383179,
                        0.7950811386108398,
                        0.7910243272781372,
                        0.7958924770355225,
                        0.7864604592323303,
                        0.7798681855201721,
                        0.7539553642272949,
                        0.7984787225723267,
                        0.8002535700798035,
                        0.7818965315818787,
                        0.8828093409538269,
                        0.6982251405715942,
                        0.7932555675506592,
                        0.8647058606147766,
                        0.7376775145530701,
                        0.7428498864173889,
                        0.7566429972648621,
                        0.9826571941375732,
                        0.8968052864074707,
                        0.9936612844467163,
                        0.7480223178863525,
                        0.8514705896377563,
                        0.8425456285476685,
                        0.8573022484779358,
                        0.8562373518943787,
                        0.8784989714622498,
                        0.8634381294250488,
                        0.7751014232635498,
                        0.8906186819076538,
                        0.8563894629478455,
                        0.7911764979362488,
                        0.8478701710700989,
                        0.8552231192588806,
                        0.8538539409637451,
                        0.7915821671485901,
                        0.7692190408706665,
                        0.7906186580657959,
                        0.9971095323562622,
                        0.7110547423362732
                    ]
                }
            }
        },
        "train": {
            "score": -3.8722418231102753
        },
        "val": {
            "score": -5.310536369201886
        },
        "test": {
            "score": -5.531016764267685
        }
    },
    "best_iteration": 10000,
    "time": "0:04:05"
}
