{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_fast___88f334f0dee44fc782727ac73dc94e4f.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0,1",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                },
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 10,
        "data": {
            "path": "data/fb-comments",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512
                ],
                "dropout": 0.3165243883109578
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "positional",
                "linear",
                "relu"
            ],
            "d_num_embedding": 11,
            "positional_encoding": {
                "n": 35,
                "sigma": 0.3078928096197865,
                "trainable": true,
                "initialization": "normal"
            },
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 512,
            "lr": 0.00015569191898648328,
            "weight_decay": 0.0007948790593667655,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 1024
        },
        "pretrain": {
            "corrupt_probability": 0.7425803516231099,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.00015569191898648328,
            "weight_decay": 0.0007948790593667655,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "target_shuffle",
            "n_neighbors": 20,
            "use_target": true,
            "early_stop_type": "pretrain",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "n_parameters": 653715,
    "epoch_size": 308,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "pretrain_loss": 0.16388095915317535,
                    "features_accuracy": [
                        0.9651733636856079,
                        0.7752636075019836,
                        0.9644628763198853,
                        0.9683452248573303,
                        0.9252591729164124,
                        0.9658902287483215,
                        0.9664928913116455,
                        0.9678250551223755,
                        0.9054986834526062,
                        0.9667466282844543,
                        0.9964222311973572,
                        0.9650909304618835,
                        0.9653192758560181,
                        0.9665309190750122,
                        0.9523655772209167,
                        0.9662835597991943,
                        0.9668798446655273,
                        0.9649577140808105,
                        0.9649957418441772,
                        0.9218589663505554,
                        0.9676157236099243,
                        0.9420254230499268,
                        0.8858270645141602,
                        0.9361829161643982,
                        0.9354534149169922,
                        0.9382445812225342,
                        0.9523084759712219,
                        0.9600794315338135,
                        0.9597051739692688,
                        0.98560631275177,
                        0.878341555595398,
                        0.996403157711029,
                        0.8886499404907227,
                        0.8839049339294434,
                        0.8798640370368958,
                        0.8875080943107605,
                        0.8862584233283997,
                        0.8938073515892029,
                        0.8918471336364746,
                        0.8959642052650452,
                        0.8663774132728577,
                        0.8869942426681519,
                        0.9649767279624939,
                        0.8805935382843018,
                        0.8873748779296875,
                        0.8904325366020203,
                        0.9666705131530762,
                        0.9561780691146851,
                        0.9669369459152222,
                        0.9975957870483398,
                        0.9625598192214966
                    ]
                },
                "val": {
                    "pretrain_loss": 0.587616503238678,
                    "features_accuracy": [
                        0.7419125437736511,
                        0.8643646240234375,
                        0.7354223728179932,
                        0.6745765805244446,
                        0.363198459148407,
                        0.7125545144081116,
                        0.732684314250946,
                        0.6552073359489441,
                        0.4782983362674713,
                        0.7228982448577881,
                        0.9926477670669556,
                        0.7323800921440125,
                        0.7386167645454407,
                        0.7332420349121094,
                        0.46547001600265503,
                        0.735625147819519,
                        0.7259405255317688,
                        0.6886725425720215,
                        0.7153939604759216,
                        0.3438292145729065,
                        0.7236588597297668,
                        0.7209208011627197,
                        0.4749518036842346,
                        0.33399248123168945,
                        0.7218841910362244,
                        0.5854882597923279,
                        0.7308589220046997,
                        0.7432816028594971,
                        0.5929418802261353,
                        0.9843322038650513,
                        0.8820606470108032,
                        0.9927492141723633,
                        0.8572152853012085,
                        0.8572152853012085,
                        0.8436771035194397,
                        0.8613223433494568,
                        0.851891279220581,
                        0.8520941138267517,
                        0.8595983982086182,
                        0.8601054549217224,
                        0.8668491840362549,
                        0.852651834487915,
                        0.6719399690628052,
                        0.8450968265533447,
                        0.860511064529419,
                        0.858989953994751,
                        0.7408984899520874,
                        0.5118141770362854,
                        0.74054354429245,
                        0.9960957169532776,
                        0.7181320190429688
                    ]
                },
                "test": {
                    "pretrain_loss": 0.44609275460243225,
                    "features_accuracy": [
                        0.7415314316749573,
                        0.6383874416351318,
                        0.7608519196510315,
                        0.7852941155433655,
                        0.7919878363609314,
                        0.7631338834762573,
                        0.7477180361747742,
                        0.7965517044067383,
                        0.8144016265869141,
                        0.7863590121269226,
                        0.9933062791824341,
                        0.7397058606147766,
                        0.7362068891525269,
                        0.7359533309936523,
                        0.8024848103523254,
                        0.7356997728347778,
                        0.7563894391059875,
                        0.7497971653938293,
                        0.744979739189148,
                        0.8018255829811096,
                        0.7874239683151245,
                        0.7870689630508423,
                        0.8679513335227966,
                        0.6475659012794495,
                        0.7580628991127014,
                        0.8444726467132568,
                        0.7284989953041077,
                        0.7432048916816711,
                        0.727687656879425,
                        0.9829107522964478,
                        0.8952839970588684,
                        0.9934077262878418,
                        0.8526369333267212,
                        0.8507606387138367,
                        0.8419371247291565,
                        0.857758641242981,
                        0.8534989953041077,
                        0.8641988039016724,
                        0.8621196746826172,
                        0.8570994138717651,
                        0.8887931108474731,
                        0.8531440496444702,
                        0.7497971653938293,
                        0.844421923160553,
                        0.8632352948188782,
                        0.8529411554336548,
                        0.7620689868927002,
                        0.8076065182685852,
                        0.7378296256065369,
                        0.9968052506446838,
                        0.7166328430175781
                    ]
                }
            },
            "20000": {
                "train": {
                    "pretrain_loss": 0.15323485434055328,
                    "features_accuracy": [
                        0.9689669013023376,
                        0.794294536113739,
                        0.968059778213501,
                        0.9702102541923523,
                        0.9383460879325867,
                        0.9713584780693054,
                        0.9706923365592957,
                        0.9714155197143555,
                        0.923438549041748,
                        0.9705401062965393,
                        0.996276319026947,
                        0.9698867201805115,
                        0.9715931415557861,
                        0.9718151688575745,
                        0.958981990814209,
                        0.9701594710350037,
                        0.9723353981971741,
                        0.970451295375824,
                        0.968256413936615,
                        0.9339372515678406,
                        0.969721794128418,
                        0.9473350644111633,
                        0.8871084451675415,
                        0.9407186508178711,
                        0.9427295923233032,
                        0.9416764974594116,
                        0.9586077332496643,
                        0.9655349850654602,
                        0.9659536480903625,
                        0.9858917593955994,
                        0.8814182281494141,
                        0.9963270425796509,
                        0.8888275623321533,
                        0.8848374485969543,
                        0.8807457685470581,
                        0.8877555131912231,
                        0.8871148228645325,
                        0.8943909406661987,
                        0.8920945525169373,
                        0.8959324955940247,
                        0.8677158951759338,
                        0.887679398059845,
                        0.9706923365592957,
                        0.881951093673706,
                        0.8896903395652771,
                        0.8904769420623779,
                        0.9727223515510559,
                        0.9624646306037903,
                        0.97071772813797,
                        0.9978241324424744,
                        0.9627818465232849
                    ]
                },
                "val": {
                    "pretrain_loss": 0.6753884553909302,
                    "features_accuracy": [
                        0.396359384059906,
                        0.8616772890090942,
                        0.3793732821941376,
                        0.6148463487625122,
                        0.39179596304893494,
                        0.6909035444259644,
                        0.6595172882080078,
                        0.4725179970264435,
                        0.47302502393722534,
                        0.3053949773311615,
                        0.9927998781204224,
                        0.7528141140937805,
                        0.6202210783958435,
                        0.6676300168037415,
                        0.474647581577301,
                        0.41653990745544434,
                        0.6539397239685059,
                        0.347023606300354,
                        0.4971098005771637,
                        0.5635837912559509,
                        0.6826386451721191,
                        0.7434337139129639,
                        0.4638981819152832,
                        0.3398742377758026,
                        0.7323293685913086,
                        0.6849203705787659,
                        0.7310617566108704,
                        0.7434844374656677,
                        0.3996044993400574,
                        0.9832673668861389,
                        0.8798803091049194,
                        0.9925970435142517,
                        0.8558969497680664,
                        0.8614237904548645,
                        0.8441334366798401,
                        0.8557955622673035,
                        0.8526011109352112,
                        0.7683804631233215,
                        0.868218183517456,
                        0.8357164263725281,
                        0.8657336831092834,
                        0.8525504469871521,
                        0.7241658568382263,
                        0.845603883266449,
                        0.8569110631942749,
                        0.8593955636024475,
                        0.7288307547569275,
                        0.6798499226570129,
                        0.6908528208732605,
                        0.9960449934005737,
                        0.7181320190429688
                    ]
                },
                "test": {
                    "pretrain_loss": 0.4322422444820404,
                    "features_accuracy": [
                        0.7629817724227905,
                        0.6402636766433716,
                        0.7979716062545776,
                        0.8018762469291687,
                        0.7987322807312012,
                        0.7914299964904785,
                        0.7760142087936401,
                        0.8063387274742126,
                        0.8044624924659729,
                        0.7997464537620544,
                        0.9933062791824341,
                        0.8031440377235413,
                        0.7887930870056152,
                        0.8017241358757019,
                        0.8134381175041199,
                        0.7525861859321594,
                        0.7799695730209351,
                        0.7962474822998047,
                        0.7496450543403625,
                        0.7955882549285889,
                        0.7922921180725098,
                        0.7861054539680481,
                        0.8765212893486023,
                        0.6865111589431763,
                        0.7920385599136353,
                        0.8520284295082092,
                        0.7333671450614929,
                        0.7432048916816711,
                        0.748275876045227,
                        0.9827079176902771,
                        0.8944219350814819,
                        0.9934584498405457,
                        0.8482758402824402,
                        0.8514198660850525,
                        0.8467038869857788,
                        0.8697261810302734,
                        0.8573529720306396,
                        0.8817444443702698,
                        0.8631339073181152,
                        0.8474137783050537,
                        0.8882352709770203,
                        0.8548174500465393,
                        0.754462480545044,
                        0.8485293984413147,
                        0.8568458557128906,
                        0.8562880158424377,
                        0.8011663556098938,
                        0.7819472551345825,
                        0.7567444443702698,
                        0.9969574213027954,
                        0.7169878482818604
                    ]
                }
            },
            "30000": {
                "train": {
                    "pretrain_loss": 0.14924569427967072,
                    "features_accuracy": [
                        0.970920741558075,
                        0.8183940649032593,
                        0.9713330864906311,
                        0.9731410145759583,
                        0.9446580410003662,
                        0.9729633927345276,
                        0.9728935956954956,
                        0.9728935956954956,
                        0.9322879314422607,
                        0.9723798036575317,
                        0.9962572455406189,
                        0.9709968566894531,
                        0.9724559187889099,
                        0.9732869267463684,
                        0.9621030688285828,
                        0.9730204939842224,
                        0.9727286696434021,
                        0.9714472889900208,
                        0.9696266055107117,
                        0.939373791217804,
                        0.9728555679321289,
                        0.9489272832870483,
                        0.8874382972717285,
                        0.9421015381813049,
                        0.9435796141624451,
                        0.9420127272605896,
                        0.9580938816070557,
                        0.9654207825660706,
                        0.9684023261070251,
                        0.9858409762382507,
                        0.8802953958511353,
                        0.9962509274482727,
                        0.8896522521972656,
                        0.8857889771461487,
                        0.8807203769683838,
                        0.8888593316078186,
                        0.8884469866752625,
                        0.8949936032295227,
                        0.8919930458068848,
                        0.8970679640769958,
                        0.8677666783332825,
                        0.8873494863510132,
                        0.9723988175392151,
                        0.8825346827507019,
                        0.8886943459510803,
                        0.8919994235038757,
                        0.9737182855606079,
                        0.964659571647644,
                        0.9727794528007507,
                        0.9978178143501282,
                        0.9630419015884399
                    ]
                },
                "val": {
                    "pretrain_loss": 0.7358543872833252,
                    "features_accuracy": [
                        0.4241963028907776,
                        0.8648210167884827,
                        0.5837643146514893,
                        0.6761991381645203,
                        0.33095020055770874,
                        0.512017011642456,
                        0.5226143002510071,
                        0.6703680753707886,
                        0.4008721113204956,
                        0.2592536211013794,
                        0.9927492141723633,
                        0.6693540215492249,
                        0.690497875213623,
                        0.5862995386123657,
                        0.486309677362442,
                        0.409745454788208,
                        0.4196836054325104,
                        0.512726902961731,
                        0.44199371337890625,
                        0.5682486295700073,
                        0.6234661340713501,
                        0.7572253942489624,
                        0.46643340587615967,
                        0.6510495543479919,
                        0.7307575345039368,
                        0.7304532527923584,
                        0.7270053625106812,
                        0.7435858249664307,
                        0.3667984902858734,
                        0.9821012020111084,
                        0.8962072730064392,
                        0.9925463795661926,
                        0.8569110631942749,
                        0.8556433916091919,
                        0.844234824180603,
                        0.8575195074081421,
                        0.8538180589675903,
                        0.7713213562965393,
                        0.862589955329895,
                        0.8415982127189636,
                        0.8626914024353027,
                        0.8521955013275146,
                        0.681269645690918,
                        0.8455531597137451,
                        0.8573673963546753,
                        0.8599533438682556,
                        0.7139235138893127,
                        0.6739174127578735,
                        0.6745259165763855,
                        0.9960957169532776,
                        0.7182334065437317
                    ]
                },
                "test": {
                    "pretrain_loss": 0.4309288561344147,
                    "features_accuracy": [
                        0.7729716300964355,
                        0.6472616791725159,
                        0.7800710201263428,
                        0.796146035194397,
                        0.7849898338317871,
                        0.8053245544433594,
                        0.7890466451644897,
                        0.8032961487770081,
                        0.8059330582618713,
                        0.797160267829895,
                        0.9933570027351379,
                        0.7915314435958862,
                        0.7762677669525146,
                        0.7971095442771912,
                        0.7924442291259766,
                        0.7697261571884155,
                        0.7845335006713867,
                        0.7934584021568298,
                        0.7610040307044983,
                        0.7813387513160706,
                        0.7929513454437256,
                        0.7999492883682251,
                        0.8804766535758972,
                        0.7054259777069092,
                        0.7963488698005676,
                        0.8651115894317627,
                        0.7518255710601807,
                        0.7432048916816711,
                        0.7795131802558899,
                        0.9824036359786987,
                        0.901673436164856,
                        0.9934077262878418,
                        0.8481237292289734,
                        0.8529918789863586,
                        0.8443711996078491,
                        0.8566937446594238,
                        0.8586714267730713,
                        0.8729715943336487,
                        0.8635902404785156,
                        0.8587220907211304,
                        0.8721602559089661,
                        0.8618661165237427,
                        0.7805274128913879,
                        0.8483772873878479,
                        0.8579614758491516,
                        0.8530933260917664,
                        0.7989857792854309,
                        0.7912271618843079,
                        0.7957403659820557,
                        0.9969066977500916,
                        0.7175456285476685
                    ]
                }
            },
            "40000": {
                "train": {
                    "pretrain_loss": 0.1462448686361313,
                    "features_accuracy": [
                        0.9716122150421143,
                        0.8390235900878906,
                        0.9725700616836548,
                        0.9736484885215759,
                        0.9504307508468628,
                        0.9735533595085144,
                        0.9727286696434021,
                        0.9743145704269409,
                        0.93964022397995,
                        0.9735977649688721,
                        0.9962572455406189,
                        0.9713965058326721,
                        0.9736104607582092,
                        0.973667562007904,
                        0.9657443165779114,
                        0.9744794964790344,
                        0.9736865758895874,
                        0.9725891351699829,
                        0.9710412621498108,
                        0.9445755481719971,
                        0.9740798473358154,
                        0.950107216835022,
                        0.8874192833900452,
                        0.943516194820404,
                        0.9442203044891357,
                        0.9427549242973328,
                        0.9573072791099548,
                        0.9660361409187317,
                        0.9693411588668823,
                        0.985739529132843,
                        0.8811517953872681,
                        0.9963334202766418,
                        0.8891193866729736,
                        0.885078489780426,
                        0.8835306167602539,
                        0.8887958526611328,
                        0.8886690139770508,
                        0.895412266254425,
                        0.8919613361358643,
                        0.8963638544082642,
                        0.8682805299758911,
                        0.8872162699699402,
                        0.9729887843132019,
                        0.8843806982040405,
                        0.8918281197547913,
                        0.892957329750061,
                        0.9746063947677612,
                        0.9669052362442017,
                        0.9736294746398926,
                        0.9979510307312012,
                        0.9627501368522644
                    ]
                },
                "val": {
                    "pretrain_loss": 0.7636811137199402,
                    "features_accuracy": [
                        0.5469526052474976,
                        0.8621843457221985,
                        0.540158212184906,
                        0.7143798470497131,
                        0.4193793535232544,
                        0.5473582744598389,
                        0.34626305103302,
                        0.5682486295700073,
                        0.4350471496582031,
                        0.25220564007759094,
                        0.9927998781204224,
                        0.7148361802101135,
                        0.5886826515197754,
                        0.6313254237174988,
                        0.3876381516456604,
                        0.4133962094783783,
                        0.46901935338974,
                        0.6450157165527344,
                        0.34489402174949646,
                        0.5729134678840637,
                        0.5478653311729431,
                        0.7410506010055542,
                        0.5260115265846252,
                        0.6921711564064026,
                        0.7322279214859009,
                        0.7309096455574036,
                        0.7260419726371765,
                        0.7436872124671936,
                        0.3613223731517792,
                        0.9832167029380798,
                        0.8801338076591492,
                        0.9926477670669556,
                        0.8567082285881042,
                        0.8546800017356873,
                        0.8457559943199158,
                        0.8591927289962769,
                        0.8537166118621826,
                        0.8556433916091919,
                        0.8607138991355896,
                        0.6596186757087708,
                        0.8601054549217224,
                        0.8523983359336853,
                        0.7093600630760193,
                        0.8464151620864868,
                        0.8578237295150757,
                        0.8591927289962769,
                        0.7224926352500916,
                        0.5763614177703857,
                        0.7004867196083069,
                        0.9959942698478699,
                        0.7184362411499023
                    ]
                },
                "test": {
                    "pretrain_loss": 0.43221715092658997,
                    "features_accuracy": [
                        0.7712474465370178,
                        0.644472599029541,
                        0.7840771079063416,
                        0.7813894748687744,
                        0.7961967587471008,
                        0.794929027557373,
                        0.7963488698005676,
                        0.7943711876869202,
                        0.7841277718544006,
                        0.7868661284446716,
                        0.9934077262878418,
                        0.7543610334396362,
                        0.7895537614822388,
                        0.7898073196411133,
                        0.807758629322052,
                        0.781693696975708,
                        0.780578076839447,
                        0.7847363352775574,
                        0.7641480565071106,
                        0.7917850017547607,
                        0.7942190766334534,
                        0.8062880635261536,
                        0.8636916875839233,
                        0.7091785073280334,
                        0.7790060639381409,
                        0.8584178686141968,
                        0.7524340748786926,
                        0.7432048916816711,
                        0.774949312210083,
                        0.9831135869026184,
                        0.9003042578697205,
                        0.9934077262878418,
                        0.826622724533081,
                        0.8537525534629822,
                        0.8458417654037476,
                        0.856135904788971,
                        0.8622211217880249,
                        0.8669878244400024,
                        0.8626267910003662,
                        0.5377281904220581,
                        0.8820993900299072,
                        0.8592292070388794,
                        0.7847363352775574,
                        0.8559330701828003,
                        0.8554259538650513,
                        0.853296160697937,
                        0.792799174785614,
                        0.7766227126121521,
                        0.7848377227783203,
                        0.9970081448554993,
                        0.7170385718345642
                    ]
                }
            }
        },
        "train": {
            "score": -3.6449012296825445
        },
        "val": {
            "score": -5.295987330877907
        },
        "test": {
            "score": -5.57590707564144
        }
    },
    "best_iteration": 10000,
    "time": "0:04:17"
}
