{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_fast___88f334f0dee44fc782727ac73dc94e4f.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0,1",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                },
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 7,
        "data": {
            "path": "data/fb-comments",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512
                ],
                "dropout": 0.3165243883109578
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "positional",
                "linear",
                "relu"
            ],
            "d_num_embedding": 11,
            "positional_encoding": {
                "n": 35,
                "sigma": 0.3078928096197865,
                "trainable": true,
                "initialization": "normal"
            },
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 512,
            "lr": 0.00015569191898648328,
            "weight_decay": 0.0007948790593667655,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 1024
        },
        "pretrain": {
            "corrupt_probability": 0.7425803516231099,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.00015569191898648328,
            "weight_decay": 0.0007948790593667655,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "target_shuffle",
            "n_neighbors": 20,
            "use_target": true,
            "early_stop_type": "pretrain",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "n_parameters": 653715,
    "epoch_size": 308,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "pretrain_loss": 0.1632743924856186,
                    "features_accuracy": [
                        0.966321587562561,
                        0.7756568789482117,
                        0.9633971452713013,
                        0.966454803943634,
                        0.9253987073898315,
                        0.9676220417022705,
                        0.9655793905258179,
                        0.9671525955200195,
                        0.9053400754928589,
                        0.9672794938087463,
                        0.9960352182388306,
                        0.9656174182891846,
                        0.9666895270347595,
                        0.9666134119033813,
                        0.9520230293273926,
                        0.9686306715011597,
                        0.9657760262489319,
                        0.9628579616546631,
                        0.9660868644714355,
                        0.9231594204902649,
                        0.9664230942726135,
                        0.9408645033836365,
                        0.8842411041259766,
                        0.9372930526733398,
                        0.9369885921478271,
                        0.9379972219467163,
                        0.954852283000946,
                        0.9614750742912292,
                        0.9608280062675476,
                        0.9855809211730957,
                        0.8784556984901428,
                        0.9959908127784729,
                        0.888941764831543,
                        0.8835940957069397,
                        0.8791217803955078,
                        0.8880663514137268,
                        0.8866897821426392,
                        0.8930651545524597,
                        0.8916187882423401,
                        0.8960466384887695,
                        0.8654829859733582,
                        0.8872480392456055,
                        0.9672794938087463,
                        0.8812025189399719,
                        0.8878633379936218,
                        0.8896839618682861,
                        0.967786967754364,
                        0.9551123380661011,
                        0.9661629796028137,
                        0.9973864555358887,
                        0.9623060822486877
                    ]
                },
                "val": {
                    "pretrain_loss": 0.5939236879348755,
                    "features_accuracy": [
                        0.7393265962600708,
                        0.8607138991355896,
                        0.7011966109275818,
                        0.7381604313850403,
                        0.3379981517791748,
                        0.6378663182258606,
                        0.541577935218811,
                        0.6855795383453369,
                        0.4747996926307678,
                        0.6443565487861633,
                        0.9923942685127258,
                        0.7307575345039368,
                        0.7373998165130615,
                        0.7029712796211243,
                        0.6029307246208191,
                        0.5363045930862427,
                        0.6627624034881592,
                        0.7325322031974792,
                        0.7338504791259766,
                        0.46090659499168396,
                        0.5097352862358093,
                        0.7213264107704163,
                        0.5059324502944946,
                        0.3699928820133209,
                        0.7234560251235962,
                        0.7276645302772522,
                        0.682030200958252,
                        0.7367913722991943,
                        0.6027786135673523,
                        0.9847885370254517,
                        0.8839874267578125,
                        0.9927492141723633,
                        0.8576716184616089,
                        0.8523476123809814,
                        0.8568096160888672,
                        0.8556941151618958,
                        0.8540715575218201,
                        0.8465672731399536,
                        0.8620829582214355,
                        0.8603589534759521,
                        0.8657336831092834,
                        0.8520941138267517,
                        0.5623669028282166,
                        0.8500658869743347,
                        0.8599026203155518,
                        0.8582800626754761,
                        0.7470337748527527,
                        0.5891897082328796,
                        0.7325322031974792,
                        0.9956900477409363,
                        0.7204137444496155
                    ]
                },
                "test": {
                    "pretrain_loss": 0.447767972946167,
                    "features_accuracy": [
                        0.7387424111366272,
                        0.638336718082428,
                        0.7456389665603638,
                        0.7491379380226135,
                        0.7908214926719666,
                        0.7669878602027893,
                        0.7632859945297241,
                        0.7708417773246765,
                        0.8147565722465515,
                        0.7507606744766235,
                        0.9934584498405457,
                        0.7323529720306396,
                        0.7386409640312195,
                        0.745030403137207,
                        0.789401650428772,
                        0.7630831599235535,
                        0.7542089223861694,
                        0.7430020570755005,
                        0.7377281785011292,
                        0.8136409521102905,
                        0.7720588445663452,
                        0.7631338834762573,
                        0.8796653151512146,
                        0.6499999761581421,
                        0.7974138259887695,
                        0.8570486903190613,
                        0.7359533309936523,
                        0.741632878780365,
                        0.7317951321601868,
                        0.9834178686141968,
                        0.9012677669525146,
                        0.9933570027351379,
                        0.851064920425415,
                        0.8524340987205505,
                        0.8435598611831665,
                        0.8566937446594238,
                        0.8610547780990601,
                        0.8789046406745911,
                        0.8625760674476624,
                        0.8590263724327087,
                        0.882758617401123,
                        0.8548681735992432,
                        0.7338235378265381,
                        0.8471602201461792,
                        0.8552231192588806,
                        0.853803277015686,
                        0.7736308574676514,
                        0.7773326635360718,
                        0.7391480803489685,
                        0.9968559741973877,
                        0.7133874297142029
                    ]
                }
            },
            "20000": {
                "train": {
                    "pretrain_loss": 0.15410150587558746,
                    "features_accuracy": [
                        0.968719482421875,
                        0.8006445169448853,
                        0.9690874218940735,
                        0.9698930382728577,
                        0.934508204460144,
                        0.9699501395225525,
                        0.9704068899154663,
                        0.9709588289260864,
                        0.9189155101776123,
                        0.9711744785308838,
                        0.9961050152778625,
                        0.9678440690040588,
                        0.9718722701072693,
                        0.9716819524765015,
                        0.9585316181182861,
                        0.9695060849189758,
                        0.970920741558075,
                        0.9690366983413696,
                        0.9687384963035583,
                        0.9324401617050171,
                        0.9696646928787231,
                        0.9477918148040771,
                        0.8864169716835022,
                        0.9401794075965881,
                        0.942164957523346,
                        0.9402619004249573,
                        0.9573706984519958,
                        0.9649957418441772,
                        0.9638031721115112,
                        0.9854096174240112,
                        0.8800035715103149,
                        0.9961113929748535,
                        0.8889607787132263,
                        0.8852941989898682,
                        0.8800162672996521,
                        0.888611912727356,
                        0.887412965297699,
                        0.8959959149360657,
                        0.8915299773216248,
                        0.8960910439491272,
                        0.8671450018882751,
                        0.8869181275367737,
                        0.970787525177002,
                        0.8801431059837341,
                        0.8889100551605225,
                        0.8906101584434509,
                        0.9717390537261963,
                        0.9607328176498413,
                        0.9709334373474121,
                        0.9978812336921692,
                        0.9622616767883301
                    ]
                },
                "val": {
                    "pretrain_loss": 0.6721250414848328,
                    "features_accuracy": [
                        0.735625147819519,
                        0.8615251779556274,
                        0.4349457323551178,
                        0.6773146390914917,
                        0.29890477657318115,
                        0.655156672000885,
                        0.6218436360359192,
                        0.7343068718910217,
                        0.4701855778694153,
                        0.6287901401519775,
                        0.9926477670669556,
                        0.7500760555267334,
                        0.37445491552352905,
                        0.6421762108802795,
                        0.5279890298843384,
                        0.6871007084846497,
                        0.5908122658729553,
                        0.5142480134963989,
                        0.7239123582839966,
                        0.5639894604682922,
                        0.31999796628952026,
                        0.7280194759368896,
                        0.4873237907886505,
                        0.4782983362674713,
                        0.7254841923713684,
                        0.73344486951828,
                        0.70743328332901,
                        0.7370449304580688,
                        0.544518768787384,
                        0.9844843149185181,
                        0.8796774744987488,
                        0.9927492141723633,
                        0.8584828972816467,
                        0.8536152243614197,
                        0.8603589534759521,
                        0.8583307862281799,
                        0.8518405556678772,
                        0.7832369804382324,
                        0.8724774122238159,
                        0.8613730669021606,
                        0.8637561798095703,
                        0.8516884446144104,
                        0.3035188913345337,
                        0.8542743921279907,
                        0.8658350706100464,
                        0.8592434525489807,
                        0.538231372833252,
                        0.5540512800216675,
                        0.600192666053772,
                        0.9962478280067444,
                        0.7131629586219788
                    ]
                },
                "test": {
                    "pretrain_loss": 0.43179193139076233,
                    "features_accuracy": [
                        0.7387424111366272,
                        0.6400101184844971,
                        0.7928498983383179,
                        0.8074036836624146,
                        0.801673412322998,
                        0.7863083481788635,
                        0.7778904438018799,
                        0.795030415058136,
                        0.8174949288368225,
                        0.7941176295280457,
                        0.9934077262878418,
                        0.7498478889465332,
                        0.7878296375274658,
                        0.7898580431938171,
                        0.8054766654968262,
                        0.7892494797706604,
                        0.7786511182785034,
                        0.7870689630508423,
                        0.7380324602127075,
                        0.8093306422233582,
                        0.7946754693984985,
                        0.8070994019508362,
                        0.8796653151512146,
                        0.6591277718544006,
                        0.807758629322052,
                        0.8375253677368164,
                        0.7381845712661743,
                        0.7416836023330688,
                        0.7402129769325256,
                        0.9837220907211304,
                        0.8948276042938232,
                        0.9936612844467163,
                        0.8039553761482239,
                        0.8514198660850525,
                        0.8485801219940186,
                        0.8568458557128906,
                        0.8549695611000061,
                        0.8663793206214905,
                        0.8683570027351379,
                        0.8635395765304565,
                        0.8903144001960754,
                        0.8579614758491516,
                        0.7629817724227905,
                        0.8646044731140137,
                        0.8547160029411316,
                        0.8532454371452332,
                        0.8048174381256104,
                        0.8079614639282227,
                        0.8061866164207458,
                        0.9969574213027954,
                        0.7133874297142029
                    ]
                }
            },
            "30000": {
                "train": {
                    "pretrain_loss": 0.1496124118566513,
                    "features_accuracy": [
                        0.9692650437355042,
                        0.815437912940979,
                        0.971117377281189,
                        0.9730712175369263,
                        0.9422474503517151,
                        0.9726081490516663,
                        0.9720181822776794,
                        0.9738641977310181,
                        0.9294903874397278,
                        0.9732235074043274,
                        0.9963270425796509,
                        0.9704385995864868,
                        0.9733249545097351,
                        0.9733947515487671,
                        0.9633781313896179,
                        0.9732298254966736,
                        0.9732235074043274,
                        0.9716629385948181,
                        0.9696900844573975,
                        0.937635600566864,
                        0.9723353981971741,
                        0.9512237310409546,
                        0.8876540064811707,
                        0.9427613019943237,
                        0.9438333511352539,
                        0.9415750503540039,
                        0.9583032131195068,
                        0.965991735458374,
                        0.9671081900596619,
                        0.9858219623565674,
                        0.8817163705825806,
                        0.9963143467903137,
                        0.8896903395652771,
                        0.8875334858894348,
                        0.8809360861778259,
                        0.8890876770019531,
                        0.8889671564102173,
                        0.8946066498756409,
                        0.8928494453430176,
                        0.8963828682899475,
                        0.8678427934646606,
                        0.887876033782959,
                        0.9722973108291626,
                        0.8832007646560669,
                        0.887679398059845,
                        0.8919930458068848,
                        0.9726398587226868,
                        0.9635557532310486,
                        0.9727286696434021,
                        0.9979573488235474,
                        0.9627437591552734
                    ]
                },
                "val": {
                    "pretrain_loss": 0.7271963357925415,
                    "features_accuracy": [
                        0.3570631742477417,
                        0.8623364567756653,
                        0.663573682308197,
                        0.7234053015708923,
                        0.2653889060020447,
                        0.5688570737838745,
                        0.4035087525844574,
                        0.6746780276298523,
                        0.4794645309448242,
                        0.6382719874382019,
                        0.9926477670669556,
                        0.6835006475448608,
                        0.2833890914916992,
                        0.6250380277633667,
                        0.6668187379837036,
                        0.629145085811615,
                        0.37359294295310974,
                        0.4572051465511322,
                        0.735625147819519,
                        0.5662711262702942,
                        0.5419328808784485,
                        0.7203630208969116,
                        0.5094310641288757,
                        0.7004360556602478,
                        0.7249264717102051,
                        0.7360815405845642,
                        0.7331406474113464,
                        0.7370449304580688,
                        0.3836831748485565,
                        0.9833180904388428,
                        0.8780549168586731,
                        0.9926984906196594,
                        0.8623364567756653,
                        0.8531588912010193,
                        0.847682774066925,
                        0.8591420650482178,
                        0.8514856100082397,
                        0.6204238533973694,
                        0.8613730669021606,
                        0.861068844795227,
                        0.8594970107078552,
                        0.8526011109352112,
                        0.30083155632019043,
                        0.8482912182807922,
                        0.8677618503570557,
                        0.8592434525489807,
                        0.68755704164505,
                        0.5909643769264221,
                        0.5304735898971558,
                        0.9961971044540405,
                        0.720160186290741
                    ]
                },
                "test": {
                    "pretrain_loss": 0.4281785190105438,
                    "features_accuracy": [
                        0.741632878780365,
                        0.6414300203323364,
                        0.7818965315818787,
                        0.8033468723297119,
                        0.8025861978530884,
                        0.7891480922698975,
                        0.7845335006713867,
                        0.7996957302093506,
                        0.8173428177833557,
                        0.7813387513160706,
                        0.9935091137886047,
                        0.7576065063476562,
                        0.7906186580657959,
                        0.7988336682319641,
                        0.7784482836723328,
                        0.8009127974510193,
                        0.7854969501495361,
                        0.7920385599136353,
                        0.7394523620605469,
                        0.8154665231704712,
                        0.7933570146560669,
                        0.806034505367279,
                        0.8660750389099121,
                        0.7080121636390686,
                        0.8070994019508362,
                        0.8299188613891602,
                        0.7386409640312195,
                        0.7416836023330688,
                        0.7722616791725159,
                        0.9835192561149597,
                        0.8807809352874756,
                        0.9935598373413086,
                        0.8147059082984924,
                        0.8527383208274841,
                        0.8460446000099182,
                        0.8614097237586975,
                        0.8539553880691528,
                        0.8874746561050415,
                        0.8633367419242859,
                        0.8564908504486084,
                        0.8916328549385071,
                        0.8697769045829773,
                        0.7863083481788635,
                        0.8450811505317688,
                        0.8546653389930725,
                        0.853904664516449,
                        0.7707910537719727,
                        0.8069472908973694,
                        0.7982251644134521,
                        0.9969574213027954,
                        0.7134888768196106
                    ]
                }
            },
            "40000": {
                "train": {
                    "pretrain_loss": 0.14684952795505524,
                    "features_accuracy": [
                        0.9706162214279175,
                        0.8298570513725281,
                        0.9720625877380371,
                        0.9742638468742371,
                        0.9499803781509399,
                        0.9744541645050049,
                        0.9740228056907654,
                        0.9731664061546326,
                        0.935244083404541,
                        0.9735406637191772,
                        0.9963651299476624,
                        0.9716693162918091,
                        0.9743716716766357,
                        0.9732552170753479,
                        0.965788722038269,
                        0.9732044339179993,
                        0.9734772443771362,
                        0.9715868234634399,
                        0.9717200398445129,
                        0.9430404305458069,
                        0.9734835624694824,
                        0.9513696432113647,
                        0.8869689106941223,
                        0.9434908032417297,
                        0.9457173943519592,
                        0.9428310394287109,
                        0.9586204290390015,
                        0.966385006904602,
                        0.9681295156478882,
                        0.9859171509742737,
                        0.8810693025588989,
                        0.99640953540802,
                        0.8895507454872131,
                        0.8860934972763062,
                        0.8827059864997864,
                        0.889937698841095,
                        0.8899250626564026,
                        0.895881712436676,
                        0.8939786553382874,
                        0.8974422812461853,
                        0.8686991930007935,
                        0.8878316283226013,
                        0.9731093049049377,
                        0.8833974003791809,
                        0.8910542130470276,
                        0.8921135663986206,
                        0.9738451838493347,
                        0.9665563106536865,
                        0.9735850691795349,
                        0.9979764223098755,
                        0.9619825482368469
                    ]
                },
                "val": {
                    "pretrain_loss": 0.7595763206481934,
                    "features_accuracy": [
                        0.5930432677268982,
                        0.8622857332229614,
                        0.6593144536018372,
                        0.744802713394165,
                        0.3369840681552887,
                        0.5287495851516724,
                        0.40680456161499023,
                        0.7056586146354675,
                        0.4987323582172394,
                        0.4442754089832306,
                        0.9926477670669556,
                        0.49457457661628723,
                        0.47079402208328247,
                        0.6905993223190308,
                        0.6469931602478027,
                        0.7253828048706055,
                        0.3046344220638275,
                        0.4378359019756317,
                        0.34986308217048645,
                        0.4302808940410614,
                        0.430585116147995,
                        0.7177263498306274,
                        0.5167325735092163,
                        0.7339012026786804,
                        0.7008923888206482,
                        0.7251799702644348,
                        0.734965980052948,
                        0.7371463179588318,
                        0.3675083518028259,
                        0.9823039770126343,
                        0.8861677050590515,
                        0.9925970435142517,
                        0.8600547313690186,
                        0.8535138368606567,
                        0.8542743921279907,
                        0.8565561175346375,
                        0.8520941138267517,
                        0.8415982127189636,
                        0.8628941774368286,
                        0.851333498954773,
                        0.8634519577026367,
                        0.8528039455413818,
                        0.2981441915035248,
                        0.8457052707672119,
                        0.8587363958358765,
                        0.8593448996543884,
                        0.5966940522193909,
                        0.6094716191291809,
                        0.5564344525337219,
                        0.9961971044540405,
                        0.7196024656295776
                    ]
                },
                "test": {
                    "pretrain_loss": 0.4279603958129883,
                    "features_accuracy": [
                        0.752231240272522,
                        0.6406693458557129,
                        0.7911764979362488,
                        0.7895537614822388,
                        0.8020790815353394,
                        0.7952839732170105,
                        0.7922413945198059,
                        0.7953346967697144,
                        0.8108519315719604,
                        0.8019776940345764,
                        0.9936612844467163,
                        0.7653651237487793,
                        0.7845335006713867,
                        0.7829107642173767,
                        0.7898073196411133,
                        0.7885395288467407,
                        0.7865618467330933,
                        0.7915821671485901,
                        0.7610547542572021,
                        0.790567934513092,
                        0.7985293865203857,
                        0.7879310250282288,
                        0.8717545866966248,
                        0.723935067653656,
                        0.8117139935493469,
                        0.8647058606147766,
                        0.7661257386207581,
                        0.7416836023330688,
                        0.7708925008773804,
                        0.9835192561149597,
                        0.8976166248321533,
                        0.9933062791824341,
                        0.6695740222930908,
                        0.8524340987205505,
                        0.8460953235626221,
                        0.8625760674476624,
                        0.8609533309936523,
                        0.8728194832801819,
                        0.8648580312728882,
                        0.791683554649353,
                        0.8887931108474731,
                        0.8710953593254089,
                        0.7829107642173767,
                        0.8454868197441101,
                        0.8550710082054138,
                        0.8526369333267212,
                        0.7995436191558838,
                        0.8052738308906555,
                        0.7969067096710205,
                        0.9969574213027954,
                        0.7146044373512268
                    ]
                }
            }
        },
        "train": {
            "score": -3.1758348374007985
        },
        "val": {
            "score": -5.226096406882966
        },
        "test": {
            "score": -5.504552224521646
        }
    },
    "best_iteration": 10000,
    "time": "0:05:03"
}
