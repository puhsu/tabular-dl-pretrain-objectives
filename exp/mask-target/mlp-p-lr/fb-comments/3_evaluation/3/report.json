{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_fast___88f334f0dee44fc782727ac73dc94e4f.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0,1",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                },
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 3,
        "data": {
            "path": "data/fb-comments",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512
                ],
                "dropout": 0.3165243883109578
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "positional",
                "linear",
                "relu"
            ],
            "d_num_embedding": 11,
            "positional_encoding": {
                "n": 35,
                "sigma": 0.3078928096197865,
                "trainable": true,
                "initialization": "normal"
            },
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 512,
            "lr": 0.00015569191898648328,
            "weight_decay": 0.0007948790593667655,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 1024
        },
        "pretrain": {
            "corrupt_probability": 0.7425803516231099,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.00015569191898648328,
            "weight_decay": 0.0007948790593667655,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "target_shuffle",
            "n_neighbors": 20,
            "use_target": true,
            "early_stop_type": "pretrain",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "n_parameters": 653715,
    "epoch_size": 308,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "pretrain_loss": 0.163212850689888,
                    "features_accuracy": [
                        0.9660868644714355,
                        0.7769764065742493,
                        0.9637333750724792,
                        0.9697408080101013,
                        0.9264073371887207,
                        0.9673810005187988,
                        0.9674761295318604,
                        0.9670701622962952,
                        0.9060569405555725,
                        0.9672160744667053,
                        0.9962572455406189,
                        0.966588020324707,
                        0.9663025736808777,
                        0.9661503434181213,
                        0.9508621096611023,
                        0.9672667980194092,
                        0.965858519077301,
                        0.9635303616523743,
                        0.966124951839447,
                        0.9226455688476562,
                        0.9669496417045593,
                        0.9420381188392639,
                        0.8838605284690857,
                        0.9377307891845703,
                        0.9348634481430054,
                        0.9381431341171265,
                        0.9531014561653137,
                        0.9609865546226501,
                        0.9616971015930176,
                        0.9853969216346741,
                        0.8775231838226318,
                        0.9961811304092407,
                        0.8892145752906799,
                        0.8840571641921997,
                        0.8798893690109253,
                        0.8881234526634216,
                        0.886543869972229,
                        0.8936804533004761,
                        0.8917837142944336,
                        0.8949682116508484,
                        0.8645694851875305,
                        0.8866326808929443,
                        0.9664357900619507,
                        0.8812279105186462,
                        0.8881361484527588,
                        0.8897030353546143,
                        0.9679709672927856,
                        0.9562161564826965,
                        0.9658902287483215,
                        0.9973610639572144,
                        0.9625725150108337
                    ]
                },
                "val": {
                    "pretrain_loss": 0.5937463641166687,
                    "features_accuracy": [
                        0.7425210475921631,
                        0.8632491230964661,
                        0.737653374671936,
                        0.6287394762039185,
                        0.40426933765411377,
                        0.6804583668708801,
                        0.7429266571998596,
                        0.7358787059783936,
                        0.47662508487701416,
                        0.698255717754364,
                        0.9927998781204224,
                        0.7361829280853271,
                        0.7428759336471558,
                        0.7330899238586426,
                        0.38986918330192566,
                        0.7320758104324341,
                        0.735625147819519,
                        0.611550509929657,
                        0.749011218547821,
                        0.5611499547958374,
                        0.5362032055854797,
                        0.7240137457847595,
                        0.4490416646003723,
                        0.3957509398460388,
                        0.7229996919631958,
                        0.5780346393585205,
                        0.7244701385498047,
                        0.7359800934791565,
                        0.5878207087516785,
                        0.9846871495246887,
                        0.900567889213562,
                        0.9926477670669556,
                        0.8565053939819336,
                        0.8528039455413818,
                        0.8500151634216309,
                        0.8558969497680664,
                        0.8520433902740479,
                        0.8563532829284668,
                        0.8620829582214355,
                        0.8499644994735718,
                        0.8768887519836426,
                        0.8528039455413818,
                        0.7269546389579773,
                        0.852651834487915,
                        0.863959014415741,
                        0.8644153475761414,
                        0.6271676421165466,
                        0.6396409869194031,
                        0.7399857640266418,
                        0.9958421587944031,
                        0.7227461338043213
                    ]
                },
                "test": {
                    "pretrain_loss": 0.4417066276073456,
                    "features_accuracy": [
                        0.7430527210235596,
                        0.6382859945297241,
                        0.7490872144699097,
                        0.7867140173912048,
                        0.7887424230575562,
                        0.790567934513092,
                        0.773833692073822,
                        0.7708417773246765,
                        0.8183062672615051,
                        0.7799695730209351,
                        0.9935091137886047,
                        0.7414807081222534,
                        0.7484787106513977,
                        0.7713488936424255,
                        0.7806288003921509,
                        0.7792596220970154,
                        0.7592291831970215,
                        0.7553245425224304,
                        0.7412778735160828,
                        0.8104462623596191,
                        0.7990872263908386,
                        0.7938134074211121,
                        0.876014232635498,
                        0.6613590121269226,
                        0.7920385599136353,
                        0.8284482955932617,
                        0.7304766774177551,
                        0.7456896305084229,
                        0.7288539409637451,
                        0.9828600287437439,
                        0.8945740461349487,
                        0.9933062791824341,
                        0.8534989953041077,
                        0.8530426025390625,
                        0.8420385718345642,
                        0.8572008013725281,
                        0.8533468842506409,
                        0.8646551966667175,
                        0.8623225092887878,
                        0.8637424111366272,
                        0.882251501083374,
                        0.853296160697937,
                        0.7454867959022522,
                        0.8509634733200073,
                        0.8671906590461731,
                        0.8589756488800049,
                        0.7876774668693542,
                        0.8095334768295288,
                        0.7549188733100891,
                        0.9967545866966248,
                        0.7175456285476685
                    ]
                }
            },
            "20000": {
                "train": {
                    "pretrain_loss": 0.15350341796875,
                    "features_accuracy": [
                        0.9690811038017273,
                        0.7996104955673218,
                        0.9695758819580078,
                        0.971320390701294,
                        0.9381431341171265,
                        0.9711998701095581,
                        0.9716058373451233,
                        0.9708129167556763,
                        0.9223664402961731,
                        0.9703053832054138,
                        0.9961811304092407,
                        0.9694997668266296,
                        0.9718659520149231,
                        0.9713901877403259,
                        0.9596861600875854,
                        0.9704639911651611,
                        0.9707304239273071,
                        0.9696710109710693,
                        0.9686687588691711,
                        0.9352757930755615,
                        0.9701277613639832,
                        0.946840226650238,
                        0.8863979578018188,
                        0.9388536214828491,
                        0.9432370662689209,
                        0.9413149356842041,
                        0.9571106433868408,
                        0.9641901254653931,
                        0.9654397964477539,
                        0.9856253266334534,
                        0.8800542950630188,
                        0.9961621165275574,
                        0.8886246085166931,
                        0.8834671974182129,
                        0.8811200261116028,
                        0.8884215950965881,
                        0.8872353434562683,
                        0.894486129283905,
                        0.8920057415962219,
                        0.8943783044815063,
                        0.8678491115570068,
                        0.888148844242096,
                        0.9721704125404358,
                        0.8813928365707397,
                        0.8887641429901123,
                        0.8907750844955444,
                        0.9728047847747803,
                        0.9607518911361694,
                        0.9715741276741028,
                        0.9977797269821167,
                        0.9621918797492981
                    ]
                },
                "val": {
                    "pretrain_loss": 0.6799464821815491,
                    "features_accuracy": [
                        0.7234560251235962,
                        0.8642125129699707,
                        0.7371463179588318,
                        0.2797383666038513,
                        0.40213972330093384,
                        0.3893621265888214,
                        0.47956594824790955,
                        0.5203832983970642,
                        0.47809550166130066,
                        0.30179494619369507,
                        0.9926984906196594,
                        0.7378562092781067,
                        0.5654598474502563,
                        0.7228982448577881,
                        0.3020484745502472,
                        0.4009228050708771,
                        0.45826995372772217,
                        0.694706380367279,
                        0.6949092149734497,
                        0.564902126789093,
                        0.6346212029457092,
                        0.7235574126243591,
                        0.4734813868999481,
                        0.4782983362674713,
                        0.7187404632568359,
                        0.7184869647026062,
                        0.7310110330581665,
                        0.736335039138794,
                        0.43778520822525024,
                        0.9849406480789185,
                        0.8885001540184021,
                        0.9926477670669556,
                        0.8633505702018738,
                        0.8535138368606567,
                        0.8445897698402405,
                        0.8578237295150757,
                        0.8521955013275146,
                        0.8586857318878174,
                        0.8630463480949402,
                        0.6475509405136108,
                        0.8656322360038757,
                        0.8535138368606567,
                        0.5074028968811035,
                        0.8473785519599915,
                        0.8577223420143127,
                        0.8589392304420471,
                        0.6021701693534851,
                        0.7079403400421143,
                        0.4780448079109192,
                        0.9958421587944031,
                        0.7227968573570251
                    ]
                },
                "test": {
                    "pretrain_loss": 0.4307868480682373,
                    "features_accuracy": [
                        0.7427991628646851,
                        0.6395537853240967,
                        0.7729209065437317,
                        0.8008620738983154,
                        0.7865618467330933,
                        0.7920385599136353,
                        0.7991886734962463,
                        0.8085192441940308,
                        0.8152129650115967,
                        0.8091278076171875,
                        0.9935091137886047,
                        0.7616633176803589,
                        0.7834178805351257,
                        0.8120689988136292,
                        0.8133874535560608,
                        0.7971095442771912,
                        0.7952332496643066,
                        0.7780933380126953,
                        0.7438133955001831,
                        0.8057809472084045,
                        0.7777890563011169,
                        0.7833671569824219,
                        0.8519269824028015,
                        0.6289553642272949,
                        0.8021805286407471,
                        0.8245943188667297,
                        0.737778902053833,
                        0.7456896305084229,
                        0.7521297931671143,
                        0.9827079176902771,
                        0.8948276042938232,
                        0.9935091137886047,
                        0.8504056930541992,
                        0.853803277015686,
                        0.8424949049949646,
                        0.8619675636291504,
                        0.860547661781311,
                        0.8641988039016724,
                        0.8625760674476624,
                        0.8181541562080383,
                        0.8694726228713989,
                        0.8542596101760864,
                        0.7872210741043091,
                        0.8445740342140198,
                        0.8690162301063538,
                        0.8580121994018555,
                        0.8046653270721436,
                        0.8023326396942139,
                        0.797160267829895,
                        0.9970081448554993,
                        0.7179006338119507
                    ]
                }
            },
            "30000": {
                "train": {
                    "pretrain_loss": 0.14926734566688538,
                    "features_accuracy": [
                        0.9691635370254517,
                        0.8082188367843628,
                        0.9710920453071594,
                        0.9734518527984619,
                        0.9454383254051208,
                        0.9726144671440125,
                        0.9729443788528442,
                        0.9736104607582092,
                        0.9324211478233337,
                        0.9724242091178894,
                        0.9962636232376099,
                        0.9710666537284851,
                        0.9724432229995728,
                        0.9734391570091248,
                        0.9609231352806091,
                        0.9733947515487671,
                        0.9731917381286621,
                        0.9712759852409363,
                        0.9700009226799011,
                        0.9404458403587341,
                        0.9736865758895874,
                        0.9505005478858948,
                        0.8873875737190247,
                        0.9426661133766174,
                        0.9454827308654785,
                        0.9413847327232361,
                        0.9582905173301697,
                        0.9657316207885742,
                        0.9671716690063477,
                        0.9857965707778931,
                        0.880066990852356,
                        0.9962255358695984,
                        0.8892843127250671,
                        0.8855352401733398,
                        0.8806886672973633,
                        0.8895888328552246,
                        0.8884977102279663,
                        0.8947461843490601,
                        0.8927797079086304,
                        0.8962940573692322,
                        0.8665043115615845,
                        0.8869308233261108,
                        0.9727730751037598,
                        0.8829787373542786,
                        0.8896966576576233,
                        0.8924244046211243,
                        0.9742321372032166,
                        0.9638792872428894,
                        0.9725510478019714,
                        0.9978622198104858,
                        0.9623568058013916
                    ]
                },
                "val": {
                    "pretrain_loss": 0.7432724237442017,
                    "features_accuracy": [
                        0.6750836372375488,
                        0.8617280125617981,
                        0.7390223741531372,
                        0.26513537764549255,
                        0.41126659512519836,
                        0.3542743921279907,
                        0.2970793843269348,
                        0.35959839820861816,
                        0.47941383719444275,
                        0.583916425704956,
                        0.9927998781204224,
                        0.6903964877128601,
                        0.3544265329837799,
                        0.7319236993789673,
                        0.3493560254573822,
                        0.6385762095451355,
                        0.5351890921592712,
                        0.5708853006362915,
                        0.45872628688812256,
                        0.5643443465232849,
                        0.23273500800132751,
                        0.7340025901794434,
                        0.47708141803741455,
                        0.7135685682296753,
                        0.7068248391151428,
                        0.7277151942253113,
                        0.7332420349121094,
                        0.736335039138794,
                        0.3680154085159302,
                        0.984585702419281,
                        0.8980833292007446,
                        0.9928506016731262,
                        0.8587363958358765,
                        0.8537673354148865,
                        0.8475813865661621,
                        0.8568096160888672,
                        0.851891279220581,
                        0.8225331902503967,
                        0.8613730669021606,
                        0.8200486302375793,
                        0.8720210790634155,
                        0.8530575037002563,
                        0.650187611579895,
                        0.854020893573761,
                        0.859649121761322,
                        0.8590406179428101,
                        0.5299665331840515,
                        0.7096642851829529,
                        0.6452692151069641,
                        0.9958928823471069,
                        0.7223912477493286
                    ]
                },
                "test": {
                    "pretrain_loss": 0.42477840185165405,
                    "features_accuracy": [
                        0.7450811266899109,
                        0.6409736275672913,
                        0.7834178805351257,
                        0.8008620738983154,
                        0.7904158234596252,
                        0.7863590121269226,
                        0.7979208827018738,
                        0.8078600168228149,
                        0.7946754693984985,
                        0.7991886734962463,
                        0.9935598373413086,
                        0.7711967825889587,
                        0.7876268029212952,
                        0.7980223298072815,
                        0.7934077382087708,
                        0.7943204641342163,
                        0.7937626838684082,
                        0.7930020093917847,
                        0.753346860408783,
                        0.7891988158226013,
                        0.8076571822166443,
                        0.7948275804519653,
                        0.8820993900299072,
                        0.6802231073379517,
                        0.7986308336257935,
                        0.8403143882751465,
                        0.7717545628547668,
                        0.7456896305084229,
                        0.7753042578697205,
                        0.9829107522964478,
                        0.9018255472183228,
                        0.9935091137886047,
                        0.8551217317581177,
                        0.8519269824028015,
                        0.8548174500465393,
                        0.85943204164505,
                        0.8597870469093323,
                        0.8684077262878418,
                        0.8624746203422546,
                        0.8658722043037415,
                        0.8816429972648621,
                        0.8570486903190613,
                        0.7850912809371948,
                        0.8474137783050537,
                        0.8603448271751404,
                        0.8530933260917664,
                        0.7901115417480469,
                        0.7929006218910217,
                        0.7952839732170105,
                        0.9970081448554993,
                        0.7175456285476685
                    ]
                }
            },
            "40000": {
                "train": {
                    "pretrain_loss": 0.14628346264362335,
                    "features_accuracy": [
                        0.9706670045852661,
                        0.8348304629325867,
                        0.9719039797782898,
                        0.9738895893096924,
                        0.9512237310409546,
                        0.9732108116149902,
                        0.9726842641830444,
                        0.9738578200340271,
                        0.9388155341148376,
                        0.9730331897735596,
                        0.9963016510009766,
                        0.9704005718231201,
                        0.9727667570114136,
                        0.9736865758895874,
                        0.9659282565116882,
                        0.973800778388977,
                        0.9728682637214661,
                        0.9723924398422241,
                        0.9700706601142883,
                        0.9444423317909241,
                        0.9730141162872314,
                        0.9504814743995667,
                        0.8886563181877136,
                        0.9429769515991211,
                        0.9454129338264465,
                        0.9424567818641663,
                        0.9580304622650146,
                        0.9654334783554077,
                        0.9684911370277405,
                        0.9857141375541687,
                        0.8811771273612976,
                        0.9963207244873047,
                        0.8900201916694641,
                        0.8857128620147705,
                        0.8840444684028625,
                        0.8890559673309326,
                        0.8906735777854919,
                        0.8957992792129517,
                        0.8940801024436951,
                        0.8978546261787415,
                        0.8678554892539978,
                        0.8883327841758728,
                        0.9735469818115234,
                        0.884875476360321,
                        0.890870213508606,
                        0.8926655054092407,
                        0.9741560220718384,
                        0.965255856513977,
                        0.9735216498374939,
                        0.9979002475738525,
                        0.9622489809989929
                    ]
                },
                "val": {
                    "pretrain_loss": 0.7688219547271729,
                    "features_accuracy": [
                        0.3547307550907135,
                        0.8624885678291321,
                        0.725027859210968,
                        0.5889362096786499,
                        0.4122806787490845,
                        0.3074738681316376,
                        0.35493355989456177,
                        0.4065510630607605,
                        0.48012369871139526,
                        0.3340432047843933,
                        0.9929519891738892,
                        0.7037318348884583,
                        0.30154141783714294,
                        0.6924753785133362,
                        0.37982961535453796,
                        0.5472568273544312,
                        0.4403204321861267,
                        0.6889260411262512,
                        0.5342257022857666,
                        0.5688570737838745,
                        0.510698676109314,
                        0.73060542345047,
                        0.4998478591442108,
                        0.7636649012565613,
                        0.6987120509147644,
                        0.5311834216117859,
                        0.7315688133239746,
                        0.7361322045326233,
                        0.3522462248802185,
                        0.9834194779396057,
                        0.8917959332466125,
                        0.9927998781204224,
                        0.8581279516220093,
                        0.8552377820014954,
                        0.8459588289260864,
                        0.8564040064811707,
                        0.852753221988678,
                        0.806104838848114,
                        0.8643646240234375,
                        0.8046343922615051,
                        0.8695365190505981,
                        0.8539194464683533,
                        0.5191664099693298,
                        0.8470743298530579,
                        0.858381450176239,
                        0.8592941761016846,
                        0.6164689064025879,
                        0.6778724193572998,
                        0.6067842841148376,
                        0.9960957169532776,
                        0.7225940227508545
                    ]
                },
                "test": {
                    "pretrain_loss": 0.4251994490623474,
                    "features_accuracy": [
                        0.7640973925590515,
                        0.6451318264007568,
                        0.7868154048919678,
                        0.7915314435958862,
                        0.7907707691192627,
                        0.807251513004303,
                        0.7902637124061584,
                        0.797160267829895,
                        0.806135892868042,
                        0.8031947016716003,
                        0.9935598373413086,
                        0.7583164572715759,
                        0.7974644899368286,
                        0.8002028465270996,
                        0.7948275804519653,
                        0.7994421720504761,
                        0.7975152134895325,
                        0.7901115417480469,
                        0.75162273645401,
                        0.7912778854370117,
                        0.796044647693634,
                        0.7774847745895386,
                        0.8787525296211243,
                        0.7003549933433533,
                        0.7913793325424194,
                        0.8601419925689697,
                        0.7304766774177551,
                        0.7456896305084229,
                        0.7893002033233643,
                        0.9825558066368103,
                        0.898326575756073,
                        0.9935091137886047,
                        0.8287018537521362,
                        0.8518255352973938,
                        0.8469067215919495,
                        0.8586714267730713,
                        0.8579107522964478,
                        0.8759635090827942,
                        0.8807302117347717,
                        0.8662778735160828,
                        0.8866633176803589,
                        0.8797160387039185,
                        0.7937119603157043,
                        0.8448275923728943,
                        0.8563387393951416,
                        0.8524340987205505,
                        0.800000011920929,
                        0.7902129888534546,
                        0.7984787225723267,
                        0.9970081448554993,
                        0.7179006338119507
                    ]
                }
            }
        },
        "train": {
            "score": -4.022304945721922
        },
        "val": {
            "score": -5.318744438525602
        },
        "test": {
            "score": -5.594134440556759
        }
    },
    "best_iteration": 10000,
    "time": "0:04:13"
}
