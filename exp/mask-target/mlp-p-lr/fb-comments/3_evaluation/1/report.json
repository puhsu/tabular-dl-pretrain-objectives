{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_fast___88f334f0dee44fc782727ac73dc94e4f.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0,1",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                },
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 1,
        "data": {
            "path": "data/fb-comments",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512
                ],
                "dropout": 0.3165243883109578
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "positional",
                "linear",
                "relu"
            ],
            "d_num_embedding": 11,
            "positional_encoding": {
                "n": 35,
                "sigma": 0.3078928096197865,
                "trainable": true,
                "initialization": "normal"
            },
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 512,
            "lr": 0.00015569191898648328,
            "weight_decay": 0.0007948790593667655,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 1024
        },
        "pretrain": {
            "corrupt_probability": 0.7425803516231099,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.00015569191898648328,
            "weight_decay": 0.0007948790593667655,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "target_shuffle",
            "n_neighbors": 20,
            "use_target": true,
            "early_stop_type": "pretrain",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "n_parameters": 653715,
    "epoch_size": 308,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "pretrain_loss": 0.1639411300420761,
                    "features_accuracy": [
                        0.9655666947364807,
                        0.7770017385482788,
                        0.9626866579055786,
                        0.9670384526252747,
                        0.9262614250183105,
                        0.966061532497406,
                        0.9648752212524414,
                        0.9665690064430237,
                        0.9067293405532837,
                        0.9662137627601624,
                        0.9960415959358215,
                        0.96492600440979,
                        0.9660805463790894,
                        0.9670954942703247,
                        0.9509446024894714,
                        0.9675713181495667,
                        0.9663532972335815,
                        0.9638665914535522,
                        0.9660234451293945,
                        0.9248214364051819,
                        0.9648689031600952,
                        0.9404268264770508,
                        0.8822936415672302,
                        0.9355422258377075,
                        0.9329032301902771,
                        0.9374452829360962,
                        0.9551377296447754,
                        0.9621157646179199,
                        0.9609865546226501,
                        0.9855682253837585,
                        0.877199649810791,
                        0.9960162043571472,
                        0.8889100551605225,
                        0.8839049339294434,
                        0.8789568543434143,
                        0.8871845602989197,
                        0.8869372010231018,
                        0.8946700692176819,
                        0.8915489912033081,
                        0.895754873752594,
                        0.8632944226264954,
                        0.8868674039840698,
                        0.9645897746086121,
                        0.8806633353233337,
                        0.887609601020813,
                        0.8895190358161926,
                        0.9681802988052368,
                        0.9540529847145081,
                        0.9663342833518982,
                        0.9972976446151733,
                        0.961513102054596
                    ]
                },
                "val": {
                    "pretrain_loss": 0.5781801342964172,
                    "features_accuracy": [
                        0.7331406474113464,
                        0.864719569683075,
                        0.7362843155860901,
                        0.7226447463035583,
                        0.3531588912010193,
                        0.7416083216667175,
                        0.7348138689994812,
                        0.7416083216667175,
                        0.48788154125213623,
                        0.7416083216667175,
                        0.9923942685127258,
                        0.7300983667373657,
                        0.6847175359725952,
                        0.7357772588729858,
                        0.6911570429801941,
                        0.6742216348648071,
                        0.6958726048469543,
                        0.7389209866523743,
                        0.751039445400238,
                        0.45887839794158936,
                        0.7447013258934021,
                        0.726396918296814,
                        0.4736334979534149,
                        0.35741809010505676,
                        0.7176756858825684,
                        0.7572253942489624,
                        0.7241658568382263,
                        0.7380589842796326,
                        0.44331201910972595,
                        0.9843828678131104,
                        0.8934692144393921,
                        0.9926984906196594,
                        0.8574687838554382,
                        0.8590406179428101,
                        0.844184160232544,
                        0.8786126971244812,
                        0.8524997234344482,
                        0.8094513416290283,
                        0.8679139614105225,
                        0.7711185216903687,
                        0.8774464726448059,
                        0.8520433902740479,
                        0.6941486597061157,
                        0.8588885068893433,
                        0.857620894908905,
                        0.8762295842170715,
                        0.7425210475921631,
                        0.6995740532875061,
                        0.737754762172699,
                        0.9957407712936401,
                        0.7160531282424927
                    ]
                },
                "test": {
                    "pretrain_loss": 0.44915980100631714,
                    "features_accuracy": [
                        0.7379817366600037,
                        0.6394016146659851,
                        0.7431541681289673,
                        0.7450811266899109,
                        0.7899087071418762,
                        0.7376267910003662,
                        0.7452839612960815,
                        0.7736815214157104,
                        0.8148072957992554,
                        0.7384381294250488,
                        0.9933062791824341,
                        0.7391480803489685,
                        0.7640973925590515,
                        0.7748985886573792,
                        0.7821500897407532,
                        0.7802231311798096,
                        0.7546653151512146,
                        0.7418357133865356,
                        0.7375253438949585,
                        0.8029918670654297,
                        0.7577078938484192,
                        0.7476166486740112,
                        0.8537018299102783,
                        0.6237829923629761,
                        0.7512677311897278,
                        0.8207910656929016,
                        0.7309330701828003,
                        0.7420892715454102,
                        0.7279918789863586,
                        0.9828600287437439,
                        0.8941683769226074,
                        0.9935091137886047,
                        0.8529411554336548,
                        0.8581643104553223,
                        0.8432048559188843,
                        0.8592799305915833,
                        0.8541582226753235,
                        0.8683570027351379,
                        0.8653650879859924,
                        0.8512170314788818,
                        0.8876267671585083,
                        0.8536511063575745,
                        0.7378803491592407,
                        0.8530426025390625,
                        0.856135904788971,
                        0.8550710082054138,
                        0.7800202965736389,
                        0.7611562013626099,
                        0.7530425786972046,
                        0.9968559741973877,
                        0.7210953235626221
                    ]
                }
            },
            "20000": {
                "train": {
                    "pretrain_loss": 0.1539708375930786,
                    "features_accuracy": [
                        0.969049334526062,
                        0.795030415058136,
                        0.9691445231437683,
                        0.9720752835273743,
                        0.9356310367584229,
                        0.97071772813797,
                        0.9714853167533875,
                        0.9716566205024719,
                        0.9222459197044373,
                        0.971320390701294,
                        0.9960796236991882,
                        0.9685038328170776,
                        0.9708065390586853,
                        0.9711808562278748,
                        0.9585760235786438,
                        0.9699565172195435,
                        0.9698867201805115,
                        0.9691508412361145,
                        0.9700643420219421,
                        0.9329603314399719,
                        0.9708446264266968,
                        0.9462883472442627,
                        0.8857128620147705,
                        0.939970076084137,
                        0.9423933625221252,
                        0.9395197033882141,
                        0.9576561450958252,
                        0.9659409523010254,
                        0.9664484858512878,
                        0.9857585430145264,
                        0.8793691992759705,
                        0.9960796236991882,
                        0.8896205425262451,
                        0.8835623860359192,
                        0.8817607760429382,
                        0.8884406089782715,
                        0.8873050808906555,
                        0.8948286771774292,
                        0.8915997743606567,
                        0.8959388136863708,
                        0.8663266897201538,
                        0.8867087960243225,
                        0.9716439247131348,
                        0.8811835050582886,
                        0.8894492387771606,
                        0.8897156715393066,
                        0.9721513986587524,
                        0.9615004062652588,
                        0.9697344899177551,
                        0.9976845979690552,
                        0.9626866579055786
                    ]
                },
                "val": {
                    "pretrain_loss": 0.655709981918335,
                    "features_accuracy": [
                        0.7287800312042236,
                        0.8436771035194397,
                        0.45015716552734375,
                        0.7333434820175171,
                        0.4106581509113312,
                        0.5746374726295471,
                        0.6816245913505554,
                        0.6965317726135254,
                        0.48199978470802307,
                        0.6169252395629883,
                        0.9929519891738892,
                        0.7625494003295898,
                        0.44503599405288696,
                        0.7007910013198853,
                        0.6817259788513184,
                        0.6041983366012573,
                        0.6634215712547302,
                        0.3736436367034912,
                        0.7480478286743164,
                        0.5649528503417969,
                        0.681269645690918,
                        0.7347124814987183,
                        0.5001521110534668,
                        0.37283235788345337,
                        0.7239630818367004,
                        0.7095121741294861,
                        0.7152418494224548,
                        0.7381604313850403,
                        0.3545786440372467,
                        0.9836223125457764,
                        0.8981340527534485,
                        0.9924956560134888,
                        0.8558969497680664,
                        0.8685224652290344,
                        0.8462123274803162,
                        0.8579251170158386,
                        0.8546800017356873,
                        0.8473785519599915,
                        0.863198459148407,
                        0.8571645617485046,
                        0.8828718662261963,
                        0.8530067801475525,
                        0.6240239143371582,
                        0.8461109399795532,
                        0.8582293391227722,
                        0.868928074836731,
                        0.6743230819702148,
                        0.6322380900382996,
                        0.7046952247619629,
                        0.9961971044540405,
                        0.7163573503494263
                    ]
                },
                "test": {
                    "pretrain_loss": 0.431595116853714,
                    "features_accuracy": [
                        0.7428498864173889,
                        0.6386409997940063,
                        0.7828600406646729,
                        0.7814401388168335,
                        0.7979208827018738,
                        0.7938640713691711,
                        0.7779918909072876,
                        0.8047160506248474,
                        0.8093306422233582,
                        0.776064932346344,
                        0.9933570027351379,
                        0.7435598373413086,
                        0.7843813300132751,
                        0.8045132160186768,
                        0.8047160506248474,
                        0.7883366942405701,
                        0.7732758522033691,
                        0.7705375552177429,
                        0.7376775145530701,
                        0.7980730533599854,
                        0.791632890701294,
                        0.7882353067398071,
                        0.8463996052742004,
                        0.639452338218689,
                        0.7973123788833618,
                        0.8159229159355164,
                        0.7351927161216736,
                        0.7420892715454102,
                        0.7395537495613098,
                        0.9828093647956848,
                        0.8948783278465271,
                        0.9937119483947754,
                        0.8450811505317688,
                        0.8545638918876648,
                        0.8429006338119507,
                        0.8573529720306396,
                        0.8590263724327087,
                        0.8873732089996338,
                        0.8630324602127075,
                        0.8346349000930786,
                        0.8896551728248596,
                        0.8533468842506409,
                        0.7830121517181396,
                        0.8444726467132568,
                        0.856135904788971,
                        0.85780930519104,
                        0.8141987919807434,
                        0.8009127974510193,
                        0.7630831599235535,
                        0.9969066977500916,
                        0.7209432125091553
                    ]
                }
            },
            "30000": {
                "train": {
                    "pretrain_loss": 0.1497724950313568,
                    "features_accuracy": [
                        0.9703434705734253,
                        0.8201195597648621,
                        0.9714980125427246,
                        0.9730902910232544,
                        0.9420698285102844,
                        0.9719610810279846,
                        0.9733503460884094,
                        0.9736104607582092,
                        0.9291287660598755,
                        0.9721450805664062,
                        0.9961304068565369,
                        0.9690240025520325,
                        0.9724939465522766,
                        0.9728745818138123,
                        0.9625598192214966,
                        0.9730268120765686,
                        0.9725256562232971,
                        0.971250593662262,
                        0.969651997089386,
                        0.9381494522094727,
                        0.9726018309593201,
                        0.9487370252609253,
                        0.8875334858894348,
                        0.9415115714073181,
                        0.945178210735321,
                        0.9416003823280334,
                        0.9580177664756775,
                        0.965725302696228,
                        0.9664801955223083,
                        0.9860820770263672,
                        0.8803778290748596,
                        0.9961621165275574,
                        0.8891891837120056,
                        0.8843933939933777,
                        0.8815831542015076,
                        0.8886436223983765,
                        0.8887578248977661,
                        0.894156277179718,
                        0.8920311331748962,
                        0.895412266254425,
                        0.8668214678764343,
                        0.8879331350326538,
                        0.9724368453025818,
                        0.8822238445281982,
                        0.8887514472007751,
                        0.8909273147583008,
                        0.9728618860244751,
                        0.9648181200027466,
                        0.9729570746421814,
                        0.9977480173110962,
                        0.9621537923812866
                    ]
                },
                "val": {
                    "pretrain_loss": 0.7124648094177246,
                    "features_accuracy": [
                        0.5228678584098816,
                        0.8576716184616089,
                        0.31158095598220825,
                        0.7310110330581665,
                        0.3660886287689209,
                        0.5237805247306824,
                        0.426376610994339,
                        0.6005476117134094,
                        0.4756616950035095,
                        0.598063051700592,
                        0.9931548237800598,
                        0.515566349029541,
                        0.23608152568340302,
                        0.6933373808860779,
                        0.6149477362632751,
                        0.6762498617172241,
                        0.5294594764709473,
                        0.37186896800994873,
                        0.5652063488960266,
                        0.5650542378425598,
                        0.5183044075965881,
                        0.7302504777908325,
                        0.48144203424453735,
                        0.48524489998817444,
                        0.6611398458480835,
                        0.6930838227272034,
                        0.7267518043518066,
                        0.7382618188858032,
                        0.5184565186500549,
                        0.9829631447792053,
                        0.8967143297195435,
                        0.9927998781204224,
                        0.8569110631942749,
                        0.8577223420143127,
                        0.8459588289260864,
                        0.8565053939819336,
                        0.8533617258071899,
                        0.852651834487915,
                        0.8664942383766174,
                        0.8590406179428101,
                        0.8770915269851685,
                        0.8554912805557251,
                        0.6728019118309021,
                        0.8452996611595154,
                        0.8565053939819336,
                        0.8636547923088074,
                        0.6559679508209229,
                        0.6395902633666992,
                        0.398083359003067,
                        0.9959942698478699,
                        0.7156981825828552
                    ]
                },
                "test": {
                    "pretrain_loss": 0.4267197549343109,
                    "features_accuracy": [
                        0.7664807438850403,
                        0.6391480565071106,
                        0.795030415058136,
                        0.778296172618866,
                        0.7861054539680481,
                        0.8047160506248474,
                        0.7912271618843079,
                        0.7997464537620544,
                        0.7924442291259766,
                        0.7740872502326965,
                        0.9935598373413086,
                        0.746653139591217,
                        0.790567934513092,
                        0.8013691902160645,
                        0.7902637124061584,
                        0.7970080971717834,
                        0.7981237173080444,
                        0.7840263843536377,
                        0.7465517520904541,
                        0.7919371128082275,
                        0.8061866164207458,
                        0.786156177520752,
                        0.873884379863739,
                        0.6849391460418701,
                        0.8009635210037231,
                        0.83945232629776,
                        0.7521805167198181,
                        0.7420385479927063,
                        0.7381845712661743,
                        0.9829614758491516,
                        0.8975152373313904,
                        0.9937119483947754,
                        0.8513184785842896,
                        0.852281928062439,
                        0.8462981581687927,
                        0.8561866283416748,
                        0.8552231192588806,
                        0.8902130126953125,
                        0.8650608658790588,
                        0.8352434039115906,
                        0.8903651237487793,
                        0.8556287884712219,
                        0.7884888648986816,
                        0.8459432125091553,
                        0.8663793206214905,
                        0.855527400970459,
                        0.8081135749816895,
                        0.7966024279594421,
                        0.7924949526786804,
                        0.9970081448554993,
                        0.7209432125091553
                    ]
                }
            },
            "40000": {
                "train": {
                    "pretrain_loss": 0.14608798921108246,
                    "features_accuracy": [
                        0.9710920453071594,
                        0.8377739191055298,
                        0.9721133708953857,
                        0.9740989208221436,
                        0.9480265378952026,
                        0.9739276170730591,
                        0.9735660552978516,
                        0.9745239019393921,
                        0.9390692710876465,
                        0.9734074473381042,
                        0.9962192177772522,
                        0.9711300730705261,
                        0.9731664061546326,
                        0.97393399477005,
                        0.9655095934867859,
                        0.9736738801002502,
                        0.9732869267463684,
                        0.9719801545143127,
                        0.9702419638633728,
                        0.9424948692321777,
                        0.9749109148979187,
                        0.950170636177063,
                        0.888611912727356,
                        0.9433956742286682,
                        0.9449878931045532,
                        0.9417970776557922,
                        0.9576942324638367,
                        0.9668798446655273,
                        0.9684276580810547,
                        0.9857648611068726,
                        0.8807711601257324,
                        0.9961875081062317,
                        0.8904388546943665,
                        0.8862584233283997,
                        0.8822555541992188,
                        0.8893668055534363,
                        0.8899821043014526,
                        0.895551860332489,
                        0.8931602835655212,
                        0.8967761993408203,
                        0.8678871989250183,
                        0.8886373043060303,
                        0.9733313322067261,
                        0.8835877180099487,
                        0.8914728760719299,
                        0.8912128210067749,
                        0.9746254086494446,
                        0.967387318611145,
                        0.9740164279937744,
                        0.9979002475738525,
                        0.9622870087623596
                    ]
                },
                "val": {
                    "pretrain_loss": 0.7411990761756897,
                    "features_accuracy": [
                        0.6989148855209351,
                        0.8644660711288452,
                        0.47505322098731995,
                        0.5050704479217529,
                        0.3927086293697357,
                        0.5569414496421814,
                        0.3743534982204437,
                        0.6961261630058289,
                        0.478196918964386,
                        0.6450157165527344,
                        0.9926984906196594,
                        0.38976776599884033,
                        0.49001115560531616,
                        0.655815839767456,
                        0.5894939303398132,
                        0.5911672115325928,
                        0.5992799997329712,
                        0.3775479197502136,
                        0.7311124205589294,
                        0.5720515251159668,
                        0.6404522657394409,
                        0.7370955944061279,
                        0.43996551632881165,
                        0.7066220045089722,
                        0.6715850234031677,
                        0.6662610173225403,
                        0.7276138067245483,
                        0.7383632063865662,
                        0.49325624108314514,
                        0.9828110337257385,
                        0.8942297697067261,
                        0.9926984906196594,
                        0.8579758405685425,
                        0.853412389755249,
                        0.844843327999115,
                        0.8578744530677795,
                        0.8620829582214355,
                        0.8452489376068115,
                        0.8675083518028259,
                        0.8493053317070007,
                        0.8681167960166931,
                        0.854020893573761,
                        0.711641788482666,
                        0.8490011096000671,
                        0.8582293391227722,
                        0.8610181212425232,
                        0.6589595079421997,
                        0.6429874897003174,
                        0.5149579048156738,
                        0.9961463809013367,
                        0.7169150710105896
                    ]
                },
                "test": {
                    "pretrain_loss": 0.42670321464538574,
                    "features_accuracy": [
                        0.7593306303024292,
                        0.6417849659919739,
                        0.7952332496643066,
                        0.8113590478897095,
                        0.7859026193618774,
                        0.8123224973678589,
                        0.7912778854370117,
                        0.8085699677467346,
                        0.8090263605117798,
                        0.7963488698005676,
                        0.9936105608940125,
                        0.7526369094848633,
                        0.7828600406646729,
                        0.8147565722465515,
                        0.7951825857162476,
                        0.8090770840644836,
                        0.7896551489830017,
                        0.8004564046859741,
                        0.7436612844467163,
                        0.7842799425125122,
                        0.8021298050880432,
                        0.7985801100730896,
                        0.8703854084014893,
                        0.6758113503456116,
                        0.7875760793685913,
                        0.8102940917015076,
                        0.7669371366500854,
                        0.7420385479927063,
                        0.7627789378166199,
                        0.9836714267730713,
                        0.8853955268859863,
                        0.9939655065536499,
                        0.8530933260917664,
                        0.8518255352973938,
                        0.8451318740844727,
                        0.8570486903190613,
                        0.8571500778198242,
                        0.8842292428016663,
                        0.8630831837654114,
                        0.8386917114257812,
                        0.8818965554237366,
                        0.8559330701828003,
                        0.7867646813392639,
                        0.8474645018577576,
                        0.8552738428115845,
                        0.8537525534629822,
                        0.8054766654968262,
                        0.8041074872016907,
                        0.7933570146560669,
                        0.9970081448554993,
                        0.7209432125091553
                    ]
                }
            }
        },
        "train": {
            "score": -3.679796587103216
        },
        "val": {
            "score": -5.271186794199675
        },
        "test": {
            "score": -5.535592716683219
        }
    },
    "best_iteration": 10000,
    "time": "0:04:23"
}
