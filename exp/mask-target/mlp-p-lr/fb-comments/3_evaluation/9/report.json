{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask_fast___88f334f0dee44fc782727ac73dc94e4f.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0,1",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                },
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 9,
        "data": {
            "path": "data/fb-comments",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512
                ],
                "dropout": 0.3165243883109578
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "positional",
                "linear",
                "relu"
            ],
            "d_num_embedding": 11,
            "positional_encoding": {
                "n": 35,
                "sigma": 0.3078928096197865,
                "trainable": true,
                "initialization": "normal"
            },
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 512,
            "lr": 0.00015569191898648328,
            "weight_decay": 0.0007948790593667655,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 1024
        },
        "pretrain": {
            "corrupt_probability": 0.7425803516231099,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.00015569191898648328,
            "weight_decay": 0.0007948790593667655,
            "patience": 2,
            "n_iterations": 100000,
            "validate_every": 10000,
            "replace_strategy": "target_shuffle",
            "n_neighbors": 20,
            "use_target": true,
            "early_stop_type": "pretrain",
            "target_injection_type": "post"
        },
        "bins": null
    },
    "n_parameters": 653715,
    "epoch_size": 308,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "pretrain_loss": 0.1633596569299698,
                    "features_accuracy": [
                        0.966124951839447,
                        0.779209315776825,
                        0.9639617800712585,
                        0.9677679538726807,
                        0.9254114031791687,
                        0.9688019752502441,
                        0.9665563106536865,
                        0.967450737953186,
                        0.9044646620750427,
                        0.9669052362442017,
                        0.9961494207382202,
                        0.9656618237495422,
                        0.9659282565116882,
                        0.9675649404525757,
                        0.9498724937438965,
                        0.9676854610443115,
                        0.9661820530891418,
                        0.9638094902038574,
                        0.965255856513977,
                        0.9235653877258301,
                        0.9672731161117554,
                        0.9431418776512146,
                        0.8848627805709839,
                        0.9361639022827148,
                        0.9341402649879456,
                        0.9366333484649658,
                        0.9548014998435974,
                        0.9622362852096558,
                        0.9631497859954834,
                        0.9855745434761047,
                        0.8781956434249878,
                        0.9960225820541382,
                        0.8887641429901123,
                        0.8828582167625427,
                        0.8795087933540344,
                        0.887412965297699,
                        0.8868420124053955,
                        0.8940039873123169,
                        0.8923102617263794,
                        0.8959071040153503,
                        0.8660284876823425,
                        0.8864677548408508,
                        0.9661566615104675,
                        0.8812532424926758,
                        0.8884660005569458,
                        0.8896903395652771,
                        0.9678313732147217,
                        0.9544716477394104,
                        0.966791033744812,
                        0.9972849488258362,
                        0.9626549482345581
                    ]
                },
                "val": {
                    "pretrain_loss": 0.5880907773971558,
                    "features_accuracy": [
                        0.7332927584648132,
                        0.8609167337417603,
                        0.7273603081703186,
                        0.7442957162857056,
                        0.3992495536804199,
                        0.7093093991279602,
                        0.683348536491394,
                        0.621995747089386,
                        0.4764222502708435,
                        0.7262954711914062,
                        0.9924956560134888,
                        0.7394280433654785,
                        0.6764526963233948,
                        0.7459689378738403,
                        0.6705709099769592,
                        0.7424703240394592,
                        0.43839365243911743,
                        0.7420646548271179,
                        0.73060542345047,
                        0.5386877655982971,
                        0.4600953161716461,
                        0.7316702008247375,
                        0.41435959935188293,
                        0.3433728814125061,
                        0.7348645925521851,
                        0.751140832901001,
                        0.6295507550239563,
                        0.7396815419197083,
                        0.374860554933548,
                        0.9845350384712219,
                        0.879525363445282,
                        0.992343544960022,
                        0.8606631755828857,
                        0.8541222810745239,
                        0.8443869352340698,
                        0.8607138991355896,
                        0.8532096147537231,
                        0.8516377210617065,
                        0.866037905216217,
                        0.8410404324531555,
                        0.8835310339927673,
                        0.8515870571136475,
                        0.7360815405845642,
                        0.8473278284072876,
                        0.8626914024353027,
                        0.8747084140777588,
                        0.7234560251235962,
                        0.40533414483070374,
                        0.7419125437736511,
                        0.9950816035270691,
                        0.7199066877365112
                    ]
                },
                "test": {
                    "pretrain_loss": 0.44572970271110535,
                    "features_accuracy": [
                        0.7416836023330688,
                        0.6392495036125183,
                        0.7413285970687866,
                        0.7424949407577515,
                        0.8038032650947571,
                        0.7861054539680481,
                        0.7471095323562622,
                        0.7849898338317871,
                        0.8176977634429932,
                        0.7797160148620605,
                        0.9933062791824341,
                        0.7386409640312195,
                        0.7571501135826111,
                        0.7517748475074768,
                        0.7679513096809387,
                        0.7714502811431885,
                        0.7597870230674744,
                        0.748275876045227,
                        0.7384888529777527,
                        0.8224138021469116,
                        0.7770283818244934,
                        0.7625253796577454,
                        0.8837221264839172,
                        0.6147565841674805,
                        0.7712474465370178,
                        0.8461460471153259,
                        0.7324036359786987,
                        0.743864119052887,
                        0.7740365266799927,
                        0.9832656979560852,
                        0.9033975601196289,
                        0.9932555556297302,
                        0.8460446000099182,
                        0.8506085276603699,
                        0.842190682888031,
                        0.8771805167198181,
                        0.8602434396743774,
                        0.8659736514091492,
                        0.862778902053833,
                        0.8646551966667175,
                        0.8870182633399963,
                        0.8587220907211304,
                        0.7586206793785095,
                        0.8457403779029846,
                        0.8625760674476624,
                        0.8525862097740173,
                        0.7718560099601746,
                        0.7626267671585083,
                        0.7497971653938293,
                        0.996653139591217,
                        0.7200304269790649
                    ]
                }
            },
            "20000": {
                "train": {
                    "pretrain_loss": 0.15369059145450592,
                    "features_accuracy": [
                        0.9689605236053467,
                        0.8038544058799744,
                        0.9690240025520325,
                        0.9711046814918518,
                        0.9369251132011414,
                        0.9713140726089478,
                        0.9723227024078369,
                        0.9714853167533875,
                        0.9169933795928955,
                        0.970654308795929,
                        0.9961811304092407,
                        0.9687765836715698,
                        0.9726208448410034,
                        0.9709968566894531,
                        0.9584047198295593,
                        0.9703307747840881,
                        0.9713013768196106,
                        0.9687638878822327,
                        0.9685799479484558,
                        0.9331379532814026,
                        0.970781147480011,
                        0.9473604559898376,
                        0.8857255578041077,
                        0.939037561416626,
                        0.9428184032440186,
                        0.9396782517433167,
                        0.9575673341751099,
                        0.965858519077301,
                        0.9662327766418457,
                        0.9855492115020752,
                        0.880466639995575,
                        0.9961811304092407,
                        0.8897981643676758,
                        0.884412407875061,
                        0.8811898231506348,
                        0.8891891837120056,
                        0.8868356943130493,
                        0.8943085074424744,
                        0.8919423222541809,
                        0.8957929015159607,
                        0.8673670291900635,
                        0.8866580724716187,
                        0.9715931415557861,
                        0.8814752697944641,
                        0.8896142244338989,
                        0.8905340433120728,
                        0.9728111624717712,
                        0.9604410529136658,
                        0.971383810043335,
                        0.997805118560791,
                        0.9622362852096558
                    ]
                },
                "val": {
                    "pretrain_loss": 0.6700862646102905,
                    "features_accuracy": [
                        0.7040360569953918,
                        0.8542236685752869,
                        0.3004259169101715,
                        0.6236183047294617,
                        0.3835310637950897,
                        0.6012067794799805,
                        0.6197646856307983,
                        0.5812290906906128,
                        0.47647297382354736,
                        0.7047966718673706,
                        0.9927492141723633,
                        0.7329885363578796,
                        0.47621944546699524,
                        0.7373491525650024,
                        0.6569820046424866,
                        0.7346110939979553,
                        0.5640908479690552,
                        0.6723455786705017,
                        0.4082750082015991,
                        0.5484230518341064,
                        0.7161545157432556,
                        0.7612310647964478,
                        0.4861575663089752,
                        0.42815127968788147,
                        0.7541831135749817,
                        0.7402899861335754,
                        0.6653483510017395,
                        0.739782989025116,
                        0.36497312784194946,
                        0.9831152558326721,
                        0.8962072730064392,
                        0.9924449324607849,
                        0.8588378429412842,
                        0.853412389755249,
                        0.8431193232536316,
                        0.8590913414955139,
                        0.8517898321151733,
                        0.8517898321151733,
                        0.8612209558486938,
                        0.8385559320449829,
                        0.8810465335845947,
                        0.8520433902740479,
                        0.7487577199935913,
                        0.8444376587867737,
                        0.861068844795227,
                        0.8636547923088074,
                        0.5687049627304077,
                        0.5933474898338318,
                        0.4678531587123871,
                        0.9957407712936401,
                        0.7197038531303406
                    ]
                },
                "test": {
                    "pretrain_loss": 0.429243266582489,
                    "features_accuracy": [
                        0.7417849898338318,
                        0.6451318264007568,
                        0.76997971534729,
                        0.7786511182785034,
                        0.7925456166267395,
                        0.7881338596343994,
                        0.7721095085144043,
                        0.8044624924659729,
                        0.822210967540741,
                        0.7992900609970093,
                        0.9937626719474792,
                        0.7457910776138306,
                        0.7946247458457947,
                        0.7766227126121521,
                        0.8020284175872803,
                        0.7783975601196289,
                        0.7870182394981384,
                        0.7852433919906616,
                        0.7485294342041016,
                        0.7972109317779541,
                        0.7825050950050354,
                        0.778296172618866,
                        0.862170398235321,
                        0.6515213251113892,
                        0.7913286089897156,
                        0.8545131683349609,
                        0.7594320774078369,
                        0.743864119052887,
                        0.76719069480896,
                        0.9826571941375732,
                        0.9017241597175598,
                        0.9935091137886047,
                        0.8508113622665405,
                        0.851673424243927,
                        0.8438640832901001,
                        0.8570486903190613,
                        0.8751521110534668,
                        0.8692190647125244,
                        0.8628296256065369,
                        0.863894522190094,
                        0.8893508911132812,
                        0.8582150340080261,
                        0.7836713790893555,
                        0.8709431886672974,
                        0.8621196746826172,
                        0.8525354862213135,
                        0.8126775026321411,
                        0.7869168519973755,
                        0.7837728261947632,
                        0.9968559741973877,
                        0.7202839851379395
                    ]
                }
            },
            "30000": {
                "train": {
                    "pretrain_loss": 0.14936833083629608,
                    "features_accuracy": [
                        0.9704639911651611,
                        0.8184511661529541,
                        0.9710666537284851,
                        0.9723607301712036,
                        0.9443598985671997,
                        0.9727730751037598,
                        0.9727540612220764,
                        0.9727350473403931,
                        0.9299344420433044,
                        0.9732615351676941,
                        0.9963270425796509,
                        0.9704766869544983,
                        0.9727667570114136,
                        0.9729189872741699,
                        0.9620586633682251,
                        0.9721387028694153,
                        0.9730014801025391,
                        0.9707431197166443,
                        0.9698867201805115,
                        0.9360941052436829,
                        0.9728047847747803,
                        0.9501960277557373,
                        0.8869118094444275,
                        0.9414037466049194,
                        0.9464596509933472,
                        0.9416384696960449,
                        0.9580367803573608,
                        0.9652875661849976,
                        0.968256413936615,
                        0.9860503673553467,
                        0.8801494836807251,
                        0.9963270425796509,
                        0.8897347450256348,
                        0.8843172788619995,
                        0.8814562559127808,
                        0.8881805539131165,
                        0.8888212442398071,
                        0.8941943049430847,
                        0.8918154239654541,
                        0.89694744348526,
                        0.8676270842552185,
                        0.8879204392433167,
                        0.9725003242492676,
                        0.8818876147270203,
                        0.8898552656173706,
                        0.8923292756080627,
                        0.9731537103652954,
                        0.9650845527648926,
                        0.9728618860244751,
                        0.9977607131004333,
                        0.9630355834960938
                    ]
                },
                "val": {
                    "pretrain_loss": 0.7332424521446228,
                    "features_accuracy": [
                        0.4070073962211609,
                        0.8601561188697815,
                        0.3712098002433777,
                        0.7134164571762085,
                        0.41344690322875977,
                        0.6638779044151306,
                        0.7142277359962463,
                        0.5429469347000122,
                        0.4458472728729248,
                        0.48103639483451843,
                        0.9928506016731262,
                        0.5768177509307861,
                        0.34808841347694397,
                        0.6930838227272034,
                        0.6475509405136108,
                        0.6673257946968079,
                        0.2514957785606384,
                        0.4904167652130127,
                        0.6702666878700256,
                        0.5588175654411316,
                        0.684869647026062,
                        0.6548017263412476,
                        0.49878308176994324,
                        0.674170970916748,
                        0.739782989025116,
                        0.7488591074943542,
                        0.7085995078086853,
                        0.7398843765258789,
                        0.36948585510253906,
                        0.9828617572784424,
                        0.8988438844680786,
                        0.9924956560134888,
                        0.8569110631942749,
                        0.8520433902740479,
                        0.843575656414032,
                        0.8607646226882935,
                        0.8510292768478394,
                        0.8524489998817444,
                        0.8617280125617981,
                        0.835006594657898,
                        0.8753675818443298,
                        0.8517898321151733,
                        0.7509379982948303,
                        0.8444376587867737,
                        0.8614744544029236,
                        0.8602575659751892,
                        0.410506010055542,
                        0.5936010479927063,
                        0.4479261636734009,
                        0.9959942698478699,
                        0.7202109098434448
                    ]
                },
                "test": {
                    "pretrain_loss": 0.4264155626296997,
                    "features_accuracy": [
                        0.7597362995147705,
                        0.6452332735061646,
                        0.7863590121269226,
                        0.7757099270820618,
                        0.7870182394981384,
                        0.7819979786872864,
                        0.7841784954071045,
                        0.8096348643302917,
                        0.8146551847457886,
                        0.8114097118377686,
                        0.9936612844467163,
                        0.7603448033332825,
                        0.781085193157196,
                        0.7943711876869202,
                        0.8061866164207458,
                        0.7862576246261597,
                        0.7937626838684082,
                        0.7935091257095337,
                        0.7456389665603638,
                        0.7936612367630005,
                        0.7936105728149414,
                        0.7796652913093567,
                        0.870537519454956,
                        0.6765720248222351,
                        0.801622748374939,
                        0.863286018371582,
                        0.7831135988235474,
                        0.743864119052887,
                        0.7727687954902649,
                        0.9824543595314026,
                        0.9030426144599915,
                        0.9936105608940125,
                        0.815010130405426,
                        0.852789044380188,
                        0.842799186706543,
                        0.8622211217880249,
                        0.8616125583648682,
                        0.8701825737953186,
                        0.8667849898338318,
                        0.841582179069519,
                        0.8885902762413025,
                        0.8713995814323425,
                        0.7951825857162476,
                        0.8670385479927063,
                        0.8573022484779358,
                        0.8527383208274841,
                        0.8098377585411072,
                        0.7852433919906616,
                        0.7919878363609314,
                        0.9968559741973877,
                        0.7200304269790649
                    ]
                }
            },
            "40000": {
                "train": {
                    "pretrain_loss": 0.14561642706394196,
                    "features_accuracy": [
                        0.9706733226776123,
                        0.8290196657180786,
                        0.9730014801025391,
                        0.9741750359535217,
                        0.949104905128479,
                        0.9748347401618958,
                        0.9732552170753479,
                        0.9741242527961731,
                        0.937775194644928,
                        0.9737436771392822,
                        0.9965871572494507,
                        0.9729697108268738,
                        0.9730204939842224,
                        0.9747205972671509,
                        0.9658268094062805,
                        0.9737753868103027,
                        0.9739022254943848,
                        0.9728364944458008,
                        0.9713521003723145,
                        0.9427105188369751,
                        0.9744477868080139,
                        0.950969934463501,
                        0.8870323300361633,
                        0.9439665675163269,
                        0.946979820728302,
                        0.9427168965339661,
                        0.9589439034461975,
                        0.9666388034820557,
                        0.968522846698761,
                        0.985872745513916,
                        0.8811390995979309,
                        0.996536374092102,
                        0.8909209966659546,
                        0.887140154838562,
                        0.8833022713661194,
                        0.8904579281806946,
                        0.8895761370658875,
                        0.8958626985549927,
                        0.8929255604743958,
                        0.8973090648651123,
                        0.8685786724090576,
                        0.8897156715393066,
                        0.9728491902351379,
                        0.8822999596595764,
                        0.8892589807510376,
                        0.8923355937004089,
                        0.9749679565429688,
                        0.9674951434135437,
                        0.9745936989784241,
                        0.9981603622436523,
                        0.9624646306037903
                    ]
                },
                "val": {
                    "pretrain_loss": 0.7651659846305847,
                    "features_accuracy": [
                        0.4808335602283478,
                        0.8582800626754761,
                        0.5842206478118896,
                        0.6360916495323181,
                        0.4151201546192169,
                        0.6733089685440063,
                        0.710881233215332,
                        0.5491329431533813,
                        0.479920893907547,
                        0.499695748090744,
                        0.9927998781204224,
                        0.3158908784389496,
                        0.40153127908706665,
                        0.664334237575531,
                        0.6376128196716309,
                        0.6529256701469421,
                        0.25453805923461914,
                        0.3611702620983124,
                        0.6717878580093384,
                        0.5668796300888062,
                        0.6741202473640442,
                        0.5915221571922302,
                        0.5347327589988708,
                        0.7770509719848633,
                        0.7235574126243591,
                        0.7475407719612122,
                        0.7019571661949158,
                        0.7398843765258789,
                        0.3740999698638916,
                        0.9831152558326721,
                        0.8944832682609558,
                        0.9923942685127258,
                        0.8570124506950378,
                        0.8524997234344482,
                        0.8450968265533447,
                        0.86117023229599,
                        0.8530067801475525,
                        0.8423080444335938,
                        0.8614237904548645,
                        0.7656931281089783,
                        0.8687252402305603,
                        0.8522462248802185,
                        0.7314673662185669,
                        0.8451475501060486,
                        0.8667477965354919,
                        0.8675590753555298,
                        0.638322651386261,
                        0.5254538059234619,
                        0.4728222191333771,
                        0.9956900477409363,
                        0.7202616333961487
                    ]
                },
                "test": {
                    "pretrain_loss": 0.4253183603286743,
                    "features_accuracy": [
                        0.7567951083183289,
                        0.6453853845596313,
                        0.7920892238616943,
                        0.7926977872848511,
                        0.7880831956863403,
                        0.793914794921875,
                        0.7738843560218811,
                        0.804411768913269,
                        0.8164807558059692,
                        0.8137423992156982,
                        0.9936612844467163,
                        0.7709432244300842,
                        0.7843306064605713,
                        0.7913286089897156,
                        0.8009127974510193,
                        0.7909736633300781,
                        0.7875760793685913,
                        0.7953854203224182,
                        0.7484279870986938,
                        0.8074036836624146,
                        0.8083164095878601,
                        0.8014705777168274,
                        0.8606997728347778,
                        0.7112069129943848,
                        0.7876268029212952,
                        0.8675456643104553,
                        0.7929006218910217,
                        0.743864119052887,
                        0.7552738189697266,
                        0.9825558066368103,
                        0.8978701829910278,
                        0.9936105608940125,
                        0.8312373161315918,
                        0.8531947135925293,
                        0.8434584140777588,
                        0.8587728142738342,
                        0.8606491088867188,
                        0.8746450543403625,
                        0.8654158115386963,
                        0.8466024398803711,
                        0.8834685683250427,
                        0.874492883682251,
                        0.7910750508308411,
                        0.8654665350914001,
                        0.8730730414390564,
                        0.8541582226753235,
                        0.8005577921867371,
                        0.7930020093917847,
                        0.7908722162246704,
                        0.9969574213027954,
                        0.720537543296814
                    ]
                }
            }
        },
        "train": {
            "score": -3.4322645428769647
        },
        "val": {
            "score": -5.28172070120041
        },
        "test": {
            "score": -5.5528143419649485
        }
    },
    "best_iteration": 10000,
    "time": "0:04:30"
}
