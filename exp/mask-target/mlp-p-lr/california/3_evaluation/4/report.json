{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask___5d05b070fa82407d9a53cee3dca54d05.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 4,
        "data": {
            "path": "data/california",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512,
                    512,
                    512,
                    512,
                    512
                ],
                "dropout": 0.0
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "positional",
                "linear",
                "relu"
            ],
            "d_num_embedding": 81,
            "positional_encoding": {
                "n": 117,
                "sigma": 0.0645046613804462,
                "trainable": true,
                "initialization": "normal"
            },
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 128,
            "lr": 0.00021816479301146112,
            "weight_decay": 0.00015166267854399025,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.4879106004758035,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.00021816479301146112,
            "weight_decay": 0.00015166267854399025,
            "patience": 2,
            "n_iterations": 100000,
            "finetune_every": 10000,
            "replace_strategy": "target_shuffle",
            "n_neighbors": 20,
            "use_target": true,
            "target_injection_type": "post"
        },
        "bins": null
    },
    "epoch_size": 104,
    "n_parameters": 1803400,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -0.36321397195681376,
                    "pretrain_loss": 0.61956787109375,
                    "features_accuracy": [
                        0.7300325632095337,
                        0.5266863703727722,
                        0.6454690098762512,
                        0.5390264391899109,
                        0.5186615586280823,
                        0.6075403094291687,
                        0.7088348865509033,
                        0.7334393262863159
                    ]
                },
                "val": {
                    "score": -0.4616627006892429,
                    "pretrain_loss": 0.6313600540161133,
                    "features_accuracy": [
                        0.7051165699958801,
                        0.5225552320480347,
                        0.6321525573730469,
                        0.5216469764709473,
                        0.5040872097015381,
                        0.6100514531135559,
                        0.6878595352172852,
                        0.7263094186782837
                    ]
                },
                "test": {
                    "score": -0.45943597114043366,
                    "pretrain_loss": 0.6293327212333679,
                    "features_accuracy": [
                        0.7139050364494324,
                        0.5397287011146545,
                        0.6363856792449951,
                        0.536579430103302,
                        0.5123546719551086,
                        0.6017441749572754,
                        0.707848846912384,
                        0.7175387740135193
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -0.3665653577837826,
                    "pretrain_loss": 0.5995047092437744,
                    "features_accuracy": [
                        0.7324551939964294,
                        0.5964115858078003,
                        0.6658339500427246,
                        0.5611326098442078,
                        0.5367552638053894,
                        0.6233628988265991,
                        0.7407827973365784,
                        0.7525172233581543
                    ]
                },
                "val": {
                    "score": -0.45591024217201465,
                    "pretrain_loss": 0.6219170093536377,
                    "features_accuracy": [
                        0.7202543020248413,
                        0.5815925002098083,
                        0.6333636045455933,
                        0.5349681973457336,
                        0.5143808722496033,
                        0.6185286045074463,
                        0.7172267436981201,
                        0.7502270340919495
                    ]
                },
                "test": {
                    "score": -0.4426525303745846,
                    "pretrain_loss": 0.6139222383499146,
                    "features_accuracy": [
                        0.7165697813034058,
                        0.588178277015686,
                        0.6419573426246643,
                        0.5564438104629517,
                        0.5218023061752319,
                        0.6131298542022705,
                        0.7342538833618164,
                        0.7437015771865845
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -0.340370524427482,
                    "pretrain_loss": 0.5859536528587341,
                    "features_accuracy": [
                        0.7392687201499939,
                        0.6165493726730347,
                        0.676659882068634,
                        0.5722613334655762,
                        0.558180034160614,
                        0.6292679309844971,
                        0.7520630359649658,
                        0.7639488577842712
                    ]
                },
                "val": {
                    "score": -0.45012631928680363,
                    "pretrain_loss": 0.6219016313552856,
                    "features_accuracy": [
                        0.7238873839378357,
                        0.5879503488540649,
                        0.6424462795257568,
                        0.5307296514511108,
                        0.5322434306144714,
                        0.6200423836708069,
                        0.7266121506690979,
                        0.7456857562065125
                    ]
                },
                "test": {
                    "score": -0.432959773417325,
                    "pretrain_loss": 0.6075848937034607,
                    "features_accuracy": [
                        0.7223837375640869,
                        0.6017441749572754,
                        0.6552810072898865,
                        0.5528100728988647,
                        0.538759708404541,
                        0.6138566136360168,
                        0.7383720874786377,
                        0.7453972697257996
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -0.32229680419624,
                    "pretrain_loss": 0.5775654315948486,
                    "features_accuracy": [
                        0.7460822463035583,
                        0.6186690926551819,
                        0.6837762594223022,
                        0.5836929678916931,
                        0.570141613483429,
                        0.6374441981315613,
                        0.7633432149887085,
                        0.7725793123245239
                    ]
                },
                "val": {
                    "score": -0.44265384533409563,
                    "pretrain_loss": 0.6241031289100647,
                    "features_accuracy": [
                        0.7199515700340271,
                        0.5930972099304199,
                        0.6457765698432922,
                        0.5392068028450012,
                        0.5401150584220886,
                        0.6200423836708069,
                        0.7305479645729065,
                        0.7532545924186707
                    ]
                },
                "test": {
                    "score": -0.42723720686362576,
                    "pretrain_loss": 0.6046562194824219,
                    "features_accuracy": [
                        0.7211724519729614,
                        0.5981104373931885,
                        0.6557654738426208,
                        0.5646802186965942,
                        0.5438469052314758,
                        0.6162790656089783,
                        0.7412790656089783,
                        0.7550871968269348
                    ]
                }
            },
            "50000": {
                "train": {
                    "score": -0.3129479342667858,
                    "pretrain_loss": 0.5700879693031311,
                    "features_accuracy": [
                        0.7503975033760071,
                        0.633507490158081,
                        0.6791581511497498,
                        0.5910364389419556,
                        0.5828601717948914,
                        0.6431978344917297,
                        0.7702324390411377,
                        0.7861306667327881
                    ]
                },
                "val": {
                    "score": -0.43448368065353665,
                    "pretrain_loss": 0.6184080243110657,
                    "features_accuracy": [
                        0.7199515700340271,
                        0.5894641280174255,
                        0.6436572670936584,
                        0.5398122668266296,
                        0.538298487663269,
                        0.6239781975746155,
                        0.7375113368034363,
                        0.7638510465621948
                    ]
                },
                "test": {
                    "score": -0.42394378961834994,
                    "pretrain_loss": 0.6025450229644775,
                    "features_accuracy": [
                        0.7216569781303406,
                        0.6056201457977295,
                        0.659641444683075,
                        0.5799418687820435,
                        0.5501453280448914,
                        0.6153100728988647,
                        0.7453972697257996,
                        0.7599321603775024
                    ]
                }
            },
            "60000": {
                "train": {
                    "score": -0.30590398753499387,
                    "pretrain_loss": 0.561652421951294,
                    "features_accuracy": [
                        0.7513059377670288,
                        0.635930061340332,
                        0.6961920261383057,
                        0.5990612506866455,
                        0.5855855941772461,
                        0.6547808647155762,
                        0.7743205428123474,
                        0.793322741985321
                    ]
                },
                "val": {
                    "score": -0.4385392414207257,
                    "pretrain_loss": 0.6156894564628601,
                    "features_accuracy": [
                        0.7154102325439453,
                        0.5933999419212341,
                        0.6457765698432922,
                        0.5389040112495422,
                        0.541023313999176,
                        0.630638837814331,
                        0.7459884881973267,
                        0.76203453540802
                    ]
                },
                "test": {
                    "score": -0.42450071613049384,
                    "pretrain_loss": 0.6009490489959717,
                    "features_accuracy": [
                        0.731589138507843,
                        0.6051356792449951,
                        0.6555232405662537,
                        0.5646802186965942,
                        0.5617732405662537,
                        0.6167635917663574,
                        0.7449128031730652,
                        0.7633236646652222
                    ]
                }
            },
            "70000": {
                "train": {
                    "score": -0.29279668469659603,
                    "pretrain_loss": 0.5820807814598083,
                    "features_accuracy": [
                        0.7305625081062317,
                        0.6189719438552856,
                        0.672950267791748,
                        0.5789991617202759,
                        0.5739268660545349,
                        0.6351730227470398,
                        0.75493985414505,
                        0.7755318880081177
                    ]
                },
                "val": {
                    "score": -0.4366934603698838,
                    "pretrain_loss": 0.6153867244720459,
                    "features_accuracy": [
                        0.7093551158905029,
                        0.5864365696907043,
                        0.6460793018341064,
                        0.54828941822052,
                        0.5340599417686462,
                        0.6270057559013367,
                        0.7438691854476929,
                        0.7650620341300964
                    ]
                },
                "test": {
                    "score": -0.4275958392140533,
                    "pretrain_loss": 0.5967753529548645,
                    "features_accuracy": [
                        0.7284399271011353,
                        0.617490291595459,
                        0.663517415523529,
                        0.5750969052314758,
                        0.557170569896698,
                        0.6157945990562439,
                        0.7507267594337463,
                        0.7693798542022705
                    ]
                }
            },
            "80000": {
                "train": {
                    "score": -0.32114119071654473,
                    "pretrain_loss": 0.5736820697784424,
                    "features_accuracy": [
                        0.7373003363609314,
                        0.6152623295783997,
                        0.6824135184288025,
                        0.5799833536148071,
                        0.5796805620193481,
                        0.6474373936653137,
                        0.7717465758323669,
                        0.7763646245002747
                    ]
                },
                "val": {
                    "score": -0.43640474497369725,
                    "pretrain_loss": 0.6127251982688904,
                    "features_accuracy": [
                        0.7154102325439453,
                        0.5964275002479553,
                        0.6442627906799316,
                        0.5479866862297058,
                        0.535876452922821,
                        0.6185286045074463,
                        0.7435664534568787,
                        0.766878604888916
                    ]
                },
                "test": {
                    "score": -0.42245999607238555,
                    "pretrain_loss": 0.5985762476921082,
                    "features_accuracy": [
                        0.7248061895370483,
                        0.6053779125213623,
                        0.6560077667236328,
                        0.5687984228134155,
                        0.5499030947685242,
                        0.6252422332763672,
                        0.744428277015686,
                        0.7681686282157898
                    ]
                }
            }
        },
        "train": {
            "score": -0.3129479342667858
        },
        "val": {
            "score": -0.43448368065353665
        },
        "test": {
            "score": -0.42394378961834994
        }
    },
    "best_iteration": 50000,
    "time": "0:08:32"
}
