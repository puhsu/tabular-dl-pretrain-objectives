{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/tune.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 0,
        "program": "bin/pretrain_mask.py",
        "base_config": {
            "seed": 0,
            "data": {
                "T_cache": true,
                "path": "data/adult_roc",
                "T": {
                    "normalization": "quantile"
                }
            },
            "model": {
                "kind": "mlp",
                "num_embedding_arch": [
                    "linear",
                    "relu"
                ]
            },
            "training": {
                "batch_size": 256,
                "patience": 16
            },
            "pretrain": {
                "corrupt_strategy": "resample",
                "patience": 2,
                "d_hidden_head": 512,
                "replace_strategy": "target_shuffle",
                "use_target": true
            }
        },
        "space": {
            "model": {
                "d_num_embedding": [
                    "int",
                    1,
                    128
                ],
                "config": {
                    "d_layers": [
                        "$fixed_mlp_d_layers",
                        1,
                        8,
                        512
                    ],
                    "dropout": [
                        "?uniform",
                        0.0,
                        0.0,
                        0.5
                    ]
                }
            },
            "pretrain": {
                "corrupt_probability": [
                    "uniform",
                    0.2,
                    0.8
                ]
            },
            "training": {
                "lr": [
                    "loguniform",
                    5e-05,
                    0.005
                ],
                "weight_decay": [
                    "?loguniform",
                    0.0,
                    1e-06,
                    0.001
                ]
            },
            "bins": {
                "count": [
                    "int",
                    2,
                    256
                ],
                "tree": {
                    "min_samples_leaf": [
                        "int",
                        1,
                        128
                    ],
                    "min_impurity_decrease": [
                        "loguniform",
                        1e-09,
                        0.01
                    ]
                }
            }
        },
        "n_trials": 100,
        "timeout": null,
        "sampler": {
            "seed": 0
        }
    },
    "best": {
        "program": "bin/pretrain_mask.py",
        "environment": {
            "CUDA_VISIBLE_DEVICES": "0",
            "gpus": {
                "driver": "450.119.04",
                "devices": [
                    {
                        "name": "A100-SXM-80GB",
                        "memory_total": 85199093760,
                        "memory_free": 85195948032,
                        "memory_used": 3145728,
                        "utilization": 0
                    }
                ]
            },
            "torch.version.cuda": "11.1",
            "torch.backends.cudnn.version()": 8005,
            "torch.cuda.nccl.version()": [
                2,
                10,
                3
            ]
        },
        "config": {
            "seed": 0,
            "data": {
                "path": "data/adult_roc",
                "T": {
                    "seed": 0,
                    "normalization": "quantile",
                    "num_nan_policy": null,
                    "cat_nan_policy": null,
                    "cat_min_frequency": null,
                    "cat_encoding": null,
                    "y_policy": "default"
                },
                "T_cache": true
            },
            "model": {
                "kind": "mlp",
                "config": {
                    "d_layers": [
                        512,
                        512
                    ],
                    "dropout": 0.4109582839485935
                },
                "default": true,
                "checkpoint": null,
                "num_embedding_arch": [
                    "linear",
                    "relu"
                ],
                "d_num_embedding": 118,
                "positional_encoding": null,
                "d_cat_embedding": null
            },
            "training": {
                "batch_size": 256,
                "lr": 0.0007446455726892904,
                "weight_decay": 2.2783649837215467e-05,
                "optimizer": "AdamW",
                "patience": 16,
                "n_epochs": Infinity,
                "eval_batch_size": 8192
            },
            "pretrain": {
                "corrupt_probability": 0.6158632236794572,
                "corrupt_strategy": "resample",
                "d_hidden_head": 512,
                "lr": 0.0007446455726892904,
                "weight_decay": 2.2783649837215467e-05,
                "patience": 2,
                "n_iterations": 100000,
                "finetune_every": 10000,
                "replace_strategy": "target_shuffle",
                "n_neighbors": 20,
                "use_target": true,
                "target_injection_type": "post"
            },
            "bins": {
                "count": 70,
                "value": "ratio",
                "tree": {
                    "min_samples_leaf": 15,
                    "min_impurity_decrease": 7.912381608348969e-08
                },
                "subsample": null
            }
        },
        "epoch_size": 102,
        "n_parameters": 998506,
        "metrics": {
            "iteration_scores": {
                "10000": {
                    "train": {
                        "score": 0.9383782643210532,
                        "pretrain_loss": 0.4382171630859375,
                        "features_accuracy": [
                            0.6928746700286865,
                            0.6206618547439575,
                            0.7512285113334656,
                            0.9527027010917664,
                            0.9700552821159363,
                            0.6974048018455505,
                            0.779407262802124,
                            0.7520346641540527,
                            0.7944563627243042,
                            0.6992859244346619,
                            0.7889280915260315,
                            0.8791077733039856,
                            0.7819026112556458,
                            0.9151566028594971
                        ]
                    },
                    "val": {
                        "score": 0.9309517575988939,
                        "pretrain_loss": 0.4420677125453949,
                        "features_accuracy": [
                            0.6913864612579346,
                            0.6172270774841309,
                            0.7431291341781616,
                            0.9557807445526123,
                            0.9709811210632324,
                            0.7159526944160461,
                            0.7701520323753357,
                            0.7526485323905945,
                            0.788730263710022,
                            0.6958391070365906,
                            0.7844311594963074,
                            0.8834638595581055,
                            0.776140034198761,
                            0.9103331565856934
                        ]
                    },
                    "test": {
                        "score": 0.9277385514399265,
                        "pretrain_loss": 0.44014155864715576,
                        "features_accuracy": [
                            0.6900067925453186,
                            0.6129844784736633,
                            0.7494011521339417,
                            0.9533812999725342,
                            0.9707021117210388,
                            0.6978687047958374,
                            0.775382399559021,
                            0.7557275891304016,
                            0.7876666188240051,
                            0.6893925666809082,
                            0.7885265350341797,
                            0.8782630562782288,
                            0.7774707078933716,
                            0.9178797602653503
                        ]
                    }
                },
                "20000": {
                    "train": {
                        "score": 0.9435188272013605,
                        "pretrain_loss": 0.43815699219703674,
                        "features_accuracy": [
                            0.6963682174682617,
                            0.6147112846374512,
                            0.7496928572654724,
                            0.9536624550819397,
                            0.9717444777488708,
                            0.6962146759033203,
                            0.7739173769950867,
                            0.7551443576812744,
                            0.7887361645698547,
                            0.6945638656616211,
                            0.7864711284637451,
                            0.8794149160385132,
                            0.7822097539901733,
                            0.9152717590332031
                        ]
                    },
                    "val": {
                        "score": 0.9326813700707784,
                        "pretrain_loss": 0.4403897523880005,
                        "features_accuracy": [
                            0.6944572329521179,
                            0.6172270774841309,
                            0.7415937185287476,
                            0.9560878276824951,
                            0.9714417457580566,
                            0.7128819227218628,
                            0.7739905118942261,
                            0.7544910311698914,
                            0.7918010354042053,
                            0.6889298558235168,
                            0.7865806818008423,
                            0.8845385909080505,
                            0.7735298871994019,
                            0.9112544059753418
                        ]
                    },
                    "test": {
                        "score": 0.9284520379608912,
                        "pretrain_loss": 0.43857449293136597,
                        "features_accuracy": [
                            0.6963946223258972,
                            0.6129844784736633,
                            0.7533321380615234,
                            0.9534426927566528,
                            0.9710091948509216,
                            0.6987900137901306,
                            0.7754437923431396,
                            0.7562189102172852,
                            0.7880351543426514,
                            0.6887783408164978,
                            0.7880351543426514,
                            0.8787544369697571,
                            0.7781463265419006,
                            0.9175112247467041
                        ]
                    }
                },
                "30000": {
                    "train": {
                        "score": 0.9447491033250482,
                        "pretrain_loss": 0.43455058336257935,
                        "features_accuracy": [
                            0.6994010806083679,
                            0.6149800419807434,
                            0.7564112544059753,
                            0.9535089135169983,
                            0.9710918068885803,
                            0.7016277313232422,
                            0.7807509303092957,
                            0.7558353543281555,
                            0.7910012006759644,
                            0.6986716985702515,
                            0.7892352342605591,
                            0.8793381452560425,
                            0.7878147959709167,
                            0.9172680974006653
                        ]
                    },
                    "val": {
                        "score": 0.9318184983801407,
                        "pretrain_loss": 0.4384292960166931,
                        "features_accuracy": [
                            0.6966068148612976,
                            0.6172270774841309,
                            0.7472746968269348,
                            0.9560878276824951,
                            0.9714417457580566,
                            0.7138031721115112,
                            0.7699984908103943,
                            0.7563334703445435,
                            0.7891908288002014,
                            0.6981421709060669,
                            0.785045325756073,
                            0.8845385909080505,
                            0.7775219082832336,
                            0.9101796746253967
                        ]
                    },
                    "test": {
                        "score": 0.9283549757752272,
                        "pretrain_loss": 0.4375442564487457,
                        "features_accuracy": [
                            0.6980530023574829,
                            0.6129844784736633,
                            0.7506296038627625,
                            0.953688383102417,
                            0.9708863496780396,
                            0.7003255486488342,
                            0.7758123278617859,
                            0.7570174336433411,
                            0.7898778319358826,
                            0.6954118609428406,
                            0.7909219861030579,
                            0.8780787587165833,
                            0.7791290879249573,
                            0.9176340699195862
                        ]
                    }
                },
                "40000": {
                    "train": {
                        "score": 0.9431254329201282,
                        "pretrain_loss": 0.43657007813453674,
                        "features_accuracy": [
                            0.6983261704444885,
                            0.6105266809463501,
                            0.753685474395752,
                            0.9513206481933594,
                            0.9725122451782227,
                            0.6971360445022583,
                            0.7766430974006653,
                            0.7523801922798157,
                            0.7891968488693237,
                            0.696291446685791,
                            0.7878147959709167,
                            0.8772650361061096,
                            0.783553421497345,
                            0.9149646759033203
                        ]
                    },
                    "val": {
                        "score": 0.9323392779761045,
                        "pretrain_loss": 0.43850016593933105,
                        "features_accuracy": [
                            0.7019806504249573,
                            0.6172270774841309,
                            0.7491171360015869,
                            0.9560878276824951,
                            0.9714417457580566,
                            0.7153385281562805,
                            0.7701520323753357,
                            0.7567940950393677,
                            0.7911868691444397,
                            0.6995240449905396,
                            0.785045325756073,
                            0.8834638595581055,
                            0.7770612835884094,
                            0.9111008644104004
                        ]
                    },
                    "test": {
                        "score": 0.9287233604342163,
                        "pretrain_loss": 0.43738436698913574,
                        "features_accuracy": [
                            0.6995270848274231,
                            0.6129844784736633,
                            0.7517352104187012,
                            0.9537498354911804,
                            0.9710705876350403,
                            0.7000798583030701,
                            0.7775321006774902,
                            0.7575088143348694,
                            0.7881579995155334,
                            0.6954732537269592,
                            0.7894478440284729,
                            0.8779559135437012,
                            0.7790062427520752,
                            0.9172041416168213
                        ]
                    }
                },
                "50000": {
                    "train": {
                        "score": 0.9434276089023996,
                        "pretrain_loss": 0.4340898096561432,
                        "features_accuracy": [
                            0.7027794718742371,
                            0.6071099638938904,
                            0.7584075331687927,
                            0.9529330134391785,
                            0.9714757204055786,
                            0.7019732594490051,
                            0.7765279412269592,
                            0.7570254802703857,
                            0.789926290512085,
                            0.6997082233428955,
                            0.7876996397972107,
                            0.8809505105018616,
                            0.7833231091499329,
                            0.9152717590332031
                        ]
                    },
                    "val": {
                        "score": 0.9323091635541981,
                        "pretrain_loss": 0.4381958842277527,
                        "features_accuracy": [
                            0.6972209215164185,
                            0.6172270774841309,
                            0.7485029697418213,
                            0.9562413692474365,
                            0.9714417457580566,
                            0.713342547416687,
                            0.7759864926338196,
                            0.7558728456497192,
                            0.7908797860145569,
                            0.6964532732963562,
                            0.7891908288002014,
                            0.8830032348632812,
                            0.7787501811981201,
                            0.911715030670166
                        ]
                    },
                    "test": {
                        "score": 0.9287564498156927,
                        "pretrain_loss": 0.4369266927242279,
                        "features_accuracy": [
                            0.6976844668388367,
                            0.6129844784736633,
                            0.7538849115371704,
                            0.9537498354911804,
                            0.9710091948509216,
                            0.7002641558647156,
                            0.7758737802505493,
                            0.7567102909088135,
                            0.7900006771087646,
                            0.6947976350784302,
                            0.7906148433685303,
                            0.8780787587165833,
                            0.7793747782707214,
                            0.91830974817276
                        ]
                    }
                }
            },
            "train": {
                "score": 0.9435188272013605
            },
            "val": {
                "score": 0.9326813700707784
            },
            "test": {
                "score": 0.9284520379608912
            }
        },
        "best_iteration": 20000,
        "time": "0:05:17",
        "trial_id": 26,
        "tuning_time": "5:03:12"
    },
    "time": "17:33:57"
}
