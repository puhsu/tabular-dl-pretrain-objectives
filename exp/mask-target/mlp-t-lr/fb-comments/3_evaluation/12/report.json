{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask___678e69ba6e7f43b6b1a7780c837f4a2b.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 12,
        "data": {
            "path": "data/fb-comments",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512
                ],
                "dropout": 0.27051204110517374
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear",
                "relu"
            ],
            "d_num_embedding": 86,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 512,
            "lr": 0.0010389025799681128,
            "weight_decay": 1.2066026259918022e-06,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.5702245024053401,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.0010389025799681128,
            "weight_decay": 1.2066026259918022e-06,
            "patience": 2,
            "n_iterations": 100000,
            "finetune_every": 10000,
            "replace_strategy": "target_shuffle",
            "n_neighbors": 20,
            "use_target": true,
            "target_injection_type": "post"
        },
        "bins": {
            "count": 246,
            "value": "ratio",
            "tree": {
                "min_samples_leaf": 51,
                "min_impurity_decrease": 0.0007608440657744265
            },
            "subsample": null
        }
    },
    "epoch_size": 308,
    "n_parameters": 2631815,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -4.193669418195815,
                    "pretrain_loss": 0.13124637305736542,
                    "features_accuracy": [
                        0.9507352709770203,
                        0.8842728734016418,
                        0.9544906616210938,
                        0.9615448117256165,
                        0.9588868618011475,
                        0.9601872563362122,
                        0.9570091366767883,
                        0.9576879143714905,
                        0.947645902633667,
                        0.9614560008049011,
                        0.9971580505371094,
                        0.9524543881416321,
                        0.9564445614814758,
                        0.9619635343551636,
                        0.9597051739692688,
                        0.961513102054596,
                        0.9611895680427551,
                        0.9562288522720337,
                        0.9475570917129517,
                        0.9554295539855957,
                        0.9652875661849976,
                        0.9346350431442261,
                        0.8800479769706726,
                        0.9454256296157837,
                        0.9372486472129822,
                        0.9384602904319763,
                        0.9429135322570801,
                        0.9396846294403076,
                        0.9502150416374207,
                        0.9881691336631775,
                        0.8905530571937561,
                        0.996936023235321,
                        0.9135043621063232,
                        0.9091716408729553,
                        0.9069133400917053,
                        0.9131808280944824,
                        0.9128763675689697,
                        0.9185221791267395,
                        0.9171139001846313,
                        0.9167776703834534,
                        0.8711414933204651,
                        0.9133584499359131,
                        0.9595211744308472,
                        0.9052639603614807,
                        0.9140245318412781,
                        0.9159847497940063,
                        0.9528984427452087,
                        0.9612974524497986,
                        0.956717312335968,
                        0.9977670311927795,
                        0.9481026530265808
                    ]
                },
                "val": {
                    "score": -5.321803731690379,
                    "pretrain_loss": 0.7475031018257141,
                    "features_accuracy": [
                        0.48960551619529724,
                        0.6008011102676392,
                        0.34854477643966675,
                        0.41258493065834045,
                        0.44691208004951477,
                        0.4327654242515564,
                        0.3164486289024353,
                        0.3698407709598541,
                        0.5115099549293518,
                        0.33531081676483154,
                        0.9931548237800598,
                        0.3973734676837921,
                        0.31447112560272217,
                        0.3656322658061981,
                        0.3864719569683075,
                        0.3205050230026245,
                        0.35686033964157104,
                        0.3208599388599396,
                        0.4493458867073059,
                        0.5778825283050537,
                        0.3826690912246704,
                        0.3046344220638275,
                        0.5609471797943115,
                        0.38540714979171753,
                        0.28536659479141235,
                        0.36355337500572205,
                        0.47170671820640564,
                        0.5644457936286926,
                        0.4420951008796692,
                        0.9881857633590698,
                        0.9082750082015991,
                        0.9927998781204224,
                        0.9046749472618103,
                        0.904167890548706,
                        0.9009227752685547,
                        0.9055876731872559,
                        0.8993002772331238,
                        0.6992698311805725,
                        0.9086299538612366,
                        0.6153534054756165,
                        0.9095426201820374,
                        0.8802859783172607,
                        0.43621334433555603,
                        0.8974748849868774,
                        0.9056383371353149,
                        0.909136950969696,
                        0.5028901696205139,
                        0.36598721146583557,
                        0.4318527281284332,
                        0.9954872727394104,
                        0.474647581577301
                    ]
                },
                "test": {
                    "score": -5.6793858269296305,
                    "pretrain_loss": 0.466977596282959,
                    "features_accuracy": [
                        0.57271808385849,
                        0.6947261691093445,
                        0.6353955268859863,
                        0.6201825737953186,
                        0.7146044373512268,
                        0.6797667145729065,
                        0.7037018537521362,
                        0.6462981700897217,
                        0.6874239444732666,
                        0.713843822479248,
                        0.9947261810302734,
                        0.6440162062644958,
                        0.6274847984313965,
                        0.7292089462280273,
                        0.6958925127983093,
                        0.7710446119308472,
                        0.7490872144699097,
                        0.7333671450614929,
                        0.569979727268219,
                        0.6836206912994385,
                        0.7017748355865479,
                        0.6280933022499084,
                        0.8207403421401978,
                        0.7700304388999939,
                        0.5765720009803772,
                        0.8256085515022278,
                        0.643864095211029,
                        0.5648580193519592,
                        0.48509126901626587,
                        0.9880324602127075,
                        0.9182048439979553,
                        0.9945233464241028,
                        0.5840263962745667,
                        0.8942697644233704,
                        0.9003042578697205,
                        0.90892493724823,
                        0.9084685444831848,
                        0.9101927280426025,
                        0.9009634852409363,
                        0.582707941532135,
                        0.9164299964904785,
                        0.9054766893386841,
                        0.6925456523895264,
                        0.9012170433998108,
                        0.9093813300132751,
                        0.9063387513160706,
                        0.6648073196411133,
                        0.7150101661682129,
                        0.683367133140564,
                        0.9974138140678406,
                        0.5276369452476501
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -4.207702699519791,
                    "pretrain_loss": 0.12019190192222595,
                    "features_accuracy": [
                        0.9534186124801636,
                        0.9063233733177185,
                        0.9625915288925171,
                        0.9696075916290283,
                        0.9670066833496094,
                        0.9707241058349609,
                        0.9670637845993042,
                        0.9712759852409363,
                        0.9616336226463318,
                        0.971117377281189,
                        0.9978939294815063,
                        0.9596734642982483,
                        0.9672287106513977,
                        0.9743209481239319,
                        0.9676854610443115,
                        0.9703624844551086,
                        0.9681739211082458,
                        0.9636128544807434,
                        0.949910581111908,
                        0.9636001586914062,
                        0.9750187397003174,
                        0.9446580410003662,
                        0.8885484933853149,
                        0.9500564932823181,
                        0.9417209029197693,
                        0.9436303377151489,
                        0.9435669183731079,
                        0.9385491013526917,
                        0.9583539962768555,
                        0.9880993366241455,
                        0.8928748369216919,
                        0.9975005984306335,
                        0.9118550419807434,
                        0.9098377227783203,
                        0.9099392294883728,
                        0.9156041145324707,
                        0.9171456098556519,
                        0.9204126000404358,
                        0.9161115884780884,
                        0.9207044243812561,
                        0.8825536966323853,
                        0.9143734574317932,
                        0.9648118019104004,
                        0.9105862975120544,
                        0.9131554961204529,
                        0.9182621240615845,
                        0.9698486328125,
                        0.9664230942726135,
                        0.9693031311035156,
                        0.9983316659927368,
                        0.9512554407119751
                    ]
                },
                "val": {
                    "score": -5.344305186279947,
                    "pretrain_loss": 0.8489615321159363,
                    "features_accuracy": [
                        0.403052419424057,
                        0.7434337139129639,
                        0.3036710321903229,
                        0.4135483205318451,
                        0.4464050233364105,
                        0.3697393536567688,
                        0.3112260401248932,
                        0.4182131588459015,
                        0.5196734666824341,
                        0.38145217299461365,
                        0.9936111569404602,
                        0.35757023096084595,
                        0.35929417610168457,
                        0.4007200002670288,
                        0.40208902955055237,
                        0.39017340540885925,
                        0.4272386133670807,
                        0.3321671187877655,
                        0.5077071189880371,
                        0.5877192616462708,
                        0.38074231147766113,
                        0.43530067801475525,
                        0.582598090171814,
                        0.40487778186798096,
                        0.32871919870376587,
                        0.3764323890209198,
                        0.44985294342041016,
                        0.5563330054283142,
                        0.4054355323314667,
                        0.9865124821662903,
                        0.8983368873596191,
                        0.9938647150993347,
                        0.9023932218551636,
                        0.9034580588340759,
                        0.8989959955215454,
                        0.9050806164741516,
                        0.8930635452270508,
                        0.6545988917350769,
                        0.9088327288627625,
                        0.6011560559272766,
                        0.9059425592422485,
                        0.8772436380386353,
                        0.3698407709598541,
                        0.8842916488647461,
                        0.9063482284545898,
                        0.9095933437347412,
                        0.37648311257362366,
                        0.42424702644348145,
                        0.4252104163169861,
                        0.9965013265609741,
                        0.38626912236213684
                    ]
                },
                "test": {
                    "score": -5.656225263023167,
                    "pretrain_loss": 0.4510168135166168,
                    "features_accuracy": [
                        0.6485294103622437,
                        0.6872718334197998,
                        0.7030932903289795,
                        0.6929005980491638,
                        0.7082149982452393,
                        0.7038032412528992,
                        0.7370689511299133,
                        0.6255578398704529,
                        0.7314908504486084,
                        0.7640466690063477,
                        0.9945740699768066,
                        0.7532961368560791,
                        0.5774340629577637,
                        0.7007606625556946,
                        0.7059837579727173,
                        0.7626267671585083,
                        0.6875253319740295,
                        0.7379817366600037,
                        0.5788032412528992,
                        0.6772819757461548,
                        0.7246957421302795,
                        0.6506592035293579,
                        0.8313894271850586,
                        0.7649087309837341,
                        0.5804259777069092,
                        0.8403143882751465,
                        0.6887931227684021,
                        0.5403143763542175,
                        0.5629310607910156,
                        0.9840263724327087,
                        0.9187626838684082,
                        0.9944218993186951,
                        0.5625760555267334,
                        0.9051216840744019,
                        0.8966024518013,
                        0.9086713790893555,
                        0.9046652913093567,
                        0.9134888648986816,
                        0.9036511182785034,
                        0.5728194713592529,
                        0.9169371128082275,
                        0.9064908623695374,
                        0.6835699677467346,
                        0.8946754336357117,
                        0.9090771079063416,
                        0.9061359167098999,
                        0.7177484631538391,
                        0.7423934936523438,
                        0.7463489174842834,
                        0.9970588088035583,
                        0.5140466690063477
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -4.247724573398672,
                    "pretrain_loss": 0.11766088008880615,
                    "features_accuracy": [
                        0.9551441073417664,
                        0.911081075668335,
                        0.96492600440979,
                        0.9712442755699158,
                        0.9676981568336487,
                        0.9713013768196106,
                        0.9694743752479553,
                        0.9728428721427917,
                        0.9635621309280396,
                        0.9733186364173889,
                        0.9973293542861938,
                        0.9620523452758789,
                        0.9729951024055481,
                        0.9771502017974854,
                        0.9705781936645508,
                        0.974067211151123,
                        0.9712315797805786,
                        0.9704132676124573,
                        0.956647515296936,
                        0.9652685523033142,
                        0.9751392602920532,
                        0.9461678266525269,
                        0.8921389579772949,
                        0.948248565196991,
                        0.9430467486381531,
                        0.9418668150901794,
                        0.9462122321128845,
                        0.9364874362945557,
                        0.9582080841064453,
                        0.9883467555046082,
                        0.8914474844932556,
                        0.9974244832992554,
                        0.9145510792732239,
                        0.909285843372345,
                        0.9074335098266602,
                        0.9180210828781128,
                        0.9165112376213074,
                        0.9221380949020386,
                        0.9196513891220093,
                        0.9185285568237305,
                        0.8817543983459473,
                        0.9155977964401245,
                        0.9645643830299377,
                        0.9107322096824646,
                        0.9167523384094238,
                        0.9200383424758911,
                        0.9714980125427246,
                        0.9689478874206543,
                        0.9745683073997498,
                        0.9984585046768188,
                        0.9533107876777649
                    ]
                },
                "val": {
                    "score": -5.359358194162386,
                    "pretrain_loss": 0.8557013869285583,
                    "features_accuracy": [
                        0.3592434823513031,
                        0.7511915564537048,
                        0.36603790521621704,
                        0.39306357502937317,
                        0.42282727360725403,
                        0.3905283212661743,
                        0.34783488512039185,
                        0.4184666872024536,
                        0.5383835434913635,
                        0.3467193841934204,
                        0.9934590458869934,
                        0.3525504469871521,
                        0.3519926965236664,
                        0.4218638837337494,
                        0.45730653405189514,
                        0.3666970729827881,
                        0.42313152551651,
                        0.31066828966140747,
                        0.42029204964637756,
                        0.6027278900146484,
                        0.38307473063468933,
                        0.44518810510635376,
                        0.5446202158927917,
                        0.48859140276908875,
                        0.3745056092739105,
                        0.44270357489585876,
                        0.3631477355957031,
                        0.5645979046821594,
                        0.45537975430488586,
                        0.9871209263801575,
                        0.8982354402542114,
                        0.9936111569404602,
                        0.8951931595802307,
                        0.9033059477806091,
                        0.8920494914054871,
                        0.9057397842407227,
                        0.8885001540184021,
                        0.7155967950820923,
                        0.906956672668457,
                        0.5922827124595642,
                        0.9054355025291443,
                        0.878004252910614,
                        0.39428049325942993,
                        0.8851029276847839,
                        0.9050298929214478,
                        0.9099482297897339,
                        0.3232937753200531,
                        0.3903762102127075,
                        0.37957608699798584,
                        0.996552050113678,
                        0.4503600001335144
                    ]
                },
                "test": {
                    "score": -5.654585717393766,
                    "pretrain_loss": 0.4557466506958008,
                    "features_accuracy": [
                        0.6451318264007568,
                        0.6995435953140259,
                        0.6749492883682251,
                        0.6296653151512146,
                        0.7019776701927185,
                        0.6823529601097107,
                        0.624391496181488,
                        0.6790568232536316,
                        0.6906186938285828,
                        0.7386916875839233,
                        0.9942697882652283,
                        0.7086206674575806,
                        0.7139959335327148,
                        0.6194218993186951,
                        0.6474137902259827,
                        0.6618661284446716,
                        0.5959432125091553,
                        0.6837728023529053,
                        0.6169371008872986,
                        0.6934077143669128,
                        0.7219067215919495,
                        0.5920385718345642,
                        0.8313387632369995,
                        0.8106490969657898,
                        0.567748486995697,
                        0.8011156320571899,
                        0.7476166486740112,
                        0.5657708048820496,
                        0.5043610334396362,
                        0.9842799305915833,
                        0.9126774668693542,
                        0.9945740699768066,
                        0.6807809472084045,
                        0.9055274128913879,
                        0.8953853845596313,
                        0.9076572060585022,
                        0.9049188494682312,
                        0.9145030379295349,
                        0.9008620977401733,
                        0.5759127736091614,
                        0.917190670967102,
                        0.8971095085144043,
                        0.6751013994216919,
                        0.9021298289299011,
                        0.90892493724823,
                        0.9053245186805725,
                        0.6479209065437317,
                        0.6778397560119629,
                        0.7227180600166321,
                        0.9973123669624329,
                        0.5231237411499023
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -3.8921109147386774,
                    "pretrain_loss": 0.11513514071702957,
                    "features_accuracy": [
                        0.9525939226150513,
                        0.9167142510414124,
                        0.9680787920951843,
                        0.9719991683959961,
                        0.9685291647911072,
                        0.9735025763511658,
                        0.9695948958396912,
                        0.9725320339202881,
                        0.9666705131530762,
                        0.9720181822776794,
                        0.9978178143501282,
                        0.9637397527694702,
                        0.9724368453025818,
                        0.977790892124176,
                        0.970920741558075,
                        0.9776005744934082,
                        0.9739149212837219,
                        0.9726462364196777,
                        0.959648072719574,
                        0.9680724143981934,
                        0.9785140752792358,
                        0.946776807308197,
                        0.8921262621879578,
                        0.9535708427429199,
                        0.9405473470687866,
                        0.9452797174453735,
                        0.9468085169792175,
                        0.9360941052436829,
                        0.9598827958106995,
                        0.9885497093200684,
                        0.8931475877761841,
                        0.9976845979690552,
                        0.9151029586791992,
                        0.9100534319877625,
                        0.9118296504020691,
                        0.9156168103218079,
                        0.9165366291999817,
                        0.9215861558914185,
                        0.9188774228096008,
                        0.9182113409042358,
                        0.8796420097351074,
                        0.9149824380874634,
                        0.9678630828857422,
                        0.9075857400894165,
                        0.9155089855194092,
                        0.919226348400116,
                        0.9754310846328735,
                        0.9720752835273743,
                        0.9775054454803467,
                        0.9988835453987122,
                        0.956850528717041
                    ]
                },
                "val": {
                    "score": -5.381247616299391,
                    "pretrain_loss": 0.895643949508667,
                    "features_accuracy": [
                        0.5124226808547974,
                        0.6720413565635681,
                        0.37734508514404297,
                        0.38540714979171753,
                        0.45512625575065613,
                        0.3982861638069153,
                        0.3506236672401428,
                        0.4340837597846985,
                        0.5412737131118774,
                        0.4602981209754944,
                        0.9939153790473938,
                        0.38231414556503296,
                        0.32932764291763306,
                        0.3877395689487457,
                        0.4554304778575897,
                        0.3680154085159302,
                        0.4029003083705902,
                        0.33049386739730835,
                        0.3740999698638916,
                        0.6054152846336365,
                        0.4241963028907776,
                        0.4998478591442108,
                        0.5128282904624939,
                        0.5132339596748352,
                        0.3740999698638916,
                        0.4285062253475189,
                        0.4061454236507416,
                        0.5628232359886169,
                        0.4339316487312317,
                        0.9864618182182312,
                        0.9113172888755798,
                        0.9936618804931641,
                        0.9023425579071045,
                        0.9034073352813721,
                        0.897880494594574,
                        0.9040157794952393,
                        0.8998579978942871,
                        0.6326437592506409,
                        0.9099482297897339,
                        0.5942094922065735,
                        0.897779107093811,
                        0.8884494304656982,
                        0.43646687269210815,
                        0.8910353779792786,
                        0.9043200016021729,
                        0.9105567336082458,
                        0.3310008943080902,
                        0.43134570121765137,
                        0.42500758171081543,
                        0.996552050113678,
                        0.2800425887107849
                    ]
                },
                "test": {
                    "score": -5.611704416978575,
                    "pretrain_loss": 0.4574032425880432,
                    "features_accuracy": [
                        0.5844827890396118,
                        0.6792596578598022,
                        0.665567934513092,
                        0.6167342662811279,
                        0.6275355219841003,
                        0.7202332615852356,
                        0.7302231192588806,
                        0.6676977872848511,
                        0.6447768807411194,
                        0.7566429972648621,
                        0.9941683411598206,
                        0.6088235378265381,
                        0.6185091137886047,
                        0.6139959692955017,
                        0.6377788782119751,
                        0.6546652913093567,
                        0.6313387751579285,
                        0.6831135749816895,
                        0.6717038750648499,
                        0.6725659370422363,
                        0.7498986124992371,
                        0.6473630666732788,
                        0.82109534740448,
                        0.8257099390029907,
                        0.6085192561149597,
                        0.8362069129943848,
                        0.6767748594284058,
                        0.5645537376403809,
                        0.5470080971717834,
                        0.9836207032203674,
                        0.9214503169059753,
                        0.9946754574775696,
                        0.5759634971618652,
                        0.9052738547325134,
                        0.8970588445663452,
                        0.9073022603988647,
                        0.9061359167098999,
                        0.9140973687171936,
                        0.8970588445663452,
                        0.5785496830940247,
                        0.9102941155433655,
                        0.8972616791725159,
                        0.6548681855201721,
                        0.9006085395812988,
                        0.9070487022399902,
                        0.8982251286506653,
                        0.6231744289398193,
                        0.6845334768295288,
                        0.7218559980392456,
                        0.9975152015686035,
                        0.559482753276825
                    ]
                }
            }
        },
        "train": {
            "score": -4.193669418195815
        },
        "val": {
            "score": -5.321803731690379
        },
        "test": {
            "score": -5.6793858269296305
        }
    },
    "best_iteration": 10000,
    "time": "0:06:46"
}
