{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask___678e69ba6e7f43b6b1a7780c837f4a2b.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 1,
        "data": {
            "path": "data/fb-comments",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512
                ],
                "dropout": 0.27051204110517374
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear",
                "relu"
            ],
            "d_num_embedding": 86,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 512,
            "lr": 0.0010389025799681128,
            "weight_decay": 1.2066026259918022e-06,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.5702245024053401,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.0010389025799681128,
            "weight_decay": 1.2066026259918022e-06,
            "patience": 2,
            "n_iterations": 100000,
            "finetune_every": 10000,
            "replace_strategy": "target_shuffle",
            "n_neighbors": 20,
            "use_target": true,
            "target_injection_type": "post"
        },
        "bins": {
            "count": 246,
            "value": "ratio",
            "tree": {
                "min_samples_leaf": 51,
                "min_impurity_decrease": 0.0007608440657744265
            },
            "subsample": null
        }
    },
    "epoch_size": 308,
    "n_parameters": 2631815,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -3.7220729700186665,
                    "pretrain_loss": 0.13022497296333313,
                    "features_accuracy": [
                        0.9568315148353577,
                        0.8916441798210144,
                        0.9573262929916382,
                        0.9581890106201172,
                        0.9592357277870178,
                        0.9559624195098877,
                        0.9586965441703796,
                        0.965122640132904,
                        0.9500691890716553,
                        0.9646785855293274,
                        0.9965046644210815,
                        0.9552011489868164,
                        0.9563557505607605,
                        0.9625534415245056,
                        0.9594958424568176,
                        0.9594260454177856,
                        0.9625661373138428,
                        0.9608280062675476,
                        0.9502975344657898,
                        0.9572818875312805,
                        0.9622933864593506,
                        0.9402682185173035,
                        0.8807140588760376,
                        0.9446834325790405,
                        0.9384285807609558,
                        0.9382826685905457,
                        0.9442456960678101,
                        0.9365381598472595,
                        0.9509382247924805,
                        0.9882198572158813,
                        0.889874279499054,
                        0.9966124892234802,
                        0.9134663343429565,
                        0.9078458547592163,
                        0.9051180481910706,
                        0.9113792777061462,
                        0.9116393327713013,
                        0.9195688962936401,
                        0.914493978023529,
                        0.918160617351532,
                        0.8735266923904419,
                        0.9123625159263611,
                        0.9583413004875183,
                        0.9064058065414429,
                        0.9119311571121216,
                        0.9125591516494751,
                        0.960180938243866,
                        0.9592040181159973,
                        0.9609865546226501,
                        0.997602105140686,
                        0.948978066444397
                    ]
                },
                "val": {
                    "score": -5.32203792713685,
                    "pretrain_loss": 0.7788434624671936,
                    "features_accuracy": [
                        0.31827399134635925,
                        0.6409085988998413,
                        0.28054964542388916,
                        0.4317513406276703,
                        0.4647601544857025,
                        0.37460702657699585,
                        0.2927187979221344,
                        0.342054545879364,
                        0.4876787066459656,
                        0.35452792048454285,
                        0.9929519891738892,
                        0.32481491565704346,
                        0.3425108790397644,
                        0.3653280436992645,
                        0.38976776599884033,
                        0.3167021572589874,
                        0.3774465024471283,
                        0.3263360559940338,
                        0.3732379972934723,
                        0.5753980278968811,
                        0.2999695837497711,
                        0.3062569499015808,
                        0.5583105087280273,
                        0.3485954701900482,
                        0.31320351362228394,
                        0.3915931284427643,
                        0.3475813865661621,
                        0.5654598474502563,
                        0.43763309717178345,
                        0.988135039806366,
                        0.9162863492965698,
                        0.9921407103538513,
                        0.8973734378814697,
                        0.904117226600647,
                        0.9000608325004578,
                        0.9060946702957153,
                        0.8993509411811829,
                        0.6322888135910034,
                        0.9103538990020752,
                        0.5851333141326904,
                        0.9033059477806091,
                        0.8863705396652222,
                        0.28622856736183167,
                        0.8996551632881165,
                        0.904776394367218,
                        0.9092891216278076,
                        0.42363855242729187,
                        0.35640400648117065,
                        0.3218233287334442,
                        0.9955886602401733,
                        0.35828009247779846
                    ]
                },
                "test": {
                    "score": -5.590229671028923,
                    "pretrain_loss": 0.46669137477874756,
                    "features_accuracy": [
                        0.6924949288368225,
                        0.6225152015686035,
                        0.7453854084014893,
                        0.7162778973579407,
                        0.6949290037155151,
                        0.6580121517181396,
                        0.6813387274742126,
                        0.7431034445762634,
                        0.7154665589332581,
                        0.7273326516151428,
                        0.9950811266899109,
                        0.6404665112495422,
                        0.6845842003822327,
                        0.709432065486908,
                        0.7023833990097046,
                        0.7366125583648682,
                        0.7241886258125305,
                        0.724949300289154,
                        0.5642495155334473,
                        0.6368661522865295,
                        0.7518762946128845,
                        0.5820486545562744,
                        0.8130831718444824,
                        0.7655172348022461,
                        0.6371703743934631,
                        0.823833703994751,
                        0.6731744408607483,
                        0.5663285851478577,
                        0.5737829804420471,
                        0.9884888529777527,
                        0.9209432005882263,
                        0.9946247339248657,
                        0.8040060997009277,
                        0.9051724076271057,
                        0.902180552482605,
                        0.9102941155433655,
                        0.9087221026420593,
                        0.9158214926719666,
                        0.9118154048919678,
                        0.681744396686554,
                        0.9010142087936401,
                        0.9081643223762512,
                        0.6515213251113892,
                        0.9051216840744019,
                        0.9112069010734558,
                        0.9056795239448547,
                        0.6966531276702881,
                        0.7100912928581238,
                        0.7092292308807373,
                        0.9976673722267151,
                        0.49731236696243286
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -4.409916296518283,
                    "pretrain_loss": 0.12000200897455215,
                    "features_accuracy": [
                        0.958778977394104,
                        0.9116330146789551,
                        0.9710222482681274,
                        0.9686877727508545,
                        0.966727614402771,
                        0.9683642387390137,
                        0.9673429131507874,
                        0.9714599251747131,
                        0.9608407020568848,
                        0.9731791019439697,
                        0.9973103404045105,
                        0.9624519944190979,
                        0.9668417572975159,
                        0.9701468348503113,
                        0.9653065800666809,
                        0.9750187397003174,
                        0.9665119051933289,
                        0.9639490842819214,
                        0.9538943767547607,
                        0.9649450182914734,
                        0.9752787947654724,
                        0.9453304409980774,
                        0.8918344974517822,
                        0.9489970803260803,
                        0.9421903491020203,
                        0.9404839277267456,
                        0.9452607035636902,
                        0.937572181224823,
                        0.9566411972045898,
                        0.9881564378738403,
                        0.8918979167938232,
                        0.9976274967193604,
                        0.9149126410484314,
                        0.9096727967262268,
                        0.9098250865936279,
                        0.9122292995452881,
                        0.9140816330909729,
                        0.9212309122085571,
                        0.9177799820899963,
                        0.9201271533966064,
                        0.882617175579071,
                        0.914696991443634,
                        0.9677742719650269,
                        0.9101041555404663,
                        0.9154835939407349,
                        0.914367139339447,
                        0.9741433262825012,
                        0.9679962992668152,
                        0.9703370928764343,
                        0.9984965920448303,
                        0.9535074234008789
                    ]
                },
                "val": {
                    "score": -5.374676504933218,
                    "pretrain_loss": 0.908186137676239,
                    "features_accuracy": [
                        0.32020077109336853,
                        0.6442551016807556,
                        0.34246018528938293,
                        0.32775580883026123,
                        0.4483318030834198,
                        0.29834702610969543,
                        0.3308487832546234,
                        0.3285670876502991,
                        0.4959436058998108,
                        0.38718181848526,
                        0.9928506016731262,
                        0.2973836362361908,
                        0.3713619112968445,
                        0.34139537811279297,
                        0.3426630198955536,
                        0.3388601541519165,
                        0.3543251156806946,
                        0.3065612018108368,
                        0.3288205862045288,
                        0.5836122035980225,
                        0.39397627115249634,
                        0.31518101692199707,
                        0.5876685976982117,
                        0.3422066569328308,
                        0.38991987705230713,
                        0.4327654242515564,
                        0.3531588912010193,
                        0.5581076741218567,
                        0.3360713720321655,
                        0.9861068725585938,
                        0.9089848399162292,
                        0.9927998781204224,
                        0.8946861028671265,
                        0.8889057636260986,
                        0.8954466581344604,
                        0.9040157794952393,
                        0.9002129435539246,
                        0.6413649320602417,
                        0.8918466567993164,
                        0.5978602170944214,
                        0.9036608338356018,
                        0.8728323578834534,
                        0.38495081663131714,
                        0.8917959332466125,
                        0.9048270583152771,
                        0.9091876745223999,
                        0.31725990772247314,
                        0.3622857630252838,
                        0.3719196617603302,
                        0.9965013265609741,
                        0.24039143323898315
                    ]
                },
                "test": {
                    "score": -5.593507558332433,
                    "pretrain_loss": 0.4518391191959381,
                    "features_accuracy": [
                        0.6812373399734497,
                        0.6853448152542114,
                        0.7024847865104675,
                        0.7114604711532593,
                        0.7033975720405579,
                        0.7308316230773926,
                        0.7057809233665466,
                        0.7183570265769958,
                        0.7182555794715881,
                        0.6721095442771912,
                        0.9945740699768066,
                        0.6483772993087769,
                        0.6702332496643066,
                        0.7410750389099121,
                        0.6949290037155151,
                        0.750507116317749,
                        0.7111561894416809,
                        0.6598884463310242,
                        0.6562880277633667,
                        0.6747971773147583,
                        0.7221602201461792,
                        0.6307302117347717,
                        0.8424442410469055,
                        0.7567444443702698,
                        0.6496450304985046,
                        0.7995943427085876,
                        0.7069979906082153,
                        0.552789032459259,
                        0.49842798709869385,
                        0.9851419925689697,
                        0.8965517282485962,
                        0.9942190647125244,
                        0.7477180361747742,
                        0.8827078938484192,
                        0.8943712115287781,
                        0.9099898338317871,
                        0.9070993661880493,
                        0.9140466451644897,
                        0.9066430330276489,
                        0.709432065486908,
                        0.8974137902259827,
                        0.9045131802558899,
                        0.6820994019508362,
                        0.8932048678398132,
                        0.8985294103622437,
                        0.8984280228614807,
                        0.6980730295181274,
                        0.7169371247291565,
                        0.7333671450614929,
                        0.9979208707809448,
                        0.5132352709770203
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -4.231653218580809,
                    "pretrain_loss": 0.11759550869464874,
                    "features_accuracy": [
                        0.9582397937774658,
                        0.9163272976875305,
                        0.9746317863464355,
                        0.9624456167221069,
                        0.9709778428077698,
                        0.9742955565452576,
                        0.9716122150421143,
                        0.9718849658966064,
                        0.9649767279624939,
                        0.978456974029541,
                        0.9976274967193604,
                        0.9621474742889404,
                        0.9672477841377258,
                        0.9749933481216431,
                        0.9652812480926514,
                        0.9719674587249756,
                        0.9675649404525757,
                        0.9646278619766235,
                        0.9580431580543518,
                        0.9670828580856323,
                        0.9780510067939758,
                        0.9460346102714539,
                        0.8928811550140381,
                        0.9504053592681885,
                        0.9427168965339661,
                        0.9418478012084961,
                        0.9460282325744629,
                        0.9369885921478271,
                        0.9561971426010132,
                        0.9886322021484375,
                        0.8831246495246887,
                        0.9976592063903809,
                        0.9130920171737671,
                        0.9113157987594604,
                        0.9112777709960938,
                        0.9151981472969055,
                        0.9157183170318604,
                        0.9198163151741028,
                        0.9172598123550415,
                        0.9201651811599731,
                        0.8811264038085938,
                        0.9161242842674255,
                        0.9654271602630615,
                        0.9129841923713684,
                        0.916422426700592,
                        0.9143227338790894,
                        0.9755516052246094,
                        0.9711237549781799,
                        0.9752978682518005,
                        0.9986551403999329,
                        0.9527208209037781
                    ]
                },
                "val": {
                    "score": -5.3690339550343875,
                    "pretrain_loss": 0.9748973250389099,
                    "features_accuracy": [
                        0.3017442226409912,
                        0.625545084476471,
                        0.38403812050819397,
                        0.3218233287334442,
                        0.44838249683380127,
                        0.32349658012390137,
                        0.3440827429294586,
                        0.3362742066383362,
                        0.4902646541595459,
                        0.4034580588340759,
                        0.9934083223342896,
                        0.345603883266449,
                        0.4194807708263397,
                        0.3889564871788025,
                        0.4260723888874054,
                        0.4524388909339905,
                        0.35148563981056213,
                        0.2881046533584595,
                        0.30980628728866577,
                        0.5795050859451294,
                        0.3397728204727173,
                        0.3640604317188263,
                        0.5791501998901367,
                        0.3558969497680664,
                        0.3432714641094208,
                        0.4496501386165619,
                        0.3735422194004059,
                        0.5594767332077026,
                        0.36441537737846375,
                        0.9857012033462524,
                        0.9129398465156555,
                        0.9940168261528015,
                        0.8927085995674133,
                        0.8953959941864014,
                        0.8958523273468018,
                        0.9047256708145142,
                        0.9016833901405334,
                        0.6482608318328857,
                        0.9102017879486084,
                        0.6067842841148376,
                        0.9004157781600952,
                        0.8860663175582886,
                        0.4412331283092499,
                        0.8762295842170715,
                        0.8912888765335083,
                        0.8991988301277161,
                        0.320555716753006,
                        0.38652265071868896,
                        0.40954262018203735,
                        0.9968055486679077,
                        0.2490619570016861
                    ]
                },
                "test": {
                    "score": -5.643778712889975,
                    "pretrain_loss": 0.45310279726982117,
                    "features_accuracy": [
                        0.6431541442871094,
                        0.6722109317779541,
                        0.7116633057594299,
                        0.7297160029411316,
                        0.6469066739082336,
                        0.7185091376304626,
                        0.6786004304885864,
                        0.6466531753540039,
                        0.7052738666534424,
                        0.6625253558158875,
                        0.9940162301063538,
                        0.6990872025489807,
                        0.6880324482917786,
                        0.7860040664672852,
                        0.6771298050880432,
                        0.7419878244400024,
                        0.6879817247390747,
                        0.6954361200332642,
                        0.6506085395812988,
                        0.6538032293319702,
                        0.7487829923629761,
                        0.6453346610069275,
                        0.848935067653656,
                        0.7820487022399902,
                        0.6487829685211182,
                        0.7996957302093506,
                        0.7470081448554993,
                        0.565517246723175,
                        0.5258113741874695,
                        0.986156165599823,
                        0.9227180480957031,
                        0.9953346848487854,
                        0.7914299964904785,
                        0.883874237537384,
                        0.8709431886672974,
                        0.8919371366500854,
                        0.9076064825057983,
                        0.9146551489830017,
                        0.9112576246261597,
                        0.7536004185676575,
                        0.9026876091957092,
                        0.9067444205284119,
                        0.6635902523994446,
                        0.881135880947113,
                        0.8876774907112122,
                        0.8698275685310364,
                        0.5869168639183044,
                        0.7827586531639099,
                        0.7604462504386902,
                        0.9980223178863525,
                        0.5154158473014832
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -4.16915339864087,
                    "pretrain_loss": 0.11409810930490494,
                    "features_accuracy": [
                        0.9585569500923157,
                        0.9235907793045044,
                        0.9768330454826355,
                        0.9761161804199219,
                        0.9755389094352722,
                        0.9768837690353394,
                        0.9694743752479553,
                        0.9730712175369263,
                        0.9672033786773682,
                        0.980195164680481,
                        0.9977543950080872,
                        0.9634542465209961,
                        0.9749045372009277,
                        0.9764397144317627,
                        0.968649685382843,
                        0.9777591824531555,
                        0.9715487360954285,
                        0.9674127101898193,
                        0.9616209268569946,
                        0.9697979092597961,
                        0.9797194004058838,
                        0.9488067626953125,
                        0.8944988250732422,
                        0.9528984427452087,
                        0.9456349611282349,
                        0.9439792633056641,
                        0.946707010269165,
                        0.9412388205528259,
                        0.9558609127998352,
                        0.9885751008987427,
                        0.8843553066253662,
                        0.9978368282318115,
                        0.916098952293396,
                        0.9133965373039246,
                        0.9075350165367126,
                        0.9136375784873962,
                        0.9169172644615173,
                        0.9209074378013611,
                        0.9156675338745117,
                        0.918027400970459,
                        0.8812342286109924,
                        0.9157056212425232,
                        0.9728555679321289,
                        0.9133267402648926,
                        0.9123054146766663,
                        0.917031466960907,
                        0.975862443447113,
                        0.9726969599723816,
                        0.9751646518707275,
                        0.9987439513206482,
                        0.9583222270011902
                    ]
                },
                "val": {
                    "score": -5.375095791574478,
                    "pretrain_loss": 0.9675172567367554,
                    "features_accuracy": [
                        0.25337186455726624,
                        0.6448128819465637,
                        0.3630463480949402,
                        0.3605617880821228,
                        0.47023627161979675,
                        0.32440927624702454,
                        0.3119359016418457,
                        0.296927273273468,
                        0.5012168884277344,
                        0.37070274353027344,
                        0.9930534362792969,
                        0.28420037031173706,
                        0.3476320803165436,
                        0.4032552242279053,
                        0.39904674887657166,
                        0.3666463792324066,
                        0.3376939296722412,
                        0.3260825276374817,
                        0.3465672731399536,
                        0.5926883816719055,
                        0.3585336208343506,
                        0.3530067801475525,
                        0.5866544842720032,
                        0.4067031741142273,
                        0.37911975383758545,
                        0.47662508487701416,
                        0.3933171033859253,
                        0.5351890921592712,
                        0.414714515209198,
                        0.9863603711128235,
                        0.9128891229629517,
                        0.9933576583862305,
                        0.899908721446991,
                        0.9043200016021729,
                        0.8990467190742493,
                        0.9046242237091064,
                        0.9013791680335999,
                        0.6542946696281433,
                        0.9100496768951416,
                        0.5983166098594666,
                        0.898539662361145,
                        0.8743028044700623,
                        0.426376610994339,
                        0.880184531211853,
                        0.8972720503807068,
                        0.9089848399162292,
                        0.40122705698013306,
                        0.40300172567367554,
                        0.3831254243850708,
                        0.9962985515594482,
                        0.2682283818721771
                    ]
                },
                "test": {
                    "score": -5.691093550424737,
                    "pretrain_loss": 0.45713484287261963,
                    "features_accuracy": [
                        0.6482758522033691,
                        0.7193711996078491,
                        0.7023326754570007,
                        0.7273326516151428,
                        0.6335699558258057,
                        0.7173935174942017,
                        0.6901623010635376,
                        0.7034989595413208,
                        0.6863083243370056,
                        0.6243407726287842,
                        0.9947261810302734,
                        0.6886409521102905,
                        0.7010648846626282,
                        0.7742393612861633,
                        0.6914300322532654,
                        0.7654665112495422,
                        0.6527383327484131,
                        0.6518762707710266,
                        0.6167342662811279,
                        0.5878803133964539,
                        0.6948276162147522,
                        0.5930527448654175,
                        0.8318965435028076,
                        0.8164300322532654,
                        0.5842292308807373,
                        0.8196247220039368,
                        0.7741379141807556,
                        0.5591785311698914,
                        0.4499492943286896,
                        0.9855983853340149,
                        0.9020791053771973,
                        0.9952839612960815,
                        0.6520283818244934,
                        0.8903651237487793,
                        0.9009634852409363,
                        0.9080628752708435,
                        0.9084685444831848,
                        0.9129310250282288,
                        0.9041582345962524,
                        0.693965494632721,
                        0.8961460590362549,
                        0.9004563689231873,
                        0.6595335006713867,
                        0.896703839302063,
                        0.9061359167098999,
                        0.9032454490661621,
                        0.6075050830841064,
                        0.73002028465271,
                        0.6834178566932678,
                        0.9973123669624329,
                        0.5978701710700989
                    ]
                }
            }
        },
        "train": {
            "score": -3.7220729700186665
        },
        "val": {
            "score": -5.32203792713685
        },
        "test": {
            "score": -5.590229671028923
        }
    },
    "best_iteration": 10000,
    "time": "0:06:38"
}
