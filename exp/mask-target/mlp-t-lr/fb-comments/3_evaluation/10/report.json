{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask___678e69ba6e7f43b6b1a7780c837f4a2b.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 10,
        "data": {
            "path": "data/fb-comments",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512
                ],
                "dropout": 0.27051204110517374
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear",
                "relu"
            ],
            "d_num_embedding": 86,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 512,
            "lr": 0.0010389025799681128,
            "weight_decay": 1.2066026259918022e-06,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.5702245024053401,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.0010389025799681128,
            "weight_decay": 1.2066026259918022e-06,
            "patience": 2,
            "n_iterations": 100000,
            "finetune_every": 10000,
            "replace_strategy": "target_shuffle",
            "n_neighbors": 20,
            "use_target": true,
            "target_injection_type": "post"
        },
        "bins": {
            "count": 246,
            "value": "ratio",
            "tree": {
                "min_samples_leaf": 51,
                "min_impurity_decrease": 0.0007608440657744265
            },
            "subsample": null
        }
    },
    "epoch_size": 308,
    "n_parameters": 2631815,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -4.082692037316183,
                    "pretrain_loss": 0.1287432163953781,
                    "features_accuracy": [
                        0.950303852558136,
                        0.8900645971298218,
                        0.9587472677230835,
                        0.9641711115837097,
                        0.9602316617965698,
                        0.9616780281066895,
                        0.9586648344993591,
                        0.9627310633659363,
                        0.9540973901748657,
                        0.9627945423126221,
                        0.9972278475761414,
                        0.9562986493110657,
                        0.959248423576355,
                        0.959977924823761,
                        0.9602316617965698,
                        0.9631497859954834,
                        0.9612656831741333,
                        0.9592611193656921,
                        0.9500818252563477,
                        0.9532790780067444,
                        0.9700706601142883,
                        0.9392722845077515,
                        0.8827313184738159,
                        0.944315493106842,
                        0.9395514130592346,
                        0.9418541193008423,
                        0.9450703859329224,
                        0.937235951423645,
                        0.9521181583404541,
                        0.9881437420845032,
                        0.8897030353546143,
                        0.9973610639572144,
                        0.9131237864494324,
                        0.9090701937675476,
                        0.9043695330619812,
                        0.915299654006958,
                        0.9137200713157654,
                        0.9178497791290283,
                        0.9166191220283508,
                        0.9190043210983276,
                        0.8789949417114258,
                        0.9129397869110107,
                        0.9617668390274048,
                        0.9051688313484192,
                        0.9106687903404236,
                        0.9127621650695801,
                        0.9565460085868835,
                        0.9613164663314819,
                        0.9636826515197754,
                        0.9977861046791077,
                        0.9487370252609253
                    ]
                },
                "val": {
                    "score": -5.325780894541731,
                    "pretrain_loss": 0.7724136710166931,
                    "features_accuracy": [
                        0.4025960862636566,
                        0.5634316802024841,
                        0.32557550072669983,
                        0.33252203464508057,
                        0.3780549466609955,
                        0.2709157168865204,
                        0.2842510938644409,
                        0.32456138730049133,
                        0.4876787066459656,
                        0.3511306941509247,
                        0.9940168261528015,
                        0.3490518033504486,
                        0.3425108790397644,
                        0.3583814799785614,
                        0.3636547923088074,
                        0.4038130044937134,
                        0.38200992345809937,
                        0.3059527277946472,
                        0.3707534670829773,
                        0.578389585018158,
                        0.3627420961856842,
                        0.3768887519836426,
                        0.5678430199623108,
                        0.4117736518383026,
                        0.3419531285762787,
                        0.3624378740787506,
                        0.3337896764278412,
                        0.5696176886558533,
                        0.4186187982559204,
                        0.9866645932197571,
                        0.9158300161361694,
                        0.9931548237800598,
                        0.9023425579071045,
                        0.9040665030479431,
                        0.8986917734146118,
                        0.8929621577262878,
                        0.8925564885139465,
                        0.6218942999839783,
                        0.9060440063476562,
                        0.6123111248016357,
                        0.909086287021637,
                        0.8804887533187866,
                        0.38768887519836426,
                        0.8962579369544983,
                        0.9023932218551636,
                        0.9068045616149902,
                        0.3295304775238037,
                        0.39250582456588745,
                        0.2867356240749359,
                        0.9959436058998108,
                        0.4727715253829956
                    ]
                },
                "test": {
                    "score": -5.617226868656348,
                    "pretrain_loss": 0.4655182659626007,
                    "features_accuracy": [
                        0.5777890682220459,
                        0.7026368975639343,
                        0.7303752303123474,
                        0.6700811386108398,
                        0.6963995695114136,
                        0.7362068891525269,
                        0.7004056572914124,
                        0.647718071937561,
                        0.6624239087104797,
                        0.7180020213127136,
                        0.9942697882652283,
                        0.6482758522033691,
                        0.6000000238418579,
                        0.6779412031173706,
                        0.6493407487869263,
                        0.6590263843536377,
                        0.6681541800498962,
                        0.723326563835144,
                        0.5908722281455994,
                        0.6237829923629761,
                        0.7147058844566345,
                        0.6656186580657959,
                        0.8291582465171814,
                        0.7928498983383179,
                        0.6212981939315796,
                        0.8529918789863586,
                        0.7461967468261719,
                        0.5683062672615051,
                        0.6015720367431641,
                        0.9872211217880249,
                        0.9215517044067383,
                        0.9952332973480225,
                        0.6795638799667358,
                        0.8809330463409424,
                        0.8989858031272888,
                        0.9050710201263428,
                        0.9094827771186829,
                        0.9152129888534546,
                        0.8913286328315735,
                        0.6862576007843018,
                        0.9150101542472839,
                        0.9032454490661621,
                        0.688894510269165,
                        0.904411792755127,
                        0.908823549747467,
                        0.9055274128913879,
                        0.6146551966667175,
                        0.7246957421302795,
                        0.69609534740448,
                        0.9967038631439209,
                        0.5476166605949402
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -4.100900580977205,
                    "pretrain_loss": 0.11885391920804977,
                    "features_accuracy": [
                        0.9564571976661682,
                        0.9114236831665039,
                        0.9652748703956604,
                        0.9661059379577637,
                        0.9675395488739014,
                        0.9719991683959961,
                        0.9666451215744019,
                        0.9709714651107788,
                        0.9633591175079346,
                        0.9728491902351379,
                        0.9976338148117065,
                        0.9616653323173523,
                        0.9669115543365479,
                        0.9710602760314941,
                        0.9674951434135437,
                        0.9734581708908081,
                        0.9647420048713684,
                        0.9696900844573975,
                        0.9537801742553711,
                        0.9651543498039246,
                        0.9685799479484558,
                        0.9455017447471619,
                        0.8912064433097839,
                        0.9501579999923706,
                        0.9441378712654114,
                        0.9447722434997559,
                        0.9484578967094421,
                        0.942298173904419,
                        0.9514774680137634,
                        0.9884228706359863,
                        0.8927162289619446,
                        0.9975576996803284,
                        0.9124830365180969,
                        0.9100280404090881,
                        0.907554030418396,
                        0.916898250579834,
                        0.9159847497940063,
                        0.920691728591919,
                        0.9158198237419128,
                        0.9204379916191101,
                        0.8666438460350037,
                        0.9139928221702576,
                        0.9669115543365479,
                        0.9081757068634033,
                        0.9153566956520081,
                        0.9162384867668152,
                        0.9699692130088806,
                        0.9672033786773682,
                        0.9705528020858765,
                        0.9980588555335999,
                        0.9516677856445312
                    ]
                },
                "val": {
                    "score": -5.377953376722491,
                    "pretrain_loss": 0.8497757911682129,
                    "features_accuracy": [
                        0.3414461016654968,
                        0.6958218812942505,
                        0.3850015103816986,
                        0.37871411442756653,
                        0.4127877354621887,
                        0.3252205550670624,
                        0.32892200350761414,
                        0.3777000308036804,
                        0.5004563331604004,
                        0.35483214259147644,
                        0.9942703247070312,
                        0.3295811712741852,
                        0.36279281973838806,
                        0.3677111864089966,
                        0.3889564871788025,
                        0.3068654239177704,
                        0.3639083206653595,
                        0.29165399074554443,
                        0.29276949167251587,
                        0.5836629271507263,
                        0.35366594791412354,
                        0.4282526969909668,
                        0.5545076131820679,
                        0.42379069328308105,
                        0.38170570135116577,
                        0.4130919575691223,
                        0.3891085982322693,
                        0.5673866868019104,
                        0.4119764566421509,
                        0.9862082600593567,
                        0.9163877367973328,
                        0.9941182136535645,
                        0.9039143919944763,
                        0.9039651155471802,
                        0.8980833292007446,
                        0.8998579978942871,
                        0.8981340527534485,
                        0.5909643769264221,
                        0.9064496159553528,
                        0.6134266257286072,
                        0.9022411108016968,
                        0.8856099247932434,
                        0.2959638833999634,
                        0.8942804932594299,
                        0.9070073962211609,
                        0.9073622822761536,
                        0.33297839760780334,
                        0.37562111020088196,
                        0.41101306676864624,
                        0.9967548847198486,
                        0.2940371036529541
                    ]
                },
                "test": {
                    "score": -5.581720795896676,
                    "pretrain_loss": 0.45575231313705444,
                    "features_accuracy": [
                        0.68215012550354,
                        0.668306291103363,
                        0.7127282023429871,
                        0.6539553999900818,
                        0.7119168639183044,
                        0.7396551966667175,
                        0.7118661403656006,
                        0.6297667622566223,
                        0.66217041015625,
                        0.7539046406745911,
                        0.9949290156364441,
                        0.7000507116317749,
                        0.6113590002059937,
                        0.7443205118179321,
                        0.6978194713592529,
                        0.6482758522033691,
                        0.6551724076271057,
                        0.7031440138816833,
                        0.6327078938484192,
                        0.6520791053771973,
                        0.6883874535560608,
                        0.6703854203224182,
                        0.8395537734031677,
                        0.7979716062545776,
                        0.6581643223762512,
                        0.8343813419342041,
                        0.7748478651046753,
                        0.5675963759422302,
                        0.5998985767364502,
                        0.9850912690162659,
                        0.9224138259887695,
                        0.9945740699768066,
                        0.6202839612960815,
                        0.8876774907112122,
                        0.8993407487869263,
                        0.9046146273612976,
                        0.9054259657859802,
                        0.9147058725357056,
                        0.9123225212097168,
                        0.6729716062545776,
                        0.9150608777999878,
                        0.9006592631340027,
                        0.6862576007843018,
                        0.9038032293319702,
                        0.9087221026420593,
                        0.9074543714523315,
                        0.582200825214386,
                        0.6606490612030029,
                        0.6438133716583252,
                        0.9969574213027954,
                        0.5729209184646606
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -4.074549954483799,
                    "pretrain_loss": 0.11628304421901703,
                    "features_accuracy": [
                        0.9561780691146851,
                        0.9190550446510315,
                        0.9670954942703247,
                        0.9710476398468018,
                        0.9691952466964722,
                        0.9787868857383728,
                        0.9704449772834778,
                        0.9706289172172546,
                        0.9663025736808777,
                        0.973800778388977,
                        0.9978305101394653,
                        0.9624266028404236,
                        0.9698677062988281,
                        0.9733947515487671,
                        0.9675649404525757,
                        0.9777084589004517,
                        0.9671081900596619,
                        0.9699501395225525,
                        0.9574722051620483,
                        0.966860830783844,
                        0.9737753868103027,
                        0.9479884505271912,
                        0.8917012810707092,
                        0.95090651512146,
                        0.9446960687637329,
                        0.944448709487915,
                        0.9473667740821838,
                        0.9391961693763733,
                        0.9568568468093872,
                        0.9884291887283325,
                        0.8924688100814819,
                        0.9977290034294128,
                        0.9157183170318604,
                        0.9115822315216064,
                        0.9082772135734558,
                        0.91895991563797,
                        0.9160037636756897,
                        0.9213197231292725,
                        0.9178434610366821,
                        0.9196069836616516,
                        0.8749730587005615,
                        0.9156485199928284,
                        0.9723544120788574,
                        0.9097679853439331,
                        0.9132062196731567,
                        0.9135360717773438,
                        0.9711490869522095,
                        0.9698613286018372,
                        0.9762684106826782,
                        0.9984838962554932,
                        0.9556832909584045
                    ]
                },
                "val": {
                    "score": -5.366923376608075,
                    "pretrain_loss": 0.874725878238678,
                    "features_accuracy": [
                        0.35173916816711426,
                        0.6688469648361206,
                        0.3726295530796051,
                        0.37927186489105225,
                        0.46034884452819824,
                        0.3745563328266144,
                        0.3352093994617462,
                        0.35579556226730347,
                        0.5212960243225098,
                        0.36487171053886414,
                        0.9942703247070312,
                        0.2939356863498688,
                        0.31771624088287354,
                        0.3969171345233917,
                        0.4458472728729248,
                        0.37065204977989197,
                        0.3945847153663635,
                        0.31112462282180786,
                        0.3167528510093689,
                        0.5957306623458862,
                        0.3248656094074249,
                        0.4579150080680847,
                        0.6062772274017334,
                        0.45056280493736267,
                        0.3624378740787506,
                        0.5040563941001892,
                        0.5079099535942078,
                        0.5654598474502563,
                        0.42105263471603394,
                        0.986005425453186,
                        0.918923020362854,
                        0.993763267993927,
                        0.8938748240470886,
                        0.9030017256736755,
                        0.8951424360275269,
                        0.8983875513076782,
                        0.901987612247467,
                        0.6576411724090576,
                        0.9063482284545898,
                        0.6009025573730469,
                        0.891390323638916,
                        0.8814014792442322,
                        0.36877596378326416,
                        0.8959537148475647,
                        0.8969678282737732,
                        0.9057904481887817,
                        0.4104553163051605,
                        0.41567790508270264,
                        0.43048369884490967,
                        0.9968562722206116,
                        0.274667888879776
                    ]
                },
                "test": {
                    "score": -5.675882169121289,
                    "pretrain_loss": 0.4538649916648865,
                    "features_accuracy": [
                        0.6751013994216919,
                        0.6813894510269165,
                        0.7030426263809204,
                        0.6348884701728821,
                        0.715060830116272,
                        0.7815923094749451,
                        0.6773326396942139,
                        0.4831135869026184,
                        0.661663293838501,
                        0.727281928062439,
                        0.9943205118179321,
                        0.656693696975708,
                        0.5975152254104614,
                        0.7540060877799988,
                        0.7310851812362671,
                        0.7441176772117615,
                        0.6362575888633728,
                        0.6249492764472961,
                        0.6707910895347595,
                        0.6793103218078613,
                        0.7396551966667175,
                        0.5986308455467224,
                        0.8347362875938416,
                        0.8208925127983093,
                        0.6385395526885986,
                        0.8347362875938416,
                        0.743914783000946,
                        0.5680527687072754,
                        0.5272819399833679,
                        0.9856491088867188,
                        0.9218052625656128,
                        0.9945233464241028,
                        0.6781440377235413,
                        0.9053245186805725,
                        0.8987322449684143,
                        0.8981744647026062,
                        0.9091784954071045,
                        0.9160243272781372,
                        0.9128296375274658,
                        0.5975659489631653,
                        0.911054790019989,
                        0.8915821313858032,
                        0.613793134689331,
                        0.9042596220970154,
                        0.9079107642173767,
                        0.9081135988235474,
                        0.5812373161315918,
                        0.686612606048584,
                        0.6899087429046631,
                        0.9971602559089661,
                        0.4976673424243927
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -3.9513281852282667,
                    "pretrain_loss": 0.11428537219762802,
                    "features_accuracy": [
                        0.9591659307479858,
                        0.9220619797706604,
                        0.9700262546539307,
                        0.9713076949119568,
                        0.970920741558075,
                        0.9800175428390503,
                        0.9733947515487671,
                        0.9736294746398926,
                        0.9683008193969727,
                        0.9764397144317627,
                        0.9979827404022217,
                        0.9639363884925842,
                        0.9739657044410706,
                        0.9777084589004517,
                        0.9684403538703918,
                        0.9800809621810913,
                        0.9673619270324707,
                        0.9711364507675171,
                        0.95991450548172,
                        0.9691572189331055,
                        0.9764207005500793,
                        0.949441134929657,
                        0.8931475877761841,
                        0.9532790780067444,
                        0.9436747431755066,
                        0.9442012906074524,
                        0.9469988346099854,
                        0.9334424734115601,
                        0.958652138710022,
                        0.9882452487945557,
                        0.8937439322471619,
                        0.9979954361915588,
                        0.9148682355880737,
                        0.9113348722457886,
                        0.9055367708206177,
                        0.9199178218841553,
                        0.9121150970458984,
                        0.9217320680618286,
                        0.9157500267028809,
                        0.9208439588546753,
                        0.8828265070915222,
                        0.9172788262367249,
                        0.9722592234611511,
                        0.908816397190094,
                        0.9142909646034241,
                        0.915756344795227,
                        0.9738705158233643,
                        0.9721196889877319,
                        0.9790913462638855,
                        0.9988391399383545,
                        0.9574912190437317
                    ]
                },
                "val": {
                    "score": -5.38959858589819,
                    "pretrain_loss": 0.9033495187759399,
                    "features_accuracy": [
                        0.35128283500671387,
                        0.593195378780365,
                        0.32669100165367126,
                        0.39803263545036316,
                        0.461261510848999,
                        0.3633505702018738,
                        0.3693337142467499,
                        0.4038130044937134,
                        0.5133353471755981,
                        0.38393670320510864,
                        0.9939661026000977,
                        0.296927273273468,
                        0.3927086293697357,
                        0.40122705698013306,
                        0.4231822192668915,
                        0.3653280436992645,
                        0.39975661039352417,
                        0.3554913103580475,
                        0.3646688759326935,
                        0.605820894241333,
                        0.3483419418334961,
                        0.45832064747810364,
                        0.6140857934951782,
                        0.4169962406158447,
                        0.39646080136299133,
                        0.5066930055618286,
                        0.4470134675502777,
                        0.4985802471637726,
                        0.34403204917907715,
                        0.9875265955924988,
                        0.9198864102363586,
                        0.9936111569404602,
                        0.8974748849868774,
                        0.8877902626991272,
                        0.897779107093811,
                        0.8856606483459473,
                        0.8952438831329346,
                        0.6603792309761047,
                        0.9067538380622864,
                        0.6454213261604309,
                        0.8827197551727295,
                        0.8778014183044434,
                        0.40604400634765625,
                        0.8876888751983643,
                        0.9068045616149902,
                        0.8966636061668396,
                        0.38535645604133606,
                        0.4262244999408722,
                        0.39935097098350525,
                        0.9963492155075073,
                        0.2646283209323883
                    ]
                },
                "test": {
                    "score": -5.674318931018549,
                    "pretrain_loss": 0.4617062509059906,
                    "features_accuracy": [
                        0.6561866402626038,
                        0.6856998205184937,
                        0.6273833513259888,
                        0.6804766654968262,
                        0.667190670967102,
                        0.7643508911132812,
                        0.6715010404586792,
                        0.48412778973579407,
                        0.6581643223762512,
                        0.7031947374343872,
                        0.9948782920837402,
                        0.6685091257095337,
                        0.6673427820205688,
                        0.6282454133033752,
                        0.6991379261016846,
                        0.7512677311897278,
                        0.6752028465270996,
                        0.6418356895446777,
                        0.6736815571784973,
                        0.6197769045829773,
                        0.767241358757019,
                        0.6278397440910339,
                        0.8159736394882202,
                        0.8251521587371826,
                        0.6263184547424316,
                        0.8487322330474854,
                        0.7556794881820679,
                        0.53392493724823,
                        0.6208925247192383,
                        0.9861055016517639,
                        0.9119675755500793,
                        0.9943205118179321,
                        0.7377281785011292,
                        0.8754563927650452,
                        0.8841785192489624,
                        0.8829614520072937,
                        0.9033975601196289,
                        0.9163793325424194,
                        0.8867647051811218,
                        0.626115620136261,
                        0.8897058963775635,
                        0.8802231550216675,
                        0.6335192918777466,
                        0.8982251286506653,
                        0.9085699915885925,
                        0.8803752660751343,
                        0.4799695909023285,
                        0.6595335006713867,
                        0.6545131802558899,
                        0.9972109794616699,
                        0.5491886138916016
                    ]
                }
            }
        },
        "train": {
            "score": -4.082692037316183
        },
        "val": {
            "score": -5.325780894541731
        },
        "test": {
            "score": -5.617226868656348
        }
    },
    "best_iteration": 10000,
    "time": "0:06:43"
}
