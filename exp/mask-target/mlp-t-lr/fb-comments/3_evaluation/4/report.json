{
    "program": "/slot/sandbox/d/in/script/0_script_unpacked/pretrains/bin/pretrain_mask___678e69ba6e7f43b6b1a7780c837f4a2b.py",
    "environment": {
        "CUDA_VISIBLE_DEVICES": "0",
        "gpus": {
            "driver": "450.119.04",
            "devices": [
                {
                    "name": "A100-SXM-80GB",
                    "memory_total": 85199093760,
                    "memory_free": 85195948032,
                    "memory_used": 3145728,
                    "utilization": 0
                }
            ]
        },
        "torch.version.cuda": "11.1",
        "torch.backends.cudnn.version()": 8005,
        "torch.cuda.nccl.version()": [
            2,
            10,
            3
        ]
    },
    "config": {
        "seed": 4,
        "data": {
            "path": "data/fb-comments",
            "T": {
                "seed": 0,
                "normalization": "quantile",
                "num_nan_policy": null,
                "cat_nan_policy": null,
                "cat_min_frequency": null,
                "cat_encoding": null,
                "y_policy": "default"
            },
            "T_cache": true
        },
        "model": {
            "kind": "mlp",
            "config": {
                "d_layers": [
                    512
                ],
                "dropout": 0.27051204110517374
            },
            "default": true,
            "checkpoint": null,
            "num_embedding_arch": [
                "linear",
                "relu"
            ],
            "d_num_embedding": 86,
            "positional_encoding": null,
            "d_cat_embedding": null
        },
        "training": {
            "batch_size": 512,
            "lr": 0.0010389025799681128,
            "weight_decay": 1.2066026259918022e-06,
            "optimizer": "AdamW",
            "patience": 16,
            "n_epochs": Infinity,
            "eval_batch_size": 8192
        },
        "pretrain": {
            "corrupt_probability": 0.5702245024053401,
            "corrupt_strategy": "resample",
            "d_hidden_head": 512,
            "lr": 0.0010389025799681128,
            "weight_decay": 1.2066026259918022e-06,
            "patience": 2,
            "n_iterations": 100000,
            "finetune_every": 10000,
            "replace_strategy": "target_shuffle",
            "n_neighbors": 20,
            "use_target": true,
            "target_injection_type": "post"
        },
        "bins": {
            "count": 246,
            "value": "ratio",
            "tree": {
                "min_samples_leaf": 51,
                "min_impurity_decrease": 0.0007608440657744265
            },
            "subsample": null
        }
    },
    "epoch_size": 308,
    "n_parameters": 2631815,
    "metrics": {
        "iteration_scores": {
            "10000": {
                "train": {
                    "score": -3.7351952971831217,
                    "pretrain_loss": 0.13116975128650665,
                    "features_accuracy": [
                        0.9511412382125854,
                        0.8883517980575562,
                        0.9570915699005127,
                        0.9624139070510864,
                        0.9566602110862732,
                        0.9610817432403564,
                        0.958112895488739,
                        0.9609929323196411,
                        0.9476966261863708,
                        0.9620776772499084,
                        0.9970248341560364,
                        0.9553470611572266,
                        0.9604854583740234,
                        0.9622933864593506,
                        0.9606884121894836,
                        0.9631941914558411,
                        0.9612847566604614,
                        0.956121027469635,
                        0.9497202634811401,
                        0.9573072791099548,
                        0.9668417572975159,
                        0.9408645033836365,
                        0.8812976479530334,
                        0.9411500096321106,
                        0.9337469339370728,
                        0.9369505047798157,
                        0.9430023431777954,
                        0.9343813061714172,
                        0.9513378739356995,
                        0.9881627559661865,
                        0.8917456865310669,
                        0.996669590473175,
                        0.9138278961181641,
                        0.910281777381897,
                        0.905485987663269,
                        0.9116013050079346,
                        0.9128129482269287,
                        0.9194102883338928,
                        0.9148175120353699,
                        0.9185856580734253,
                        0.8609345555305481,
                        0.910751223564148,
                        0.9598637819290161,
                        0.9083089232444763,
                        0.9106560945510864,
                        0.9129461646080017,
                        0.9647673964500427,
                        0.9594260454177856,
                        0.9616971015930176,
                        0.997602105140686,
                        0.9486291408538818
                    ]
                },
                "val": {
                    "score": -5.3122750597487824,
                    "pretrain_loss": 0.7695884108543396,
                    "features_accuracy": [
                        0.37404927611351013,
                        0.6733596920967102,
                        0.30214986205101013,
                        0.3600040376186371,
                        0.4410303235054016,
                        0.4356555938720703,
                        0.32395294308662415,
                        0.37055063247680664,
                        0.4834195077419281,
                        0.3925565183162689,
                        0.9927492141723633,
                        0.3658351004123688,
                        0.32760366797447205,
                        0.3187810480594635,
                        0.391390323638916,
                        0.3257276117801666,
                        0.3323192298412323,
                        0.323040246963501,
                        0.3451475501060486,
                        0.4681066572666168,
                        0.3244599997997284,
                        0.284606009721756,
                        0.5724064111709595,
                        0.3282628357410431,
                        0.31568804383277893,
                        0.3365784287452698,
                        0.3510800004005432,
                        0.5611499547958374,
                        0.39281004667282104,
                        0.9871716499328613,
                        0.9128891229629517,
                        0.9926984906196594,
                        0.9032045006752014,
                        0.9050298929214478,
                        0.8977283835411072,
                        0.9056890606880188,
                        0.9029510021209717,
                        0.6357874274253845,
                        0.9063482284545898,
                        0.5838657021522522,
                        0.9067031741142273,
                        0.8983368873596191,
                        0.2784707248210907,
                        0.8984889984130859,
                        0.9068552851676941,
                        0.9074130058288574,
                        0.36603790521621704,
                        0.4017848074436188,
                        0.3783591687679291,
                        0.9954365491867065,
                        0.461261510848999
                    ]
                },
                "test": {
                    "score": -5.57800970819825,
                    "pretrain_loss": 0.4709196090698242,
                    "features_accuracy": [
                        0.6300709843635559,
                        0.7056795358657837,
                        0.6684077382087708,
                        0.6488843560218811,
                        0.7021298408508301,
                        0.6624746322631836,
                        0.6595841646194458,
                        0.5906693935394287,
                        0.7235293984413147,
                        0.7136917114257812,
                        0.9940669536590576,
                        0.6672921180725098,
                        0.613793134689331,
                        0.7088742256164551,
                        0.7319979667663574,
                        0.7157707810401917,
                        0.6882860064506531,
                        0.7141987681388855,
                        0.6021298170089722,
                        0.7136409878730774,
                        0.7259634733200073,
                        0.6017748713493347,
                        0.8481237292289734,
                        0.7347870469093323,
                        0.6061866283416748,
                        0.8010649085044861,
                        0.7251014113426208,
                        0.5675456523895264,
                        0.5871703624725342,
                        0.9884888529777527,
                        0.9135902523994446,
                        0.9937626719474792,
                        0.631085216999054,
                        0.9045131802558899,
                        0.8974137902259827,
                        0.9100912809371948,
                        0.9089756608009338,
                        0.9125760793685913,
                        0.9133874177932739,
                        0.6060344576835632,
                        0.9149087071418762,
                        0.9051724076271057,
                        0.7286511063575745,
                        0.9006592631340027,
                        0.908316433429718,
                        0.9030933380126953,
                        0.7108519077301025,
                        0.7075557708740234,
                        0.726064920425415,
                        0.996653139591217,
                        0.500507116317749
                    ]
                }
            },
            "20000": {
                "train": {
                    "score": -3.9558820618716406,
                    "pretrain_loss": 0.12191227078437805,
                    "features_accuracy": [
                        0.9502594470977783,
                        0.9011976718902588,
                        0.962375819683075,
                        0.9640251994132996,
                        0.9652495384216309,
                        0.969258725643158,
                        0.967323899269104,
                        0.9693411588668823,
                        0.9631243944168091,
                        0.9688463807106018,
                        0.9974815845489502,
                        0.960244357585907,
                        0.9660361409187317,
                        0.9706416130065918,
                        0.9650655388832092,
                        0.9720625877380371,
                        0.9698359966278076,
                        0.9643804430961609,
                        0.9547570943832397,
                        0.9625281095504761,
                        0.9745302796363831,
                        0.9434463977813721,
                        0.8885675072669983,
                        0.9429262280464172,
                        0.9397607445716858,
                        0.9430721402168274,
                        0.9462756514549255,
                        0.9349395632743835,
                        0.951439380645752,
                        0.9881056547164917,
                        0.8885167241096497,
                        0.997405469417572,
                        0.9140689373016357,
                        0.9128129482269287,
                        0.9113094806671143,
                        0.9123435020446777,
                        0.9147540926933289,
                        0.916898250579834,
                        0.9173359274864197,
                        0.9180718064308167,
                        0.8808472752571106,
                        0.9133267402648926,
                        0.9663659930229187,
                        0.9068625569343567,
                        0.9134409427642822,
                        0.9153757691383362,
                        0.9700262546539307,
                        0.9661122560501099,
                        0.9721450805664062,
                        0.9983569979667664,
                        0.9506781697273254
                    ]
                },
                "val": {
                    "score": -5.400122418303052,
                    "pretrain_loss": 0.8406856060028076,
                    "features_accuracy": [
                        0.30752459168434143,
                        0.6356353163719177,
                        0.3039245307445526,
                        0.3451475501060486,
                        0.46065306663513184,
                        0.3398742377758026,
                        0.3654801547527313,
                        0.40913698077201843,
                        0.5081634521484375,
                        0.4337795376777649,
                        0.993763267993927,
                        0.4368725121021271,
                        0.32380083203315735,
                        0.34707432985305786,
                        0.3934692144393921,
                        0.31259506940841675,
                        0.3650745153427124,
                        0.32045429944992065,
                        0.3161444067955017,
                        0.5653584599494934,
                        0.3589392602443695,
                        0.3104654550552368,
                        0.57686847448349,
                        0.33825168013572693,
                        0.3620322346687317,
                        0.35615047812461853,
                        0.394939661026001,
                        0.5659669041633606,
                        0.4891998767852783,
                        0.9843322038650513,
                        0.9150187373161316,
                        0.993104100227356,
                        0.8930128812789917,
                        0.9053848385810852,
                        0.8870803713798523,
                        0.9039143919944763,
                        0.9009227752685547,
                        0.6206774115562439,
                        0.8966128826141357,
                        0.596643328666687,
                        0.8826690912246704,
                        0.8821113109588623,
                        0.35173916816711426,
                        0.898539662361145,
                        0.8967649936676025,
                        0.9011763334274292,
                        0.42130613327026367,
                        0.3619815409183502,
                        0.3535645306110382,
                        0.9961971044540405,
                        0.27375519275665283
                    ]
                },
                "test": {
                    "score": -5.685495056798311,
                    "pretrain_loss": 0.4611550271511078,
                    "features_accuracy": [
                        0.5863083004951477,
                        0.6687119603157043,
                        0.6931541562080383,
                        0.6677485108375549,
                        0.6702839732170105,
                        0.7156693935394287,
                        0.7011663317680359,
                        0.6314401626586914,
                        0.6964502930641174,
                        0.6993914842605591,
                        0.9940669536590576,
                        0.6596348881721497,
                        0.6974645256996155,
                        0.7354462742805481,
                        0.7338742613792419,
                        0.7259634733200073,
                        0.6695233583450317,
                        0.7184584140777588,
                        0.6439655423164368,
                        0.6947768926620483,
                        0.7809330821037292,
                        0.6758620738983154,
                        0.830070972442627,
                        0.7406693696975708,
                        0.6016227006912231,
                        0.8382353186607361,
                        0.7234280109405518,
                        0.5666835904121399,
                        0.38671401143074036,
                        0.9837220907211304,
                        0.904411792755127,
                        0.9941176772117615,
                        0.6201318502426147,
                        0.8929005861282349,
                        0.8896551728248596,
                        0.9049188494682312,
                        0.9090771079063416,
                        0.9141480922698975,
                        0.9076064825057983,
                        0.7233772873878479,
                        0.8923428058624268,
                        0.9050202965736389,
                        0.6995435953140259,
                        0.8997464776039124,
                        0.8893508911132812,
                        0.8753042817115784,
                        0.6241379380226135,
                        0.7075050473213196,
                        0.7217038869857788,
                        0.997261643409729,
                        0.5634381175041199
                    ]
                }
            },
            "30000": {
                "train": {
                    "score": -4.357625129068868,
                    "pretrain_loss": 0.11858972162008286,
                    "features_accuracy": [
                        0.9544399380683899,
                        0.9065644145011902,
                        0.9664865136146545,
                        0.9638031721115112,
                        0.9652939438819885,
                        0.9735913872718811,
                        0.9727350473403931,
                        0.9692016243934631,
                        0.9662327766418457,
                        0.9740354418754578,
                        0.9977036118507385,
                        0.9617415070533752,
                        0.9699501395225525,
                        0.9746952056884766,
                        0.970381498336792,
                        0.9721387028694153,
                        0.9728935956954956,
                        0.9680787920951843,
                        0.9573516845703125,
                        0.9649133086204529,
                        0.97926265001297,
                        0.9447468519210815,
                        0.8907687664031982,
                        0.9480074644088745,
                        0.9441441893577576,
                        0.9437953233718872,
                        0.9475888013839722,
                        0.9322752356529236,
                        0.9544780254364014,
                        0.9883720874786377,
                        0.8919233083724976,
                        0.9976909160614014,
                        0.9178687930107117,
                        0.912502110004425,
                        0.9109225273132324,
                        0.9142148494720459,
                        0.9135107398033142,
                        0.9185729622840881,
                        0.9173042178153992,
                        0.9187442064285278,
                        0.8804095387458801,
                        0.9146208763122559,
                        0.9679645895957947,
                        0.9100597500801086,
                        0.9163526892662048,
                        0.9177419543266296,
                        0.9739086031913757,
                        0.9681993126869202,
                        0.9758497476577759,
                        0.9986298084259033,
                        0.9541481137275696
                    ]
                },
                "val": {
                    "score": -5.41151701024382,
                    "pretrain_loss": 0.8998845219612122,
                    "features_accuracy": [
                        0.3576209247112274,
                        0.7604705095291138,
                        0.30179494619369507,
                        0.312797874212265,
                        0.4716053009033203,
                        0.3547307550907135,
                        0.32238107919692993,
                        0.4116215407848358,
                        0.49832671880722046,
                        0.38099583983421326,
                        0.9937126040458679,
                        0.3546293377876282,
                        0.3734915256500244,
                        0.3843930661678314,
                        0.3782070577144623,
                        0.34884899854660034,
                        0.32704591751098633,
                        0.32217827439308167,
                        0.2740594148635864,
                        0.5841699242591858,
                        0.3141162097454071,
                        0.3436771035194397,
                        0.5732684135437012,
                        0.3372375965118408,
                        0.33429670333862305,
                        0.3969171345233917,
                        0.41638776659965515,
                        0.5516681671142578,
                        0.42130613327026367,
                        0.9866645932197571,
                        0.9099482297897339,
                        0.9934083223342896,
                        0.8861169815063477,
                        0.9053341150283813,
                        0.8906804323196411,
                        0.9058918952941895,
                        0.9032045006752014,
                        0.6126660704612732,
                        0.9033566117286682,
                        0.5941081047058105,
                        0.8994016647338867,
                        0.893671989440918,
                        0.34387990832328796,
                        0.8852550387382507,
                        0.906956672668457,
                        0.909136950969696,
                        0.4262244999408722,
                        0.4036608636379242,
                        0.3814014792442322,
                        0.9961463809013367,
                        0.29119762778282166
                    ]
                },
                "test": {
                    "score": -5.57456478962318,
                    "pretrain_loss": 0.4590902030467987,
                    "features_accuracy": [
                        0.6077079176902771,
                        0.6627281904220581,
                        0.6873732209205627,
                        0.6782961487770081,
                        0.628346860408783,
                        0.7256085276603699,
                        0.5876267552375793,
                        0.6261663436889648,
                        0.7011663317680359,
                        0.5943711996078491,
                        0.9943205118179321,
                        0.7058823704719543,
                        0.649949312210083,
                        0.7306287884712219,
                        0.744979739189148,
                        0.6865111589431763,
                        0.6324543356895447,
                        0.7185598611831665,
                        0.6690162420272827,
                        0.7063894271850586,
                        0.8046653270721436,
                        0.6038539409637451,
                        0.8374239206314087,
                        0.7537018060684204,
                        0.6115618944168091,
                        0.8240872025489807,
                        0.6764198541641235,
                        0.5690669417381287,
                        0.4392494857311249,
                        0.9870689511299133,
                        0.9219574332237244,
                        0.9936612844467163,
                        0.7762170433998108,
                        0.9078600406646729,
                        0.8932555913925171,
                        0.9101927280426025,
                        0.90892493724823,
                        0.9123225212097168,
                        0.9058823585510254,
                        0.7201825380325317,
                        0.908316433429718,
                        0.9063894748687744,
                        0.654411792755127,
                        0.8982758522033691,
                        0.908316433429718,
                        0.8966024518013,
                        0.6123225092887878,
                        0.7093813419342041,
                        0.7371196746826172,
                        0.9974138140678406,
                        0.5241379141807556
                    ]
                }
            },
            "40000": {
                "train": {
                    "score": -4.2154789216130695,
                    "pretrain_loss": 0.11644329130649567,
                    "features_accuracy": [
                        0.9574214816093445,
                        0.916162371635437,
                        0.9693982601165771,
                        0.9722084999084473,
                        0.970051646232605,
                        0.971250593662262,
                        0.9749933481216431,
                        0.9729506969451904,
                        0.967057466506958,
                        0.9767886400222778,
                        0.997735321521759,
                        0.9633337259292603,
                        0.9676791429519653,
                        0.9773722290992737,
                        0.9706416130065918,
                        0.975995659828186,
                        0.971053957939148,
                        0.9696646928787231,
                        0.9595719575881958,
                        0.9636191725730896,
                        0.9803664088249207,
                        0.9471891522407532,
                        0.8925449848175049,
                        0.9490160942077637,
                        0.9440617561340332,
                        0.9448800683021545,
                        0.9467197060585022,
                        0.9353582262992859,
                        0.958385705947876,
                        0.9880866408348083,
                        0.8885167241096497,
                        0.9975132942199707,
                        0.9153440594673157,
                        0.9142846465110779,
                        0.9109859466552734,
                        0.9140499234199524,
                        0.9177165627479553,
                        0.9185095429420471,
                        0.914493978023529,
                        0.9188774228096008,
                        0.87980055809021,
                        0.913764476776123,
                        0.9726144671440125,
                        0.9096410870552063,
                        0.916422426700592,
                        0.9131301045417786,
                        0.9742828607559204,
                        0.9708255529403687,
                        0.9776323437690735,
                        0.9985156059265137,
                        0.953856348991394
                    ]
                },
                "val": {
                    "score": -5.401537731488203,
                    "pretrain_loss": 0.9091135859489441,
                    "features_accuracy": [
                        0.3013386130332947,
                        0.6050096154212952,
                        0.43489503860473633,
                        0.340634822845459,
                        0.4874759018421173,
                        0.40315383672714233,
                        0.3432207703590393,
                        0.4180610477924347,
                        0.5097352862358093,
                        0.39397627115249634,
                        0.9938647150993347,
                        0.37607747316360474,
                        0.41709765791893005,
                        0.43372881412506104,
                        0.4141567647457123,
                        0.32785719633102417,
                        0.35275325179100037,
                        0.3839874267578125,
                        0.2944934368133545,
                        0.5936010479927063,
                        0.34154748916625977,
                        0.3608660399913788,
                        0.5598823428153992,
                        0.34535035490989685,
                        0.348747581243515,
                        0.40432003140449524,
                        0.4436669647693634,
                        0.5628739595413208,
                        0.39336779713630676,
                        0.9860561490058899,
                        0.9156271815299988,
                        0.9934590458869934,
                        0.9036101698875427,
                        0.9052833914756775,
                        0.8845958709716797,
                        0.9057397842407227,
                        0.9031031131744385,
                        0.6286380290985107,
                        0.9031538367271423,
                        0.5855897068977356,
                        0.8887536525726318,
                        0.8818578124046326,
                        0.31203731894493103,
                        0.8911367654800415,
                        0.9060440063476562,
                        0.9071595072746277,
                        0.42439913749694824,
                        0.40193691849708557,
                        0.3994523882865906,
                        0.9963492155075073,
                        0.23866747319698334
                    ]
                },
                "test": {
                    "score": -5.622543134453761,
                    "pretrain_loss": 0.44995078444480896,
                    "features_accuracy": [
                        0.6371703743934631,
                        0.6823022365570068,
                        0.7596349120140076,
                        0.6736308336257935,
                        0.6684077382087708,
                        0.7365111708641052,
                        0.653346836566925,
                        0.6110040545463562,
                        0.6969574093818665,
                        0.6926470398902893,
                        0.9948275685310364,
                        0.7394523620605469,
                        0.7087221145629883,
                        0.7213996052742004,
                        0.702839732170105,
                        0.7397058606147766,
                        0.601166307926178,
                        0.7375253438949585,
                        0.6745436191558838,
                        0.6148073077201843,
                        0.7908722162246704,
                        0.6298174262046814,
                        0.8309330940246582,
                        0.7532454133033752,
                        0.6425963640213013,
                        0.8117139935493469,
                        0.718306303024292,
                        0.568965494632721,
                        0.5845841765403748,
                        0.9862576127052307,
                        0.9222109317779541,
                        0.9940669536590576,
                        0.5958924889564514,
                        0.9093813300132751,
                        0.8646044731140137,
                        0.905578076839447,
                        0.9093813300132751,
                        0.9141480922698975,
                        0.9120182394981384,
                        0.6819979548454285,
                        0.9089756608009338,
                        0.8989858031272888,
                        0.6681541800498962,
                        0.9016227126121521,
                        0.9070993661880493,
                        0.898833692073822,
                        0.578955352306366,
                        0.7169878482818604,
                        0.7592291831970215,
                        0.9973123669624329,
                        0.5169371366500854
                    ]
                }
            }
        },
        "train": {
            "score": -3.7351952971831217
        },
        "val": {
            "score": -5.3122750597487824
        },
        "test": {
            "score": -5.57800970819825
        }
    },
    "best_iteration": 10000,
    "time": "0:06:49"
}
